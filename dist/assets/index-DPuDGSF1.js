var h4=e=>{throw TypeError(e)};var See=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var y_=(e,t,r)=>t.has(e)||h4("Cannot "+r);var X=(e,t,r)=>(y_(e,t,"read from private field"),r?r.call(e):t.get(e)),at=(e,t,r)=>t.has(e)?h4("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Ue=(e,t,r,n)=>(y_(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),kt=(e,t,r)=>(y_(e,t,"access private method"),r);var py=(e,t,r,n)=>({set _(a){Ue(e,t,a,r)},get _(){return X(e,t,n)}});var JXe=See((CQe,_ee)=>{function c6(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var my=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Cee(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var u6={exports:{}},B1={},d6={exports:{}},zt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vx=Symbol.for("react.element"),Eee=Symbol.for("react.portal"),kee=Symbol.for("react.fragment"),Aee=Symbol.for("react.strict_mode"),Pee=Symbol.for("react.profiler"),Tee=Symbol.for("react.provider"),Ree=Symbol.for("react.context"),Oee=Symbol.for("react.forward_ref"),Iee=Symbol.for("react.suspense"),Dee=Symbol.for("react.memo"),Mee=Symbol.for("react.lazy"),f4=Symbol.iterator;function $ee(e){return e===null||typeof e!="object"?null:(e=f4&&e[f4]||e["@@iterator"],typeof e=="function"?e:null)}var h6={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f6=Object.assign,p6={};function Lp(e,t,r){this.props=e,this.context=t,this.refs=p6,this.updater=r||h6}Lp.prototype.isReactComponent={};Lp.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Lp.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function m6(){}m6.prototype=Lp.prototype;function lP(e,t,r){this.props=e,this.context=t,this.refs=p6,this.updater=r||h6}var cP=lP.prototype=new m6;cP.constructor=lP;f6(cP,Lp.prototype);cP.isPureReactComponent=!0;var p4=Array.isArray,v6=Object.prototype.hasOwnProperty,uP={current:null},g6={key:!0,ref:!0,__self:!0,__source:!0};function x6(e,t,r){var n,a={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)v6.call(t,n)&&!g6.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:vx,type:e,key:i,ref:o,props:a,_owner:uP.current}}function Fee(e,t){return{$$typeof:vx,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function dP(e){return typeof e=="object"&&e!==null&&e.$$typeof===vx}function Lee(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var m4=/\/+/g;function b_(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Lee(""+e.key):t.toString(36)}function Rb(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case vx:case Eee:o=!0}}if(o)return o=e,a=a(o),e=n===""?"."+b_(o,0):n,p4(a)?(r="",e!=null&&(r=e.replace(m4,"$&/")+"/"),Rb(a,t,r,"",function(u){return u})):a!=null&&(dP(a)&&(a=Fee(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(m4,"$&/")+"/")+e)),t.push(a)),1;if(o=0,n=n===""?".":n+":",p4(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+b_(i,l);o+=Rb(i,t,r,c,a)}else if(c=$ee(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+b_(i,l++),o+=Rb(i,t,r,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function vy(e,t,r){if(e==null)return e;var n=[],a=0;return Rb(e,n,"","",function(i){return t.call(r,i,a++)}),n}function Bee(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var za={current:null},Ob={transition:null},Uee={ReactCurrentDispatcher:za,ReactCurrentBatchConfig:Ob,ReactCurrentOwner:uP};function y6(){throw Error("act(...) is not supported in production builds of React.")}zt.Children={map:vy,forEach:function(e,t,r){vy(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return vy(e,function(){t++}),t},toArray:function(e){return vy(e,function(t){return t})||[]},only:function(e){if(!dP(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};zt.Component=Lp;zt.Fragment=kee;zt.Profiler=Pee;zt.PureComponent=lP;zt.StrictMode=Aee;zt.Suspense=Iee;zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Uee;zt.act=y6;zt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=f6({},e.props),a=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=uP.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)v6.call(t,c)&&!g6.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:vx,type:e.type,key:a,ref:i,props:n,_owner:o}};zt.createContext=function(e){return e={$$typeof:Ree,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Tee,_context:e},e.Consumer=e};zt.createElement=x6;zt.createFactory=function(e){var t=x6.bind(null,e);return t.type=e,t};zt.createRef=function(){return{current:null}};zt.forwardRef=function(e){return{$$typeof:Oee,render:e}};zt.isValidElement=dP;zt.lazy=function(e){return{$$typeof:Mee,_payload:{_status:-1,_result:e},_init:Bee}};zt.memo=function(e,t){return{$$typeof:Dee,type:e,compare:t===void 0?null:t}};zt.startTransition=function(e){var t=Ob.transition;Ob.transition={};try{e()}finally{Ob.transition=t}};zt.unstable_act=y6;zt.useCallback=function(e,t){return za.current.useCallback(e,t)};zt.useContext=function(e){return za.current.useContext(e)};zt.useDebugValue=function(){};zt.useDeferredValue=function(e){return za.current.useDeferredValue(e)};zt.useEffect=function(e,t){return za.current.useEffect(e,t)};zt.useId=function(){return za.current.useId()};zt.useImperativeHandle=function(e,t,r){return za.current.useImperativeHandle(e,t,r)};zt.useInsertionEffect=function(e,t){return za.current.useInsertionEffect(e,t)};zt.useLayoutEffect=function(e,t){return za.current.useLayoutEffect(e,t)};zt.useMemo=function(e,t){return za.current.useMemo(e,t)};zt.useReducer=function(e,t,r){return za.current.useReducer(e,t,r)};zt.useRef=function(e){return za.current.useRef(e)};zt.useState=function(e){return za.current.useState(e)};zt.useSyncExternalStore=function(e,t,r){return za.current.useSyncExternalStore(e,t,r)};zt.useTransition=function(){return za.current.useTransition()};zt.version="18.3.1";d6.exports=zt;var w=d6.exports;const F=lr(w),hP=c6({__proto__:null,default:F},[w]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vee=w,zee=Symbol.for("react.element"),Wee=Symbol.for("react.fragment"),qee=Object.prototype.hasOwnProperty,Gee=Vee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Hee={key:!0,ref:!0,__self:!0,__source:!0};function b6(e,t,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)qee.call(t,n)&&!Hee.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:zee,type:e,key:i,ref:o,props:a,_owner:Gee.current}}B1.Fragment=Wee;B1.jsx=b6;B1.jsxs=b6;u6.exports=B1;var s=u6.exports,w6={exports:{}},$s={},j6={exports:{}},N6={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t($,D){var W=$.length;$.push(D);e:for(;0<W;){var Z=W-1>>>1,U=$[Z];if(0<a(U,D))$[Z]=D,$[W]=U,W=Z;else break e}}function r($){return $.length===0?null:$[0]}function n($){if($.length===0)return null;var D=$[0],W=$.pop();if(W!==D){$[0]=W;e:for(var Z=0,U=$.length,Y=U>>>1;Z<Y;){var ae=2*(Z+1)-1,ie=$[ae],he=ae+1,se=$[he];if(0>a(ie,W))he<U&&0>a(se,ie)?($[Z]=se,$[he]=W,Z=he):($[Z]=ie,$[ae]=W,Z=ae);else if(he<U&&0>a(se,W))$[Z]=se,$[he]=W,Z=he;else break e}}return D}function a($,D){var W=$.sortIndex-D.sortIndex;return W!==0?W:$.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,v=!1,g=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b($){for(var D=r(u);D!==null;){if(D.callback===null)n(u);else if(D.startTime<=$)n(u),D.sortIndex=D.expirationTime,t(c,D);else break;D=r(u)}}function N($){if(v=!1,b($),!m)if(r(c)!==null)m=!0,M(j);else{var D=r(u);D!==null&&B(N,D.startTime-$)}}function j($,D){m=!1,v&&(v=!1,x(C),C=-1),p=!0;var W=f;try{for(b(D),h=r(c);h!==null&&(!(h.expirationTime>D)||$&&!P());){var Z=h.callback;if(typeof Z=="function"){h.callback=null,f=h.priorityLevel;var U=Z(h.expirationTime<=D);D=e.unstable_now(),typeof U=="function"?h.callback=U:h===r(c)&&n(c),b(D)}else n(c);h=r(c)}if(h!==null)var Y=!0;else{var ae=r(u);ae!==null&&B(N,ae.startTime-D),Y=!1}return Y}finally{h=null,f=W,p=!1}}var _=!1,S=null,C=-1,E=5,k=-1;function P(){return!(e.unstable_now()-k<E)}function A(){if(S!==null){var $=e.unstable_now();k=$;var D=!0;try{D=S(!0,$)}finally{D?O():(_=!1,S=null)}}else _=!1}var O;if(typeof y=="function")O=function(){y(A)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,R=I.port2;I.port1.onmessage=A,O=function(){R.postMessage(null)}}else O=function(){g(A,0)};function M($){S=$,_||(_=!0,O())}function B($,D){C=g(function(){$(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function($){$.callback=null},e.unstable_continueExecution=function(){m||p||(m=!0,M(j))},e.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<$?Math.floor(1e3/$):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function($){switch(f){case 1:case 2:case 3:var D=3;break;default:D=f}var W=f;f=D;try{return $()}finally{f=W}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function($,D){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var W=f;f=$;try{return D()}finally{f=W}},e.unstable_scheduleCallback=function($,D,W){var Z=e.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?Z+W:Z):W=Z,$){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=W+U,$={id:d++,callback:D,priorityLevel:$,startTime:W,expirationTime:U,sortIndex:-1},W>Z?($.sortIndex=W,t(u,$),r(c)===null&&$===r(u)&&(v?(x(C),C=-1):v=!0,B(N,W-Z))):($.sortIndex=U,t(c,$),m||p||(m=!0,M(j))),$},e.unstable_shouldYield=P,e.unstable_wrapCallback=function($){var D=f;return function(){var W=f;f=D;try{return $.apply(this,arguments)}finally{f=W}}}})(N6);j6.exports=N6;var Kee=j6.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yee=w,Ds=Kee;function Ee(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _6=new Set,Vv={};function Hd(e,t){zf(e,t),zf(e+"Capture",t)}function zf(e,t){for(Vv[e]=t,e=0;e<t.length;e++)_6.add(t[e])}var wl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),TS=Object.prototype.hasOwnProperty,Xee=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v4={},g4={};function Qee(e){return TS.call(g4,e)?!0:TS.call(v4,e)?!1:Xee.test(e)?g4[e]=!0:(v4[e]=!0,!1)}function Zee(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Jee(e,t,r,n){if(t===null||typeof t>"u"||Zee(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Wa(e,t,r,n,a,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var ia={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ia[e]=new Wa(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ia[t]=new Wa(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ia[e]=new Wa(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ia[e]=new Wa(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ia[e]=new Wa(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ia[e]=new Wa(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ia[e]=new Wa(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ia[e]=new Wa(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ia[e]=new Wa(e,5,!1,e.toLowerCase(),null,!1,!1)});var fP=/[\-:]([a-z])/g;function pP(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(fP,pP);ia[t]=new Wa(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(fP,pP);ia[t]=new Wa(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(fP,pP);ia[t]=new Wa(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ia[e]=new Wa(e,1,!1,e.toLowerCase(),null,!1,!1)});ia.xlinkHref=new Wa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ia[e]=new Wa(e,1,!1,e.toLowerCase(),null,!0,!0)});function mP(e,t,r,n){var a=ia.hasOwnProperty(t)?ia[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Jee(t,r,a,n)&&(r=null),n||a===null?Qee(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Il=Yee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,gy=Symbol.for("react.element"),zh=Symbol.for("react.portal"),Wh=Symbol.for("react.fragment"),vP=Symbol.for("react.strict_mode"),RS=Symbol.for("react.profiler"),S6=Symbol.for("react.provider"),C6=Symbol.for("react.context"),gP=Symbol.for("react.forward_ref"),OS=Symbol.for("react.suspense"),IS=Symbol.for("react.suspense_list"),xP=Symbol.for("react.memo"),rc=Symbol.for("react.lazy"),E6=Symbol.for("react.offscreen"),x4=Symbol.iterator;function Em(e){return e===null||typeof e!="object"?null:(e=x4&&e[x4]||e["@@iterator"],typeof e=="function"?e:null)}var Fr=Object.assign,w_;function av(e){if(w_===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);w_=t&&t[1]||""}return`
`+w_+e}var j_=!1;function N_(e,t){if(!e||j_)return"";j_=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=n.stack.split(`
`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var c=`
`+a[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{j_=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?av(e):""}function ete(e){switch(e.tag){case 5:return av(e.type);case 16:return av("Lazy");case 13:return av("Suspense");case 19:return av("SuspenseList");case 0:case 2:case 15:return e=N_(e.type,!1),e;case 11:return e=N_(e.type.render,!1),e;case 1:return e=N_(e.type,!0),e;default:return""}}function DS(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Wh:return"Fragment";case zh:return"Portal";case RS:return"Profiler";case vP:return"StrictMode";case OS:return"Suspense";case IS:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case C6:return(e.displayName||"Context")+".Consumer";case S6:return(e._context.displayName||"Context")+".Provider";case gP:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case xP:return t=e.displayName||null,t!==null?t:DS(e.type)||"Memo";case rc:t=e._payload,e=e._init;try{return DS(e(t))}catch{}}return null}function tte(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return DS(t);case 8:return t===vP?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Kc(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function k6(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function rte(e){var t=k6(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function xy(e){e._valueTracker||(e._valueTracker=rte(e))}function A6(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=k6(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function a0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function MS(e,t){var r=t.checked;return Fr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function y4(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Kc(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function P6(e,t){t=t.checked,t!=null&&mP(e,"checked",t,!1)}function $S(e,t){P6(e,t);var r=Kc(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?FS(e,t.type,r):t.hasOwnProperty("defaultValue")&&FS(e,t.type,Kc(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function b4(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function FS(e,t,r){(t!=="number"||a0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var sv=Array.isArray;function sf(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Kc(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function LS(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ee(91));return Fr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function w4(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ee(92));if(sv(r)){if(1<r.length)throw Error(Ee(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Kc(r)}}function T6(e,t){var r=Kc(t.value),n=Kc(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function j4(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function R6(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function BS(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?R6(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var yy,O6=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(yy=yy||document.createElement("div"),yy.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=yy.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function zv(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var mv={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nte=["Webkit","ms","Moz","O"];Object.keys(mv).forEach(function(e){nte.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),mv[t]=mv[e]})});function I6(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||mv.hasOwnProperty(e)&&mv[e]?(""+t).trim():t+"px"}function D6(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=I6(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var ate=Fr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function US(e,t){if(t){if(ate[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ee(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ee(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ee(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ee(62))}}function VS(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zS=null;function yP(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var WS=null,of=null,lf=null;function N4(e){if(e=yx(e)){if(typeof WS!="function")throw Error(Ee(280));var t=e.stateNode;t&&(t=q1(t),WS(e.stateNode,e.type,t))}}function M6(e){of?lf?lf.push(e):lf=[e]:of=e}function $6(){if(of){var e=of,t=lf;if(lf=of=null,N4(e),t)for(e=0;e<t.length;e++)N4(t[e])}}function F6(e,t){return e(t)}function L6(){}var __=!1;function B6(e,t,r){if(__)return e(t,r);__=!0;try{return F6(e,t,r)}finally{__=!1,(of!==null||lf!==null)&&(L6(),$6())}}function Wv(e,t){var r=e.stateNode;if(r===null)return null;var n=q1(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ee(231,t,typeof r));return r}var qS=!1;if(wl)try{var km={};Object.defineProperty(km,"passive",{get:function(){qS=!0}}),window.addEventListener("test",km,km),window.removeEventListener("test",km,km)}catch{qS=!1}function ste(e,t,r,n,a,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var vv=!1,s0=null,i0=!1,GS=null,ite={onError:function(e){vv=!0,s0=e}};function ote(e,t,r,n,a,i,o,l,c){vv=!1,s0=null,ste.apply(ite,arguments)}function lte(e,t,r,n,a,i,o,l,c){if(ote.apply(this,arguments),vv){if(vv){var u=s0;vv=!1,s0=null}else throw Error(Ee(198));i0||(i0=!0,GS=u)}}function Kd(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function U6(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function _4(e){if(Kd(e)!==e)throw Error(Ee(188))}function cte(e){var t=e.alternate;if(!t){if(t=Kd(e),t===null)throw Error(Ee(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return _4(a),e;if(i===n)return _4(a),t;i=i.sibling}throw Error(Ee(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o)throw Error(Ee(189))}}if(r.alternate!==n)throw Error(Ee(190))}if(r.tag!==3)throw Error(Ee(188));return r.stateNode.current===r?e:t}function V6(e){return e=cte(e),e!==null?z6(e):null}function z6(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=z6(e);if(t!==null)return t;e=e.sibling}return null}var W6=Ds.unstable_scheduleCallback,S4=Ds.unstable_cancelCallback,ute=Ds.unstable_shouldYield,dte=Ds.unstable_requestPaint,Jr=Ds.unstable_now,hte=Ds.unstable_getCurrentPriorityLevel,bP=Ds.unstable_ImmediatePriority,q6=Ds.unstable_UserBlockingPriority,o0=Ds.unstable_NormalPriority,fte=Ds.unstable_LowPriority,G6=Ds.unstable_IdlePriority,U1=null,jo=null;function pte(e){if(jo&&typeof jo.onCommitFiberRoot=="function")try{jo.onCommitFiberRoot(U1,e,void 0,(e.current.flags&128)===128)}catch{}}var Li=Math.clz32?Math.clz32:gte,mte=Math.log,vte=Math.LN2;function gte(e){return e>>>=0,e===0?32:31-(mte(e)/vte|0)|0}var by=64,wy=4194304;function iv(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function l0(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=iv(l):(i&=o,i!==0&&(n=iv(i)))}else o=r&~a,o!==0?n=iv(o):i!==0&&(n=iv(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Li(t),a=1<<r,n|=e[r],t&=~a;return n}function xte(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yte(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Li(i),l=1<<o,c=a[o];c===-1?(!(l&r)||l&n)&&(a[o]=xte(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function HS(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function H6(){var e=by;return by<<=1,!(by&4194240)&&(by=64),e}function S_(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function gx(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Li(t),e[t]=r}function bte(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Li(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function wP(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Li(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var or=0;function K6(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Y6,jP,X6,Q6,Z6,KS=!1,jy=[],Tc=null,Rc=null,Oc=null,qv=new Map,Gv=new Map,oc=[],wte="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function C4(e,t){switch(e){case"focusin":case"focusout":Tc=null;break;case"dragenter":case"dragleave":Rc=null;break;case"mouseover":case"mouseout":Oc=null;break;case"pointerover":case"pointerout":qv.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gv.delete(t.pointerId)}}function Am(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=yx(t),t!==null&&jP(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function jte(e,t,r,n,a){switch(t){case"focusin":return Tc=Am(Tc,e,t,r,n,a),!0;case"dragenter":return Rc=Am(Rc,e,t,r,n,a),!0;case"mouseover":return Oc=Am(Oc,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return qv.set(i,Am(qv.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Gv.set(i,Am(Gv.get(i)||null,e,t,r,n,a)),!0}return!1}function J6(e){var t=Wu(e.target);if(t!==null){var r=Kd(t);if(r!==null){if(t=r.tag,t===13){if(t=U6(r),t!==null){e.blockedOn=t,Z6(e.priority,function(){X6(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ib(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=YS(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);zS=n,r.target.dispatchEvent(n),zS=null}else return t=yx(r),t!==null&&jP(t),e.blockedOn=r,!1;t.shift()}return!0}function E4(e,t,r){Ib(e)&&r.delete(t)}function Nte(){KS=!1,Tc!==null&&Ib(Tc)&&(Tc=null),Rc!==null&&Ib(Rc)&&(Rc=null),Oc!==null&&Ib(Oc)&&(Oc=null),qv.forEach(E4),Gv.forEach(E4)}function Pm(e,t){e.blockedOn===t&&(e.blockedOn=null,KS||(KS=!0,Ds.unstable_scheduleCallback(Ds.unstable_NormalPriority,Nte)))}function Hv(e){function t(a){return Pm(a,e)}if(0<jy.length){Pm(jy[0],e);for(var r=1;r<jy.length;r++){var n=jy[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Tc!==null&&Pm(Tc,e),Rc!==null&&Pm(Rc,e),Oc!==null&&Pm(Oc,e),qv.forEach(t),Gv.forEach(t),r=0;r<oc.length;r++)n=oc[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<oc.length&&(r=oc[0],r.blockedOn===null);)J6(r),r.blockedOn===null&&oc.shift()}var cf=Il.ReactCurrentBatchConfig,c0=!0;function _te(e,t,r,n){var a=or,i=cf.transition;cf.transition=null;try{or=1,NP(e,t,r,n)}finally{or=a,cf.transition=i}}function Ste(e,t,r,n){var a=or,i=cf.transition;cf.transition=null;try{or=4,NP(e,t,r,n)}finally{or=a,cf.transition=i}}function NP(e,t,r,n){if(c0){var a=YS(e,t,r,n);if(a===null)D_(e,t,n,u0,r),C4(e,n);else if(jte(a,e,t,r,n))n.stopPropagation();else if(C4(e,n),t&4&&-1<wte.indexOf(e)){for(;a!==null;){var i=yx(a);if(i!==null&&Y6(i),i=YS(e,t,r,n),i===null&&D_(e,t,n,u0,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else D_(e,t,n,null,r)}}var u0=null;function YS(e,t,r,n){if(u0=null,e=yP(n),e=Wu(e),e!==null)if(t=Kd(e),t===null)e=null;else if(r=t.tag,r===13){if(e=U6(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return u0=e,null}function eU(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hte()){case bP:return 1;case q6:return 4;case o0:case fte:return 16;case G6:return 536870912;default:return 16}default:return 16}}var wc=null,_P=null,Db=null;function tU(){if(Db)return Db;var e,t=_P,r=t.length,n,a="value"in wc?wc.value:wc.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[i-n];n++);return Db=a.slice(e,1<n?1-n:void 0)}function Mb(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ny(){return!0}function k4(){return!1}function Fs(e){function t(r,n,a,i,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ny:k4,this.isPropagationStopped=k4,this}return Fr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ny)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ny)},persist:function(){},isPersistent:Ny}),t}var Bp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},SP=Fs(Bp),xx=Fr({},Bp,{view:0,detail:0}),Cte=Fs(xx),C_,E_,Tm,V1=Fr({},xx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:CP,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Tm&&(Tm&&e.type==="mousemove"?(C_=e.screenX-Tm.screenX,E_=e.screenY-Tm.screenY):E_=C_=0,Tm=e),C_)},movementY:function(e){return"movementY"in e?e.movementY:E_}}),A4=Fs(V1),Ete=Fr({},V1,{dataTransfer:0}),kte=Fs(Ete),Ate=Fr({},xx,{relatedTarget:0}),k_=Fs(Ate),Pte=Fr({},Bp,{animationName:0,elapsedTime:0,pseudoElement:0}),Tte=Fs(Pte),Rte=Fr({},Bp,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ote=Fs(Rte),Ite=Fr({},Bp,{data:0}),P4=Fs(Ite),Dte={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mte={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$te={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Fte(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=$te[e])?!!t[e]:!1}function CP(){return Fte}var Lte=Fr({},xx,{key:function(e){if(e.key){var t=Dte[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Mb(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Mte[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:CP,charCode:function(e){return e.type==="keypress"?Mb(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Mb(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Bte=Fs(Lte),Ute=Fr({},V1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),T4=Fs(Ute),Vte=Fr({},xx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:CP}),zte=Fs(Vte),Wte=Fr({},Bp,{propertyName:0,elapsedTime:0,pseudoElement:0}),qte=Fs(Wte),Gte=Fr({},V1,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Hte=Fs(Gte),Kte=[9,13,27,32],EP=wl&&"CompositionEvent"in window,gv=null;wl&&"documentMode"in document&&(gv=document.documentMode);var Yte=wl&&"TextEvent"in window&&!gv,rU=wl&&(!EP||gv&&8<gv&&11>=gv),R4=" ",O4=!1;function nU(e,t){switch(e){case"keyup":return Kte.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function aU(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var qh=!1;function Xte(e,t){switch(e){case"compositionend":return aU(t);case"keypress":return t.which!==32?null:(O4=!0,R4);case"textInput":return e=t.data,e===R4&&O4?null:e;default:return null}}function Qte(e,t){if(qh)return e==="compositionend"||!EP&&nU(e,t)?(e=tU(),Db=_P=wc=null,qh=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return rU&&t.locale!=="ko"?null:t.data;default:return null}}var Zte={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function I4(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Zte[e.type]:t==="textarea"}function sU(e,t,r,n){M6(n),t=d0(t,"onChange"),0<t.length&&(r=new SP("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var xv=null,Kv=null;function Jte(e){vU(e,0)}function z1(e){var t=Kh(e);if(A6(t))return e}function ere(e,t){if(e==="change")return t}var iU=!1;if(wl){var A_;if(wl){var P_="oninput"in document;if(!P_){var D4=document.createElement("div");D4.setAttribute("oninput","return;"),P_=typeof D4.oninput=="function"}A_=P_}else A_=!1;iU=A_&&(!document.documentMode||9<document.documentMode)}function M4(){xv&&(xv.detachEvent("onpropertychange",oU),Kv=xv=null)}function oU(e){if(e.propertyName==="value"&&z1(Kv)){var t=[];sU(t,Kv,e,yP(e)),B6(Jte,t)}}function tre(e,t,r){e==="focusin"?(M4(),xv=t,Kv=r,xv.attachEvent("onpropertychange",oU)):e==="focusout"&&M4()}function rre(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return z1(Kv)}function nre(e,t){if(e==="click")return z1(t)}function are(e,t){if(e==="input"||e==="change")return z1(t)}function sre(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Vi=typeof Object.is=="function"?Object.is:sre;function Yv(e,t){if(Vi(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!TS.call(t,a)||!Vi(e[a],t[a]))return!1}return!0}function $4(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function F4(e,t){var r=$4(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=$4(r)}}function lU(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?lU(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function cU(){for(var e=window,t=a0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=a0(e.document)}return t}function kP(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function ire(e){var t=cU(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&lU(r.ownerDocument.documentElement,r)){if(n!==null&&kP(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=F4(r,i);var o=F4(r,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ore=wl&&"documentMode"in document&&11>=document.documentMode,Gh=null,XS=null,yv=null,QS=!1;function L4(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;QS||Gh==null||Gh!==a0(n)||(n=Gh,"selectionStart"in n&&kP(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),yv&&Yv(yv,n)||(yv=n,n=d0(XS,"onSelect"),0<n.length&&(t=new SP("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Gh)))}function _y(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Hh={animationend:_y("Animation","AnimationEnd"),animationiteration:_y("Animation","AnimationIteration"),animationstart:_y("Animation","AnimationStart"),transitionend:_y("Transition","TransitionEnd")},T_={},uU={};wl&&(uU=document.createElement("div").style,"AnimationEvent"in window||(delete Hh.animationend.animation,delete Hh.animationiteration.animation,delete Hh.animationstart.animation),"TransitionEvent"in window||delete Hh.transitionend.transition);function W1(e){if(T_[e])return T_[e];if(!Hh[e])return e;var t=Hh[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in uU)return T_[e]=t[r];return e}var dU=W1("animationend"),hU=W1("animationiteration"),fU=W1("animationstart"),pU=W1("transitionend"),mU=new Map,B4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function su(e,t){mU.set(e,t),Hd(t,[e])}for(var R_=0;R_<B4.length;R_++){var O_=B4[R_],lre=O_.toLowerCase(),cre=O_[0].toUpperCase()+O_.slice(1);su(lre,"on"+cre)}su(dU,"onAnimationEnd");su(hU,"onAnimationIteration");su(fU,"onAnimationStart");su("dblclick","onDoubleClick");su("focusin","onFocus");su("focusout","onBlur");su(pU,"onTransitionEnd");zf("onMouseEnter",["mouseout","mouseover"]);zf("onMouseLeave",["mouseout","mouseover"]);zf("onPointerEnter",["pointerout","pointerover"]);zf("onPointerLeave",["pointerout","pointerover"]);Hd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Hd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Hd("onBeforeInput",["compositionend","keypress","textInput","paste"]);Hd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Hd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Hd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ov="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ure=new Set("cancel close invalid load scroll toggle".split(" ").concat(ov));function U4(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,lte(n,t,void 0,e),e.currentTarget=null}function vU(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&a.isPropagationStopped())break e;U4(a,l,u),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&a.isPropagationStopped())break e;U4(a,l,u),i=c}}}if(i0)throw e=GS,i0=!1,GS=null,e}function jr(e,t){var r=t[rC];r===void 0&&(r=t[rC]=new Set);var n=e+"__bubble";r.has(n)||(gU(t,e,2,!1),r.add(n))}function I_(e,t,r){var n=0;t&&(n|=4),gU(r,e,n,t)}var Sy="_reactListening"+Math.random().toString(36).slice(2);function Xv(e){if(!e[Sy]){e[Sy]=!0,_6.forEach(function(r){r!=="selectionchange"&&(ure.has(r)||I_(r,!1,e),I_(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Sy]||(t[Sy]=!0,I_("selectionchange",!1,t))}}function gU(e,t,r,n){switch(eU(t)){case 1:var a=_te;break;case 4:a=Ste;break;default:a=NP}r=a.bind(null,t,r,e),a=void 0,!qS||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function D_(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=Wu(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}B6(function(){var u=i,d=yP(r),h=[];e:{var f=mU.get(e);if(f!==void 0){var p=SP,m=e;switch(e){case"keypress":if(Mb(r)===0)break e;case"keydown":case"keyup":p=Bte;break;case"focusin":m="focus",p=k_;break;case"focusout":m="blur",p=k_;break;case"beforeblur":case"afterblur":p=k_;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=A4;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=kte;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=zte;break;case dU:case hU:case fU:p=Tte;break;case pU:p=qte;break;case"scroll":p=Cte;break;case"wheel":p=Hte;break;case"copy":case"cut":case"paste":p=Ote;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=T4}var v=(t&4)!==0,g=!v&&e==="scroll",x=v?f!==null?f+"Capture":null:f;v=[];for(var y=u,b;y!==null;){b=y;var N=b.stateNode;if(b.tag===5&&N!==null&&(b=N,x!==null&&(N=Wv(y,x),N!=null&&v.push(Qv(y,N,b)))),g)break;y=y.return}0<v.length&&(f=new p(f,m,null,r,d),h.push({event:f,listeners:v}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",f&&r!==zS&&(m=r.relatedTarget||r.fromElement)&&(Wu(m)||m[jl]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(m=r.relatedTarget||r.toElement,p=u,m=m?Wu(m):null,m!==null&&(g=Kd(m),m!==g||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(v=A4,N="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(v=T4,N="onPointerLeave",x="onPointerEnter",y="pointer"),g=p==null?f:Kh(p),b=m==null?f:Kh(m),f=new v(N,y+"leave",p,r,d),f.target=g,f.relatedTarget=b,N=null,Wu(d)===u&&(v=new v(x,y+"enter",m,r,d),v.target=b,v.relatedTarget=g,N=v),g=N,p&&m)t:{for(v=p,x=m,y=0,b=v;b;b=hh(b))y++;for(b=0,N=x;N;N=hh(N))b++;for(;0<y-b;)v=hh(v),y--;for(;0<b-y;)x=hh(x),b--;for(;y--;){if(v===x||x!==null&&v===x.alternate)break t;v=hh(v),x=hh(x)}v=null}else v=null;p!==null&&V4(h,f,p,v,!1),m!==null&&g!==null&&V4(h,g,m,v,!0)}}e:{if(f=u?Kh(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var j=ere;else if(I4(f))if(iU)j=are;else{j=rre;var _=tre}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(j=nre);if(j&&(j=j(e,u))){sU(h,j,r,d);break e}_&&_(e,f,u),e==="focusout"&&(_=f._wrapperState)&&_.controlled&&f.type==="number"&&FS(f,"number",f.value)}switch(_=u?Kh(u):window,e){case"focusin":(I4(_)||_.contentEditable==="true")&&(Gh=_,XS=u,yv=null);break;case"focusout":yv=XS=Gh=null;break;case"mousedown":QS=!0;break;case"contextmenu":case"mouseup":case"dragend":QS=!1,L4(h,r,d);break;case"selectionchange":if(ore)break;case"keydown":case"keyup":L4(h,r,d)}var S;if(EP)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else qh?nU(e,r)&&(C="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(rU&&r.locale!=="ko"&&(qh||C!=="onCompositionStart"?C==="onCompositionEnd"&&qh&&(S=tU()):(wc=d,_P="value"in wc?wc.value:wc.textContent,qh=!0)),_=d0(u,C),0<_.length&&(C=new P4(C,e,null,r,d),h.push({event:C,listeners:_}),S?C.data=S:(S=aU(r),S!==null&&(C.data=S)))),(S=Yte?Xte(e,r):Qte(e,r))&&(u=d0(u,"onBeforeInput"),0<u.length&&(d=new P4("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:u}),d.data=S))}vU(h,t)})}function Qv(e,t,r){return{instance:e,listener:t,currentTarget:r}}function d0(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Wv(e,r),i!=null&&n.unshift(Qv(e,i,a)),i=Wv(e,t),i!=null&&n.push(Qv(e,i,a))),e=e.return}return n}function hh(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function V4(e,t,r,n,a){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,a?(c=Wv(r,i),c!=null&&o.unshift(Qv(r,c,l))):a||(c=Wv(r,i),c!=null&&o.push(Qv(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var dre=/\r\n?/g,hre=/\u0000|\uFFFD/g;function z4(e){return(typeof e=="string"?e:""+e).replace(dre,`
`).replace(hre,"")}function Cy(e,t,r){if(t=z4(t),z4(e)!==t&&r)throw Error(Ee(425))}function h0(){}var ZS=null,JS=null;function eC(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var tC=typeof setTimeout=="function"?setTimeout:void 0,fre=typeof clearTimeout=="function"?clearTimeout:void 0,W4=typeof Promise=="function"?Promise:void 0,pre=typeof queueMicrotask=="function"?queueMicrotask:typeof W4<"u"?function(e){return W4.resolve(null).then(e).catch(mre)}:tC;function mre(e){setTimeout(function(){throw e})}function M_(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Hv(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Hv(t)}function Ic(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function q4(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Up=Math.random().toString(36).slice(2),po="__reactFiber$"+Up,Zv="__reactProps$"+Up,jl="__reactContainer$"+Up,rC="__reactEvents$"+Up,vre="__reactListeners$"+Up,gre="__reactHandles$"+Up;function Wu(e){var t=e[po];if(t)return t;for(var r=e.parentNode;r;){if(t=r[jl]||r[po]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=q4(e);e!==null;){if(r=e[po])return r;e=q4(e)}return t}e=r,r=e.parentNode}return null}function yx(e){return e=e[po]||e[jl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Kh(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ee(33))}function q1(e){return e[Zv]||null}var nC=[],Yh=-1;function iu(e){return{current:e}}function Cr(e){0>Yh||(e.current=nC[Yh],nC[Yh]=null,Yh--)}function xr(e,t){Yh++,nC[Yh]=e.current,e.current=t}var Yc={},_a=iu(Yc),as=iu(!1),jd=Yc;function Wf(e,t){var r=e.type.contextTypes;if(!r)return Yc;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function ss(e){return e=e.childContextTypes,e!=null}function f0(){Cr(as),Cr(_a)}function G4(e,t,r){if(_a.current!==Yc)throw Error(Ee(168));xr(_a,t),xr(as,r)}function xU(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Ee(108,tte(e)||"Unknown",a));return Fr({},r,n)}function p0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Yc,jd=_a.current,xr(_a,e),xr(as,as.current),!0}function H4(e,t,r){var n=e.stateNode;if(!n)throw Error(Ee(169));r?(e=xU(e,t,jd),n.__reactInternalMemoizedMergedChildContext=e,Cr(as),Cr(_a),xr(_a,e)):Cr(as),xr(as,r)}var rl=null,G1=!1,$_=!1;function yU(e){rl===null?rl=[e]:rl.push(e)}function xre(e){G1=!0,yU(e)}function ou(){if(!$_&&rl!==null){$_=!0;var e=0,t=or;try{var r=rl;for(or=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}rl=null,G1=!1}catch(a){throw rl!==null&&(rl=rl.slice(e+1)),W6(bP,ou),a}finally{or=t,$_=!1}}return null}var Xh=[],Qh=0,m0=null,v0=0,Ks=[],Ys=0,Nd=null,ol=1,ll="";function Tu(e,t){Xh[Qh++]=v0,Xh[Qh++]=m0,m0=e,v0=t}function bU(e,t,r){Ks[Ys++]=ol,Ks[Ys++]=ll,Ks[Ys++]=Nd,Nd=e;var n=ol;e=ll;var a=32-Li(n)-1;n&=~(1<<a),r+=1;var i=32-Li(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,ol=1<<32-Li(t)+a|r<<a|n,ll=i+e}else ol=1<<i|r<<a|n,ll=e}function AP(e){e.return!==null&&(Tu(e,1),bU(e,1,0))}function PP(e){for(;e===m0;)m0=Xh[--Qh],Xh[Qh]=null,v0=Xh[--Qh],Xh[Qh]=null;for(;e===Nd;)Nd=Ks[--Ys],Ks[Ys]=null,ll=Ks[--Ys],Ks[Ys]=null,ol=Ks[--Ys],Ks[Ys]=null}var Rs=null,Es=null,Ar=!1,Pi=null;function wU(e,t){var r=Js(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function K4(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Rs=e,Es=Ic(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Rs=e,Es=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Nd!==null?{id:ol,overflow:ll}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Js(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Rs=e,Es=null,!0):!1;default:return!1}}function aC(e){return(e.mode&1)!==0&&(e.flags&128)===0}function sC(e){if(Ar){var t=Es;if(t){var r=t;if(!K4(e,t)){if(aC(e))throw Error(Ee(418));t=Ic(r.nextSibling);var n=Rs;t&&K4(e,t)?wU(n,r):(e.flags=e.flags&-4097|2,Ar=!1,Rs=e)}}else{if(aC(e))throw Error(Ee(418));e.flags=e.flags&-4097|2,Ar=!1,Rs=e}}}function Y4(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Rs=e}function Ey(e){if(e!==Rs)return!1;if(!Ar)return Y4(e),Ar=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!eC(e.type,e.memoizedProps)),t&&(t=Es)){if(aC(e))throw jU(),Error(Ee(418));for(;t;)wU(e,t),t=Ic(t.nextSibling)}if(Y4(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ee(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Es=Ic(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Es=null}}else Es=Rs?Ic(e.stateNode.nextSibling):null;return!0}function jU(){for(var e=Es;e;)e=Ic(e.nextSibling)}function qf(){Es=Rs=null,Ar=!1}function TP(e){Pi===null?Pi=[e]:Pi.push(e)}var yre=Il.ReactCurrentBatchConfig;function Rm(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ee(309));var n=r.stateNode}if(!n)throw Error(Ee(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(Ee(284));if(!r._owner)throw Error(Ee(290,e))}return e}function ky(e,t){throw e=Object.prototype.toString.call(t),Error(Ee(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function X4(e){var t=e._init;return t(e._payload)}function NU(e){function t(x,y){if(e){var b=x.deletions;b===null?(x.deletions=[y],x.flags|=16):b.push(y)}}function r(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function n(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function a(x,y){return x=Fc(x,y),x.index=0,x.sibling=null,x}function i(x,y,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<y?(x.flags|=2,y):b):(x.flags|=2,y)):(x.flags|=1048576,y)}function o(x){return e&&x.alternate===null&&(x.flags|=2),x}function l(x,y,b,N){return y===null||y.tag!==6?(y=W_(b,x.mode,N),y.return=x,y):(y=a(y,b),y.return=x,y)}function c(x,y,b,N){var j=b.type;return j===Wh?d(x,y,b.props.children,N,b.key):y!==null&&(y.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===rc&&X4(j)===y.type)?(N=a(y,b.props),N.ref=Rm(x,y,b),N.return=x,N):(N=zb(b.type,b.key,b.props,null,x.mode,N),N.ref=Rm(x,y,b),N.return=x,N)}function u(x,y,b,N){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=q_(b,x.mode,N),y.return=x,y):(y=a(y,b.children||[]),y.return=x,y)}function d(x,y,b,N,j){return y===null||y.tag!==7?(y=md(b,x.mode,N,j),y.return=x,y):(y=a(y,b),y.return=x,y)}function h(x,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=W_(""+y,x.mode,b),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case gy:return b=zb(y.type,y.key,y.props,null,x.mode,b),b.ref=Rm(x,null,y),b.return=x,b;case zh:return y=q_(y,x.mode,b),y.return=x,y;case rc:var N=y._init;return h(x,N(y._payload),b)}if(sv(y)||Em(y))return y=md(y,x.mode,b,null),y.return=x,y;ky(x,y)}return null}function f(x,y,b,N){var j=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return j!==null?null:l(x,y,""+b,N);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case gy:return b.key===j?c(x,y,b,N):null;case zh:return b.key===j?u(x,y,b,N):null;case rc:return j=b._init,f(x,y,j(b._payload),N)}if(sv(b)||Em(b))return j!==null?null:d(x,y,b,N,null);ky(x,b)}return null}function p(x,y,b,N,j){if(typeof N=="string"&&N!==""||typeof N=="number")return x=x.get(b)||null,l(y,x,""+N,j);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case gy:return x=x.get(N.key===null?b:N.key)||null,c(y,x,N,j);case zh:return x=x.get(N.key===null?b:N.key)||null,u(y,x,N,j);case rc:var _=N._init;return p(x,y,b,_(N._payload),j)}if(sv(N)||Em(N))return x=x.get(b)||null,d(y,x,N,j,null);ky(y,N)}return null}function m(x,y,b,N){for(var j=null,_=null,S=y,C=y=0,E=null;S!==null&&C<b.length;C++){S.index>C?(E=S,S=null):E=S.sibling;var k=f(x,S,b[C],N);if(k===null){S===null&&(S=E);break}e&&S&&k.alternate===null&&t(x,S),y=i(k,y,C),_===null?j=k:_.sibling=k,_=k,S=E}if(C===b.length)return r(x,S),Ar&&Tu(x,C),j;if(S===null){for(;C<b.length;C++)S=h(x,b[C],N),S!==null&&(y=i(S,y,C),_===null?j=S:_.sibling=S,_=S);return Ar&&Tu(x,C),j}for(S=n(x,S);C<b.length;C++)E=p(S,x,C,b[C],N),E!==null&&(e&&E.alternate!==null&&S.delete(E.key===null?C:E.key),y=i(E,y,C),_===null?j=E:_.sibling=E,_=E);return e&&S.forEach(function(P){return t(x,P)}),Ar&&Tu(x,C),j}function v(x,y,b,N){var j=Em(b);if(typeof j!="function")throw Error(Ee(150));if(b=j.call(b),b==null)throw Error(Ee(151));for(var _=j=null,S=y,C=y=0,E=null,k=b.next();S!==null&&!k.done;C++,k=b.next()){S.index>C?(E=S,S=null):E=S.sibling;var P=f(x,S,k.value,N);if(P===null){S===null&&(S=E);break}e&&S&&P.alternate===null&&t(x,S),y=i(P,y,C),_===null?j=P:_.sibling=P,_=P,S=E}if(k.done)return r(x,S),Ar&&Tu(x,C),j;if(S===null){for(;!k.done;C++,k=b.next())k=h(x,k.value,N),k!==null&&(y=i(k,y,C),_===null?j=k:_.sibling=k,_=k);return Ar&&Tu(x,C),j}for(S=n(x,S);!k.done;C++,k=b.next())k=p(S,x,C,k.value,N),k!==null&&(e&&k.alternate!==null&&S.delete(k.key===null?C:k.key),y=i(k,y,C),_===null?j=k:_.sibling=k,_=k);return e&&S.forEach(function(A){return t(x,A)}),Ar&&Tu(x,C),j}function g(x,y,b,N){if(typeof b=="object"&&b!==null&&b.type===Wh&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case gy:e:{for(var j=b.key,_=y;_!==null;){if(_.key===j){if(j=b.type,j===Wh){if(_.tag===7){r(x,_.sibling),y=a(_,b.props.children),y.return=x,x=y;break e}}else if(_.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===rc&&X4(j)===_.type){r(x,_.sibling),y=a(_,b.props),y.ref=Rm(x,_,b),y.return=x,x=y;break e}r(x,_);break}else t(x,_);_=_.sibling}b.type===Wh?(y=md(b.props.children,x.mode,N,b.key),y.return=x,x=y):(N=zb(b.type,b.key,b.props,null,x.mode,N),N.ref=Rm(x,y,b),N.return=x,x=N)}return o(x);case zh:e:{for(_=b.key;y!==null;){if(y.key===_)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(x,y.sibling),y=a(y,b.children||[]),y.return=x,x=y;break e}else{r(x,y);break}else t(x,y);y=y.sibling}y=q_(b,x.mode,N),y.return=x,x=y}return o(x);case rc:return _=b._init,g(x,y,_(b._payload),N)}if(sv(b))return m(x,y,b,N);if(Em(b))return v(x,y,b,N);ky(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(x,y.sibling),y=a(y,b),y.return=x,x=y):(r(x,y),y=W_(b,x.mode,N),y.return=x,x=y),o(x)):r(x,y)}return g}var Gf=NU(!0),_U=NU(!1),g0=iu(null),x0=null,Zh=null,RP=null;function OP(){RP=Zh=x0=null}function IP(e){var t=g0.current;Cr(g0),e._currentValue=t}function iC(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function uf(e,t){x0=e,RP=Zh=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(rs=!0),e.firstContext=null)}function li(e){var t=e._currentValue;if(RP!==e)if(e={context:e,memoizedValue:t,next:null},Zh===null){if(x0===null)throw Error(Ee(308));Zh=e,x0.dependencies={lanes:0,firstContext:e}}else Zh=Zh.next=e;return t}var qu=null;function DP(e){qu===null?qu=[e]:qu.push(e)}function SU(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,DP(t)):(r.next=a.next,a.next=r),t.interleaved=r,Nl(e,n)}function Nl(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var nc=!1;function MP(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function CU(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fl(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Dc(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Qt&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Nl(e,r)}return a=n.interleaved,a===null?(t.next=t,DP(n)):(t.next=a.next,a.next=t),n.interleaved=t,Nl(e,r)}function $b(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,wP(e,r)}}function Q4(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function y0(e,t,r,n){var a=e.updateQueue;nc=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=a.baseState;o=0,d=u=c=null,l=i;do{var f=l.lane,p=l.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,v=l;switch(f=t,p=r,v.tag){case 1:if(m=v.payload,typeof m=="function"){h=m.call(p,h,f);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=v.payload,f=typeof m=="function"?m.call(p,h,f):m,f==null)break e;h=Fr({},h,f);break e;case 2:nc=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,f=a.effects,f===null?a.effects=[l]:f.push(l))}else p={eventTime:p,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=h):d=d.next=p,o|=f;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;f=l,l=f.next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}while(!0);if(d===null&&(c=h),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Sd|=o,e.lanes=o,e.memoizedState=h}}function Z4(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Ee(191,a));a.call(n)}}}var bx={},No=iu(bx),Jv=iu(bx),eg=iu(bx);function Gu(e){if(e===bx)throw Error(Ee(174));return e}function $P(e,t){switch(xr(eg,t),xr(Jv,e),xr(No,bx),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:BS(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=BS(t,e)}Cr(No),xr(No,t)}function Hf(){Cr(No),Cr(Jv),Cr(eg)}function EU(e){Gu(eg.current);var t=Gu(No.current),r=BS(t,e.type);t!==r&&(xr(Jv,e),xr(No,r))}function FP(e){Jv.current===e&&(Cr(No),Cr(Jv))}var Rr=iu(0);function b0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var F_=[];function LP(){for(var e=0;e<F_.length;e++)F_[e]._workInProgressVersionPrimary=null;F_.length=0}var Fb=Il.ReactCurrentDispatcher,L_=Il.ReactCurrentBatchConfig,_d=0,$r=null,_n=null,zn=null,w0=!1,bv=!1,tg=0,bre=0;function ua(){throw Error(Ee(321))}function BP(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Vi(e[r],t[r]))return!1;return!0}function UP(e,t,r,n,a,i){if(_d=i,$r=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Fb.current=e===null||e.memoizedState===null?_re:Sre,e=r(n,a),bv){i=0;do{if(bv=!1,tg=0,25<=i)throw Error(Ee(301));i+=1,zn=_n=null,t.updateQueue=null,Fb.current=Cre,e=r(n,a)}while(bv)}if(Fb.current=j0,t=_n!==null&&_n.next!==null,_d=0,zn=_n=$r=null,w0=!1,t)throw Error(Ee(300));return e}function VP(){var e=tg!==0;return tg=0,e}function io(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zn===null?$r.memoizedState=zn=e:zn=zn.next=e,zn}function ci(){if(_n===null){var e=$r.alternate;e=e!==null?e.memoizedState:null}else e=_n.next;var t=zn===null?$r.memoizedState:zn.next;if(t!==null)zn=t,_n=e;else{if(e===null)throw Error(Ee(310));_n=e,e={memoizedState:_n.memoizedState,baseState:_n.baseState,baseQueue:_n.baseQueue,queue:_n.queue,next:null},zn===null?$r.memoizedState=zn=e:zn=zn.next=e}return zn}function rg(e,t){return typeof t=="function"?t(e):t}function B_(e){var t=ci(),r=t.queue;if(r===null)throw Error(Ee(311));r.lastRenderedReducer=e;var n=_n,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((_d&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=n):c=c.next=h,$r.lanes|=d,Sd|=d}u=u.next}while(u!==null&&u!==i);c===null?o=n:c.next=l,Vi(n,t.memoizedState)||(rs=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,$r.lanes|=i,Sd|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function U_(e){var t=ci(),r=t.queue;if(r===null)throw Error(Ee(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=e(i,o.action),o=o.next;while(o!==a);Vi(i,t.memoizedState)||(rs=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function kU(){}function AU(e,t){var r=$r,n=ci(),a=t(),i=!Vi(n.memoizedState,a);if(i&&(n.memoizedState=a,rs=!0),n=n.queue,zP(RU.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||zn!==null&&zn.memoizedState.tag&1){if(r.flags|=2048,ng(9,TU.bind(null,r,n,a,t),void 0,null),qn===null)throw Error(Ee(349));_d&30||PU(r,t,a)}return a}function PU(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=$r.updateQueue,t===null?(t={lastEffect:null,stores:null},$r.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function TU(e,t,r,n){t.value=r,t.getSnapshot=n,OU(t)&&IU(e)}function RU(e,t,r){return r(function(){OU(t)&&IU(e)})}function OU(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Vi(e,r)}catch{return!0}}function IU(e){var t=Nl(e,1);t!==null&&Bi(t,e,1,-1)}function J4(e){var t=io();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rg,lastRenderedState:e},t.queue=e,e=e.dispatch=Nre.bind(null,$r,e),[t.memoizedState,e]}function ng(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=$r.updateQueue,t===null?(t={lastEffect:null,stores:null},$r.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function DU(){return ci().memoizedState}function Lb(e,t,r,n){var a=io();$r.flags|=e,a.memoizedState=ng(1|t,r,void 0,n===void 0?null:n)}function H1(e,t,r,n){var a=ci();n=n===void 0?null:n;var i=void 0;if(_n!==null){var o=_n.memoizedState;if(i=o.destroy,n!==null&&BP(n,o.deps)){a.memoizedState=ng(t,r,i,n);return}}$r.flags|=e,a.memoizedState=ng(1|t,r,i,n)}function eD(e,t){return Lb(8390656,8,e,t)}function zP(e,t){return H1(2048,8,e,t)}function MU(e,t){return H1(4,2,e,t)}function $U(e,t){return H1(4,4,e,t)}function FU(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function LU(e,t,r){return r=r!=null?r.concat([e]):null,H1(4,4,FU.bind(null,t,e),r)}function WP(){}function BU(e,t){var r=ci();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&BP(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function UU(e,t){var r=ci();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&BP(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function VU(e,t,r){return _d&21?(Vi(r,t)||(r=H6(),$r.lanes|=r,Sd|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,rs=!0),e.memoizedState=r)}function wre(e,t){var r=or;or=r!==0&&4>r?r:4,e(!0);var n=L_.transition;L_.transition={};try{e(!1),t()}finally{or=r,L_.transition=n}}function zU(){return ci().memoizedState}function jre(e,t,r){var n=$c(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},WU(e))qU(t,r);else if(r=SU(e,t,r,n),r!==null){var a=La();Bi(r,e,n,a),GU(r,t,n)}}function Nre(e,t,r){var n=$c(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(WU(e))qU(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(a.hasEagerState=!0,a.eagerState=l,Vi(l,o)){var c=t.interleaved;c===null?(a.next=a,DP(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=SU(e,t,a,n),r!==null&&(a=La(),Bi(r,e,n,a),GU(r,t,n))}}function WU(e){var t=e.alternate;return e===$r||t!==null&&t===$r}function qU(e,t){bv=w0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function GU(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,wP(e,r)}}var j0={readContext:li,useCallback:ua,useContext:ua,useEffect:ua,useImperativeHandle:ua,useInsertionEffect:ua,useLayoutEffect:ua,useMemo:ua,useReducer:ua,useRef:ua,useState:ua,useDebugValue:ua,useDeferredValue:ua,useTransition:ua,useMutableSource:ua,useSyncExternalStore:ua,useId:ua,unstable_isNewReconciler:!1},_re={readContext:li,useCallback:function(e,t){return io().memoizedState=[e,t===void 0?null:t],e},useContext:li,useEffect:eD,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Lb(4194308,4,FU.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Lb(4194308,4,e,t)},useInsertionEffect:function(e,t){return Lb(4,2,e,t)},useMemo:function(e,t){var r=io();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=io();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=jre.bind(null,$r,e),[n.memoizedState,e]},useRef:function(e){var t=io();return e={current:e},t.memoizedState=e},useState:J4,useDebugValue:WP,useDeferredValue:function(e){return io().memoizedState=e},useTransition:function(){var e=J4(!1),t=e[0];return e=wre.bind(null,e[1]),io().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=$r,a=io();if(Ar){if(r===void 0)throw Error(Ee(407));r=r()}else{if(r=t(),qn===null)throw Error(Ee(349));_d&30||PU(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,eD(RU.bind(null,n,i,e),[e]),n.flags|=2048,ng(9,TU.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=io(),t=qn.identifierPrefix;if(Ar){var r=ll,n=ol;r=(n&~(1<<32-Li(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=tg++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=bre++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Sre={readContext:li,useCallback:BU,useContext:li,useEffect:zP,useImperativeHandle:LU,useInsertionEffect:MU,useLayoutEffect:$U,useMemo:UU,useReducer:B_,useRef:DU,useState:function(){return B_(rg)},useDebugValue:WP,useDeferredValue:function(e){var t=ci();return VU(t,_n.memoizedState,e)},useTransition:function(){var e=B_(rg)[0],t=ci().memoizedState;return[e,t]},useMutableSource:kU,useSyncExternalStore:AU,useId:zU,unstable_isNewReconciler:!1},Cre={readContext:li,useCallback:BU,useContext:li,useEffect:zP,useImperativeHandle:LU,useInsertionEffect:MU,useLayoutEffect:$U,useMemo:UU,useReducer:U_,useRef:DU,useState:function(){return U_(rg)},useDebugValue:WP,useDeferredValue:function(e){var t=ci();return _n===null?t.memoizedState=e:VU(t,_n.memoizedState,e)},useTransition:function(){var e=U_(rg)[0],t=ci().memoizedState;return[e,t]},useMutableSource:kU,useSyncExternalStore:AU,useId:zU,unstable_isNewReconciler:!1};function ji(e,t){if(e&&e.defaultProps){t=Fr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function oC(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Fr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var K1={isMounted:function(e){return(e=e._reactInternals)?Kd(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=La(),a=$c(e),i=fl(n,a);i.payload=t,r!=null&&(i.callback=r),t=Dc(e,i,a),t!==null&&(Bi(t,e,a,n),$b(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=La(),a=$c(e),i=fl(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Dc(e,i,a),t!==null&&(Bi(t,e,a,n),$b(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=La(),n=$c(e),a=fl(r,n);a.tag=2,t!=null&&(a.callback=t),t=Dc(e,a,n),t!==null&&(Bi(t,e,n,r),$b(t,e,n))}};function tD(e,t,r,n,a,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!Yv(r,n)||!Yv(a,i):!0}function HU(e,t,r){var n=!1,a=Yc,i=t.contextType;return typeof i=="object"&&i!==null?i=li(i):(a=ss(t)?jd:_a.current,n=t.contextTypes,i=(n=n!=null)?Wf(e,a):Yc),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=K1,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function rD(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&K1.enqueueReplaceState(t,t.state,null)}function lC(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},MP(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=li(i):(i=ss(t)?jd:_a.current,a.context=Wf(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(oC(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&K1.enqueueReplaceState(a,a.state,null),y0(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Kf(e,t){try{var r="",n=t;do r+=ete(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function V_(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function cC(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Ere=typeof WeakMap=="function"?WeakMap:Map;function KU(e,t,r){r=fl(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){_0||(_0=!0,yC=n),cC(e,t)},r}function YU(e,t,r){r=fl(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){cC(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){cC(e,t),typeof n!="function"&&(Mc===null?Mc=new Set([this]):Mc.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function nD(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Ere;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Ure.bind(null,e,t,r),t.then(e,e))}function aD(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function sD(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=fl(-1,1),t.tag=2,Dc(r,t,1))),r.lanes|=1),e)}var kre=Il.ReactCurrentOwner,rs=!1;function Oa(e,t,r,n){t.child=e===null?_U(t,null,r,n):Gf(t,e.child,r,n)}function iD(e,t,r,n,a){r=r.render;var i=t.ref;return uf(t,a),n=UP(e,t,r,n,i,a),r=VP(),e!==null&&!rs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,_l(e,t,a)):(Ar&&r&&AP(t),t.flags|=1,Oa(e,t,n,a),t.child)}function oD(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!ZP(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,XU(e,t,i,n,a)):(e=zb(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Yv,r(o,n)&&e.ref===t.ref)return _l(e,t,a)}return t.flags|=1,e=Fc(i,n),e.ref=t.ref,e.return=t,t.child=e}function XU(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(Yv(i,n)&&e.ref===t.ref)if(rs=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(rs=!0);else return t.lanes=e.lanes,_l(e,t,a)}return uC(e,t,r,n,a)}function QU(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},xr(ef,xs),xs|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,xr(ef,xs),xs|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,xr(ef,xs),xs|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,xr(ef,xs),xs|=n;return Oa(e,t,a,r),t.child}function ZU(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function uC(e,t,r,n,a){var i=ss(r)?jd:_a.current;return i=Wf(t,i),uf(t,a),r=UP(e,t,r,n,i,a),n=VP(),e!==null&&!rs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,_l(e,t,a)):(Ar&&n&&AP(t),t.flags|=1,Oa(e,t,r,a),t.child)}function lD(e,t,r,n,a){if(ss(r)){var i=!0;p0(t)}else i=!1;if(uf(t,a),t.stateNode===null)Bb(e,t),HU(t,r,n),lC(t,r,n,a),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=li(u):(u=ss(r)?jd:_a.current,u=Wf(t,u));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&rD(t,o,n,u),nc=!1;var f=t.memoizedState;o.state=f,y0(t,n,o,a),c=t.memoizedState,l!==n||f!==c||as.current||nc?(typeof d=="function"&&(oC(t,r,d,n),c=t.memoizedState),(l=nc||tD(t,r,l,n,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,CU(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:ji(t.type,l),o.props=u,h=t.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=li(c):(c=ss(r)?jd:_a.current,c=Wf(t,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&rD(t,o,n,c),nc=!1,f=t.memoizedState,o.state=f,y0(t,n,o,a);var m=t.memoizedState;l!==h||f!==m||as.current||nc?(typeof p=="function"&&(oC(t,r,p,n),m=t.memoizedState),(u=nc||tD(t,r,u,n,f,m,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),o.props=n,o.state=m,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return dC(e,t,r,n,i,a)}function dC(e,t,r,n,a,i){ZU(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return a&&H4(t,r,!1),_l(e,t,i);n=t.stateNode,kre.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Gf(t,e.child,null,i),t.child=Gf(t,null,l,i)):Oa(e,t,l,i),t.memoizedState=n.state,a&&H4(t,r,!0),t.child}function JU(e){var t=e.stateNode;t.pendingContext?G4(e,t.pendingContext,t.pendingContext!==t.context):t.context&&G4(e,t.context,!1),$P(e,t.containerInfo)}function cD(e,t,r,n,a){return qf(),TP(a),t.flags|=256,Oa(e,t,r,n),t.child}var hC={dehydrated:null,treeContext:null,retryLane:0};function fC(e){return{baseLanes:e,cachePool:null,transitions:null}}function eV(e,t,r){var n=t.pendingProps,a=Rr.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),xr(Rr,a&1),e===null)return sC(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Q1(o,n,0,null),e=md(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=fC(r),t.memoizedState=hC,e):qP(t,o));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return Are(e,t,o,n,l,a,r);if(i){i=n.fallback,o=t.mode,a=e.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Fc(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=Fc(l,i):(i=md(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?fC(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=hC,n}return i=e.child,e=i.sibling,n=Fc(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function qP(e,t){return t=Q1({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ay(e,t,r,n){return n!==null&&TP(n),Gf(t,e.child,null,r),e=qP(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Are(e,t,r,n,a,i,o){if(r)return t.flags&256?(t.flags&=-257,n=V_(Error(Ee(422))),Ay(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Q1({mode:"visible",children:n.children},a,0,null),i=md(i,a,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Gf(t,e.child,null,o),t.child.memoizedState=fC(o),t.memoizedState=hC,i);if(!(t.mode&1))return Ay(e,t,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(Ee(419)),n=V_(i,n,void 0),Ay(e,t,o,n)}if(l=(o&e.childLanes)!==0,rs||l){if(n=qn,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Nl(e,a),Bi(n,e,a,-1))}return QP(),n=V_(Error(Ee(421))),Ay(e,t,o,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Vre.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Es=Ic(a.nextSibling),Rs=t,Ar=!0,Pi=null,e!==null&&(Ks[Ys++]=ol,Ks[Ys++]=ll,Ks[Ys++]=Nd,ol=e.id,ll=e.overflow,Nd=t),t=qP(t,n.children),t.flags|=4096,t)}function uD(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),iC(e.return,t,r)}function z_(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function tV(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Oa(e,t,n.children,r),n=Rr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&uD(e,r,t);else if(e.tag===19)uD(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(xr(Rr,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&b0(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),z_(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&b0(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}z_(t,!0,r,null,i);break;case"together":z_(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Bb(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function _l(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Sd|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ee(153));if(t.child!==null){for(e=t.child,r=Fc(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Fc(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Pre(e,t,r){switch(t.tag){case 3:JU(t),qf();break;case 5:EU(t);break;case 1:ss(t.type)&&p0(t);break;case 4:$P(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;xr(g0,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(xr(Rr,Rr.current&1),t.flags|=128,null):r&t.child.childLanes?eV(e,t,r):(xr(Rr,Rr.current&1),e=_l(e,t,r),e!==null?e.sibling:null);xr(Rr,Rr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return tV(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),xr(Rr,Rr.current),n)break;return null;case 22:case 23:return t.lanes=0,QU(e,t,r)}return _l(e,t,r)}var rV,pC,nV,aV;rV=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};pC=function(){};nV=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Gu(No.current);var i=null;switch(r){case"input":a=MS(e,a),n=MS(e,n),i=[];break;case"select":a=Fr({},a,{value:void 0}),n=Fr({},n,{value:void 0}),i=[];break;case"textarea":a=LS(e,a),n=LS(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=h0)}US(r,n);var o;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var l=a[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Vv.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(l=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Vv.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&jr("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};aV=function(e,t,r,n){r!==n&&(t.flags|=4)};function Om(e,t){if(!Ar)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function da(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Tre(e,t,r){var n=t.pendingProps;switch(PP(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return da(t),null;case 1:return ss(t.type)&&f0(),da(t),null;case 3:return n=t.stateNode,Hf(),Cr(as),Cr(_a),LP(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ey(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Pi!==null&&(jC(Pi),Pi=null))),pC(e,t),da(t),null;case 5:FP(t);var a=Gu(eg.current);if(r=t.type,e!==null&&t.stateNode!=null)nV(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ee(166));return da(t),null}if(e=Gu(No.current),Ey(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[po]=t,n[Zv]=i,e=(t.mode&1)!==0,r){case"dialog":jr("cancel",n),jr("close",n);break;case"iframe":case"object":case"embed":jr("load",n);break;case"video":case"audio":for(a=0;a<ov.length;a++)jr(ov[a],n);break;case"source":jr("error",n);break;case"img":case"image":case"link":jr("error",n),jr("load",n);break;case"details":jr("toggle",n);break;case"input":y4(n,i),jr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},jr("invalid",n);break;case"textarea":w4(n,i),jr("invalid",n)}US(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&Cy(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Cy(n.textContent,l,e),a=["children",""+l]):Vv.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&jr("scroll",n)}switch(r){case"input":xy(n),b4(n,i,!0);break;case"textarea":xy(n),j4(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=h0)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=R6(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[po]=t,e[Zv]=n,rV(e,t,!1,!1),t.stateNode=e;e:{switch(o=VS(r,n),r){case"dialog":jr("cancel",e),jr("close",e),a=n;break;case"iframe":case"object":case"embed":jr("load",e),a=n;break;case"video":case"audio":for(a=0;a<ov.length;a++)jr(ov[a],e);a=n;break;case"source":jr("error",e),a=n;break;case"img":case"image":case"link":jr("error",e),jr("load",e),a=n;break;case"details":jr("toggle",e),a=n;break;case"input":y4(e,n),a=MS(e,n),jr("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Fr({},n,{value:void 0}),jr("invalid",e);break;case"textarea":w4(e,n),a=LS(e,n),jr("invalid",e);break;default:a=n}US(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?D6(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&O6(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&zv(e,c):typeof c=="number"&&zv(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Vv.hasOwnProperty(i)?c!=null&&i==="onScroll"&&jr("scroll",e):c!=null&&mP(e,i,c,o))}switch(r){case"input":xy(e),b4(e,n,!1);break;case"textarea":xy(e),j4(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Kc(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?sf(e,!!n.multiple,i,!1):n.defaultValue!=null&&sf(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=h0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return da(t),null;case 6:if(e&&t.stateNode!=null)aV(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ee(166));if(r=Gu(eg.current),Gu(No.current),Ey(t)){if(n=t.stateNode,r=t.memoizedProps,n[po]=t,(i=n.nodeValue!==r)&&(e=Rs,e!==null))switch(e.tag){case 3:Cy(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Cy(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[po]=t,t.stateNode=n}return da(t),null;case 13:if(Cr(Rr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ar&&Es!==null&&t.mode&1&&!(t.flags&128))jU(),qf(),t.flags|=98560,i=!1;else if(i=Ey(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Ee(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ee(317));i[po]=t}else qf(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;da(t),i=!1}else Pi!==null&&(jC(Pi),Pi=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Rr.current&1?En===0&&(En=3):QP())),t.updateQueue!==null&&(t.flags|=4),da(t),null);case 4:return Hf(),pC(e,t),e===null&&Xv(t.stateNode.containerInfo),da(t),null;case 10:return IP(t.type._context),da(t),null;case 17:return ss(t.type)&&f0(),da(t),null;case 19:if(Cr(Rr),i=t.memoizedState,i===null)return da(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)Om(i,!1);else{if(En!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=b0(e),o!==null){for(t.flags|=128,Om(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return xr(Rr,Rr.current&1|2),t.child}e=e.sibling}i.tail!==null&&Jr()>Yf&&(t.flags|=128,n=!0,Om(i,!1),t.lanes=4194304)}else{if(!n)if(e=b0(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Om(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ar)return da(t),null}else 2*Jr()-i.renderingStartTime>Yf&&r!==1073741824&&(t.flags|=128,n=!0,Om(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Jr(),t.sibling=null,r=Rr.current,xr(Rr,n?r&1|2:r&1),t):(da(t),null);case 22:case 23:return XP(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?xs&1073741824&&(da(t),t.subtreeFlags&6&&(t.flags|=8192)):da(t),null;case 24:return null;case 25:return null}throw Error(Ee(156,t.tag))}function Rre(e,t){switch(PP(t),t.tag){case 1:return ss(t.type)&&f0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Hf(),Cr(as),Cr(_a),LP(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return FP(t),null;case 13:if(Cr(Rr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ee(340));qf()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Cr(Rr),null;case 4:return Hf(),null;case 10:return IP(t.type._context),null;case 22:case 23:return XP(),null;case 24:return null;default:return null}}var Py=!1,va=!1,Ore=typeof WeakSet=="function"?WeakSet:Set,We=null;function Jh(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Hr(e,t,n)}else r.current=null}function mC(e,t,r){try{r()}catch(n){Hr(e,t,n)}}var dD=!1;function Ire(e,t){if(ZS=c0,e=cU(),kP(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==r||a!==0&&h.nodeType!==3||(l=o+a),h!==i||n!==0&&h.nodeType!==3||(c=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===e)break t;if(f===r&&++u===a&&(l=o),f===i&&++d===n&&(c=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(JS={focusedElem:e,selectionRange:r},c0=!1,We=t;We!==null;)if(t=We,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,We=e;else for(;We!==null;){t=We;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var v=m.memoizedProps,g=m.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?v:ji(t.type,v),g);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ee(163))}}catch(N){Hr(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,We=e;break}We=t.return}return m=dD,dD=!1,m}function wv(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&mC(t,r,i)}a=a.next}while(a!==n)}}function Y1(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function vC(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function sV(e){var t=e.alternate;t!==null&&(e.alternate=null,sV(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[po],delete t[Zv],delete t[rC],delete t[vre],delete t[gre])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function iV(e){return e.tag===5||e.tag===3||e.tag===4}function hD(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||iV(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function gC(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=h0));else if(n!==4&&(e=e.child,e!==null))for(gC(e,t,r),e=e.sibling;e!==null;)gC(e,t,r),e=e.sibling}function xC(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(xC(e,t,r),e=e.sibling;e!==null;)xC(e,t,r),e=e.sibling}var Jn=null,Ci=!1;function Gl(e,t,r){for(r=r.child;r!==null;)oV(e,t,r),r=r.sibling}function oV(e,t,r){if(jo&&typeof jo.onCommitFiberUnmount=="function")try{jo.onCommitFiberUnmount(U1,r)}catch{}switch(r.tag){case 5:va||Jh(r,t);case 6:var n=Jn,a=Ci;Jn=null,Gl(e,t,r),Jn=n,Ci=a,Jn!==null&&(Ci?(e=Jn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Jn.removeChild(r.stateNode));break;case 18:Jn!==null&&(Ci?(e=Jn,r=r.stateNode,e.nodeType===8?M_(e.parentNode,r):e.nodeType===1&&M_(e,r),Hv(e)):M_(Jn,r.stateNode));break;case 4:n=Jn,a=Ci,Jn=r.stateNode.containerInfo,Ci=!0,Gl(e,t,r),Jn=n,Ci=a;break;case 0:case 11:case 14:case 15:if(!va&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&mC(r,t,o),a=a.next}while(a!==n)}Gl(e,t,r);break;case 1:if(!va&&(Jh(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Hr(r,t,l)}Gl(e,t,r);break;case 21:Gl(e,t,r);break;case 22:r.mode&1?(va=(n=va)||r.memoizedState!==null,Gl(e,t,r),va=n):Gl(e,t,r);break;default:Gl(e,t,r)}}function fD(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Ore),t.forEach(function(n){var a=zre.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function vi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Jn=l.stateNode,Ci=!1;break e;case 3:Jn=l.stateNode.containerInfo,Ci=!0;break e;case 4:Jn=l.stateNode.containerInfo,Ci=!0;break e}l=l.return}if(Jn===null)throw Error(Ee(160));oV(i,o,a),Jn=null,Ci=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){Hr(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)lV(t,e),t=t.sibling}function lV(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vi(t,e),ao(e),n&4){try{wv(3,e,e.return),Y1(3,e)}catch(v){Hr(e,e.return,v)}try{wv(5,e,e.return)}catch(v){Hr(e,e.return,v)}}break;case 1:vi(t,e),ao(e),n&512&&r!==null&&Jh(r,r.return);break;case 5:if(vi(t,e),ao(e),n&512&&r!==null&&Jh(r,r.return),e.flags&32){var a=e.stateNode;try{zv(a,"")}catch(v){Hr(e,e.return,v)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&P6(a,i),VS(l,o);var u=VS(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?D6(a,h):d==="dangerouslySetInnerHTML"?O6(a,h):d==="children"?zv(a,h):mP(a,d,h,u)}switch(l){case"input":$S(a,i);break;case"textarea":T6(a,i);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?sf(a,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?sf(a,!!i.multiple,i.defaultValue,!0):sf(a,!!i.multiple,i.multiple?[]:"",!1))}a[Zv]=i}catch(v){Hr(e,e.return,v)}}break;case 6:if(vi(t,e),ao(e),n&4){if(e.stateNode===null)throw Error(Ee(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(v){Hr(e,e.return,v)}}break;case 3:if(vi(t,e),ao(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Hv(t.containerInfo)}catch(v){Hr(e,e.return,v)}break;case 4:vi(t,e),ao(e);break;case 13:vi(t,e),ao(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(KP=Jr())),n&4&&fD(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(va=(u=va)||d,vi(t,e),va=u):vi(t,e),ao(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(We=e,d=e.child;d!==null;){for(h=We=d;We!==null;){switch(f=We,p=f.child,f.tag){case 0:case 11:case 14:case 15:wv(4,f,f.return);break;case 1:Jh(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(v){Hr(n,r,v)}}break;case 5:Jh(f,f.return);break;case 22:if(f.memoizedState!==null){mD(h);continue}}p!==null?(p.return=f,We=p):mD(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{a=h.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=I6("display",o))}catch(v){Hr(e,e.return,v)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(v){Hr(e,e.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:vi(t,e),ao(e),n&4&&fD(e);break;case 21:break;default:vi(t,e),ao(e)}}function ao(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(iV(r)){var n=r;break e}r=r.return}throw Error(Ee(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(zv(a,""),n.flags&=-33);var i=hD(e);xC(e,i,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=hD(e);gC(e,l,o);break;default:throw Error(Ee(161))}}catch(c){Hr(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Dre(e,t,r){We=e,cV(e)}function cV(e,t,r){for(var n=(e.mode&1)!==0;We!==null;){var a=We,i=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||Py;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||va;l=Py;var u=va;if(Py=o,(va=c)&&!u)for(We=a;We!==null;)o=We,c=o.child,o.tag===22&&o.memoizedState!==null?vD(a):c!==null?(c.return=o,We=c):vD(a);for(;i!==null;)We=i,cV(i),i=i.sibling;We=a,Py=l,va=u}pD(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,We=i):pD(e)}}function pD(e){for(;We!==null;){var t=We;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:va||Y1(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!va)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:ji(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Z4(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Z4(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Hv(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ee(163))}va||t.flags&512&&vC(t)}catch(f){Hr(t,t.return,f)}}if(t===e){We=null;break}if(r=t.sibling,r!==null){r.return=t.return,We=r;break}We=t.return}}function mD(e){for(;We!==null;){var t=We;if(t===e){We=null;break}var r=t.sibling;if(r!==null){r.return=t.return,We=r;break}We=t.return}}function vD(e){for(;We!==null;){var t=We;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Y1(4,t)}catch(c){Hr(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){Hr(t,a,c)}}var i=t.return;try{vC(t)}catch(c){Hr(t,i,c)}break;case 5:var o=t.return;try{vC(t)}catch(c){Hr(t,o,c)}}}catch(c){Hr(t,t.return,c)}if(t===e){We=null;break}var l=t.sibling;if(l!==null){l.return=t.return,We=l;break}We=t.return}}var Mre=Math.ceil,N0=Il.ReactCurrentDispatcher,GP=Il.ReactCurrentOwner,ni=Il.ReactCurrentBatchConfig,Qt=0,qn=null,un=null,sa=0,xs=0,ef=iu(0),En=0,ag=null,Sd=0,X1=0,HP=0,jv=null,Ja=null,KP=0,Yf=1/0,el=null,_0=!1,yC=null,Mc=null,Ty=!1,jc=null,S0=0,Nv=0,bC=null,Ub=-1,Vb=0;function La(){return Qt&6?Jr():Ub!==-1?Ub:Ub=Jr()}function $c(e){return e.mode&1?Qt&2&&sa!==0?sa&-sa:yre.transition!==null?(Vb===0&&(Vb=H6()),Vb):(e=or,e!==0||(e=window.event,e=e===void 0?16:eU(e.type)),e):1}function Bi(e,t,r,n){if(50<Nv)throw Nv=0,bC=null,Error(Ee(185));gx(e,r,n),(!(Qt&2)||e!==qn)&&(e===qn&&(!(Qt&2)&&(X1|=r),En===4&&lc(e,sa)),is(e,n),r===1&&Qt===0&&!(t.mode&1)&&(Yf=Jr()+500,G1&&ou()))}function is(e,t){var r=e.callbackNode;yte(e,t);var n=l0(e,e===qn?sa:0);if(n===0)r!==null&&S4(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&S4(r),t===1)e.tag===0?xre(gD.bind(null,e)):yU(gD.bind(null,e)),pre(function(){!(Qt&6)&&ou()}),r=null;else{switch(K6(n)){case 1:r=bP;break;case 4:r=q6;break;case 16:r=o0;break;case 536870912:r=G6;break;default:r=o0}r=gV(r,uV.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function uV(e,t){if(Ub=-1,Vb=0,Qt&6)throw Error(Ee(327));var r=e.callbackNode;if(df()&&e.callbackNode!==r)return null;var n=l0(e,e===qn?sa:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=C0(e,n);else{t=n;var a=Qt;Qt|=2;var i=hV();(qn!==e||sa!==t)&&(el=null,Yf=Jr()+500,pd(e,t));do try{Lre();break}catch(l){dV(e,l)}while(!0);OP(),N0.current=i,Qt=a,un!==null?t=0:(qn=null,sa=0,t=En)}if(t!==0){if(t===2&&(a=HS(e),a!==0&&(n=a,t=wC(e,a))),t===1)throw r=ag,pd(e,0),lc(e,n),is(e,Jr()),r;if(t===6)lc(e,n);else{if(a=e.current.alternate,!(n&30)&&!$re(a)&&(t=C0(e,n),t===2&&(i=HS(e),i!==0&&(n=i,t=wC(e,i))),t===1))throw r=ag,pd(e,0),lc(e,n),is(e,Jr()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Ee(345));case 2:Ru(e,Ja,el);break;case 3:if(lc(e,n),(n&130023424)===n&&(t=KP+500-Jr(),10<t)){if(l0(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){La(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=tC(Ru.bind(null,e,Ja,el),t);break}Ru(e,Ja,el);break;case 4:if(lc(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-Li(n);i=1<<o,o=t[o],o>a&&(a=o),n&=~i}if(n=a,n=Jr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Mre(n/1960))-n,10<n){e.timeoutHandle=tC(Ru.bind(null,e,Ja,el),n);break}Ru(e,Ja,el);break;case 5:Ru(e,Ja,el);break;default:throw Error(Ee(329))}}}return is(e,Jr()),e.callbackNode===r?uV.bind(null,e):null}function wC(e,t){var r=jv;return e.current.memoizedState.isDehydrated&&(pd(e,t).flags|=256),e=C0(e,t),e!==2&&(t=Ja,Ja=r,t!==null&&jC(t)),e}function jC(e){Ja===null?Ja=e:Ja.push.apply(Ja,e)}function $re(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Vi(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function lc(e,t){for(t&=~HP,t&=~X1,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Li(t),n=1<<r;e[r]=-1,t&=~n}}function gD(e){if(Qt&6)throw Error(Ee(327));df();var t=l0(e,0);if(!(t&1))return is(e,Jr()),null;var r=C0(e,t);if(e.tag!==0&&r===2){var n=HS(e);n!==0&&(t=n,r=wC(e,n))}if(r===1)throw r=ag,pd(e,0),lc(e,t),is(e,Jr()),r;if(r===6)throw Error(Ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ru(e,Ja,el),is(e,Jr()),null}function YP(e,t){var r=Qt;Qt|=1;try{return e(t)}finally{Qt=r,Qt===0&&(Yf=Jr()+500,G1&&ou())}}function Cd(e){jc!==null&&jc.tag===0&&!(Qt&6)&&df();var t=Qt;Qt|=1;var r=ni.transition,n=or;try{if(ni.transition=null,or=1,e)return e()}finally{or=n,ni.transition=r,Qt=t,!(Qt&6)&&ou()}}function XP(){xs=ef.current,Cr(ef)}function pd(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,fre(r)),un!==null)for(r=un.return;r!==null;){var n=r;switch(PP(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&f0();break;case 3:Hf(),Cr(as),Cr(_a),LP();break;case 5:FP(n);break;case 4:Hf();break;case 13:Cr(Rr);break;case 19:Cr(Rr);break;case 10:IP(n.type._context);break;case 22:case 23:XP()}r=r.return}if(qn=e,un=e=Fc(e.current,null),sa=xs=t,En=0,ag=null,HP=X1=Sd=0,Ja=jv=null,qu!==null){for(t=0;t<qu.length;t++)if(r=qu[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,n.next=o}r.pending=n}qu=null}return e}function dV(e,t){do{var r=un;try{if(OP(),Fb.current=j0,w0){for(var n=$r.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}w0=!1}if(_d=0,zn=_n=$r=null,bv=!1,tg=0,GP.current=null,r===null||r.return===null){En=1,ag=t,un=null;break}e:{var i=e,o=r.return,l=r,c=t;if(t=sa,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=aD(o);if(p!==null){p.flags&=-257,sD(p,o,l,i,t),p.mode&1&&nD(i,u,t),t=p,c=u;var m=t.updateQueue;if(m===null){var v=new Set;v.add(c),t.updateQueue=v}else m.add(c);break e}else{if(!(t&1)){nD(i,u,t),QP();break e}c=Error(Ee(426))}}else if(Ar&&l.mode&1){var g=aD(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),sD(g,o,l,i,t),TP(Kf(c,l));break e}}i=c=Kf(c,l),En!==4&&(En=2),jv===null?jv=[i]:jv.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=KU(i,c,t);Q4(i,x);break e;case 1:l=c;var y=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Mc===null||!Mc.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var N=YU(i,l,t);Q4(i,N);break e}}i=i.return}while(i!==null)}pV(r)}catch(j){t=j,un===r&&r!==null&&(un=r=r.return);continue}break}while(!0)}function hV(){var e=N0.current;return N0.current=j0,e===null?j0:e}function QP(){(En===0||En===3||En===2)&&(En=4),qn===null||!(Sd&268435455)&&!(X1&268435455)||lc(qn,sa)}function C0(e,t){var r=Qt;Qt|=2;var n=hV();(qn!==e||sa!==t)&&(el=null,pd(e,t));do try{Fre();break}catch(a){dV(e,a)}while(!0);if(OP(),Qt=r,N0.current=n,un!==null)throw Error(Ee(261));return qn=null,sa=0,En}function Fre(){for(;un!==null;)fV(un)}function Lre(){for(;un!==null&&!ute();)fV(un)}function fV(e){var t=vV(e.alternate,e,xs);e.memoizedProps=e.pendingProps,t===null?pV(e):un=t,GP.current=null}function pV(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Rre(r,t),r!==null){r.flags&=32767,un=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{En=6,un=null;return}}else if(r=Tre(r,t,xs),r!==null){un=r;return}if(t=t.sibling,t!==null){un=t;return}un=t=e}while(t!==null);En===0&&(En=5)}function Ru(e,t,r){var n=or,a=ni.transition;try{ni.transition=null,or=1,Bre(e,t,r,n)}finally{ni.transition=a,or=n}return null}function Bre(e,t,r,n){do df();while(jc!==null);if(Qt&6)throw Error(Ee(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ee(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(bte(e,i),e===qn&&(un=qn=null,sa=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ty||(Ty=!0,gV(o0,function(){return df(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=ni.transition,ni.transition=null;var o=or;or=1;var l=Qt;Qt|=4,GP.current=null,Ire(e,r),lV(r,e),ire(JS),c0=!!ZS,JS=ZS=null,e.current=r,Dre(r),dte(),Qt=l,or=o,ni.transition=i}else e.current=r;if(Ty&&(Ty=!1,jc=e,S0=a),i=e.pendingLanes,i===0&&(Mc=null),pte(r.stateNode),is(e,Jr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(_0)throw _0=!1,e=yC,yC=null,e;return S0&1&&e.tag!==0&&df(),i=e.pendingLanes,i&1?e===bC?Nv++:(Nv=0,bC=e):Nv=0,ou(),null}function df(){if(jc!==null){var e=K6(S0),t=ni.transition,r=or;try{if(ni.transition=null,or=16>e?16:e,jc===null)var n=!1;else{if(e=jc,jc=null,S0=0,Qt&6)throw Error(Ee(331));var a=Qt;for(Qt|=4,We=e.current;We!==null;){var i=We,o=i.child;if(We.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(We=u;We!==null;){var d=We;switch(d.tag){case 0:case 11:case 15:wv(8,d,i)}var h=d.child;if(h!==null)h.return=d,We=h;else for(;We!==null;){d=We;var f=d.sibling,p=d.return;if(sV(d),d===u){We=null;break}if(f!==null){f.return=p,We=f;break}We=p}}}var m=i.alternate;if(m!==null){var v=m.child;if(v!==null){m.child=null;do{var g=v.sibling;v.sibling=null,v=g}while(v!==null)}}We=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,We=o;else e:for(;We!==null;){if(i=We,i.flags&2048)switch(i.tag){case 0:case 11:case 15:wv(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,We=x;break e}We=i.return}}var y=e.current;for(We=y;We!==null;){o=We;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,We=b;else e:for(o=y;We!==null;){if(l=We,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Y1(9,l)}}catch(j){Hr(l,l.return,j)}if(l===o){We=null;break e}var N=l.sibling;if(N!==null){N.return=l.return,We=N;break e}We=l.return}}if(Qt=a,ou(),jo&&typeof jo.onPostCommitFiberRoot=="function")try{jo.onPostCommitFiberRoot(U1,e)}catch{}n=!0}return n}finally{or=r,ni.transition=t}}return!1}function xD(e,t,r){t=Kf(r,t),t=KU(e,t,1),e=Dc(e,t,1),t=La(),e!==null&&(gx(e,1,t),is(e,t))}function Hr(e,t,r){if(e.tag===3)xD(e,e,r);else for(;t!==null;){if(t.tag===3){xD(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Mc===null||!Mc.has(n))){e=Kf(r,e),e=YU(t,e,1),t=Dc(t,e,1),e=La(),t!==null&&(gx(t,1,e),is(t,e));break}}t=t.return}}function Ure(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=La(),e.pingedLanes|=e.suspendedLanes&r,qn===e&&(sa&r)===r&&(En===4||En===3&&(sa&130023424)===sa&&500>Jr()-KP?pd(e,0):HP|=r),is(e,t)}function mV(e,t){t===0&&(e.mode&1?(t=wy,wy<<=1,!(wy&130023424)&&(wy=4194304)):t=1);var r=La();e=Nl(e,t),e!==null&&(gx(e,t,r),is(e,r))}function Vre(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),mV(e,r)}function zre(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ee(314))}n!==null&&n.delete(t),mV(e,r)}var vV;vV=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||as.current)rs=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return rs=!1,Pre(e,t,r);rs=!!(e.flags&131072)}else rs=!1,Ar&&t.flags&1048576&&bU(t,v0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Bb(e,t),e=t.pendingProps;var a=Wf(t,_a.current);uf(t,r),a=UP(null,t,n,e,a,r);var i=VP();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ss(n)?(i=!0,p0(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,MP(t),a.updater=K1,t.stateNode=a,a._reactInternals=t,lC(t,n,e,r),t=dC(null,t,n,!0,i,r)):(t.tag=0,Ar&&i&&AP(t),Oa(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Bb(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=qre(n),e=ji(n,e),a){case 0:t=uC(null,t,n,e,r);break e;case 1:t=lD(null,t,n,e,r);break e;case 11:t=iD(null,t,n,e,r);break e;case 14:t=oD(null,t,n,ji(n.type,e),r);break e}throw Error(Ee(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ji(n,a),uC(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ji(n,a),lD(e,t,n,a,r);case 3:e:{if(JU(t),e===null)throw Error(Ee(387));n=t.pendingProps,i=t.memoizedState,a=i.element,CU(e,t),y0(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Kf(Error(Ee(423)),t),t=cD(e,t,n,r,a);break e}else if(n!==a){a=Kf(Error(Ee(424)),t),t=cD(e,t,n,r,a);break e}else for(Es=Ic(t.stateNode.containerInfo.firstChild),Rs=t,Ar=!0,Pi=null,r=_U(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(qf(),n===a){t=_l(e,t,r);break e}Oa(e,t,n,r)}t=t.child}return t;case 5:return EU(t),e===null&&sC(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,o=a.children,eC(n,a)?o=null:i!==null&&eC(n,i)&&(t.flags|=32),ZU(e,t),Oa(e,t,o,r),t.child;case 6:return e===null&&sC(t),null;case 13:return eV(e,t,r);case 4:return $P(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Gf(t,null,n,r):Oa(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ji(n,a),iD(e,t,n,a,r);case 7:return Oa(e,t,t.pendingProps,r),t.child;case 8:return Oa(e,t,t.pendingProps.children,r),t.child;case 12:return Oa(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,xr(g0,n._currentValue),n._currentValue=o,i!==null)if(Vi(i.value,o)){if(i.children===a.children&&!as.current){t=_l(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=fl(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),iC(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Ee(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),iC(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Oa(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,uf(t,r),a=li(a),n=n(a),t.flags|=1,Oa(e,t,n,r),t.child;case 14:return n=t.type,a=ji(n,t.pendingProps),a=ji(n.type,a),oD(e,t,n,a,r);case 15:return XU(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ji(n,a),Bb(e,t),t.tag=1,ss(n)?(e=!0,p0(t)):e=!1,uf(t,r),HU(t,n,a),lC(t,n,a,r),dC(null,t,n,!0,e,r);case 19:return tV(e,t,r);case 22:return QU(e,t,r)}throw Error(Ee(156,t.tag))};function gV(e,t){return W6(e,t)}function Wre(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Js(e,t,r,n){return new Wre(e,t,r,n)}function ZP(e){return e=e.prototype,!(!e||!e.isReactComponent)}function qre(e){if(typeof e=="function")return ZP(e)?1:0;if(e!=null){if(e=e.$$typeof,e===gP)return 11;if(e===xP)return 14}return 2}function Fc(e,t){var r=e.alternate;return r===null?(r=Js(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function zb(e,t,r,n,a,i){var o=2;if(n=e,typeof e=="function")ZP(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Wh:return md(r.children,a,i,t);case vP:o=8,a|=8;break;case RS:return e=Js(12,r,t,a|2),e.elementType=RS,e.lanes=i,e;case OS:return e=Js(13,r,t,a),e.elementType=OS,e.lanes=i,e;case IS:return e=Js(19,r,t,a),e.elementType=IS,e.lanes=i,e;case E6:return Q1(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case S6:o=10;break e;case C6:o=9;break e;case gP:o=11;break e;case xP:o=14;break e;case rc:o=16,n=null;break e}throw Error(Ee(130,e==null?e:typeof e,""))}return t=Js(o,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function md(e,t,r,n){return e=Js(7,e,n,t),e.lanes=r,e}function Q1(e,t,r,n){return e=Js(22,e,n,t),e.elementType=E6,e.lanes=r,e.stateNode={isHidden:!1},e}function W_(e,t,r){return e=Js(6,e,null,t),e.lanes=r,e}function q_(e,t,r){return t=Js(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Gre(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=S_(0),this.expirationTimes=S_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=S_(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function JP(e,t,r,n,a,i,o,l,c){return e=new Gre(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Js(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},MP(i),e}function Hre(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zh,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function xV(e){if(!e)return Yc;e=e._reactInternals;e:{if(Kd(e)!==e||e.tag!==1)throw Error(Ee(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ss(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ee(171))}if(e.tag===1){var r=e.type;if(ss(r))return xU(e,r,t)}return t}function yV(e,t,r,n,a,i,o,l,c){return e=JP(r,n,!0,e,a,i,o,l,c),e.context=xV(null),r=e.current,n=La(),a=$c(r),i=fl(n,a),i.callback=t??null,Dc(r,i,a),e.current.lanes=a,gx(e,a,n),is(e,n),e}function Z1(e,t,r,n){var a=t.current,i=La(),o=$c(a);return r=xV(r),t.context===null?t.context=r:t.pendingContext=r,t=fl(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Dc(a,t,o),e!==null&&(Bi(e,a,o,i),$b(e,a,o)),o}function E0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function yD(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function eT(e,t){yD(e,t),(e=e.alternate)&&yD(e,t)}function Kre(){return null}var bV=typeof reportError=="function"?reportError:function(e){console.error(e)};function tT(e){this._internalRoot=e}J1.prototype.render=tT.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ee(409));Z1(e,t,null,null)};J1.prototype.unmount=tT.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Cd(function(){Z1(null,e,null,null)}),t[jl]=null}};function J1(e){this._internalRoot=e}J1.prototype.unstable_scheduleHydration=function(e){if(e){var t=Q6();e={blockedOn:null,target:e,priority:t};for(var r=0;r<oc.length&&t!==0&&t<oc[r].priority;r++);oc.splice(r,0,e),r===0&&J6(e)}};function rT(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ej(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function bD(){}function Yre(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var u=E0(o);i.call(u)}}var o=yV(t,n,e,0,null,!1,!1,"",bD);return e._reactRootContainer=o,e[jl]=o.current,Xv(e.nodeType===8?e.parentNode:e),Cd(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var u=E0(c);l.call(u)}}var c=JP(e,0,!1,null,null,!1,!1,"",bD);return e._reactRootContainer=c,e[jl]=c.current,Xv(e.nodeType===8?e.parentNode:e),Cd(function(){Z1(t,c,r,n)}),c}function tj(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var l=a;a=function(){var c=E0(o);l.call(c)}}Z1(t,o,e,a)}else o=Yre(r,t,e,a,n);return E0(o)}Y6=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=iv(t.pendingLanes);r!==0&&(wP(t,r|1),is(t,Jr()),!(Qt&6)&&(Yf=Jr()+500,ou()))}break;case 13:Cd(function(){var n=Nl(e,1);if(n!==null){var a=La();Bi(n,e,1,a)}}),eT(e,1)}};jP=function(e){if(e.tag===13){var t=Nl(e,134217728);if(t!==null){var r=La();Bi(t,e,134217728,r)}eT(e,134217728)}};X6=function(e){if(e.tag===13){var t=$c(e),r=Nl(e,t);if(r!==null){var n=La();Bi(r,e,t,n)}eT(e,t)}};Q6=function(){return or};Z6=function(e,t){var r=or;try{return or=e,t()}finally{or=r}};WS=function(e,t,r){switch(t){case"input":if($S(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=q1(n);if(!a)throw Error(Ee(90));A6(n),$S(n,a)}}}break;case"textarea":T6(e,r);break;case"select":t=r.value,t!=null&&sf(e,!!r.multiple,t,!1)}};F6=YP;L6=Cd;var Xre={usingClientEntryPoint:!1,Events:[yx,Kh,q1,M6,$6,YP]},Im={findFiberByHostInstance:Wu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Qre={bundleType:Im.bundleType,version:Im.version,rendererPackageName:Im.rendererPackageName,rendererConfig:Im.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Il.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=V6(e),e===null?null:e.stateNode},findFiberByHostInstance:Im.findFiberByHostInstance||Kre,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ry=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ry.isDisabled&&Ry.supportsFiber)try{U1=Ry.inject(Qre),jo=Ry}catch{}}$s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xre;$s.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rT(t))throw Error(Ee(200));return Hre(e,t,null,r)};$s.createRoot=function(e,t){if(!rT(e))throw Error(Ee(299));var r=!1,n="",a=bV;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=JP(e,1,!1,null,null,r,!1,n,a),e[jl]=t.current,Xv(e.nodeType===8?e.parentNode:e),new tT(t)};$s.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ee(188)):(e=Object.keys(e).join(","),Error(Ee(268,e)));return e=V6(t),e=e===null?null:e.stateNode,e};$s.flushSync=function(e){return Cd(e)};$s.hydrate=function(e,t,r){if(!ej(t))throw Error(Ee(200));return tj(null,e,t,!0,r)};$s.hydrateRoot=function(e,t,r){if(!rT(e))throw Error(Ee(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",o=bV;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=yV(t,null,e,1,r??null,a,!1,i,o),e[jl]=t.current,Xv(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new J1(t)};$s.render=function(e,t,r){if(!ej(t))throw Error(Ee(200));return tj(null,e,t,!1,r)};$s.unmountComponentAtNode=function(e){if(!ej(e))throw Error(Ee(40));return e._reactRootContainer?(Cd(function(){tj(null,null,e,!1,function(){e._reactRootContainer=null,e[jl]=null})}),!0):!1};$s.unstable_batchedUpdates=YP;$s.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!ej(r))throw Error(Ee(200));if(e==null||e._reactInternals===void 0)throw Error(Ee(38));return tj(e,t,r,!1,n)};$s.version="18.3.1-next-f1338f8080-20240426";function wV(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(wV)}catch(e){console.error(e)}}wV(),w6.exports=$s;var ei=w6.exports;const jV=lr(ei);var NV,wD=ei;NV=wD.createRoot,wD.hydrateRoot;var k0=["light","dark"],nT="(prefers-color-scheme: dark)",Zre=typeof window>"u",aT=w.createContext(void 0),Jre={setTheme:e=>{},themes:[]},_V=()=>{var e;return(e=w.useContext(aT))!=null?e:Jre},ene=e=>w.useContext(aT)?e.children:w.createElement(rne,{...e}),tne=["light","dark"],rne=({forcedTheme:e,disableTransitionOnChange:t=!1,enableSystem:r=!0,enableColorScheme:n=!0,storageKey:a="theme",themes:i=tne,defaultTheme:o=r?"system":"light",attribute:l="data-theme",value:c,children:u,nonce:d})=>{let[h,f]=w.useState(()=>jD(a,o)),[p,m]=w.useState(()=>jD(a)),v=c?Object.values(c):i,g=w.useCallback(N=>{let j=N;if(!j)return;N==="system"&&r&&(j=ND());let _=c?c[j]:j,S=t?ane():null,C=document.documentElement;if(l==="class"?(C.classList.remove(...v),_&&C.classList.add(_)):_?C.setAttribute(l,_):C.removeAttribute(l),n){let E=k0.includes(o)?o:null,k=k0.includes(j)?j:E;C.style.colorScheme=k}S==null||S()},[]),x=w.useCallback(N=>{let j=typeof N=="function"?N(N):N;f(j);try{localStorage.setItem(a,j)}catch{}},[e]),y=w.useCallback(N=>{let j=ND(N);m(j),h==="system"&&r&&!e&&g("system")},[h,e]);w.useEffect(()=>{let N=window.matchMedia(nT);return N.addListener(y),y(N),()=>N.removeListener(y)},[y]),w.useEffect(()=>{let N=j=>{if(j.key!==a)return;let _=j.newValue||o;x(_)};return window.addEventListener("storage",N),()=>window.removeEventListener("storage",N)},[x]),w.useEffect(()=>{g(e??h)},[e,h]);let b=w.useMemo(()=>({theme:h,setTheme:x,forcedTheme:e,resolvedTheme:h==="system"?p:h,themes:r?[...i,"system"]:i,systemTheme:r?p:void 0}),[h,x,e,p,r,i]);return w.createElement(aT.Provider,{value:b},w.createElement(nne,{forcedTheme:e,disableTransitionOnChange:t,enableSystem:r,enableColorScheme:n,storageKey:a,themes:i,defaultTheme:o,attribute:l,value:c,children:u,attrs:v,nonce:d}),u)},nne=w.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:i,value:o,attrs:l,nonce:c})=>{let u=i==="system",d=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${l.map(m=>`'${m}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,h=a?k0.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(m,v=!1,g=!0)=>{let x=o?o[m]:m,y=v?m+"|| ''":`'${x}'`,b="";return a&&g&&!v&&k0.includes(m)&&(b+=`d.style.colorScheme = '${m}';`),r==="class"?v||x?b+=`c.add(${y})`:b+="null":x&&(b+=`d[s](n,${y})`),b},p=e?`!function(){${d}${f(e)}}()`:n?`!function(){try{${d}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${u})){var t='${nT}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}${u?"":"else{"+f(i,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${d}var e=localStorage.getItem('${t}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${h}}catch(t){}}();`;return w.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:p}})}),jD=(e,t)=>{if(Zre)return;let r;try{r=localStorage.getItem(e)||void 0}catch{}return r||t},ane=()=>{let e=document.createElement("style");return e.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(e),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(e)},1)}},ND=e=>(e||(e=window.matchMedia(nT)),e.matches?"dark":"light");const sne=1,ine=1e6;let G_=0;function one(){return G_=(G_+1)%Number.MAX_SAFE_INTEGER,G_.toString()}const H_=new Map,_D=e=>{if(H_.has(e))return;const t=setTimeout(()=>{H_.delete(e),_v({type:"REMOVE_TOAST",toastId:e})},ine);H_.set(e,t)},lne=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,sne)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?_D(r):e.toasts.forEach(n=>{_D(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},Wb=[];let qb={toasts:[]};function _v(e){qb=lne(qb,e),Wb.forEach(t=>{t(qb)})}function cne({...e}){const t=one(),r=a=>_v({type:"UPDATE_TOAST",toast:{...a,id:t}}),n=()=>_v({type:"DISMISS_TOAST",toastId:t});return _v({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:a=>{a||n()}}}),{id:t,dismiss:n,update:r}}function Et(){const[e,t]=w.useState(qb);return w.useEffect(()=>(Wb.push(t),()=>{const r=Wb.indexOf(t);r>-1&&Wb.splice(r,1)}),[e]),{...e,toast:cne,dismiss:r=>_v({type:"DISMISS_TOAST",toastId:r})}}function Ne(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function SD(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Sl(...e){return t=>{let r=!1;const n=e.map(a=>{const i=SD(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():SD(e[a],null)}}}}function ct(...e){return w.useCallback(Sl(...e),e)}function une(e,t){const r=w.createContext(t),n=i=>{const{children:o,...l}=i,c=w.useMemo(()=>l,Object.values(l));return s.jsx(r.Provider,{value:c,children:o})};n.displayName=e+"Provider";function a(i){const o=w.useContext(r);if(o)return o;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[n,a]}function an(e,t=[]){let r=[];function n(i,o){const l=w.createContext(o),c=r.length;r=[...r,o];const u=h=>{var x;const{scope:f,children:p,...m}=h,v=((x=f==null?void 0:f[e])==null?void 0:x[c])||l,g=w.useMemo(()=>m,Object.values(m));return s.jsx(v.Provider,{value:g,children:p})};u.displayName=i+"Provider";function d(h,f){var v;const p=((v=f==null?void 0:f[e])==null?void 0:v[c])||l,m=w.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const a=()=>{const i=r.map(o=>w.createContext(o));return function(l){const c=(l==null?void 0:l[e])||i;return w.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return a.scopeName=e,[n,dne(a,...t)]}function dne(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return w.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function Xc(e){const t=hne(e),r=w.forwardRef((n,a)=>{const{children:i,...o}=n,l=w.Children.toArray(i),c=l.find(fne);if(c){const u=c.props.children,d=l.map(h=>h===c?w.Children.count(u)>1?w.Children.only(null):w.isValidElement(u)?u.props.children:null:h);return s.jsx(t,{...o,ref:a,children:w.isValidElement(u)?w.cloneElement(u,void 0,d):null})}return s.jsx(t,{...o,ref:a,children:i})});return r.displayName=`${e}.Slot`,r}var SV=Xc("Slot");function hne(e){const t=w.forwardRef((r,n)=>{const{children:a,...i}=r;if(w.isValidElement(a)){const o=mne(a),l=pne(i,a.props);return a.type!==w.Fragment&&(l.ref=n?Sl(n,o):o),w.cloneElement(a,l)}return w.Children.count(a)>1?w.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var CV=Symbol("radix.slottable");function EV(e){const t=({children:r})=>s.jsx(s.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=CV,t}function fne(e){return w.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===CV}function pne(e,t){const r={...t};for(const n in t){const a=e[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{const c=i(...l);return a(...l),c}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...e,...r}}function mne(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function wx(e){const t=e+"CollectionProvider",[r,n]=an(t),[a,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),o=v=>{const{scope:g,children:x}=v,y=F.useRef(null),b=F.useRef(new Map).current;return s.jsx(a,{scope:g,itemMap:b,collectionRef:y,children:x})};o.displayName=t;const l=e+"CollectionSlot",c=Xc(l),u=F.forwardRef((v,g)=>{const{scope:x,children:y}=v,b=i(l,x),N=ct(g,b.collectionRef);return s.jsx(c,{ref:N,children:y})});u.displayName=l;const d=e+"CollectionItemSlot",h="data-radix-collection-item",f=Xc(d),p=F.forwardRef((v,g)=>{const{scope:x,children:y,...b}=v,N=F.useRef(null),j=ct(g,N),_=i(d,x);return F.useEffect(()=>(_.itemMap.set(N,{ref:N,...b}),()=>void _.itemMap.delete(N))),s.jsx(f,{[h]:"",ref:j,children:y})});p.displayName=d;function m(v){const g=i(e+"CollectionConsumer",v);return F.useCallback(()=>{const y=g.collectionRef.current;if(!y)return[];const b=Array.from(y.querySelectorAll(`[${h}]`));return Array.from(g.itemMap.values()).sort((_,S)=>b.indexOf(_.ref.current)-b.indexOf(S.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:o,Slot:u,ItemSlot:p},m,n]}var vne=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Me=vne.reduce((e,t)=>{const r=Xc(`Primitive.${t}`),n=w.forwardRef((a,i)=>{const{asChild:o,...l}=a,c=o?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(c,{...l,ref:i})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function sT(e,t){e&&ei.flushSync(()=>e.dispatchEvent(t))}function Yr(e){const t=w.useRef(e);return w.useEffect(()=>{t.current=e}),w.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function gne(e,t=globalThis==null?void 0:globalThis.document){const r=Yr(e);w.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var xne="DismissableLayer",NC="dismissableLayer.update",yne="dismissableLayer.pointerDownOutside",bne="dismissableLayer.focusOutside",CD,kV=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Yd=w.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=e,u=w.useContext(kV),[d,h]=w.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=w.useState({}),m=ct(t,S=>h(S)),v=Array.from(u.layers),[g]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),x=v.indexOf(g),y=d?v.indexOf(d):-1,b=u.layersWithOutsidePointerEventsDisabled.size>0,N=y>=x,j=jne(S=>{const C=S.target,E=[...u.branches].some(k=>k.contains(C));!N||E||(a==null||a(S),o==null||o(S),S.defaultPrevented||l==null||l())},f),_=Nne(S=>{const C=S.target;[...u.branches].some(k=>k.contains(C))||(i==null||i(S),o==null||o(S),S.defaultPrevented||l==null||l())},f);return gne(S=>{y===u.layers.size-1&&(n==null||n(S),!S.defaultPrevented&&l&&(S.preventDefault(),l()))},f),w.useEffect(()=>{if(d)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(CD=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),ED(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=CD)}},[d,f,r,u]),w.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),ED())},[d,u]),w.useEffect(()=>{const S=()=>p({});return document.addEventListener(NC,S),()=>document.removeEventListener(NC,S)},[]),s.jsx(Me.div,{...c,ref:m,style:{pointerEvents:b?N?"auto":"none":void 0,...e.style},onFocusCapture:Ne(e.onFocusCapture,_.onFocusCapture),onBlurCapture:Ne(e.onBlurCapture,_.onBlurCapture),onPointerDownCapture:Ne(e.onPointerDownCapture,j.onPointerDownCapture)})});Yd.displayName=xne;var wne="DismissableLayerBranch",AV=w.forwardRef((e,t)=>{const r=w.useContext(kV),n=w.useRef(null),a=ct(t,n);return w.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),s.jsx(Me.div,{...e,ref:a})});AV.displayName=wne;function jne(e,t=globalThis==null?void 0:globalThis.document){const r=Yr(e),n=w.useRef(!1),a=w.useRef(()=>{});return w.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let c=function(){PV(yne,r,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",i),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function Nne(e,t=globalThis==null?void 0:globalThis.document){const r=Yr(e),n=w.useRef(!1);return w.useEffect(()=>{const a=i=>{i.target&&!n.current&&PV(bne,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function ED(){const e=new CustomEvent(NC);document.dispatchEvent(e)}function PV(e,t,r,{discrete:n}){const a=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?sT(a,i):a.dispatchEvent(i)}var _ne=Yd,Sne=AV,Xr=globalThis!=null&&globalThis.document?w.useLayoutEffect:()=>{},Cne="Portal",Vp=w.forwardRef((e,t)=>{var l;const{container:r,...n}=e,[a,i]=w.useState(!1);Xr(()=>i(!0),[]);const o=r||a&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?jV.createPortal(s.jsx(Me.div,{...n,ref:t}),o):null});Vp.displayName=Cne;function Ene(e,t){return w.useReducer((r,n)=>t[r][n]??r,e)}var gn=e=>{const{present:t,children:r}=e,n=kne(t),a=typeof r=="function"?r({present:n.isPresent}):w.Children.only(r),i=ct(n.ref,Ane(a));return typeof r=="function"||n.isPresent?w.cloneElement(a,{ref:i}):null};gn.displayName="Presence";function kne(e){const[t,r]=w.useState(),n=w.useRef(null),a=w.useRef(e),i=w.useRef("none"),o=e?"mounted":"unmounted",[l,c]=Ene(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return w.useEffect(()=>{const u=Oy(n.current);i.current=l==="mounted"?u:"none"},[l]),Xr(()=>{const u=n.current,d=a.current;if(d!==e){const f=i.current,p=Oy(u);e?c("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&f!==p?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,c]),Xr(()=>{if(t){let u;const d=t.ownerDocument.defaultView??window,h=p=>{const v=Oy(n.current).includes(p.animationName);if(p.target===t&&v&&(c("ANIMATION_END"),!a.current)){const g=t.style.animationFillMode;t.style.animationFillMode="forwards",u=d.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=g)})}},f=p=>{p.target===t&&(i.current=Oy(n.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{d.clearTimeout(u),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:w.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function Oy(e){return(e==null?void 0:e.animationName)||"none"}function Ane(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var Pne=hP[" useInsertionEffect ".trim().toString()]||Xr;function Ba({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[a,i,o]=Tne({defaultProp:t,onChange:r}),l=e!==void 0,c=l?e:a;{const d=w.useRef(e!==void 0);w.useEffect(()=>{const h=d.current;h!==l&&console.warn(`${n} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,n])}const u=w.useCallback(d=>{var h;if(l){const f=Rne(d)?d(e):d;f!==e&&((h=o.current)==null||h.call(o,f))}else i(d)},[l,e,i,o]);return[c,u]}function Tne({defaultProp:e,onChange:t}){const[r,n]=w.useState(e),a=w.useRef(r),i=w.useRef(t);return Pne(()=>{i.current=t},[t]),w.useEffect(()=>{var o;a.current!==r&&((o=i.current)==null||o.call(i,r),a.current=r)},[r,a]),[r,n,i]}function Rne(e){return typeof e=="function"}var TV=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),One="VisuallyHidden",rj=w.forwardRef((e,t)=>s.jsx(Me.span,{...e,ref:t,style:{...TV,...e.style}}));rj.displayName=One;var Ine=rj,iT="ToastProvider",[oT,Dne,Mne]=wx("Toast"),[RV,tQe]=an("Toast",[Mne]),[$ne,nj]=RV(iT),OV=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:a="right",swipeThreshold:i=50,children:o}=e,[l,c]=w.useState(null),[u,d]=w.useState(0),h=w.useRef(!1),f=w.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${iT}\`. Expected non-empty \`string\`.`),s.jsx(oT.Provider,{scope:t,children:s.jsx($ne,{scope:t,label:r,duration:n,swipeDirection:a,swipeThreshold:i,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:w.useCallback(()=>d(p=>p+1),[]),onToastRemove:w.useCallback(()=>d(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:o})})};OV.displayName=iT;var IV="ToastViewport",Fne=["F8"],_C="toast.viewportPause",SC="toast.viewportResume",DV=w.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=Fne,label:a="Notifications ({hotkey})",...i}=e,o=nj(IV,r),l=Dne(r),c=w.useRef(null),u=w.useRef(null),d=w.useRef(null),h=w.useRef(null),f=ct(t,h,o.onViewportChange),p=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),m=o.toastCount>0;w.useEffect(()=>{const g=x=>{var b;n.length!==0&&n.every(N=>x[N]||x.code===N)&&((b=h.current)==null||b.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[n]),w.useEffect(()=>{const g=c.current,x=h.current;if(m&&g&&x){const y=()=>{if(!o.isClosePausedRef.current){const _=new CustomEvent(_C);x.dispatchEvent(_),o.isClosePausedRef.current=!0}},b=()=>{if(o.isClosePausedRef.current){const _=new CustomEvent(SC);x.dispatchEvent(_),o.isClosePausedRef.current=!1}},N=_=>{!g.contains(_.relatedTarget)&&b()},j=()=>{g.contains(document.activeElement)||b()};return g.addEventListener("focusin",y),g.addEventListener("focusout",N),g.addEventListener("pointermove",y),g.addEventListener("pointerleave",j),window.addEventListener("blur",y),window.addEventListener("focus",b),()=>{g.removeEventListener("focusin",y),g.removeEventListener("focusout",N),g.removeEventListener("pointermove",y),g.removeEventListener("pointerleave",j),window.removeEventListener("blur",y),window.removeEventListener("focus",b)}}},[m,o.isClosePausedRef]);const v=w.useCallback(({tabbingDirection:g})=>{const y=l().map(b=>{const N=b.ref.current,j=[N,...Qne(N)];return g==="forwards"?j:j.reverse()});return(g==="forwards"?y.reverse():y).flat()},[l]);return w.useEffect(()=>{const g=h.current;if(g){const x=y=>{var j,_,S;const b=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!b){const C=document.activeElement,E=y.shiftKey;if(y.target===g&&E){(j=u.current)==null||j.focus();return}const A=v({tabbingDirection:E?"backwards":"forwards"}),O=A.findIndex(I=>I===C);K_(A.slice(O+1))?y.preventDefault():E?(_=u.current)==null||_.focus():(S=d.current)==null||S.focus()}};return g.addEventListener("keydown",x),()=>g.removeEventListener("keydown",x)}},[l,v]),s.jsxs(Sne,{ref:c,role:"region","aria-label":a.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:m?void 0:"none"},children:[m&&s.jsx(CC,{ref:u,onFocusFromOutsideViewport:()=>{const g=v({tabbingDirection:"forwards"});K_(g)}}),s.jsx(oT.Slot,{scope:r,children:s.jsx(Me.ol,{tabIndex:-1,...i,ref:f})}),m&&s.jsx(CC,{ref:d,onFocusFromOutsideViewport:()=>{const g=v({tabbingDirection:"backwards"});K_(g)}})]})});DV.displayName=IV;var MV="ToastFocusProxy",CC=w.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...a}=e,i=nj(MV,r);return s.jsx(rj,{"aria-hidden":!0,tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:o=>{var u;const l=o.relatedTarget;!((u=i.viewport)!=null&&u.contains(l))&&n()}})});CC.displayName=MV;var jx="Toast",Lne="toast.swipeStart",Bne="toast.swipeMove",Une="toast.swipeCancel",Vne="toast.swipeEnd",$V=w.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:a,onOpenChange:i,...o}=e,[l,c]=Ba({prop:n,defaultProp:a??!0,onChange:i,caller:jx});return s.jsx(gn,{present:r||l,children:s.jsx(qne,{open:l,...o,ref:t,onClose:()=>c(!1),onPause:Yr(e.onPause),onResume:Yr(e.onResume),onSwipeStart:Ne(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Ne(e.onSwipeMove,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:Ne(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Ne(e.onSwipeEnd,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})})})});$V.displayName=jx;var[zne,Wne]=RV(jx,{onClose(){}}),qne=w.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:a,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:p,...m}=e,v=nj(jx,r),[g,x]=w.useState(null),y=ct(t,I=>x(I)),b=w.useRef(null),N=w.useRef(null),j=a||v.duration,_=w.useRef(0),S=w.useRef(j),C=w.useRef(0),{onToastAdd:E,onToastRemove:k}=v,P=Yr(()=>{var R;(g==null?void 0:g.contains(document.activeElement))&&((R=v.viewport)==null||R.focus()),o()}),A=w.useCallback(I=>{!I||I===1/0||(window.clearTimeout(C.current),_.current=new Date().getTime(),C.current=window.setTimeout(P,I))},[P]);w.useEffect(()=>{const I=v.viewport;if(I){const R=()=>{A(S.current),u==null||u()},M=()=>{const B=new Date().getTime()-_.current;S.current=S.current-B,window.clearTimeout(C.current),c==null||c()};return I.addEventListener(_C,M),I.addEventListener(SC,R),()=>{I.removeEventListener(_C,M),I.removeEventListener(SC,R)}}},[v.viewport,j,c,u,A]),w.useEffect(()=>{i&&!v.isClosePausedRef.current&&A(j)},[i,j,v.isClosePausedRef,A]),w.useEffect(()=>(E(),()=>k()),[E,k]);const O=w.useMemo(()=>g?WV(g):null,[g]);return v.viewport?s.jsxs(s.Fragment,{children:[O&&s.jsx(Gne,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:O}),s.jsx(zne,{scope:r,onClose:P,children:ei.createPortal(s.jsx(oT.ItemSlot,{scope:r,children:s.jsx(_ne,{asChild:!0,onEscapeKeyDown:Ne(l,()=>{v.isFocusedToastEscapeKeyDownRef.current||P(),v.isFocusedToastEscapeKeyDownRef.current=!1}),children:s.jsx(Me.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":v.swipeDirection,...m,ref:y,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Ne(e.onKeyDown,I=>{I.key==="Escape"&&(l==null||l(I.nativeEvent),I.nativeEvent.defaultPrevented||(v.isFocusedToastEscapeKeyDownRef.current=!0,P()))}),onPointerDown:Ne(e.onPointerDown,I=>{I.button===0&&(b.current={x:I.clientX,y:I.clientY})}),onPointerMove:Ne(e.onPointerMove,I=>{if(!b.current)return;const R=I.clientX-b.current.x,M=I.clientY-b.current.y,B=!!N.current,$=["left","right"].includes(v.swipeDirection),D=["left","up"].includes(v.swipeDirection)?Math.min:Math.max,W=$?D(0,R):0,Z=$?0:D(0,M),U=I.pointerType==="touch"?10:2,Y={x:W,y:Z},ae={originalEvent:I,delta:Y};B?(N.current=Y,Iy(Bne,h,ae,{discrete:!1})):kD(Y,v.swipeDirection,U)?(N.current=Y,Iy(Lne,d,ae,{discrete:!1}),I.target.setPointerCapture(I.pointerId)):(Math.abs(R)>U||Math.abs(M)>U)&&(b.current=null)}),onPointerUp:Ne(e.onPointerUp,I=>{const R=N.current,M=I.target;if(M.hasPointerCapture(I.pointerId)&&M.releasePointerCapture(I.pointerId),N.current=null,b.current=null,R){const B=I.currentTarget,$={originalEvent:I,delta:R};kD(R,v.swipeDirection,v.swipeThreshold)?Iy(Vne,p,$,{discrete:!0}):Iy(Une,f,$,{discrete:!0}),B.addEventListener("click",D=>D.preventDefault(),{once:!0})}})})})}),v.viewport)})]}):null}),Gne=e=>{const{__scopeToast:t,children:r,...n}=e,a=nj(jx,t),[i,o]=w.useState(!1),[l,c]=w.useState(!1);return Yne(()=>o(!0)),w.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:s.jsx(Vp,{asChild:!0,children:s.jsx(rj,{...n,children:i&&s.jsxs(s.Fragment,{children:[a.label," ",r]})})})},Hne="ToastTitle",FV=w.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return s.jsx(Me.div,{...n,ref:t})});FV.displayName=Hne;var Kne="ToastDescription",LV=w.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return s.jsx(Me.div,{...n,ref:t})});LV.displayName=Kne;var BV="ToastAction",UV=w.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?s.jsx(zV,{altText:r,asChild:!0,children:s.jsx(lT,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${BV}\`. Expected non-empty \`string\`.`),null)});UV.displayName=BV;var VV="ToastClose",lT=w.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,a=Wne(VV,r);return s.jsx(zV,{asChild:!0,children:s.jsx(Me.button,{type:"button",...n,ref:t,onClick:Ne(e.onClick,a.onClose)})})});lT.displayName=VV;var zV=w.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...a}=e;return s.jsx(Me.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...a,ref:t})});function WV(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),Xne(n)){const a=n.ariaHidden||n.hidden||n.style.display==="none",i=n.dataset.radixToastAnnounceExclude==="";if(!a)if(i){const o=n.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...WV(n))}}),t}function Iy(e,t,r,{discrete:n}){const a=r.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?sT(a,i):a.dispatchEvent(i)}var kD=(e,t,r=0)=>{const n=Math.abs(e.x),a=Math.abs(e.y),i=n>a;return t==="left"||t==="right"?i&&n>r:!i&&a>r};function Yne(e=()=>{}){const t=Yr(e);Xr(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function Xne(e){return e.nodeType===e.ELEMENT_NODE}function Qne(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function K_(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var Zne=OV,qV=DV,GV=$V,HV=FV,KV=LV,YV=UV,XV=lT;function QV(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=QV(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Ut(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=QV(e))&&(n&&(n+=" "),n+=t);return n}const AD=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,PD=Ut,zp=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return PD(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:i}=t,o=Object.keys(a).map(u=>{const d=r==null?void 0:r[u],h=i==null?void 0:i[u];if(d===null)return null;const f=AD(d)||AD(h);return a[u][f]}),l=r&&Object.entries(r).reduce((u,d)=>{let[h,f]=d;return f===void 0||(u[h]=f),u},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,d)=>{let{class:h,className:f,...p}=d;return Object.entries(p).every(m=>{let[v,g]=m;return Array.isArray(g)?g.includes({...i,...l}[v]):{...i,...l}[v]===g})?[...u,h,f]:u},[]);return PD(e,o,c,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jne=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ZV=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var eae={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tae=w.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:o,...l},c)=>w.createElement("svg",{ref:c,...eae,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:ZV("lucide",a),...l},[...o.map(([u,d])=>w.createElement(u,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=(e,t)=>{const r=w.forwardRef(({className:n,...a},i)=>w.createElement(tae,{ref:i,iconNode:t,className:ZV(`lucide-${Jne(e)}`,n),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JV=Se("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=Se("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ez=Se("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aj=Se("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rae=Se("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tz=Se("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rz=Se("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=Se("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=Se("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=Se("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=Se("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TD=Se("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=Se("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lc=Se("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xd=Se("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wp=Se("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sv=Se("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nae=Se("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=Se("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=Se("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EC=Se("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A0=Se("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qd=Se("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cT=Se("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=Se("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sg=Se("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aae=Se("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zi=Se("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kC=Se("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=Se("Delete",[["path",{d:"M10 5a2 2 0 0 0-1.344.519l-6.328 5.74a1 1 0 0 0 0 1.481l6.328 5.741A2 2 0 0 0 10 19h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z",key:"1yo7s0"}],["path",{d:"m12 9 6 6",key:"anjzzh"}],["path",{d:"m18 9-6 6",key:"1fp51s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wi=Se("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uT=Se("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sae=Se("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ig=Se("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P0=Se("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ri=Se("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T0=Se("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AC=Se("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R0=Se("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iae=Se("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=Se("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dT=Se("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oae=Se("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PC=Se("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=Se("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lae=Se("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cae=Se("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iz=Se("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y_=Se("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uae=Se("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=Se("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=Se("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ai=Se("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=Se("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dae=Se("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sj=Se("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=Se("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hae=Se("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fae=Se("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pae=Se("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RD=Se("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mae=Se("OctagonAlert",[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z",key:"1fd625"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TC=Se("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=Se("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vae=Se("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=Se("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gae=Se("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ij=Se("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xae=Se("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oz=Se("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yae=Se("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bae=Se("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cl=Se("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nx=Se("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oj=Se("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RC=Se("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=Se("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wae=Se("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kd=Se("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jae=Se("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=Se("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nae=Se("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hT=Se("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qc=Se("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=Se("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=Se("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const og=Se("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lj=Se("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ae=Se("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=Se("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=Se("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sae=Se("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=Se("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=Se("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),fT="-",Cae=e=>{const t=kae(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:o=>{const l=o.split(fT);return l[0]===""&&l.length!==1&&l.shift(),cz(l,t)||Eae(o)},getConflictingClassGroupIds:(o,l)=>{const c=r[o]||[];return l&&n[o]?[...c,...n[o]]:c}}},cz=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?cz(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const i=e.join(fT);return(o=t.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},OD=/^\[(.+)\]$/,Eae=e=>{if(OD.test(e)){const t=OD.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},kae=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return Pae(Object.entries(e.classGroups),r).forEach(([i,o])=>{OC(o,n,i,t)}),n},OC=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const i=a===""?t:ID(t,a);i.classGroupId=r;return}if(typeof a=="function"){if(Aae(a)){OC(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([i,o])=>{OC(o,ID(t,i),r,n)})})},ID=(e,t)=>{let r=e;return t.split(fT).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Aae=e=>e.isThemeGetter,Pae=(e,t)=>t?e.map(([r,n])=>{const a=n.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,l])=>[t+o,l])):i);return[r,a]}):e,Tae=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(i,o)=>{r.set(i,o),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let o=r.get(i);if(o!==void 0)return o;if((o=n.get(i))!==void 0)return a(i,o),o},set(i,o){r.has(i)?r.set(i,o):a(i,o)}}},uz="!",Rae=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,a=t[0],i=t.length,o=l=>{const c=[];let u=0,d=0,h;for(let g=0;g<l.length;g++){let x=l[g];if(u===0){if(x===a&&(n||l.slice(g,g+i)===t)){c.push(l.slice(d,g)),d=g+i;continue}if(x==="/"){h=g;continue}}x==="["?u++:x==="]"&&u--}const f=c.length===0?l:l.substring(d),p=f.startsWith(uz),m=p?f.substring(1):f,v=h&&h>d?h-d:void 0;return{modifiers:c,hasImportantModifier:p,baseClassName:m,maybePostfixModifierPosition:v}};return r?l=>r({className:l,parseClassName:o}):o},Oae=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},Iae=e=>({cache:Tae(e.cacheSize),parseClassName:Rae(e),...Cae(e)}),Dae=/\s+/,Mae=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=t,i=[],o=e.trim().split(Dae);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{modifiers:d,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:p}=r(u);let m=!!p,v=n(m?f.substring(0,p):f);if(!v){if(!m){l=u+(l.length>0?" "+l:l);continue}if(v=n(f),!v){l=u+(l.length>0?" "+l:l);continue}m=!1}const g=Oae(d).join(":"),x=h?g+uz:g,y=x+v;if(i.includes(y))continue;i.push(y);const b=a(v,m);for(let N=0;N<b.length;++N){const j=b[N];i.push(x+j)}l=u+(l.length>0?" "+l:l)}return l};function $ae(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=dz(t))&&(n&&(n+=" "),n+=r);return n}const dz=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=dz(e[n]))&&(r&&(r+=" "),r+=t);return r};function Fae(e,...t){let r,n,a,i=o;function o(c){const u=t.reduce((d,h)=>h(d),e());return r=Iae(u),n=r.cache.get,a=r.cache.set,i=l,l(c)}function l(c){const u=n(c);if(u)return u;const d=Mae(c,r);return a(c,d),d}return function(){return i($ae.apply(null,arguments))}}const wr=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},hz=/^\[(?:([a-z-]+):)?(.+)\]$/i,Lae=/^\d+\/\d+$/,Bae=new Set(["px","full","screen"]),Uae=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Vae=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,zae=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Wae=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,qae=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ko=e=>hf(e)||Bae.has(e)||Lae.test(e),Hl=e=>qp(e,"length",Jae),hf=e=>!!e&&!Number.isNaN(Number(e)),X_=e=>qp(e,"number",hf),Dm=e=>!!e&&Number.isInteger(Number(e)),Gae=e=>e.endsWith("%")&&hf(e.slice(0,-1)),jt=e=>hz.test(e),Kl=e=>Uae.test(e),Hae=new Set(["length","size","percentage"]),Kae=e=>qp(e,Hae,fz),Yae=e=>qp(e,"position",fz),Xae=new Set(["image","url"]),Qae=e=>qp(e,Xae,tse),Zae=e=>qp(e,"",ese),Mm=()=>!0,qp=(e,t,r)=>{const n=hz.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},Jae=e=>Vae.test(e)&&!zae.test(e),fz=()=>!1,ese=e=>Wae.test(e),tse=e=>qae.test(e),rse=()=>{const e=wr("colors"),t=wr("spacing"),r=wr("blur"),n=wr("brightness"),a=wr("borderColor"),i=wr("borderRadius"),o=wr("borderSpacing"),l=wr("borderWidth"),c=wr("contrast"),u=wr("grayscale"),d=wr("hueRotate"),h=wr("invert"),f=wr("gap"),p=wr("gradientColorStops"),m=wr("gradientColorStopPositions"),v=wr("inset"),g=wr("margin"),x=wr("opacity"),y=wr("padding"),b=wr("saturate"),N=wr("scale"),j=wr("sepia"),_=wr("skew"),S=wr("space"),C=wr("translate"),E=()=>["auto","contain","none"],k=()=>["auto","hidden","clip","visible","scroll"],P=()=>["auto",jt,t],A=()=>[jt,t],O=()=>["",Ko,Hl],I=()=>["auto",hf,jt],R=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],M=()=>["solid","dashed","dotted","double","none"],B=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],$=()=>["start","end","center","between","around","evenly","stretch"],D=()=>["","0",jt],W=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Z=()=>[hf,jt];return{cacheSize:500,separator:":",theme:{colors:[Mm],spacing:[Ko,Hl],blur:["none","",Kl,jt],brightness:Z(),borderColor:[e],borderRadius:["none","","full",Kl,jt],borderSpacing:A(),borderWidth:O(),contrast:Z(),grayscale:D(),hueRotate:Z(),invert:D(),gap:A(),gradientColorStops:[e],gradientColorStopPositions:[Gae,Hl],inset:P(),margin:P(),opacity:Z(),padding:A(),saturate:Z(),scale:Z(),sepia:D(),skew:Z(),space:A(),translate:A()},classGroups:{aspect:[{aspect:["auto","square","video",jt]}],container:["container"],columns:[{columns:[Kl]}],"break-after":[{"break-after":W()}],"break-before":[{"break-before":W()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...R(),jt]}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:E()}],"overscroll-x":[{"overscroll-x":E()}],"overscroll-y":[{"overscroll-y":E()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[v]}],"inset-x":[{"inset-x":[v]}],"inset-y":[{"inset-y":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Dm,jt]}],basis:[{basis:P()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",jt]}],grow:[{grow:D()}],shrink:[{shrink:D()}],order:[{order:["first","last","none",Dm,jt]}],"grid-cols":[{"grid-cols":[Mm]}],"col-start-end":[{col:["auto",{span:["full",Dm,jt]},jt]}],"col-start":[{"col-start":I()}],"col-end":[{"col-end":I()}],"grid-rows":[{"grid-rows":[Mm]}],"row-start-end":[{row:["auto",{span:[Dm,jt]},jt]}],"row-start":[{"row-start":I()}],"row-end":[{"row-end":I()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",jt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",jt]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...$()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...$(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...$(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",jt,t]}],"min-w":[{"min-w":[jt,t,"min","max","fit"]}],"max-w":[{"max-w":[jt,t,"none","full","min","max","fit","prose",{screen:[Kl]},Kl]}],h:[{h:[jt,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[jt,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[jt,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[jt,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Kl,Hl]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",X_]}],"font-family":[{font:[Mm]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",jt]}],"line-clamp":[{"line-clamp":["none",hf,X_]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ko,jt]}],"list-image":[{"list-image":["none",jt]}],"list-style-type":[{list:["none","disc","decimal",jt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...M(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ko,Hl]}],"underline-offset":[{"underline-offset":["auto",Ko,jt]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:A()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",jt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",jt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...R(),Yae]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Kae]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Qae]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[m]}],"gradient-via-pos":[{via:[m]}],"gradient-to-pos":[{to:[m]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...M(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:M()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...M()]}],"outline-offset":[{"outline-offset":[Ko,jt]}],"outline-w":[{outline:[Ko,Hl]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Ko,Hl]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Kl,Zae]}],"shadow-color":[{shadow:[Mm]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...B(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":B()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Kl,jt]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[b]}],sepia:[{sepia:[j]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[j]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",jt]}],duration:[{duration:Z()}],ease:[{ease:["linear","in","out","in-out",jt]}],delay:[{delay:Z()}],animate:[{animate:["none","spin","ping","pulse","bounce",jt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[Dm,jt]}],"translate-x":[{"translate-x":[C]}],"translate-y":[{"translate-y":[C]}],"skew-x":[{"skew-x":[_]}],"skew-y":[{"skew-y":[_]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",jt]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",jt]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":A()}],"scroll-mx":[{"scroll-mx":A()}],"scroll-my":[{"scroll-my":A()}],"scroll-ms":[{"scroll-ms":A()}],"scroll-me":[{"scroll-me":A()}],"scroll-mt":[{"scroll-mt":A()}],"scroll-mr":[{"scroll-mr":A()}],"scroll-mb":[{"scroll-mb":A()}],"scroll-ml":[{"scroll-ml":A()}],"scroll-p":[{"scroll-p":A()}],"scroll-px":[{"scroll-px":A()}],"scroll-py":[{"scroll-py":A()}],"scroll-ps":[{"scroll-ps":A()}],"scroll-pe":[{"scroll-pe":A()}],"scroll-pt":[{"scroll-pt":A()}],"scroll-pr":[{"scroll-pr":A()}],"scroll-pb":[{"scroll-pb":A()}],"scroll-pl":[{"scroll-pl":A()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",jt]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Ko,Hl,X_]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},nse=Fae(rse);function me(...e){return nse(Ut(e))}const ase=Zne,pz=w.forwardRef(({className:e,...t},r)=>s.jsx(qV,{ref:r,className:me("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));pz.displayName=qV.displayName;const sse=zp("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),mz=w.forwardRef(({className:e,variant:t,...r},n)=>s.jsx(GV,{ref:n,className:me(sse({variant:t}),e),...r}));mz.displayName=GV.displayName;const ise=w.forwardRef(({className:e,...t},r)=>s.jsx(YV,{ref:r,className:me("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",e),...t}));ise.displayName=YV.displayName;const vz=w.forwardRef(({className:e,...t},r)=>s.jsx(XV,{ref:r,className:me("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:s.jsx(vn,{className:"h-4 w-4"})}));vz.displayName=XV.displayName;const gz=w.forwardRef(({className:e,...t},r)=>s.jsx(HV,{ref:r,className:me("text-sm font-semibold",e),...t}));gz.displayName=HV.displayName;const xz=w.forwardRef(({className:e,...t},r)=>s.jsx(KV,{ref:r,className:me("text-sm opacity-90",e),...t}));xz.displayName=KV.displayName;function ose(){const{toasts:e}=Et();return s.jsxs(ase,{children:[e.map(function({id:t,title:r,description:n,action:a,...i}){return s.jsxs(mz,{...i,children:[s.jsxs("div",{className:"grid gap-1",children:[r&&s.jsx(gz,{children:r}),n&&s.jsx(xz,{children:n})]}),a,s.jsx(vz,{})]},t)}),s.jsx(pz,{})]})}var lse=e=>{switch(e){case"success":return dse;case"info":return fse;case"warning":return hse;case"error":return pse;default:return null}},cse=Array(12).fill(0),use=({visible:e,className:t})=>F.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},F.createElement("div",{className:"sonner-spinner"},cse.map((r,n)=>F.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),dse=F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},F.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),hse=F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},F.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),fse=F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},F.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),pse=F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},F.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),mse=F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},F.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),F.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),vse=()=>{let[e,t]=F.useState(document.hidden);return F.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},IC=1,gse=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;let{message:n,...a}=t,i=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:IC++,o=this.toasts.find(c=>c.id===i),l=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),o?this.toasts=this.toasts.map(c=>c.id===i?(this.publish({...c,...t,id:i,title:n}),{...c,...t,id:i,dismissible:l,title:n}):c):this.addToast({title:n,...a,dismissible:l,id:i}),i},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),this.subscribers.forEach(r=>r({id:t,dismiss:!0})),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));let a=t instanceof Promise?t:t(),i=n!==void 0,o,l=a.then(async u=>{if(o=["resolve",u],F.isValidElement(u))i=!1,this.create({id:n,type:"default",message:u});else if(yse(u)&&!u.ok){i=!1;let d=typeof r.error=="function"?await r.error(`HTTP error! status: ${u.status}`):r.error,h=typeof r.description=="function"?await r.description(`HTTP error! status: ${u.status}`):r.description;this.create({id:n,type:"error",message:d,description:h})}else if(r.success!==void 0){i=!1;let d=typeof r.success=="function"?await r.success(u):r.success,h=typeof r.description=="function"?await r.description(u):r.description;this.create({id:n,type:"success",message:d,description:h})}}).catch(async u=>{if(o=["reject",u],r.error!==void 0){i=!1;let d=typeof r.error=="function"?await r.error(u):r.error,h=typeof r.description=="function"?await r.description(u):r.description;this.create({id:n,type:"error",message:d,description:h})}}).finally(()=>{var u;i&&(this.dismiss(n),n=void 0),(u=r.finally)==null||u.call(r)}),c=()=>new Promise((u,d)=>l.then(()=>o[0]==="reject"?d(o[1]):u(o[1])).catch(d));return typeof n!="string"&&typeof n!="number"?{unwrap:c}:Object.assign(n,{unwrap:c})},this.custom=(t,r)=>{let n=(r==null?void 0:r.id)||IC++;return this.create({jsx:t(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Za=new gse,xse=(e,t)=>{let r=(t==null?void 0:t.id)||IC++;return Za.addToast({title:e,...t,id:r}),r},yse=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",bse=xse,wse=()=>Za.toasts,jse=()=>Za.getActiveToasts(),H=Object.assign(bse,{success:Za.success,info:Za.info,warning:Za.warning,error:Za.error,custom:Za.custom,message:Za.message,promise:Za.promise,dismiss:Za.dismiss,loading:Za.loading},{getHistory:wse,getToasts:jse});function Nse(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}Nse(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Dy(e){return e.label!==void 0}var _se=3,Sse="32px",Cse="16px",DD=4e3,Ese=356,kse=14,Ase=20,Pse=200;function gi(...e){return e.filter(Boolean).join(" ")}function Tse(e){let[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}var Rse=e=>{var t,r,n,a,i,o,l,c,u,d,h;let{invert:f,toast:p,unstyled:m,interacting:v,setHeights:g,visibleToasts:x,heights:y,index:b,toasts:N,expanded:j,removeToast:_,defaultRichColors:S,closeButton:C,style:E,cancelButtonStyle:k,actionButtonStyle:P,className:A="",descriptionClassName:O="",duration:I,position:R,gap:M,loadingIcon:B,expandByDefault:$,classNames:D,icons:W,closeButtonAriaLabel:Z="Close toast",pauseWhenPageIsHidden:U}=e,[Y,ae]=F.useState(null),[ie,he]=F.useState(null),[se,ye]=F.useState(!1),[ne,le]=F.useState(!1),[ve,K]=F.useState(!1),[ke,Ce]=F.useState(!1),[Ge,He]=F.useState(!1),[It,ar]=F.useState(0),[Kt,G]=F.useState(0),te=F.useRef(p.duration||I||DD),ce=F.useRef(null),_e=F.useRef(null),Ae=b===0,je=b+1<=x,Le=p.type,it=p.dismissible!==!1,ft=p.className||"",kr=p.descriptionClassName||"",Ha=F.useMemo(()=>y.findIndex(st=>st.toastId===p.id)||0,[y,p.id]),Qr=F.useMemo(()=>{var st;return(st=p.closeButton)!=null?st:C},[p.closeButton,C]),Ho=F.useMemo(()=>p.duration||I||DD,[p.duration,I]),ps=F.useRef(0),la=F.useRef(0),Ls=F.useRef(0),Bs=F.useRef(null),[Nm,Cu]=R.split("-"),hy=F.useMemo(()=>y.reduce((st,wt,Dt)=>Dt>=Ha?st:st+wt.height,0),[y,Ha]),fy=vse(),g_=p.invert||f,sn=Le==="loading";la.current=F.useMemo(()=>Ha*M+hy,[Ha,hy]),F.useEffect(()=>{te.current=Ho},[Ho]),F.useEffect(()=>{ye(!0)},[]),F.useEffect(()=>{let st=_e.current;if(st){let wt=st.getBoundingClientRect().height;return G(wt),g(Dt=>[{toastId:p.id,height:wt,position:p.position},...Dt]),()=>g(Dt=>Dt.filter(Ur=>Ur.toastId!==p.id))}},[g,p.id]),F.useLayoutEffect(()=>{if(!se)return;let st=_e.current,wt=st.style.height;st.style.height="auto";let Dt=st.getBoundingClientRect().height;st.style.height=wt,G(Dt),g(Ur=>Ur.find(Ln=>Ln.toastId===p.id)?Ur.map(Ln=>Ln.toastId===p.id?{...Ln,height:Dt}:Ln):[{toastId:p.id,height:Dt,position:p.position},...Ur])},[se,p.title,p.description,g,p.id]);let Br=F.useCallback(()=>{le(!0),ar(la.current),g(st=>st.filter(wt=>wt.toastId!==p.id)),setTimeout(()=>{_(p)},Pse)},[p,_,g,la]);F.useEffect(()=>{if(p.promise&&Le==="loading"||p.duration===1/0||p.type==="loading")return;let st;return j||v||U&&fy?(()=>{if(Ls.current<ps.current){let wt=new Date().getTime()-ps.current;te.current=te.current-wt}Ls.current=new Date().getTime()})():te.current!==1/0&&(ps.current=new Date().getTime(),st=setTimeout(()=>{var wt;(wt=p.onAutoClose)==null||wt.call(p,p),Br()},te.current)),()=>clearTimeout(st)},[j,v,p,Le,U,fy,Br]),F.useEffect(()=>{p.delete&&Br()},[Br,p.delete]);function Pa(){var st,wt,Dt;return W!=null&&W.loading?F.createElement("div",{className:gi(D==null?void 0:D.loader,(st=p==null?void 0:p.classNames)==null?void 0:st.loader,"sonner-loader"),"data-visible":Le==="loading"},W.loading):B?F.createElement("div",{className:gi(D==null?void 0:D.loader,(wt=p==null?void 0:p.classNames)==null?void 0:wt.loader,"sonner-loader"),"data-visible":Le==="loading"},B):F.createElement(use,{className:gi(D==null?void 0:D.loader,(Dt=p==null?void 0:p.classNames)==null?void 0:Dt.loader),visible:Le==="loading"})}return F.createElement("li",{tabIndex:0,ref:_e,className:gi(A,ft,D==null?void 0:D.toast,(t=p==null?void 0:p.classNames)==null?void 0:t.toast,D==null?void 0:D.default,D==null?void 0:D[Le],(r=p==null?void 0:p.classNames)==null?void 0:r[Le]),"data-sonner-toast":"","data-rich-colors":(n=p.richColors)!=null?n:S,"data-styled":!(p.jsx||p.unstyled||m),"data-mounted":se,"data-promise":!!p.promise,"data-swiped":Ge,"data-removed":ne,"data-visible":je,"data-y-position":Nm,"data-x-position":Cu,"data-index":b,"data-front":Ae,"data-swiping":ve,"data-dismissible":it,"data-type":Le,"data-invert":g_,"data-swipe-out":ke,"data-swipe-direction":ie,"data-expanded":!!(j||$&&se),style:{"--index":b,"--toasts-before":b,"--z-index":N.length-b,"--offset":`${ne?It:la.current}px`,"--initial-height":$?"auto":`${Kt}px`,...E,...p.style},onDragEnd:()=>{K(!1),ae(null),Bs.current=null},onPointerDown:st=>{sn||!it||(ce.current=new Date,ar(la.current),st.target.setPointerCapture(st.pointerId),st.target.tagName!=="BUTTON"&&(K(!0),Bs.current={x:st.clientX,y:st.clientY}))},onPointerUp:()=>{var st,wt,Dt,Ur;if(ke||!it)return;Bs.current=null;let Ln=Number(((st=_e.current)==null?void 0:st.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),pr=Number(((wt=_e.current)==null?void 0:wt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ca=new Date().getTime()-((Dt=ce.current)==null?void 0:Dt.getTime()),Vr=Y==="x"?Ln:pr,Bn=Math.abs(Vr)/ca;if(Math.abs(Vr)>=Ase||Bn>.11){ar(la.current),(Ur=p.onDismiss)==null||Ur.call(p,p),he(Y==="x"?Ln>0?"right":"left":pr>0?"down":"up"),Br(),Ce(!0),He(!1);return}K(!1),ae(null)},onPointerMove:st=>{var wt,Dt,Ur,Ln;if(!Bs.current||!it||((wt=window.getSelection())==null?void 0:wt.toString().length)>0)return;let pr=st.clientY-Bs.current.y,ca=st.clientX-Bs.current.x,Vr=(Dt=e.swipeDirections)!=null?Dt:Tse(R);!Y&&(Math.abs(ca)>1||Math.abs(pr)>1)&&ae(Math.abs(ca)>Math.abs(pr)?"x":"y");let Bn={x:0,y:0};Y==="y"?(Vr.includes("top")||Vr.includes("bottom"))&&(Vr.includes("top")&&pr<0||Vr.includes("bottom")&&pr>0)&&(Bn.y=pr):Y==="x"&&(Vr.includes("left")||Vr.includes("right"))&&(Vr.includes("left")&&ca<0||Vr.includes("right")&&ca>0)&&(Bn.x=ca),(Math.abs(Bn.x)>0||Math.abs(Bn.y)>0)&&He(!0),(Ur=_e.current)==null||Ur.style.setProperty("--swipe-amount-x",`${Bn.x}px`),(Ln=_e.current)==null||Ln.style.setProperty("--swipe-amount-y",`${Bn.y}px`)}},Qr&&!p.jsx?F.createElement("button",{"aria-label":Z,"data-disabled":sn,"data-close-button":!0,onClick:sn||!it?()=>{}:()=>{var st;Br(),(st=p.onDismiss)==null||st.call(p,p)},className:gi(D==null?void 0:D.closeButton,(a=p==null?void 0:p.classNames)==null?void 0:a.closeButton)},(i=W==null?void 0:W.close)!=null?i:mse):null,p.jsx||w.isValidElement(p.title)?p.jsx?p.jsx:typeof p.title=="function"?p.title():p.title:F.createElement(F.Fragment,null,Le||p.icon||p.promise?F.createElement("div",{"data-icon":"",className:gi(D==null?void 0:D.icon,(o=p==null?void 0:p.classNames)==null?void 0:o.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||Pa():null,p.type!=="loading"?p.icon||(W==null?void 0:W[Le])||lse(Le):null):null,F.createElement("div",{"data-content":"",className:gi(D==null?void 0:D.content,(l=p==null?void 0:p.classNames)==null?void 0:l.content)},F.createElement("div",{"data-title":"",className:gi(D==null?void 0:D.title,(c=p==null?void 0:p.classNames)==null?void 0:c.title)},typeof p.title=="function"?p.title():p.title),p.description?F.createElement("div",{"data-description":"",className:gi(O,kr,D==null?void 0:D.description,(u=p==null?void 0:p.classNames)==null?void 0:u.description)},typeof p.description=="function"?p.description():p.description):null),w.isValidElement(p.cancel)?p.cancel:p.cancel&&Dy(p.cancel)?F.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||k,onClick:st=>{var wt,Dt;Dy(p.cancel)&&it&&((Dt=(wt=p.cancel).onClick)==null||Dt.call(wt,st),Br())},className:gi(D==null?void 0:D.cancelButton,(d=p==null?void 0:p.classNames)==null?void 0:d.cancelButton)},p.cancel.label):null,w.isValidElement(p.action)?p.action:p.action&&Dy(p.action)?F.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||P,onClick:st=>{var wt,Dt;Dy(p.action)&&((Dt=(wt=p.action).onClick)==null||Dt.call(wt,st),!st.defaultPrevented&&Br())},className:gi(D==null?void 0:D.actionButton,(h=p==null?void 0:p.classNames)==null?void 0:h.actionButton)},p.action.label):null))};function MD(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Ose(e,t){let r={};return[e,t].forEach((n,a)=>{let i=a===1,o=i?"--mobile-offset":"--offset",l=i?Cse:Sse;function c(u){["top","right","bottom","left"].forEach(d=>{r[`${o}-${d}`]=typeof u=="number"?`${u}px`:u})}typeof n=="number"||typeof n=="string"?c(n):typeof n=="object"?["top","right","bottom","left"].forEach(u=>{n[u]===void 0?r[`${o}-${u}`]=l:r[`${o}-${u}`]=typeof n[u]=="number"?`${n[u]}px`:n[u]}):c(l)}),r}var Ise=w.forwardRef(function(e,t){let{invert:r,position:n="bottom-right",hotkey:a=["altKey","KeyT"],expand:i,closeButton:o,className:l,offset:c,mobileOffset:u,theme:d="light",richColors:h,duration:f,style:p,visibleToasts:m=_se,toastOptions:v,dir:g=MD(),gap:x=kse,loadingIcon:y,icons:b,containerAriaLabel:N="Notifications",pauseWhenPageIsHidden:j}=e,[_,S]=F.useState([]),C=F.useMemo(()=>Array.from(new Set([n].concat(_.filter(U=>U.position).map(U=>U.position)))),[_,n]),[E,k]=F.useState([]),[P,A]=F.useState(!1),[O,I]=F.useState(!1),[R,M]=F.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),B=F.useRef(null),$=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),D=F.useRef(null),W=F.useRef(!1),Z=F.useCallback(U=>{S(Y=>{var ae;return(ae=Y.find(ie=>ie.id===U.id))!=null&&ae.delete||Za.dismiss(U.id),Y.filter(({id:ie})=>ie!==U.id)})},[]);return F.useEffect(()=>Za.subscribe(U=>{if(U.dismiss){S(Y=>Y.map(ae=>ae.id===U.id?{...ae,delete:!0}:ae));return}setTimeout(()=>{jV.flushSync(()=>{S(Y=>{let ae=Y.findIndex(ie=>ie.id===U.id);return ae!==-1?[...Y.slice(0,ae),{...Y[ae],...U},...Y.slice(ae+1)]:[U,...Y]})})})}),[]),F.useEffect(()=>{if(d!=="system"){M(d);return}if(d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?M("dark"):M("light")),typeof window>"u")return;let U=window.matchMedia("(prefers-color-scheme: dark)");try{U.addEventListener("change",({matches:Y})=>{M(Y?"dark":"light")})}catch{U.addListener(({matches:ae})=>{try{M(ae?"dark":"light")}catch(ie){console.error(ie)}})}},[d]),F.useEffect(()=>{_.length<=1&&A(!1)},[_]),F.useEffect(()=>{let U=Y=>{var ae,ie;a.every(he=>Y[he]||Y.code===he)&&(A(!0),(ae=B.current)==null||ae.focus()),Y.code==="Escape"&&(document.activeElement===B.current||(ie=B.current)!=null&&ie.contains(document.activeElement))&&A(!1)};return document.addEventListener("keydown",U),()=>document.removeEventListener("keydown",U)},[a]),F.useEffect(()=>{if(B.current)return()=>{D.current&&(D.current.focus({preventScroll:!0}),D.current=null,W.current=!1)}},[B.current]),F.createElement("section",{ref:t,"aria-label":`${N} ${$}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},C.map((U,Y)=>{var ae;let[ie,he]=U.split("-");return _.length?F.createElement("ol",{key:U,dir:g==="auto"?MD():g,tabIndex:-1,ref:B,className:l,"data-sonner-toaster":!0,"data-theme":R,"data-y-position":ie,"data-lifted":P&&_.length>1&&!i,"data-x-position":he,style:{"--front-toast-height":`${((ae=E[0])==null?void 0:ae.height)||0}px`,"--width":`${Ese}px`,"--gap":`${x}px`,...p,...Ose(c,u)},onBlur:se=>{W.current&&!se.currentTarget.contains(se.relatedTarget)&&(W.current=!1,D.current&&(D.current.focus({preventScroll:!0}),D.current=null))},onFocus:se=>{se.target instanceof HTMLElement&&se.target.dataset.dismissible==="false"||W.current||(W.current=!0,D.current=se.relatedTarget)},onMouseEnter:()=>A(!0),onMouseMove:()=>A(!0),onMouseLeave:()=>{O||A(!1)},onDragEnd:()=>A(!1),onPointerDown:se=>{se.target instanceof HTMLElement&&se.target.dataset.dismissible==="false"||I(!0)},onPointerUp:()=>I(!1)},_.filter(se=>!se.position&&Y===0||se.position===U).map((se,ye)=>{var ne,le;return F.createElement(Rse,{key:se.id,icons:b,index:ye,toast:se,defaultRichColors:h,duration:(ne=v==null?void 0:v.duration)!=null?ne:f,className:v==null?void 0:v.className,descriptionClassName:v==null?void 0:v.descriptionClassName,invert:r,visibleToasts:m,closeButton:(le=v==null?void 0:v.closeButton)!=null?le:o,interacting:O,position:U,style:v==null?void 0:v.style,unstyled:v==null?void 0:v.unstyled,classNames:v==null?void 0:v.classNames,cancelButtonStyle:v==null?void 0:v.cancelButtonStyle,actionButtonStyle:v==null?void 0:v.actionButtonStyle,removeToast:Z,toasts:_.filter(ve=>ve.position==se.position),heights:E.filter(ve=>ve.position==se.position),setHeights:k,expandByDefault:i,gap:x,loadingIcon:y,expanded:P,pauseWhenPageIsHidden:j,swipeDirections:e.swipeDirections})})):null}))});const Dse=({...e})=>{const{theme:t="system"}=_V();return s.jsx(Ise,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var Mse=hP[" useId ".trim().toString()]||(()=>{}),$se=0;function pn(e){const[t,r]=w.useState(Mse());return Xr(()=>{e||r(n=>n??String($se++))},[e]),e||(t?`radix-${t}`:"")}const Fse=["top","right","bottom","left"],Zc=Math.min,js=Math.max,O0=Math.round,My=Math.floor,Co=e=>({x:e,y:e}),Lse={left:"right",right:"left",bottom:"top",top:"bottom"},Bse={start:"end",end:"start"};function DC(e,t,r){return js(e,Zc(t,r))}function El(e,t){return typeof e=="function"?e(t):e}function kl(e){return e.split("-")[0]}function Gp(e){return e.split("-")[1]}function pT(e){return e==="x"?"y":"x"}function mT(e){return e==="y"?"height":"width"}const Use=new Set(["top","bottom"]);function go(e){return Use.has(kl(e))?"y":"x"}function vT(e){return pT(go(e))}function Vse(e,t,r){r===void 0&&(r=!1);const n=Gp(e),a=vT(e),i=mT(a);let o=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(o=I0(o)),[o,I0(o)]}function zse(e){const t=I0(e);return[MC(e),t,MC(t)]}function MC(e){return e.replace(/start|end/g,t=>Bse[t])}const $D=["left","right"],FD=["right","left"],Wse=["top","bottom"],qse=["bottom","top"];function Gse(e,t,r){switch(e){case"top":case"bottom":return r?t?FD:$D:t?$D:FD;case"left":case"right":return t?Wse:qse;default:return[]}}function Hse(e,t,r,n){const a=Gp(e);let i=Gse(kl(e),r==="start",n);return a&&(i=i.map(o=>o+"-"+a),t&&(i=i.concat(i.map(MC)))),i}function I0(e){return e.replace(/left|right|bottom|top/g,t=>Lse[t])}function Kse(e){return{top:0,right:0,bottom:0,left:0,...e}}function yz(e){return typeof e!="number"?Kse(e):{top:e,right:e,bottom:e,left:e}}function D0(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function LD(e,t,r){let{reference:n,floating:a}=e;const i=go(t),o=vT(t),l=mT(o),c=kl(t),u=i==="y",d=n.x+n.width/2-a.width/2,h=n.y+n.height/2-a.height/2,f=n[l]/2-a[l]/2;let p;switch(c){case"top":p={x:d,y:n.y-a.height};break;case"bottom":p={x:d,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:h};break;case"left":p={x:n.x-a.width,y:h};break;default:p={x:n.x,y:n.y}}switch(Gp(t)){case"start":p[o]-=f*(r&&u?-1:1);break;case"end":p[o]+=f*(r&&u?-1:1);break}return p}const Yse=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:i=[],platform:o}=r,l=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(t));let u=await o.getElementRects({reference:e,floating:t,strategy:a}),{x:d,y:h}=LD(u,n,c),f=n,p={},m=0;for(let v=0;v<l.length;v++){const{name:g,fn:x}=l[v],{x:y,y:b,data:N,reset:j}=await x({x:d,y:h,initialPlacement:n,placement:f,strategy:a,middlewareData:p,rects:u,platform:o,elements:{reference:e,floating:t}});d=y??d,h=b??h,p={...p,[g]:{...p[g],...N}},j&&m<=50&&(m++,typeof j=="object"&&(j.placement&&(f=j.placement),j.rects&&(u=j.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:a}):j.rects),{x:d,y:h}=LD(u,f,c)),v=-1)}return{x:d,y:h,placement:f,strategy:a,middlewareData:p}};async function lg(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:i,rects:o,elements:l,strategy:c}=e,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:p=0}=El(t,e),m=yz(p),g=l[f?h==="floating"?"reference":"floating":h],x=D0(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(g)))==null||r?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),y=h==="floating"?{x:n,y:a,width:o.floating.width,height:o.floating.height}:o.reference,b=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),N=await(i.isElement==null?void 0:i.isElement(b))?await(i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},j=D0(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:y,offsetParent:b,strategy:c}):y);return{top:(x.top-j.top+m.top)/N.y,bottom:(j.bottom-x.bottom+m.bottom)/N.y,left:(x.left-j.left+m.left)/N.x,right:(j.right-x.right+m.right)/N.x}}const Xse=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:a,rects:i,platform:o,elements:l,middlewareData:c}=t,{element:u,padding:d=0}=El(e,t)||{};if(u==null)return{};const h=yz(d),f={x:r,y:n},p=vT(a),m=mT(p),v=await o.getDimensions(u),g=p==="y",x=g?"top":"left",y=g?"bottom":"right",b=g?"clientHeight":"clientWidth",N=i.reference[m]+i.reference[p]-f[p]-i.floating[m],j=f[p]-i.reference[p],_=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let S=_?_[b]:0;(!S||!await(o.isElement==null?void 0:o.isElement(_)))&&(S=l.floating[b]||i.floating[m]);const C=N/2-j/2,E=S/2-v[m]/2-1,k=Zc(h[x],E),P=Zc(h[y],E),A=k,O=S-v[m]-P,I=S/2-v[m]/2+C,R=DC(A,I,O),M=!c.arrow&&Gp(a)!=null&&I!==R&&i.reference[m]/2-(I<A?k:P)-v[m]/2<0,B=M?I<A?I-A:I-O:0;return{[p]:f[p]+B,data:{[p]:R,centerOffset:I-R-B,...M&&{alignmentOffset:B}},reset:M}}}),Qse=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:a,middlewareData:i,rects:o,initialPlacement:l,platform:c,elements:u}=t,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:v=!0,...g}=El(e,t);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const x=kl(a),y=go(l),b=kl(l)===l,N=await(c.isRTL==null?void 0:c.isRTL(u.floating)),j=f||(b||!v?[I0(l)]:zse(l)),_=m!=="none";!f&&_&&j.push(...Hse(l,v,m,N));const S=[l,...j],C=await lg(t,g),E=[];let k=((n=i.flip)==null?void 0:n.overflows)||[];if(d&&E.push(C[x]),h){const I=Vse(a,o,N);E.push(C[I[0]],C[I[1]])}if(k=[...k,{placement:a,overflows:E}],!E.every(I=>I<=0)){var P,A;const I=(((P=i.flip)==null?void 0:P.index)||0)+1,R=S[I];if(R&&(!(h==="alignment"?y!==go(R):!1)||k.every($=>$.overflows[0]>0&&go($.placement)===y)))return{data:{index:I,overflows:k},reset:{placement:R}};let M=(A=k.filter(B=>B.overflows[0]<=0).sort((B,$)=>B.overflows[1]-$.overflows[1])[0])==null?void 0:A.placement;if(!M)switch(p){case"bestFit":{var O;const B=(O=k.filter($=>{if(_){const D=go($.placement);return D===y||D==="y"}return!0}).map($=>[$.placement,$.overflows.filter(D=>D>0).reduce((D,W)=>D+W,0)]).sort(($,D)=>$[1]-D[1])[0])==null?void 0:O[0];B&&(M=B);break}case"initialPlacement":M=l;break}if(a!==M)return{reset:{placement:M}}}return{}}}};function BD(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function UD(e){return Fse.some(t=>e[t]>=0)}const Zse=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=El(e,t);switch(n){case"referenceHidden":{const i=await lg(t,{...a,elementContext:"reference"}),o=BD(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:UD(o)}}}case"escaped":{const i=await lg(t,{...a,altBoundary:!0}),o=BD(i,r.floating);return{data:{escapedOffsets:o,escaped:UD(o)}}}default:return{}}}}},bz=new Set(["left","top"]);async function Jse(e,t){const{placement:r,platform:n,elements:a}=e,i=await(n.isRTL==null?void 0:n.isRTL(a.floating)),o=kl(r),l=Gp(r),c=go(r)==="y",u=bz.has(o)?-1:1,d=i&&c?-1:1,h=El(t,e);let{mainAxis:f,crossAxis:p,alignmentAxis:m}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof m=="number"&&(p=l==="end"?m*-1:m),c?{x:p*d,y:f*u}:{x:f*u,y:p*d}}const eie=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:a,y:i,placement:o,middlewareData:l}=t,c=await Jse(t,e);return o===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:a+c.x,y:i+c.y,data:{...c,placement:o}}}}},tie=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:g=>{let{x,y}=g;return{x,y}}},...c}=El(e,t),u={x:r,y:n},d=await lg(t,c),h=go(kl(a)),f=pT(h);let p=u[f],m=u[h];if(i){const g=f==="y"?"top":"left",x=f==="y"?"bottom":"right",y=p+d[g],b=p-d[x];p=DC(y,p,b)}if(o){const g=h==="y"?"top":"left",x=h==="y"?"bottom":"right",y=m+d[g],b=m-d[x];m=DC(y,m,b)}const v=l.fn({...t,[f]:p,[h]:m});return{...v,data:{x:v.x-r,y:v.y-n,enabled:{[f]:i,[h]:o}}}}}},rie=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:i,middlewareData:o}=t,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=El(e,t),d={x:r,y:n},h=go(a),f=pT(h);let p=d[f],m=d[h];const v=El(l,t),g=typeof v=="number"?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(c){const b=f==="y"?"height":"width",N=i.reference[f]-i.floating[b]+g.mainAxis,j=i.reference[f]+i.reference[b]-g.mainAxis;p<N?p=N:p>j&&(p=j)}if(u){var x,y;const b=f==="y"?"width":"height",N=bz.has(kl(a)),j=i.reference[h]-i.floating[b]+(N&&((x=o.offset)==null?void 0:x[h])||0)+(N?0:g.crossAxis),_=i.reference[h]+i.reference[b]+(N?0:((y=o.offset)==null?void 0:y[h])||0)-(N?g.crossAxis:0);m<j?m=j:m>_&&(m=_)}return{[f]:p,[h]:m}}}},nie=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:a,rects:i,platform:o,elements:l}=t,{apply:c=()=>{},...u}=El(e,t),d=await lg(t,u),h=kl(a),f=Gp(a),p=go(a)==="y",{width:m,height:v}=i.floating;let g,x;h==="top"||h==="bottom"?(g=h,x=f===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(x=h,g=f==="end"?"top":"bottom");const y=v-d.top-d.bottom,b=m-d.left-d.right,N=Zc(v-d[g],y),j=Zc(m-d[x],b),_=!t.middlewareData.shift;let S=N,C=j;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(C=b),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(S=y),_&&!f){const k=js(d.left,0),P=js(d.right,0),A=js(d.top,0),O=js(d.bottom,0);p?C=m-2*(k!==0||P!==0?k+P:js(d.left,d.right)):S=v-2*(A!==0||O!==0?A+O:js(d.top,d.bottom))}await c({...t,availableWidth:C,availableHeight:S});const E=await o.getDimensions(l.floating);return m!==E.width||v!==E.height?{reset:{rects:!0}}:{}}}};function cj(){return typeof window<"u"}function Hp(e){return wz(e)?(e.nodeName||"").toLowerCase():"#document"}function Os(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Bo(e){var t;return(t=(wz(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function wz(e){return cj()?e instanceof Node||e instanceof Os(e).Node:!1}function qi(e){return cj()?e instanceof Element||e instanceof Os(e).Element:!1}function Io(e){return cj()?e instanceof HTMLElement||e instanceof Os(e).HTMLElement:!1}function VD(e){return!cj()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Os(e).ShadowRoot}const aie=new Set(["inline","contents"]);function _x(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=Gi(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!aie.has(a)}const sie=new Set(["table","td","th"]);function iie(e){return sie.has(Hp(e))}const oie=[":popover-open",":modal"];function uj(e){return oie.some(t=>{try{return e.matches(t)}catch{return!1}})}const lie=["transform","translate","scale","rotate","perspective"],cie=["transform","translate","scale","rotate","perspective","filter"],uie=["paint","layout","strict","content"];function gT(e){const t=xT(),r=qi(e)?Gi(e):e;return lie.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||cie.some(n=>(r.willChange||"").includes(n))||uie.some(n=>(r.contain||"").includes(n))}function die(e){let t=Jc(e);for(;Io(t)&&!Xf(t);){if(gT(t))return t;if(uj(t))return null;t=Jc(t)}return null}function xT(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const hie=new Set(["html","body","#document"]);function Xf(e){return hie.has(Hp(e))}function Gi(e){return Os(e).getComputedStyle(e)}function dj(e){return qi(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Jc(e){if(Hp(e)==="html")return e;const t=e.assignedSlot||e.parentNode||VD(e)&&e.host||Bo(e);return VD(t)?t.host:t}function jz(e){const t=Jc(e);return Xf(t)?e.ownerDocument?e.ownerDocument.body:e.body:Io(t)&&_x(t)?t:jz(t)}function cg(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=jz(e),i=a===((n=e.ownerDocument)==null?void 0:n.body),o=Os(a);if(i){const l=$C(o);return t.concat(o,o.visualViewport||[],_x(a)?a:[],l&&r?cg(l):[])}return t.concat(a,cg(a,[],r))}function $C(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Nz(e){const t=Gi(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=Io(e),i=a?e.offsetWidth:r,o=a?e.offsetHeight:n,l=O0(r)!==i||O0(n)!==o;return l&&(r=i,n=o),{width:r,height:n,$:l}}function yT(e){return qi(e)?e:e.contextElement}function ff(e){const t=yT(e);if(!Io(t))return Co(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:i}=Nz(t);let o=(i?O0(r.width):r.width)/n,l=(i?O0(r.height):r.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const fie=Co(0);function _z(e){const t=Os(e);return!xT()||!t.visualViewport?fie:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function pie(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Os(e)?!1:t}function Ad(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),i=yT(e);let o=Co(1);t&&(n?qi(n)&&(o=ff(n)):o=ff(e));const l=pie(i,r,n)?_z(i):Co(0);let c=(a.left+l.x)/o.x,u=(a.top+l.y)/o.y,d=a.width/o.x,h=a.height/o.y;if(i){const f=Os(i),p=n&&qi(n)?Os(n):n;let m=f,v=$C(m);for(;v&&n&&p!==m;){const g=ff(v),x=v.getBoundingClientRect(),y=Gi(v),b=x.left+(v.clientLeft+parseFloat(y.paddingLeft))*g.x,N=x.top+(v.clientTop+parseFloat(y.paddingTop))*g.y;c*=g.x,u*=g.y,d*=g.x,h*=g.y,c+=b,u+=N,m=Os(v),v=$C(m)}}return D0({width:d,height:h,x:c,y:u})}function bT(e,t){const r=dj(e).scrollLeft;return t?t.left+r:Ad(Bo(e)).left+r}function Sz(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),a=n.left+t.scrollLeft-(r?0:bT(e,n)),i=n.top+t.scrollTop;return{x:a,y:i}}function mie(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const i=a==="fixed",o=Bo(n),l=t?uj(t.floating):!1;if(n===o||l&&i)return r;let c={scrollLeft:0,scrollTop:0},u=Co(1);const d=Co(0),h=Io(n);if((h||!h&&!i)&&((Hp(n)!=="body"||_x(o))&&(c=dj(n)),Io(n))){const p=Ad(n);u=ff(n),d.x=p.x+n.clientLeft,d.y=p.y+n.clientTop}const f=o&&!h&&!i?Sz(o,c,!0):Co(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-c.scrollLeft*u.x+d.x+f.x,y:r.y*u.y-c.scrollTop*u.y+d.y+f.y}}function vie(e){return Array.from(e.getClientRects())}function gie(e){const t=Bo(e),r=dj(e),n=e.ownerDocument.body,a=js(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),i=js(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+bT(e);const l=-r.scrollTop;return Gi(n).direction==="rtl"&&(o+=js(t.clientWidth,n.clientWidth)-a),{width:a,height:i,x:o,y:l}}function xie(e,t){const r=Os(e),n=Bo(e),a=r.visualViewport;let i=n.clientWidth,o=n.clientHeight,l=0,c=0;if(a){i=a.width,o=a.height;const u=xT();(!u||u&&t==="fixed")&&(l=a.offsetLeft,c=a.offsetTop)}return{width:i,height:o,x:l,y:c}}const yie=new Set(["absolute","fixed"]);function bie(e,t){const r=Ad(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,i=Io(e)?ff(e):Co(1),o=e.clientWidth*i.x,l=e.clientHeight*i.y,c=a*i.x,u=n*i.y;return{width:o,height:l,x:c,y:u}}function zD(e,t,r){let n;if(t==="viewport")n=xie(e,r);else if(t==="document")n=gie(Bo(e));else if(qi(t))n=bie(t,r);else{const a=_z(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return D0(n)}function Cz(e,t){const r=Jc(e);return r===t||!qi(r)||Xf(r)?!1:Gi(r).position==="fixed"||Cz(r,t)}function wie(e,t){const r=t.get(e);if(r)return r;let n=cg(e,[],!1).filter(l=>qi(l)&&Hp(l)!=="body"),a=null;const i=Gi(e).position==="fixed";let o=i?Jc(e):e;for(;qi(o)&&!Xf(o);){const l=Gi(o),c=gT(o);!c&&l.position==="fixed"&&(a=null),(i?!c&&!a:!c&&l.position==="static"&&!!a&&yie.has(a.position)||_x(o)&&!c&&Cz(e,o))?n=n.filter(d=>d!==o):a=l,o=Jc(o)}return t.set(e,n),n}function jie(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const o=[...r==="clippingAncestors"?uj(t)?[]:wie(t,this._c):[].concat(r),n],l=o[0],c=o.reduce((u,d)=>{const h=zD(t,d,a);return u.top=js(h.top,u.top),u.right=Zc(h.right,u.right),u.bottom=Zc(h.bottom,u.bottom),u.left=js(h.left,u.left),u},zD(t,l,a));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function Nie(e){const{width:t,height:r}=Nz(e);return{width:t,height:r}}function _ie(e,t,r){const n=Io(t),a=Bo(t),i=r==="fixed",o=Ad(e,!0,i,t);let l={scrollLeft:0,scrollTop:0};const c=Co(0);function u(){c.x=bT(a)}if(n||!n&&!i)if((Hp(t)!=="body"||_x(a))&&(l=dj(t)),n){const p=Ad(t,!0,i,t);c.x=p.x+t.clientLeft,c.y=p.y+t.clientTop}else a&&u();i&&!n&&a&&u();const d=a&&!n&&!i?Sz(a,l):Co(0),h=o.left+l.scrollLeft-c.x-d.x,f=o.top+l.scrollTop-c.y-d.y;return{x:h,y:f,width:o.width,height:o.height}}function Q_(e){return Gi(e).position==="static"}function WD(e,t){if(!Io(e)||Gi(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Bo(e)===r&&(r=r.ownerDocument.body),r}function Ez(e,t){const r=Os(e);if(uj(e))return r;if(!Io(e)){let a=Jc(e);for(;a&&!Xf(a);){if(qi(a)&&!Q_(a))return a;a=Jc(a)}return r}let n=WD(e,t);for(;n&&iie(n)&&Q_(n);)n=WD(n,t);return n&&Xf(n)&&Q_(n)&&!gT(n)?r:n||die(e)||r}const Sie=async function(e){const t=this.getOffsetParent||Ez,r=this.getDimensions,n=await r(e.floating);return{reference:_ie(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Cie(e){return Gi(e).direction==="rtl"}const Eie={convertOffsetParentRelativeRectToViewportRelativeRect:mie,getDocumentElement:Bo,getClippingRect:jie,getOffsetParent:Ez,getElementRects:Sie,getClientRects:vie,getDimensions:Nie,getScale:ff,isElement:qi,isRTL:Cie};function kz(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function kie(e,t){let r=null,n;const a=Bo(e);function i(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const u=e.getBoundingClientRect(),{left:d,top:h,width:f,height:p}=u;if(l||t(),!f||!p)return;const m=My(h),v=My(a.clientWidth-(d+f)),g=My(a.clientHeight-(h+p)),x=My(d),b={rootMargin:-m+"px "+-v+"px "+-g+"px "+-x+"px",threshold:js(0,Zc(1,c))||1};let N=!0;function j(_){const S=_[0].intersectionRatio;if(S!==c){if(!N)return o();S?o(!1,S):n=setTimeout(()=>{o(!1,1e-7)},1e3)}S===1&&!kz(u,e.getBoundingClientRect())&&o(),N=!1}try{r=new IntersectionObserver(j,{...b,root:a.ownerDocument})}catch{r=new IntersectionObserver(j,b)}r.observe(e)}return o(!0),i}function Aie(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,u=yT(e),d=a||i?[...u?cg(u):[],...cg(t)]:[];d.forEach(x=>{a&&x.addEventListener("scroll",r,{passive:!0}),i&&x.addEventListener("resize",r)});const h=u&&l?kie(u,r):null;let f=-1,p=null;o&&(p=new ResizeObserver(x=>{let[y]=x;y&&y.target===u&&p&&(p.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var b;(b=p)==null||b.observe(t)})),r()}),u&&!c&&p.observe(u),p.observe(t));let m,v=c?Ad(e):null;c&&g();function g(){const x=Ad(e);v&&!kz(v,x)&&r(),v=x,m=requestAnimationFrame(g)}return r(),()=>{var x;d.forEach(y=>{a&&y.removeEventListener("scroll",r),i&&y.removeEventListener("resize",r)}),h==null||h(),(x=p)==null||x.disconnect(),p=null,c&&cancelAnimationFrame(m)}}const Pie=eie,Tie=tie,Rie=Qse,Oie=nie,Iie=Zse,qD=Xse,Die=rie,Mie=(e,t,r)=>{const n=new Map,a={platform:Eie,...r},i={...a.platform,_c:n};return Yse(e,t,{...a,platform:i})};var $ie=typeof document<"u",Fie=function(){},Gb=$ie?w.useLayoutEffect:Fie;function M0(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!M0(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const i=a[n];if(!(i==="_owner"&&e.$$typeof)&&!M0(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function Az(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function GD(e,t){const r=Az(e);return Math.round(t*r)/r}function Z_(e){const t=w.useRef(e);return Gb(()=>{t.current=e}),t}function Lie(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=e,[d,h]=w.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[f,p]=w.useState(n);M0(f,n)||p(n);const[m,v]=w.useState(null),[g,x]=w.useState(null),y=w.useCallback($=>{$!==_.current&&(_.current=$,v($))},[]),b=w.useCallback($=>{$!==S.current&&(S.current=$,x($))},[]),N=i||m,j=o||g,_=w.useRef(null),S=w.useRef(null),C=w.useRef(d),E=c!=null,k=Z_(c),P=Z_(a),A=Z_(u),O=w.useCallback(()=>{if(!_.current||!S.current)return;const $={placement:t,strategy:r,middleware:f};P.current&&($.platform=P.current),Mie(_.current,S.current,$).then(D=>{const W={...D,isPositioned:A.current!==!1};I.current&&!M0(C.current,W)&&(C.current=W,ei.flushSync(()=>{h(W)}))})},[f,t,r,P,A]);Gb(()=>{u===!1&&C.current.isPositioned&&(C.current.isPositioned=!1,h($=>({...$,isPositioned:!1})))},[u]);const I=w.useRef(!1);Gb(()=>(I.current=!0,()=>{I.current=!1}),[]),Gb(()=>{if(N&&(_.current=N),j&&(S.current=j),N&&j){if(k.current)return k.current(N,j,O);O()}},[N,j,O,k,E]);const R=w.useMemo(()=>({reference:_,floating:S,setReference:y,setFloating:b}),[y,b]),M=w.useMemo(()=>({reference:N,floating:j}),[N,j]),B=w.useMemo(()=>{const $={position:r,left:0,top:0};if(!M.floating)return $;const D=GD(M.floating,d.x),W=GD(M.floating,d.y);return l?{...$,transform:"translate("+D+"px, "+W+"px)",...Az(M.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:D,top:W}},[r,l,M.floating,d.x,d.y]);return w.useMemo(()=>({...d,update:O,refs:R,elements:M,floatingStyles:B}),[d,O,R,M,B])}const Bie=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?qD({element:n.current,padding:a}).fn(r):{}:n?qD({element:n,padding:a}).fn(r):{}}}},Uie=(e,t)=>({...Pie(e),options:[e,t]}),Vie=(e,t)=>({...Tie(e),options:[e,t]}),zie=(e,t)=>({...Die(e),options:[e,t]}),Wie=(e,t)=>({...Rie(e),options:[e,t]}),qie=(e,t)=>({...Oie(e),options:[e,t]}),Gie=(e,t)=>({...Iie(e),options:[e,t]}),Hie=(e,t)=>({...Bie(e),options:[e,t]});var Kie="Arrow",Pz=w.forwardRef((e,t)=>{const{children:r,width:n=10,height:a=5,...i}=e;return s.jsx(Me.svg,{...i,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:s.jsx("polygon",{points:"0,0 30,0 15,10"})})});Pz.displayName=Kie;var Yie=Pz;function hj(e){const[t,r]=w.useState(void 0);return Xr(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=e.offsetWidth,l=e.offsetHeight;r({width:o,height:l})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var wT="Popper",[Tz,lu]=an(wT),[Xie,Rz]=Tz(wT),Oz=e=>{const{__scopePopper:t,children:r}=e,[n,a]=w.useState(null);return s.jsx(Xie,{scope:t,anchor:n,onAnchorChange:a,children:r})};Oz.displayName=wT;var Iz="PopperAnchor",Dz=w.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...a}=e,i=Rz(Iz,r),o=w.useRef(null),l=ct(t,o);return w.useEffect(()=>{i.onAnchorChange((n==null?void 0:n.current)||o.current)}),n?null:s.jsx(Me.div,{...a,ref:l})});Dz.displayName=Iz;var jT="PopperContent",[Qie,Zie]=Tz(jT),Mz=w.forwardRef((e,t)=>{var se,ye,ne,le,ve,K;const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:m,...v}=e,g=Rz(jT,r),[x,y]=w.useState(null),b=ct(t,ke=>y(ke)),[N,j]=w.useState(null),_=hj(N),S=(_==null?void 0:_.width)??0,C=(_==null?void 0:_.height)??0,E=n+(i!=="center"?"-"+i:""),k=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},P=Array.isArray(u)?u:[u],A=P.length>0,O={padding:k,boundary:P.filter(eoe),altBoundary:A},{refs:I,floatingStyles:R,placement:M,isPositioned:B,middlewareData:$}=Lie({strategy:"fixed",placement:E,whileElementsMounted:(...ke)=>Aie(...ke,{animationFrame:p==="always"}),elements:{reference:g.anchor},middleware:[Uie({mainAxis:a+C,alignmentAxis:o}),c&&Vie({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?zie():void 0,...O}),c&&Wie({...O}),qie({...O,apply:({elements:ke,rects:Ce,availableWidth:Ge,availableHeight:He})=>{const{width:It,height:ar}=Ce.reference,Kt=ke.floating.style;Kt.setProperty("--radix-popper-available-width",`${Ge}px`),Kt.setProperty("--radix-popper-available-height",`${He}px`),Kt.setProperty("--radix-popper-anchor-width",`${It}px`),Kt.setProperty("--radix-popper-anchor-height",`${ar}px`)}}),N&&Hie({element:N,padding:l}),toe({arrowWidth:S,arrowHeight:C}),f&&Gie({strategy:"referenceHidden",...O})]}),[D,W]=Lz(M),Z=Yr(m);Xr(()=>{B&&(Z==null||Z())},[B,Z]);const U=(se=$.arrow)==null?void 0:se.x,Y=(ye=$.arrow)==null?void 0:ye.y,ae=((ne=$.arrow)==null?void 0:ne.centerOffset)!==0,[ie,he]=w.useState();return Xr(()=>{x&&he(window.getComputedStyle(x).zIndex)},[x]),s.jsx("div",{ref:I.setFloating,"data-radix-popper-content-wrapper":"",style:{...R,transform:B?R.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ie,"--radix-popper-transform-origin":[(le=$.transformOrigin)==null?void 0:le.x,(ve=$.transformOrigin)==null?void 0:ve.y].join(" "),...((K=$.hide)==null?void 0:K.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:s.jsx(Qie,{scope:r,placedSide:D,onArrowChange:j,arrowX:U,arrowY:Y,shouldHideArrow:ae,children:s.jsx(Me.div,{"data-side":D,"data-align":W,...v,ref:b,style:{...v.style,animation:B?void 0:"none"}})})})});Mz.displayName=jT;var $z="PopperArrow",Jie={top:"bottom",right:"left",bottom:"top",left:"right"},Fz=w.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,i=Zie($z,n),o=Jie[i.placedSide];return s.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:s.jsx(Yie,{...a,ref:r,style:{...a.style,display:"block"}})})});Fz.displayName=$z;function eoe(e){return e!==null}var toe=e=>({name:"transformOrigin",options:e,fn(t){var g,x,y;const{placement:r,rects:n,middlewareData:a}=t,o=((g=a.arrow)==null?void 0:g.centerOffset)!==0,l=o?0:e.arrowWidth,c=o?0:e.arrowHeight,[u,d]=Lz(r),h={start:"0%",center:"50%",end:"100%"}[d],f=(((x=a.arrow)==null?void 0:x.x)??0)+l/2,p=(((y=a.arrow)==null?void 0:y.y)??0)+c/2;let m="",v="";return u==="bottom"?(m=o?h:`${f}px`,v=`${-c}px`):u==="top"?(m=o?h:`${f}px`,v=`${n.floating.height+c}px`):u==="right"?(m=`${-c}px`,v=o?h:`${p}px`):u==="left"&&(m=`${n.floating.width+c}px`,v=o?h:`${p}px`),{data:{x:m,y:v}}}});function Lz(e){const[t,r="center"]=e.split("-");return[t,r]}var fj=Oz,Sx=Dz,pj=Mz,mj=Fz,[vj,nQe]=an("Tooltip",[lu]),gj=lu(),Bz="TooltipProvider",roe=700,FC="tooltip.open",[noe,NT]=vj(Bz),Uz=e=>{const{__scopeTooltip:t,delayDuration:r=roe,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:i}=e,o=w.useRef(!0),l=w.useRef(!1),c=w.useRef(0);return w.useEffect(()=>{const u=c.current;return()=>window.clearTimeout(u)},[]),s.jsx(noe,{scope:t,isOpenDelayedRef:o,delayDuration:r,onOpen:w.useCallback(()=>{window.clearTimeout(c.current),o.current=!1},[]),onClose:w.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>o.current=!0,n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:w.useCallback(u=>{l.current=u},[]),disableHoverableContent:a,children:i})};Uz.displayName=Bz;var ug="Tooltip",[aoe,xj]=vj(ug),Vz=e=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:a,onOpenChange:i,disableHoverableContent:o,delayDuration:l}=e,c=NT(ug,e.__scopeTooltip),u=gj(t),[d,h]=w.useState(null),f=pn(),p=w.useRef(0),m=o??c.disableHoverableContent,v=l??c.delayDuration,g=w.useRef(!1),[x,y]=Ba({prop:n,defaultProp:a??!1,onChange:S=>{S?(c.onOpen(),document.dispatchEvent(new CustomEvent(FC))):c.onClose(),i==null||i(S)},caller:ug}),b=w.useMemo(()=>x?g.current?"delayed-open":"instant-open":"closed",[x]),N=w.useCallback(()=>{window.clearTimeout(p.current),p.current=0,g.current=!1,y(!0)},[y]),j=w.useCallback(()=>{window.clearTimeout(p.current),p.current=0,y(!1)},[y]),_=w.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{g.current=!0,y(!0),p.current=0},v)},[v,y]);return w.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),s.jsx(fj,{...u,children:s.jsx(aoe,{scope:t,contentId:f,open:x,stateAttribute:b,trigger:d,onTriggerChange:h,onTriggerEnter:w.useCallback(()=>{c.isOpenDelayedRef.current?_():N()},[c.isOpenDelayedRef,_,N]),onTriggerLeave:w.useCallback(()=>{m?j():(window.clearTimeout(p.current),p.current=0)},[j,m]),onOpen:N,onClose:j,disableHoverableContent:m,children:r})})};Vz.displayName=ug;var LC="TooltipTrigger",zz=w.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=xj(LC,r),i=NT(LC,r),o=gj(r),l=w.useRef(null),c=ct(t,l,a.onTriggerChange),u=w.useRef(!1),d=w.useRef(!1),h=w.useCallback(()=>u.current=!1,[]);return w.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),s.jsx(Sx,{asChild:!0,...o,children:s.jsx(Me.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:c,onPointerMove:Ne(e.onPointerMove,f=>{f.pointerType!=="touch"&&!d.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),d.current=!0)}),onPointerLeave:Ne(e.onPointerLeave,()=>{a.onTriggerLeave(),d.current=!1}),onPointerDown:Ne(e.onPointerDown,()=>{a.open&&a.onClose(),u.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:Ne(e.onFocus,()=>{u.current||a.onOpen()}),onBlur:Ne(e.onBlur,a.onClose),onClick:Ne(e.onClick,a.onClose)})})});zz.displayName=LC;var soe="TooltipPortal",[aQe,ioe]=vj(soe,{forceMount:void 0}),Qf="TooltipContent",Wz=w.forwardRef((e,t)=>{const r=ioe(Qf,e.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...i}=e,o=xj(Qf,e.__scopeTooltip);return s.jsx(gn,{present:n||o.open,children:o.disableHoverableContent?s.jsx(qz,{side:a,...i,ref:t}):s.jsx(ooe,{side:a,...i,ref:t})})}),ooe=w.forwardRef((e,t)=>{const r=xj(Qf,e.__scopeTooltip),n=NT(Qf,e.__scopeTooltip),a=w.useRef(null),i=ct(t,a),[o,l]=w.useState(null),{trigger:c,onClose:u}=r,d=a.current,{onPointerInTransitChange:h}=n,f=w.useCallback(()=>{l(null),h(!1)},[h]),p=w.useCallback((m,v)=>{const g=m.currentTarget,x={x:m.clientX,y:m.clientY},y=hoe(x,g.getBoundingClientRect()),b=foe(x,y),N=poe(v.getBoundingClientRect()),j=voe([...b,...N]);l(j),h(!0)},[h]);return w.useEffect(()=>()=>f(),[f]),w.useEffect(()=>{if(c&&d){const m=g=>p(g,d),v=g=>p(g,c);return c.addEventListener("pointerleave",m),d.addEventListener("pointerleave",v),()=>{c.removeEventListener("pointerleave",m),d.removeEventListener("pointerleave",v)}}},[c,d,p,f]),w.useEffect(()=>{if(o){const m=v=>{const g=v.target,x={x:v.clientX,y:v.clientY},y=(c==null?void 0:c.contains(g))||(d==null?void 0:d.contains(g)),b=!moe(x,o);y?f():b&&(f(),u())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[c,d,o,u,f]),s.jsx(qz,{...e,ref:i})}),[loe,coe]=vj(ug,{isInside:!1}),uoe=EV("TooltipContent"),qz=w.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:o,...l}=e,c=xj(Qf,r),u=gj(r),{onClose:d}=c;return w.useEffect(()=>(document.addEventListener(FC,d),()=>document.removeEventListener(FC,d)),[d]),w.useEffect(()=>{if(c.trigger){const h=f=>{const p=f.target;p!=null&&p.contains(c.trigger)&&d()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[c.trigger,d]),s.jsx(Yd,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:d,children:s.jsxs(pj,{"data-state":c.stateAttribute,...u,...l,ref:t,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[s.jsx(uoe,{children:n}),s.jsx(loe,{scope:r,isInside:!0,children:s.jsx(Ine,{id:c.contentId,role:"tooltip",children:a||n})})]})})});Wz.displayName=Qf;var Gz="TooltipArrow",doe=w.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=gj(r);return coe(Gz,r).isInside?null:s.jsx(mj,{...a,...n,ref:t})});doe.displayName=Gz;function hoe(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(r,n,a,i)){case i:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function foe(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function poe(e){const{top:t,right:r,bottom:n,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function moe(e,t){const{x:r,y:n}=e;let a=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i],c=t[o],u=l.x,d=l.y,h=c.x,f=c.y;d>n!=f>n&&r<(h-u)*(n-d)/(f-d)+u&&(a=!a)}return a}function voe(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),goe(t)}function goe(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const a=e[n];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const a=e[n];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var xoe=Uz,yoe=Vz,boe=zz,Hz=Wz;const BC=xoe,HD=yoe,KD=boe,UC=w.forwardRef(({className:e,sideOffset:t=4,...r},n)=>s.jsx(Hz,{ref:n,sideOffset:t,className:me("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));UC.displayName=Hz.displayName;var Kp=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Pd=typeof window>"u"||"Deno"in globalThis;function Ia(){}function woe(e,t){return typeof e=="function"?e(t):e}function VC(e){return typeof e=="number"&&e>=0&&e!==1/0}function Kz(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Uc(e,t){return typeof e=="function"?e(t):e}function qs(e,t){return typeof e=="function"?e(t):e}function YD(e,t){const{type:r="all",exact:n,fetchStatus:a,predicate:i,queryKey:o,stale:l}=e;if(o){if(n){if(t.queryHash!==_T(o,t.options))return!1}else if(!dg(t.queryKey,o))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||a&&a!==t.state.fetchStatus||i&&!i(t))}function XD(e,t){const{exact:r,status:n,predicate:a,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(Td(t.options.mutationKey)!==Td(i))return!1}else if(!dg(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function _T(e,t){return((t==null?void 0:t.queryKeyHashFn)||Td)(e)}function Td(e){return JSON.stringify(e,(t,r)=>zC(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function dg(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>dg(e[r],t[r])):!1}function Yz(e,t){if(e===t)return e;const r=QD(e)&&QD(t);if(r||zC(e)&&zC(t)){const n=r?e:Object.keys(e),a=n.length,i=r?t:Object.keys(t),o=i.length,l=r?[]:{},c=new Set(n);let u=0;for(let d=0;d<o;d++){const h=r?d:i[d];(!r&&c.has(h)||r)&&e[h]===void 0&&t[h]===void 0?(l[h]=void 0,u++):(l[h]=Yz(e[h],t[h]),l[h]===e[h]&&e[h]!==void 0&&u++)}return a===o&&u===a?e:l}return t}function $0(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function QD(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function zC(e){if(!ZD(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!ZD(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function ZD(e){return Object.prototype.toString.call(e)==="[object Object]"}function joe(e){return new Promise(t=>{setTimeout(t,e)})}function WC(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?Yz(e,t):t}function Noe(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function _oe(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var ST=Symbol();function Xz(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===ST?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Qz(e,t){return typeof e=="function"?e(...t):!!e}var sd,dc,Tf,JB,Soe=(JB=class extends Kp{constructor(){super();at(this,sd);at(this,dc);at(this,Tf);Ue(this,Tf,t=>{if(!Pd&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){X(this,dc)||this.setEventListener(X(this,Tf))}onUnsubscribe(){var t;this.hasListeners()||((t=X(this,dc))==null||t.call(this),Ue(this,dc,void 0))}setEventListener(t){var r;Ue(this,Tf,t),(r=X(this,dc))==null||r.call(this),Ue(this,dc,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){X(this,sd)!==t&&(Ue(this,sd,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof X(this,sd)=="boolean"?X(this,sd):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},sd=new WeakMap,dc=new WeakMap,Tf=new WeakMap,JB),CT=new Soe,Rf,hc,Of,e6,Coe=(e6=class extends Kp{constructor(){super();at(this,Rf,!0);at(this,hc);at(this,Of);Ue(this,Of,t=>{if(!Pd&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){X(this,hc)||this.setEventListener(X(this,Of))}onUnsubscribe(){var t;this.hasListeners()||((t=X(this,hc))==null||t.call(this),Ue(this,hc,void 0))}setEventListener(t){var r;Ue(this,Of,t),(r=X(this,hc))==null||r.call(this),Ue(this,hc,t(this.setOnline.bind(this)))}setOnline(t){X(this,Rf)!==t&&(Ue(this,Rf,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return X(this,Rf)}},Rf=new WeakMap,hc=new WeakMap,Of=new WeakMap,e6),F0=new Coe;function qC(){let e,t;const r=new Promise((a,i)=>{e=a,t=i});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}function Eoe(e){return Math.min(1e3*2**e,3e4)}function Zz(e){return(e??"online")==="online"?F0.isOnline():!0}var Jz=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function J_(e){return e instanceof Jz}function e8(e){let t=!1,r=0,n=!1,a;const i=qC(),o=v=>{var g;n||(f(new Jz(v)),(g=e.abort)==null||g.call(e))},l=()=>{t=!0},c=()=>{t=!1},u=()=>CT.isFocused()&&(e.networkMode==="always"||F0.isOnline())&&e.canRun(),d=()=>Zz(e.networkMode)&&e.canRun(),h=v=>{var g;n||(n=!0,(g=e.onSuccess)==null||g.call(e,v),a==null||a(),i.resolve(v))},f=v=>{var g;n||(n=!0,(g=e.onError)==null||g.call(e,v),a==null||a(),i.reject(v))},p=()=>new Promise(v=>{var g;a=x=>{(n||u())&&v(x)},(g=e.onPause)==null||g.call(e)}).then(()=>{var v;a=void 0,n||(v=e.onContinue)==null||v.call(e)}),m=()=>{if(n)return;let v;const g=r===0?e.initialPromise:void 0;try{v=g??e.fn()}catch(x){v=Promise.reject(x)}Promise.resolve(v).then(h).catch(x=>{var _;if(n)return;const y=e.retry??(Pd?0:3),b=e.retryDelay??Eoe,N=typeof b=="function"?b(r,x):b,j=y===!0||typeof y=="number"&&r<y||typeof y=="function"&&y(r,x);if(t||!j){f(x);return}r++,(_=e.onFail)==null||_.call(e,r,x),joe(N).then(()=>u()?void 0:p()).then(()=>{t?f(x):m()})})};return{promise:i,cancel:o,continue:()=>(a==null||a(),i),cancelRetry:l,continueRetry:c,canStart:d,start:()=>(d()?m():p().then(m),i)}}var koe=e=>setTimeout(e,0);function Aoe(){let e=[],t=0,r=l=>{l()},n=l=>{l()},a=koe;const i=l=>{t?e.push(l):a(()=>{r(l)})},o=()=>{const l=e;e=[],l.length&&a(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{a=l}}}var Cn=Aoe(),id,t6,t8=(t6=class{constructor(){at(this,id)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),VC(this.gcTime)&&Ue(this,id,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Pd?1/0:5*60*1e3))}clearGcTimeout(){X(this,id)&&(clearTimeout(X(this,id)),Ue(this,id,void 0))}},id=new WeakMap,t6),If,od,Ws,ld,fa,hx,cd,_i,Zo,r6,Poe=(r6=class extends t8{constructor(t){super();at(this,_i);at(this,If);at(this,od);at(this,Ws);at(this,ld);at(this,fa);at(this,hx);at(this,cd);Ue(this,cd,!1),Ue(this,hx,t.defaultOptions),this.setOptions(t.options),this.observers=[],Ue(this,ld,t.client),Ue(this,Ws,X(this,ld).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Ue(this,If,Toe(this.options)),this.state=t.state??X(this,If),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=X(this,fa))==null?void 0:t.promise}setOptions(t){this.options={...X(this,hx),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&X(this,Ws).remove(this)}setData(t,r){const n=WC(this.state.data,t,this.options);return kt(this,_i,Zo).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){kt(this,_i,Zo).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=X(this,fa))==null?void 0:n.promise;return(a=X(this,fa))==null||a.cancel(t),r?r.then(Ia).catch(Ia):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(X(this,If))}isActive(){return this.observers.some(t=>qs(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ST||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Uc(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Kz(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=X(this,fa))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=X(this,fa))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),X(this,Ws).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(X(this,fa)&&(X(this,cd)?X(this,fa).cancel({revert:!0}):X(this,fa).cancelRetry()),this.scheduleGc()),X(this,Ws).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||kt(this,_i,Zo).call(this,{type:"invalidate"})}fetch(t,r){var u,d,h;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(X(this,fa))return X(this,fa).continueRetry(),X(this,fa).promise}if(t&&this.setOptions(t),!this.options.queryFn){const f=this.observers.find(p=>p.options.queryFn);f&&this.setOptions(f.options)}const n=new AbortController,a=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(Ue(this,cd,!0),n.signal)})},i=()=>{const f=Xz(this.options,r),m=(()=>{const v={client:X(this,ld),queryKey:this.queryKey,meta:this.meta};return a(v),v})();return Ue(this,cd,!1),this.options.persister?this.options.persister(f,m,this):f(m)},l=(()=>{const f={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:X(this,ld),state:this.state,fetchFn:i};return a(f),f})();(u=this.options.behavior)==null||u.onFetch(l,this),Ue(this,od,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=l.fetchOptions)==null?void 0:d.meta))&&kt(this,_i,Zo).call(this,{type:"fetch",meta:(h=l.fetchOptions)==null?void 0:h.meta});const c=f=>{var p,m,v,g;J_(f)&&f.silent||kt(this,_i,Zo).call(this,{type:"error",error:f}),J_(f)||((m=(p=X(this,Ws).config).onError)==null||m.call(p,f,this),(g=(v=X(this,Ws).config).onSettled)==null||g.call(v,this.state.data,f,this)),this.scheduleGc()};return Ue(this,fa,e8({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,abort:n.abort.bind(n),onSuccess:f=>{var p,m,v,g;if(f===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(x){c(x);return}(m=(p=X(this,Ws).config).onSuccess)==null||m.call(p,f,this),(g=(v=X(this,Ws).config).onSettled)==null||g.call(v,f,this.state.error,this),this.scheduleGc()},onError:c,onFail:(f,p)=>{kt(this,_i,Zo).call(this,{type:"failed",failureCount:f,error:p})},onPause:()=>{kt(this,_i,Zo).call(this,{type:"pause"})},onContinue:()=>{kt(this,_i,Zo).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),X(this,fa).start()}},If=new WeakMap,od=new WeakMap,Ws=new WeakMap,ld=new WeakMap,fa=new WeakMap,hx=new WeakMap,cd=new WeakMap,_i=new WeakSet,Zo=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...r8(n.data,this.options),fetchMeta:t.meta??null};case"success":return Ue(this,od,void 0),{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return J_(a)&&a.revert&&X(this,od)?{...X(this,od),fetchStatus:"idle"}:{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),Cn.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),X(this,Ws).notify({query:this,type:"updated",action:t})})},r6);function r8(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Zz(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Toe(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var co,n6,Roe=(n6=class extends Kp{constructor(t={}){super();at(this,co);this.config=t,Ue(this,co,new Map)}build(t,r,n){const a=r.queryKey,i=r.queryHash??_T(a,r);let o=this.get(i);return o||(o=new Poe({client:t,queryKey:a,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(o)),o}add(t){X(this,co).has(t.queryHash)||(X(this,co).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=X(this,co).get(t.queryHash);r&&(t.destroy(),r===t&&X(this,co).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Cn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return X(this,co).get(t)}getAll(){return[...X(this,co).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>YD(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>YD(t,n)):r}notify(t){Cn.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Cn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Cn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},co=new WeakMap,n6),uo,Ta,ud,ho,Jl,a6,Ooe=(a6=class extends t8{constructor(t){super();at(this,ho);at(this,uo);at(this,Ta);at(this,ud);this.mutationId=t.mutationId,Ue(this,Ta,t.mutationCache),Ue(this,uo,[]),this.state=t.state||n8(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){X(this,uo).includes(t)||(X(this,uo).push(t),this.clearGcTimeout(),X(this,Ta).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Ue(this,uo,X(this,uo).filter(r=>r!==t)),this.scheduleGc(),X(this,Ta).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){X(this,uo).length||(this.state.status==="pending"?this.scheduleGc():X(this,Ta).remove(this))}continue(){var t;return((t=X(this,ud))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,o,l,c,u,d,h,f,p,m,v,g,x,y,b,N,j,_,S,C;const r=()=>{kt(this,ho,Jl).call(this,{type:"continue"})};Ue(this,ud,e8({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(E,k)=>{kt(this,ho,Jl).call(this,{type:"failed",failureCount:E,error:k})},onPause:()=>{kt(this,ho,Jl).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>X(this,Ta).canRun(this)}));const n=this.state.status==="pending",a=!X(this,ud).canStart();try{if(n)r();else{kt(this,ho,Jl).call(this,{type:"pending",variables:t,isPaused:a}),await((o=(i=X(this,Ta).config).onMutate)==null?void 0:o.call(i,t,this));const k=await((c=(l=this.options).onMutate)==null?void 0:c.call(l,t));k!==this.state.context&&kt(this,ho,Jl).call(this,{type:"pending",context:k,variables:t,isPaused:a})}const E=await X(this,ud).start();return await((d=(u=X(this,Ta).config).onSuccess)==null?void 0:d.call(u,E,t,this.state.context,this)),await((f=(h=this.options).onSuccess)==null?void 0:f.call(h,E,t,this.state.context)),await((m=(p=X(this,Ta).config).onSettled)==null?void 0:m.call(p,E,null,this.state.variables,this.state.context,this)),await((g=(v=this.options).onSettled)==null?void 0:g.call(v,E,null,t,this.state.context)),kt(this,ho,Jl).call(this,{type:"success",data:E}),E}catch(E){try{throw await((y=(x=X(this,Ta).config).onError)==null?void 0:y.call(x,E,t,this.state.context,this)),await((N=(b=this.options).onError)==null?void 0:N.call(b,E,t,this.state.context)),await((_=(j=X(this,Ta).config).onSettled)==null?void 0:_.call(j,void 0,E,this.state.variables,this.state.context,this)),await((C=(S=this.options).onSettled)==null?void 0:C.call(S,void 0,E,t,this.state.context)),E}finally{kt(this,ho,Jl).call(this,{type:"error",error:E})}}finally{X(this,Ta).runNext(this)}}},uo=new WeakMap,Ta=new WeakMap,ud=new WeakMap,ho=new WeakSet,Jl=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Cn.batch(()=>{X(this,uo).forEach(n=>{n.onMutationUpdate(t)}),X(this,Ta).notify({mutation:this,type:"updated",action:t})})},a6);function n8(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var nl,Si,fx,s6,Ioe=(s6=class extends Kp{constructor(t={}){super();at(this,nl);at(this,Si);at(this,fx);this.config=t,Ue(this,nl,new Set),Ue(this,Si,new Map),Ue(this,fx,0)}build(t,r,n){const a=new Ooe({mutationCache:this,mutationId:++py(this,fx)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){X(this,nl).add(t);const r=$y(t);if(typeof r=="string"){const n=X(this,Si).get(r);n?n.push(t):X(this,Si).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(X(this,nl).delete(t)){const r=$y(t);if(typeof r=="string"){const n=X(this,Si).get(r);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&X(this,Si).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=$y(t);if(typeof r=="string"){const n=X(this,Si).get(r),a=n==null?void 0:n.find(i=>i.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n;const r=$y(t);if(typeof r=="string"){const a=(n=X(this,Si).get(r))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Cn.batch(()=>{X(this,nl).forEach(t=>{this.notify({type:"removed",mutation:t})}),X(this,nl).clear(),X(this,Si).clear()})}getAll(){return Array.from(X(this,nl))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>XD(r,n))}findAll(t={}){return this.getAll().filter(r=>XD(t,r))}notify(t){Cn.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Cn.batch(()=>Promise.all(t.map(r=>r.continue().catch(Ia))))}},nl=new WeakMap,Si=new WeakMap,fx=new WeakMap,s6);function $y(e){var t;return(t=e.options.scope)==null?void 0:t.id}function JD(e){return{onFetch:(t,r)=>{var d,h,f,p,m;const n=t.options,a=(f=(h=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((p=t.state.data)==null?void 0:p.pages)||[],o=((m=t.state.data)==null?void 0:m.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let v=!1;const g=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?v=!0:t.signal.addEventListener("abort",()=>{v=!0}),t.signal)})},x=Xz(t.options,t.fetchOptions),y=async(b,N,j)=>{if(v)return Promise.reject();if(N==null&&b.pages.length)return Promise.resolve(b);const S=(()=>{const P={client:t.client,queryKey:t.queryKey,pageParam:N,direction:j?"backward":"forward",meta:t.options.meta};return g(P),P})(),C=await x(S),{maxPages:E}=t.options,k=j?_oe:Noe;return{pages:k(b.pages,C,E),pageParams:k(b.pageParams,N,E)}};if(a&&i.length){const b=a==="backward",N=b?Doe:eM,j={pages:i,pageParams:o},_=N(n,j);l=await y(j,_,b)}else{const b=e??i.length;do{const N=c===0?o[0]??n.initialPageParam:eM(n,l);if(c>0&&N==null)break;l=await y(l,N),c++}while(c<b)}return l};t.options.persister?t.fetchFn=()=>{var v,g;return(g=(v=t.options).persister)==null?void 0:g.call(v,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function eM(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function Doe(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var qr,fc,pc,Df,Mf,mc,$f,Ff,i6,Moe=(i6=class{constructor(e={}){at(this,qr);at(this,fc);at(this,pc);at(this,Df);at(this,Mf);at(this,mc);at(this,$f);at(this,Ff);Ue(this,qr,e.queryCache||new Roe),Ue(this,fc,e.mutationCache||new Ioe),Ue(this,pc,e.defaultOptions||{}),Ue(this,Df,new Map),Ue(this,Mf,new Map),Ue(this,mc,0)}mount(){py(this,mc)._++,X(this,mc)===1&&(Ue(this,$f,CT.subscribe(async e=>{e&&(await this.resumePausedMutations(),X(this,qr).onFocus())})),Ue(this,Ff,F0.subscribe(async e=>{e&&(await this.resumePausedMutations(),X(this,qr).onOnline())})))}unmount(){var e,t;py(this,mc)._--,X(this,mc)===0&&((e=X(this,$f))==null||e.call(this),Ue(this,$f,void 0),(t=X(this,Ff))==null||t.call(this),Ue(this,Ff,void 0))}isFetching(e){return X(this,qr).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return X(this,fc).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=X(this,qr).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=X(this,qr).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Uc(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return X(this,qr).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=X(this,qr).get(n.queryHash),i=a==null?void 0:a.state.data,o=woe(t,i);if(o!==void 0)return X(this,qr).build(this,n).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return Cn.batch(()=>X(this,qr).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=X(this,qr).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=X(this,qr);Cn.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=X(this,qr);return Cn.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=Cn.batch(()=>X(this,qr).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(Ia).catch(Ia)}invalidateQueries(e,t={}){return Cn.batch(()=>(X(this,qr).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=Cn.batch(()=>X(this,qr).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,r);return r.throwOnError||(i=i.catch(Ia)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(Ia)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=X(this,qr).build(this,t);return r.isStaleByTime(Uc(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Ia).catch(Ia)}fetchInfiniteQuery(e){return e.behavior=JD(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Ia).catch(Ia)}ensureInfiniteQueryData(e){return e.behavior=JD(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return F0.isOnline()?X(this,fc).resumePausedMutations():Promise.resolve()}getQueryCache(){return X(this,qr)}getMutationCache(){return X(this,fc)}getDefaultOptions(){return X(this,pc)}setDefaultOptions(e){Ue(this,pc,e)}setQueryDefaults(e,t){X(this,Df).set(Td(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...X(this,Df).values()],r={};return t.forEach(n=>{dg(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){X(this,Mf).set(Td(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...X(this,Mf).values()],r={};return t.forEach(n=>{dg(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...X(this,pc).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=_T(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===ST&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...X(this,pc).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){X(this,qr).clear(),X(this,fc).clear()}},qr=new WeakMap,fc=new WeakMap,pc=new WeakMap,Df=new WeakMap,Mf=new WeakMap,mc=new WeakMap,$f=new WeakMap,Ff=new WeakMap,i6),Ya,Wt,px,Ra,dd,Lf,vc,gc,mx,Bf,Uf,hd,fd,xc,Vf,rr,lv,GC,HC,KC,YC,XC,QC,ZC,a8,o6,$oe=(o6=class extends Kp{constructor(t,r){super();at(this,rr);at(this,Ya);at(this,Wt);at(this,px);at(this,Ra);at(this,dd);at(this,Lf);at(this,vc);at(this,gc);at(this,mx);at(this,Bf);at(this,Uf);at(this,hd);at(this,fd);at(this,xc);at(this,Vf,new Set);this.options=r,Ue(this,Ya,t),Ue(this,gc,null),Ue(this,vc,qC()),this.options.experimental_prefetchInRender||X(this,vc).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(X(this,Wt).addObserver(this),tM(X(this,Wt),this.options)?kt(this,rr,lv).call(this):this.updateResult(),kt(this,rr,YC).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return JC(X(this,Wt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return JC(X(this,Wt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,kt(this,rr,XC).call(this),kt(this,rr,QC).call(this),X(this,Wt).removeObserver(this)}setOptions(t){const r=this.options,n=X(this,Wt);if(this.options=X(this,Ya).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof qs(this.options.enabled,X(this,Wt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");kt(this,rr,ZC).call(this),X(this,Wt).setOptions(this.options),r._defaulted&&!$0(this.options,r)&&X(this,Ya).getQueryCache().notify({type:"observerOptionsUpdated",query:X(this,Wt),observer:this});const a=this.hasListeners();a&&rM(X(this,Wt),n,this.options,r)&&kt(this,rr,lv).call(this),this.updateResult(),a&&(X(this,Wt)!==n||qs(this.options.enabled,X(this,Wt))!==qs(r.enabled,X(this,Wt))||Uc(this.options.staleTime,X(this,Wt))!==Uc(r.staleTime,X(this,Wt)))&&kt(this,rr,GC).call(this);const i=kt(this,rr,HC).call(this);a&&(X(this,Wt)!==n||qs(this.options.enabled,X(this,Wt))!==qs(r.enabled,X(this,Wt))||i!==X(this,xc))&&kt(this,rr,KC).call(this,i)}getOptimisticResult(t){const r=X(this,Ya).getQueryCache().build(X(this,Ya),t),n=this.createResult(r,t);return Loe(this,n)&&(Ue(this,Ra,n),Ue(this,Lf,this.options),Ue(this,dd,X(this,Wt).state)),n}getCurrentResult(){return X(this,Ra)}trackResult(t,r){return new Proxy(t,{get:(n,a)=>(this.trackProp(a),r==null||r(a),Reflect.get(n,a))})}trackProp(t){X(this,Vf).add(t)}getCurrentQuery(){return X(this,Wt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=X(this,Ya).defaultQueryOptions(t),n=X(this,Ya).getQueryCache().build(X(this,Ya),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return kt(this,rr,lv).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),X(this,Ra)))}createResult(t,r){var E;const n=X(this,Wt),a=this.options,i=X(this,Ra),o=X(this,dd),l=X(this,Lf),u=t!==n?t.state:X(this,px),{state:d}=t;let h={...d},f=!1,p;if(r._optimisticResults){const k=this.hasListeners(),P=!k&&tM(t,r),A=k&&rM(t,n,r,a);(P||A)&&(h={...h,...r8(d.data,t.options)}),r._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:m,errorUpdatedAt:v,status:g}=h;p=h.data;let x=!1;if(r.placeholderData!==void 0&&p===void 0&&g==="pending"){let k;i!=null&&i.isPlaceholderData&&r.placeholderData===(l==null?void 0:l.placeholderData)?(k=i.data,x=!0):k=typeof r.placeholderData=="function"?r.placeholderData((E=X(this,Uf))==null?void 0:E.state.data,X(this,Uf)):r.placeholderData,k!==void 0&&(g="success",p=WC(i==null?void 0:i.data,k,r),f=!0)}if(r.select&&p!==void 0&&!x)if(i&&p===(o==null?void 0:o.data)&&r.select===X(this,mx))p=X(this,Bf);else try{Ue(this,mx,r.select),p=r.select(p),p=WC(i==null?void 0:i.data,p,r),Ue(this,Bf,p),Ue(this,gc,null)}catch(k){Ue(this,gc,k)}X(this,gc)&&(m=X(this,gc),p=X(this,Bf),v=Date.now(),g="error");const y=h.fetchStatus==="fetching",b=g==="pending",N=g==="error",j=b&&y,_=p!==void 0,C={status:g,fetchStatus:h.fetchStatus,isPending:b,isSuccess:g==="success",isError:N,isInitialLoading:j,isLoading:j,data:p,dataUpdatedAt:h.dataUpdatedAt,error:m,errorUpdatedAt:v,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:y,isRefetching:y&&!b,isLoadingError:N&&!_,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:N&&_,isStale:ET(t,r),refetch:this.refetch,promise:X(this,vc),isEnabled:qs(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const k=O=>{C.status==="error"?O.reject(C.error):C.data!==void 0&&O.resolve(C.data)},P=()=>{const O=Ue(this,vc,C.promise=qC());k(O)},A=X(this,vc);switch(A.status){case"pending":t.queryHash===n.queryHash&&k(A);break;case"fulfilled":(C.status==="error"||C.data!==A.value)&&P();break;case"rejected":(C.status!=="error"||C.error!==A.reason)&&P();break}}return C}updateResult(){const t=X(this,Ra),r=this.createResult(X(this,Wt),this.options);if(Ue(this,dd,X(this,Wt).state),Ue(this,Lf,this.options),X(this,dd).data!==void 0&&Ue(this,Uf,X(this,Wt)),$0(r,t))return;Ue(this,Ra,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,i=typeof a=="function"?a():a;if(i==="all"||!i&&!X(this,Vf).size)return!0;const o=new Set(i??X(this,Vf));return this.options.throwOnError&&o.add("error"),Object.keys(X(this,Ra)).some(l=>{const c=l;return X(this,Ra)[c]!==t[c]&&o.has(c)})};kt(this,rr,a8).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&kt(this,rr,YC).call(this)}},Ya=new WeakMap,Wt=new WeakMap,px=new WeakMap,Ra=new WeakMap,dd=new WeakMap,Lf=new WeakMap,vc=new WeakMap,gc=new WeakMap,mx=new WeakMap,Bf=new WeakMap,Uf=new WeakMap,hd=new WeakMap,fd=new WeakMap,xc=new WeakMap,Vf=new WeakMap,rr=new WeakSet,lv=function(t){kt(this,rr,ZC).call(this);let r=X(this,Wt).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(Ia)),r},GC=function(){kt(this,rr,XC).call(this);const t=Uc(this.options.staleTime,X(this,Wt));if(Pd||X(this,Ra).isStale||!VC(t))return;const n=Kz(X(this,Ra).dataUpdatedAt,t)+1;Ue(this,hd,setTimeout(()=>{X(this,Ra).isStale||this.updateResult()},n))},HC=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(X(this,Wt)):this.options.refetchInterval)??!1},KC=function(t){kt(this,rr,QC).call(this),Ue(this,xc,t),!(Pd||qs(this.options.enabled,X(this,Wt))===!1||!VC(X(this,xc))||X(this,xc)===0)&&Ue(this,fd,setInterval(()=>{(this.options.refetchIntervalInBackground||CT.isFocused())&&kt(this,rr,lv).call(this)},X(this,xc)))},YC=function(){kt(this,rr,GC).call(this),kt(this,rr,KC).call(this,kt(this,rr,HC).call(this))},XC=function(){X(this,hd)&&(clearTimeout(X(this,hd)),Ue(this,hd,void 0))},QC=function(){X(this,fd)&&(clearInterval(X(this,fd)),Ue(this,fd,void 0))},ZC=function(){const t=X(this,Ya).getQueryCache().build(X(this,Ya),this.options);if(t===X(this,Wt))return;const r=X(this,Wt);Ue(this,Wt,t),Ue(this,px,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},a8=function(t){Cn.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(X(this,Ra))}),X(this,Ya).getQueryCache().notify({query:X(this,Wt),type:"observerResultsUpdated"})})},o6);function Foe(e,t){return qs(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function tM(e,t){return Foe(e,t)||e.state.data!==void 0&&JC(e,t,t.refetchOnMount)}function JC(e,t,r){if(qs(t.enabled,e)!==!1&&Uc(t.staleTime,e)!=="static"){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&ET(e,t)}return!1}function rM(e,t,r,n){return(e!==t||qs(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&ET(e,r)}function ET(e,t){return qs(t.enabled,e)!==!1&&e.isStaleByTime(Uc(t.staleTime,e))}function Loe(e,t){return!$0(e.getCurrentResult(),t)}var yc,bc,Xa,al,bl,Hb,eE,l6,Boe=(l6=class extends Kp{constructor(r,n){super();at(this,bl);at(this,yc);at(this,bc);at(this,Xa);at(this,al);Ue(this,yc,r),this.setOptions(n),this.bindMethods(),kt(this,bl,Hb).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var a;const n=this.options;this.options=X(this,yc).defaultMutationOptions(r),$0(this.options,n)||X(this,yc).getMutationCache().notify({type:"observerOptionsUpdated",mutation:X(this,Xa),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&Td(n.mutationKey)!==Td(this.options.mutationKey)?this.reset():((a=X(this,Xa))==null?void 0:a.state.status)==="pending"&&X(this,Xa).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=X(this,Xa))==null||r.removeObserver(this)}onMutationUpdate(r){kt(this,bl,Hb).call(this),kt(this,bl,eE).call(this,r)}getCurrentResult(){return X(this,bc)}reset(){var r;(r=X(this,Xa))==null||r.removeObserver(this),Ue(this,Xa,void 0),kt(this,bl,Hb).call(this),kt(this,bl,eE).call(this)}mutate(r,n){var a;return Ue(this,al,n),(a=X(this,Xa))==null||a.removeObserver(this),Ue(this,Xa,X(this,yc).getMutationCache().build(X(this,yc),this.options)),X(this,Xa).addObserver(this),X(this,Xa).execute(r)}},yc=new WeakMap,bc=new WeakMap,Xa=new WeakMap,al=new WeakMap,bl=new WeakSet,Hb=function(){var n;const r=((n=X(this,Xa))==null?void 0:n.state)??n8();Ue(this,bc,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},eE=function(r){Cn.batch(()=>{var n,a,i,o,l,c,u,d;if(X(this,al)&&this.hasListeners()){const h=X(this,bc).variables,f=X(this,bc).context;(r==null?void 0:r.type)==="success"?((a=(n=X(this,al)).onSuccess)==null||a.call(n,r.data,h,f),(o=(i=X(this,al)).onSettled)==null||o.call(i,r.data,null,h,f)):(r==null?void 0:r.type)==="error"&&((c=(l=X(this,al)).onError)==null||c.call(l,r.error,h,f),(d=(u=X(this,al)).onSettled)==null||d.call(u,void 0,r.error,h,f))}this.listeners.forEach(h=>{h(X(this,bc))})})},l6),s8=w.createContext(void 0),Cx=e=>{const t=w.useContext(s8);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Uoe=({client:e,children:t})=>(w.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),s.jsx(s8.Provider,{value:e,children:t})),i8=w.createContext(!1),Voe=()=>w.useContext(i8);i8.Provider;function zoe(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Woe=w.createContext(zoe()),qoe=()=>w.useContext(Woe),Goe=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Hoe=e=>{w.useEffect(()=>{e.clearReset()},[e])},Koe=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(a&&e.data===void 0||Qz(r,[e.error,n])),Yoe=e=>{if(e.suspense){const t=n=>n==="static"?n:Math.max(n??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...n)=>t(r(...n)):t(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Xoe=(e,t)=>e.isLoading&&e.isFetching&&!t,Qoe=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,nM=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function Zoe(e,t,r){var h,f,p,m,v;const n=Voe(),a=qoe(),i=Cx(),o=i.defaultQueryOptions(e);(f=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||f.call(h,o),o._optimisticResults=n?"isRestoring":"optimistic",Yoe(o),Goe(o,a),Hoe(a);const l=!i.getQueryCache().get(o.queryHash),[c]=w.useState(()=>new t(i,o)),u=c.getOptimisticResult(o),d=!n&&e.subscribed!==!1;if(w.useSyncExternalStore(w.useCallback(g=>{const x=d?c.subscribe(Cn.batchCalls(g)):Ia;return c.updateResult(),x},[c,d]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),w.useEffect(()=>{c.setOptions(o)},[o,c]),Qoe(o,u))throw nM(o,c,a);if(Koe({result:u,errorResetBoundary:a,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw u.error;if((m=(p=i.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||m.call(p,o,u),o.experimental_prefetchInRender&&!Pd&&Xoe(u,n)){const g=l?nM(o,c,a):(v=i.getQueryCache().get(o.queryHash))==null?void 0:v.promise;g==null||g.catch(Ia).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?u:c.trackResult(u)}function Rd(e,t){return Zoe(e,$oe)}function hg(e,t){const r=Cx(),[n]=w.useState(()=>new Boe(r,e));w.useEffect(()=>{n.setOptions(e)},[n,e]);const a=w.useSyncExternalStore(w.useCallback(o=>n.subscribe(Cn.batchCalls(o)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=w.useCallback((o,l)=>{n.mutate(o,l).catch(Ia)},[n]);if(a.error&&Qz(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fg(){return fg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fg.apply(this,arguments)}var Nc;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Nc||(Nc={}));const aM="popstate";function Joe(e){e===void 0&&(e={});function t(n,a){let{pathname:i,search:o,hash:l}=n.location;return tE("",{pathname:i,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:l8(a)}return tle(t,r,null,e)}function Pn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function o8(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function ele(){return Math.random().toString(36).substr(2,8)}function sM(e,t){return{usr:e.state,key:e.key,idx:t}}function tE(e,t,r,n){return r===void 0&&(r=null),fg({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Yp(t):t,{state:r,key:t&&t.key||n||ele()})}function l8(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Yp(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function tle(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,o=a.history,l=Nc.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(fg({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){l=Nc.Pop;let g=d(),x=g==null?null:g-u;u=g,c&&c({action:l,location:v.location,delta:x})}function f(g,x){l=Nc.Push;let y=tE(v.location,g,x);u=d()+1;let b=sM(y,u),N=v.createHref(y);try{o.pushState(b,"",N)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;a.location.assign(N)}i&&c&&c({action:l,location:v.location,delta:1})}function p(g,x){l=Nc.Replace;let y=tE(v.location,g,x);u=d();let b=sM(y,u),N=v.createHref(y);o.replaceState(b,"",N),i&&c&&c({action:l,location:v.location,delta:0})}function m(g){let x=a.location.origin!=="null"?a.location.origin:a.location.href,y=typeof g=="string"?g:l8(g);return y=y.replace(/ $/,"%20"),Pn(x,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,x)}let v={get action(){return l},get location(){return e(a,o)},listen(g){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(aM,h),c=g,()=>{a.removeEventListener(aM,h),c=null}},createHref(g){return t(a,g)},createURL:m,encodeLocation(g){let x=m(g);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:p,go(g){return o.go(g)}};return v}var iM;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(iM||(iM={}));function rle(e,t,r){return r===void 0&&(r="/"),nle(e,t,r,!1)}function nle(e,t,r,n){let a=typeof t=="string"?Yp(t):t,i=d8(a.pathname||"/",r);if(i==null)return null;let o=c8(e);ale(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=mle(i);l=fle(o[c],u,n)}return l}function c8(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(Pn(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=vd([n,c.relativePath]),d=r.concat(c);i.children&&i.children.length>0&&(Pn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),c8(i.children,t,d,u)),!(i.path==null&&!i.index)&&t.push({path:u,score:dle(u,i.index),routesMeta:d})};return e.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,o);else for(let c of u8(i.path))a(i,o,c)}),t}function u8(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=u8(n.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function ale(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:hle(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const sle=/^:[\w-]+$/,ile=3,ole=2,lle=1,cle=10,ule=-2,oM=e=>e==="*";function dle(e,t){let r=e.split("/"),n=r.length;return r.some(oM)&&(n+=ule),t&&(n+=ole),r.filter(a=>!oM(a)).reduce((a,i)=>a+(sle.test(i)?ile:i===""?lle:cle),n)}function hle(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function fle(e,t,r){let{routesMeta:n}=e,a={},i="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",h=lM({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!h&&u&&r&&!n[n.length-1].route.index&&(h=lM({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!h)return null;Object.assign(a,h.params),o.push({params:a,pathname:vd([i,h.pathname]),pathnameBase:wle(vd([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=vd([i,h.pathnameBase]))}return o}function lM(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=ple(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((u,d,h)=>{let{paramName:f,isOptional:p}=d;if(f==="*"){let v=l[h]||"";o=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const m=l[h];return p&&!m?u[f]=void 0:u[f]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:e}}function ple(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),o8(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function mle(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return o8(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function d8(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function vle(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Yp(e):e;return{pathname:r?r.startsWith("/")?r:gle(r,t):t,search:jle(n),hash:Nle(a)}}function gle(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function e2(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function xle(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function yle(e,t){let r=xle(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function ble(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Yp(e):(a=fg({},e),Pn(!a.pathname||!a.pathname.includes("?"),e2("?","pathname","search",a)),Pn(!a.pathname||!a.pathname.includes("#"),e2("#","pathname","hash",a)),Pn(!a.search||!a.search.includes("#"),e2("#","search","hash",a)));let i=e===""||a.pathname==="",o=i?"/":a.pathname,l;if(o==null)l=r;else{let h=t.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;a.pathname=f.join("/")}l=h>=0?t[h]:"/"}let c=vle(a,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const vd=e=>e.join("/").replace(/\/\/+/g,"/"),wle=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),jle=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Nle=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function _le(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const h8=["post","put","patch","delete"];new Set(h8);const Sle=["get",...h8];new Set(Sle);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pg(){return pg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pg.apply(this,arguments)}const kT=w.createContext(null),Cle=w.createContext(null),yj=w.createContext(null),bj=w.createContext(null),Zd=w.createContext({outlet:null,matches:[],isDataRoute:!1}),f8=w.createContext(null);function wj(){return w.useContext(bj)!=null}function jj(){return wj()||Pn(!1),w.useContext(bj).location}function p8(e){w.useContext(yj).static||w.useLayoutEffect(e)}function Oe(){let{isDataRoute:e}=w.useContext(Zd);return e?Lle():Ele()}function Ele(){wj()||Pn(!1);let e=w.useContext(kT),{basename:t,future:r,navigator:n}=w.useContext(yj),{matches:a}=w.useContext(Zd),{pathname:i}=jj(),o=JSON.stringify(yle(a,r.v7_relativeSplatPath)),l=w.useRef(!1);return p8(()=>{l.current=!0}),w.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let h=ble(u,JSON.parse(o),i,d.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:vd([t,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[t,n,o,i,e])}function us(){let{matches:e}=w.useContext(Zd),t=e[e.length-1];return t?t.params:{}}function kle(e,t){return Ale(e,t)}function Ale(e,t,r,n){wj()||Pn(!1);let{navigator:a}=w.useContext(yj),{matches:i}=w.useContext(Zd),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=jj(),d;if(t){var h;let g=typeof t=="string"?Yp(t):t;c==="/"||(h=g.pathname)!=null&&h.startsWith(c)||Pn(!1),d=g}else d=u;let f=d.pathname||"/",p=f;if(c!=="/"){let g=c.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(g.length).join("/")}let m=rle(e,{pathname:p}),v=Ile(m&&m.map(g=>Object.assign({},g,{params:Object.assign({},l,g.params),pathname:vd([c,a.encodeLocation?a.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?c:vd([c,a.encodeLocation?a.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,r,n);return t&&v?w.createElement(bj.Provider,{value:{location:pg({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Nc.Pop}},v):v}function Ple(){let e=Fle(),t=_le(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},t),r?w.createElement("pre",{style:a},r):null,null)}const Tle=w.createElement(Ple,null);class Rle extends w.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?w.createElement(Zd.Provider,{value:this.props.routeContext},w.createElement(f8.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Ole(e){let{routeContext:t,match:r,children:n}=e,a=w.useContext(kT);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),w.createElement(Zd.Provider,{value:t},n)}function Ile(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(a=r)==null?void 0:a.errors;if(l!=null){let d=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);d>=0||Pn(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:p}=r,m=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||m){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,f)=>{let p,m=!1,v=null,g=null;r&&(p=l&&h.route.id?l[h.route.id]:void 0,v=h.route.errorElement||Tle,c&&(u<0&&f===0?(m=!0,g=null):u===f&&(m=!0,g=h.route.hydrateFallbackElement||null)));let x=t.concat(o.slice(0,f+1)),y=()=>{let b;return p?b=v:m?b=g:h.route.Component?b=w.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=d,w.createElement(Ole,{match:h,routeContext:{outlet:d,matches:x,isDataRoute:r!=null},children:b})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?w.createElement(Rle,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:y(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):y()},null)}var m8=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(m8||{}),L0=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(L0||{});function Dle(e){let t=w.useContext(kT);return t||Pn(!1),t}function Mle(e){let t=w.useContext(Cle);return t||Pn(!1),t}function $le(e){let t=w.useContext(Zd);return t||Pn(!1),t}function v8(e){let t=$le(),r=t.matches[t.matches.length-1];return r.route.id||Pn(!1),r.route.id}function Fle(){var e;let t=w.useContext(f8),r=Mle(L0.UseRouteError),n=v8(L0.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function Lle(){let{router:e}=Dle(m8.UseNavigateStable),t=v8(L0.UseNavigateStable),r=w.useRef(!1);return p8(()=>{r.current=!0}),w.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,pg({fromRouteId:t},i)))},[e,t])}function Ble(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Ie(e){Pn(!1)}function Ule(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Nc.Pop,navigator:i,static:o=!1,future:l}=e;wj()&&Pn(!1);let c=t.replace(/^\/*/,"/"),u=w.useMemo(()=>({basename:c,navigator:i,static:o,future:pg({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof n=="string"&&(n=Yp(n));let{pathname:d="/",search:h="",hash:f="",state:p=null,key:m="default"}=n,v=w.useMemo(()=>{let g=d8(d,c);return g==null?null:{location:{pathname:g,search:h,hash:f,state:p,key:m},navigationType:a}},[c,d,h,f,p,m,a]);return v==null?null:w.createElement(yj.Provider,{value:u},w.createElement(bj.Provider,{children:r,value:v}))}function Vle(e){let{children:t,location:r}=e;return kle(rE(t),r)}new Promise(()=>{});function rE(e,t){t===void 0&&(t=[]);let r=[];return w.Children.forEach(e,(n,a)=>{if(!w.isValidElement(n))return;let i=[...t,a];if(n.type===w.Fragment){r.push.apply(r,rE(n.props.children,i));return}n.type!==Ie&&Pn(!1),!n.props.index||!n.props.children||Pn(!1);let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=rE(n.props.children,i)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function nE(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function zle(e,t){let r=nE(e);return t&&t.forEach((n,a)=>{r.has(a)||t.getAll(a).forEach(i=>{r.append(a,i)})}),r}const Wle="6";try{window.__reactRouterVersion=Wle}catch{}const qle="startTransition",cM=hP[qle];function Gle(e){let{basename:t,children:r,future:n,window:a}=e,i=w.useRef();i.current==null&&(i.current=Joe({window:a,v5Compat:!0}));let o=i.current,[l,c]=w.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},d=w.useCallback(h=>{u&&cM?cM(()=>c(h)):c(h)},[c,u]);return w.useLayoutEffect(()=>o.listen(d),[o,d]),w.useEffect(()=>Ble(n),[n]),w.createElement(Ule,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}var uM;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(uM||(uM={}));var dM;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(dM||(dM={}));function Ex(e){let t=w.useRef(nE(e)),r=w.useRef(!1),n=jj(),a=w.useMemo(()=>zle(n.search,r.current?null:t.current),[n.search]),i=Oe(),o=w.useCallback((l,c)=>{const u=nE(typeof l=="function"?l(a):l);r.current=!0,i("?"+u,c)},[i,a]);return[a,o]}const AT=zp("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),L=w.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},i)=>{const o=n?SV:"button";return s.jsx(o,{className:me(AT({variant:t,size:r,className:e})),ref:i,...a})});L.displayName="Button";const Zi="/assets/vairify-logo-CPWkkuUw.png",Hle=()=>{const e=Oe(),[t]=Ex();return w.useEffect(()=>{const r=t.get("vai");r&&e(`/login?vai=${r}`)},[t,e]),s.jsxs("div",{className:"min-h-screen bg-gradient-hero flex flex-col items-center justify-center p-4 relative overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[s.jsx("div",{className:"absolute top-20 left-10 w-32 h-32 bg-primary-light/10 rounded-full blur-3xl animate-float",style:{animationDelay:"0s"}}),s.jsx("div",{className:"absolute bottom-20 right-10 w-40 h-40 bg-primary-light/10 rounded-full blur-3xl animate-float",style:{animationDelay:"1s"}}),s.jsx("div",{className:"absolute top-1/2 left-1/4 w-24 h-24 bg-primary-light/10 rounded-full blur-3xl animate-float",style:{animationDelay:"2s"}})]}),s.jsxs("div",{className:"w-full max-w-lg relative z-10 animate-fade-in",children:[s.jsx("div",{className:"text-center mb-12",children:s.jsx("div",{className:"flex items-center justify-center mb-6",children:s.jsx("img",{src:Zi,alt:"VAIRIFY",className:"w-52 h-52 md:w-64 md:h-64"})})}),s.jsxs("div",{className:"text-center space-y-6 mb-12",children:[s.jsxs("h1",{className:"text-5xl md:text-6xl font-bold text-white leading-tight",children:["Stop Hoping.",s.jsx("br",{}),"Start Knowing."]}),s.jsx("p",{className:"text-xl text-white/90 max-w-md mx-auto",children:"The first platform with V.A.I. verified anonymous identity for every encounter."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(L,{onClick:()=>e("/onboarding/registration"),size:"lg",className:"w-full h-14 text-lg font-semibold bg-white text-primary hover:bg-white/90 transition-all duration-300 hover:scale-105",children:"Sign Up"}),s.jsx(L,{onClick:()=>e("/login"),size:"lg",variant:"outline",className:"w-full h-14 text-lg font-semibold border-2 border-white text-white hover:bg-white hover:text-primary transition-all duration-300",children:"Login"})]})]})]})},Kle=()=>{const e=jj();return w.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),s.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),s.jsx("p",{className:"mb-4 text-xl text-gray-600",children:"Oops! Page not found"}),s.jsx("a",{href:"/",className:"text-blue-500 underline hover:text-blue-700",children:"Return to Home"})]})})},De=w.forwardRef(({className:e,type:t,...r},n)=>s.jsx("input",{type:t,className:me("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));De.displayName="Input";var aE=function(e,t){return aE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},aE(e,t)};function PT(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");aE(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ur=function(){return ur=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},ur.apply(this,arguments)};function cu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function g8(e,t,r,n){var a=arguments.length,i=a<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function x8(e,t){return function(r,n){t(r,n,e)}}function y8(e,t,r,n,a,i){function o(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var l=n.kind,c=l==="getter"?"get":l==="setter"?"set":"value",u=!t&&e?n.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),h,f=!1,p=r.length-1;p>=0;p--){var m={};for(var v in n)m[v]=v==="access"?{}:n[v];for(var v in n.access)m.access[v]=n.access[v];m.addInitializer=function(x){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(x||null))};var g=(0,r[p])(l==="accessor"?{get:d.get,set:d.set}:d[c],m);if(l==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(h=o(g.get))&&(d.get=h),(h=o(g.set))&&(d.set=h),(h=o(g.init))&&a.unshift(h)}else(h=o(g))&&(l==="field"?a.unshift(h):d[c]=h)}u&&Object.defineProperty(u,n.name,d),f=!0}function b8(e,t,r){for(var n=arguments.length>2,a=0;a<t.length;a++)r=n?t[a].call(e,r):t[a].call(e);return n?r:void 0}function w8(e){return typeof e=="symbol"?e:"".concat(e)}function j8(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function N8(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function et(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{u(n.next(d))}catch(h){o(h)}}function c(d){try{u(n.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})}function _8(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(r=0)),r;)try{if(n=1,a&&(i=u[0]&2?a.return:u[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,u[1])).done)return i;switch(a=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(d){u=[6,d],a=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var Nj=Object.create?function(e,t,r,n){n===void 0&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]};function S8(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Nj(t,e,r)}function B0(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function TT(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,i=[],o;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function C8(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(TT(arguments[t]));return e}function E8(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var i=arguments[t],o=0,l=i.length;o<l;o++,a++)n[a]=i[o];return n}function RT(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function Zf(e){return this instanceof Zf?(this.v=e,this):new Zf(e)}function k8(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),a,i=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),a[Symbol.asyncIterator]=function(){return this},a;function o(p){return function(m){return Promise.resolve(m).then(p,h)}}function l(p,m){n[p]&&(a[p]=function(v){return new Promise(function(g,x){i.push([p,v,g,x])>1||c(p,v)})},m&&(a[p]=m(a[p])))}function c(p,m){try{u(n[p](m))}catch(v){f(i[0][3],v)}}function u(p){p.value instanceof Zf?Promise.resolve(p.value.v).then(d,h):f(i[0][2],p)}function d(p){c("next",p)}function h(p){c("throw",p)}function f(p,m){p(m),i.shift(),i.length&&c(i[0][0],i[0][1])}}function A8(e){var t,r;return t={},n("next"),n("throw",function(a){throw a}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(a,i){t[a]=e[a]?function(o){return(r=!r)?{value:Zf(e[a](o)),done:!1}:i?i(o):o}:i}}function P8(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof B0=="function"?B0(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=e[i]&&function(o){return new Promise(function(l,c){o=e[i](o),a(l,c,o.done,o.value)})}}function a(i,o,l,c){Promise.resolve(c).then(function(u){i({value:u,done:l})},o)}}function T8(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var Yle=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},sE=function(e){return sE=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},sE(e)};function R8(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=sE(e),n=0;n<r.length;n++)r[n]!=="default"&&Nj(t,e,r[n]);return Yle(t,e),t}function O8(e){return e&&e.__esModule?e:{default:e}}function I8(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function D8(e,t,r,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,r):a?a.value=r:t.set(e,r),r}function M8(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function $8(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,a;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(a=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");a&&(n=function(){try{a.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var Xle=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function F8(e){function t(i){e.error=e.hasError?new Xle(i,e.error,"An error was suppressed during disposal."):i,e.hasError=!0}var r,n=0;function a(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(a);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(i).then(a,function(o){return t(o),a()})}else n|=1}catch(o){t(o)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return a()}function L8(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,a,i,o){return n?t?".jsx":".js":a&&(!i||!o)?r:a+i+"."+o.toLowerCase()+"js"}):e}const Qle={__extends:PT,__assign:ur,__rest:cu,__decorate:g8,__param:x8,__esDecorate:y8,__runInitializers:b8,__propKey:w8,__setFunctionName:j8,__metadata:N8,__awaiter:et,__generator:_8,__createBinding:Nj,__exportStar:S8,__values:B0,__read:TT,__spread:C8,__spreadArrays:E8,__spreadArray:RT,__await:Zf,__asyncGenerator:k8,__asyncDelegator:A8,__asyncValues:P8,__makeTemplateObject:T8,__importStar:R8,__importDefault:O8,__classPrivateFieldGet:I8,__classPrivateFieldSet:D8,__classPrivateFieldIn:M8,__addDisposableResource:$8,__disposeResources:F8,__rewriteRelativeImportExtension:L8},Zle=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:$8,get __assign(){return ur},__asyncDelegator:A8,__asyncGenerator:k8,__asyncValues:P8,__await:Zf,__awaiter:et,__classPrivateFieldGet:I8,__classPrivateFieldIn:M8,__classPrivateFieldSet:D8,__createBinding:Nj,__decorate:g8,__disposeResources:F8,__esDecorate:y8,__exportStar:S8,__extends:PT,__generator:_8,__importDefault:O8,__importStar:R8,__makeTemplateObject:T8,__metadata:N8,__param:x8,__propKey:w8,__read:TT,__rest:cu,__rewriteRelativeImportExtension:L8,__runInitializers:b8,__setFunctionName:j8,__spread:C8,__spreadArray:RT,__spreadArrays:E8,__values:B0,default:Qle},Symbol.toStringTag,{value:"Module"})),Jle=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class OT extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class hM extends OT{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class fM extends OT{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class pM extends OT{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var iE;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(iE||(iE={}));class ece{constructor(t,{headers:r={},customFetch:n,region:a=iE.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=Jle(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return et(this,arguments,void 0,function*(r,n={}){var a;try{const{headers:i,method:o,body:l,signal:c}=n;let u={},{region:d}=n;d||(d=this.region);const h=new URL(`${this.url}/${r}`);d&&d!=="any"&&(u["x-region"]=d,h.searchParams.set("forceFunctionRegion",d));let f;l&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)?typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",f=l):typeof l=="string"?(u["Content-Type"]="text/plain",f=l):typeof FormData<"u"&&l instanceof FormData?f=l:(u["Content-Type"]="application/json",f=JSON.stringify(l)):f=l;const p=yield this.fetch(h.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),i),body:f,signal:c}).catch(x=>{throw x.name==="AbortError"?x:new hM(x)}),m=p.headers.get("x-relay-error");if(m&&m==="true")throw new fM(p);if(!p.ok)throw new pM(p);let v=((a=p.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),g;return v==="application/json"?g=yield p.json():v==="application/octet-stream"||v==="application/pdf"?g=yield p.blob():v==="text/event-stream"?g=p:v==="multipart/form-data"?g=yield p.formData():g=yield p.text(),{data:g,error:null,response:p}}catch(i){return i instanceof Error&&i.name==="AbortError"?{data:null,error:new hM(i)}:{data:null,error:i,response:i instanceof pM||i instanceof fM?i.context:void 0}}})}}var Ma={};const Xp=Cee(Zle);var Fy={},Ly={},By={},Uy={},Vy={},zy={},mM;function B8(){if(mM)return zy;mM=1,Object.defineProperty(zy,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return zy.default=e,zy}var vM;function U8(){if(vM)return Vy;vM=1,Object.defineProperty(Vy,"__esModule",{value:!0});const t=Xp.__importDefault(B8());class r{constructor(a){var i,o;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(i=a.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=a.signal,this.isMaybeSingle=(o=a.isMaybeSingle)!==null&&o!==void 0?o:!1,a.fetch?this.fetch=a.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,i){return this.headers=new Headers(this.headers),this.headers.set(a,i),this}then(a,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,d,h,f;let p=null,m=null,v=null,g=c.status,x=c.statusText;if(c.ok){if(this.method!=="HEAD"){const j=await c.text();j===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?m=j:m=JSON.parse(j))}const b=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),N=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");b&&N&&N.length>1&&(v=parseInt(N[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(p={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,v=null,g=406,x="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const b=await c.text();try{p=JSON.parse(b),Array.isArray(p)&&c.status===404&&(m=[],p=null,g=200,x="OK")}catch{c.status===404&&b===""?(g=204,x="No Content"):p={message:b}}if(p&&this.isMaybeSingle&&(!((f=p==null?void 0:p.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,g=200,x="OK"),p&&this.shouldThrowOnError)throw new t.default(p)}return{error:p,data:m,count:v,status:g,statusText:x}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,d,h;return{error:{message:`${(u=c==null?void 0:c.name)!==null&&u!==void 0?u:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(d=c==null?void 0:c.stack)!==null&&d!==void 0?d:""}`,hint:"",code:`${(h=c==null?void 0:c.code)!==null&&h!==void 0?h:""}`},data:null,count:null,status:0,statusText:""}})),l.then(a,i)}returns(){return this}overrideTypes(){return this}}return Vy.default=r,Vy}var gM;function V8(){if(gM)return Uy;gM=1,Object.defineProperty(Uy,"__esModule",{value:!0});const t=Xp.__importDefault(U8());class r extends t.default{select(a){let i=!1;const o=(a??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:i=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const u=c?`${c}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${a}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:i,referencedTable:o=i}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${a}`),this}range(a,i,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${a}`),this.url.searchParams.set(u,`${i-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:i=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:u="text"}={}){var d;const h=[a?"analyze":null,i?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),f=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${f}"; options=${h};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return Uy.default=r,Uy}var xM;function IT(){if(xM)return By;xM=1,Object.defineProperty(By,"__esModule",{value:!0});const t=Xp.__importDefault(V8()),r=new RegExp("[,()]");class n extends t.default{eq(i,o){return this.url.searchParams.append(i,`eq.${o}`),this}neq(i,o){return this.url.searchParams.append(i,`neq.${o}`),this}gt(i,o){return this.url.searchParams.append(i,`gt.${o}`),this}gte(i,o){return this.url.searchParams.append(i,`gte.${o}`),this}lt(i,o){return this.url.searchParams.append(i,`lt.${o}`),this}lte(i,o){return this.url.searchParams.append(i,`lte.${o}`),this}like(i,o){return this.url.searchParams.append(i,`like.${o}`),this}likeAllOf(i,o){return this.url.searchParams.append(i,`like(all).{${o.join(",")}}`),this}likeAnyOf(i,o){return this.url.searchParams.append(i,`like(any).{${o.join(",")}}`),this}ilike(i,o){return this.url.searchParams.append(i,`ilike.${o}`),this}ilikeAllOf(i,o){return this.url.searchParams.append(i,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(i,o){return this.url.searchParams.append(i,`ilike(any).{${o.join(",")}}`),this}is(i,o){return this.url.searchParams.append(i,`is.${o}`),this}in(i,o){const l=Array.from(new Set(o)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(i,`in.(${l})`),this}contains(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cs.{${o.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(o)}`),this}containedBy(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cd.{${o.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(o)}`),this}rangeGt(i,o){return this.url.searchParams.append(i,`sr.${o}`),this}rangeGte(i,o){return this.url.searchParams.append(i,`nxl.${o}`),this}rangeLt(i,o){return this.url.searchParams.append(i,`sl.${o}`),this}rangeLte(i,o){return this.url.searchParams.append(i,`nxr.${o}`),this}rangeAdjacent(i,o){return this.url.searchParams.append(i,`adj.${o}`),this}overlaps(i,o){return typeof o=="string"?this.url.searchParams.append(i,`ov.${o}`):this.url.searchParams.append(i,`ov.{${o.join(",")}}`),this}textSearch(i,o,{config:l,type:c}={}){let u="";c==="plain"?u="pl":c==="phrase"?u="ph":c==="websearch"&&(u="w");const d=l===void 0?"":`(${l})`;return this.url.searchParams.append(i,`${u}fts${d}.${o}`),this}match(i){return Object.entries(i).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(i,o,l){return this.url.searchParams.append(i,`not.${o}.${l}`),this}or(i,{foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${i})`),this}filter(i,o,l){return this.url.searchParams.append(i,`${o}.${l}`),this}}return By.default=n,By}var yM;function z8(){if(yM)return Ly;yM=1,Object.defineProperty(Ly,"__esModule",{value:!0});const t=Xp.__importDefault(IT());class r{constructor(a,{headers:i={},schema:o,fetch:l}){this.url=a,this.headers=new Headers(i),this.schema=o,this.fetch=l}select(a,i){const{head:o=!1,count:l}=i??{},c=o?"HEAD":"GET";let u=!1;const d=(a??"*").split("").map(h=>/\s/.test(h)&&!u?"":(h==='"'&&(u=!u),h)).join("");return this.url.searchParams.set("select",d),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:i,defaultToNull:o=!0}={}){var l;const c="POST";if(i&&this.headers.append("Prefer",`count=${i}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const u=a.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(u.length>0){const d=[...new Set(u)].map(h=>`"${h}"`);this.url.searchParams.set("columns",d.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(a,{onConflict:i,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var u;const d="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const h=a.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(h.length>0){const f=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(a,{count:i}={}){var o;const l="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:a}={}){var i;const o="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}}return Ly.default=r,Ly}var bM;function tce(){if(bM)return Fy;bM=1,Object.defineProperty(Fy,"__esModule",{value:!0});const e=Xp,t=e.__importDefault(z8()),r=e.__importDefault(IT());class n{constructor(i,{headers:o={},schema:l,fetch:c}={}){this.url=i,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(i){const o=new URL(`${this.url}/${i}`);return new t.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new n(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:l=!1,get:c=!1,count:u}={}){var d;let h;const f=new URL(`${this.url}/rpc/${i}`);let p;l||c?(h=l?"HEAD":"GET",Object.entries(o).filter(([v,g])=>g!==void 0).map(([v,g])=>[v,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([v,g])=>{f.searchParams.append(v,g)})):(h="POST",p=o);const m=new Headers(this.headers);return u&&m.set("Prefer",`count=${u}`),new r.default({method:h,url:f,headers:m,schema:this.schemaName,body:p,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return Fy.default=n,Fy}Object.defineProperty(Ma,"__esModule",{value:!0});var W8=Ma.PostgrestError=eW=Ma.PostgrestBuilder=Z8=Ma.PostgrestTransformBuilder=X8=Ma.PostgrestFilterBuilder=K8=Ma.PostgrestQueryBuilder=G8=Ma.PostgrestClient=void 0;const Qp=Xp,q8=Qp.__importDefault(tce());var G8=Ma.PostgrestClient=q8.default;const H8=Qp.__importDefault(z8());var K8=Ma.PostgrestQueryBuilder=H8.default;const Y8=Qp.__importDefault(IT());var X8=Ma.PostgrestFilterBuilder=Y8.default;const Q8=Qp.__importDefault(V8());var Z8=Ma.PostgrestTransformBuilder=Q8.default;const J8=Qp.__importDefault(U8());var eW=Ma.PostgrestBuilder=J8.default;const tW=Qp.__importDefault(B8());W8=Ma.PostgrestError=tW.default;var rW=Ma.default={PostgrestClient:q8.default,PostgrestQueryBuilder:H8.default,PostgrestFilterBuilder:Y8.default,PostgrestTransformBuilder:Q8.default,PostgrestBuilder:J8.default,PostgrestError:tW.default};const rce=c6({__proto__:null,get PostgrestBuilder(){return eW},get PostgrestClient(){return G8},get PostgrestError(){return W8},get PostgrestFilterBuilder(){return X8},get PostgrestQueryBuilder(){return K8},get PostgrestTransformBuilder(){return Z8},default:rW},[Ma]),{PostgrestClient:nce,PostgrestQueryBuilder:iQe,PostgrestFilterBuilder:oQe,PostgrestTransformBuilder:lQe,PostgrestBuilder:cQe,PostgrestError:uQe}=rW||rce;class ace{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const sce="2.79.0",ice=`realtime-js/${sce}`,oce="1.0.0",oE=1e4,lce=1e3,cce=100;var Cv;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Cv||(Cv={}));var bn;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(bn||(bn={}));var Ei;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ei||(Ei={}));var lE;(function(e){e.websocket="websocket"})(lE||(lE={}));var Bu;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Bu||(Bu={}));class uce{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const l=n.decode(t.slice(o,o+a));o=o+a;const c=n.decode(t.slice(o,o+i));o=o+i;const u=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class nW{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var mr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(mr||(mr={}));const wM=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((i,o)=>(i[o]=dce(o,e,t,a),i),{}):{}},dce=(e,t,r,n)=>{const a=t.find(l=>l.name===e),i=a==null?void 0:a.type,o=r[e];return i&&!n.includes(i)?aW(i,o):cE(o)},aW=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return mce(t,r)}switch(e){case mr.bool:return hce(t);case mr.float4:case mr.float8:case mr.int2:case mr.int4:case mr.int8:case mr.numeric:case mr.oid:return fce(t);case mr.json:case mr.jsonb:return pce(t);case mr.timestamp:return vce(t);case mr.abstime:case mr.date:case mr.daterange:case mr.int4range:case mr.int8range:case mr.money:case mr.reltime:case mr.text:case mr.time:case mr.timestamptz:case mr.timetz:case mr.tsrange:case mr.tstzrange:return cE(t);default:return cE(t)}},cE=e=>e,hce=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},fce=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},pce=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},mce=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>aW(t,l))}return e},vce=e=>typeof e=="string"?e.replace(" ","T"):e,sW=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class t2{constructor(t,r,n={},a=oE){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var jM;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(jM||(jM={}));class Ev{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ev.syncState(this.state,a,i,o),this.pendingDiffs.forEach(c=>{this.state=Ev.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Ev.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(i,(u,d)=>{o[u]||(c[u]=d)}),this.map(o,(u,d)=>{const h=i[u];if(h){const f=d.map(g=>g.presence_ref),p=h.map(g=>g.presence_ref),m=d.filter(g=>p.indexOf(g.presence_ref)<0),v=h.filter(g=>f.indexOf(g.presence_ref)<0);m.length>0&&(l[u]=m),v.length>0&&(c[u]=v)}else l[u]=d}),this.syncDiff(i,{joins:l,leaves:c},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const h=t[l].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);t[l].unshift(...f)}n(l,d,c)}),this.map(o,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),t[l]=u,a(l,u,c),u.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var NM;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(NM||(NM={}));var kv;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(kv||(kv={}));var tl;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(tl||(tl={}));class DT{constructor(t,r={config:{}},n){var a,i;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=bn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new t2(this,Ei.join,this.params,this.timeout),this.rejoinTimer=new nW(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=bn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=bn.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=bn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=bn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=bn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ei.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Ev(this),this.broadcastEndpointURL=sW(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==bn.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,u=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&a!==void 0?a:[],d=!!this.bindings[kv.PRESENCE]&&this.bindings[kv.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>t==null?void 0:t(tl.CHANNEL_ERROR,p)),this._onClose(()=>t==null?void 0:t(tl.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var m;if(this.socket.setAuth(),p===void 0){t==null||t(tl.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,g=(m=v==null?void 0:v.length)!==null&&m!==void 0?m:0,x=[];for(let y=0;y<g;y++){const b=v[y],{filter:{event:N,schema:j,table:_,filter:S}}=b,C=p&&p[y];if(C&&C.event===N&&C.schema===j&&C.table===_&&C.filter===S)x.push(Object.assign(Object.assign({},b),{id:C.id}));else{this.unsubscribe(),this.state=bn.errored,t==null||t(tl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(tl.SUBSCRIBED);return}}).receive("error",p=>{this.state=bn.errored,t==null||t(tl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(tl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===bn.joined&&t===kv.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var a;const i=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:i,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=u.body)===null||a===void 0?void 0:a.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=bn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ei.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new t2(this,Ei.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=bn.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new t2(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>cce){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=Ei;if(n&&[l,c,u,d].indexOf(o)>=0&&n!==this._joinRef())return;let f=this._onMessage(o,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(p=>{var m,v,g;return((m=p.filter)===null||m===void 0?void 0:m.event)==="*"||((g=(v=p.filter)===null||v===void 0?void 0:v.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===o}).map(p=>p.callback(f,n)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var m,v,g,x,y,b;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const N=p.id,j=(m=p.filter)===null||m===void 0?void 0:m.event;return N&&((v=r.ids)===null||v===void 0?void 0:v.includes(N))&&(j==="*"||(j==null?void 0:j.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const N=(y=(x=p==null?void 0:p.filter)===null||x===void 0?void 0:x.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return N==="*"||N===((b=r==null?void 0:r.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof f=="object"&&"ids"in f){const m=f.data,{schema:v,table:g,commit_timestamp:x,type:y,errors:b}=m;f=Object.assign(Object.assign({},{schema:v,table:g,commit_timestamp:x,eventType:y,new:{},old:{},errors:b}),this._getPayloadRecords(m))}p.callback(f,n)})}_isClosed(){return this.state===bn.closed}_isJoined(){return this.state===bn.joined}_isJoining(){return this.state===bn.joining}_isLeaving(){return this.state===bn.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&DT.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ei.close,{},t)}_onError(t){this._on(Ei.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=bn.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=wM(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=wM(t.columns,t.old_record)),r}}const r2=()=>{},Wy={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},gce=[1e3,2e3,5e3,1e4],xce=1e4,yce=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class bce{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=oE,this.transport=null,this.heartbeatIntervalMs=Wy.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=r2,this.ref=0,this.reconnectTimer=null,this.logger=r2,this.conn=null,this.sendBuffer=[],this.serializer=new uce,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...i)=>a(...i):(...i)=>fetch(...i),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${lE.websocket}`,this.httpEndpoint=sW(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ace.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:oce}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Cv.connecting:return Bu.Connecting;case Cv.open:return Bu.Open;case Cv.closing:return Bu.Closing;default:return Bu.Closed}}isConnected(){return this.connectionState()===Bu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new DT(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:a,ref:i}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(lce,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Wy.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:i,ref:o}=r,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${n} ${a} ${l}`.trim(),i),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(a,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ei.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([yce],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:ice};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Ei.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new nW(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Wy.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,i,o,l,c,u,d;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:oE,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:Wy.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:r2,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:h=>gce[h-1]||xce,this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(h,f)=>f(JSON.stringify(h)),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class MT extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Tr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class wce extends MT{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class uE extends MT{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const $T=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),jce=()=>Response,dE=e=>{if(Array.isArray(e))return e.map(r=>dE(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=dE(n)}),t},Nce=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},n2=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},_ce=(e,t,r)=>et(void 0,void 0,void 0,function*(){const n=yield jce();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const i=e.status||500,o=(a==null?void 0:a.statusCode)||i+"";t(new wce(n2(a),i,o))}).catch(a=>{t(new uE(n2(a),a))}):t(new uE(n2(e),e))}),Sce=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(Nce(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function kx(e,t,r,n,a,i){return et(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,Sce(t,n,a,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>_ce(c,l,n))})})}function mg(e,t,r,n){return et(this,void 0,void 0,function*(){return kx(e,"GET",t,r,n)})}function Ni(e,t,r,n,a){return et(this,void 0,void 0,function*(){return kx(e,"POST",t,n,a,r)})}function hE(e,t,r,n,a){return et(this,void 0,void 0,function*(){return kx(e,"PUT",t,n,a,r)})}function Cce(e,t,r,n){return et(this,void 0,void 0,function*(){return kx(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function FT(e,t,r,n,a){return et(this,void 0,void 0,function*(){return kx(e,"DELETE",t,n,a,r)})}class Ece{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return et(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Tr(t))return{data:null,error:t};throw t}})}}var iW;class kce{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[iW]="BlobDownloadBuilder",this.promise=null}asStream(){return new Ece(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return et(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Tr(t))return{data:null,error:t};throw t}})}}iW=Symbol.toStringTag;const Ace={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},_M={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Pce{constructor(t,r={},n,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=$T(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,a){return et(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},_M),a);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),c&&!i.has("metadata")&&i.append("metadata",this.encodeMetadata(c))):(i=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),a!=null&&a.headers&&(l=Object.assign(Object.assign({},l),a.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),h=yield(t=="PUT"?hE:Ni)(this.fetch,`${this.url}/object/${d}`,i,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Tr(i))return{data:null,error:i};throw i}})}upload(t,r,n){return et(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return et(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:_M.upsert},a),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield hE(this.fetch,l.toString(),c,{headers:d});return{data:{path:i,fullPath:h.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Tr(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return et(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const i=yield Ni(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new MT("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Tr(n))return{data:null,error:n};throw n}})}update(t,r,n){return et(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return et(this,void 0,void 0,function*(){try{return{data:yield Ni(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Tr(a))return{data:null,error:a};throw a}})}copy(t,r,n){return et(this,void 0,void 0,function*(){try{return{data:{path:(yield Ni(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Tr(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return et(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),i=yield Ni(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Tr(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return et(this,void 0,void 0,function*(){try{const a=yield Ni(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Tr(a))return{data:null,error:a};throw a}})}download(t,r){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=i?`?${i}`:"",l=this._getFinalPath(t),c=()=>mg(this.fetch,`${this.url}/${a}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new kce(c,this.shouldThrowOnError)}info(t){return et(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield mg(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:dE(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Tr(n))return{data:null,error:n};throw n}})}exists(t){return et(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield Cce(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Tr(n)&&n instanceof uE){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&a.push(c);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(t){return et(this,void 0,void 0,function*(){try{return{data:yield FT(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Tr(r))return{data:null,error:r};throw r}})}list(t,r,n){return et(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Ace),r),{prefix:t||""});return{data:yield Ni(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Tr(a))return{data:null,error:a};throw a}})}listV2(t,r){return et(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Ni(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Tr(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const oW="2.79.0",lW={"X-Client-Info":`storage-js/${oW}`};class Tce{constructor(t,r={},n,a){this.shouldThrowOnError=!1;const i=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},lW),r),this.fetch=$T(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return et(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield mg(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Tr(r))return{data:null,error:r};throw r}})}getBucket(t){return et(this,void 0,void 0,function*(){try{return{data:yield mg(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Tr(r))return{data:null,error:r};throw r}})}createBucket(t){return et(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield Ni(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Tr(a))return{data:null,error:a};throw a}})}updateBucket(t,r){return et(this,void 0,void 0,function*(){try{return{data:yield hE(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Tr(n))return{data:null,error:n};throw n}})}emptyBucket(t){return et(this,void 0,void 0,function*(){try{return{data:yield Ni(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Tr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return et(this,void 0,void 0,function*(){try{return{data:yield FT(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Tr(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class Rce{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},lW),r),this.fetch=$T(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return et(this,void 0,void 0,function*(){try{return{data:yield Ni(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Tr(r))return{data:null,error:r};throw r}})}listBuckets(t){return et(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const n=r.toString(),a=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield mg(this.fetch,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Tr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return et(this,void 0,void 0,function*(){try{return{data:yield FT(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Tr(r))return{data:null,error:r};throw r}})}}const LT={"X-Client-Info":`storage-js/${oW}`,"Content-Type":"application/json"};class cW extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function _s(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class a2 extends cW{constructor(t,r,n){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Oce extends cW{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var SM;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(SM||(SM={}));const BT=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Ice=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},CM=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Dce=(e,t,r)=>et(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const a=e.status||500,i=e;if(typeof i.json=="function")i.json().then(o=>{const l=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||a+"";t(new a2(CM(o),a,l))}).catch(()=>{const o=a+"",l=i.statusText||`HTTP ${a} error`;t(new a2(l,a,o))});else{const o=a+"",l=i.statusText||`HTTP ${a} error`;t(new a2(l,a,o))}}else t(new Oce(CM(e),e))}),Mce=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(Ice(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,Object.assign(Object.assign({},a),r)):a};function $ce(e,t,r,n,a,i){return et(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,Mce(t,n,a,i)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>Dce(c,l,n))})})}function Ss(e,t,r,n,a){return et(this,void 0,void 0,function*(){return $ce(e,"POST",t,n,a,r)})}class Fce{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},LT),r),this.fetch=BT(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return et(this,void 0,void 0,function*(){try{return{data:(yield Ss(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_s(r))return{data:null,error:r};throw r}})}getIndex(t,r){return et(this,void 0,void 0,function*(){try{return{data:yield Ss(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(_s(n))return{data:null,error:n};throw n}})}listIndexes(t){return et(this,void 0,void 0,function*(){try{return{data:yield Ss(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_s(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return et(this,void 0,void 0,function*(){try{return{data:(yield Ss(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(_s(n))return{data:null,error:n};throw n}})}}class Lce{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},LT),r),this.fetch=BT(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return et(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Ss(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_s(r))return{data:null,error:r};throw r}})}getVectors(t){return et(this,void 0,void 0,function*(){try{return{data:yield Ss(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_s(r))return{data:null,error:r};throw r}})}listVectors(t){return et(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield Ss(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_s(r))return{data:null,error:r};throw r}})}queryVectors(t){return et(this,void 0,void 0,function*(){try{return{data:yield Ss(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_s(r))return{data:null,error:r};throw r}})}deleteVectors(t){return et(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Ss(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_s(r))return{data:null,error:r};throw r}})}}class Bce{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},LT),r),this.fetch=BT(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return et(this,void 0,void 0,function*(){try{return{data:(yield Ss(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_s(r))return{data:null,error:r};throw r}})}getBucket(t){return et(this,void 0,void 0,function*(){try{return{data:yield Ss(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_s(r))return{data:null,error:r};throw r}})}listBuckets(){return et(this,arguments,void 0,function*(t={}){try{return{data:yield Ss(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_s(r))return{data:null,error:r};throw r}})}deleteBucket(t){return et(this,void 0,void 0,function*(){try{return{data:(yield Ss(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_s(r))return{data:null,error:r};throw r}})}}class Uce extends Bce{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new Vce(this.url,this.headers,t,this.fetch)}}class Vce extends Fce{constructor(t,r,n,a){super(t,r,a),this.vectorBucketName=n}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return et(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return et(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return et(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return et(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new zce(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class zce extends Lce{constructor(t,r,n,a,i){super(t,r,i),this.vectorBucketName=n,this.indexName=a}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return et(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return et(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return et(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return et(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return et(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class Wce extends Tce{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new Pce(this.url,this.headers,t,this.fetch)}get vectors(){return new Uce(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Rce(this.url+"/iceberg",this.headers,this.fetch)}}const qce="2.79.0";let cv="";typeof Deno<"u"?cv="deno":typeof document<"u"?cv="web":typeof navigator<"u"&&navigator.product==="ReactNative"?cv="react-native":cv="node";const Gce={"X-Client-Info":`supabase-js-${cv}/${qce}`},Hce={headers:Gce},Kce={schema:"public"},Yce={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Xce={},Qce=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Zce=()=>Headers,Jce=(e,t,r)=>{const n=Qce(r),a=Zce();return async(i,o)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:e;let u=new a(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(i,Object.assign(Object.assign({},o),{headers:u}))}};function eue(e){return e.endsWith("/")?e:e+"/"}function tue(e,t){var r,n;const{db:a,auth:i,realtime:o,global:l}=e,{db:c,auth:u,realtime:d,global:h}=t,f={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},d),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}function rue(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(eue(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const uW="2.79.0",Rh=30*1e3,fE=3,s2=fE*Rh,nue="http://localhost:9999",aue="supabase.auth.token",sue={"X-Client-Info":`gotrue-js/${uW}`},pE="X-Supabase-Api-Version",dW={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},iue=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,oue=10*60*1e3;class vg extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function nt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class lue extends vg{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function cue(e){return nt(e)&&e.name==="AuthApiError"}class Uu extends vg{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class uu extends vg{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class yi extends uu{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function uue(e){return nt(e)&&e.name==="AuthSessionMissingError"}class fh extends uu{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class qy extends uu{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Gy extends uu{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function due(e){return nt(e)&&e.name==="AuthImplicitGrantRedirectError"}class EM extends uu{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class mE extends uu{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function i2(e){return nt(e)&&e.name==="AuthRetryableFetchError"}class kM extends uu{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class vE extends uu{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const U0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),AM=` 	
\r=`.split(""),hue=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<AM.length;t+=1)e[AM[t].charCodeAt(0)]=-2;for(let t=0;t<U0.length;t+=1)e[U0[t].charCodeAt(0)]=t;return e})();function PM(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(U0[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(U0[n]),t.queuedBits-=6}}function hW(e,t,r){const n=hue[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function TM(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{mue(o,n,r)};for(let o=0;o<e.length;o+=1)hW(e.charCodeAt(o),a,i);return t.join("")}function fue(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function pue(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}fue(n,t)}}function mue(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function pf(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)hW(e.charCodeAt(a),r,n);return new Uint8Array(t)}function vue(e){const t=[];return pue(e,r=>t.push(r)),new Uint8Array(t)}function Hu(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>PM(a,r,n)),PM(null,r,n),t.join("")}function gue(e){return Math.round(Date.now()/1e3)+e}function xue(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const ha=()=>typeof window<"u"&&typeof document<"u",Eu={tested:!1,writable:!1},fW=()=>{if(!ha())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Eu.tested)return Eu.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Eu.tested=!0,Eu.writable=!0}catch{Eu.tested=!0,Eu.writable=!1}return Eu.writable};function yue(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const pW=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),bue=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Oh=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ku=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Yl=async(e,t)=>{await e.removeItem(t)};class _j{constructor(){this.promise=new _j.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}_j.promiseConstructor=Promise;function o2(e){const t=e.split(".");if(t.length!==3)throw new vE("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!iue.test(t[n]))throw new vE("JWT not in base64url format");return{header:JSON.parse(TM(t[0])),payload:JSON.parse(TM(t[1])),signature:pf(t[2]),raw:{header:t[0],payload:t[1]}}}async function wue(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function jue(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){n(o);return}}catch(o){if(!t(i,o)){a(o);return}}})()})}function Nue(e){return("0"+e.toString(16)).substr(-2)}function _ue(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,Nue).join("")}async function Sue(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function Cue(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Sue(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ph(e,t,r=!1){const n=_ue();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await Oh(e,`${t}-code-verifier`,a);const i=await Cue(n);return[i,n===i?"plain":"s256"]}const Eue=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function kue(e){const t=e.headers.get(pE);if(!t||!t.match(Eue))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Aue(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Pue(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Tue=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function mh(e){if(!Tue.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function l2(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Rue(e,t){return new Proxy(e,{get:(r,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,a)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,a)}})}function RM(e){return JSON.parse(JSON.stringify(e))}const Ou=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Oue=[502,503,504];async function OM(e){var t;if(!bue(e))throw new mE(Ou(e),0);if(Oue.includes(e.status))throw new mE(Ou(e),e.status);let r;try{r=await e.json()}catch(i){throw new Uu(Ou(i),i)}let n;const a=kue(e);if(a&&a.getTime()>=dW["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new kM(Ou(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new yi}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new kM(Ou(r),e.status,r.weak_password.reasons);throw new lue(Ou(r),e.status||500,n)}const Iue=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function dt(e,t,r,n){var a;const i=Object.assign({},n==null?void 0:n.headers);i[pE]||(i[pE]=dW["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Due(e,t,r+l,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function Due(e,t,r,n,a,i){const o=Iue(t,n,a,i);let l;try{l=await e(r,Object.assign({},o))}catch(c){throw console.error(c),new mE(Ou(c),0)}if(l.ok||await OM(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await OM(c)}}function bi(e){var t;let r=null;Fue(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=gue(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function IM(e){const t=bi(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function cc(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Mue(e){return{data:e,error:null}}function $ue(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,o=cu(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function DM(e){return e}function Fue(e){return e.access_token&&e.refresh_token&&e.expires_in}const c2=["global","local","others"];class Lue{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=pW(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=c2[0]){if(c2.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${c2.join(", ")}`);try{return await dt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(nt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await dt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:cc})}catch(n){if(nt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=cu(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await dt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:$ue,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(nt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await dt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:cc})}catch(r){if(nt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await dt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:DM});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(m=>{const v=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);u[`${g}Page`]=v}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(nt(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){mh(t);try{return await dt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:cc})}catch(r){if(nt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){mh(t);try{return await dt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:cc})}catch(n){if(nt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){mh(t);try{return await dt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:cc})}catch(n){if(nt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){mh(t.userId);try{const{data:r,error:n}=await dt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(nt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){mh(t.userId),mh(t.id);try{return{data:await dt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(nt(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,a,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await dt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:DM});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(m=>{const v=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);u[`${g}Page`]=v}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(nt(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await dt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(nt(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await dt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(nt(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await dt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(nt(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await dt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(nt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await dt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(nt(r))return{data:null,error:r};throw r}}}function MM(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const vh={debug:!!(globalThis&&fW()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class mW extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Bue extends mW{}async function Uue(e,t,r){vh.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),vh.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){vh.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{vh.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw vh.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Bue(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(vh.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Vue(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function vW(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function zue(e){return parseInt(e,16)}function Wue(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function que(e){var t;const{chainId:r,domain:n,expirationTime:a,issuedAt:i=new Date,nonce:o,notBefore:l,requestId:c,resources:u,scheme:d,uri:h,version:f}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const p=vW(e.address),m=d?`${d}://${n}`:n,v=e.statement?`${e.statement}
`:"",g=`${m} wants you to sign in with your Ethereum account:
${p}

${v}`;let x=`URI: ${h}
Version: ${f}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(a&&(x+=`
Expiration Time: ${a.toISOString()}`),l&&(x+=`
Not Before: ${l.toISOString()}`),c&&(x+=`
Request ID: ${c}`),u){let y=`
Resources:`;for(const b of u){if(!b||typeof b!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);y+=`
- ${b}`}x+=y}return`${g}
${x}`}class cn extends Error{constructor({message:t,code:r,cause:n,name:a}){var i;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=a??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class V0 extends cn{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function Gue({error:e,options:t}){var r,n,a;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new cn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new cn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new cn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new cn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new cn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new cn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new cn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new cn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(gW(o)){if(i.rp.id!==o)return new cn({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new cn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new cn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new cn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new cn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function Hue({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new cn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new cn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(gW(n)){if(r.rpId!==n)return new cn({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new cn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new cn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new cn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class Kue{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const Yue=new Kue;function Xue(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,a=cu(e,["challenge","user","excludeCredentials"]),i=pf(t).buffer,o=Object.assign(Object.assign({},r),{id:pf(r.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:i,user:o});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const u=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:pf(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function Que(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=cu(e,["challenge","allowCredentials"]),a=pf(t).buffer,i=Object.assign(Object.assign({},n),{challenge:a});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const l=r[o];i.allowCredentials[o]=Object.assign(Object.assign({},l),{id:pf(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function Zue(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Hu(new Uint8Array(e.response.attestationObject)),clientDataJSON:Hu(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Jue(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Hu(new Uint8Array(a.authenticatorData)),clientDataJSON:Hu(new Uint8Array(a.clientDataJSON)),signature:Hu(new Uint8Array(a.signature)),userHandle:a.userHandle?Hu(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function gW(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function $M(){var e,t;return!!(ha()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function ede(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new V0("Browser returned unexpected credential type",t)}:{data:null,error:new V0("Empty credential response",t)}}catch(t){return{data:null,error:Gue({error:t,options:e})}}}async function tde(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new V0("Browser returned unexpected credential type",t)}:{data:null,error:new V0("Empty credential response",t)}}catch(t){return{data:null,error:Hue({error:t,options:e})}}}const rde={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},nde={userVerification:"preferred",hints:["security-key"]};function z0(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of e)if(a)for(const i in a){const o=a[i];if(o!==void 0)if(Array.isArray(o))n[i]=o;else if(r(o))n[i]=o;else if(t(o)){const l=n[i];t(l)?n[i]=z0(l,o):n[i]=z0(o)}else n[i]=o}return n}function ade(e,t){return z0(rde,e,t||{})}function sde(e,t){return z0(nde,e,t||{})}class ide{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:a},i){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:l};const c=a??Yue.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=ade(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:d,error:h}=await ede({publicKey:u,signal:c});return d?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}case"request":{const u=sde(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:d,error:h}=await tde(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}}}catch(o){return nt(o)?{data:null,error:o}:{data:null,error:new Uu("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}},i){if(!r)return{data:null,error:new vg("rpId is required for WebAuthn authentication")};try{if(!$M())return{data:null,error:new Uu("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:a},{request:i});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(o){return nt(o)?{data:null,error:o}:{data:null,error:new Uu("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a},i){if(!r)return{data:null,error:new vg("rpId is required for WebAuthn registration")};try{if(!$M())return{data:null,error:new Uu("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(d=>{var h;return(h=d.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===t&&f.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:a},{create:i});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(o){return nt(o)?{data:null,error:o}:{data:null,error:new Uu("Unexpected error in register",o)}}}}Vue();const ode={url:nue,storageKey:aue,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:sue,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function FM(e,t,r){return await r()}const gh={};class gg{get jwks(){var t,r;return(r=(t=gh[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){gh[this.storageKey]=Object.assign(Object.assign({},gh[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=gh[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){gh[this.storageKey]=Object.assign(Object.assign({},gh[this.storageKey]),{cachedAt:t})}constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=gg.nextInstanceID,gg.nextInstanceID+=1,this.instanceID>0&&ha()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},ode),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Lue({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=pW(a.fetch),this.lock=a.lock||FM,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:ha()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Uue:this.lock=FM,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new ide(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:fW()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=MM(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=MM(this.memoryStorage)),ha()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${uW}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(ha()&&(r=yue(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),ha()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),due(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return nt(r)?this._returnResult({error:r}):this._returnResult({error:new Uu("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const i=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:bi}),{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(nt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(t){var r,n,a;try{let i;if("email"in t){const{email:d,password:h,options:f}=t;let p=null,m=null;this.flowType==="pkce"&&([p,m]=await ph(this.storage,this.storageKey)),i=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:m},xform:bi})}else if("phone"in t){const{phone:d,password:h,options:f}=t;i=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(a=f==null?void 0:f.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:bi})}else throw new qy("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(nt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:o,options:l}=t;r=await dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:IM})}else if("phone"in t){const{phone:i,password:o,options:l}=t;r=await dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:IM})}else throw new qy("You must provide either an email or phone number and a password");const{data:n,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const i=new fh;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(nt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,a,i,o,l,c,u,d,h,f;let p,m;if("message"in t)p=t.message,m=t.signature;else{const{chain:v,wallet:g,statement:x,options:y}=t;let b;if(ha())if(typeof g=="object")b=g;else{const E=window;if("ethereum"in E&&typeof E.ethereum=="object"&&"request"in E.ethereum&&typeof E.ethereum.request=="function")b=E.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=g}const N=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href),j=await b.request({method:"eth_requestAccounts"}).then(E=>E).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!j||j.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const _=vW(j[0]);let S=(n=y==null?void 0:y.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!S){const E=await b.request({method:"eth_chainId"});S=zue(E)}const C={domain:N.host,address:_,statement:x,uri:N.href,version:"1",chainId:S,nonce:(a=y==null?void 0:y.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(o=(i=y==null?void 0:y.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=y==null?void 0:y.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=y==null?void 0:y.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=y==null?void 0:y.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=y==null?void 0:y.signInWithEthereum)===null||d===void 0?void 0:d.resources};p=que(C),m=await b.request({method:"personal_sign",params:[Wue(p),_]})}try{const{data:v,error:g}=await dt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:m},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:bi});if(g)throw g;if(!v||!v.session||!v.user){const x=new fh;return this._returnResult({data:{user:null,session:null},error:x})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:g})}catch(v){if(nt(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async signInWithSolana(t){var r,n,a,i,o,l,c,u,d,h,f,p;let m,v;if("message"in t)m=t.message,v=t.signature;else{const{chain:g,wallet:x,statement:y,options:b}=t;let N;if(ha())if(typeof x=="object")N=x;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))N=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=x}const j=new URL((r=b==null?void 0:b.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in N&&N.signIn){const _=await N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),y?{statement:y}:null));let S;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")S=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)S=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)m=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),v=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in N)||typeof N.signMessage!="function"||!("publicKey"in N)||typeof N!="object"||!N.publicKey||!("toBase58"in N.publicKey)||typeof N.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${j.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(a=(n=b==null?void 0:b.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=b==null?void 0:b.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((u=b==null?void 0:b.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((h=(d=b==null?void 0:b.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...b.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const _=await N.signMessage(new TextEncoder().encode(m),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=_}}try{const{data:g,error:x}=await dt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:Hu(v)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:bi});if(x)throw x;if(!g||!g.session||!g.user){const y=new fh;return this._returnResult({data:{user:null,session:null},error:y})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:x})}catch(g){if(nt(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(t){const r=await ku(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:i,error:o}=await dt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:bi});if(await Yl(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const l=new fh;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(nt(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:i,nonce:o}=t,l=await dt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:bi}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new fh;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(nt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,a,i,o;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await ph(this.storage,this.storageKey));const{error:h}=await dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new qy("You must provide either an email or phone number.")}catch(l){if(nt(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await dt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:bi});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(nt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var r,n,a;try{let i=null,o=null;this.flowType==="pkce"&&([i,o]=await ph(this.storage,this.storageKey));const l=await dt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Mue});return this._returnResult(l)}catch(i){if(nt(i))return this._returnResult({data:null,error:i});throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new yi;const{error:a}=await dt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(nt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:o}=await dt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:o,error:l}=await dt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new qy("You must provide either an email or phone number and a type")}catch(r){if(nt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ku(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<s2:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await ku(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=l2()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=Rue(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:cc}):await this._useSession(async r=>{var n,a,i;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new yi}:await dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:cc})})}catch(r){if(nt(r))return uue(r)&&(await this._removeSession(),await Yl(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new yi;const o=a.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await ph(this.storage,this.storageKey));const{data:u,error:d}=await dt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:cc});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(nt(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new yi;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:o}=o2(t.access_token);if(o.exp&&(n=o.exp,a=n<=r),a){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(nt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new yi;const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(nt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!ha())throw new Gy("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Gy(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new EM("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Gy("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new EM("No code detected.");const{data:y,error:b}=await this._exchangeCodeForSession(t.code);if(b)throw b;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=t;if(!i||!l||!o||!u)throw new Gy("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let f=d+h;c&&(f=parseInt(c));const p=f-d;p*1e3<=Rh&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const m=f-h;d-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,f,d):d-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,f,d);const{data:v,error:g}=await this._getUser(i);if(g)throw g;const x={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:t.type},error:null})}catch(n){if(nt(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ku(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return this._returnResult({error:i});const o=(n=a.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(cue(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await Yl(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=xue(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await ph(this.storage,this.storageKey,!0));try{return await dt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(nt(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(nt(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var o,l,c,u,d;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await dt(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(a)throw a;return ha()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(nt(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:a,data:{session:i}}=r;if(a)throw a;const{options:o,provider:l,token:c,access_token:u,nonce:d}=t,h=await dt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i==null?void 0:i.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:bi}),{data:f,error:p}=h;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new fh}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(a){if(nt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:o}=r;if(o)throw o;return await dt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(nt(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await jue(async a=>(a>0&&await wue(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await dt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:bi})),(a,i)=>{const o=200*Math.pow(2,a);return i&&i2(i)&&Date.now()+o-n<Rh})}catch(n){if(this._debug(r,"error",n),nt(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),ha()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await ku(this.storage,this.storageKey);if(a&&this.userStorage){let o=await ku(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await Oh(this.userStorage,this.storageKey+"-user",o)),a.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:l2()}else if(a&&!a.user&&!a.user){const o=await ku(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(a.user=o.user,await Yl(this.storage,this.storageKey+"-user"),await Oh(this.storage,this.storageKey,a)):a.user=l2()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<s2;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${s2}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),i2(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(a.access_token);!l&&(o!=null&&o.user)?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new yi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new _j;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new yi;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),nt(i)){const o={data:null,error:i};return i2(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Oh(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=RM(a);await Oh(this.storage,this.storageKey,i)}else{const a=RM(r);await Oh(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Yl(this.storage,this.storageKey),await Yl(this.storage,this.storageKey+"-code-verifier"),await Yl(this.storage,this.storageKey+"-user"),this.userStorage&&await Yl(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ha()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Rh);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Rh);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Rh}ms, refresh threshold is ${fE} ticks`),a<=fE&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof mW)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ha()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await ph(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?this._returnResult({data:null,error:i}):await dt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(nt(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await dt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&c.type==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(nt(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?Zue(t.webauthn.credential_response):Jue(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await dt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(nt(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=await dt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Xue(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Que(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(nt(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=o2(n.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?await dt(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new yi})})}catch(r){if(nt(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new yi});const o=await dt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&ha()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(nt(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new yi});const o=await dt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&ha()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(nt(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+oue>a)return n;const{data:i,error:o}=await dt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:p,error:m}=await this.getSession();if(m||!p.session)return this._returnResult({data:null,error:m});n=p.session.access_token}const{header:a,payload:i,signature:o,raw:{header:l,payload:c}}=o2(n);r!=null&&r.allowExpired||Aue(i.exp);const u=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:i,header:a,signature:o},error:null}}const d=Pue(a.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,o,vue(`${l}.${c}`)))throw new vE("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(n){if(nt(n))return this._returnResult({data:null,error:n});throw n}}}gg.nextInstanceID=0;const lde=gg;class cde extends lde{constructor(t){super(t)}}class ude{constructor(t,r,n){var a,i,o;this.supabaseUrl=t,this.supabaseKey=r;const l=rue(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:Kce,realtime:Xce,auth:Object.assign(Object.assign({},Yce),{storageKey:c}),global:Hce},d=tue(n??{},u);this.storageKey=(a=d.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=Jce(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new nce(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new Wce(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new ece(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,storageKey:o,flowType:l,lock:c,debug:u,throwOnError:d},h,f){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new cde({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),h),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,flowType:l,lock:c,debug:u,throwOnError:d,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new bce(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const dde=(e,t,r)=>new ude(e,t,r);function hde(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}hde()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const fde="https://jgwmxzgeropjxwonnruz.supabase.co",pde="sb_publishable_4SdRme_-chJ5v54EXtP6kw_MVJSbuSG",T=dde(fde,pde,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0},global:{headers:{"x-client-info":"vairify-web"}}}),mde=Object.freeze(Object.defineProperty({__proto__:null,supabase:T},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var xW=function(e,t){return(xW=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])})(e,t)};function Ji(e,t){function r(){this.constructor=e}xW(e,t),e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function Ye(e,t,r,n){return new(r||(r=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?a(u.value):new r(function(d){d(u.value)}).then(o,l)}c((n=n.apply(e,[])).next())})}function Xe(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(c){return function(u){return function(d){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&d[0]?n.return:d[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,d[1])).done)return a;switch(n=0,a&&(d=[2&d[0],a.value]),d[0]){case 0:case 1:a=d;break;case 4:return o.label++,{value:d[1],done:!1};case 5:o.label++,n=d[1],d=[0];continue;case 7:d=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){o=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){o.label=d[1];break}if(d[0]===6&&o.label<a[1]){o.label=a[1],a=d;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(d);break}a[2]&&o.ops.pop(),o.trys.pop();continue}d=t.call(e,o)}catch(h){d=[6,h],n=0}finally{r=a=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([c,u])}}}var vde=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,r){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+r+"."),this.platformName=t,this.platform=r},e.prototype.registerFlag=function(t,r,n){if(this.flagRegistry[t]={evaluationFn:r,setHook:n},this.urlFlags[t]!=null){var a=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+a+"."),this.set(t,a)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,r){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=r,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(r)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var r,n,a=(r=this.global.location.search,n={},r.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var o=[],l=1;l<arguments.length;l++)o[l-1]=arguments[l];return gde(n,o[0],o[1]),o.join("=")}),n);"tfjsflags"in a&&a.tfjsflags.split(",").forEach(function(i){var o=i.split(":"),l=o[0],c=o[1];t.urlFlags[l]=function(u,d){if((d=d.toLowerCase())==="true"||d==="false")return d==="true";if(""+ +d===d)return+d;throw new Error("Could not parse value flag value "+d+" for flag "+u+".")}(l,c)})}},e}();function gde(e,t,r){e[decodeURIComponent(t)]=decodeURIComponent(r||"")}function fe(){return yW}var yW=null,W0=new Map,gE=new Map;function bW(e,t){var r=jW(e,t);return W0.get(r)}function xde(e){return gE.get(e)}function LM(e){for(var t=W0.entries(),r=[];;){var n=t.next(),a=n.done,i=n.value;if(a)break;var o=i[0],l=i[1];o.split("_")[0]===e&&r.push(l)}return r}function wW(e){var t=e.kernelName,r=e.backendName,n=jW(t,r);if(W0.has(n))throw new Error("The kernel '"+t+"' for backend '"+r+"' is already registered");W0.set(n,e)}function yde(e){var t=e.kernelName;gE.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),gE.set(t,e)}function jW(e,t){return t+"_"+e}function xE(e,t,r){return Math.max(e,Math.min(t,r))}function NW(e){return e%2==0?e:e+1}function bde(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t}function z(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function nr(e,t,r){r===void 0&&(r=""),z(Gn(e,t),function(){return r+" Shapes "+e+" and "+t+" must match"})}function Zp(e){z(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function Jf(e,t,r){if(t===void 0&&(t=[]),r===void 0&&(r=!1),t==null&&(t=[]),Array.isArray(e)||Eo(e)&&!r)for(var n=0;n<e.length;++n)Jf(e[n],t,r);else t.push(e);return t}function Qe(e){if(e.length===0)return 1;for(var t=e[0],r=1;r<e.length;r++)t*=e[r];return t}function Gn(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function rn(e){return e%1==0}function wde(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function yE(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function mf(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function BM(e,t,r){return t===void 0&&(t=function(n){return 0}),new Promise(function(n,a){var i=0,o=function(){if(e())n();else{i++;var l=t(i);r!=null&&i>=r?a():setTimeout(o,l)}};o()})}function jde(e,t){for(var r=1,n=-1,a=0;a<e.length;++a)if(e[a]>=0)r*=e[a];else if(e[a]===-1){if(n!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+n+" and dim "+a);n=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found "+e[a]+" at dim "+a);if(n===-1){if(t>0&&t!==r)throw Error("Size("+t+") must match the product of shape "+e);return e}if(r===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%r!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+r);var i=e.slice();return i[n]=t/r,i}function $n(e,t){var r=t.length;return z((e=e==null?t.map(function(n,a){return a}):[].concat(e)).every(function(n){return n>=-r&&n<r}),function(){return"All values in axis param must be in range [-"+r+", "+r+") but got axis "+e}),z(e.every(function(n){return rn(n)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(n){return n<0?r+n:n})}function Vu(e,t){for(var r=[],n=[],a=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||a?null:$n(t,e).sort(),o=0,l=0;l<e.length;++l){if(i!=null){if(i[o]===l&&e[l]!==1)throw new Error("Can't squeeze axis "+l+" since its dim '"+e[l]+"' is not 1");(i[o]==null||i[o]>l)&&e[l]===1&&(r.push(e[l]),n.push(l)),i[o]<=l&&o++}e[l]!==1&&(r.push(e[l]),n.push(l))}return{newShape:r,keptDims:n}}function xg(e,t){var r=null;if(e==null||e==="float32")r=new Float32Array(t);else if(e==="int32")r=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);r=new Uint8Array(t)}return r}function q0(e,t){var r=null;if(e==null||e==="float32")r=new Float32Array(t);else if(e==="int32")r=new Int32Array(t);else if(e==="bool")r=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);r=new Array(t)}return r}function Nde(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(isNaN(n)||!isFinite(n))throw Error("A tensor of type "+t+" being uploaded contains "+n+".")}}function _de(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function Sde(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function Eo(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function _W(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function Cde(e){if(e==null)return 0;var t=0;return e.forEach(function(r){return t+=r.length}),t}function UT(e){return typeof e=="string"||e instanceof String}function Ede(e){return typeof e=="boolean"}function kde(e){return typeof e=="number"}function Ax(e){return Array.isArray(e)?Ax(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":kde(e)?"float32":UT(e)?"string":Ede(e)?"bool":"float32"}function bE(e){return!!(e&&e.constructor&&e.call&&e.apply)}function wE(e,t){for(var r=t;r<e;++r)if(e%r==0)return r;return e}function ko(e){var t=e.length;if(t<2)return[];var r=new Array(t-1);r[t-2]=e[t-1];for(var n=t-3;n>=0;--n)r[n]=r[n+1]*e[n+1];return r}function SW(e,t,r){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Jf(e)),r&&Nde(e,t),function(i,o){return i instanceof Float32Array&&o==="float32"||i instanceof Int32Array&&o==="int32"||i instanceof Uint8Array&&o==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var n=new Uint8Array(e.length),a=0;a<n.length;++a)Math.round(e[a])!==0&&(n[a]=1);return n}throw new Error("Unknown data type "+t)}function UM(e,t){if(e.length===0)return t[0];var r=e.reduce(function(n,a){return n*a});if(r===0)return[];if(r!==t.length)throw new Error("["+e+"] does not match the input size.");return function n(a,i,o){var l=new Array;if(i.length===1)for(var c=i[0],u=0;u<c;u++)l[u]=o[a+u];else{c=i[0];var d=i.slice(1),h=d.reduce(function(f,p){return f*p});for(u=0;u<c;u++)l[u]=n(a+u*h,d,o)}return l}(0,e,t)}function CW(e,t){for(var r=Px(e,t),n=0;n<r.length;n++)r[n]=1;return r}function Px(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function fo(){return fe().platform.now()}function EW(e){e.forEach(function(t){z(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function Ade(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",fe().platform.encode(e,t)}function G0(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",fe().platform.decode(e,t)}function VM(e,t,r){if(t===0)return 0;if(t===1)return e[0];for(var n=e[e.length-1],a=0;a<e.length-1;++a)n+=r[a]*e[a];return n}function Pde(e,t,r){if(t===0)return[];if(t===1)return[e];for(var n=new Array(t),a=0;a<n.length-1;++a)n[a]=Math.floor(e/r[a]),e-=n[a]*r[a];return n[n.length-1]=e,n}var Tde=function(){function e(t,r){this.backendTimer=t,this.logger=r,r==null&&(this.logger=new Rde)}return e.prototype.profileKernel=function(t,r,n){var a,i=this,o=this.backendTimer.time(function(){a=n()});return a.forEach(function(l){l.data().then(function(c){(function(u,d,h){if(d!=="float32")return!1;for(var f=0;f<u.length;f++){var p=u[f];if(isNaN(p)||!isFinite(p))return console.warn("Found "+p+" in the result of '"+h+"'"),!0}})(c,l.dtype,t),o.then(function(u){var d="";u.getExtraProfileInfo!=null&&(d=u.getExtraProfileInfo()),i.logger.logKernelProfile(t,l,c,u.kernelMs,r,d)})})}),a},e}(),Rde=function(){function e(){}return e.prototype.logKernelProfile=function(t,r,n,a,i,o){var l=typeof a=="number"?mf(a+"ms",9):a.error,c=mf(t,25),u=r.rank,d=r.size,h=mf(r.shape.toString(),14),f="";for(var p in i){var m=i[p].shape||r.shape,v=m.length;f+=p+": "+v+"D "+(v>0?m:"")+" "}console.log("%c"+c+"	%c"+l+"	%c"+u+"D "+h+"	%c"+d+"	%c"+f+"	%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),zM=20,$m=3,u2=7;function Ode(e,t,r,n){var a=ko(t),i=function(u,d,h,f){var p=Qe(d),m=f[f.length-1],v=new Array(m).fill(0),g=d.length,x=h==="complex64"?Lm(u):u;if(g>1)for(var y=0;y<p/m;y++)for(var b=y*m,N=0;N<m;N++)v[N]=Math.max(v[N],Fm(x[b+N],0,h).length);return v}(e,t,r,a),o=t.length,l=function u(d,h,f,p,m,v){v===void 0&&(v=!0);var g=f==="complex64"?2:1,x=h[0],y=h.length;if(y===0)return f==="complex64"?[Fm(Lm(d)[0],0,f)]:f==="bool"?[kW(d[0])]:[d[0].toString()];if(y===1){if(x>zM){var b=$m*g,N=Array.from(d.slice(0,b)),j=Array.from(d.slice((x-$m)*g,x*g));return f==="complex64"&&(N=Lm(N),j=Lm(j)),["["+N.map(function(R,M){return Fm(R,m[M],f)}).join(", ")+", ..., "+j.map(function(R,M){return Fm(R,m[x-$m+M],f)}).join(", ")+"]"]}return["["+(f==="complex64"?Lm(d):Array.from(d)).map(function(R,M){return Fm(R,m[M],f)}).join(", ")+"]"]}var _=h.slice(1),S=p.slice(1),C=p[0]*g,E=[];if(x>zM){for(var k=0;k<$m;k++){var P=(A=k*C)+C;E.push.apply(E,u(d.slice(A,P),_,f,S,m,!1))}for(E.push("..."),k=x-$m;k<x;k++)P=(A=k*C)+C,E.push.apply(E,u(d.slice(A,P),_,f,S,m,k===x-1))}else for(k=0;k<x;k++){var A;P=(A=k*C)+C,E.push.apply(E,u(d.slice(A,P),_,f,S,m,k===x-1))}var O=y===2?",":"";for(E[0]="["+E[0]+O,k=1;k<E.length-1;k++)E[k]=" "+E[k]+O;var I=`,
`;for(k=2;k<y;k++)I+=`
`;return E[E.length-1]=" "+E[E.length-1]+"]"+(v?"":I),E}(e,t,r,a,i),c=["Tensor"];return n&&(c.push("  dtype: "+r),c.push("  rank: "+o),c.push("  shape: ["+t+"]"),c.push("  values:")),c.push(l.map(function(u){return"    "+u}).join(`
`)),c.join(`
`)}function Fm(e,t,r){return mf(Array.isArray(e)?parseFloat(e[0].toFixed(u2))+" + "+parseFloat(e[1].toFixed(u2))+"j":UT(e)?"'"+e+"'":r==="bool"?kW(e):parseFloat(e.toFixed(u2)).toString(),t)}function kW(e){return e===0?"false":"true"}function Lm(e){for(var t=[],r=0;r<e.length;r+=2)t.push([e[r],e[r+1]]);return t}var yg=function(){function e(t,r,n){var a=this;if(this.dtype=r,this.shape=t.slice(),this.size=Qe(t),n!=null){var i=n.length;z(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+a.size+"'."})}if(r==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||q0(r,this.size),this.strides=ko(t)}return e.prototype.set=function(t){for(var r=this,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];n.length===0&&(n=[0]),z(n.length===this.rank,function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+r.rank+")"});var i=this.locToIndex(n);this.values[i]=t},e.prototype.get=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.length===0&&(t=[0]);for(var n=0,a=0,i=t;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[n]){var l="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(l)}n++}for(var c=t[t.length-1],u=0;u<t.length-1;++u)c+=this.strides[u]*t[u];return this.values[c]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var r=t[t.length-1],n=0;n<t.length-1;++n)r+=this.strides[n]*t[n];return r},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var r=new Array(this.shape.length),n=0;n<r.length-1;++n)r[n]=Math.floor(t/this.strides[n]),t-=r[n]*this.strides[n];return r[r.length-1]=t,r},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return mo().makeTensor(this.values,this.shape,this.dtype)},e}(),mo=null,ue=null,AW=null,Ir=function(){function e(t,r,n,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=r||"float32",this.size=Qe(t),this.strides=ko(t),this.dataId=n,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),z(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,r){return this.throwIfDisposed(),this.reshape([t,r])},e.prototype.as3D=function(t,r,n){return this.throwIfDisposed(),this.reshape([t,r,n])},e.prototype.as4D=function(t,r,n,a){return this.throwIfDisposed(),this.reshape([t,r,n,a])},e.prototype.as5D=function(t,r,n,a,i){return this.throwIfDisposed(),this.reshape([t,r,n,a,i])},e.prototype.asType=function(t){return this.throwIfDisposed(),ue.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return Ye(this,void 0,void 0,function(){var t;return Xe(this,function(r){switch(r.label){case 0:return[4,this.data()];case 1:return t=r.sent(),[2,ue.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return ue.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return Ye(this,void 0,void 0,function(){var t;return Xe(this,function(r){switch(r.label){case 0:return[4,this.data()];case 1:return t=r.sent(),[2,UM(this.shape,t)]}})})},e.prototype.arraySync=function(){return UM(this.shape,this.dataSync())},e.prototype.data=function(){return Ye(this,void 0,void 0,function(){var t,r;return Xe(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=mo().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:r=n.sent();try{return[2,r.map(function(a){return G0(a)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=mo().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(r){return G0(r)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return Ye(this,void 0,void 0,function(){var t;return Xe(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),[4,mo().read(this.dataId)];case 1:return t=r.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(mo().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),ue.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),ue.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),ue.expandDims(this,t)},e.prototype.cumsum=function(t,r,n){return t===void 0&&(t=0),r===void 0&&(r=!1),n===void 0&&(n=!1),ue.cumsum(this,t,r,n)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),ue.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),ue.clone(this)},e.prototype.oneHot=function(t,r,n){return this.throwIfDisposed(),ue.oneHot(this,t,r,n)},e.prototype.toString=function(t){return t===void 0&&(t=!1),Ode(this.dataSync(),this.shape,this.dtype,t)},e.prototype.tile=function(t){return this.throwIfDisposed(),ue.tile(this,t)},e.prototype.gather=function(t,r){return r===void 0&&(r=0),this.throwIfDisposed(),ue.gather(this,t,r)},e.prototype.matMul=function(t,r,n){return r===void 0&&(r=!1),n===void 0&&(n=!1),this.throwIfDisposed(),ue.matMul(this,t,r,n)},e.prototype.dot=function(t){return this.throwIfDisposed(),ue.dot(this,t)},e.prototype.norm=function(t,r,n){return t===void 0&&(t="euclidean"),r===void 0&&(r=null),n===void 0&&(n=!1),this.throwIfDisposed(),ue.norm(this,t,r,n)},e.prototype.slice=function(t,r){return this.throwIfDisposed(),ue.slice(this,t,r)},e.prototype.reverse=function(t){return this.throwIfDisposed(),ue.reverse(this,t)},e.prototype.concat=function(t,r){return r===void 0&&(r=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),ue.concat([this].concat(t),r)},e.prototype.split=function(t,r){return r===void 0&&(r=0),this.throwIfDisposed(),ue.split(this,t,r)},e.prototype.stack=function(t,r){return r===void 0&&(r=0),ue.stack([this,t],r)},e.prototype.unstack=function(t){return t===void 0&&(t=0),ue.unstack(this,t)},e.prototype.pad=function(t,r){return r===void 0&&(r=0),ue.pad(this,t,r)},e.prototype.batchNormalization=function(t,r,n,a,i){return n===void 0&&(n=.001),AW("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,r,i,a,n)},e.prototype.batchNorm=function(t,r,n,a,i){return i===void 0&&(i=.001),this.throwIfDisposed(),ue.batchNorm(this,t,r,n,a,i)},e.prototype.all=function(t,r){return t===void 0&&(t=null),r===void 0&&(r=!1),this.throwIfDisposed(),ue.all(this,t,r)},e.prototype.any=function(t,r){return t===void 0&&(t=null),r===void 0&&(r=!1),this.throwIfDisposed(),ue.any(this,t,r)},e.prototype.logSumExp=function(t,r){return t===void 0&&(t=null),r===void 0&&(r=!1),this.throwIfDisposed(),ue.logSumExp(this,t,r)},e.prototype.sum=function(t,r){return t===void 0&&(t=null),r===void 0&&(r=!1),this.throwIfDisposed(),ue.sum(this,t,r)},e.prototype.prod=function(t,r){return t===void 0&&(t=null),r===void 0&&(r=!1),this.throwIfDisposed(),ue.prod(this,t,r)},e.prototype.mean=function(t,r){return t===void 0&&(t=null),r===void 0&&(r=!1),this.throwIfDisposed(),ue.mean(this,t,r)},e.prototype.min=function(t,r){return t===void 0&&(t=null),r===void 0&&(r=!1),this.throwIfDisposed(),ue.min(this,t,r)},e.prototype.max=function(t,r){return t===void 0&&(t=null),r===void 0&&(r=!1),this.throwIfDisposed(),ue.max(this,t,r)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ue.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ue.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),ue.cast(this,t)},e.prototype.add=function(t){return this.throwIfDisposed(),ue.add(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),ue.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),ue.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),ue.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),ue.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),ue.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),ue.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),ue.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),ue.mulStrict(this,t)},e.prototype.div=function(t){return this.throwIfDisposed(),ue.div(this,t)},e.prototype.divNoNan=function(t){return this.throwIfDisposed(),ue.divNoNan(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),ue.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),ue.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),ue.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),ue.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),ue.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),ue.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),ue.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),ue.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),ue.squaredDifferenceStrict(this,t)},e.prototype.transpose=function(t){return this.throwIfDisposed(),ue.transpose(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),ue.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),ue.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),ue.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),ue.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),ue.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),ue.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),ue.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),ue.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),ue.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),ue.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),ue.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),ue.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),ue.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),ue.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),ue.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),ue.logicalXor(this,t)},e.prototype.where=function(t,r){return this.throwIfDisposed(),ue.where(t,this,r)},e.prototype.neg=function(){return this.throwIfDisposed(),ue.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),ue.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),ue.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),ue.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),ue.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),ue.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),ue.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),ue.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),ue.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),ue.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),ue.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),ue.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),ue.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),ue.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),ue.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),ue.abs(this)},e.prototype.clipByValue=function(t,r){return this.throwIfDisposed(),ue.clipByValue(this,t,r)},e.prototype.relu=function(){return this.throwIfDisposed(),ue.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),ue.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),ue.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),ue.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),ue.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),ue.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),ue.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),ue.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),ue.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),ue.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),ue.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),ue.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),ue.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),ue.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),ue.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),ue.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),ue.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),ue.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),ue.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),ue.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),ue.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),ue.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),ue.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),ue.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),ue.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),ue.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ue.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ue.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,r){return r===void 0&&(r=!1),this.throwIfDisposed(),ue.image.resizeBilinear(this,t,r)},e.prototype.resizeNearestNeighbor=function(t,r){return r===void 0&&(r=!1),this.throwIfDisposed(),ue.image.resizeNearestNeighbor(this,t,r)},e.prototype.conv1d=function(t,r,n,a,i,o){return a===void 0&&(a="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),ue.conv1d(this,t,r,n,a,i,o)},e.prototype.conv2d=function(t,r,n,a,i,o){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),ue.conv2d(this,t,r,n,a,i,o)},e.prototype.conv2dTranspose=function(t,r,n,a,i){return this.throwIfDisposed(),ue.conv2dTranspose(this,t,r,n,a,i)},e.prototype.depthwiseConv2D=function(t,r,n,a,i,o){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),ue.depthwiseConv2d(this,t,r,n,a,i,o)},e.prototype.separableConv2d=function(t,r,n,a,i,o){return i===void 0&&(i=[1,1]),o===void 0&&(o="NHWC"),this.throwIfDisposed(),ue.separableConv2d(this,t,r,n,a,i,o)},e.prototype.avgPool=function(t,r,n,a){return this.throwIfDisposed(),ue.avgPool(this,t,r,n,a)},e.prototype.maxPool=function(t,r,n,a){return this.throwIfDisposed(),ue.maxPool(this,t,r,n,a)},e.prototype.localResponseNormalization=function(t,r,n,a){return t===void 0&&(t=5),r===void 0&&(r=1),n===void 0&&(n=1),a===void 0&&(a=.5),ue.localResponseNormalization(this,t,r,n,a)},e.prototype.pool=function(t,r,n,a,i){return this.throwIfDisposed(),ue.pool(this,t,r,n,a,i)},e.prototype.variable=function(t,r,n){return t===void 0&&(t=!0),this.throwIfDisposed(),mo().makeVariable(this,t,r,n)},e.prototype.unsortedSegmentSum=function(t,r){return this.throwIfDisposed(),ue.unsortedSegmentSum(this,t,r)},e.prototype.batchToSpaceND=function(t,r){return this.throwIfDisposed(),ue.batchToSpaceND(this,t,r)},e.prototype.spaceToBatchND=function(t,r){return this.throwIfDisposed(),ue.spaceToBatchND(this,t,r)},e.prototype.topk=function(t,r){return t===void 0&&(t=1),r===void 0&&(r=!0),this.throwIfDisposed(),ue.topk(this,t,r)},e.prototype.stridedSlice=function(t,r,n,a,i,o,l,c){return a===void 0&&(a=0),i===void 0&&(i=0),o===void 0&&(o=0),l===void 0&&(l=0),c===void 0&&(c=0),this.throwIfDisposed(),ue.stridedSlice(this,t,r,n,a,i,o,l,c)},e.prototype.depthToSpace=function(t,r){return this.throwIfDisposed(),ue.depthToSpace(this,t,r)},e.prototype.fft=function(){return this.throwIfDisposed(),ue.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),ue.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),ue.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),ue.spectral.irfft(this)},e}();Object.defineProperty(Ir,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var WM,jE,NE,_E,SE,ep=function(e){function t(r,n,a,i){var o=e.call(this,r.shape,r.dtype,r.dataId,i)||this;return o.trainable=n,o.name=a,o}return Ji(t,e),t.prototype.assign=function(r){if(r.dtype!==this.dtype)throw new Error("dtype of the new value ("+r.dtype+") and previous value ("+this.dtype+") must match");if(!Gn(r.shape,this.shape))throw new Error("shape of the new value ("+r.shape+") and previous value ("+this.shape+") must match");mo().disposeTensor(this),this.dataId=r.dataId,mo().incRef(this,null)},t.prototype.dispose=function(){mo().disposeVariable(this),this.isDisposedInternal=!0},t}(Ir);Object.defineProperty(ep,Symbol.hasInstance,{value:function(e){return e instanceof Ir&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(WM||(WM={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(jE||(jE={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(NE||(NE={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(_E||(_E={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(SE||(SE={}));var Ide={float32:_E,int32:jE,bool:NE,complex64:SE};function ta(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return Ide[e][t]}function d2(e){return ta(e,"int32")}function Lr(e,t){if(e.dtype===t.dtype)return[e,t];var r=ta(e.dtype,t.dtype);return[e.cast(r),t.cast(r)]}function Dde(e,t){z(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function PW(e){var t=[];return function r(n,a,i){if(n!=null){if(n instanceof Ir)return void a.push(n);if(o=n,!(!Array.isArray(o)&&typeof o!="object")){var o,l=n;for(var c in l){var u=l[c];i.has(u)||(i.add(u),r(u,a,i))}}}}(e,t,new Set),t}var h2,qM=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),Mde=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new qM}return e.prototype.ready=function(){return Ye(this,void 0,void 0,function(){var t,r,n;return Xe(this,function(a){switch(a.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),r=0,a.label=1;case 1:return r<t.length?(n=t[r],[4,this.initializeBackend(n).success]):[3,5];case 2:return a.sent()?[4,this.setBackend(n)]:[3,4];case 3:return a.sent(),[2];case 4:return r++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),r=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+r+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(r)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,r,n){return n===void 0&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:r,priority:n},!0)},e.prototype.setBackend=function(t){return Ye(this,void 0,void 0,function(){var r,n,a;return Xe(this,function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,r=this.initializeBackend(t),n=r.success,r.asyncInit?[4,n]:[3,2]);case 1:return a=i.sent(),[3,3];case 2:a=n,i.label=3;case 3:if(!a)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Tde(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;LM(this.backendName).forEach(function(r){r.setupFunc!=null&&r.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var r=this;LM(t).forEach(function(n){n.disposeFunc!=null&&n.disposeFunc(r.registry[t])})},e.prototype.initializeBackend=function(t){var r=this,n=this.registryFactory[t];if(n==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var a=n.factory();if(Promise.resolve(a)===a){var i=++this.pendingBackendInitId,o=a.then(function(l){return!(i<r.pendingBackendInitId)&&(r.registry[t]=l,r.pendingBackendInit=null,!0)}).catch(function(l){return!(i<r.pendingBackendInitId)&&(r.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),!1)});return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[t]=a,{success:!0,asyncInit:!1}}catch(l){return console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(r,n){return t.registryFactory[n].priority-t.registryFactory[r].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),r=0;r<t.length;r++){var n=t[r],a=this.initializeBackend(n),i=a.success,o=a.asyncInit;if(o||i)return{name:n,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,r){var n=this.state.tensorInfo.get(r),a=n.backend,i=this.readSync(r);a.disposeData(r),n.backend=t,t.move(r,i,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,r){var n,a=this,i=null;if(r==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");r=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof r!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return a.startScope(i)},function(){return a.endScope(n)},function(){return(n=r())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n})},e.prototype.scopedRun=function(t,r,n){t();try{var a=n();return r(),a}catch(i){throw r(),i}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var r=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[r],function(a){return{x:function(){return a.toFloat()}}},[]),r},e.prototype.runKernel=function(t,r,n,a,i){return this.runKernelFunc(null,r,null,t,n,a,i)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,r,n){var a=this.backend.numDataIds(),i=0;n.forEach(function(c){i+=c.dtype==="complex64"?3:1});var o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=a-r-i-o;if(l>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+l+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,r,n,a,i,o,l){var c,u=this;o===void 0&&(o=[]),l===void 0&&(l=[]);var d=[],h=this.isTapeOn();a==null&&(a=this.state.activeScope!=null?this.state.activeScope.name:"");var f,p=function(y){h&&(d=y.map(function(b){return u.keep(u.clone(b))}))},m=this.state.numBytes,v=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,x=bW(a,this.backendName);return f=x!=null?function(){var y=u.backend.numDataIds();g=x.kernelFunc({inputs:r,attrs:i,backend:u.backend});var b=Array.isArray(g)?g:[g];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(a,y,b);var N=b.map(function(_){var S=_.dataId,C=_.shape,E=_.dtype;return u.makeTensorFromDataId(S,C,E)}),j=N.filter(function(_,S){return l[S]});return p((o||[]).slice().concat(j)),N}:function(){var y=u.backend.numDataIds();g=u.tidy(function(){return t(u.backend,p)});var b=Array.isArray(g)?g:[g];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(a,y,b),b},this.scopedRun(function(){return u.state.kernelDepth++},function(){return u.state.kernelDepth--},function(){c=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(a,r,function(){return f()}):f()}),h&&this.addTapeNode(a,r,c,n,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:a,bytesAdded:this.state.numBytes-m,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-v,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(r).map(function(y){return r[y].shape}),outputShapes:c.map(function(y){return y.shape})}),Array.isArray(g)?c:c[0]},e.prototype.makeTensor=function(t,r,n,a){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",a=a||this.backend;var i=t;n==="string"&&UT(t[0])&&(i=t.map(function(d){return Ade(d)}));var o=a.write(i,r,n),l=new Ir(r,n,o,this.nextTensorId());if(this.incRef(l,a),n==="string"){var c=this.state.tensorInfo.get(o),u=Cde(i);this.state.numBytes+=u-c.bytes,c.bytes=u}return l},e.prototype.makeTensorFromDataId=function(t,r,n,a){var i=new Ir(r,n=n||"float32",t,this.nextTensorId());return this.incRef(i,a),i},e.prototype.makeVariable=function(t,r,n,a){r===void 0&&(r=!0),n=n||this.nextVariableId().toString(),a!=null&&a!==t.dtype&&(t=t.asType(a));var i=new ep(t,r,n,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},e.prototype.incRef=function(t,r){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,n===0){this.state.numDataBuffers++;var a=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(a=t.size*_W(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:r||this.backend,dtype:t.dtype,shape:t.shape,bytes:a,refCount:0}),this.state.numBytes+=a}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof ep||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var r=this.state.tensorInfo.get(t.dataId);r.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=r.bytes),this.state.numDataBuffers--,r.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var r=this.state.registeredVariables[t];this.disposeVariable(r)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return Ye(this,void 0,void 0,function(){var r,n;return Xe(this,function(a){return this.state.profiling=!0,r=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-r,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,r,n,a,i){var o=this,l={id:this.state.nextTapeNodeId++,kernelName:t,inputs:r,outputs:n,saved:i},c=xde(t);c!=null&&(a=c.gradFunc),a!=null&&(l.gradient=function(u){return u=u.map(function(d,h){if(d==null){var f=n[h],p=Px(f.size,f.dtype);return o.makeTensor(p,f.shape,f.dtype)}return d}),a(u.length>1?u:u[0],i)}),this.state.activeTape.push(l)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var r={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(r.name=t),this.state.scopeStack.push(r),this.state.activeScope=r},e.prototype.endScope=function(t){for(var r=this,n=PW(t),a=new Set(n.map(function(c){return c.id})),i=0;i<this.state.activeScope.track.length;i++){var o=this.state.activeScope.track[i];o.kept||a.has(o.id)||o.dispose()}var l=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(function(c){c.kept||c.scopeId!==l.id||r.track(c)})},e.prototype.gradients=function(t,r,n,a){var i=this;if(a===void 0&&(a=!1),z(r.length>0,function(){return"gradients() received an empty list of xs."}),n!=null&&n.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var o=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});z(o instanceof Ir,function(){return"The result y returned by f() must be a tensor."});var l=function(c,u,d){for(var h={},f={},p=0;p<u.length;p++)h[u[p].id]=!0;for(p=0;p<c.length;p++){var m=(_=c[p]).inputs;for(var v in m){for(var g=m[v],x=!1,y=0;y<u.length;y++)if(h[g.id]){_.outputs.forEach(function(k){return h[k.id]=!0}),x=!0,f[_.id]=!0;break}if(x)break}}var b={};b[d.id]=!0;var N={};for(p=c.length-1;p>=0;p--)for(m=(_=c[p]).inputs,y=0;y<_.outputs.length;y++)if(b[_.outputs[y].id]){for(var v in m)b[m[v].id]=!0,N[_.id]=!0;break}var j=[];for(p=0;p<c.length;p++){var _;if(f[(_=c[p]).id]&&N[_.id]){var S={};for(var v in _.inputs){var C=_.inputs[v];h[C.id]&&(S[v]=C)}var E=Object.assign({},_);E.inputs=S,E.outputs=_.outputs,j.push(E)}}return j}(this.state.activeTape,r,o);if(!a&&l.length===0&&r.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var c,u,d={};d[o.id]=n??(c=o.shape,u=CW(Qe(c),"float32"),J.makeTensor(u,c,"float32")),function(f,p,m){for(var v=function(x){var y=p[x],b=[];if(y.outputs.forEach(function(S){var C=f[S.id];C!=null?b.push(C):b.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var N=y.gradient(b),j=function(S){if(!(S in N))throw new Error("Cannot backprop through input "+S+". Available gradients found: "+Object.keys(N)+".");var C=m(function(){return N[S]()});if(C.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+S+" must have 'float32' dtype, but has '"+C.dtype+"'");var E=y.inputs[S];if(!Gn(C.shape,E.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+S+"' has shape '"+C.shape+"', which does not match the shape of the input '"+E.shape+"'");if(f[E.id]==null)f[E.id]=C;else{var k=f[E.id];f[E.id]=k.add(C),k.dispose()}};for(var _ in y.inputs)j(_)},g=p.length-1;g>=0;g--)v(g)}(d,l,function(f){return i.tidy(f)});var h=r.map(function(f){return d[f.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(f){for(var p=0,m=f.saved;p<m.length;p++)m[p].dispose()}),i.state.activeTape=null),{value:o,grads:h}})},e.prototype.customGrad=function(t){var r=this;return z(bE(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var n,a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];z(a.every(function(l){return l instanceof Ir}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var o={};return a.forEach(function(l,c){o[c]=l}),r.runKernelFunc(function(l,c){return z((n=t.apply(void 0,a.concat([c]))).value instanceof Ir,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),z(bE(n.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),n.value},o,function(l,c){var u=n.gradFunc(l,c),d=Array.isArray(u)?u:[u];z(d.length===a.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),z(d.every(function(f){return f instanceof Ir}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var h={};return d.forEach(function(f,p){h[p]=function(){return f}}),h})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return Ye(this,void 0,void 0,function(){var r,n;return Xe(this,function(a){switch(a.label){case 0:return r=fo(),[4,this.backend.time(t)];case 1:return(n=a.sent()).wallMs=fo()-r,[2,n]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new qM,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),J=function(){var e=function(){if(h2==null){var r=void 0;if(typeof window<"u")r=window;else if(typeof global<"u")r=global;else if(typeof process<"u")r=process;else{if(typeof self>"u")throw new Error("Could not find a global object");r=self}h2=r}return h2}();if(e._tfengine==null){var t=new vde(e);e._tfengine=new Mde(t)}return function(r){yW=r}(e._tfengine.ENV),mo=function(){return e._tfengine},e._tfengine}();function TW(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Yo=fe();Yo.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Yo.registerFlag("IS_BROWSER",function(){return TW()}),Yo.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),Yo.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Yo.registerFlag("PROD",function(){return!1}),Yo.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Yo.getBool("DEBUG")}),Yo.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Yo.registerFlag("IS_TEST",function(){return!1});var bg,ks,Ns,Iu={},f2={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function $de(e,t){Iu[e]=t}function Uo(e){e in Iu||(Iu[e]=function(r){if(r!==1&&r!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var n=function(a){if(typeof OffscreenCanvas<"u"&&a===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(r);return n.addEventListener("webglcontextlost",function(a){a.preventDefault(),delete Iu[r]},!1),r===1?n.getContext("webgl",f2)||n.getContext("experimental-webgl",f2):n.getContext("webgl2",f2)}(e));var t=Iu[e];return t.isContextLost()?(delete Iu[e],Uo(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Iu[e])}function Sj(e,t){return[t,e]}function Av(e){var t=Qe(e);return yE(Math.ceil(t/4))}function Tx(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function VT(e,t){var r,n,a,i,o,l,c,u,d,h=e;return fe().getNumber("WEBGL_VERSION")===2?(r=h.R32F,n=h.R16F,a=h.RGBA16F,i=h.RGBA32F,o=h.RED,l=4,c=1,u=h.HALF_FLOAT,d=h.FLOAT):(r=e.RGBA,n=e.RGBA,a=e.RGBA,i=h.RGBA,o=e.RGBA,l=4,c=4,u=t!=null?t.HALF_FLOAT_OES:null,d=e.FLOAT),{internalFormatFloat:r,internalFormatHalfFloat:n,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:l,defaultNumChannels:c,textureTypeHalfFloat:u,textureTypeFloat:d}}function Je(e,t,r){var n=r();return t&&function(a){var i=a.getError();if(i!==a.NO_ERROR)throw new Error("WebGL Error: "+Ude(a,i))}(e),n}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(bg||(bg={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(ks||(ks={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Ns||(Ns={}));var Fde=596e-10,Lde=65504;function Bde(e){return!!(fe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||Fde<Math.abs(e)&&Math.abs(e)<Lde)}function Ude(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Hy(e,t,r){return Dl(e,t,function(){return e.getExtension(r)},'Extension "'+r+'" not supported on this browser.')}function Vde(e,t,r){var n=Dl(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(Je(e,t,function(){return e.shaderSource(n,r)}),Je(e,t,function(){return e.compileShader(n)}),e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function zde(e,t,r){var n=Dl(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(Je(e,t,function(){return e.shaderSource(n,r)}),Je(e,t,function(){return e.compileShader(n)}),e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw function(a,i){var o=Wde.exec(i);if(o==null)return console.log("Couldn't parse line number in error: "+i),void console.log(a);for(var l=+o[1],c=a.split(`
`),u=c.length.toString().length+2,d=c.map(function(g,x){return mf((x+1).toString(),u)+g}),h=0,f=0;f<d.length;f++)h=Math.max(d[f].length,h);var p=d.slice(0,l-1),m=d.slice(l-1,l),v=d.slice(l);console.log(p.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+mf(m[0],h),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(v.join(`
`))}(r,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var p2,m2,Wde=/ERROR: [0-9]+:([0-9]+):/g;function qde(e,t){return Dl(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function Gde(e,t,r){if(Je(e,t,function(){return e.linkProgram(r)}),e.getProgramParameter(r,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(r)),new Error("Failed to link vertex and fragment shaders.")}function v2(e,t,r){if(Je(e,t,function(){return e.validateProgram(r)}),e.getProgramParameter(r,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(r)),new Error("Shader program validation failed.")}function Hde(e,t,r){var n=Dl(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return Je(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,n)}),Je(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW)}),n}function Kde(e,t,r){var n=Dl(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return Je(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)}),Je(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,r,e.STATIC_DRAW)}),n}function Yde(e,t){return Dl(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function Xde(e,t){var r=fe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var n="["+e+"x"+t+"]";throw new Error("Requested texture size "+n+" is invalid.")}if(e>r||t>r)throw n="["+e+"x"+t+"]",new Error("Requested texture size "+n+" greater than WebGL maximum on this browser / GPU "+("["+r+"x"+r+"]")+".")}function Qde(e,t){return Dl(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function GM(e,t,r,n,a,i,o,l){var c=e.getAttribLocation(r,n);return c!==-1&&(Je(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,a)}),Je(e,t,function(){return e.vertexAttribPointer(c,i,e.FLOAT,!1,o,l)}),Je(e,t,function(){return e.enableVertexAttribArray(c)}),!0)}function Zde(e,t,r,n){nhe(e,n),Je(e,t,function(){return e.activeTexture(e.TEXTURE0+n)}),Je(e,t,function(){return e.bindTexture(e.TEXTURE_2D,r)})}function Jde(e,t,r,n){return Dl(e,t,function(){return e.getUniformLocation(r,n)},'uniform "'+n+'" not present in program.')}function ehe(e,t,r){return e.getUniformLocation(t,r)}function the(e,t,r,n,a,i){Je(e,t,function(){return Zde(e,t,n,i)}),Je(e,t,function(){return e.uniform1i(a,i)})}function g2(e,t,r,n){Je(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),Je(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0)})}function HM(e,t,r){Je(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),Je(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function Ky(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+rhe(e,t))}function rhe(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function Dl(e,t,r,n){var a=Je(e,t,function(){return r()});if(a==null)throw new Error(n);return a}function nhe(e,t){var r=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=t+e.TEXTURE0;if(n<e.TEXTURE0||n>r)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+r+"]")+".")}function H0(e,t){return t===void 0&&(t=2),Qe(e.slice(0,e.length-t))}function K0(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function x2(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[H0(e)].concat(K0(e))),t}function ahe(e,t){var r;t===void 0&&(t=!1);var n=fe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,(e=e.map(function(u,d){return d>=e.length-2?NW(e[d]):e[d]})).length===1&&(e=[2,e[0]])),e.length!==2){var a=Vu(e);e=a.newShape}var i=Qe(e);if(e.length<=1&&i<=n)return[1,i];if(e.length===2&&e[0]<=n&&e[1]<=n)return e;if(e.length===3&&e[0]*e[1]<=n&&e[2]<=n)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=n&&e[1]*e[2]<=n)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=n&&e[3]<=n)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=n&&e[1]*e[2]*e[3]<=n)return[e[0],e[1]*e[2]*e[3]];if(t){var o=H0(e),l=2,c=2;return e.length&&(l=(r=K0(e))[0],c=r[1]),yE(i=o*(l/2)*(c/2)).map(function(u){return 2*u})}return yE(i)}function Yy(e){return e%2==0}function Xy(e,t){if(Gn(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var r=e.slice(-1)[0],n=t.slice(-1)[0];if(r===n||Yy(r)&&Yy(n)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&Yy(e[0])&&Yy(t[0])}function she(e){if(p2==null){var t=Uo(e);p2=t.getParameter(t.MAX_TEXTURE_SIZE)}return p2}function ihe(e){if(m2==null){var t=Uo(e);m2=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,m2)}function ohe(e){if(e===0)return 0;var t=Uo(e);return ti(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:ti(t,"EXT_disjoint_timer_query")?1:0}function ti(e,t){return e.getExtension(t)!=null}function KM(e){try{if(Uo(e)!=null)return!0}catch{return!1}return!1}function lhe(e){if(e===0)return!1;var t=Uo(e);if(e===1){if(!ti(t,"OES_texture_float"))return!1}else if(!ti(t,"EXT_color_buffer_float"))return!1;return CE(t)}function che(e){if(e===0)return!1;var t=Uo(e);if(e!==1){if(ti(t,"EXT_color_buffer_float"))return CE(t);if(ti(t,"EXT_color_buffer_half_float")){var r=t.getExtension("EXT_color_buffer_half_float");return function(n,a){var i=VT(n,a),o=n.createTexture();n.bindTexture(n.TEXTURE_2D,o),n.texImage2D(n.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var l=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,l),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,o,0);var c=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(o),n.deleteFramebuffer(l),c}(t,r)}return!1}return!!ti(t,"OES_texture_float")&&!!ti(t,"WEBGL_color_buffer_float")&&CE(t)}function CE(e){var t=VT(e),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(n),a}function uhe(e){return e===2&&Uo(e).fenceSync!=null}var ht=fe();function RW(e){fe().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Ve(e,t){return J.tidy(e,t)}function os(e){PW(e).forEach(function(t){return t.dispose()})}function dhe(e){return J.keep(e)}function Y0(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];fe().getBool("IS_TEST")||console.warn.apply(console,e)}function du(e,t){var r=e;if(Eo(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var n=[];Array.isArray(r)||Eo(r)&&t!=="string";)n.push(r.length),r=r[0];return Array.isArray(e)&&fe().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function a(i,o,l){if(l=l||[],!Array.isArray(i)&&!Eo(i))return void z(o.length===0,function(){return"Element arr["+l.join("][")+"] is a primitive, but should be an array/TypedArray of "+o[0]+" elements"});z(o.length>0,function(){return"Element arr["+l.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),z(i.length===o[0],function(){return"Element arr["+l.join("][")+"] should have "+o[0]+" elements, but has "+i.length+" elements"});for(var c=o.slice(1),u=0;u<i.length;++u)a(i[u],c,l.concat(u))}(e,n,[]),n}function YM(e,t,r,n){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+r+"' passed to '"+n+"' must be "+e+" tensor, but got "+t+" tensor")}function V(e,t,r,n){if(n===void 0&&(n="numeric"),e instanceof Ir)return YM(n,e.dtype,t,r),e;var a=Ax(e);if(a!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(a=n),YM(n,a,t,r),e==null||!Eo(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var i=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+r+"' must be a Tensor or TensorLike, but got '"+i+"'")}var o=du(e,a);Eo(e)||Array.isArray(e)||(e=[e]);var l=a!=="string"?SW(e,a,fe().getBool("DEBUG")):Jf(e,[],!0);return J.makeTensor(l,o,a)}function X0(e,t,r,n){if(n===void 0&&(n="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+r+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(a,i){return V(a,t+"["+i+"]",r)},n)}function OW(e,t){for(var r=0;r<e.length;++r)if(e[e.length-r-1]!==t-1-r)return!1;return!0}function hhe(e,t,r){for(var n=e.length+t.length,a=[],i=0,o=0,l=0;l<n;l++)r.indexOf(l)===-1?a.push(e[i++]):a.push(t[o++]);return a}function ma(e,t){for(var r=[],n=e.length,a=0;a<n;a++)t.indexOf(a)===-1&&r.push(e[a]);return[r,t.map(function(i){return e[i]})]}function ls(e,t){return hhe(e,t.map(function(r){return 1}),t)}function bs(e,t,r){z(OW(t,r),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+r+" input."})}function Vo(e,t){if(OW(e,t))return null;for(var r=[],n=0;n<t;++n)e.indexOf(n)===-1&&r.push(n);return e.forEach(function(a){return r.push(a)}),r}function zT(e){return e.map(function(t,r){return[r,t]}).sort(function(t,r){return t[1]-r[1]}).map(function(t){return t[0]})}function zo(e,t){for(var r=[],n=t-e;n<t;++n)r.push(n);return r}function fhe(e,t){var r=e[0].length;e.forEach(function(a,i){z(a.length===r,function(){return"Error in concat"+r+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+r+")"})}),z(t>=0&&t<r,function(){return"Error in concat"+r+"D: axis must be between 0 and "+(r-1)+"."});var n=e[0];e.forEach(function(a,i){for(var o=0;o<r;o++)z(o===t||a[o]===n[o],function(){return"Error in concat"+r+"D: Shape of tensors["+i+"] ("+a+") does not match the shape of the rest ("+n+") along the non-concatenated axis "+i+"."})})}function tp(e,t){for(var r=e[0].slice(),n=1;n<e.length;n++)r[t]+=e[n][t];return r}function Q(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var r=t[0],n=e[r];r.endsWith("_")&&(r=r.substring(0,r.length-1));var a=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];J.startScope(r);try{var l=n.apply(void 0,i);return l instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),J.endScope(l),l}catch(c){throw J.endScope(null),c}};return Object.defineProperty(a,"name",{value:r,configurable:!0}),a}ht.registerFlag("HAS_WEBGL",function(){return ht.getNumber("WEBGL_VERSION")>0}),ht.registerFlag("WEBGL_VERSION",function(){return KM(2)?2:KM(1)?1:0}),ht.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return ht.get("WEBGL_VERSION")===2}),ht.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),ht.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),ht.registerFlag("WEBGL_PACK",function(){return ht.getBool("HAS_WEBGL")}),ht.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return ht.getBool("WEBGL_PACK")}),ht.registerFlag("WEBGL_PACK_CLIP",function(){return ht.getBool("WEBGL_PACK")}),ht.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),ht.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return ht.getBool("WEBGL_PACK")}),ht.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return ht.getBool("WEBGL_PACK")}),ht.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return ht.getBool("WEBGL_PACK")}),ht.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return ht.getBool("WEBGL_PACK")}),ht.registerFlag("WEBGL_PACK_REDUCE",function(){return ht.getBool("WEBGL_PACK")}),ht.registerFlag("WEBGL_LAZILY_UNPACK",function(){return ht.getBool("WEBGL_PACK")}),ht.registerFlag("WEBGL_CONV_IM2COL",function(){return ht.getBool("WEBGL_PACK")}),ht.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return she(ht.getNumber("WEBGL_VERSION"))}),ht.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return ihe(ht.getNumber("WEBGL_VERSION"))}),ht.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=ht.getNumber("WEBGL_VERSION");return e===0?0:ohe(e)}),ht.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return ht.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),ht.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return lhe(ht.getNumber("WEBGL_VERSION"))}),ht.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!ht.getBool("WEBGL_FORCE_F16_TEXTURES")&&ht.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),ht.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return che(ht.getNumber("WEBGL_VERSION"))}),ht.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return uhe(ht.getNumber("WEBGL_VERSION"))}),ht.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return ht.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),AW=RW;var ea=Q({complex_:function(e,t){var r=V(e,"real","complex"),n=V(t,"imag","complex");return nr(r.shape,n.shape,"real and imag shapes, "+r.shape+" and "+n.shape+", must match in call to tf.complex()."),J.runKernelFunc(function(a){return a.complex(r,n)},{$real:r,$imag:n})}}),Zs=Q({real_:function(e){var t=V(e,"input","real");return J.runKernelFunc(function(r){return r.real(t)},{$input:t})}}),vo=Q({imag_:function(e){var t=V(e,"input","imag");return J.runKernelFunc(function(r){return r.imag(t)},{$input:t})}});function ra(e,t,r){return hu(e,t,du(e,r),r)}function hu(e,t,r,n){if(n==null&&(n=Ax(e)),n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Eo(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){EW(t);var a=Qe(t),i=Qe(r);z(a===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+a+" values but has "+i});for(var o=0;o<r.length;++o){var l=r[o],c=o!==r.length-1||l!==Qe(t.slice(o));z(r[o]===t[o]||!c,function(){return"Error creating a new Tensor. Inferred shape ("+r+") does not match the provided shape ("+t+"). "})}}return Eo(e)||Array.isArray(e)||(e=[e]),t=t||r,e=n!=="string"?SW(e,n,fe().getBool("DEBUG")):Jf(e,[],!0),J.makeTensor(e,t,n)}function Fe(e,t){if((Eo(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Eo(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return hu(e,[],[],t)}function dn(e,t){Zp(e);var r=du(e,t);if(r.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return hu(e,null,r,t)}function Vc(e,t,r){if(Zp(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var n=du(e,r);if(n.length!==2&&n.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return hu(e,t,n,r)}function WT(e,t,r){if(Zp(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var n=du(e,r);if(n.length!==3&&n.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return hu(e,t,n,r)}function es(e,t,r){if(Zp(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var n=du(e,r);if(n.length!==4&&n.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return hu(e,t,n,r)}function phe(e,t,r){if(Zp(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var n=du(e,r);if(n.length!==5&&n.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return hu(e,t,n,r)}function mhe(e,t,r){if(Zp(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var n=du(e,r);if(n.length!==6&&n.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return hu(e,t=t||n,n,r)}function vhe(e,t,r,n){return t===void 0&&(t=!0),J.makeVariable(e,t,r,n)}function Jp(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var r=Jp(e,"float32"),n=_r(e,"float32");return ea(r,n)}var a=CW(Qe(e),t);return J.makeTensor(a,e,t)}function _r(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var r=_r(e,"float32"),n=_r(e,"float32");return ea(r,n)}var a=Px(Qe(e),t);return J.makeTensor(a,e,t)}function Ao(e,t,r){return J.runKernelFunc(function(n){return n.fill(e,t,r)},{})}function ghe(e,t,r){if(r<=0)throw new Error("The number of values should be positive.");return J.runKernelFunc(function(n){return n.linspace(e,t,r)},{})}function Q0(e,t,r,n){if(r===void 0&&(r=1),n===void 0&&(n="float32"),r===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&r<0||t<e&&r>1)return _r([0],n);var a=Px(Math.abs(Math.ceil((t-e)/r)),n);t<e&&r===1&&(r=-1),a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return dn(a,n)}var IW=Q({onesLike_:function(e){var t=V(e,"x","onesLike");if(t.dtype==="complex64"){var r=IW(Zs(t)),n=Xt(vo(t));return ea(r,n)}return J.runKernelFunc(function(a){return a.onesLike(t)},{$x:t},function(a,i){return{$x:function(){return Xt(a)}}})}}),Xt=Q({zerosLike_:function(e){var t=V(e,"x","zerosLike");return J.runKernelFunc(function(r){return r.zerosLike(t)},{$x:t},function(r,n){return{$x:function(){return Xt(r)}}})}}),Tn=Q({concat_:function(e,t){t===void 0&&(t=0),z(e.length>=1,function(){return"Pass at least one tensor to concat"});var r=X0(e,"tensors","concat");r[0].dtype==="complex64"&&r.forEach(function(l){if(l.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+l.dtype+". ")}),t=$n(t,r[0].shape)[0];var n=tp(r.map(function(l){return l.shape}),t);if(Qe(n)===0)return ra([],n);if((r=r.filter(function(l){return l.size>0})).length===1)return r[0];var a=r.map(function(l){return l.shape});fhe(a,t);var i=r,o={axis:t};return J.runKernelFunc(function(l){return l.concat(r,t)},i,function(l){var c=a.map(function(u){return u[t]});return qT(l,c,t).map(function(u){return function(){return u}})},"Concat",o)}}),xhe=Q({concat1d_:function(e){return Tn(e,0)}}),yhe=Q({concat2d_:function(e,t){return Tn(e,t)}}),bhe=Q({concat3d_:function(e,t){return Tn(e,t)}}),whe=Q({concat4d_:function(e,t){return Tn(e,t)}}),qT=Q({split_:function(e,t,r){r===void 0&&(r=0);var n,a=V(e,"x","split");return r=$n(r,a.shape)[0],typeof t=="number"?(z(a.shape[r]%t==0,function(){return"Number of splits must evenly divide the axis."}),n=new Array(t).fill(a.shape[r]/t)):(z(a.shape[r]===t.reduce(function(i,o){return i+o}),function(){return"The sum of sizes must match the size of the axis dimension."}),n=t),J.runKernelFunc(function(i){return i.split(a,n,r)},{$x:a},function(i){return{$x:function(){return Tn(i,r)}}})}});function Jd(e,t){return e(t={exports:{}},t.exports),t.exports}var jhe=Jd(function(e){(function(t,r,n){function a(l){var c,u=this,d=(c=4022871197,function(h){h=h.toString();for(var f=0;f<h.length;f++){var p=.02519603282416938*(c+=h.charCodeAt(f));p-=c=p>>>0,c=(p*=c)>>>0,c+=4294967296*(p-=c)}return 23283064365386963e-26*(c>>>0)});u.next=function(){var h=2091639*u.s0+23283064365386963e-26*u.c;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=0|h)},u.c=1,u.s0=d(" "),u.s1=d(" "),u.s2=d(" "),u.s0-=d(l),u.s0<0&&(u.s0+=1),u.s1-=d(l),u.s1<0&&(u.s1+=1),u.s2-=d(l),u.s2<0&&(u.s2+=1),d=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var u=new a(l),d=c&&c.state,h=u.next;return h.int32=function(){return 4294967296*u.next()|0},h.double=function(){return h()+11102230246251565e-32*(2097152*h()|0)},h.quick=h,d&&(typeof d=="object"&&i(d,u),h.state=function(){return i(u,{})}),h}r&&r.exports?r.exports=o:this.alea=o})(0,e)}),Nhe=Jd(function(e){(function(t,r,n){function a(l){var c=this,u="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var h=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^h^h>>>8},l===(0|l)?c.x=l:u+=l;for(var d=0;d<u.length+64;d++)c.x^=0|u.charCodeAt(d),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c}function o(l,c){var u=new a(l),d=c&&c.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(f===0);return f},h.int32=u.next,h.quick=h,d&&(typeof d=="object"&&i(d,u),h.state=function(){return i(u,{})}),h}r&&r.exports?r.exports=o:this.xor128=o})(0,e)}),_he=Jd(function(e){(function(t,r,n){function a(l){var c=this,u="";c.next=function(){var h=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^h^h<<1)|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,l===(0|l)?c.x=l:u+=l;for(var d=0;d<u.length+64;d++)c.x^=0|u.charCodeAt(d),d==u.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c.v=l.v,c.d=l.d,c}function o(l,c){var u=new a(l),d=c&&c.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(f===0);return f},h.int32=u.next,h.quick=h,d&&(typeof d=="object"&&i(d,u),h.state=function(){return i(u,{})}),h}r&&r.exports?r.exports=o:this.xorwow=o})(0,e)}),She=Jd(function(e){(function(t,r,n){function a(l){var c=this;c.next=function(){var u,d,h=c.x,f=c.i;return u=h[f],d=(u^=u>>>7)^u<<24,d^=(u=h[f+1&7])^u>>>10,d^=(u=h[f+3&7])^u>>>3,d^=(u=h[f+4&7])^u<<7,u=h[f+7&7],d^=(u^=u<<13)^u<<9,h[f]=d,c.i=f+1&7,d},function(u,d){var h,f=[];if(d===(0|d))f[0]=d;else for(d=""+d,h=0;h<d.length;++h)f[7&h]=f[7&h]<<15^d.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],u.x=f,u.i=0,h=256;h>0;--h)u.next()}(c,l)}function i(l,c){return c.x=l.x.slice(),c.i=l.i,c}function o(l,c){l==null&&(l=+new Date);var u=new a(l),d=c&&c.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(f===0);return f},h.int32=u.next,h.quick=h,d&&(d.x&&i(d,u),h.state=function(){return i(u,{})}),h}r&&r.exports?r.exports=o:this.xorshift7=o})(0,e)}),Che=Jd(function(e){(function(t,r,n){function a(l){var c=this;c.next=function(){var u,d,h=c.w,f=c.X,p=c.i;return c.w=h=h+1640531527|0,d=f[p+34&127],u=f[p=p+1&127],d^=d<<13,u^=u<<17,d^=d>>>15,u^=u>>>12,d=f[p]=d^u,c.i=p,d+(h^h>>>16)|0},function(u,d){var h,f,p,m,v,g=[],x=128;for(d===(0|d)?(f=d,d=null):(d+="\0",f=0,x=Math.max(x,d.length)),p=0,m=-32;m<x;++m)d&&(f^=d.charCodeAt((m+32)%d.length)),m===0&&(v=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(v=v+1640531527|0,p=(h=g[127&m]^=f+v)==0?p+1:0);for(p>=128&&(g[127&(d&&d.length||0)]=-1),p=127,m=512;m>0;--m)f=g[p+34&127],h=g[p=p+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,g[p]=f^h;u.w=v,u.X=g,u.i=p}(c,l)}function i(l,c){return c.i=l.i,c.w=l.w,c.X=l.X.slice(),c}function o(l,c){l==null&&(l=+new Date);var u=new a(l),d=c&&c.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(f===0);return f},h.int32=u.next,h.quick=h,d&&(d.X&&i(d,u),h.state=function(){return i(u,{})}),h}r&&r.exports?r.exports=o:this.xor4096=o})(0,e)}),Ehe=Jd(function(e){(function(t,r,n){function a(l){var c=this,u="";c.next=function(){var h=c.b,f=c.c,p=c.d,m=c.a;return h=h<<25^h>>>7^f,f=f-p|0,p=p<<24^p>>>8^m,m=m-h|0,c.b=h=h<<20^h>>>12^f,c.c=f=f-p|0,c.d=p<<16^f>>>16^m,c.a=m-h|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,l===Math.floor(l)?(c.a=l/4294967296|0,c.b=0|l):u+=l;for(var d=0;d<u.length+20;d++)c.b^=0|u.charCodeAt(d),c.next()}function i(l,c){return c.a=l.a,c.b=l.b,c.c=l.c,c.d=l.d,c}function o(l,c){var u=new a(l),d=c&&c.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(f===0);return f},h.int32=u.next,h.quick=h,d&&(typeof d=="object"&&i(d,u),h.state=function(){return i(u,{})}),h}r&&r.exports?r.exports=o:this.tychei=o})(0,e)}),Du=Jd(function(e){(function(t,r){var n,a=this,i=256,o=6,l="random",c=r.pow(i,o),u=r.pow(2,52),d=2*u,h=i-1;function f(x,y,b){var N=[],j=v(function C(E,k){var P,A=[],O=typeof E;if(k&&O=="object")for(P in E)try{A.push(C(E[P],k-1))}catch{}return A.length?A:O=="string"?E:E+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[x,g(t)]:x??function(){try{var C;return n&&(C=n.randomBytes)?C=C(i):(C=new Uint8Array(i),(a.crypto||a.msCrypto).getRandomValues(C)),g(C)}catch{var E=a.navigator,k=E&&E.plugins;return[+new Date,a,k,a.screen,g(t)]}}(),3),N),_=new p(N),S=function(){for(var C=_.g(o),E=c,k=0;C<u;)C=(C+k)*i,E*=i,k=_.g(1);for(;C>=d;)C/=2,E/=2,k>>>=1;return(C+k)/E};return S.int32=function(){return 0|_.g(4)},S.quick=function(){return _.g(4)/4294967296},S.double=S,v(g(_.S),t),(y.pass||b||function(C,E,k,P){return P&&(P.S&&m(P,_),C.state=function(){return m(_,{})}),k?(r[l]=C,E):C})(S,j,"global"in y?y.global:this==r,y.state)}function p(x){var y,b=x.length,N=this,j=0,_=N.i=N.j=0,S=N.S=[];for(b||(x=[b++]);j<i;)S[j]=j++;for(j=0;j<i;j++)S[j]=S[_=h&_+x[j%b]+(y=S[j])],S[_]=y;(N.g=function(C){for(var E,k=0,P=N.i,A=N.j,O=N.S;C--;)E=O[P=h&P+1],k=k*i+O[h&(O[P]=O[A=h&A+E])+(O[A]=E)];return N.i=P,N.j=A,k})(i)}function m(x,y){return y.i=x.i,y.j=x.j,y.S=x.S.slice(),y}function v(x,y){for(var b,N=x+"",j=0;j<N.length;)y[h&j]=h&(b^=19*y[h&j])+N.charCodeAt(j++);return g(y)}function g(x){return String.fromCharCode.apply(0,x)}if(r["seed"+l]=f,v(r.random(),t),e.exports){e.exports=f;try{n=require("crypto")}catch{}}})([],Math)});Du.alea=jhe,Du.xor128=Nhe,Du.xorwow=_he,Du.xorshift7=She,Du.xor4096=Che,Du.tychei=Ehe;var Cj=Du.alea,GT=function(){function e(t,r,n,a,i){this.mean=t,this.stdDev=r,this.dtype=n,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=Cj(o.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var r,n,a=!1;!a;){var i=void 0,o=void 0,l=void 0;do l=(i=2*this.random()-1)*i+(o=2*this.random()-1)*o;while(l>=1||l===0);var c=Math.sqrt(-2*Math.log(l)/l);r=this.mean+this.stdDev*i*c,n=this.mean+this.stdDev*o*c,this.truncated&&!this.isValidTruncated(r)||(a=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(r)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),khe=function(){function e(t,r,n,a){this.alpha=t,this.beta=1/r,this.dtype=n;var i=a||Math.random();this.randu=Cj(i.toString()),this.randn=new GT(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,r,n,a,i,o;;){do a=this.randn.nextValue(),o=1+this.c*a;while(o<=0);if(o*=o*o,r=1-.331*(t=a*a)*t,n=.5*t+this.d*(1-o+Math.log(o)),(i=this.randu())<r||Math.log(i)<n)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),Ahe=function(){function e(t,r,n,a){var i=this;if(t===void 0&&(t=0),r===void 0&&(r=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=r-t,this.dtype=n,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+r+" <= 1 and dtype is not float");this.random=Cj(a)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function yt(e,t,r){return t===void 0&&(t="float32"),t=t||"float32",EW(e),new yg(e,t,r)}function Phe(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var DW=Q({batchToSpaceND_:function(e,t,r){var n=V(e,"x","batchToSpaceND"),a=t.reduce(function(i,o){return i*o});return z(n.rank>=1+t.length,function(){return"input rank is "+n.rank+" but should be > than blockShape.length "+t.length}),z(r.length===t.length,function(){return"crops.length is "+r.length+" but should be equal to blockShape.length  "+t.length}),z(n.shape[0]%a==0,function(){return"input tensor batch is "+n.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+a}),J.runKernelFunc(function(i){return i.batchToSpaceND(n,t,r)},{$x:n},function(i){return{$x:function(){return i.spaceToBatchND(t,r)}}})}}),The=Q({broadcastTo_:function(e,t){var r=V(e,"broadcastTo","x"),n=r.shape;if(t.some(function(c){return!(c>0)||c%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<r.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+r.rank+".");if(t.length>r.rank){for(var a=r.shape.slice();a.length<t.length;)a.unshift(1);r=r.reshape(a)}for(var i=Array.from(t),o=t.length-1;o>=0;o--)if(r.shape[o]===t[o])i[o]=1;else if(r.shape[o]!==1)throw new Error("broadcastTo(): ["+n+"] cannot be broadcast to ["+t+"].");var l=i.map(function(c,u){return c>1?u:-1}).filter(function(c){return c>=0});return l.length===0?r.clone():J.runKernelFunc(function(c){return c.tile(r,i)},{input:r},function(c){return{input:function(){return c.sum(l,!0)}}})}}),Rhe=Q({cast_:function(e,t){var r=V(e,"x","cast");if(!_de(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&r.dtype!=="string"||t!=="string"&&r.dtype==="string")throw new Error("Only strings can be casted to strings");var n={dtype:t};return J.runKernelFunc(function(a){return a.cast(r,t)},{x:r},function(a){return{x:function(){return a.clone()}}},"Cast",n)}}),Ohe=Q({clone_:function(e){var t=V(e,"x","clone",null);return J.runKernelFunc(function(){return J.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(r){return{$x:function(){return r.toFloat()}}})}}),Ihe=Q({cumsum_:function(e,t,r,n){t===void 0&&(t=0),r===void 0&&(r=!1),n===void 0&&(n=!1);var a=V(e,"x","cumsum"),i=Vo([t|=0],a.rank),o=a;i!=null&&(o=a.transpose(i));var l=zo(1,a.rank)[0],c=J.runKernelFunc(function(u){return u.cumsum(o,l,r,n)},{permutedX:o},function(u){return{permutedX:function(){return u.cumsum(t,r,!n)}}});return i!=null&&(c=c.transpose(i)),c}}),Dhe=Q({depthToSpace_:function(e,t,r){r===void 0&&(r="NHWC");var n=V(e,"x","depthToSpace"),a=r==="NHWC"?n.shape[1]:n.shape[2],i=r==="NHWC"?n.shape[2]:n.shape[3],o=r==="NHWC"?n.shape[3]:n.shape[1];return z(a*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+`  for depthToSpace with input shape
      `+n.shape}),z(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+n.shape}),z(o%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+o+" for depthToSpace with input shape "+n.shape}),J.runKernelFunc(function(l){return l.depthToSpace(n,t,r)},{$x:n})}}),Qs=Q({expandDims_:function(e,t){t===void 0&&(t=0);var r=V(e,"x","expandDims",null);z(t<=r.rank,function(){return"Axis must be <= rank of the tensor"});var n=r.shape.slice();return t<0&&(z(-(r.rank+1)<=t,function(){return"Axis must be in the interval ["+-(r.rank+1)+", "+r.rank+"]"}),t=r.rank+t+1),n.splice(t,0,1),Mi(r,n)}}),MW=Q({eye_:function(e,t,r,n){n===void 0&&(n="float32"),t==null&&(t=e);for(var a=yt([e,t],n),i=e<=t?e:t,o=0;o<i;++o)a.set(1,o,o);var l=a.toTensor().as2D(e,t);if(r==null)return l;if(r.length===1)return vf(Qs(l,0),[r[0],1,1]);if(r.length===2)return vf(Qs(Qs(l,0),0),[r[0],r[1],1,1]);if(r.length===3)return vf(Qs(Qs(Qs(l,0),0),0),[r[0],r[1],r[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+r.length+"D.")}}),Mhe=Q({multinomial_:function(e,t,r,n){n===void 0&&(n=!1);var a=V(e,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);r=r||Math.random();var l=o===1?a.as2D(1,-1):a,c=J.runKernelFunc(function(u){return u.multinomial(l,n,t,r)},{logits2D:l});return o===1?c.as1D():c}}),EE=Q({oneHot_:function(e,t,r,n){if(r===void 0&&(r=1),n===void 0&&(n=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var a=V(e,"indices","oneHot","int32"),i=a.shape.concat([t]);return a=a.flatten(),J.runKernelFunc(function(o){return o.oneHot(a,t,r,n)},{$indices:a},function(o){return{$indices:function(){return _r(a.shape,"float32")}}}).reshape(i)}}),eh=Q({pad_:function(e,t,r){r===void 0&&(r=0);var n=V(e,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:r};return J.runKernelFunc(function(i){return i.pad(n,t,r)},{x:n},function(i){var o=t.map(function(l){return l[0]});return{x:function(){return i.slice(o,n.shape)}}},"PadV2",a)}}),$he=Q({pad1d_:function(e,t,r){return r===void 0&&(r=0),z(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),eh(e,[t],r)}}),Fhe=Q({pad2d_:function(e,t,r){return r===void 0&&(r=0),z(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),eh(e,t,r)}}),Lhe=Q({pad3d_:function(e,t,r){return r===void 0&&(r=0),z(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),eh(e,t,r)}}),Bhe=Q({pad4d_:function(e,t,r){return r===void 0&&(r=0),z(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),eh(e,t,r)}}),Uhe=Q({rand_:function(e,t,r){var n=Qe(e),a=null;if(r==null||r==="float32")a=new Float32Array(n);else if(r==="int32")a=new Int32Array(n);else{if(r!=="bool")throw new Error("Unknown data type "+r);a=new Uint8Array(n)}for(var i=0;i<n;i++)a[i]=t();return J.makeTensor(a,e,r)}}),Vhe=Q({randomNormal_:function(e,t,r,n,a){if(t===void 0&&(t=0),r===void 0&&(r=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var i=new GT(t,r,n,!1,a),o=yt(e,n),l=0;l<o.values.length;l++)o.values[l]=i.nextValue();return o.toTensor()}}),zhe=Q({randomGamma_:function(e,t,r,n,a){if(r===void 0&&(r=1),n===void 0&&(n="float32"),r==null&&(r=1),n==null&&(n="float32"),n!=="float32"&&n!=="int32")throw new Error("Unsupported data type "+n);for(var i=new khe(t,r,n,a),o=yt(e,n),l=0;l<o.values.length;l++)o.values[l]=i.nextValue();return o.toTensor()}}),$W=Q({randomUniform_:function(e,t,r,n,a){t===void 0&&(t=0),r===void 0&&(r=1),n===void 0&&(n="float32");for(var i=yt(e,n),o=new Ahe(t,r,null,a),l=0;l<i.values.length;l++)i.values[l]=o.nextValue();return i.toTensor()}}),Mi=Q({reshape_:function(e,t){var r=V(e,"x","reshape",null);t=jde(t,r.size),z(r.size===Qe(t),function(){return"new shape and old shape must have the same number of elements."});var n={shape:t};return J.runKernelFunc(function(a){return a.reshape(r,t)},{x:r},function(a){return{x:function(){return a.reshape(r.shape)}}},"Reshape",n)}}),FW=Q({spaceToBatchND_:function(e,t,r){var n=V(e,"x","spaceToBatchND");return z(n.rank>=1+t.length,function(){return"input rank "+n.rank+" should be > than [blockShape] "+t.length}),z(r.length===t.length,function(){return"paddings.shape[0] "+r.length+" must be equal to [blockShape] "+t.length}),z(n.shape.reduce(function(a,i,o){return o>0&&o<=t.length?a&&(i+r[o-1][0]+r[o-1][1])%t[o-1]==0:a},!0),function(){return"input spatial dimensions "+n.shape.slice(1)+" with paddings "+r.toString()+" must be divisible by blockShapes "+t.toString()}),J.runKernelFunc(function(a){return a.spaceToBatchND(n,t,r)},{$x:n},function(a){return{$x:function(){return a.batchToSpaceND(t,r)}}})}}),LW=Q({squeeze_:function(e,t){var r=V(e,"x","squeeze");return Mi(r,Vu(r.shape,t).newShape)}}),Is=Q({stack_:function(e,t){t===void 0&&(t=0);var r=X0(e,"tensors","stack");if(z(r.length>=1,function(){return"Pass at least one tensor to tf.stack"}),r.length===1)return r[0].expandDims(t);var n=r[0].rank,a=r[0].shape,i=r[0].dtype;z(t<=n,function(){return"Axis must be <= rank of the tensor"}),r.forEach(function(l){nr(a,l.shape,"All tensors passed to stack must have matching shapes")}),r.forEach(function(l){z(i===l.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var o=r.map(function(l){return l.expandDims(t)});return Tn(o,t)}}),vf=Q({tile_:function(e,t){var r=V(e,"x","tile",null);z(r.rank===t.length,function(){return"Error in transpose: rank of input "+r.rank+" must match length of reps "+t+"."});var n=[r],a={reps:t};return J.runKernelFunc(function(i,o){var l=i.tile(r,t);return o([r]),l},{x:r},function(i,o){var l=o[0];return{x:function(){var c=Xt(l);if(l.rank===1)for(var u=0;u<t[0];++u)c=c.add(i.slice([u*l.shape[0]],[l.shape[0]]));else if(l.rank===2)for(u=0;u<t[0];++u)for(var d=0;d<t[1];++d)c=c.add(i.slice([u*l.shape[0],d*l.shape[1]],[l.shape[0],l.shape[1]]));else if(l.rank===3)for(u=0;u<t[0];++u)for(d=0;d<t[1];++d)for(var h=0;h<t[2];++h)c=c.add(i.slice([u*l.shape[0],d*l.shape[1],h*l.shape[2]],[l.shape[0],l.shape[1],l.shape[2]]));else{if(l.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+l.rank+" tensors yet.");for(u=0;u<t[0];++u)for(d=0;d<t[1];++d)for(h=0;h<t[2];++h)for(var f=0;f<t[3];++f)c=c.add(i.slice([u*l.shape[0],d*l.shape[1],h*l.shape[2],f*l.shape[3]],[l.shape[0],l.shape[1],l.shape[2],l.shape[3]]))}return c}}},"Tile",a,n)}}),Whe=Q({truncatedNormal_:function(e,t,r,n,a){if(t===void 0&&(t=0),r===void 0&&(r=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var i=new GT(t,r,n,!0,a),o=yt(e,n),l=0;l<o.values.length;l++)o.values[l]=i.nextValue();return o.toTensor()}}),Rn=Q({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var r=V(e,"x","unstack");z(t>=-r.shape.length&&t<r.shape.length,function(){return"Axis = "+t+" is not in [-"+r.shape.length+", "+r.shape.length+")"}),t<0&&(t+=r.shape.length);var n={axis:t};return J.runKernelFunc(function(a){return a.unstack(r,t)},{x:r},function(a){return{x:function(){return Is(a,t)}}},"Unpack",n)}}),qhe=function(e,t){return Ye(this,void 0,void 0,function(){var r,n,a,i,o,l,c,u,d,h;return Xe(this,function(f){switch(f.label){case 0:return r=V(e,"x","setdiff1d"),n=V(t,"y","setdiff1d"),z(r.dtype===n.dtype,function(){return"x and y should have the same dtype, but got x ("+r.dtype+") and y ("+n.dtype+")."}),z(r.rank===1,function(){return"x should be 1D tensor, but got x ("+r.shape+")."}),z(n.rank===1,function(){return"y should be 1D tensor, but got y ("+n.shape+")."}),[4,r.data()];case 1:return a=f.sent(),[4,n.data()];case 2:for(i=f.sent(),o=new Set(i),l=0,d=0;d<a.length;d++)o.has(a[d])||l++;for(c=new yg([l],r.dtype),u=new yg([l],"int32"),d=0,h=0;d<a.length;d++)o.has(a[d])||(c.values[h]=a[d],u.values[h]=d,h++);return[2,[c.toTensor(),u.toTensor()]]}})})};function Z0(e,t,r,n){n===void 0&&(n=!0);var a=[];if(n)(a=a.concat(t.slice(0))).push(e[0]/r),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var i=t.length,o=0;o<i;++o)a=a.concat([e[o+1]/t[o],t[o]]);a=a.concat(e.slice(i+1))}return a}function J0(e,t,r){r===void 0&&(r=!0);var n=[];if(r){n.push(t);for(var a=t+1;a<e;++a)a<=2*t?(n.push(a),n.push(a-(t+1))):n.push(a)}else{var i=[],o=[];for(a=1;a<e;++a)a>=2*t+1||a%2==1?o.push(a):i.push(a);n.push.apply(n,i),n.push(0),n.push.apply(n,o)}return n}function ew(e,t,r,n){n===void 0&&(n=!0);var a=[];n?a.push(e[0]/r):a.push(e[0]*r);for(var i=1;i<e.length;++i)i<=t.length?n?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function BW(e,t){for(var r=[0],n=0;n<t;++n)r.push(e[n][0]);return r}function UW(e,t,r){for(var n=e.slice(0,1),a=0;a<r;++a)n.push(e[a+1]-t[a][0]-t[a][1]);return n}function VW(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var r=t.shape,n=r[r.length-1],a=1,i=0;i<r.length-1;++i)a*=r[i];var o=e.shape,l=r.slice();l.pop();var c=1;for(i=n;i<e.rank;++i)c*=o[i],l.push(o[i]);var u=ko(e.shape).map(function(d){return d/c}).concat([1]).slice(0,n);return[l,a,c,u]}var zW=30;function y2(e){return e<=zW?e:wE(e,Math.floor(Math.sqrt(e)))}function Ghe(e,t,r){var n=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+r.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+n+", and batchDim: "+a+".";if(r.rank<a)throw new Error(i+" update.rank < "+a+". ");if(e.length<n+(r.rank-a))throw new Error(i+" Output shape length < "+(n+(r.rank-a)));if(r.rank!==a+e.length-n)throw new Error(i+" update.rank != "+(a+e.length-n));for(var o=0;o<a;++o)if(r.shape[o]!==t.shape[o])throw new Error(i+" updates.shape["+o+"] ("+r.shape[o]+") != indices.shape["+o+"] ("+t.shape[o]+").");for(o=0;o<r.rank-a;++o)if(r.shape[o+a]!==e[o+n])throw new Error(i+" updates.shape["+(o+a)+"] ("+r.shape[o+a]+") != shape["+(o+a)+"] ("+e[o+a]+")")}function Hhe(e,t,r){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(r.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+r);if(r.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}Ghe(r,t,e)}function tw(e,t,r){for(var n=t.shape.length,a=n>1?t.shape[n-1]:1,i=r.length,o=1,l=a;l<i;++l)o*=r[l];var c=a<1?1:a;return{sliceRank:a,numUpdates:Qe(t.shape)/c,sliceSize:o,strides:ko(r.slice(0,a)).concat([1]),outputSize:Qe(r)}}function Khe(e,t,r){z(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),z(e.rank===r.length,function(){return"Error in slice"+e.rank+"D: Length of size "+r+" must match the rank of the array ("+e.rank+")."});for(var n=function(i){z(t[i]+r[i]<=e.shape[i],function(){return"Error in slice"+e.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+r[i])+") would overflow input.shape["+i+"] ("+e.shape[i]+")"})},a=0;a<e.rank;++a)n(a)}function XM(e){for(var t=[],r=0;e>0;)1&e&&t.push(r),e/=2,r++;return t}function HT(e,t,r){for(var n=[],a=0;a<e.length;a++)n[a]=Math.ceil((t[a]-e[a])/r[a]);return n}function Yhe(e,t,r,n,a){var i=t[a],o=r[a]||1;(e&1<<a||i==null)&&(i=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var l=n[a];return i<0&&(i+=l),i=xE(0,i,l-1)}function Xhe(e,t,r,n,a){var i=t[a],o=r[a]||1;(e&1<<a||i==null)&&(i=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var l=n[a];return i<0&&(i+=l),i=o>0?xE(0,i,l):xE(-1,i,l-1)}function WW(e,t,r){for(var n=r.length,a=0;a<r.length;a++)if(r[a]>1){n=a;break}for(a=n+1;a<r.length;a++)if(t[a]>0||r[a]!==e[a])return!1;return!0}function qW(e,t){for(var r=e.length>0?e[e.length-1]:1,n=0;n<e.length-1;n++)r+=e[n]*t[n];return r}function Qhe(e,t){z(bE(e),function(){return"The f passed in variableGrads(f) must be a function"}),z(t==null||Array.isArray(t)&&t.every(function(d){return d instanceof ep}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var r=t!=null;if(!r)for(var n in t=[],J.registeredVariables)t.push(J.registeredVariables[n]);var a=r?t.filter(function(d){return!d.trainable}):null,i=t.length;z((t=t.filter(function(d){return d.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var o=J.gradients(e,t,null,!0),l=o.value,c=o.grads;z(c.some(function(d){return d!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),z(l.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+l.rank+" tensor"});var u={};return t.forEach(function(d,h){c[h]!=null&&(u[d.name]=c[h])}),a!=null&&a.forEach(function(d){return u[d.name]=null}),{value:l,grads:u}}function Ej(e){return J.customGrad(e)}var Ml=Q({softmax_:function(e,t){t===void 0&&(t=-1);var r=V(e,"logits","softmax","float32");if(t===-1&&(t=r.rank-1),t!==r.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+r.rank+" and dim was "+t);return J.runKernelFunc(function(n,a){var i=n.softmax(r,t);return a([i]),i},{logits:r},function(n,a){var i=a[0],o=n.mul(i);return{logits:function(){return o.sub(o.sum([t],!0).mul(i))}}},"Softmax",{dim:t},[],[!0])}}),Zhe=Q({logSoftmax_:function(e,t){t===void 0&&(t=-1);var r=V(e,"logits","logSoftmax");if(t===-1&&(t=r.rank-1),t!==r.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+r.rank+" and axis was "+t);return Ej(function(n,a){var i=n.max(t,!0),o=n.sub(i),l=o.toFloat().sub(o.exp().sum(t,!0).log());return a([l]),{value:l,gradFunc:function(c,u){var d=u[0].exp();return c.sub(c.sum(t,!0).mul(d))}}})(r)}}),GW=function(){function e(t,r){this.backend=t,this.dataMover=r,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,r){this.dataIdsCount++,this.data.set(t,r)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),HW=function(){function e(){}return e.prototype.time=function(t){return oe("time")},e.prototype.read=function(t){return oe("read")},e.prototype.readSync=function(t){return oe("readSync")},e.prototype.numDataIds=function(){return oe("numDataIds")},e.prototype.disposeData=function(t){return oe("disposeData")},e.prototype.write=function(t,r,n){return oe("write")},e.prototype.move=function(t,r,n,a){return oe("move")},e.prototype.memory=function(){return oe("memory")},e.prototype.floatPrecision=function(){return oe("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,r,n,a){return oe("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,oe("fusedBatchMatMul")},e.prototype.slice=function(t,r,n){return oe("slice")},e.prototype.stridedSlice=function(t,r,n,a){return oe("stridedSlice")},e.prototype.unstack=function(t,r){return oe("unstack")},e.prototype.reverse=function(t,r){return oe("reverse")},e.prototype.concat=function(t,r){return oe("concat")},e.prototype.neg=function(t){return oe("neg")},e.prototype.add=function(t,r){return oe("add")},e.prototype.addN=function(t){return oe("addN")},e.prototype.subtract=function(t,r){return oe("subtract")},e.prototype.multiply=function(t,r){return oe("multiply")},e.prototype.realDivide=function(t,r){return oe("realDivide")},e.prototype.floorDiv=function(t,r){return oe("floorDiv")},e.prototype.sum=function(t,r){return oe("sum")},e.prototype.prod=function(t,r){return oe("prod")},e.prototype.unsortedSegmentSum=function(t,r,n){return oe("unsortedSegmentSum")},e.prototype.argMin=function(t,r){return oe("argMin")},e.prototype.argMax=function(t,r){return oe("argMax")},e.prototype.equal=function(t,r){return oe("equal")},e.prototype.notEqual=function(t,r){return oe("notEqual")},e.prototype.less=function(t,r){return oe("less")},e.prototype.lessEqual=function(t,r){return oe("lessEqual")},e.prototype.greater=function(t,r){return oe("greater")},e.prototype.greaterEqual=function(t,r){return oe("greaterEqual")},e.prototype.logicalNot=function(t){return oe("logicalNot")},e.prototype.logicalAnd=function(t,r){return oe("logicalAnd")},e.prototype.logicalOr=function(t,r){return oe("logicalOr")},e.prototype.where=function(t){return oe("where")},e.prototype.select=function(t,r,n){return oe("select")},e.prototype.topk=function(t,r,n){return oe("topk")},e.prototype.min=function(t,r){return oe("min")},e.prototype.minimum=function(t,r){return oe("minimum")},e.prototype.mod=function(t,r){return oe("mod")},e.prototype.max=function(t,r){return oe("max")},e.prototype.maximum=function(t,r){return oe("maximum")},e.prototype.all=function(t,r){return oe("all")},e.prototype.any=function(t,r){return oe("any")},e.prototype.squaredDifference=function(t,r){return oe("squaredDifference")},e.prototype.ceil=function(t){return oe("ceil")},e.prototype.floor=function(t){return oe("floor")},e.prototype.round=function(t){return oe("round")},e.prototype.sign=function(t){return oe("sign")},e.prototype.isNaN=function(t){return oe("isNaN")},e.prototype.isInf=function(t){return oe("isInf")},e.prototype.isFinite=function(t){return oe("isFinite")},e.prototype.pow=function(t,r){return oe("pow")},e.prototype.exp=function(t){return oe("exp")},e.prototype.expm1=function(t){return oe("expm1")},e.prototype.softmax=function(t,r){return oe("softmax")},e.prototype.log=function(t){return oe("log")},e.prototype.log1p=function(t){return oe("log1p")},e.prototype.sqrt=function(t){return oe("sqrt")},e.prototype.rsqrt=function(t){return oe("rsqrt")},e.prototype.square=function(t){return oe("square")},e.prototype.reciprocal=function(t){return oe("reciprocal")},e.prototype.relu=function(t){return oe("relu")},e.prototype.relu6=function(t){return oe("relu6")},e.prototype.prelu=function(t,r){return oe("prelu")},e.prototype.elu=function(t){return oe("elu")},e.prototype.eluDer=function(t,r){return oe("eluDer")},e.prototype.selu=function(t){return oe("selu")},e.prototype.int=function(t){return oe("int")},e.prototype.clip=function(t,r,n){return oe("clip")},e.prototype.abs=function(t){return oe("abs")},e.prototype.complexAbs=function(t){return oe("complexAbs")},e.prototype.sigmoid=function(t){return oe("sigmoid")},e.prototype.softplus=function(t){return oe("softplus")},e.prototype.sin=function(t){return oe("sin")},e.prototype.cos=function(t){return oe("cos")},e.prototype.tan=function(t){return oe("tan")},e.prototype.asin=function(t){return oe("asin")},e.prototype.acos=function(t){return oe("acos")},e.prototype.atan=function(t){return oe("atan")},e.prototype.atan2=function(t,r){return oe("atan2")},e.prototype.sinh=function(t){return oe("sinh")},e.prototype.cosh=function(t){return oe("cosh")},e.prototype.tanh=function(t){return oe("tanh")},e.prototype.asinh=function(t){return oe("asinh")},e.prototype.acosh=function(t){return oe("acosh")},e.prototype.atanh=function(t){return oe("atanh")},e.prototype.erf=function(t){return oe("erf")},e.prototype.step=function(t,r){return oe("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,oe("fusedConv2d")},e.prototype.conv2d=function(t,r,n){return oe("conv2d")},e.prototype.conv2dDerInput=function(t,r,n){return oe("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,r,n){return oe("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,oe("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,r,n){return oe("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,r,n){return oe("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,r,n){return oe("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,r,n){return oe("conv3d")},e.prototype.conv3dDerInput=function(t,r,n){return oe("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,r,n){return oe("conv3dDerFilter")},e.prototype.maxPool=function(t,r){return oe("maxPool")},e.prototype.maxPoolBackprop=function(t,r,n,a){return oe("maxPoolBackprop")},e.prototype.avgPool=function(t,r){return oe("avgPool")},e.prototype.avgPoolBackprop=function(t,r,n){return oe("avgPoolBackprop")},e.prototype.avgPool3d=function(t,r){return oe("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,r,n){return oe("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,r){return oe("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,r,n,a){return oe("maxPool3dBackprop")},e.prototype.reshape=function(t,r){return oe("reshape")},e.prototype.cast=function(t,r){return oe("cast")},e.prototype.tile=function(t,r){return oe("tile")},e.prototype.pad=function(t,r,n){return oe("pad")},e.prototype.transpose=function(t,r){return oe("transpose")},e.prototype.gather=function(t,r,n){return oe("gather")},e.prototype.gatherND=function(t,r){return oe("gatherND")},e.prototype.scatterND=function(t,r,n){return oe("scatterND")},e.prototype.batchToSpaceND=function(t,r,n){return oe("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,r,n){return oe("spaceToBatchND")},e.prototype.resizeBilinear=function(t,r,n,a){return oe("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,r,n){return oe("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,r,n,a){return oe("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,r,n){return oe("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,r,n,a,i,o){return oe("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,r,n,a,i){return oe("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,r,n,a,i,o,l){return oe("LRNGrad")},e.prototype.multinomial=function(t,r,n,a){return oe("multinomial")},e.prototype.oneHot=function(t,r,n,a){return oe("oneHot")},e.prototype.cumsum=function(t,r,n,a){return oe("cumsum")},e.prototype.nonMaxSuppression=function(t,r,n,a,i){return oe("nonMaxSuppression")},e.prototype.fft=function(t){return oe("fft")},e.prototype.ifft=function(t){return oe("ifft")},e.prototype.complex=function(t,r){return oe("complex")},e.prototype.real=function(t){return oe("real")},e.prototype.imag=function(t){return oe("imag")},e.prototype.cropAndResize=function(t,r,n,a,i,o){return oe("cropAndResize")},e.prototype.depthToSpace=function(t,r,n){return oe("depthToSpace")},e.prototype.split=function(t,r,n){return oe("split")},e.prototype.sparseToDense=function(t,r,n,a){return oe("sparseToDense")},e.prototype.diag=function(t){return oe("diag")},e.prototype.fill=function(t,r,n){return oe("fill")},e.prototype.onesLike=function(t){return oe("onesLike")},e.prototype.zerosLike=function(t){return oe("zerosLike")},e.prototype.linspace=function(t,r,n){return oe("linspace")},e.prototype.dispose=function(){return oe("dispose")},e}();function oe(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function _c(e,t){for(var r=e.length,n=[],a=0;a<r;a++){var i=r-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&o===1&&n.unshift(i)}return n}function In(e,t){for(var r=[],n=0;n<t.length;n++){var a=e[e.length-n-1],i=t.length-n-1,o=t[i];(a==null||a===1&&o>1)&&r.unshift(i)}return r}function Vt(e,t){for(var r=[],n=Math.max(e.length,t.length),a=0;a<n;a++){var i=e[e.length-a-1];i==null&&(i=1);var o=t[t.length-a-1];if(o==null&&(o=1),i===1)r.unshift(o);else if(o===1)r.unshift(i);else{if(i!==o)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");r.unshift(i)}}return r}function wg(e,t,r,n,a,i,o){o===void 0&&(o="channelsLast");var l,c=aw(t),u=c[0],d=c[1];if(o==="channelsLast")l=[u,d,e[3],e[3]];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);l=[u,d,e[1],e[1]]}return th(e,l,r,n,a,i,!1,o)}function rw(e,t,r,n,a,i,o){o===void 0&&(o="NDHWC");var l,c,u=kE(t),d=u[0],h=u[1],f=u[2];if(o==="NDHWC")c="channelsLast",l=[d,h,f,e[4],e[4]];else{if(o!=="NCDHW")throw new Error("Unknown dataFormat "+o);c="channelsFirst",l=[d,h,f,e[1],e[1]]}return nw(e,l,r,n,a,!1,c,i)}function th(e,t,r,n,a,i,o,l){o===void 0&&(o=!1),l===void 0&&(l="channelsLast");var c=[-1,-1,-1,-1],u=c[0],d=c[1],h=c[2],f=c[3];if(l==="channelsLast")u=e[0],d=e[1],h=e[2],f=e[3];else{if(l!=="channelsFirst")throw new Error("Unknown dataFormat "+l);u=e[0],f=e[1],d=e[2],h=e[3]}var p,m=t[0],v=t[1],g=t[3],x=aw(r),y=x[0],b=x[1],N=aw(n),j=N[0],_=N[1],S=gf(m,j),C=gf(v,_),E=function(I,R,M,B,$,D,W,Z){var U,Y,ae;if(typeof I=="number"){U={top:I,bottom:I,left:I,right:I,type:I===0?"VALID":"NUMBER"};var ie=function(ve,K,ke,Ce,Ge){Ce==null&&(Ce=KW(ve,K,ke));var He=ve[0],It=ve[1],ar=Pv((He-K+2*Ce)/ke+1,Ge);z(rn(ar),function(){return"The output # of rows ("+ar+") must be an integer. Change the stride and/or zero pad parameters"});var Kt=Pv((It-K+2*Ce)/ke+1,Ge);return z(rn(Kt),function(){return"The output # of columns ("+Kt+") must be an integer. Change the stride and/or zero pad parameters"}),[ar,Kt]}([R,M],D,B,I,Z);Y=ie[0],ae=ie[1]}else if(I==="same"){Y=Math.ceil(R/B),ae=Math.ceil(M/$);var he=Math.max(0,(Y-1)*B+D-R),se=Math.max(0,(ae-1)*$+W-M),ye=Math.floor(he/2),ne=he-ye,le=Math.floor(se/2);U={top:ye,bottom:ne,left:le,right:se-le,type:"SAME"}}else{if(I!=="valid")throw Error("Unknown padding parameter: "+I);U={top:0,bottom:0,left:0,right:0,type:"VALID"},Y=Math.ceil((R-D+1)/B),ae=Math.ceil((M-W+1)/$)}return{padInfo:U,outHeight:Y,outWidth:ae}}(a,d,h,y,b,S,C,i),k=E.padInfo,P=E.outHeight,A=E.outWidth,O=o?g*f:g;return l==="channelsFirst"?p=[u,O,P,A]:l==="channelsLast"&&(p=[u,P,A,O]),{batchSize:u,dataFormat:l,inHeight:d,inWidth:h,inChannels:f,outHeight:P,outWidth:A,outChannels:O,padInfo:k,strideHeight:y,strideWidth:b,filterHeight:m,filterWidth:v,effectiveFilterHeight:S,effectiveFilterWidth:C,dilationHeight:j,dilationWidth:_,inShape:e,outShape:p,filterShape:t}}function nw(e,t,r,n,a,i,o,l){i===void 0&&(i=!1),o===void 0&&(o="channelsLast");var c=[-1,-1,-1,-1,-1],u=c[0],d=c[1],h=c[2],f=c[3],p=c[4];if(o==="channelsLast")u=e[0],d=e[1],h=e[2],f=e[3],p=e[4];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);u=e[0],p=e[1],d=e[2],h=e[3],f=e[4]}var m,v=t[0],g=t[1],x=t[2],y=t[4],b=kE(r),N=b[0],j=b[1],_=b[2],S=kE(n),C=S[0],E=S[1],k=S[2],P=gf(v,C),A=gf(g,E),O=gf(x,k),I=function(W,Z,U,Y,ae,ie,he,se,ye,ne,le){var ve,K,ke,Ce;if(typeof W=="number"){ve={top:W,bottom:W,left:W,right:W,front:W,back:W,type:W===0?"VALID":"NUMBER"};var Ge=function(Ae,je,Le,it,ft,kr){ft==null&&(ft=KW(Ae,je,it));var Ha=Ae[0],Qr=Ae[1],Ho=Ae[2],ps=Pv((Ha-je+2*ft)/it+1,kr);z(rn(ps),function(){return"The output # of depths ("+ps+") must be an integer. Change the stride and/or zero pad parameters"});var la=Pv((Qr-je+2*ft)/it+1,kr);z(rn(la),function(){return"The output # of rows ("+la+") must be an integer. Change the stride and/or zero pad parameters"});var Ls=Pv((Ho-je+2*ft)/it+1,kr);return z(rn(Ls),function(){return"The output # of columns ("+Ls+") must be an integer. Change the stride and/or zero pad parameters"}),[ps,la,Ls,Le]}([Z,U,Y,1],se,1,ae,W,le);K=Ge[0],ke=Ge[1],Ce=Ge[2]}else if(W==="same"){K=Math.ceil(Z/ae),ke=Math.ceil(U/ie),Ce=Math.ceil(Y/he);var He=(K-1)*ae+se-Z,It=(ke-1)*ie+ye-U,ar=(Ce-1)*he+ne-Y,Kt=Math.floor(He/2),G=He-Kt,te=Math.floor(It/2),ce=It-te,_e=Math.floor(ar/2);ve={top:te,bottom:ce,left:_e,right:ar-_e,front:Kt,back:G,type:"SAME"}}else{if(W!=="valid")throw Error("Unknown padding parameter: "+W);ve={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},K=Math.ceil((Z-se+1)/ae),ke=Math.ceil((U-ye+1)/ie),Ce=Math.ceil((Y-ne+1)/he)}return{padInfo:ve,outDepth:K,outHeight:ke,outWidth:Ce}}(a,d,h,f,N,j,_,P,A,O,l),R=I.padInfo,M=I.outDepth,B=I.outHeight,$=I.outWidth,D=i?y*p:y;return o==="channelsFirst"?m=[u,D,M,B,$]:o==="channelsLast"&&(m=[u,M,B,$,D]),{batchSize:u,dataFormat:o,inDepth:d,inHeight:h,inWidth:f,inChannels:p,outDepth:M,outHeight:B,outWidth:$,outChannels:D,padInfo:R,strideDepth:N,strideHeight:j,strideWidth:_,filterDepth:v,filterHeight:g,filterWidth:x,effectiveFilterDepth:P,effectiveFilterHeight:A,effectiveFilterWidth:O,dilationDepth:C,dilationHeight:E,dilationWidth:k,inShape:e,outShape:m,filterShape:t}}function KW(e,t,r,n){n===void 0&&(n=1);var a=gf(t,n);return Math.floor((e[0]*(r-1)-r+a)/2)}function aw(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function kE(e){return typeof e=="number"?[e,e,e]:e}function gf(e,t){return t<=1?e:e+(e-1)*(t-1)}function Pv(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function rp(e){var t=aw(e),r=t[0],n=t[1],a=t[2];return r===1&&n===1&&a===1}function cs(e,t){return rp(e)||rp(t)}function KT(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function YW(e,t,r){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var n=_r(e.shape),a=e.toFloat(),i=r.complex(a,n);return n.dispose(),a.dispose(),i}if(!Sde(e.dtype,t))return J.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var o=r.real(e);return i=o.cast(t),o.dispose(),i}if(t==="int32")return r.int(e);if(t==="bool"){var l=Fe(0,e.dtype);return i=r.notEqual(e,l),l.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function AE(e,t){return J.makeTensorFromDataId(e.dataId,t,e.dtype)}function XW(e,t,r){var n=(t-e)/(r-1),a=Px(r,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return dn(a,"float32")}function PE(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var r=new Float32Array(2*e.length),n=0;n<r.length;n+=2)r[n]=e[n/2],r[n+1]=t[n/2];return r}function QM(e,t){return{real:e[2*t],imag:e[2*t+1]}}function Jhe(e,t,r,n){e[2*n]=t,e[2*n+1]=r}function efe(e,t,r){var n=(r?2:-2)*Math.PI*(e/t);return{real:Math.cos(n),imag:Math.sin(n)}}function tfe(e,t,r){var n=function(i,o,l){return function(c,u,d){for(var h=0,f=c.length,p=0,m=!1;h<f;){var v=d(u,c[p=h+(f-h>>>1)]);v>0?h=p+1:(f=p,m=!v)}return m?h:-h-1}(i,o,l||rfe)}(e,t,r),a=n<0?-(n+1):n;e.splice(a,0,t)}function rfe(e,t){return e>t?1:e<t?-1:0}function YT(e,t,r,n,a){return QW(e,t,r,n,a,0).selectedIndices}function XT(e,t,r,n,a,i){var o=QW(e,t,r,n,a,i);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function QW(e,t,r,n,a,i,o,l){l===void 0&&(l=!1);for(var c=Array.from(t).map(function(N,j){return{score:N,boxIndex:j,suppressBeginIndex:0}}).filter(function(N){return N.score>a}).sort(ZM),u=i>0?-.5/i:0,d=[],h=[];d.length<r&&c.length>0;){var f=c.pop(),p=f.score,m=f.boxIndex,v=f.suppressBeginIndex;if(p<a)break;for(var g=!1,x=d.length-1;x>=v;--x){var y=nfe(e,m,d[x]);if(y>=n){g=!0;break}if(f.score=f.score*afe(n,u,y),f.score<=a)break}f.suppressBeginIndex=d.length,g||(f.score===p?(d.push(m),h.push(f.score)):f.score>a&&tfe(c,f,ZM))}var b=d.length;return l&&(d.fill(0,b),h.fill(0,b)),{selectedIndices:dn(d,"int32"),selectedScores:dn(h,"float32"),numValidOutputs:Fe(b,"int32")}}function nfe(e,t,r){var n=e.subarray(4*t,4*t+4),a=e.subarray(4*r,4*r+4),i=Math.min(n[0],n[2]),o=Math.min(n[1],n[3]),l=Math.max(n[0],n[2]),c=Math.max(n[1],n[3]),u=Math.min(a[0],a[2]),d=Math.min(a[1],a[3]),h=Math.max(a[0],a[2]),f=Math.max(a[1],a[3]),p=(l-i)*(c-o),m=(h-u)*(f-d);if(p<=0||m<=0)return 0;var v=Math.max(i,u),g=Math.max(o,d),x=Math.min(l,h),y=Math.min(c,f),b=Math.max(x-v,0)*Math.max(y-g,0);return b/(p+m-b)}function afe(e,t,r){var n=Math.exp(t*r*r);return r<=e?n:0}function ZM(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function ZW(e,t,r){var n=new Array(e.rank).fill(0),a=e.shape.slice();return t.map(function(i){a[r]=i;var o=e.slice(n,a);return n[r]+=i,o})}function JW(e,t){for(var r=new Array(e.rank),n=0;n<r.length;n++)r[n]=e.shape[n]*t[n];var a=yt(r,e.dtype);for(n=0;n<a.values.length;++n){for(var i=a.indexToLoc(n),o=new Array(e.rank),l=0;l<o.length;l++)o[l]=i[l]%e.shape[l];var c=e.locToIndex(o);a.values[n]=e.values[c]}return a.toTensor()}function eq(e,t,r,n,a){for(var i=t[t.length-1],o=[e.length/i,i],l=o[0],c=o[1],u=xg(r,l*n),d=xg("int32",l*n),h=0;h<l;h++){for(var f=h*c,p=e.subarray(f,f+c),m=[],v=0;v<p.length;v++)m.push({value:p[v],index:v});m.sort(function(N,j){return j.value-N.value});var g=h*n,x=u.subarray(g,g+n),y=d.subarray(g,g+n);for(v=0;v<n;v++)x[v]=m[v].value,y[v]=m[v].index}var b=t.slice();return b[b.length-1]=n,[ra(u,b,r),ra(d,b,"int32")]}function QT(e,t){for(var r=[],n=0;n<t.length;n++)t[n]&&r.push(n);var a=yt(e,"int32"),i=yt([r.length,e.length],"int32");for(n=0;n<r.length;n++){var o=a.indexToLoc(r[n]),l=n*e.length;i.values.set(o,l)}return i.toTensor()}var sfe=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(a,i){return"T"+i});var r=[];this.variableNames.forEach(function(a){r.push("float v"+a+" = get"+a+"AtOutCoords();")});var n=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+r.join(`
        `)+`

        float result = `+n+`;
        setOutput(result);
      }
    `},ife=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(a,i){return"T"+i});var r=[];this.variableNames.forEach(function(a){r.push("vec4 v"+a+" = get"+a+"AtOutCoords();")});var n=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+r.join(`
        `)+`

        vec4 result = `+n+`;
        setOutput(result);
      }
    `},ofe=function(e,t,r){this.variableNames=["A"];var n=e.windowSize,a=e.batchSize,i=e.inSize,o=Math.ceil(i/n);r||this.variableNames.push("bestIndicesA"),this.outputShape=[a,o];var l=t==="max"?">":"<",c=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+n+`; i++) {
          int inIdx = `+c+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+l+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function tq(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(r){return e+"."+r})}function ts(e,t){return t===1?[e]:tq(e,t)}function ba(){var e,t,r,n,a,i,o,l,c,u;return fe().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",r="out",n="in",a="texture",i="outputColor",o="out vec4 outputColor;",l=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,c="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",r="varying",n="varying",a="texture2D",i="gl_FragColor",o="",l=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:r,varyingFs:n,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:l,defineSpecialInf:c,defineRound:u}}function Ku(e,t,r){r===void 0&&(r="index");var n=ko(t);return n.map(function(a,i){return"int "+e[i]+" = "+r+" / "+a+"; "+(i===n.length-1?"int "+e[i+1]+" = "+r+" - "+e[i]+" * "+a:"index -= "+e[i]+" * "+a)+";"}).join("")}function ZT(e){var t=ko(e).map(function(r){return r.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var rq=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function lfe(e,t,r,n){var a=[];e.forEach(function(p){var m=Qe(p.shapeInfo.logicalShape);p.shapeInfo.isUniform?a.push("uniform float "+p.name+(m>1?"["+m+"]":"")+";"):(a.push("uniform sampler2D "+p.name+";"),a.push("uniform int offset"+p.name+";"))});var i,o,l=a.join(`
`),c=e.map(function(p){return function(m,v,g){g===void 0&&(g=!1);var x="";x+=g?nq(m):Ih(m);var y=m.shapeInfo.logicalShape,b=v.logicalShape;return y.length<=b.length&&(x+=g?function(N,j){var _,S=N.name,C=S.charAt(0).toUpperCase()+S.slice(1),E="get"+C+"AtOutCoords",k=N.shapeInfo.logicalShape.length,P=j.logicalShape.length,A=_c(N.shapeInfo.logicalShape,j.logicalShape),O=br(P),I=P-k,R=["x","y","z","w","u","v"];_=k===0?"":P<2&&A.length>=1?"coords = 0;":A.map(function(U){return"coords."+R[U+I]+" = 0;"}).join(`
`);var M="";M=P<2&&k>0?"coords":N.shapeInfo.logicalShape.map(function(U,Y){return"coords."+R[Y+I]}).join(", ");var B="return outputValue;",$=Qe(N.shapeInfo.logicalShape)===1,D=Qe(j.logicalShape)===1;if(k!==1||$||D){if($&&!D)B=P===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(A.length){var W=k-2,Z=k-1;A.indexOf(W)>-1&&A.indexOf(Z)>-1?B="return vec4(outputValue.x);":A.indexOf(W)>-1?B="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":A.indexOf(Z)>-1&&(B="return vec4(outputValue.xx, outputValue.zz);")}}else B=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+E+`() {
      `+O+` coords = getOutputCoords();
      `+_+`
      vec4 outputValue = get`+C+"("+M+`);
      `+B+`
    }
  `}(m,v):function(N,j){var _=N.name,S=_.charAt(0).toUpperCase()+_.slice(1),C="get"+S+"AtOutCoords",E=j.texShape,k=N.shapeInfo.texShape,P=N.shapeInfo.logicalShape.length,A=j.logicalShape.length;if(!N.shapeInfo.isUniform&&P===A&&N.shapeInfo.flatOffset==null&&Gn(k,E))return`
      float `+C+`() {
        return sampleTexture(`+_+`, resultUV);
      }
    `;var O,I=br(A),R=_c(N.shapeInfo.logicalShape,j.logicalShape),M=A-P,B=["x","y","z","w","u","v"];O=P===0?"":A<2&&R.length>=1?"coords = 0;":R.map(function(D){return"coords."+B[D+M]+" = 0;"}).join(`
`);var $="";return $=A<2&&P>0?"coords":N.shapeInfo.logicalShape.map(function(D,W){return"coords."+B[W+M]}).join(", "),`
    float `+C+`() {
      `+I+` coords = getOutputCoords();
      `+O+`
      return get`+S+"("+$+`);
    }
  `}(m,v)),x}(p,t,n)}).join(`
`),u=t.texShape,d=ba(),h=function(p){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+p.texture2D+`(textureSampler, uv).r;
    }
  `}(d),f=function(p){return p.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+p.varyingFs+` vec2 resultUV;
    `+p.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+p.defineSpecialNaN+`
    `+p.defineSpecialInf+`
    `+p.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+cfe+`
    `+ufe+`
    `+dfe+`
  `}(d);return t.isPacked?(i=function(p,m){switch(p.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(N,j){var _=[Math.ceil(j[0]/2),Math.ceil(j[1]/2)];return _[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+_[1]+`.0);
      }
    `:_[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+_[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      return 2 * (resTexRC.x * `+_[1]+` + resTexRC.y);
    }
  `}(0,m);case 2:return function(N,j){var _=[Math.ceil(j[0]/2),Math.ceil(j[1]/2)];if(Gn(N,j))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+_[0]+", "+_[1]+`));
      }
    `;var S=Math.ceil(N[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));

      int index = resTexRC.x * `+_[1]+` + resTexRC.y;
      int r = 2 * (index / `+S+`);
      int c = imod(index, `+S+`) * 2;

      return ivec2(r, c);
    }
  `}(p,m);case 3:return v=p,g=m,x=[Math.ceil(g[0]/2),Math.ceil(g[1]/2)],y=Math.ceil(v[2]/2),b=y*Math.ceil(v[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;

      int b = index / `+b+`;
      index -= b * `+b+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(N,j){for(var _=[Math.ceil(j[0]/2),Math.ceil(j[1]/2)],S=Math.ceil(N[N.length-1]/2),C=S*Math.ceil(N[N.length-2]/2),E=C,k="",P="b, r, c",A=2;A<N.length-1;A++)E*=N[N.length-A-1],k=`
      int b`+A+" = index / "+E+`;
      index -= b`+A+" * "+E+`;
    `+k,P="b"+A+", "+P;return`
    ivec`+N.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;

      `+k+`

      int b = index / `+C+`;
      index -= b * `+C+`;

      int r = 2 * (index / `+S+`);
      int c = imod(index, `+S+`) * 2;

      return ivec`+N.length+"("+P+`);
    }
  `}(p,m)}var v,g,x,y,b}(t.logicalShape,u),o=function(p){return`
    void setOutput(vec4 val) {
      `+p.output+` = val;
    }
  `}(d)):(i=function(p,m){switch(p.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(x,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,m);case 2:return function(x,y){return Gn(x,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:x[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:x[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+x[1]+`;
      int c = index - r * `+x[1]+`;
      return ivec2(r, c);
    }
  `}(p,m);case 3:return v=m,g=Ku(["r","c","d"],p),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;
      `+g+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(x,y){var b=Ku(["r","c","d","d2"],x);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+b+`
      return ivec4(r, c, d, d2);
    }
  `}(p,m);case 5:return function(x,y){var b=Ku(["r","c","d","d2","d3"],x);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(p,m);case 6:return function(x,y){var b=Ku(["r","c","d","d2","d3","d4"],x);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(p,m);default:throw new Error(p.length+"-D output sampling is not yet supported")}var v,g}(t.logicalShape,u),o=function(p){return`
    void setOutput(float val) {
      `+p.output+` = vec4(val, 0, 0, 0);
    }
  `}(d)),n&&(f+=hfe),[f,h,o,l,i,c,r].join(`
`)}function Ih(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(r){var n=r.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(r.shapeInfo.isUniform)return"float "+a+"() {return "+n+";}";var i=r.shapeInfo.texShape,o=i[0],l=i[1];if(o===1&&l===1)return`
      float `+a+`() {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var c=r.shapeInfo.texShape,u=c[0],d=c[1],h=Au(n);return`
    float `+a+`() {
      vec2 uv = uvFromFlat(`+u+", "+d+", "+h+`);
      return sampleTexture(`+n+`, uv);
    }
  `}(e);case 1:return function(r){var n=r.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(r.shapeInfo.isUniform)return`
      float `+a+`(int index) {
        `+xh(r)+`
      }
    `;var i=r.shapeInfo.texShape,o=i[0],l=i[1];if(l===1&&o===1)return`
      float `+a+`(int index) {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var c=Au(n);return l===1?`
      float `+a+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+c+") + 0.5) / "+o+`.0);
        return sampleTexture(`+n+`, uv);
      }
    `:o===1?`
      float `+a+`(int index) {
        vec2 uv = vec2((float(index + `+c+") + 0.5) / "+l+`.0, 0.5);
        return sampleTexture(`+n+`, uv);
      }
    `:`
    float `+a+`(int index) {
      vec2 uv = uvFromFlat(`+o+", "+l+", index + "+c+`);
      return sampleTexture(`+n+`, uv);
    }
  `}(e);case 2:return function(r){var n=r.shapeInfo.logicalShape,a=r.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),o=r.shapeInfo.texShape;if(o!=null&&Gn(n,o)){var l=o[0],c=o[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `}var u=Vu(n),d=u.newShape,h=u.keptDims,f=d;if(f.length<n.length){var p=Dh(r,f);return`
      `+Ih(p)+`
      float `+i+`(int row, int col) {
        return `+i+"("+Mh(["row","col"],h)+`);
      }
    `}if(r.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+n[1]+`, 1)));
        `+xh(r)+`
      }
    `;var m=o[0],v=o[1],g=Au(a);return v===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+m+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `:m===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+v+`.0, 0.5);
      return sampleTexture(`+a+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+n[1]+" + col + "+g+`;
    vec2 uv = uvFromFlat(`+m+", "+v+`, index);
    return sampleTexture(`+a+`, uv);
  }
`}(e);case 3:return function(r){var n=r.shapeInfo.logicalShape,a=r.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),o=n[1]*n[2],l=n[2],c=Vu(n),u=c.newShape,d=c.keptDims,h=u;if(h.length<n.length){var f=Dh(r,h);return`
        `+Ih(f)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+Mh(["row","col","depth"],d)+`);
        }
      `}if(r.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+o+", "+l+`, 1)));
        `+xh(r)+`
      }
    `;var p=r.shapeInfo.texShape,m=p[0],v=p[1],g=r.shapeInfo.flatOffset;if(v===o&&g==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+l+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+v+".0, "+m+`.0);
          return sampleTexture(`+a+`, uv);
        }
      `;if(v===l&&g==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+n[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+v+".0, "+m+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `;var x=Au(a);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+o+" + col * "+l+" + depth + "+x+`;
        vec2 uv = uvFromFlat(`+m+", "+v+`, index);
        return sampleTexture(`+a+`, uv);
      }
  `}(e);case 4:return function(r){var n=r.shapeInfo.logicalShape,a=r.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),o=n[3],l=n[2]*o,c=n[1]*l,u=Vu(n),d=u.newShape,h=u.keptDims;if(d.length<n.length){var f=Dh(r,d);return`
      `+Ih(f)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+Mh(["row","col","depth","depth2"],h)+`);
      }
    `}if(r.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+c+", "+l+", "+o+`, 1)));
        `+xh(r)+`
      }
    `;var p=r.shapeInfo.flatOffset,m=r.shapeInfo.texShape,v=m[0],g=m[1];if(g===c&&p==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+l+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+g+".0, "+v+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(g===o&&p==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+n[1]*n[2]+", "+n[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+g+".0, "+v+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var x=Au(a);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+c+" + col * "+l+` +
          depth * `+o+` + depth2;
      vec2 uv = uvFromFlat(`+v+", "+g+", index + "+x+`);
      return sampleTexture(`+a+`, uv);
    }
  `}(e);case 5:return function(r){var n=r.shapeInfo.logicalShape,a=r.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),o=n[4],l=n[3]*o,c=n[2]*l,u=n[1]*c,d=Vu(n),h=d.newShape,f=d.keptDims;if(h.length<n.length){var p=Dh(r,h);return`
      `+Ih(p)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+Mh(["row","col","depth","depth2","depth3"],f)+`);
      }
    `}if(r.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+u+", "+c+", "+l+", "+o+`)) +
          depth3;
        `+xh(r)+`
      }
    `;var m=r.shapeInfo.flatOffset,v=r.shapeInfo.texShape,g=v[0],x=v[1];if(x===u&&m==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+c+", "+l+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+x+".0, "+g+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(x===o&&m==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]+`,
               `+n[2]*n[3]+", "+n[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+x+".0, "+g+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var y=Au(a);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+c+" + depth * "+l+` +
          depth2 * `+o+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+g+", "+x+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(e);case 6:return function(r){var n=r.shapeInfo.logicalShape,a=r.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),o=Vu(n),l=o.newShape,c=o.keptDims;if(l.length<n.length){var u=Dh(r,l);return`
      `+Ih(u)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+Mh(["row","col","depth","depth2","depth3","depth4"],c)+`);
      }
    `}var d=n[5],h=n[4]*d,f=n[3]*h,p=n[2]*f,m=n[1]*p;if(r.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+m+", "+p+", "+f+", "+h+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+d+`, 1)));
        `+xh(r)+`
      }
    `;var v=r.shapeInfo.flatOffset,g=r.shapeInfo.texShape,x=g[0],y=g[1];if(y===m&&v==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+p+", "+f+", "+h+", "+d+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+x+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(y===d&&v==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]*n[4]+`,
               `+n[2]*n[3]*n[4]+`,
               `+n[3]*n[4]+`,
               `+n[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+x+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var b=Au(a);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+m+" + col * "+p+" + depth * "+f+` +
          depth2 * `+h+" + depth3 * "+d+" + depth4 + "+b+`;
      vec2 uv = uvFromFlat(`+x+", "+y+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function nq(e){var t,r,n;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),n=ba(),`
    vec4 `+r+`() {
      return `+n.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(a){var i=a.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),l=a.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],u=ba();return`
    vec4 `+o+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+c[0]+", "+c[1]+`, index);
      return `+u.texture2D+"("+i+`, uv);
    }
  `}(e);case 2:return function(a){var i=a.shapeInfo.logicalShape,o=a.name,l="get"+o.charAt(0).toUpperCase()+o.slice(1),c=a.shapeInfo.texShape,u=c[0],d=c[1],h=ba();if(c!=null&&Gn(i,c))return`
      vec4 `+l+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+d+".0, "+u+`.0);

        return `+h.texture2D+"("+o+`, uv);
      }
    `;var f=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],p=Math.ceil(i[1]/2);return`
    vec4 `+l+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+p+", "+f[0]+", "+f[1]+`, row, col);
      return `+h.texture2D+"("+o+`, uv);
    }
  `}(e);case 3:return function(a){var i=a.shapeInfo.logicalShape,o=a.name,l="get"+o.charAt(0).toUpperCase()+o.slice(1),c=a.shapeInfo.texShape,u=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];if(i[0]===1){var d=i.slice(1),h=Dh(a,d);return`
        `+nq(h)+`
        vec4 `+l+`(int b, int row, int col) {
          return `+l+"("+Mh(["b","row","col"],[1,2])+`);
        }
      `}var f=u[0],p=u[1],m=Math.ceil(i[2]/2),v=m*Math.ceil(i[1]/2),g=ba();return`
    vec4 `+l+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+f+", "+p+", "+v+", "+m+`, b, row, col);
      return `+g.texture2D+"("+o+`, uv);
    }
  `}(e);default:return function(a){for(var i=a.shapeInfo.logicalShape,o=i.length,l=a.name,c="get"+l.charAt(0).toUpperCase()+l.slice(1),u=a.shapeInfo.texShape,d=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=d[0],f=d[1],p=Math.ceil(i[o-1]/2),m=p*Math.ceil(i[o-2]/2),v="int b, int row, int col",g="b * "+m+" + (row / 2) * "+p+" + (col / 2)",x=2;x<o-1;x++)v="int b"+x+", "+v,m*=i[o-x-1],g="b"+x+" * "+m+" + "+g;var y=ba();return`
    vec4 `+c+"("+v+`) {
      int index = `+g+`;
      int texR = index / `+f+`;
      int texC = index - texR * `+f+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+f+", "+h+`);
      return `+y.texture2D+"("+l+`, uv);
    }
  `}(e)}}var cfe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ufe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,dfe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,hfe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Au(e){return"offset"+e}function xh(e){var t=e.name,r=Qe(e.shapeInfo.logicalShape);return r<2?"return "+t+";":`
    for (int i = 0; i < `+r+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function br(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Dh(e,t){var r=JSON.parse(JSON.stringify(e));return r.shapeInfo.logicalShape=t,r}function Mh(e,t){return t.map(function(r){return e[r]}).join(", ")}var ffe=function(e,t,r,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,z(e.length>2,function(){return"Packed arg"+(r.charAt(0).toUpperCase()+r.slice(1))+" supports only inputs with rank above 2."});var a=e[e.length-1],i=Math.ceil(a/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),n||this.variableNames.push("bestIndicesA");var o,l,c=this.outputShape,u=c.length,d=br(u),h=ts("coords",u);if(i===1){var f=br(l=u+1);o=`
        `+f+" sourceLocR = "+f+"("+h.join()+`, 0);
        ++`+h[u-1]+`;
        `+f+" sourceLocG = "+f+"("+h.join()+`, 0);
        ++`+h[u-2]+`;
        `+f+" sourceLocA = "+f+"("+h.join()+`, 0);
        --`+h[u-1]+`;
        `+f+" sourceLocB = "+f+"("+h.join()+`, 0);
        --`+h[u-2]+";"}else l=u,o=`
        `+d+` sourceLocR = coords;
        ++`+h[u-1]+`;
        `+d+` sourceLocG = coords;
        ++`+h[u-2]+`;
        `+d+` sourceLocA = coords;
        --`+h[u-1]+`;
        `+d+` sourceLocB = coords;
        --`+h[u-2]+";";var p=["x","y","z","w","u","v"].slice(0,l),m="."+p[l-1],v=p.map(function(C){return"int "+C}),g=ts("sourceLocR",l-1).concat("inIdx.r"),x=ts("sourceLocG",l-1).concat("inIdx.g"),y=ts("sourceLocB",l-1).concat("inIdx.b"),b=ts("sourceLocA",l-1).concat("inIdx.a"),N=r==="max"?"greaterThan":"lessThan",j=n?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+g.join()+`),
                             getBestIndicesAChannel(`+x.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+b.join()+")));",_=`vec4(
            getAChannel(`+g.join()+`),
            hasNextCol ? getAChannel(`+x.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+b.join()+") : 0.)",S=n?"":`
      float getBestIndicesAChannel(`+v.join()+`) {
        return getChannel(getBestIndicesA(`+p.join()+`),
                                          vec2(`+p.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+v.join()+`) {
        return getChannel(getA(`+p.join()+`),
                               vec2(`+p.slice(-2).join()+`));
      }
      `+S+`
      void main() {
        `+d+` coords = getOutputCoords();
        bool hasNextCol = `+h[u-1]+" < "+(c[u-1]-1)+`;
        bool hasNextRow = `+h[u-2]+" < "+(c[u-2]-1)+`;
        `+o+`
        ivec4 srcIdx = ivec4(sourceLocR`+m+", sourceLocG"+m+`,
          sourceLocB`+m+", sourceLocA"+m+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+_+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+j+`
          vec4 candidate = `+_+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+N+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},pfe=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,r=e.filterWidth,n=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,d=c-1-e.padInfo.left,h=1/(t*r);this.userCode=`
      const ivec2 pads = ivec2(`+u+", "+d+`);
      const float avgMultiplier = float(`+h+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+l+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+c+`;
            wC+= `+o+`) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},mfe=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,r=e.filterHeight,n=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=d-1-e.padInfo.front,m=h-1-e.padInfo.top,v=f-1-e.padInfo.left,g=1/(t*r*n);this.userCode=`
      const ivec3 pads = ivec3(`+p+", "+m+", "+v+`);
      const float avgMultiplier = float(`+g+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          float dyD = float(dyDCorner + wD) / `+a+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+h+`;
              wR += `+c+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+u+`) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},vfe=function(e,t,r,n,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Vt(e,t),Vt(e,r);var o="0.0";n!=null&&(Vt(e,n),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var l="1.0";a!=null&&(Vt(e,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+o+`;
        float scale = `+l+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},gfe=function(e,t,r,n,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Vt(e,t),Vt(e,r);var o="vec4(0.0)";n!=null&&(Vt(e,n),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var l="vec4(1.0)";a!=null&&(Vt(e,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+o+`;
        vec4 scale = `+l+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},xfe="return areal * breal - aimag * bimag;",yfe="return areal * bimag + aimag * breal;",JM=function(e,t,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Vt(t,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},b2="return a + b;",w2="return a - b;",e3="return a * b;",aq="return (a < 0.) ? b * a : a;",zr=function(e,t,r){this.variableNames=["A","B"],this.outputShape=Vt(t,r),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},sq=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Jo=function(e,t,r,n){n===void 0&&(n=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Vt(t,r);var a=this.outputShape.length,i="";if(n)if(a===0||Qe(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+br(a)+` coords = getOutputCoords();
        `,a===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var o=ts("coords",a);i+=`
            bool nextRowOutOfBounds =
              (`+o[a-2]+" + 1) >= "+this.outputShape[a-2]+`;
            bool nextColOutOfBounds =
              (`+o[a-1]+" + 1) >= "+this.outputShape[a-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},bfe=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,r){var n=this;return function(a,i){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(n.minLoc,t),a.gl.uniform1f(n.maxLoc,r)}},e}(),wfe=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,r){var n=this;return function(a,i){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(n.minLoc,t),a.gl.uniform1f(n.maxLoc,r)}},e}(),jfe=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},Nfe=function(e){this.outputShape=[],this.outputShape=tp(e,1),this.variableNames=e.map(function(l,c){return"T"+c});var t=new Array(e.length-1);t[0]=e[0][1];for(var r=1;r<t.length;r++)t[r]=t[r-1]+e[r][1];var n=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(r=1;r<t.length;r++){var a=t[r-1];n.push("else if (yC < "+t[r]+") setOutput(getT"+r+"(yR, yC-"+a+"));")}var i=t.length,o=t[t.length-1];n.push("else setOutput(getT"+i+"(yR, yC-"+o+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+n.join(`
        `)+`
      }
    `},_fe=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=tp(e,t);var r=this.outputShape,n=r.length,a=br(n),i=ts("coords",n),o=["x","y","z","w","u","v"].slice(0,n);this.variableNames=e.map(function(g,x){return"T"+x});var l=new Array(e.length-1);l[0]=e[0][t];for(var c=1;c<l.length;c++)l[c]=l[c-1]+e[c][t];var u=o[t],d=o.slice(-2),h=o.join(),f="if ("+u+" < "+l[0]+`) {
        return getChannel(
            getT0(`+h+"), vec2("+d.join()+`));
        }`;for(c=1;c<l.length;c++){var p=l[c-1];f+=`
        if (`+u+" < "+l[c]+"  && "+u+" >= "+l[c-1]+`) {
          return getChannel(
            getT`+c+"("+Qy(o,u,p)+`),
            vec2(`+Qy(d,u,p)+`));
        }`}var m=l.length,v=l[l.length-1];f+=`
        return getChannel(
          getT`+m+"("+Qy(o,u,v)+`),
          vec2(`+Qy(d,u,v)+"));",this.userCode=`
      float getValue(`+o.map(function(g){return"int "+g})+`) {
        `+f+`
      }

      void main() {
        `+a+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[n-1]+" = "+i[n-1]+` + 1;
        if (`+i[n-1]+" < "+r[n-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[n-2]+" = "+i[n-2]+` + 1;
        if (`+i[n-2]+" < "+r[n-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[n-1]+" = "+i[n-1]+` - 1;
        if (`+i[n-2]+" < "+r[n-2]+` &&
            `+i[n-1]+" < "+r[n-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function Qy(e,t,r){var n=e.indexOf(t);return e.map(function(a,i){return i===n?a+" - "+r:a}).join()}var Sfe=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,r=e.strideWidth,n=e.padInfo.top,a=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+n+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+r+" - "+a+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},Cfe=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,r=e.filterWidth,n=e.strideHeight,a=e.strideWidth,i=e.dataFormat==="channelsLast",o=t-1-e.padInfo.top,l=r-1-e.padInfo.left,c=i?1:2,u=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+d+`];

        ivec2 dyCorner = ivec2(coords[`+c+"], coords["+u+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+r+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+r+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},Efe=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,r=e.strideHeight,n=e.strideWidth,a=e.padInfo.front,i=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+a+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+r+" - "+i+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+n+" - "+o+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},kfe=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,r=e.filterHeight,n=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=t-1-e.padInfo.front,c=r-1-e.padInfo.top,u=n-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+l+", "+c+", "+u+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+a+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+r+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+r+` - 1 - wR;

            for (int wC = 0; wC < `+n+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+n+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},Afe=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,r=e.strideWidth,n=e.padInfo.top,a=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+n+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+r+" - "+a+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},Pfe=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,r=e.filterWidth,n=e.strideHeight,a=e.strideWidth,i=t-1-e.padInfo.top,o=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+r+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+r+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+l+`; dm++) {
              int d2 = d1 * `+l+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},t3=function(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var a=e.padInfo.top,i=e.padInfo.left,o=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,f=4*Math.floor(e.inChannels/4),p=e.inChannels%4,m=e.dataFormat==="channelsLast",v=m?1:2,g=m?2:3,x=m?3:1,y="",b="";r&&(y=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+r+`
        }`:`
          float activation(float x) {
            `+r+`
          }
        `,b="result = activation(result);");var N=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+o+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+x+`];

        ivec2 xRCCorner =
            ivec2(coords[`+v+"], coords["+g+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+u+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+f+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+m+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(p===1)+`) {

              if (`+m+`) {
                dotProd +=
                    getX(batch, xR, xC, `+f+`) *
                    getW(wR, wC, `+f+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+f+`, xR, xC) *
                    getW(wR, wC, `+f+`, d2);
              }

            } else if (`+(p===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2)
              );

              if (`+m+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(p===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2),
                getW(wR, wC, `+f+` + 2, d2)
              );

              if (`+m+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1),
                  getX(batch, xR, xC, `+f+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC),
                  getX(batch, `+f+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+N+`
        `+b+`
        setOutput(result);
      }
    `},Tfe=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,r=e.padInfo.top,n=e.padInfo.left,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,f=e.filterWidth,p=4*Math.floor(e.inChannels/4),m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+a+", "+i+", "+o+`);
      const ivec3 pads = ivec3(`+t+", "+r+", "+n+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+d+`; wF++) {
          int xF = xFCorner + wF * `+l+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`; wR++) {
            int xR = xRCorner + wR * `+c+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`; wC++) {
              int xC = xCCorner + wC * `+u+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+p+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(m===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+p+`) *
                  getW(wF, wR, wC, `+p+`, d2);
              } else if (`+(m===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+p+`),
                  getX(batch, xF, xR, xC, `+p+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+p+`, d2),
                  getW(wF, wR, wC, `+p+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(m===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+p+`),
                  getX(batch, xF, xR, xC, `+p+` + 1),
                  getX(batch, xF, xR, xC, `+p+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+p+`, d2),
                  getW(wF, wR, wC, `+p+` + 1, d2),
                  getW(wF, wR, wC, `+p+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},r3=function(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var a=e.inHeight,i=e.inWidth,o=e.padInfo.top,l=e.padInfo.left,c=e.strideHeight,u=e.strideWidth,d=e.dilationHeight,h=e.dilationWidth,f=e.filterHeight,p=e.filterWidth,m=e.outChannels/e.inChannels,v="",g="";r&&(v=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+r+`
        }`:`
          float activation(float x) {
            `+r+`
          }
        `,g="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+v+`

      const ivec2 strides = ivec2(`+c+", "+u+`);
      const ivec2 pads = ivec2(`+o+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+m+`;
        int q = d2 - d1 * `+m+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+f+`; wR++) {
          int xR = xRCorner + wR * `+d+`;

          if (xR < 0 || xR >= `+a+`) {
            continue;
          }

          for (int wC = 0; wC < `+p+`; wC++) {
            int xC = xCCorner + wC * `+h+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+x+`
        `+g+`
        setOutput(result);
      }
    `},n3=function(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var a=e.inHeight,i=e.inWidth,o=e.padInfo.top,l=e.padInfo.left,c=e.strideHeight,u=e.strideWidth,d=e.dilationHeight,h=e.dilationWidth,f=e.filterHeight,p=e.filterWidth,m=p,v="int xR; int xC; int xCOffset;",g=0;g<f;g++)for(var x=0;x<p;x++)v+=`
          vec4 xTexelR`+g+"C"+2*x+` = vec4(0.);
          vec4 wR`+g+"C"+x+` = vec4(0.);
          vec4 xR`+g+"C"+x+" = vec4(0.);";for(g=0;g<f;g++)for(var y=0;y<m;y++){if(v+=`
          xR = xRCorner + `+g*d+`;
          xC = xCCorner + `+(x=2*y)*h+`;
        `,u===1){if(x<p&&(v+=l%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+g+"C"+x+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+g+"C"+x+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+g+"C"+x+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+g+"C"+x+" = vec4(previous.zw, xTexelR"+g+"C"+x+`.xy);
                } else {
                  xR`+g+"C"+x+" = vec4(0, 0, xTexelR"+g+"C"+x+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+a+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+g+"C"+x+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+x+` = vec4(0.);
                }

                xR`+g+"C"+x+" = xTexelR"+g+"C"+x+`;
              `,x+1<p)){var b=l%2==0?NW(h):h;h%2==0&&l%2==1||h%2!=0&&l%2!=1?(v+=`
                  xCOffset = xC + `+l%2+" + "+b+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(x+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,h>1&&(v+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+a+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+g+"C"+x+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+g+"C"+x+` = vec4(0.);
                    }
                  `),v+=`
                  xR`+g+"C"+(x+1)+` = vec4(
                    xTexelR`+g+"C"+x+".zw, xTexelR"+g+"C"+(x+2)+`.xy);
                `):v+=`
                  xCOffset = xC + `+b+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(x+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+g+"C"+(x+1)+" = xTexelR"+g+"C"+(x+2)+`;
                `}}else x<p&&(v+=`
              if(xR >= 0 && xR < `+a+`) {
            `,l%2==1?(v+=`
                xCOffset = xC + 1 - `+u+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+x+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+x+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+g+"C"+(x+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+g+"C"+(x+2)+` = vec4(0.);
                }

                xR`+g+"C"+x+` = vec4(
                  xTexelR`+g+"C"+x+".zw, xTexelR"+g+"C"+(x+2)+`.zw);
              `,x+1<p&&(v+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+u+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+g+"C"+(x+1)+" = vec4(xTexelR"+g+"C"+(x+2)+`.xy, final.xy);
                `)):(v+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+g+"C"+x+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+x+` = vec4(0.);
                }

                xCOffset = xC + `+u+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+(x+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+(x+2)+` = vec4(0.);
                }

                xR`+g+"C"+x+` = vec4(
                  xTexelR`+g+"C"+x+".xy, xTexelR"+g+"C"+(x+2)+`.xy);
              `,x+1<p&&(v+=`
                  xR`+g+"C"+(x+1)+` = vec4(
                    xTexelR`+g+"C"+x+".zw, xTexelR"+g+"C"+(x+2)+`.zw);
                `)),v+="}");x<p&&(v+=`
            vec4 wTexelR`+g+"C"+x+" = getW("+g+", "+x+`, d1, q);
            wR`+g+"C"+x+" = vec4(wTexelR"+g+"C"+x+".xz, wTexelR"+g+"C"+x+`.xz);
          `,x+1<p&&(v+=`
              vec4 wTexelR`+g+"C"+(x+1)+" = getW("+g+", "+(x+1)+`, d1, q);
              wR`+g+"C"+(x+1)+` =
                vec4(wTexelR`+g+"C"+(x+1)+".xz, wTexelR"+g+"C"+(x+1)+".xz);"))}for(g=0;g<f;g++)for(x=0;x<p;x++)v+="dotProd += xR"+g+"C"+x+" * wR"+g+"C"+x+";";var N="",j="";r&&(N=n?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+r+`
        }`:`vec4 activation(vec4 x) {
          `+r+`
        }`,j="result = activation(result);");var _=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+N+`

      const ivec2 strides = ivec2(`+c+", "+u+`);
      const ivec2 pads = ivec2(`+o+", "+l+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+v+`

        vec4 result = dotProd;
        `+_+`
        `+j+`
        setOutput(result);
      }
    `},Rfe=function(e,t,r,n,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],o=e[1],l=e[2],c=e[3],u=t[0],d=r[0],h=r[1];this.outputShape=[u,d,h,c];var f=n==="bilinear"?1:0,p=[o-1+".0",l-1+".0"],m=p[0],v=p[1],g=d>1?[""+(o-1)/(d-1),"(y2-y1) * height_ratio","y1*"+m+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+m],x=g[0],y=g[1],b=g[2],N=h>1?[""+(l-1)/(h-1),"(x2-x1) * width_ratio","x1*"+v+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+v],j=N[0],_=N[1],S=N[2];this.userCode=`
      const float height_ratio = float(`+x+`);
      const float width_ratio = float(`+j+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+_+`;

        float in_y = `+b+`;
        if( in_y < 0.0 || in_y > `+m+` ) {
          setOutput(float(`+a+`));
          return;
        }
        float in_x = `+S+`;
        if( in_x < 0.0 || in_x > `+v+` ) {
          setOutput(float(`+a+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+f+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},Ofe=function(e,t,r){this.variableNames=["x"],this.outputShape=e;var n=e.length,a=e[e.length-1],i=r?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(r?"return "+a+" -i - 1;":"return i;")+`
      }

      void main() {
        `+br(n)+` coords = getOutputCoords();
        int end = `+a3(n,"coords")+`;
        float val = 0.0;
        for (int i = `+a+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+a3(n,"coords")+` = idx;
          val += getX(`+function(o,l){if(o===1)return""+l;if(o===2)return l+".x, "+l+".y";if(o===3)return l+".x, "+l+".y, "+l+".z";if(o===4)return l+".x, "+l+".y, "+l+".z, "+l+".w";throw Error("Cumulative sum for rank "+o+" is not yet supported")}(n,"coords")+`);
        }
        setOutput(val);
      }
    `};function a3(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var Ife=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=bg.DENSE;var t=Av(e),r=ba();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Ku(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+r.output+` = result;
      }
    `},Dfe=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=bg.DENSE;var t=Av(e),r=ba();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Ku(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+r.output+` = result;
      }
    `},Mfe=function(){function e(t,r,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=r,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+r+`;
      int offset_h = imod(h, `+r+`);
      int in_w = w / `+r+`;
      int offset_w = imod(w, `+r+`);
      int offset_d = (offset_h * `+r+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),$fe=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},Ffe=function(e){this.variableNames=["A"],this.outTexUsage=ks.DOWNLOAD;var t=ba();this.outputShape=e,this.userCode=`
      `+rq+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},Lfe=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=ks.DOWNLOAD;var t=ba();this.outputShape=e,this.userCode=`
      `+rq+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},Bfe=function(e,t,r){r===void 0&&(r=!1),this.variableNames=["A"];var n=ba(),a=t[0],i=t[1];this.outputShape=e;var o="result";r&&(o="floor(result * 255. + 0.5)"),this.userCode=`
      `+ZT(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
        vec4 values = `+n.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+n.output+" = vec4("+o+`, 0., 0., 0.);
      }
    `},Ufe=function(e,t,r){r===void 0&&(r=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=ba(),a=t[0],i=t[1];this.outputShape=e;var o="",l="result";r&&(l="floor(result * 255. + 0.5)");for(var c=0;c<=1;c++)for(var u=0;u<=1;u++){var d=2*c+u;o+=`
          localCoords = coords;
          if(localCoords[2] + `+u+" < "+e[2]+`) {
            localCoords[2] += `+u+`;
            if(localCoords[1] + `+c+" < "+e[1]+`) {
              localCoords[1] += `+c+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
              values = `+n.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+d+`] = values[0];
              } else if(offset == 1) {
                result[`+d+`] = values[1];
              } else if(offset == 2) {
                result[`+d+`] = values[2];
              } else {
                result[`+d+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+ZT(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+o+`

        `+n.output+" = "+l+`;
      }
    `},Vfe="return real * expR - imag * expI;",zfe="return real * expI + imag * expR;",s3=function(e,t,r){this.variableNames=["real","imag"];var n=t[1];this.outputShape=t;var a=r?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=r?n+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+a+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+n+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+n+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},Wfe=function(){function e(t,r){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var r=this;return function(n,a){r.valueLoc==null&&(r.valueLoc=n.getUniformLocationNoThrow(a,"value")),n.gl.uniform1f(r.valueLoc,t)}},e}(),qfe=function(e,t,r){this.variableNames=["A","indices"];var n=e.slice();n[r]=t,this.outputShape=n,this.rank=n.length;var a=br(this.rank),i=function(o,l){var c=o.length;if(c>4)throw Error("Gather for rank "+c+" is not yet supported");if(c===1)return"int(getIndices(resRC))";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w"],d=[],h=0;h<o.length;h++)h===l?d.push("int(getIndices("+u[h]+"))"):d.push(""+u[h]);return d.join()}(e,r);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},Gfe=function(e,t,r){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=r;var n=br(t.length),a=br(r.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+n+" strides = "+n+"("+this.strides+`);
         void main() {
          `+a+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function Hfe(e,t){var r=ba();return Vde(e,t,r.version+`
    precision highp float;
    `+r.attribute+` vec3 clipSpacePos;
    `+r.attribute+` vec2 uv;
    `+r.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function Kfe(e,t){return Hde(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Yfe(e,t){return Kde(e,t,new Uint16Array([0,1,2,2,1,3]))}function Rx(e,t,r,n,a,i,o){Xde(r,n);var l=Yde(e,t),c=e.TEXTURE_2D;return Je(e,t,function(){return e.bindTexture(c,l)}),Je(e,t,function(){return e.texParameteri(c,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),Je(e,t,function(){return e.texParameteri(c,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),Je(e,t,function(){return e.texParameteri(c,e.TEXTURE_MIN_FILTER,e.NEAREST)}),Je(e,t,function(){return e.texParameteri(c,e.TEXTURE_MAG_FILTER,e.NEAREST)}),Je(e,t,function(){return e.texImage2D(c,0,a,r,n,0,i,o,null)}),Je(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),l}function Xfe(e,t,r,n,a){var i=Sj(r,n);return Rx(e,t,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,e.FLOAT)}function Qfe(e,t,r,n,a){var i=Sj(r,n);return Rx(e,t,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function Zfe(e,t,r,n,a){var i=Sj(r,n);return Rx(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function Jfe(e,t,r,n,a){var i=Tx(r,n);return Rx(e,t,i[0],i[1],a.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function epe(e,t,r,n,a){var i=Tx(r,n);return Rx(e,t,i[0],i[1],a.internalFormatPackedHalfFloat,e.RGBA,a.textureTypeHalfFloat)}function tpe(e,t,r,n){return Je(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,n)}),GM(e,t,r,"clipSpacePos",n,3,20,0)&&GM(e,t,r,"uv",n,2,20,12)}function rpe(e,t,r,n,a,i,o){var l,c,u;Je(e,t,function(){return e.bindTexture(e.TEXTURE_2D,r)}),i instanceof Uint8Array?(l=new Uint8Array(n*a*4),c=e.UNSIGNED_BYTE,u=e.RGBA):(l=new Float32Array(n*a*4),c=e.FLOAT,u=o.internalFormatPackedFloat),l.set(i),Je(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,u,n,a,0,e.RGBA,c,l)}),Je(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function npe(e,t,r,n){Je(e,t,function(){return e.bindTexture(e.TEXTURE_2D,r)}),n.data instanceof Uint8Array?Je(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)}):Je(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)}),Je(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function ape(e,t,r,n,a){var i=e.createBuffer();Je(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)});var o=16*r*n;return Je(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)}),Je(e,t,function(){return e.readPixels(0,0,n,r,e.RGBA,e.FLOAT,0)}),Je(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),i}function spe(e,t,r){var n=e,a=new Float32Array(r);return n.bindBuffer(n.PIXEL_PACK_BUFFER,t),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,a),n.bindBuffer(n.PIXEL_PACK_BUFFER,null),a}function ipe(e,t,r,n,a){var i=Sj(r,n),o=i[0],l=i[1],c=new Uint8Array(r*n*4);return Je(e,t,function(){return e.readPixels(0,0,o,l,a.downloadTextureFormat,e.UNSIGNED_BYTE,c)}),new Float32Array(c.buffer)}function ope(e,t,r,n,a,i,o,l){var c=e,u=new Float32Array(function(d,h){var f=Tx(d,h);return f[0]*f[1]*4}(i,o));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,u),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),u}function lpe(e,t,r,n){var a=new Float32Array(r*n*4);return Je(e,t,function(){return e.readPixels(0,0,n,r,e.RGBA,e.FLOAT,a)}),a}var cpe=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var r=fe().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,$de(r,t)):this.gl=Uo(r);var n="WEBGL_color_buffer_float";if(fe().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Hy(this.gl,this.debug,"OES_texture_float"),ti(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Hy(this.gl,this.debug,"OES_texture_half_float");else if(fe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),ti(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Hy(this.gl,this.debug,"EXT_color_buffer_half_float");else if(fe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",ti(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!ti(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=Kfe(this.gl,this.debug),this.indexBuffer=Yfe(this.gl,this.debug),this.framebuffer=Qde(this.gl,this.debug),this.textureConfig=VT(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return fe().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var r=this.gl;Je(r,this.debug,function(){return r.finish()}),Je(r,this.debug,function(){return r.bindFramebuffer(r.FRAMEBUFFER,null)}),Je(r,this.debug,function(){return r.deleteFramebuffer(t.framebuffer)}),Je(r,this.debug,function(){return r.bindBuffer(r.ARRAY_BUFFER,null)}),Je(r,this.debug,function(){return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null)}),Je(r,this.debug,function(){return r.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,r){return this.throwIfDisposed(),Xfe(this.gl,this.debug,t,r,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,r){return this.throwIfDisposed(),Qfe(this.gl,this.debug,t,r,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,r){return this.throwIfDisposed(),Zfe(this.gl,this.debug,t,r,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,r){this.throwIfDisposed(),npe(this.gl,this.debug,t,r)},e.prototype.uploadDenseMatrixToTexture=function(t,r,n,a){this.throwIfDisposed(),rpe(this.gl,this.debug,t,r,n,a,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,r){return this.throwIfDisposed(),epe(this.gl,this.debug,t,r,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,r){return this.throwIfDisposed(),Jfe(this.gl,this.debug,t,r,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var r=this;this.throwIfDisposed(),this.outputTexture===t&&(HM(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Je(this.gl,this.debug,function(){return r.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,r,n){var a=this;return this.downloadMatrixDriver(t,function(){return ipe(a.gl,a.debug,r,n,a.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,r,n,a,i,o){return ope(this.gl,t,0,0,0,i,o,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,r){return spe(this.gl,t,r)},e.prototype.createBufferFromTexture=function(t,r,n){this.bindTextureToFrameBuffer(t);var a=ape(this.gl,this.debug,r,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),a},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var r,n,a=this;if(fe().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,o=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var l=i.clientWaitSync(o,0,0);return l===i.ALREADY_SIGNALED||l===i.CONDITION_SATISFIED},r=o}else fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(r=this.beginQuery(),this.endQuery(),n=function(){return a.isQueryAvailable(r,fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:r,isFencePassed:n}},e.prototype.downloadMatrixFromPackedTexture=function(t,r,n){var a=this;return this.downloadMatrixDriver(t,function(){return lpe(a.gl,a.debug,r,n)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var r=this.gl,n=zde(r,this.debug,t),a=Hfe(r,this.debug),i=qde(r,this.debug);return Je(r,this.debug,function(){return r.attachShader(i,a)}),Je(r,this.debug,function(){return r.attachShader(i,n)}),Gde(r,this.debug,i),this.debug&&v2(r,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=tpe(r,this.debug,this.program,this.vertexBuffer)),i},e.prototype.deleteProgram=function(t){var r=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&Je(this.gl,this.debug,function(){return r.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var r=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&v2(this.gl,this.debug,this.program),Je(this.gl,this.debug,function(){return r.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,r,n){return n===void 0&&(n=!0),this.throwIfDisposed(),n?Jde(this.gl,this.debug,t,r):ehe(this.gl,t,r)},e.prototype.getAttributeLocation=function(t,r){var n=this;return this.throwIfDisposed(),Je(this.gl,this.debug,function(){return n.gl.getAttribLocation(t,r)})},e.prototype.getUniformLocationNoThrow=function(t,r){return this.throwIfDisposed(),this.gl.getUniformLocation(t,r)},e.prototype.setInputMatrixTexture=function(t,r,n){this.throwIfDisposed(),this.throwIfNoProgram(),the(this.gl,this.debug,this.program,t,r,n)},e.prototype.setOutputMatrixTexture=function(t,r,n){this.setOutputMatrixTextureDriver(t,n,r)},e.prototype.setOutputPackedMatrixTexture=function(t,r,n){this.throwIfDisposed();var a=Tx(r,n),i=a[0],o=a[1];this.setOutputMatrixTextureDriver(t,i,o)},e.prototype.setOutputMatrixWriteRegion=function(t,r,n,a){this.setOutputMatrixWriteRegionDriver(n,t,a,r)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,r,n,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&v2(this.gl,this.debug,this.program),Ky(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Je(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Je(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Hy(this.gl,this.debug,fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,r=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(r.TIME_ELAPSED_EXT,n),n}var a=this.getQueryTimerExtensionWebGL1(),i=a.createQueryEXT();return a.beginQueryEXT(a.TIME_ELAPSED_EXT,i),i},e.prototype.endQuery=function(){if(fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var r=this.gl,n=this.getQueryTimerExtensionWebGL2();r.endQuery(n.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return Ye(this,void 0,void 0,function(){var r=this;return Xe(this,function(n){switch(n.label){case 0:return[4,BM(function(){return r.disposed||r.isQueryAvailable(t,fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return n.sent(),[2,this.getQueryTime(t,fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,r){if(r===0)return null;if(r===2){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var a=this.getQueryTimerExtensionWebGL1();return a.getQueryObjectEXT(t,a.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,r){if(r===0)return!0;if(r===2){var n=this.gl,a=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(a=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,a.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint},e.prototype.pollFence=function(t){var r=this;return new Promise(function(n){r.addItemToPoll(function(){return t.isFencePassed()},function(){return n()})})},e.prototype.pollItems=function(){for(var t=function(n){for(var a=0;a<n.length&&n[a]();++a);return a-1}(this.itemsToPoll.map(function(n){return n.isDoneFn})),r=0;r<=t;++r)(0,this.itemsToPoll[r].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,r){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:r}),this.itemsToPoll.length>1||BM(function(){return n.pollItems(),n.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),g2(this.gl,this.debug,t,this.framebuffer),this.debug&&Ky(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(g2(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Ky(this.gl)):HM(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,r){this.bindTextureToFrameBuffer(t);var n=r();return this.unbindTextureToFrameBuffer(),n},e.prototype.setOutputMatrixTextureDriver=function(t,r,n){this.throwIfDisposed();var a=this.gl;g2(a,this.debug,t,this.framebuffer),this.debug&&Ky(a),this.outputTexture=t,Je(a,this.debug,function(){return a.viewport(0,0,r,n)}),Je(a,this.debug,function(){return a.scissor(0,0,r,n)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,r,n,a){var i=this;this.throwIfDisposed(),Je(this.gl,this.debug,function(){return i.gl.scissor(t,r,n,a)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function i3(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(r,n){var a=r.logicalShape,i=t[n],o=i.shape;if(!Gn(a,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+a+" and "+o+" must match");if(!r.isUniform||!i.isUniform){var l=r.texShape,c=i.isUniform?null:i.texData.texShape;if(!Gn(l,c))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+l+" and "+c+" must match")}})}var upe=function(e,t,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n=r.filterWidth,a=r.inChannels,i=r.strideWidth,o=r.strideHeight,l=r.padInfo,c=r.outWidth,u=r.dilationWidth,d=r.dilationHeight,h=r.dataFormat,f=l.left,p=l.top,m=a*n,v=ba(),g=h==="channelsLast",x=g?0:1,y=g?1:2,b="",N=0;N<=1;N++)for(var j=0;j<=1;j++)b+=`
          blockIndex = rc.y + `+j+`;
          pos = rc.x + `+N+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+c+")) * "+o+" - "+p+`;
            d0 = offsetY + `+d+" * (pos / "+m+`);

            if(d0 < `+t[x]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+c+".) * "+i+". - "+f+`.);
              d1 = offsetX + `+u+" * (int(mod(float(pos), "+m+".) / "+a+`.));

              if(d1 < `+t[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+a+`.));

                if (`+g+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*N+j)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*N+j)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+b+`

        `+v.output+` = result;
      }
    `},dpe=function(e,t,r,n,a){this.variableNames=["x"],this.outputShape=[];var i,o=t,l=e[3]-1;this.outputShape=e;var c="float("+r+") + float("+n+") * sum";i=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+o+"; j <= "+o+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+l+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},hpe=function(e,t,r,n,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=r,this.alpha=n,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+n+") * norm + float("+r+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+n+`)
                * float(`+a+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+a+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},fpe=function(e,t,r,n,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,o=t,l=e[3]-1;this.outputShape=e;var c="float("+r+") + float("+n+") * sum";i=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+o+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+o+"; j <= "+o+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+l+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},ppe=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,r=e.strideWidth,n=e.dilationHeight,a=e.effectiveFilterHeight,i=e.effectiveFilterWidth,o=a-1-e.padInfo.top,l=i-1-e.padInfo.left,c=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
          wR += `+n+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+r+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+c+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},mpe=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,r=e.strideHeight,n=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=c-1-e.padInfo.top,f=u-1-e.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(`+d+", "+h+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+l+`;
           wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+c+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+r+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+u+`;
                wC += `+o+`) {
              float dyC = float(dyCCorner + wC) / `+n+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+p+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+c+" * "+u+` +
                  wR * `+u+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},j2=function(e,t,r,n,a,i,o){r===void 0&&(r=!1),n===void 0&&(n=!1),a===void 0&&(a=!1),i===void 0&&(i=null),o===void 0&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var l=r?e[1]:e[2],c=Math.ceil(l/2),u=r?"i * 2, rc.y":"rc.y, i * 2",d=n?"rc.z, i * 2":"i * 2, rc.z",h=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=n?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],p="",m="";i&&(p=o?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,m="result = activation(result);");var v=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+p+`

      const float sharedDimension = `+c+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+c+`; i++) {
          vec4 a = getMatrixA(rc.x, `+u+`);
          vec4 b = getMatrixB(rc.x, `+d+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+h[0]+" * "+f[0]+`);
          result += (`+h[1]+" * "+f[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+v+`

        `+m+`

        setOutput(result);
      }
    `},vpe=function(){function e(t,r,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(r-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(r-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var r=this;return function(n,a){r.seedLoc==null&&(r.seedLoc=n.getUniformLocation(a,"seed")),n.gl.uniform1f(r.seedLoc,t)}},e}(),gpe=function(e,t,r,n){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+n+"), float("+r+`),
                      float(index == coords.y)));
      }
    `},xpe=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var r=ts("rc",t),n=br(t),a=function(l,c,u){if(l===1)return"rc > "+c[0];for(var d="",h=l-2;h<l;h++)d+=u[h]+" >= "+c[h],h<l-1&&(d+="||");return d}(t,e,r),i=function(l,c,u,d){if(l===1)return"";var h=d.slice(-2);return`
    int r = `+h[0]+`;
    int c = `+h[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+c+`;
    bool rEdge = rp1 >= `+u+`;
  `}(t,e[e.length-1],e[e.length-2],r),o=function(l,c){var u=l.length,d=function(h,f){for(var p=[],m=0;m<=1;m++)for(var v=0;v<=1;v++){for(var g=(m===0?"r":"rp1")+", "+(v===0?"c":"cp1"),x=2;x<h;x++)g=f[f.length-1-x]+","+g;p.push(g)}return p}(u,c);return u===1?`getA(rc),
            rc + 1 >= `+l[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+d[0]+`),
          cEdge ? 0. : getA(`+d[1]+`),
          rEdge ? 0. : getA(`+d[2]+`),
          rEdge || cEdge ? 0. : getA(`+d[3]+")"}(e,r);this.userCode=`
        void main() {
          `+n+` rc = getOutputCoords();

          if(`+a+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+o+`));
          }
        }
      `}},ype=function(e,t,r){this.variableNames=["x"],this.outputShape=t.map(function(c,u){return c[0]+e[u]+c[1]});var n=e.length,a=br(n),i=t.map(function(c){return c[0]}).join(","),o=t.map(function(c,u){return c[0]+e[u]}).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n);this.userCode=n!==1?`
      `+a+" start = "+a+"("+i+`);
      `+a+" end = "+a+"("+o+`);

      void main() {
        `+a+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+r+`));
        } else {
          `+a+` coords = outC - start;
          setOutput(getX(`+l+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+o+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+r+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},bpe=function(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(g,x){return g[0]+e[x]+g[1]});for(var n=e.length,a=br(n),i=t.map(function(g){return g[0]}).join(","),o=t.map(function(g,x){return g[0]+e[x]}).join(","),l=ts("rc",n),c=ts("source",n),u=l[n-1]+" < "+this.outputShape[n-1],d=n===1?"source":"vec2("+c.slice(-2).join()+")",h=[a+" rc = outputLoc;",l[n-1]+` += 1;
       if(`+u+`) {
      `,n===1?"":`}
       rc = outputLoc;
       `+l[n-2]+` += 1;
       if(`+l[n-2]+" < "+this.outputShape[n-2]+") {",n===1?"":"  "+l[n-1]+` += 1;
         if(`+u+") {"],f=n===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",m=0,v=n===1?2:4;m<v;m++)p+=`
        `+h[m]+`
        if (`+f+`) {
          result[`+m+"] = float("+r+`);
        } else {
          `+a+` source = rc - start;
          result[`+m+"] = getChannel(getX("+c.join()+"), "+d+`);
        }
      `;p+=n===1?"} ":"}}",this.userCode=`
      const `+a+" start = "+a+"("+i+`);
      const `+a+" end = "+a+"("+o+`);

      void main() {
        `+a+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+p+`
        setOutput(result);
      }
    `},N2=function(e,t,r){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");var n=e.filterWidth,a=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;var f=t==="avg",p="0.0";if(f||(p="-1.0 / 1e-20"),r)this.userCode=`
        const ivec2 strides = ivec2(`+a+", "+i+`);
        const ivec2 pads = ivec2(`+d+", "+h+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+c+`;
              wR += `+o+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+u+`;
                wC += `+l+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+u+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var m=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(m="avgValue / count");var v=4*Math.floor(n/4),g=n%4,x=`
      if (`+f+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+a+", "+i+`);
      const ivec2 pads = ivec2(`+d+", "+h+`);
      const float initializationValue = `+p+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+p+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+c+`;
            wR += `+o+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+v+`; wC += 4) {
            int xC = xCCorner + wC * `+l+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              getValue(batch, xR, xC + 3 * `+l+`, d)
            );

            `+x+`
          }

          int xC = xCCorner + `+v+`;
          if (`+(g===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+x+`
          } else if (`+(g===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              initializationValue,
              initializationValue
            );

            `+x+`
          } else if (`+(g===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              initializationValue
            );

            `+x+`
          }
        }
        setOutput(`+m+`);
      }
    `}},_2=function(e,t,r){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");var n=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=e.padInfo.front,m=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;var g=t==="avg",x="0.0";if(g||(x="-1.0 / 1e-20"),r)this.userCode=`
        const ivec3 strides =
            ivec3(`+a+", "+i+", "+o+`);
        const ivec3 pads = ivec3(`+p+", "+m+", "+v+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+d+`;
              wD += `+l+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+h+`;
                wR += `+c+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+f+`;
                  wC += `+u+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+h+" * "+f+` +
                      wR * `+f+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(y="avgValue / count");var b=4*Math.floor(n/4),N=n%4,j=`
      if (`+g+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+a+", "+i+", "+o+`);
      const ivec3 pads = ivec3(`+p+", "+m+", "+v+`);
      const float initializationValue = `+x+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+x+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`;
            wR += `+c+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+b+`; wC += 4) {
              int xC = xCCorner + wC * `+u+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+u+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+u+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+u+`, ch)
              );

              `+j+`
            }

            int xC = xCCorner + `+b+`;
            if (`+(N===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+j+`
            } else if (`+(N===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+u+`, ch),
                initializationValue,
                initializationValue
              );

              `+j+`
            } else if (`+(N===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+u+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+u+`, ch),
                initializationValue
              );

              `+j+`
            }
          }
          setOutput(`+y+`);
        }
      }
    `}},wpe=function(e,t){this.variableNames=["x"];var r=e.windowSize,n=e.batchSize,a=e.inSize,i=Math.ceil(a/r);this.outputShape=[n,i];var o="0.0",l="";t==="prod"?o="1.0":t==="min"?(o="1.0 / 1e-20",l="min"):t==="max"&&(o="-1.0 / 1e-20",l="max");var c=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?c="sumValue":t==="prod"?c="prodValue":t==="all"?c="allValue":t==="any"&&(c="anyValue");var u=4*Math.floor(r/4),d=r%4,h=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+l+`(values, minMaxValue);
      }
    `,f="vec4";t==="all"?(o="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):t==="any"&&(o="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");var p="";a%r>0&&(p=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+o+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+p+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        vec4 minMaxValue = vec4(`+o+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+u+`; i += 4) {
          int inIdx = inOffset + i;
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+h+`
        }

        int inIdx = inOffset + `+u+`;
        if (`+(d===1)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+h+`
        } else if (`+(d===2)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+h+`
        } else if (`+(d===3)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+h+`
        }
        setOutput(`+c+`);
      }
    `},jpe=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r="",n=0;n<4;n++){var a="thisRC = rc;";n%2==1&&(a+="thisRC.z += 1;"),n>1&&(a+="thisRC.y += 1;"),r+=`
        `+a+`
        `+(n>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+n+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(n>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Ku(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+ZT(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+r+`

        setOutput(result);
      }
    `},Npe=function(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var n=t.shape,a=n[1],i=n[2],o=e.shape,l=o[1],c=o[2],u=[r&&l>1?a-1:a,r&&c>1?i-1:i],d=[r&&l>1?l-1:l,r&&c>1?c-1:c],h=u[0]/d[0],f=u[1]/d[1],p=1/h,m=1/f,v=2*Math.ceil(p)+2,g=2*Math.ceil(m)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+h+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+p+`);
        const float invWidthScale = float(`+m+`);

        const int winHeight = int(`+v+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(a-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},_pe=function(e,t,r,n){this.variableNames=["A"],this.outputShape=[];var a=e[0],i=e[1],o=e[2],l=e[3];this.outputShape=[a,t,r,l];var c=[n&&t>1?i-1:i,n&&r>1?o-1:o],u=[n&&t>1?t-1:t,n&&r>1?r-1:r];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/u[0]+`,
          `+c[1]/u[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},Spe=function(e,t,r,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=e[0],i=e[1],o=e[2],l=e[3];this.outputShape=[a,t,r,l];var c=[n&&t>1?i-1:i,n&&r>1?o-1:o],u=[n&&t>1?t-1:t,n&&r>1?r-1:r];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+c[0]/u[0]+`,
          `+c[1]/u[1]+`,
          `+c[1]/u[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+o+`.0,
                                     `+o+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(l-1)+`;
        bool hasNextRow = coords.z < `+(r-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},Cpe=function(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var n=t.shape,a=n[1],i=n[2],o=e.shape,l=o[1],c=o[2],u=[r&&l>1?a-1:a,r&&c>1?i-1:i],d=[r&&l>1?l-1:l,r&&c>1?c-1:c],h=u[0]/d[0],f=u[1]/d[1],p=1/h,m=1/f,v=2*Math.ceil(p)+2,g=2*Math.ceil(m)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+h+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+p+`);
        const float invWidthScale = float(`+m+`);

        const int winHeight = int(`+v+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float sourceFracRow =
              float(`+u[0]+`) *
                (float(dyR) / float(`+d[0]+`));

            float sourceFracCol =
                float(`+u[1]+`) *
                  (float(dyC) / float(`+d[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+a+`) - 1),
                `+r+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+r+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},Epe=function(e,t,r,n){this.variableNames=["A"],this.outputShape=[];var a=e[0],i=e[1],o=e[2],l=e[3];this.outputShape=[a,t,r,l];var c=[n&&t>1?i-1:i,n&&r>1?o-1:o],u=[n&&t>1?t-1:t,n&&r>1?r-1:r],d=n?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/u[0]+`,
          `+c[1]/u[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+d+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},kpe=function(e,t){this.variableNames=["x"];var r=e.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-"+r+" tensor is not yet supported");if(this.outputShape=e,r!==1){var n=e.map(function(i,o){return function(l){return t.indexOf(l)!==-1&&e[l]!==1?e[l]+" - coords["+l+"] - 1":"coords["+l+"]"}(o)}).join(","),a=br(r);this.userCode=`
      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+n+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},Ape=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=e.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-"+r+" tensor is not yet supported");this.outputShape=e;var n=ts("rc",r),a=n[r-1]+" + 1 < "+this.outputShape[r-1],i=n[r-2]+" + 1 < "+this.outputShape[r-2],o=br(r);function l(c){var u=e.map(function(d,h){return function(f,p){return t.indexOf(f)!==-1&&e[f]!==1?e[f]+" - "+p[f]+" - 1":""+p[f]}(h,c)});return"getChannel(getX("+u.join(",")+"), vec2("+u.slice(-2).join(",")+"))"}this.userCode=r===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+a+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+o+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(c){return l(c)}(n.slice())+`;
          if(`+a+`){
            result.g = `+function(c){return c[r-1]="("+c[r-1]+" + 1)",l(c)}(n.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(c){return c[r-2]="("+c[r-2]+" + 1)",l(c)}(n.slice())+`;
            if(`+a+`) {
              result.a = `+function(c){return c[r-1]="("+c[r-1]+" + 1)",c[r-2]="("+c[r-2]+" + 1)",l(c)}(n.slice())+`;
            }
          }
          setOutput(result);
        }
    `},o3=function(e,t,r,n,a,i,o){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var l=br(a.length),c=br(i.length),u="";r===1?u="i":r===2&&(u="i, j");var d="getIndices("+u+")",h="";n===1?h="i":n===2&&(h="i, coords[1]");var f="getUpdates("+h+")",p=t>1?"strides[j]":"strides";this.userCode=`
        `+l+" strides = "+l+"("+a+`);

        void main() {
          `+c+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+d+`);
              flattenedIndex += index * `+p+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+f+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},Ppe=function(e,t){this.variableNames=["x","segmentIds"];var r=e.windowSize,n=e.batchSize,a=e.inSize,i=e.numSegments,o=i*Math.ceil(a/r);this.outputShape=[n,o];var l=4*Math.floor(r/4),c=r%4,u=`
        sumValue += dot(values, segFilter);
    `,d="";a%r>0&&(d=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `);var h="";a%r>0&&(h=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+d+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+h+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+r+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+u+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+u+`
        } else if (`+(c===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+u+`
        } else if (`+(c===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+u+`
        }
        setOutput(sumValue);
      }
    `},Tpe=function(e,t,r){var n,a;if(this.variableNames=["c","a","b"],this.outputShape=t,r>4)throw Error("Where for rank "+r+" is not yet supported");if(r===1)a="resRC",n="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],l=[],c=0;c<t.length;c++)l.push(""+i[c]),c<e&&o.push(""+i[c]);n=o.join(),a=l.join()}var u=br(r);this.userCode=`
      void main() {
        `+u+` resRC = getOutputCoords();
        float cVal = getC(`+n+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+a+`));
        } else {
          setOutput(getB(`+a+`));
        }
      }
    `},Rpe=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var r,n=br(this.rank),a="uniform int start["+this.rank+"];",i=function(o){if(o===1)return"sourceLoc";if(o<=6)return S2.slice(0,o).map(function(l){return"sourceLoc."+l}).join(",");throw Error("Slicing for rank "+o+" is not yet supported")}(this.rank);r=`
        `+n+` sourceLoc;
        `+n+` coords = getOutputCoords();
        `+t.map(function(o,l){return"sourceLoc."+S2[l]+" = start["+l+"] + coords."+S2[l]+";"}).join(`
`)+`
      `,this.userCode=`
      `+a+`
      void main() {
        `+r+`
        setOutput(getSource(`+i+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var r=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,a){r.startLoc==null&&(r.startLoc=n.getUniformLocationNoThrow(a,"start"),r.startLoc==null)||n.gl.uniform1iv(r.startLoc,t)}},e}(),S2=["x","y","z","w","u","v"],Ope=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var r=br(this.rank),n=ts("coords",this.rank),a=ts("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+a.slice(-2).join()+")",o="getChannel(getSource("+a.join()+"), "+i+")",l=`
      result.x = `+o+`;
      if (++`+n[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+a[this.rank-1]+`;
        result.y = `+o+`;
        --`+a[this.rank-1]+`;
      }
    `,c=this.rank===1?"":`
      --`+n[this.rank-1]+`;
      if (++`+n[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+a[this.rank-2]+`;
        result.z = `+o+`;
        if (++`+n[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+a[this.rank-1]+`;
          result.w = `+o+`;
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            `+r+"("+t.map(function(d,h){return"start["+h+"]"}).join()+");":t.map(function(d,h){return a[h]+" = "+n[h]+" + start["+h+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+r+` coords = getOutputCoords();
        `+r+` sourceLoc;
        `+u+`
        vec4 result = vec4(0.);
        `+l+`
        `+c+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var r=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,a){r.startLoc==null&&(r.startLoc=n.getUniformLocationNoThrow(a,"start"),r.startLoc==null)||n.gl.uniform1iv(r.startLoc,t)}},e}(),Ipe=function(e,t,r){this.variableNames=["x"],this.outputShape=r;var n=r.length,a=br(r.length),i=br(r.length),o="";if(n===1)o="coords * strides + begin";else{var l=0;o=r.map(function(c,u){return l++,r.length===1?"coords * strides["+u+"] + begin["+u+"]":"coords["+(l-1)+"] * strides["+u+"] + begin["+u+"]"}).join(",")}this.userCode=`
      `+a+" begin = "+a+"("+e+`);
      `+a+" strides = "+a+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+o+`));
      }
    `},Dpe=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,r,n){var a,i=l3(r,n),o=c3(t,i,n);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var l=this.freeTextures[o].shift();return this.usedTextures[o].push(l),l}return this.numUsedTextures++,this.log(),i===Ns.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Ns.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Ns.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Ns.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Ns.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(a),a},e.prototype.releaseTexture=function(t,r,n,a){if(this.freeTextures!=null){var i=c3(r,l3(n,a),a);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[i],l=o.indexOf(t);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(l,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var r in this.freeTextures)this.freeTextures[r].forEach(function(n){t.gpgpu.deleteMatrixTexture(n)});for(var r in this.usedTextures)this.usedTextures[r].forEach(function(a){t.gpgpu.deleteMatrixTexture(a)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function l3(e,t){if(e===ks.UPLOAD)return Ns.PACKED_2X2_FLOAT32;if(e===ks.RENDER||e==null)return function(r){return fe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?r?Ns.PACKED_2X2_FLOAT32:Ns.UNPACKED_FLOAT32:r?Ns.PACKED_2X2_FLOAT16:Ns.UNPACKED_FLOAT16}(t);if(e===ks.DOWNLOAD||e===ks.PIXELS)return Ns.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function c3(e,t,r){return e[0]+"_"+e[1]+"_"+t+"_"+r}var Mpe=function(e,t){this.variableNames=["A"];for(var r=new Array(e.length),n=0;n<r.length;n++)r[n]=e[n]*t[n];this.outputShape=r,this.rank=r.length;var a=br(this.rank),i=function(o){var l=o.length;if(l>5)throw Error("Tile for rank "+l+" is not yet supported");if(l===1)return"imod(resRC, "+o[0]+")";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],u=[],d=0;d<o.length;d++)u.push("imod("+c[d]+", "+o[d]+")");return u.join()}(e);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},$pe=function(e,t){this.variableNames=["A"];for(var r=new Array(e.length),n=0;n<r.length;n++)r[n]=e[t[n]];this.outputShape=r,this.rank=r.length;var a=br(this.rank),i=function(o){var l=o.length;if(l>6)throw Error("Transpose for rank "+l+" is not yet supported");for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],u=new Array(l),d=0;d<o.length;d++)u[o[d]]=c[d];return u.join()}(t);this.userCode=`
    void main() {
      `+a+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},Fpe=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(e.length),n=0;n<r.length;n++)r[n]=e[t[n]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=br(this.rank),i=tq("rc",this.rank),o=new Array(this.rank);for(n=0;n<t.length;n++)o[t[n]]=i[n];var l="vec2("+o.slice(-2).join()+")",c="++"+i[this.rank-1]+" < "+r[this.rank-1],u="getChannel(getA("+o.join()+"), "+l+")";this.userCode=`
    void main() {
      `+a+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+u+`;
      if(`+c+`) {
        result[1] = `+u+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+r[this.rank-2]+`) {
        result[2] = `+u+`;
        if(`+c+`) {
          result[3] = `+u+`;
        }
      }
      setOutput(result);
    }
    `},JT=1.7580993408473768,eR=1.0507009873554805,Nt=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},eo="if (isnan(x)) return x;",Lpe="return x;",u3="return abs(x);",iq=eo+`
  return (x < 0.0) ? 0.0 : x;
`,oq=eo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,lq="return (x >= 0.0) ? x : (exp(x) - 1.0);",Bpe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+JT+`;
  float scale = `+eR+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,d3="return -x;",h3="return ceil(x);",f3="return floor(x);",p3="return exp(x);",m3="return exp(x) - 1.0;",Upe=eo+`
  return sin(x);
`,Vpe=eo+`
  return cos(x);
`,zpe=eo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Wpe=eo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,qpe=eo+`
  return atan(x);
`,Gpe=eo+"return log(x + sqrt(x * x + 1.0));",Hpe=eo+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,Kpe=eo+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Zy="return x;",Ype="return x;",cq=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,uq=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,dq=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Bm=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},Xpe=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,r=ts("rc",t),n=br(t),a=function(l,c){if(l===1)return"rc";for(var u="",d=0;d<l;d++)u+=c[d],d<l-1&&(u+=",");return u}(t,r),i=r.slice(-2),o=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+n+` rc = getOutputCoords();
        vec4 packedInput = getA(`+a+`);

        setOutput(getChannel(packedInput, `+o+`));
      }
    `},Jy={};function eb(e,t){if(t===void 0&&(t=!1),e==="linear")return t?Ype:Lpe;if(e==="relu")return t?cq:iq;if(e==="elu")return t?dq:lq;if(e==="relu6")return t?uq:oq;if(e==="prelu")return t?sq:aq;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var Qpe=600,Zpe=function(e){function t(r){var n,a=e.call(this)||this;if(a.pendingRead=new WeakMap,a.pendingDisposal=new WeakSet,a.dataRefCount=new WeakMap,a.numBytesInGPU=0,a.uploadWaitMs=0,a.downloadWaitMs=0,a.warnedAboutMemory=!1,a.pendingDeletes=0,a.disposed=!1,!fe().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(r==null){var i=Uo(fe().getNumber("WEBGL_VERSION"));a.binaryCache=((n=fe().getNumber("WEBGL_VERSION"))in Jy||(Jy[n]={}),Jy[n]),a.gpgpu=new cpe(i),a.canvas=i.canvas,a.gpgpuCreatedLocally=!0}else a.gpgpu=r,a.binaryCache={},a.gpgpuCreatedLocally=!1,a.canvas=r.gl.canvas;return a.textureManager=new Dpe(a.gpgpu),a.numMBBeforeWarning=fe().global.screen==null?1024:fe().global.screen.height*fe().global.screen.width*window.devicePixelRatio*Qpe/1024/1024,a.texData=new GW(a,J),a}return Ji(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(r,n,a){if(fe().getBool("DEBUG")&&this.checkNumericalProblems(r),a==="complex64"&&r!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:n,dtype:a,values:r,usage:ks.UPLOAD}),i},t.prototype.move=function(r,n,a,i){if(fe().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(r,{shape:a,dtype:i,values:n,usage:ks.UPLOAD})},t.prototype.readSync=function(r){var n=this.texData.get(r),a=n.values,i=n.dtype,o=n.complexTensors,l=n.slice,c=n.shape,u=n.isPacked;if(l!=null){var d=void 0;d=u?new Bm(c,Zy):new Nt(c,Zy);var h=this.runWebGLProgram(d,[{dataId:r,shape:c,dtype:i}],i),f=this.readSync(h.dataId);return this.disposeData(h.dataId),f}if(a!=null)return this.convertAndCacheOnCPU(r);if(i==="string")return a;var p,m,v=this.activeTimers!=null;return v&&(p=fo()),i==="complex64"?m=PE(o.real.dataSync(),o.imag.dataSync()):m=this.getValuesFromTexture(r),v&&(this.downloadWaitMs+=fo()-p),this.convertAndCacheOnCPU(r,m)},t.prototype.read=function(r){return Ye(this,void 0,void 0,function(){var n,a,i,o,l,c,u,d,h,f,p,m,v,g,x,y,b,N,j,_,S,C;return Xe(this,function(E){switch(E.label){case 0:if(this.pendingRead.has(r))return n=this.pendingRead.get(r),[2,new Promise(function(k){return n.push(k)})];if(a=this.texData.get(r),i=a.values,o=a.shape,l=a.slice,c=a.dtype,u=a.complexTensors,d=a.isPacked,l!=null)return h=void 0,h=d?new Bm(o,Zy):new Nt(o,Zy),f=this.runWebGLProgram(h,[{dataId:r,shape:o,dtype:c}],c),p=this.read(f.dataId),this.disposeData(f.dataId),[2,p];if(i!=null)return[2,this.convertAndCacheOnCPU(r)];if(!fe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&fe().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return m=null,c!=="complex64"&&fe().get("WEBGL_BUFFER_SUPPORTED")&&(v=this.decode(r),g=this.texData.get(v.dataId),m=(C=this.gpgpu).createBufferFromTexture.apply(C,[g.texture].concat(Av(o)))),this.pendingRead.set(r,[]),c==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:E.sent(),E.label=2;case 2:return c!=="complex64"?[3,4]:[4,Promise.all([u.real.data(),u.imag.data()])];case 3:return y=E.sent(),b=y[0],N=y[1],x=PE(b,N),[3,5];case 4:m==null?x=this.getValuesFromTexture(r):(j=Qe(o),x=this.gpgpu.downloadFloat32MatrixFromBuffer(m,j)),E.label=5;case 5:return v!=null&&this.disposeData(v.dataId),_=this.convertAndCacheOnCPU(r,x),S=this.pendingRead.get(r),this.pendingRead.delete(r),S.forEach(function(k){return k(_)}),this.pendingDisposal.has(r)&&(this.pendingDisposal.delete(r),this.disposeData(r),this.pendingDeletes--),[2,_]}})})},t.prototype.checkNumericalProblems=function(r){if(r!=null)for(var n=0;n<r.length;n++){var a=r[n];if(!Bde(a))throw fe().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+a+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+a+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(r){var n,a=this.texData.get(r),i=a.shape,o=a.dtype,l=a.isPacked,c=Qe(i);if(fe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var u=this.decode(r),d=this.texData.get(u.dataId),h=(n=this.gpgpu).downloadMatrixFromPackedTexture.apply(n,[d.texture].concat(Av(i))).subarray(0,c);return this.disposeData(u.dataId),h}var f=fe().getBool("WEBGL_PACK")&&l===!0,p=f?x2(i):i,m=f?new Lfe(p):new Ffe(p),v=this.runWebGLProgram(m,[{shape:p,dtype:o,dataId:r}],"float32"),g=this.texData.get(v.dataId),x=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(g.texture,g.texShape[0],g.texShape[1]).subarray(0,c);return this.disposeData(v.dataId),x},t.prototype.time=function(r){return Ye(this,void 0,void 0,function(){var n,a,i,o,l,c,u;return Xe(this,function(d){switch(d.label){case 0:return n=this.activeTimers,a=[],i=!1,this.programTimersStack==null?(this.programTimersStack=a,i=!0):this.activeTimers.push(a),this.activeTimers=a,r(),o=Jf(this.activeTimers.map(function(h){return h.query})).filter(function(h){return h!=null}),l=Jf(this.activeTimers.map(function(h){return h.name})).filter(function(h){return h!=null}),this.activeTimers=n,i&&(this.programTimersStack=null),c={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(o)]:[3,2];case 1:return u=d.sent(),c.kernelMs=bde(u),c.getExtraProfileInfo=function(){return u.map(function(h,f){return{name:l[f],ms:h}}).map(function(h){return h.name+": "+h.ms}).join(", ")},[3,3];case 2:c.kernelMs={error:"WebGL query timers are not supported in this environment."},d.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,c]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:fo(),endMs:null}},t.prototype.endTimer=function(r){return fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),r):(r.endMs=fo(),r)},t.prototype.getQueryTime=function(r){return Ye(this,void 0,void 0,function(){var n;return Xe(this,function(a){return fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(r)]:[2,(n=r).endMs-n.startMs]})})},t.prototype.disposeData=function(r){if(!this.pendingDisposal.has(r)){if(this.pendingRead.has(r))return this.pendingDisposal.add(r),void this.pendingDeletes++;if(this.texData.has(r)){this.releaseGPUData(r);var n=this.texData.get(r).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.texData.delete(r)}}},t.prototype.releaseGPUData=function(r){var n=this.texData.get(r),a=n.texture,i=n.dtype,o=n.texShape,l=n.usage,c=n.isPacked,u=n.slice,d=u&&u.origDataId||r,h=this.dataRefCount.get(d);h>1?this.dataRefCount.set(d,h-1):(this.dataRefCount.delete(d),a!=null&&(this.numBytesInGPU-=this.computeBytes(o,i),this.textureManager.releaseTexture(a,o,l,c)));var f=this.texData.get(r);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null},t.prototype.getTexture=function(r){return this.uploadToGPU(r),this.texData.get(r).texture},t.prototype.getDataInfo=function(r){return this.texData.get(r)},t.prototype.getCPUBackend=function(){return fe().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=J.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(r,n){var a=this;return n===void 0&&(n=128),this.getCPUBackend()!=null&&r.every(function(i){return a.texData.get(i.dataId).texture==null&&i.size<n})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(r,n){var a=this.makeOutput(r.shape,"complex64");return this.texData.get(a.dataId).complexTensors={real:J.keep(r.clone()),imag:J.keep(n.clone())},a},t.prototype.real=function(r){return this.texData.get(r.dataId).complexTensors.real.clone()},t.prototype.imag=function(r){return this.texData.get(r.dataId).complexTensors.imag.clone()},t.prototype.slice=function(r,n,a){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.slice(r,n,a);if(Qe(a)===0)return ra([],a,r.dtype);var i=this.texData.get(r.dataId).isPacked,o=WW(r.shape,n,a);if(i||!o){var l=fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ope(a):new Rpe(a),c=l.getCustomSetupFunc(n);return this.compileAndRun(l,[r],null,c)}return this.uploadToGPU(r.dataId),this.shallowSlice(r,n,a)},t.prototype.shallowSlice=function(r,n,a){var i=this.texData.get(r.dataId),o=this.makeOutput(a,r.dtype),l=this.texData.get(o.dataId);Object.assign(l,i),l.shape=a,l.dtype=r.dtype;var c=qW(n,r.strides);i.slice&&(c+=i.slice.flatOffset),l.slice={flatOffset:c,origDataId:i.slice&&i.slice.origDataId||r.dataId};var u=this.dataRefCount.get(l.slice.origDataId)||1;return this.dataRefCount.set(l.slice.origDataId,u+1),o},t.prototype.stridedSlice=function(r,n,a,i){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.stridedSlice(r,n,a,i);var o=HT(n,a,i);if(o.some(function(c){return c===0}))return ra([],o);var l=new Ipe(n,i,o);return this.compileAndRun(l,[r])},t.prototype.reverse=function(r,n){var a=fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ape(r.shape,n):new kpe(r.shape,n);return this.compileAndRun(a,[r])},t.prototype.concat=function(r,n){if(r[0].dtype==="complex64"){var a=r.map(function(p){return Zs(p)}),i=r.map(function(p){return vo(p)});return ea(this.concat(a,n),this.concat(i,n))}if(this.shouldExecuteOnCPU(r))return this.cpuBackend.concat(r,n);if(r.length===1)return r[0];if(r.length>fe().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(r.length/2),l=this.concat(r.slice(0,o),n),c=this.concat(r.slice(o),n);return this.concat([l,c],n)}if(fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&r[0].rank>1){var u=new _fe(r.map(function(p){return p.shape}),n);return this.compileAndRun(u,r)}var d=tp(r.map(function(p){return p.shape}),n),h=r.map(function(p){return p.as2D(-1,Qe(p.shape.slice(n)))}),f=new Nfe(h.map(function(p){return p.shape}));return this.compileAndRun(f,h).reshape(d)},t.prototype.neg=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.neg(r);if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,d3,r.dtype);var n=new Nt(r.shape,d3);return this.compileAndRun(n,[r])},t.prototype.batchMatMul=function(r,n,a,i){var o=a?r.shape[2]:r.shape[1],l=i?n.shape[1]:n.shape[2],c=a?r.shape[1]:r.shape[2],u=r.shape[0];if((o===1||l===1)&&c>1e3){a&&(r=r.transpose([0,2,1])),i&&(n=n.transpose([0,2,1]));var d=l===1?r:r.as3D(u,c,1),h=l===1?2:1,f=l===1?n.as3D(u,1,c):n;return this.multiply(d,f).sum(h,!0)}var p=ta(r.dtype,n.dtype),m=new j2(r.shape,[u,o,l],a,i);return this.compileAndRun(m,[r,n],p)},t.prototype.fusedBatchMatMul=function(r){var n=r.a,a=r.b,i=r.transposeA,o=r.transposeB,l=r.bias,c=r.activation,u=r.preluActivationWeights,d=i?n.shape[2]:n.shape[1],h=o?a.shape[1]:a.shape[2],f=n.shape[0],p=ta(n.dtype,a.dtype),m=l!=null,v=u!=null,g=c?eb(c,!0):null,x=new j2(n.shape,[f,d,h],i,o,m,g,v),y=[n,a];return l&&y.push(l),u&&y.push(u),this.compileAndRun(x,y,p)},t.prototype.multiply=function(r,n){if(r.dtype==="complex64"){var a=this.texData.get(r.dataId),i=this.texData.get(n.dataId),o=new JM(xfe,r.shape,n.shape),l=new JM(yfe,r.shape,n.shape),c=[this.makeComplexComponentTensorInfo(r,a.complexTensors.real),this.makeComplexComponentTensorInfo(r,a.complexTensors.imag),this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag)],u=this.compileAndRun(o,c),d=this.compileAndRun(l,c),h=this.complex(u,d);return u.dispose(),d.dispose(),h}if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.multiply(r,n);if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,e3,r.dtype);var f=new zr(e3,r.shape,n.shape);return this.compileAndRun(f,[r,n],r.dtype)},t.prototype.batchNormalization=function(r,n,a,i,o,l){var c=[r,n,a],u=null;l!=null&&(u=l.shape,c.push(l));var d=null;if(o!=null&&(d=o.shape,c.push(o)),fe().getBool("WEBGL_PACK_NORMALIZATION")){var h=new gfe(r.shape,n.shape,a.shape,u,d,i);return this.compileAndRun(h,c)}var f=new vfe(r.shape,n.shape,a.shape,u,d,i);return this.compileAndRun(f,c)},t.prototype.localResponseNormalization4D=function(r,n,a,i,o){var l=fe().getBool("WEBGL_PACK_NORMALIZATION")?new fpe(r.shape,n,a,i,o):new dpe(r.shape,n,a,i,o);return this.compileAndRun(l,[r])},t.prototype.LRNGrad=function(r,n,a,i,o,l,c){var u=new hpe(n.shape,i,o,l,c);return this.compileAndRun(u,[n,a,r])},t.prototype.tile=function(r,n){if(r.dtype==="string"){var a=this.readSync(r.dataId).map(function(o){return G0(o)});return JW(yt(r.shape,r.dtype,a),n)}var i=new Mpe(r.shape,n);return this.compileAndRun(i,[r])},t.prototype.pad=function(r,n,a){var i=fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new bpe(r.shape,n,a):new ype(r.shape,n,a);return this.compileAndRun(i,[r])},t.prototype.transpose=function(r,n){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.transpose(r,n);var a=fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Fpe(r.shape,n):new $pe(r.shape,n);return this.compileAndRun(a,[r])},t.prototype.gather=function(r,n,a){if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.gather(r,n,a);var i=new qfe(r.shape,n.size,a);return this.compileAndRun(i,[r,n])},t.prototype.batchToSpaceND=function(r,n,a){z(r.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=n.reduce(function(h,f){return h*f}),o=Z0(r.shape,n,i),l=J0(o.length,n.length),c=ew(r.shape,n,i),u=BW(a,n.length),d=UW(c,a,n.length);return r.reshape(o).transpose(l).reshape(c).slice(u,d)},t.prototype.spaceToBatchND=function(r,n,a){z(r.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=n.reduce(function(f,p){return f*p}),o=[[0,0]];o.push.apply(o,a);for(var l=1+n.length;l<r.shape.length;++l)o.push([0,0]);var c=r.pad(o),u=Z0(c.shape,n,i,!1),d=J0(u.length,n.length,!1),h=ew(c.shape,n,i,!1);return c.reshape(u).transpose(d).reshape(h)},t.prototype.reduce=function(r,n,a){var i=r.shape[0],o=r.shape[1],l=y2(o),c=new wpe({windowSize:l,inSize:o,batchSize:i},n),u=this.compileAndRun(c,[r],a);return u.shape[1]===1?u:this.reduce(u,n,a)},t.prototype.argReduce=function(r,n,a){a===void 0&&(a=null);var i=r.shape[0],o=r.shape[1];a!=null&&(i=a.shape[0],o=a.shape[1]);var l=y2(o),c=new ofe({windowSize:l,inSize:o,batchSize:i},n,a==null),u=[r];a!=null&&u.push(a);var d=this.compileAndRun(c,u,"int32");return d.shape[1]===1?d:this.argReduce(r,n,d)},t.prototype.argReducePacked=function(r,n,a){a===void 0&&(a=null);var i=a!=null?a.shape:r.shape,o=y2(i[i.length-1]),l=new ffe(i,o,n,a==null),c=a==null?[r]:[r,a],u=this.compileAndRun(l,c,"int32");return u.rank===r.rank?this.argReducePacked(r,n,u):u},t.prototype.sum=function(r,n){bs("sum",n,r.rank);var a=ma(r.shape,n),i=a[0],o=Qe(a[1]),l=r.as2D(-1,o),c=d2(r.dtype);return this.reduce(l,"sum",c).reshape(i)},t.prototype.prod=function(r,n){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.prod(r,n);var a=ma(r.shape,n),i=a[0],o=Qe(a[1]),l=r.as2D(-1,o),c=d2(r.dtype);return this.reduce(l,"prod",c).reshape(i)},t.prototype.unsortedSegmentSum=function(r,n,a){var i=0,o=Vo([i],r.rank),l=r;o!=null&&(l=r.transpose(o),i=zo(1,r.rank)[0]);var c=function(p,m,v){for(var g=[],x=p.length,y=0;y<x;y++)y!==m?g.push(p[y]):g.push(v);return g}(l.shape,i,a),u=Qe([l.shape[i]]),d=l.as2D(-1,u),h=d2(r.dtype),f=this.segOpCompute(d,"unsortedSegmentSum",n,h,a).reshape(c);return o!=null&&(f=f.transpose(zT(o))),f},t.prototype.segOpCompute=function(r,n,a,i,o){var l=r.shape[0],c=r.shape[1],u=function(f,p){var m,v=!1;for(f<=zW?(m=f,v=!0):m=wE(f,Math.floor(Math.sqrt(f)));!v;)m>p||m===f?v=!0:m=wE(f,m+1);return m}(c,o),d=new Ppe({windowSize:u,inSize:c,batchSize:l,numSegments:o}),h=this.compileAndRun(d,[r,a],i);return h.shape[1]===o?h:(a=Q0(0,o).tile([c/u]),this.segOpCompute(h,n,a,i,o))},t.prototype.argMinMaxReduce=function(r,n,a){var i=[n];if(bs("arg"+a.charAt(0).toUpperCase()+a.slice(1),i,r.rank),!fe().getBool("WEBGL_PACK_REDUCE")||r.rank<=2){var o=ma(r.shape,i),l=o[0],c=Qe(o[1]),u=r.as2D(-1,c);return this.argReduce(u,a).reshape(l)}return this.argReducePacked(r,a)},t.prototype.argMin=function(r,n){return this.argMinMaxReduce(r,n,"min")},t.prototype.argMax=function(r,n){return this.argMinMaxReduce(r,n,"max")},t.prototype.cumsum=function(r,n,a,i){if(n!==r.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(r.rank-1)+" but got axis="+n);var o=new Ofe(r.shape,a,i);return this.compileAndRun(o,[r])},t.prototype.equal=function(r,n){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return vec4(equal(a, b));
`,"bool");var a=new zr("return float(a == b);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},t.prototype.notEqual=function(r,n){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return vec4(notEqual(a, b));
`,"bool");var a=new zr("return float(a != b);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},t.prototype.less=function(r,n){if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.less(r,n);if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return vec4(lessThan(a, b));
`,"bool");var a=new zr("return float(a < b);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},t.prototype.lessEqual=function(r,n){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return vec4(lessThanEqual(a, b));
`,"bool");var a=new zr("return float(a <= b);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},t.prototype.greater=function(r,n){if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.greater(r,n);if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return vec4(greaterThan(a, b));
`,"bool");var a=new zr("return float(a > b);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},t.prototype.greaterEqual=function(r,n){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var a=new zr("return float(a >= b);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},t.prototype.logicalNot=function(r){var n=new Nt(r.shape,"return float(!(x >= 1.0));");return this.compileAndRun(n,[r])},t.prototype.logicalAnd=function(r,n){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var a=new zr("return float(a >= 1.0 && b >= 1.0);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},t.prototype.logicalOr=function(r,n){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var a=new zr("return float(a >= 1.0 || b >= 1.0);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},t.prototype.select=function(r,n,a){var i=new Tpe(r.rank,n.shape,n.rank);return this.compileAndRun(i,[r,n,a],ta(n.dtype,a.dtype))},t.prototype.where=function(r){Y0("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var n=r.dataSync();return QT(r.shape,n)},t.prototype.topk=function(r,n,a){return eq(r.dataSync(),r.shape,r.dtype,n)},t.prototype.min=function(r,n){bs("min",n,r.rank);var a=ma(r.shape,n),i=a[0],o=Qe(a[1]),l=r.as2D(-1,o);return this.reduce(l,"min",l.dtype).reshape(i)},t.prototype.minimum=function(r,n){if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.minimum(r,n);var a=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Jo(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,r.shape,n.shape):new zr(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,r.shape,n.shape);return this.compileAndRun(a,[r,n])},t.prototype.mod=function(r,n){var a=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Jo(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,r.shape,n.shape):new zr(`if (b == 0.0) return NAN;
  return mod(a, b);`,r.shape,n.shape);return this.compileAndRun(a,[r,n])},t.prototype.max=function(r,n){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.max(r,n);bs("max",n,r.rank);var a=ma(r.shape,n),i=a[0],o=Qe(a[1]),l=r.as2D(-1,o);return this.reduce(l,"max",l.dtype).reshape(i)},t.prototype.maximum=function(r,n){if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.maximum(r,n);var a=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Jo(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,r.shape,n.shape):new zr(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,r.shape,n.shape);return this.compileAndRun(a,[r,n])},t.prototype.all=function(r,n){bs("all",n,r.rank);var a=ma(r.shape,n),i=a[0],o=Qe(a[1]),l=r.as2D(-1,o);return this.reduce(l,"all",l.dtype).reshape(i)},t.prototype.any=function(r,n){bs("any",n,r.rank);var a=ma(r.shape,n),i=a[0],o=Qe(a[1]),l=r.as2D(-1,o);return this.reduce(l,"any",l.dtype).reshape(i)},t.prototype.realDivide=function(r,n){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var a=new zr(`
if (a == b) {
  return 1.0;
};
return a / b;`,r.shape,n.shape);return this.compileAndRun(a,[r,n],"float32")},t.prototype.floorDiv=function(r,n){if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var a=new zr(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,r.shape,n.shape);return this.compileAndRun(a,[r,n],"int32")},t.prototype.add=function(r,n){if(r.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(r,n,b2);if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.add(r,n);var a=ta(r.dtype,n.dtype);if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,b2,a);var i=new zr(b2,r.shape,n.shape);return this.compileAndRun(i,[r,n],a)},t.prototype.packedUnaryOp=function(r,n,a){var i=new Bm(r.shape,n);return this.compileAndRun(i,[r],a)},t.prototype.packedBinaryOp=function(r,n,a,i,o){o===void 0&&(o=!1);var l=new Jo(a,r.shape,n.shape,o);return this.compileAndRun(l,[r,n],i)},t.prototype.complexSeparableBinaryOp=function(r,n,a){var i=this,o=this.texData.get(r.dataId),l=this.texData.get(n.dataId),c=[[o.complexTensors.real,l.complexTensors.real],[o.complexTensors.imag,l.complexTensors.imag]].map(function(f){var p=f[0],m=f[1],v=i.makeComplexComponentTensorInfo(r,p),g=i.makeComplexComponentTensorInfo(n,m),x=new zr(a,r.shape,n.shape);return i.compileAndRun(x,[v,g],ta(p.dtype,m.dtype))}),u=c[0],d=c[1],h=this.complex(u,d);return u.dispose(),d.dispose(),h},t.prototype.makeComplexComponentTensorInfo=function(r,n){return{dataId:n.dataId,dtype:n.dtype,shape:r.shape}},t.prototype.addN=function(r){if(r.length===1)return r[0];if(r.length>fe().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var n=Math.floor(r.length/2),a=this.addN(r.slice(0,n)),i=this.addN(r.slice(n));return this.addN([a,i])}var o=r.map(function(u){return u.dtype}).reduce(function(u,d){return ta(u,d)}),l=r.map(function(u){return u.shape}),c=fe().getBool("WEBGL_PACK")?new ife(r[0].shape,l):new sfe(r[0].shape,l);return this.compileAndRun(c,r,o)},t.prototype.subtract=function(r,n){if(r.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(r,n,w2);if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.subtract(r,n);var a=ta(r.dtype,n.dtype);if(fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,w2,r.dtype);var i=new zr(w2,r.shape,n.shape);return this.compileAndRun(i,[r,n],a)},t.prototype.pow=function(r,n){var a=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Jo(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,r.shape,n.shape):new zr(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,r.shape,n.shape),i=ta(r.dtype,n.dtype);return this.compileAndRun(a,[r,n],i)},t.prototype.ceil=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.ceil(r);if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,h3,r.dtype);var n=new Nt(r.shape,h3);return this.compileAndRun(n,[r])},t.prototype.floor=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.floor(r);if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,f3,r.dtype);var n=new Nt(r.shape,f3);return this.compileAndRun(n,[r])},t.prototype.sign=function(r){var n=new Nt(r.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(n,[r])},t.prototype.isNaN=function(r){var n=new Nt(r.shape,"return float(isnan(x));");return this.compileAndRun(n,[r],"bool")},t.prototype.isInf=function(r){var n=new Nt(r.shape,"return float(isinf(x));");return this.compileAndRun(n,[r],"bool")},t.prototype.isFinite=function(r){var n=new Nt(r.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(n,[r],"bool")},t.prototype.round=function(r){var n=new Nt(r.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(n,[r])},t.prototype.exp=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.exp(r);if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,p3,r.dtype);var n=new Nt(r.shape,p3);return this.compileAndRun(n,[r])},t.prototype.expm1=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.expm1(r);if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,m3,r.dtype);var n=new Nt(r.shape,m3);return this.compileAndRun(n,[r])},t.prototype.softmax=function(r,n){var a=$n([n],r.shape),i=this.max(r,a),o=ls(i.shape,a),l=this.subtract(r,i.reshape(o)),c=this.exp(l),u=this.sum(c,a).reshape(o);return this.realDivide(c,u)},t.prototype.log=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.log(r);if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,r.dtype);var n=new Nt(r.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(n,[r])},t.prototype.log1p=function(r){var n=new Nt(r.shape,"return log(1.0 + x);");return this.compileAndRun(n,[r])},t.prototype.sqrt=function(r){var n=new Nt(r.shape,"return sqrt(x);");return this.compileAndRun(n,[r])},t.prototype.rsqrt=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.rsqrt(r);var n=new Nt(r.shape,"return inversesqrt(x);");return this.compileAndRun(n,[r])},t.prototype.reciprocal=function(r){var n=new Nt(r.shape,"return 1.0 / x;");return this.compileAndRun(n,[r])},t.prototype.relu=function(r){var n;return n=fe().getBool("WEBGL_PACK")?new Bm(r.shape,cq):new Nt(r.shape,iq),this.compileAndRun(n,[r])},t.prototype.relu6=function(r){var n;return n=fe().getBool("WEBGL_PACK")?new Bm(r.shape,uq):new Nt(r.shape,oq),this.compileAndRun(n,[r])},t.prototype.prelu=function(r,n){var a=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Jo(sq,r.shape,n.shape):new zr(aq,r.shape,n.shape);return this.compileAndRun(a,[r,n])},t.prototype.elu=function(r){if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,dq,r.dtype);var n=new Nt(r.shape,lq);return this.compileAndRun(n,[r])},t.prototype.eluDer=function(r,n){var a=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Jo(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,r.shape,n.shape):new zr("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,n.shape);return this.compileAndRun(a,[r,n])},t.prototype.selu=function(r){var n=new Nt(r.shape,Bpe);return this.compileAndRun(n,[r])},t.prototype.int=function(r){var n=new Nt(r.shape,"return float(int(x));");return this.compileAndRun(n,[r],"int32")},t.prototype.clip=function(r,n,a){var i,o=(i=fe().getBool("WEBGL_PACK_CLIP")?new wfe(r.shape):new bfe(r.shape)).getCustomSetupFunc(n,a);return this.compileAndRun(i,[r],null,o)},t.prototype.abs=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.abs(r);if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,u3,r.dtype);var n=new Nt(r.shape,u3);return this.compileAndRun(n,[r])},t.prototype.complexAbs=function(r){var n=this.texData.get(r.dataId),a=new jfe(r.shape),i=[this.makeComplexComponentTensorInfo(r,n.complexTensors.real),this.makeComplexComponentTensorInfo(r,n.complexTensors.imag)];return this.compileAndRun(a,i)},t.prototype.sigmoid=function(r){var n=new Nt(r.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(n,[r])},t.prototype.softplus=function(r){var n=new Nt(r.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(n,[r])},t.prototype.sin=function(r){var n=new Nt(r.shape,Upe);return this.compileAndRun(n,[r])},t.prototype.cos=function(r){var n=new Nt(r.shape,Vpe);return this.compileAndRun(n,[r])},t.prototype.tan=function(r){var n=new Nt(r.shape,"return tan(x);");return this.compileAndRun(n,[r])},t.prototype.asin=function(r){var n=new Nt(r.shape,zpe);return this.compileAndRun(n,[r])},t.prototype.acos=function(r){var n=new Nt(r.shape,Wpe);return this.compileAndRun(n,[r])},t.prototype.atan=function(r){var n=new Nt(r.shape,qpe);return this.compileAndRun(n,[r])},t.prototype.atan2=function(r,n){var a=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Jo(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,r.shape,n.shape):new zr(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,r.shape,n.shape);return this.compileAndRun(a,[r,n])},t.prototype.sinh=function(r){var n=new Nt(r.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[r])},t.prototype.cosh=function(r){var n=new Nt(r.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[r])},t.prototype.tanh=function(r){var n=new Nt(r.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(n,[r])},t.prototype.asinh=function(r){var n=new Nt(r.shape,Gpe);return this.compileAndRun(n,[r])},t.prototype.acosh=function(r){var n=new Nt(r.shape,Hpe);return this.compileAndRun(n,[r])},t.prototype.atanh=function(r){var n=new Nt(r.shape,Kpe);return this.compileAndRun(n,[r])},t.prototype.erf=function(r){var n=new Nt(r.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(n,[r])},t.prototype.step=function(r,n){var a=new Nt(r.shape,function(i){return i===void 0&&(i=0),eo+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(n));return this.compileAndRun(a,[r])},t.prototype.conv2dByMatMul=function(r,n,a,i,o,l){var c=r.shape,u=this.texData.get(r.dataId),d=a.inChannels,h=c[0]*c[1]*c[2],f=a.outChannels,p=a.dataFormat==="channelsLast",m=(h===1||f===1)&&d>1e3,v=c[2]%2!=0&&!!u.isPacked;if(m||!fe().getBool("WEBGL_LAZILY_UNPACK")||!fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!v){var g=p?c[0]*c[1]*c[2]:c[0]*c[2]*c[3],x=this.reshape(r,[1,g,a.inChannels]),y=this.reshape(n,[1,a.inChannels,a.outChannels]);return this.reshape(this.fusedBatchMatMul({a:x,b:y,transposeA:!1,transposeB:!1,bias:i,activation:o,preluActivationWeights:l}),a.outShape)}var b=p?c[0]*c[1]*(c[2]+1):c[0]*c[2]*(c[3]+1),N={dataId:r.dataId,shape:[1,b,a.inChannels],dtype:r.dtype},j=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,z(Xy(u.shape,N.shape),function(){return"packed reshape "+u.shape+" to "+N.shape+" isn't free"});var _=this.reshape(n,[1,a.inChannels,a.outChannels]),S=this.fusedBatchMatMul({a:N,b:_,transposeA:!1,transposeB:!1,bias:i,activation:o,preluActivationWeights:l}),C=this.texData.get(S.dataId);return z(C.isPacked,function(){return"batchMatMul result is expected to be packed"}),u.shape=j,C.shape=a.outShape,J.makeTensorFromDataId(S.dataId,a.outShape,S.dtype)},t.prototype.conv2dWithIm2Row=function(r,n,a,i,o,l){var c=a.filterWidth,u=a.filterHeight,d=a.inChannels,h=a.outWidth,f=a.outHeight,p=a.dataFormat==="channelsLast",m=c*u*d,v=f*h,g=[m,v],x=r.squeeze([0]),y=n.reshape([1,m,-1]),b=new upe(g,x.shape,a),N=this.compileAndRun(b,[x]).reshape([1,g[0],g[1]]),j=i!=null,_=l!=null,S=o?eb(o,!0):null,C=new j2(N.shape,[1,v,a.outChannels],!0,!1,j,S,_),E=[N,y];i&&E.push(i),_&&E.push(l);var k=this.compileAndRun(C,E);return p?k.reshape([1,f,h,a.outChannels]):k.reshape([1,a.outChannels,f,h])},t.prototype.fusedConv2d=function(r){var n=r.input,a=r.filter,i=r.convInfo,o=r.bias,l=r.activation,c=r.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(n,a,i,o,l,c);if(fe().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,a,i,o,l,c);var u=o!=null,d=c!=null,h=l?eb(l,!1):null,f=new t3(i,u,h,d),p=[n,a];return o&&p.push(o),c&&p.push(c),this.compileAndRun(f,p)},t.prototype.conv2d=function(r,n,a){if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(r,n,a);if(fe().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,n,a);var i=new t3(a);return this.compileAndRun(i,[r,n])},t.prototype.conv2dDerInput=function(r,n,a){var i=new Cfe(a);return this.compileAndRun(i,[r,n])},t.prototype.conv2dDerFilter=function(r,n,a){var i=new Sfe(a);return this.compileAndRun(i,[r,n])},t.prototype.fusedDepthwiseConv2D=function(r){var n,a=r.input,i=r.filter,o=r.convInfo,l=r.bias,c=r.activation,u=r.preluActivationWeights,d=fe().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1,h=c?eb(c,d):null,f=[a,i],p=l!=null,m=u!=null;return p&&f.push(l),m&&f.push(u),d?(n=new n3(o,p,h,m),this.compileAndRun(n,f)):(n=new r3(o,p,h,m),this.compileAndRun(n,f))},t.prototype.depthwiseConv2D=function(r,n,a){var i;return fe().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1?(i=new n3(a),this.compileAndRun(i,[r,n])):(i=new r3(a),this.compileAndRun(i,[r,n]))},t.prototype.depthwiseConv2DDerInput=function(r,n,a){var i=new Pfe(a);return this.compileAndRun(i,[r,n])},t.prototype.depthwiseConv2DDerFilter=function(r,n,a){var i=new Afe(a);return this.compileAndRun(i,[r,n])},t.prototype.conv3d=function(r,n,a){var i=new Tfe(a);return this.compileAndRun(i,[r,n])},t.prototype.conv3dDerInput=function(r,n,a){var i=new kfe(a);return this.compileAndRun(i,[r,n])},t.prototype.conv3dDerFilter=function(r,n,a){var i=new Efe(a);return this.compileAndRun(i,[r,n])},t.prototype.maxPool=function(r,n){var a=new N2(n,"max",!1);return this.compileAndRun(a,[r])},t.prototype.avgPool=function(r,n){var a=new N2(n,"avg",!1);return this.compileAndRun(a,[r],"float32")},t.prototype.maxPoolBackprop=function(r,n,a,i){var o=new N2(i,"max",!0),l=this.compileAndRun(o,[n]),c=new ppe(i),u=this.compileAndRun(c,[r,l],n.dtype);return l.dispose(),u},t.prototype.avgPoolBackprop=function(r,n,a){var i=new pfe(a);return this.compileAndRun(i,[r],n.dtype)},t.prototype.cast=function(r,n){return YW(r,n,this)},t.prototype.unstack=function(r,n){for(var a=r.shape[n],i=new Array(r.rank-1),o=0,l=0;l<r.rank;l++)l!==n&&(i[o++]=r.shape[l]);var c=new Array(r.rank).fill(0),u=r.shape.slice();u[n]=1;var d=new Array(a);for(l=0;l<d.length;l++)c[n]=l,d[l]=this.slice(r,c,u).reshape(i);return d},t.prototype.avgPool3d=function(r,n){var a=new _2(n,"avg",!1);return this.compileAndRun(a,[r],"float32")},t.prototype.avgPool3dBackprop=function(r,n,a){var i=new mfe(a);return this.compileAndRun(i,[r],n.dtype)},t.prototype.maxPool3d=function(r,n){var a=new _2(n,"max",!1);return this.compileAndRun(a,[r],"float32")},t.prototype.maxPool3dBackprop=function(r,n,a,i){var o=new _2(i,"max",!0),l=this.compileAndRun(o,[n]),c=new mpe(i),u=this.compileAndRun(c,[r,l],n.dtype);return l.dispose(),u},t.prototype.reshape=function(r,n){var a=this.texData.get(r.dataId);if(a.isPacked&&!Xy(r.shape,n)&&(a.texture===null||!Xy(a.shape,n))){var i=this.packedReshape(r,n);return J.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return AE(r,n)},t.prototype.resizeBilinear=function(r,n,a,i){var o=fe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Spe(r.shape,n,a,i):new _pe(r.shape,n,a,i);return this.compileAndRun(o,[r],"float32")},t.prototype.resizeBilinearBackprop=function(r,n,a){var i=new Npe(r,n,a);return this.compileAndRun(i,[r])},t.prototype.resizeNearestNeighbor=function(r,n,a,i){var o=new Epe(r.shape,n,a,i);return this.compileAndRun(o,[r])},t.prototype.resizeNearestNeighborBackprop=function(r,n,a){var i=new Cpe(r,n,a);return this.compileAndRun(i,[r])},t.prototype.multinomial=function(r,n,a,i){var o=n?r:Ml(r),l=o.shape[0],c=o.shape[1],u=new vpe(l,c,a),d=u.getCustomSetupFunc(i);return this.compileAndRun(u,[o],"int32",d)},t.prototype.oneHot=function(r,n,a,i){var o=new gpe(r.size,n,a,i);return this.compileAndRun(o,[r])},t.prototype.diag=function(r){var n=new $fe(r.size);return this.compileAndRun(n,[r])},t.prototype.nonMaxSuppression=function(r,n,a,i,o){return Y0("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),YT(r.dataSync(),n.dataSync(),a,i,o)},t.prototype.cropAndResize=function(r,n,a,i,o,l){var c=new Rfe(r.shape,n.shape,i,o,l);return this.compileAndRun(c,[r,n,a],"float32")},t.prototype.depthToSpace=function(r,n,a){z(n>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+n});var i=r.shape[0],o=a==="NHWC"?r.shape[1]:r.shape[2],l=a==="NHWC"?r.shape[2]:r.shape[3],c=a==="NHWC"?r.shape[3]:r.shape[1],u=o*n,d=l*n,h=c/(n*n),f=new Mfe(a==="NHWC"?[i,u,d,h]:[i,h,u,d],n,a);return this.compileAndRun(f,[r])},t.prototype.split=function(r,n,a){return ZW(r,n,a)},t.prototype.scatterND=function(r,n,a){var i=tw(0,r,a),o=i.sliceRank,l=i.numUpdates,c=i.sliceSize,u=i.strides,d=i.outputSize,h=[d/c,c],f=r.reshape([l,o]),p=n.reshape([l,c]);if(d===0)return AE(ra([]),a);var m=Fe(0),v=new o3(l,o,f.rank,p.rank,u,h);return this.compileAndRun(v,[p,f,m]).reshape(a)},t.prototype.sparseToDense=function(r,n,a,i){var o=tw(0,r,a),l=o.sliceRank,c=o.numUpdates,u=o.strides,d=o.outputSize,h=new o3(c,l,r.rank,n.rank,u,[d,1]);return this.compileAndRun(h,[n,r,i]).reshape(a)},t.prototype.fft=function(r){return this.fftImpl(r,!1)},t.prototype.ifft=function(r){return this.fftImpl(r,!0)},t.prototype.fftImpl=function(r,n){var a=this.texData.get(r.dataId),i=new s3(Vfe,r.shape,n),o=new s3(zfe,r.shape,n),l=[this.makeComplexComponentTensorInfo(r,a.complexTensors.real),this.makeComplexComponentTensorInfo(r,a.complexTensors.imag)],c=this.compileAndRun(i,l),u=this.compileAndRun(o,l),d=this.complex(c,u).as2D(r.shape[0],r.shape[1]);return c.dispose(),u.dispose(),d},t.prototype.gatherND=function(r,n){var a=n.shape,i=a[a.length-1],o=VW(r,n),l=o[0],c=o[1],u=o[2],d=o[3],h=n.reshape([c,i]),f=r.reshape([r.size/u,u]),p=new Gfe(i,d,[c,u]);return this.compileAndRun(p,[f,h]).reshape(l)},t.prototype.fill=function(r,n,a){if((a=a||Ax(n))==="string"){var i=q0(a,Qe(r));return i.fill(n),J.makeTensor(i,r,a,this)}var o=new Wfe(r,n),l=o.getCustomSetupFunc(n);return this.compileAndRun(o,[],a,l)},t.prototype.onesLike=function(r){if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(r.shape,1,r.dtype)},t.prototype.zerosLike=function(r){return this.fill(r.shape,r.dtype==="string"?"":0,r.dtype)},t.prototype.linspace=function(r,n,a){return XW(r,n,a)},t.prototype.makeTensorInfo=function(r,n){var a=this.write(null,r,n);return this.texData.get(a).usage=null,{dataId:a,shape:r,dtype:n}},t.prototype.makeOutput=function(r,n){var a=this.makeTensorInfo(r,n).dataId;return J.makeTensorFromDataId(a,r,n,this)},t.prototype.unpackTensor=function(r){var n=new Xpe(r.shape);return this.runWebGLProgram(n,[r],r.dtype)},t.prototype.packTensor=function(r){var n=new xpe(r.shape);return this.runWebGLProgram(n,[r],r.dtype,null,!0)},t.prototype.packedReshape=function(r,n){var a=[H0(r.shape)].concat(K0(r.shape)),i={dtype:r.dtype,shape:a,dataId:r.dataId},o=[H0(n)].concat(K0(n)),l=new jpe(o,a),c=this.runWebGLProgram(l,[i],r.dtype,null,!0);return{dataId:c.dataId,shape:n,dtype:c.dtype}},t.prototype.decode=function(r){var n,a=this.texData.get(r),i=a.isPacked,o=a.shape,l=a.dtype,c=x2(o);return n=i?new Dfe(c):new Ife(c),{dtype:l,shape:o,dataId:this.runWebGLProgram(n,[{shape:c,dtype:l,dataId:r}],l,null,!0).dataId}},t.prototype.runWebGLProgram=function(r,n,a,i,o){var l=this;o===void 0&&(o=!1);var c=this.makeTensorInfo(r.outputShape,a),u=this.texData.get(c.dataId);if(r.packedOutput&&(u.isPacked=!0),r.outPackingScheme===bg.DENSE){var d=Av(r.outputShape);u.texShape=d.map(function(b){return 2*b})}if(r.outTexUsage!=null&&(u.usage=r.outTexUsage),Qe(c.shape)===0)return u.values=xg(c.dtype,0),c;var h=[],f=n.map(function(b){if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var N=l.texData.get(b.dataId);if(N.texture==null){if(!r.packedInputs&&Qe(b.shape)<=fe().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:N.values};r.packedInputs&&(N.isPacked=!0,N.shape=b.shape)}else if(!!N.isPacked!=!!r.packedInputs)b=N.isPacked?l.unpackTensor(b):l.packTensor(b),h.push(b),N=l.texData.get(b.dataId);else if(N.isPacked&&!Xy(N.shape,b.shape)){var j=b,_=b.shape;b.shape=N.shape,b=l.packedReshape(b,_),h.push(b),N=l.texData.get(b.dataId),j.shape=_}return l.uploadToGPU(b.dataId),{shape:b.shape,texData:N,isUniform:!1}});this.uploadToGPU(c.dataId);var p,m={shape:c.shape,texData:u,isUniform:!1},v=function(b,N,j){var _="";N.concat(j).forEach(function(E){var k=E.texData!=null&&E.texData.slice!=null&&E.texData.slice.flatOffset>0,P=E.isUniform?"uniform":E.texData.texShape;_+=E.shape+"_"+P+"_"+k});var S=b.userCode,C=b.constructor.name;return C+="_"+_+"_"+S}(r,f,m),g=this.getAndSaveBinary(v,function(){return function(b,N,j,_){var S=N.userCode,C=j.map(function($,D){var W={logicalShape:$.shape,texShape:$.isUniform?null:$.texData.texShape,isUniform:$.isUniform,isPacked:!$.isUniform&&$.texData.isPacked,flatOffset:null};return $.texData!=null&&$.texData.slice!=null&&$.texData.slice.flatOffset>0&&(W.flatOffset=$.texData.slice.flatOffset),{name:N.variableNames[D],shapeInfo:W}}),E=C.map(function($){return $.shapeInfo}),k={logicalShape:_.shape,texShape:_.texData.texShape,isUniform:!1,isPacked:_.texData.isPacked,flatOffset:null},P=lfe(C,k,S,N.packedInputs),A=b.createProgram(P),O=null,I=b.getUniformLocation(A,"NAN",!1);fe().getNumber("WEBGL_VERSION")===1&&(O=b.getUniformLocation(A,"INFINITY",!1));for(var R={},M=0;M<N.variableNames.length;M++){var B=N.variableNames[M];R[B]=b.getUniformLocation(A,B,!1),R["offset"+B]=b.getUniformLocation(A,"offset"+B,!1)}return{program:N,source:P,webGLProgram:A,uniformLocations:R,inShapeInfos:E,outShapeInfo:k,infLoc:O,nanLoc:I}}(l.gpgpu,r,f,m)}),x=this.activeTimers!=null;if(x&&(p=this.startTimer()),function(b,N,j,_,S){i3(N.inShapeInfos,j),i3([N.outShapeInfo],[_]);var C=_.texData.texture,E=_.texData.texShape;_.texData.isPacked?b.setOutputPackedMatrixTexture(C,E[0],E[1]):b.setOutputMatrixTexture(C,E[0],E[1]),b.setProgram(N.webGLProgram),fe().getNumber("WEBGL_VERSION")===1&&N.infLoc!==null&&b.gl.uniform1f(N.infLoc,1/0),N.nanLoc!==null&&b.gl.uniform1f(N.nanLoc,NaN),j.forEach(function(k,P){var A=N.program.variableNames[P],O=N.uniformLocations[A],I=N.uniformLocations["offset"+A];if(O!=null)if(k.isUniform)if(Qe(k.shape)<2)b.gl.uniform1f(O,k.uniformValues[0]);else{var R=k.uniformValues;R instanceof Float32Array||(R=new Float32Array(R)),b.gl.uniform1fv(O,R)}else k.texData.slice!=null&&I!=null&&b.gl.uniform1i(I,k.texData.slice.flatOffset),b.setInputMatrixTexture(k.texData.texture,O,P)}),S!=null&&S(b,N.webGLProgram),b.executeProgram()}(this.gpgpu,g,f,m,i),h.forEach(function(b){return l.disposeData(b.dataId)}),x&&(p=this.endTimer(p),this.activeTimers.push({name:r.constructor.name,query:this.getQueryTime(p)})),!fe().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&o===!1){var y=this.unpackTensor(c);return this.disposeData(c.dataId),y}return c},t.prototype.compileAndRun=function(r,n,a,i,o){o===void 0&&(o=!1),a=a||n[0].dtype;var l=this.runWebGLProgram(r,n,a,i,o);return J.makeTensorFromDataId(l.dataId,l.shape,l.dtype)},t.prototype.getAndSaveBinary=function(r,n){return r in this.binaryCache||(this.binaryCache[r]=n()),this.binaryCache[r]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var r=this;this.disposed||(fe().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(n){r.gpgpu.deleteProgram(r.binaryCache[n].webGLProgram),delete r.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var r=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Ve(function(){if(!fe().get("WEBGL_RENDER_FLOAT32_ENABLED")){var n=fe().getBool("DEBUG");fe().set("DEBUG",!1);var a=r.abs(Fe(1e-8)).dataSync()[0];if(fe().set("DEBUG",n),a>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(r){var n,a=this.texData.get(r),i=a.shape,o=a.dtype,l=a.values,c=a.texture,u=a.usage,d=a.isPacked;if(c==null){var h,f=this.activeTimers!=null;f&&(h=fo());var p=a.texShape;if(p==null&&(p=ahe(i,d),a.texShape=p),l!=null){var m=x2(i),v=void 0,g=p[1],x=p[0],y=l instanceof Uint8Array;d?(g=(n=Tx(p[0],p[1]))[0],x=n[1],v=new Ufe(m,[x,g],y)):v=new Bfe(m,[x,g],y);var b=this.makeTensorInfo([x,g],o);this.texData.get(b.dataId).usage=y?ks.PIXELS:ks.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),g,x,l);var N=this.runWebGLProgram(v,[b],o,null,!0),j=this.texData.get(N.dataId);a.texture=j.texture,a.texShape=j.texShape,a.isPacked=j.isPacked,a.usage=j.usage,this.disposeData(b.dataId),this.texData.delete(N.dataId),a.values=null,f&&(this.uploadWaitMs+=fo()-h)}else{var _=this.acquireTexture(p,u,o,d);a.texture=_}}},t.prototype.convertAndCacheOnCPU=function(r,n){var a=this.texData.get(r),i=a.dtype;return this.releaseGPUData(r),n!=null&&(a.values=function(o,l){if(l==="float32"||l==="complex64")return o;if(l==="int32"||l==="bool"){for(var c=l==="int32"?new Int32Array(o.length):new Uint8Array(o.length),u=0;u<c.length;++u)c[u]=Math.round(o[u]);return c}throw new Error("Unknown dtype "+l)}(n,i)),a.values},t.prototype.acquireTexture=function(r,n,a,i){if(this.numBytesInGPU+=this.computeBytes(r,a),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+o+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(r,n,i)},t.prototype.computeBytes=function(r,n){return r[0]*r[1]*_W(n)},t}(HW);TW()&&J.registerBackend("webgl",function(){return new Zpe},2);var Jpe=Q({square_:function(e){var t=V(e,"x","square"),r=[t];return J.runKernelFunc(function(n,a){return a([t]),n.square(t)},{x:t},null,"Square",{},r,[])}}),jg="SquaredDifference",hq=Q({squaredDifference_:function(e,t){var r,n=V(e,"a","squaredDifference"),a=V(t,"b","squaredDifference");r=Lr(n,a),n=r[0],a=r[1],Vt(n.shape,a.shape);var i={a:n,b:a},o=[n,a];return J.runKernelFunc(function(l,c){var u=l.squaredDifference(n,a);return c([n,a]),u},i,function(l,c){var u=c[0],d=c[1],h=Fe(2);return{a:function(){return l.mul(u.sub(d).mul(h))},b:function(){return l.mul(d.sub(u).mul(h))}}},jg,{},o,[])}}),eme=Q({abs_:function(e){var t=V(e,"x","abs");return t.dtype==="complex64"?J.runKernelFunc(function(r){return r.complexAbs(t)},{$x:t}):J.runKernelFunc(function(r,n){var a=r.abs(t);return n([t]),a},{x:t},function(r,n){var a=n[0];return{x:function(){return r.mul(a.toFloat().step(-1))}}},"Abs")}}),tme=Q({acos_:function(e){var t=V(e,"x","acos");return J.runKernelFunc(function(r,n){var a=r.acos(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return r.divStrict(Fe(1).sub(a.toFloat().square()).sqrt()).neg()}}})}}),rme=Q({acosh_:function(e){var t=V(e,"x","acosh");return J.runKernelFunc(function(r,n){var a=r.acosh(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return r.divStrict(a.toFloat().square().sub(1).sqrt())}}})}}),nme=Q({asin_:function(e){var t=V(e,"x","asin");return J.runKernelFunc(function(r,n){var a=r.asin(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return r.divStrict(Fe(1).sub(a.toFloat().square()).sqrt())}}})}}),ame=Q({asinh_:function(e){var t=V(e,"x","asinh");return J.runKernelFunc(function(r,n){var a=r.asinh(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return r.divStrict(Fe(1).add(a.toFloat().square()).sqrt())}}})}}),sme=Q({atan_:function(e){var t=V(e,"x","atan");return J.runKernelFunc(function(r,n){var a=r.atan(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return r.div(a.toFloat().square().add(1))}}})}}),ime=Q({atanh_:function(e){var t=V(e,"x","atanh");return J.runKernelFunc(function(r,n){var a=r.atanh(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return r.div(Fe(1).sub(a.toFloat().square()))}}})}}),ome=Q({ceil_:function(e){var t=V(e,"x","ceil");return J.runKernelFunc(function(r){return r.ceil(t)},{$x:t},function(r){return{$x:function(){return Xt(r)}}})}}),tR=Q({clipByValue_:function(e,t,r){var n=V(e,"x","clipByValue");z(t<=r,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+r+")."});var a=[n],i={min:t,max:r};return J.runKernelFunc(function(o,l){var c=o.clip(n,t,r);return l([n]),c},{x:n},function(o,l){var c=l[0];return{x:function(){return o.where(c.greaterEqual(t).logicalAnd(c.lessEqual(r)),Xt(o))}}},"ClipByValue",i,a)}}),lme=Q({cos_:function(e){var t=V(e,"x","cos"),r=[t];return J.runKernelFunc(function(n,a){var i=n.cos(t);return a([t]),i},{x:t},function(n,a){var i=a[0];return{x:function(){return i.toFloat().sin().neg().mul(n)}}},"Cos",{},r)}}),cme=Q({cosh_:function(e){var t=V(e,"x","cosh");return J.runKernelFunc(function(r,n){var a=r.cosh(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return a.toFloat().sinh().mulStrict(r)}}})}}),ume=Q({erf_:function(e){var t=V(e,"x","erf");return z(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),J.runKernelFunc(function(r,n){var a=r.erf(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return r.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),TE=Q({exp_:function(e){var t=V(e,"x","exp");return J.runKernelFunc(function(r,n){var a=r.exp(t);return n([a]),a},{x:t},function(r,n){return{x:function(){return r.mulStrict(n[0])}}},"Exp",{},[],[!0])}}),dme=Q({expm1_:function(e){var t=V(e,"x","expm1");return J.runKernelFunc(function(r,n){var a=r.expm1(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return r.mul(a.exp())}}})}}),hme=Q({floor_:function(e){var t=V(e,"x","floor");return J.runKernelFunc(function(r){return r.floor(t)},{$x:t},function(r){return{$x:function(){return Xt(r)}}})}}),fme=Q({log_:function(e){var t=V(e,"x","log"),r=[t];return J.runKernelFunc(function(n,a){var i=n.log(t);return a([t]),i},{x:t},function(n,a){var i=a[0];return{x:function(){return n.div(i.toFloat())}}},"Log",{},r)}}),pme=Q({log1p_:function(e){var t=V(e,"x","log1p");return J.runKernelFunc(function(r,n){var a=r.log1p(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return r.div(a.add(1))}}})}}),mme=Q({logSigmoid_:function(e){var t=V(e,"x","logSigmoid");return J.runKernelFunc(function(r,n){var a=r.softplus(t.neg()).neg();return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return r.mul(a.neg().sigmoid())}}})}}),sw=Q({neg_:function(e){var t=V(e,"x","neg"),r=[t];return J.runKernelFunc(function(n){return n.neg(t)},{x:t},function(n){return{x:function(){return n.neg()}}},"Neg",{},r)}}),vme=Q({reciprocal_:function(e){var t=V(e,"x","reciprocal");return J.runKernelFunc(function(r,n){var a=r.reciprocal(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return r.div(a.square().neg())}}})}}),gme=Q({round_:function(e){var t=V(e,"x","round");return J.runKernelFunc(function(r){return r.round(t)},{$x:t},function(r){return{$x:function(){return Xt(r)}}})}}),fq=Q({rsqrt_:function(e){var t=V(e,"x","rsqrt"),r=[t];return J.runKernelFunc(function(n,a){var i=n.rsqrt(t);return a([t]),i},{x:t},function(n,a){var i=a[0];return{x:function(){return n.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},r)}}),pq=Q({sigmoid_:function(e){var t=V(e,"x","sigmoid");return J.runKernelFunc(function(r,n){var a=r.sigmoid(t);return n([a]),a},{x:t},function(r,n){var a=n[0];return{x:function(){return r.mul(a.mul(Fe(1).sub(a)))}}},"Sigmoid")}}),xme=Q({sign_:function(e){var t=V(e,"x","sign");return J.runKernelFunc(function(r){return r.sign(t)},{$x:t},function(r){return{$x:function(){return Xt(r)}}})}}),yme=Q({isNaN_:function(e){var t=V(e,"x","isNaN");return J.runKernelFunc(function(r){return r.isNaN(t)},{$x:t},function(r){return{$x:function(){return Xt(r)}}})}}),bme=Q({isInf_:function(e){var t=V(e,"x","isInf");return J.runKernelFunc(function(r){return r.isInf(t)},{$x:t},function(r){return{$x:function(){return Xt(r)}}})}}),wme=Q({isFinite_:function(e){var t=V(e,"x","isFinite");return J.runKernelFunc(function(r){return r.isFinite(t)},{$x:t},function(r){return{$x:function(){return Xt(r)}}})}}),jme=Q({sin_:function(e){var t=V(e,"x","sin"),r=[t];return J.runKernelFunc(function(n,a){var i=n.sin(t);return a([t]),i},{x:t},function(n,a){var i=a[0];return{x:function(){return i.toFloat().cos().mul(n)}}},"Sin",{},r)}}),Nme=Q({sinh_:function(e){var t=V(e,"x","sinh");return J.runKernelFunc(function(r,n){var a=r.sinh(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return a.toFloat().cosh().mulStrict(r)}}})}}),_me=Q({softplus_:function(e){var t=V(e,"x","softplus");return J.runKernelFunc(function(r,n){var a=r.softplus(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return r.mul(a.sigmoid())}}})}}),Sme=Q({sqrt_:function(e){var t=V(e,"x","sqrt");return J.runKernelFunc(function(r,n){var a=r.sqrt(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return r.div(a.toFloat().sqrt().mul(2))}}})}}),Cme=Q({step_:function(e,t){t===void 0&&(t=0);var r=V(e,"x","step");return J.runKernelFunc(function(n){return n.step(r,t)},{$x:r},function(n){return{$x:function(){return Xt(n)}}})}}),Eme=Q({tan_:function(e){var t=V(e,"x","tan");return J.runKernelFunc(function(r,n){var a=r.tan(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return r.div(a.cos().square())}}})}}),kme=Q({tanh_:function(e){var t=V(e,"x","tanh");return J.runKernelFunc(function(r,n){var a=r.tanh(t);return n([a]),a},{x:t},function(r,n){var a=n[0];return{x:function(){return Fe(1).sub(a.square()).mulStrict(r)}}},"Tanh",{},null,[!0])}});function mq(e,t,r,n,a,i){var o,l,c=V(e,"x","batchNorm"),u=V(t,"mean","batchNorm"),d=V(r,"variance","batchNorm");return a!=null&&(o=V(a,"scale","batchNorm")),n!=null&&(l=V(n,"offset","batchNorm")),z(c.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),z(u.rank===2||u.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+u.rank+"."}),z(d.rank===2||d.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+d.rank+"."}),o!=null&&z(o.rank===2||o.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."}),l!=null&&z(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+l.rank+"."}),Ox(c,u,d,l,o,i)}function vq(e,t,r,n,a,i){var o,l,c=V(e,"x","batchNorm"),u=V(t,"mean","batchNorm"),d=V(r,"variance","batchNorm");return a!=null&&(o=V(a,"scale","batchNorm")),n!=null&&(l=V(n,"offset","batchNorm")),z(c.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),z(u.rank===3||u.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+u.rank+"."}),z(d.rank===3||d.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+d.rank+"."}),o!=null&&z(o.rank===3||o.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."}),l!=null&&z(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+l.rank+"."}),Ox(c,u,d,l,o,i)}function gq(e,t,r,n,a,i){var o,l,c=V(e,"x","batchNorm"),u=V(t,"mean","batchNorm"),d=V(r,"variance","batchNorm");return a!=null&&(o=V(a,"scale","batchNorm")),n!=null&&(l=V(n,"offset","batchNorm")),z(c.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+c.rank+"."}),z(u.rank===4||u.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+u.rank+"."}),z(d.rank===4||d.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+d.rank+"."}),o!=null&&z(o.rank===4||o.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."}),l!=null&&z(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+l.rank+"."}),Ox(c,u,d,l,o,i)}function Ox(e,t,r,n,a,i){i==null&&(i=.001);var o,l,c,u=V(e,"x","batchNorm"),d=V(t,"mean","batchNorm"),h=V(r,"variance","batchNorm");a!=null&&(o=V(a,"scale","batchNorm")),n!=null&&(l=V(n,"offset","batchNorm")),z(d.rank===h.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),z(l==null||d.rank===l.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),z(o==null||d.rank===o.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),c=u.rank===0||u.rank===1?u.as4D(1,1,1,u.size):u.rank===2?u.as4D(1,1,u.shape[0],u.shape[1]):u.rank===3?u.as4D(1,u.shape[0],u.shape[1],u.shape[2]):u;var f=[u,d,h,o];return J.runKernelFunc(function(p,m){var v=p.batchNormalization(c,tb(d),tb(h),i,tb(o),tb(l));return m([u,d,h,o]),v},{x:u,mean:d,variance:h,scale:o,offset:l},function(p,m){var v=m,g=v[0],x=v[1],y=v[2],b=v[3],N=b??Fe(1),j=In(x.shape,c.shape),_=[];if(x.rank===1){for(var S=0;S<c.shape.length-1;++S)_.push(c.shape[S]);_.push(1)}var C=g.sub(x),E=p.mul(N),k=fq(y.add(Fe(i))),P=k.mul(k).mul(k).mul(Fe(-.5));return{x:function(){return x.rank===1?p.mul(vf(k.as4D(1,1,1,x.shape[0]),_)).mul(N).reshape(g.shape):p.mul(k).mul(N).reshape(g.shape)},mean:function(){var A=k.mul(Fe(-1)).mul(E);return x.rank===1&&(A=A.sum(j)),A.reshape(x.shape)},variance:function(){var A=P.mul(C).mul(E);return x.rank===1&&(A=A.sum(j)),A.reshape(x.shape)},scale:function(){var A=C.mul(k),O=p.mul(A);return x.rank===1&&(O=O.sum(j)),O.reshape(x.shape)},offset:function(){var A=p;return x.rank===1&&(A=A.sum(j)),A.reshape(x.shape)}}},"BatchNormalization",{varianceEpsilon:i},f).reshape(u.shape)}function tb(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function kj(){RW("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var Ame=Q({batchNormalization2d_:function(e,t,r,n,a,i){return n===void 0&&(n=.001),kj(),mq(e,t,r,i,a,n)}}),Pme=Q({batchNormalization3d_:function(e,t,r,n,a,i){return n===void 0&&(n=.001),kj(),vq(e,t,r,i,a,n)}}),Tme=Q({batchNormalization4d_:function(e,t,r,n,a,i){return n===void 0&&(n=.001),kj(),gq(e,t,r,i,a,n)}}),Rme=Q({batchNormalization_:function(e,t,r,n,a,i){return n===void 0&&(n=.001),kj(),Ox(e,t,r,i,a,n)}}),xq=Q({batchNorm_:Ox}),Ome=Q({batchNorm2d_:mq}),Ime=Q({batchNorm3d_:vq}),Dme=Q({batchNorm4d_:gq}),Aj=Q({logicalAnd_:function(e,t){var r=V(e,"a","logicalAnd","bool"),n=V(t,"b","logicalAnd","bool");return Vt(r.shape,n.shape),J.runKernelFunc(function(a){return a.logicalAnd(r,n)},{a:r,b:n},null,"LogicalAnd")}}),Mme=Q({logicalNot_:function(e){var t=V(e,"x","logicalNot","bool");return J.runKernelFunc(function(r){return r.logicalNot(t)},{$x:t})}}),yq=Q({logicalOr_:function(e,t){var r=V(e,"a","logicalOr","bool"),n=V(t,"b","logicalOr","bool");return Vt(r.shape,n.shape),J.runKernelFunc(function(a){return a.logicalOr(r,n)},{$a:r,$b:n})}}),$me=Q({logicalXor_:function(e,t){var r=V(e,"a","logicalXor","bool"),n=V(t,"b","logicalXor","bool");return Vt(r.shape,n.shape),yq(e,t).logicalAnd(Aj(e,t).logicalNot())}}),Od=Q({where_:function(e,t,r){var n=V(t,"a","where"),a=V(r,"b","where"),i=V(e,"condition","where","bool");return nr(n.shape,a.shape,"Error in where: "),i.rank===1?z(i.shape[0]===n.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):nr(i.shape,a.shape,"Error in where: "),J.runKernelFunc(function(o,l){var c=o.select(i,n,a);return l([i]),c},{$condition:i,$a:n,$b:a},function(o,l){var c=l[0];return{$condition:function(){return Xt(c).toFloat()},$a:function(){return o.mul(c.cast(o.dtype))},$b:function(){return o.mul(c.logicalNot().cast(o.dtype))}}})}}),bq=function(e){return Ye(this,void 0,void 0,function(){var t,r,n;return Xe(this,function(a){switch(a.label){case 0:return[4,(t=V(e,"condition","whereAsync","bool")).data()];case 1:return r=a.sent(),n=QT(t.shape,r),e!==t&&t.dispose(),[2,n]}})})},Mt=Q({add_:function(e,t){var r,n=V(e,"a","add"),a=V(t,"b","add");r=Lr(n,a),n=r[0],a=r[1];var i=Vt(n.shape,a.shape);return J.runKernelFunc(function(o){return o.add(n,a)},{a:n,b:a},function(o){return{a:function(){var l=o,c=In(n.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(n.shape)},b:function(){var l=o,c=In(a.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(a.shape)}}},"Add")}}),Fme=Q({addN_:function(e){z(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),z(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(a,i){return V(a,"tensors"+i,"addN")}),r=t[0];t.forEach(function(a){if(a.dtype!==r.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(a){if(!Gn(a.shape,r.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var n=t;return J.runKernelFunc(function(a){return a.addN(t)},n,function(a){var i={};return t.forEach(function(o,l){i[l]=function(){return a.clone()}}),i},"AddN")}}),Lme=Q({addStrict_:function(e,t){var r=V(e,"a","addStrict"),n=V(t,"b","addStrict");return nr(r.shape,n.shape,"Error in addStrict: "),r.add(n)}}),Bme=Q({atan2_:function(e,t){var r,n=V(e,"a","atan2"),a=V(t,"b","atan2");r=Lr(n,a),n=r[0],a=r[1];var i=Vt(n.shape,a.shape);return J.runKernelFunc(function(o,l){var c=o.atan2(n,a);return l([n,a]),c},{$a:n,$b:a},function(o,l){var c=l[0],u=l[1];return{$a:function(){var d=Mt(c.square(),u.square()),h=o.mul(u.div(d)),f=In(c.shape,i);return f.length>0&&(h=h.sum(f)),h.reshape(c.shape)},$b:function(){var d=Mt(c.square(),u.square()),h=sw(o.mul(c.div(d))),f=In(u.shape,i);return f.length>0&&(h=h.sum(f)),h.reshape(u.shape)}}})}}),Ti=Q({div_:function(e,t){var r,n=V(e,"a","div"),a=V(t,"b","div");if(r=Lr(n,a),n=r[0],a=r[1],n.dtype==="int32"&&a.dtype==="int32")return wq(n,a);var i=Vt(n.shape,a.shape);return J.runKernelFunc(function(o,l){var c=o.realDivide(n,a);return l([n,a]),c},{a:n,b:a},function(o,l){var c=l[0],u=l[1];return{a:function(){var d=o.div(u.toFloat()),h=In(c.shape,i);return h.length>0?d.sum(h).reshape(c.shape):d},b:function(){var d=o.mul(c.toFloat()),h=In(u.shape,i);h.length>0&&(d=d.sum(h).reshape(u.shape));var f=u.square();return d.div(f.toFloat()).neg()}}},"Div")}}),Ume=Q({divNoNan_:function(e,t){var r,n=V(e,"a","div"),a=V(t,"b","div");n=(r=Lr(n,a))[0],a=r[1];var i=Ti(n,a),o=Xt(i),l=a.equal(o);return Od(l,o,i)}}),Vme=Q({divStrict_:function(e,t){var r=V(e,"a","div"),n=V(t,"b","div");return nr(r.shape,n.shape,"Error in divideStrict: "),r.div(n)}}),wq=Q({floorDiv_:function(e,t){var r,n=V(e,"a","floorDiv"),a=V(t,"b","floorDiv");r=Lr(n,a),n=r[0],a=r[1];var i=Vt(n.shape,a.shape);return J.runKernelFunc(function(o,l){var c=o.floorDiv(n,a);return l([n,a]),c},{a:n,b:a},function(o,l){var c=l[0],u=l[1];return{a:function(){var d=o.div(u.toFloat()),h=In(c.shape,i);return h.length>0?d.sum(h).reshape(c.shape):d},b:function(){var d=o.mul(c.toFloat()),h=In(u.shape,i);h.length>0&&(d=d.sum(h).reshape(u.shape));var f=u.square();return d.div(f.toFloat()).neg()}}},"FloorDiv")}}),rR=Q({maximum_:function(e,t){var r,n=V(e,"a","maximum"),a=V(t,"b","maximum");return r=Lr(n,a),n=r[0],a=r[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),Vt(n.shape,a.shape),J.runKernelFunc(function(i,o){var l=i.maximum(n,a);return o([n,a]),l},{a:n,b:a},function(i,o){var l=o[0],c=o[1];return{a:function(){return i.mul(l.greaterEqual(c).toFloat())},b:function(){return i.mul(l.less(c).toFloat())}}},"Maximum")}}),zme=Q({maximumStrict_:function(e,t){var r=V(e,"a","maximumStrict"),n=V(t,"b","maximumStrict");return nr(r.shape,n.shape,"Error in maximumStrict: "),r.maximum(n)}}),jq=Q({minimum_:function(e,t){var r,n=V(e,"a","minimum"),a=V(t,"b","minimum");return r=Lr(n,a),n=r[0],a=r[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),Vt(n.shape,a.shape),J.runKernelFunc(function(i,o){var l=i.minimum(n,a);return o([n,a]),l},{a:n,b:a},function(i,o){var l=o[0],c=o[1];return{a:function(){return i.mul(l.lessEqual(c).toFloat())},b:function(){return i.mul(l.greater(c).toFloat())}}},"Minimum")}}),Wme=Q({minimumStrict_:function(e,t){var r=V(e,"a","minimumStrict"),n=V(t,"b","minimumStrict");return nr(r.shape,n.shape,"Error in minimumStrict: "),r.minimum(n)}}),qme=Q({mod_:function(e,t){var r,n=V(e,"a","mod"),a=V(t,"b","mod");r=Lr(n,a),n=r[0],a=r[1];var i=Vt(n.shape,a.shape);return J.runKernelFunc(function(o,l){var c=o.mod(n,a);return l([n,a]),c},{$a:n,$b:a},function(o,l){var c=l[0],u=l[1];return{$a:function(){var d=In(c.shape,i);return d.length>0?o.sum(d).reshape(c.shape):o},$b:function(){var d=o.mul(c.div(u).floor().neg()),h=In(u.shape,i);return h.length>0?d.sum(h).reshape(u.shape):d}}})}}),Gme=Q({modStrict_:function(e,t){var r=V(e,"a","modStrict"),n=V(t,"b","modStrict");return nr(r.shape,n.shape,"Error in modStrict: "),r.mod(n)}}),ja=Q({mul_:function(e,t){var r,n=V(e,"a","mul"),a=V(t,"b","mul");r=Lr(n,a),n=r[0],a=r[1];var i=Vt(n.shape,a.shape);return J.runKernelFunc(function(o,l){var c=o.multiply(n,a);return l([n,a]),c},{a:n,b:a},function(o,l){var c=l[0],u=l[1];return{a:function(){var d=o.mul(u.toFloat()),h=In(c.shape,i);return h.length>0?d.sum(h).reshape(c.shape):d},b:function(){var d=o.mul(c.toFloat()),h=In(u.shape,i);return h.length>0?d.sum(h).reshape(u.shape):d}}},"Mul")}}),Hme=Q({mulStrict_:function(e,t){var r=V(e,"a","mul"),n=V(t,"b","mul");return nr(r.shape,n.shape,"Error in multiplyStrict: "),r.mul(n)}}),iw=Q({pow_:function(e,t){var r,n=V(e,"base","pow"),a=V(t,"exp","pow");r=Lr(n,a),n=r[0],a=r[1];var i=Vt(n.shape,a.shape),o=[n,a];return J.runKernelFunc(function(l,c){var u=l.pow(n,a);return c([n,a,u]),u},{a:n,b:a},function(l,c){var u=c[0],d=c[1],h=c[2];return{a:function(){var f=d.toFloat(),p=l.mul(f.mul(u.pow(f.sub(Fe(1))))),m=In(u.shape,i);return m.length>0&&(p=p.sum(m)),p.reshape(u.shape)},b:function(){var f=u.greater(0),p=u.log().where(f,Xt(u)),m=l.mul(h.mul(p)),v=In(d.shape,i);return v.length>0&&(m=m.sum(v)),m.reshape(d.shape)}}},"Pow",{},o,[!0])}}),Kme=Q({powStrict_:function(e,t){return nr(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),Yme=Q({squaredDifferenceStrict_:function(e,t){var r=V(e,"a","squaredDifferenceStrict"),n=V(t,"b","squaredDifferenceStrict");return nr(r.shape,n.shape,"Error in squaredDifferenceStrict: "),r.squaredDifference(n)}}),Dn=Q({sub_:function(e,t){var r,n=V(e,"a","sub"),a=V(t,"b","sub");r=Lr(n,a),n=r[0],a=r[1];var i=Vt(n.shape,a.shape);return J.runKernelFunc(function(o){return o.subtract(n,a)},{a:n,b:a},function(o){return{a:function(){var l=o,c=In(n.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(n.shape)},b:function(){var l=o,c=In(a.shape,i);return c.length>0&&(l=l.sum(c)),l.neg().reshape(a.shape)}}},"Sub")}}),Xme=Q({subStrict_:function(e,t){var r=V(e,"a","subStrict"),n=V(t,"b","subStrict");return nr(r.shape,n.shape,"Error in subStrict: "),r.sub(n)}}),Nq=Q({equal_:function(e,t){var r,n=V(e,"a","equal"),a=V(t,"b","equal");return r=Lr(n,a),n=r[0],a=r[1],Vt(n.shape,a.shape),J.runKernelFunc(function(i){return i.equal(n,a)},{$a:n,$b:a})}}),Qme=Q({equalStrict_:function(e,t){var r=V(e,"a","equalStrict"),n=V(t,"b","equalStrict");return nr(r.shape,n.shape,"Error in equalStrict: "),r.equal(n)}}),Zme=Q({greater_:function(e,t){var r,n=V(e,"a","greater"),a=V(t,"b","greater");return r=Lr(n,a),n=r[0],a=r[1],Vt(n.shape,a.shape),J.runKernelFunc(function(i){return i.greater(n,a)},{a:n,b:a},null,"Greater")}}),_q=Q({greaterEqual_:function(e,t){var r,n=V(e,"a","greaterEqual"),a=V(t,"b","greaterEqual");return r=Lr(n,a),n=r[0],a=r[1],Vt(n.shape,a.shape),J.runKernelFunc(function(i,o){var l=i.greaterEqual(n,a);return o([n,a]),l},{a:n,b:a},function(i,o){var l=o[0],c=o[1];return{a:function(){return Xt(l)},b:function(){return Xt(c)}}},"GreaterEqual")}}),Jme=Q({greaterEqualStrict_:function(e,t){var r=V(e,"a","greaterEqualStrict"),n=V(t,"b","greaterEqualStrict");return nr(r.shape,n.shape,"Error in greaterEqualStrict: "),r.greaterEqual(n)}}),eve=Q({greaterStrict_:function(e,t){var r=V(e,"a","greaterStrict"),n=V(t,"b","greaterStrict");return nr(r.shape,n.shape,"Error in greaterStrict: "),r.greater(n)}}),tve=Q({less_:function(e,t){var r,n=V(e,"a","less"),a=V(t,"b","less");return r=Lr(n,a),n=r[0],a=r[1],Vt(n.shape,a.shape),J.runKernelFunc(function(i){return i.less(n,a)},{a:n,b:a},null,"Less")}}),rve=Q({lessEqual_:function(e,t){var r,n=V(e,"a","lessEqual"),a=V(t,"b","lessEqual");return r=Lr(n,a),n=r[0],a=r[1],Vt(n.shape,a.shape),J.runKernelFunc(function(i,o){var l=i.lessEqual(n,a);return o([n,a]),l},{a:n,b:a},null,"LessEqual")}}),nve=Q({lessEqualStrict_:function(e,t){var r=V(e,"a","lessEqualStrict"),n=V(t,"b","lessEqualStrict");return nr(r.shape,n.shape,"Error in lessEqualStrict: "),r.lessEqual(n)}}),ave=Q({lessStrict_:function(e,t){var r=V(e,"a","lessStrict"),n=V(t,"b","lessStrict");return nr(r.shape,n.shape,"Error in lessStrict: "),r.less(n)}}),sve=Q({notEqual_:function(e,t){var r,n=V(e,"a","notEqual"),a=V(t,"b","notEqual");return r=Lr(n,a),n=r[0],a=r[1],Vt(n.shape,a.shape),J.runKernelFunc(function(i){return i.notEqual(n,a)},{a:n,b:a},null,"NotEqual")}}),ive=Q({notEqualStrict_:function(e,t){var r=V(e,"a","notEqualStrict"),n=V(t,"b","notEqualStrict");return nr(r.shape,n.shape,"Error in notEqualStrict: "),r.notEqual(n)}});function v3(e,t){for(var r=[],n=e;n<t;++n)r.push(n);return r}function g3(e){for(var t=[],r=0;r<e.length;++r)for(var n=0;n<e[r].length;++n)t.push(e[r][n]);return t}var nR=Q({gather_:function(e,t,r){r===void 0&&(r=0);var n=V(e,"x","gather"),a=V(t,"indices","gather","int32");r=$n(r,n.shape)[0];var i=function(o,l,c){for(var u=o.shape[c],d=[],h=1,f=1,p=0;p<c;p++)d.push(o.shape[p]),h*=o.shape[p];for(p=0;p<l.rank;p++)d.push(l.shape[p]);for(p=c+1;p<o.rank;p++)d.push(o.shape[p]),f*=o.shape[p];return{batchSize:h,sliceSize:f,dimSize:u,outputShape:d}}(n,a,r);return J.runKernelFunc(function(o,l){var c=o.gather(n,a.flatten(),r);return l([a]),c},{x:n,indices:a},function(o,l){var c=l[0];return{x:function(){var u=n.shape,d=c.size,h=u.slice(0,r),f=h.length,p=u.slice(r,u.length).slice(1),m=p.length,v=v3(0,f),g=v3(f+1,f+1+m),x=g3([h,[d],p]),y=o.reshape(x),b=c.reshape([d]),N=g3([[f],v,g]),j=y.transpose(N),_=Sq(j,b,n.shape[r]),S=zT(N);return _=_.transpose(S)},indices:function(){return c}}},"Gather",{axis:r}).reshape(i.outputShape)}}),Sq=Q({unsortedSegmentSum_:function(e,t,r){var n=V(e,"x","unsortedSegmentSum"),a=V(t,"segmentIds","unsortedSegmentSum","int32");return z(rn(r),function(){return"numSegments must be of dtype int"}),J.runKernelFunc(function(i,o){var l=i.unsortedSegmentSum(n,a,r);return o([a]),l},{$x:n},function(i,o){var l=o[0];return{$x:function(){return function(c,u){for(var d=rR(u,Xt(u)),h=nR(c,d),f=_q(u,Fe(0,"int32")),p=h.rank-f.rank,m=0;m<p;++m)f=Qs(f,m+1);f=Aj(f,Jp(h.shape,"bool"));var v=Xt(h);return Od(f,h,v)}(i,l)}}})}}),ove=function(e,t,r){return Ye(this,void 0,void 0,function(){var n,a,i,o,l,c,u,d,h,f,p,m,v;return Xe(this,function(g){switch(g.label){case 0:for(n=V(e,"tensor","boolMask"),a=V(t,"mask","boolMask","bool"),i=r??0,o=a.rank,l=n.shape,z(o>0,function(){return"mask cannot be scalar"}),nr(l.slice(i,i+o),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,u=i;u<i+o;u++)c*=l[u];return d=l.slice(0,i).concat([c],l.slice(i+o)),h=n.reshape(d),f=a.reshape([-1]),[4,bq(f)];case 1:return p=g.sent(),m=p.squeeze([1]),v=nR(h,m,i),e!==n&&n.dispose(),t!==a&&a.dispose(),m.dispose(),h.dispose(),f.dispose(),p.dispose(),[2,v]}})})};function Cq(e,t,r,n,a,i,o){i===void 0&&(i="NHWC"),z(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var l=e,c=t,u=!1;t.rank===3&&(u=!0,c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),l=[1,e[0],e[1],e[2]]),z(l.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+l.length+"."}),z(c.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+c.rank}),z(r.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+r.rank});var d=i==="NHWC"?l[3]:l[1],h=i==="NHWC"?c.shape[3]:c.shape[1];z(d===r.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+d+") must match input depth for filter "+r.shape[2]+"."}),z(h===r.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+h+") must match output depth for filter "+r.shape[3]+"."}),o!=null&&z(rn(a),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."});var f=KT(i),p=th(l,r.shape,n,1,a,o,!1,f),m=J.runKernelFunc(function(v,g){var x=v.conv2dDerInput(c,r,p);return g([r,c]),x},{dy4D:c,filter:r},function(v,g){var x=g[0],y=g[1];return{dy4D:function(){return di(v,x,n,a,i,1,o)},filter:function(){return aR(v,y,x.shape,n,a,i,o)}}});return u?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}function C2(e){var t=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(e),r=t[0],n=t[1],a=t[2];return r===1&&n===1&&a===1}function Eq(e,t,r,n,a){z(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var i=e,o=t,l=!1;t.rank===4&&(l=!0,o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var c=i[4],u=o.shape[4];z(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),z(o.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank}),z(r.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+r.rank}),z(c===r.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+c+") must match input depth for filter "+r.shape[3]+"."}),z(u===r.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+u+") must match output depth for filter "+r.shape[4]+"."});var d=nw(i,r.shape,n,1,a),h=J.runKernelFunc(function(f){return f.conv3dDerInput(o,r,d)},{dy5D:o});return l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var lve=Q({conv1d_:function(e,t,r,n,a,i,o){a===void 0&&(a="NWC"),i===void 0&&(i=1);var l=V(e,"x","conv1d"),c=V(t,"filter","conv1d"),u=l,d=!1;l.rank===2&&(d=!0,u=l.as3D(1,l.shape[0],l.shape[1])),z(u.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+u.rank+"."}),z(c.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+c.rank+"."}),o!=null&&z(rn(n),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+n+"."}),z(u.shape[2]===c.shape[1],function(){return"Error in conv1d: depth of input ("+u.shape[2]+") must match input depth for filter "+c.shape[1]+"."}),z(cs(r,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+r+" and dilation '"+i+"'"}),z(a==="NWC",function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."});var h=c.as4D(1,c.shape[0],c.shape[1],c.shape[2]),f=u.as4D(u.shape[0],1,u.shape[1],u.shape[2]),p=di(f,h,[1,r],n,"NHWC",[1,i],o);return d?p.as2D(p.shape[2],p.shape[3]):p.as3D(p.shape[0],p.shape[2],p.shape[3])}}),di=Q({conv2d_:function(e,t,r,n,a,i,o){a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]);var l=V(e,"x","conv2d"),c=V(t,"filter","conv2d"),u=l,d=!1;l.rank===3&&(d=!0,u=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),z(u.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+u.rank+"."}),z(c.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+c.rank+"."}),o!=null&&z(rn(n),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+n+"."});var h=a==="NHWC"?u.shape[3]:u.shape[1];z(h===c.shape[2],function(){return"Error in conv2d: depth of input ("+h+") must match input depth for filter "+c.shape[2]+"."}),z(cs(r,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"});var f=KT(a),p=th(u.shape,c.shape,r,i,n,o,!1,f),m=[c,u],v=J.runKernelFunc(function(g,x){var y=g.conv2d(u,c,p);return x([c,u]),y},{x:u,filter:c},function(g,x){var y=x,b=y[0],N=y[1];return z(rp(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return kq(N.shape,g,b,r,n,a)},filter:function(){return aR(N,g,b.shape,r,n,a)}}},"Conv2D",p,m);return d?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),cve=Q({conv3d_:function(e,t,r,n,a,i){a===void 0&&(a="NDHWC"),i===void 0&&(i=[1,1,1]);var o=V(e,"x","conv3d"),l=V(t,"filter","conv3d"),c=o,u=!1;o.rank===4&&(u=!0,c=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),z(c.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+c.rank+"."}),z(l.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+l.rank+"."}),z(c.shape[4]===l.shape[3],function(){return"Error in conv3d: depth of input ("+c.shape[4]+") must match input depth for filter "+l.shape[3]+"."}),z(function(f,p){return C2(f)||C2(p)}(r,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"}),z(a==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."});var d=nw(c.shape,l.shape,r,i,n),h=J.runKernelFunc(function(f,p){var m=f.conv3d(c,l,d);return p([c,l]),m},{x:c,$filter:l},function(f,p){z(C2(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var m=p[0],v=p[1];return{x:function(){return Eq(m.shape,f,v,r,n)},$filter:function(){return function(g,x,y,b,N){var j=g;g.rank===4&&(j=g.as5D(1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]));var _=x;_.rank===4&&(_=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3])),z(j.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+j.shape+"."}),z(_.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+_.shape+"."}),z(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),z(j.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+j.shape[4]+") must match input depth in filter ("+y[3]+"."}),z(_.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+_.shape[4]+") must match output depth for filter ("+y[4]+")."});var S=nw(j.shape,y,b,1,N);return J.runKernelFunc(function(C){return C.conv3dDerFilter(j,_,S)},{x5D:j,dy5D:_})}(m,f,v.shape,r,n)}}});return u?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),aR=Q({conv2dDerFilter_:function(e,t,r,n,a,i,o){i===void 0&&(i="NHWC");var l=e;e.rank===3&&(l=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var c=t;c.rank===3&&(c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),z(l.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+l.shape+"."}),z(c.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+c.shape+"."}),z(r.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+r+"."});var u=i==="NHWC"?l.shape[3]:l.shape[1],d=i==="NHWC"?c.shape[3]:c.shape[1];z(u===r[2],function(){return"Error in conv2dDerFilter: depth of input "+u+") must match input depth in filter ("+r[2]+"."}),z(d===r[3],function(){return"Error in conv2dDerFilter: depth of dy ("+d+") must match output depth for filter ("+r[3]+")."}),o!=null&&z(rn(a),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."});var h=KT(i),f=th(l.shape,r,n,1,a,o,!1,h);return J.runKernelFunc(function(p){return p.conv2dDerFilter(l,c,f)},{x4D:l,dy4D:c})}}),kq=Q({conv2dDerInput_:Cq}),Pj=Q({depthwiseConv2d_:function(e,t,r,n,a,i,o){i===void 0&&(i=[1,1]);var l=V(e,"x","depthwiseConv2d"),c=V(t,"filter","depthwiseConv2d"),u=l,d=!1;l.rank===3&&(d=!0,u=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),z(u.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+u.rank+"."}),z(c.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+c.rank+"."}),z(u.shape[3]===c.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+u.shape[3]+") must match the inChannels dimension in filter "+c.shape[2]+"."}),i==null&&(i=[1,1]),z(cs(r,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"}),o!=null&&z(rn(n),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+n+"."});var h=th(u.shape,c.shape,r,i,n,o,!0),f=[u,c],p=J.runKernelFunc(function(m,v){var g=m.depthwiseConv2D(u,c,h);return v([u,c]),g},{x:u,filter:c},function(m,v){z(rp(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var g=v[0],x=v[1];return{x:function(){return Aq(g.shape,m,x,h)},filter:function(){return Pq(g,m,x.shape,h)}}},"DepthwiseConv2dNative",h,f);return d?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),Aq=Q({depthwiseConv2dDerInput_:function(e,t,r,n){var a=t,i=!1;t.rank===3&&(i=!0,a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=J.runKernelFunc(function(l){return l.depthwiseConv2DDerInput(a,r,n)},{dy4D:a});return i?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),Pq=Q({depthwiseConv2dDerFilter_:function(e,t,r,n){var a=e;e.rank===3&&(a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),J.runKernelFunc(function(o){return o.depthwiseConv2DDerFilter(a,i,n)},{x4D:a,dy4D:i})}}),sR=Q({separableConv2d_:function(e,t,r,n,a,i,o){i===void 0&&(i=[1,1]),o===void 0&&(o="NHWC");var l=V(e,"x","separableConv2d"),c=V(t,"depthwiseFilter","separableConv2d"),u=V(r,"pointwiseFilter","separableConv2d"),d=l,h=!1;if(l.rank===3&&(h=!0,d=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");z(d.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+d.rank+"."}),z(c.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+c.rank+"."}),z(u.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+c.rank+"."}),z(u.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+u.shape[0]+"."}),z(u.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+u.shape[1]+"."});var f=c.shape[2],p=c.shape[3];z(u.shape[2]===f*p,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*p+", but got "+u.shape[2]+"."});var m=Pj(d,c,n,a,o,i),v=di(m,u,1,"valid",o);return h?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),uve=Q({conv2dTranspose_:function(e,t,r,n,a,i){return Cq(r,V(e,"x","conv2dTranspose"),V(t,"filter","conv2dTranspose"),n,a,"NHWC",i)}}),dve=Q({conv3dTranspose_:function(e,t,r,n,a){return Eq(r,V(e,"x","conv3dTranspose"),V(t,"filter","conv3dTranspose"),n,a)}}),Tj=Q({matMul_:function(e,t,r,n){var a;r===void 0&&(r=!1),n===void 0&&(n=!1);var i=V(e,"a","matMul"),o=V(t,"b","matMul");a=Lr(i,o),i=a[0],o=a[1];var l=r?i.shape[i.rank-2]:i.shape[i.rank-1],c=n?o.shape[o.rank-1]:o.shape[o.rank-2],u=r?i.shape[i.rank-1]:i.shape[i.rank-2],d=n?o.shape[o.rank-2]:o.shape[o.rank-1],h=i.shape.slice(0,-2),f=o.shape.slice(0,-2),p=Qe(h),m=Qe(f);z(i.rank>=2&&o.rank>=2&&i.rank===o.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+o.rank+"."}),z(Gn(h,f),function(){return"Error in matMul: outer dimensions ("+h+") and ("+f+") of Tensors with shapes "+i.shape+" and "+o.shape+" must match."}),z(l===c,function(){return"Error in matMul: inner shapes ("+l+") and ("+c+") of Tensors with shapes "+i.shape+" and "+o.shape+" and transposeA="+r+" and transposeB="+n+" must match."});var v=i.shape.slice(0,-2).concat([u,d]),g=r?i.as3D(p,l,u):i.as3D(p,u,l),x=n?o.as3D(m,d,c):o.as3D(m,c,d),y={transposeA:r,transposeB:n};return J.runKernelFunc(function(b,N){var j=b.batchMatMul(g,x,r,n);return N([g,x]),j},{a:g,b:x},function(b,N){var j=N,_=j[0],S=j[1];return r||n?!r&&n?{a:function(){return b.matMul(S,!1,!1)},b:function(){return b.matMul(_,!0,!1)}}:r&&!n?{a:function(){return S.matMul(b,!1,!0)},b:function(){return _.matMul(b,!1,!1)}}:{a:function(){return S.matMul(b,!0,!0)},b:function(){return b.matMul(_,!0,!0)}}:{a:function(){return b.matMul(S,!1,!0)},b:function(){return _.matMul(b,!0,!1)}}},"BatchMatMul",y).reshape(v)}}),hve=Q({dot_:function(e,t){var r=V(e,"t1","dot"),n=V(t,"t2","dot");z(!(r.rank!==1&&r.rank!==2||n.rank!==1&&n.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+r.rank+" and "+n.rank+"."});var a=r.rank===1?r.size:r.shape[1],i=n.rank===1?n.size:n.shape[0];return z(a===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+i+"."}),r.rank===1&&n.rank===1?r.as2D(1,-1).matMul(n.as2D(-1,1)).asScalar():r.rank===1&&n.rank===2?r.as2D(1,-1).matMul(n.as2D(n.shape[0],n.shape[1])).as1D():r.rank===2&&n.rank===1?r.matMul(n.as2D(-1,1)).as1D():r.matMul(n.as2D(n.shape[0],n.shape[1]))}}),fve=Q({outerProduct_:function(e,t){var r=V(e,"v1","outerProduct"),n=V(t,"v2","outerProduct");return z(r.rank===1&&n.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+r.rank+" and "+n.rank+"."}),r.as2D(-1,1).matMul(n.as2D(1,-1))}}),Ix=Q({reverse_:function(e,t){var r=V(e,"x","reverse");if(r.rank===0)return r.clone();var n=$n(t,r.shape);return J.runKernelFunc(function(a){return a.reverse(r,n)},{$x:r},function(a){return{$x:function(){return a.reverse(n)}}}).reshapeAs(r)}}),pve=Q({reverse1d_:function(e){var t=V(e,"x","reverse");return z(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Ix(t,0)}}),mve=Q({reverse2d_:function(e,t){var r=V(e,"x","reverse");return z(r.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+r.rank+"."}),Ix(r,t)}}),vve=Q({reverse3d_:function(e,t){var r=V(e,"x","reverse");return z(r.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+r.rank+"."}),Ix(r,t)}}),gve=Q({reverse4d_:function(e,t){var r=V(e,"x","reverse");return z(r.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+r.rank+"."}),Ix(r,t)}});function Tq(e,t,r,n,a,i){var o=V(e,"x","maxPool"),l=o,c=!1;o.rank===3&&(c=!0,l=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),z(l.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+l.rank+"."}),z(cs(r,n),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+n+"'"}),i!=null&&z(rn(a),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var u=wg(l.shape,t,r,n,a,i);if(u.filterWidth===1&&u.filterHeight===1&&Gn(u.inShape,u.outShape))return o.clone();var d=[l],h=J.runKernelFunc(function(f,p){var m=f.maxPool(l,u);return p([l,m]),m},{x:l},function(f,p){var m=p[0],v=p[1];return{x:function(){return function(g,x,y,b,N,j,_,S){var C=V(g,"dy","maxPoolBackprop"),E=V(x,"input","maxPoolBackprop"),k=V(y,"output","maxPoolBackprop");z(E.rank===C.rank,function(){return"Rank of input ("+E.rank+") does not match rank of dy ("+C.rank+")"}),z(cs(N,j),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+N+" and dilations '"+j+"'"}),z(C.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+C.rank+"."}),z(E.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+E.rank+"."});var P=wg(E.shape,b,N,j,_,S);return J.runKernelFunc(function(A){return A.maxPoolBackprop(C,E,k,P)},{$dy:C,$input:E})}(f,m,v,t,r,n,a)}}},"MaxPool",u,d);return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function Rq(e,t,r,n,a,i){var o=V(e,"x","avgPool","float32");z(cs(r,n),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+n+"'"});var l=o,c=!1;o.rank===3&&(c=!0,l=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),z(l.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+l.rank+"."}),i!=null&&z(rn(a),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var u=wg(l.shape,t,r,n,a,i);if(u.filterWidth===1&&u.filterHeight===1&&Gn(u.inShape,u.outShape))return o.clone();var d=J.runKernelFunc(function(h){return h.avgPool(l,u)},{x:l},function(h){return{x:function(){return function(f,p,m,v,g,x){var y=V(f,"dy","avgPoolBackprop"),b=V(p,"input","avgPoolBackprop");z(b.rank===y.rank,function(){return"Rank of input ("+b.rank+") does not match rank of dy ("+y.rank+")"}),z(cs(v,g),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+v+" and dilations '"+g+"'"});var N=b,j=y,_=!1;b.rank===3&&(_=!0,N=b.as4D(1,b.shape[0],b.shape[1],b.shape[2]),j=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),z(j.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+j.rank+"."}),z(N.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+N.rank+"."});var S=wg(N.shape,m,v,g,x),C=J.runKernelFunc(function(E){return E.avgPoolBackprop(j,N,S)},{dy4D:j,input4D:N});return _?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}(h,l,t,r,n,a)}}},"AvgPool",u);return d=d.cast(o.dtype),c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}var Un=Q({maxPool_:function(e,t,r,n,a){return Tq(e,t,r,1,n,a)}}),Dx=Q({avgPool_:function(e,t,r,n,a){return Rq(e,t,r,1,n,a)}}),xve=Q({pool_:function(e,t,r,n,a,i){a==null&&(a=[1,1]),i==null&&(i=1),n===0&&(n="valid");var o=V(e,"x","maxPool"),l=o,c=!1;o.rank===3&&(c=!0,l=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),z(cs(i,a),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"});var u,d=wg(l.shape,t,i,a,n),h=[d.dilationHeight,d.dilationWidth];u=n==="same"?function(N,j){var _=N.map(function(E,k){return E+(E-1)*(j[k]-1)}).map(function(E){return E-1}),S=_.map(function(E){return Math.floor(E/2)}),C=_.map(function(E,k){return E-S[k]});return _.map(function(E,k){return[S[k],C[k]]})}([d.filterHeight,d.filterWidth],h):[[0,0],[0,0]];var f=h[0]===1&&h[1]===1,p=function(N,j,_){var S=_.map(function(I){return I[0]}),C=_.map(function(I){return I[1]}),E=N.concat(S,C),k=j.map(function(I,R){return(I-E[R]%I)%I}),P=C.map(function(I,R){return I+k[R]}),A=j.map(function(I,R){return[S[R],P[R]]}),O=j.map(function(I,R){return[0,k[R]]});return[A,O]}([d.inHeight,d.inWidth],h,u),m=p[0],v=p[1],g=f?n:"valid",x=f?l:FW(l,h,m),y=(r==="avg"?function(){return Rq(x,t,i,1,g)}:function(){return Tq(x,t,i,1,g)})(),b=f?y:DW(y,h,v);return c?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),yve=Q({maxPool3d_:function(e,t,r,n,a,i,o){i===void 0&&(i="NDHWC");var l=V(e,"x","maxPool3d"),c=l,u=!1;l.rank===4&&(u=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),o==null&&(o=[1,1,1]),z(c.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+c.rank+"."}),z(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),z(cs(r,o),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+o+"'"}),a!=null&&z(rn(n),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."});var d=rw(c.shape,t,r,o,n,a,i),h=J.runKernelFunc(function(f,p){var m=f.maxPool3d(c,d);return p([c,m]),m},{x:c},function(f,p){var m=p[0],v=p[1];return{x:function(){return function(g,x,y,b,N,j,_,S){var C=V(g,"dy","maxPool3dBackprop"),E=V(x,"input","maxPool3dBackprop"),k=V(y,"output","maxPool3dBackprop"),P=C,A=E,O=k,I=!1;E.rank===4&&(I=!0,P=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3]),A=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3]),O=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3])),z(P.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+P.rank+"."}),z(A.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+A.rank+"."}),z(O.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+O.rank+"."}),j==null&&(j=[1,1,1]),z(cs(N,j),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+N+" and dilations '"+j+"'"}),S!=null&&z(rn(_),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+S+" but got pad "+_+"."});var R=rw(A.shape,b,N,j,_,S),M=J.runKernelFunc(function(B){return B.maxPool3dBackprop(P,A,O,R)},{dy5D:P,input5D:A});return I?M.as4D(M.shape[1],M.shape[2],M.shape[3],M.shape[4]):M}(f,m,v,t,r,o,n,a)}}});return u?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),bve=Q({avgPool3d_:function(e,t,r,n,a,i,o){i===void 0&&(i="NDHWC");var l=V(e,"x","avgPool3d","float32"),c=l,u=!1;l.rank===4&&(u=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),o==null&&(o=[1,1,1]),z(c.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+c.rank+"."}),z(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),z(cs(r,o),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+o+"'"}),a!=null&&z(rn(n),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."});var d=rw(c.shape,t,r,o,n,a,i),h=J.runKernelFunc(function(f){return f.avgPool3d(c,d)},{x:c},function(f){return{x:function(){return function(p,m,v,g,x,y,b){var N=V(p,"dy","avgPool3dBackprop"),j=V(m,"input","avgPool3dBackprop"),_=N,S=j,C=!1;j.rank===4&&(C=!0,_=N.as5D(1,N.shape[0],N.shape[1],N.shape[2],N.shape[3]),S=j.as5D(1,j.shape[0],j.shape[1],j.shape[2],j.shape[3])),z(_.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+_.rank+"."}),z(S.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+S.rank+"."}),x==null&&(x=[1,1,1]),z(cs(g,x),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+x+"'"}),b!=null&&z(rn(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+b+" but got pad "+y+"."});var E=rw(S.shape,v,g,x,y,b),k=J.runKernelFunc(function(P){return P.avgPool3dBackprop(_,S,E)},{dy5D:_,input5D:S});return C?k.as4D(k.shape[1],k.shape[2],k.shape[3],k.shape[4]):k}(f,c,t,r,o,n,a)}}});return h=h.cast(c.dtype),u?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Do=Q({slice_:function(e,t,r){var n,a,i=V(e,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(n=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(c){z(c!==-1,function(){return"slice() does not support negative begin indexing."})}),a=(a=r==null?new Array(i.rank).fill(-1):typeof r=="number"?[r].concat(new Array(i.rank-1).fill(-1)):r.length<i.rank?r.concat(new Array(i.rank-r.length).fill(-1)):r).map(function(c,u){return c>=0?c:(z(c===-1,function(){return"Negative size values should be exactly -1 but got "+c+" for the slice() size at index "+u+"."}),i.shape[u]-n[u])}),Khe(i,n,a);var o=i.shape,l={begin:n,size:a};return J.runKernelFunc(function(c){return c.slice(i,n,a)},{x:i},function(c){for(var u=[],d=0;d<c.rank;d++)u.push([n[d],o[d]-n[d]-a[d]]);return{x:function(){return c.pad(u)}}},"Slice",l)}}),wve=Q({slice1d_:function(e,t,r){var n=V(e,"x","slice1d");return z(n.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+n.rank+" tensor"}),Do(n,[t],[r])}}),jve=Q({slice2d_:function(e,t,r){var n=V(e,"x","slice2d");return z(n.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+n.rank+" tensor"}),Do(n,t,r)}}),Oq=Q({slice3d_:function(e,t,r){var n=V(e,"x","slice3d");return z(n.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+n.rank+" tensor"}),Do(n,t,r)}}),Nve=Q({slice4d_:function(e,t,r){var n=V(e,"x","slice4d");return z(n.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+n.rank+" tensor"}),Do(n,t,r)}});function Iq(e,t,r,n,a){return t.rank<r.rank&&(t=t.reshape(ls(t.shape,n))),e.rank<r.rank&&(e=e.reshape(ls(e.shape,n))),{x:function(){var i=e.mul(r.equal(t).cast(e.dtype));return a==null?i:i.transpose(a)}}}var _ve=Q({all_:function(e,t,r){t===void 0&&(t=null),r===void 0&&(r=!1);var n=V(e,"x","all","bool"),a=$n(t,n.shape),i=a,o=Vo(i,n.rank);o!=null&&(n=n.transpose(o),i=zo(i.length,n.rank));var l=J.runKernelFunc(function(u){return u.all(n,i)},{$x:n});if(r){var c=ls(l.shape,a);return l.reshape(c)}return l}}),Sve=Q({any_:function(e,t,r){t===void 0&&(t=null),r===void 0&&(r=!1);var n=V(e,"x","any","bool"),a=$n(t,n.shape),i=a,o=Vo(i,n.rank);o!=null&&(n=n.transpose(o),i=zo(i.length,n.rank));var l=J.runKernelFunc(function(u){return u.any(n,i)},{$x:n});if(r){var c=ls(l.shape,a);return l.reshape(c)}return l}}),Cve=Q({argMax_:function(e,t){t===void 0&&(t=0);var r=V(e,"x","argMax");t==null&&(t=0);var n=$n(t,r.shape),a=Vo(n,r.rank);a!=null&&(r=r.transpose(a),n=zo(n.length,r.rank));var i={axis:n[0]},o=[r];return J.runKernelFunc(function(l,c){var u=l.argMax(r,n[0]);return c([r]),u},{x:r},function(l,c){var u=c[0];return{x:function(){return Xt(u)}}},"ArgMax",i,o)}}),Eve=Q({argMin_:function(e,t){t===void 0&&(t=0);var r=V(e,"x","argMin");t==null&&(t=0);var n=$n(t,r.shape),a=Vo(n,r.rank);return a!=null&&(r=r.transpose(a),n=zo(n.length,r.rank)),J.runKernelFunc(function(i,o){var l=i.argMin(r,n[0]);return o([r]),l},{$x:r},function(i,o){var l=o[0];return{$x:function(){return Xt(l)}}})}}),kve=Q({logSumExp_:function(e,t,r){t===void 0&&(t=null),r===void 0&&(r=!1);var n=V(e,"x","logSumExp"),a=$n(t,n.shape),i=n.max(a,!0),o=n.sub(i).exp().sum(a).log(),l=i.reshape(o.shape).add(o);if(r){var c=ls(l.shape,a);return l.reshape(c)}return l}}),Rj=Q({max_:function(e,t,r){t===void 0&&(t=null),r===void 0&&(r=!1);var n=V(e,"x","max"),a=n,i=$n(t,n.shape),o=i,l=Vo(o,n.rank);l!=null&&(n=n.transpose(l),o=zo(o.length,n.rank));var c=[n],u=J.runKernelFunc(function(h,f){var p=h.max(n,o);return f([a,p]),p},{x:n},function(h,f){return Iq(h,f[1],f[0],i,l)},"Max",{axes:o},c,[!0]);if(r){var d=ls(u.shape,i);u=u.reshape(d)}return u}}),Ave=Q({mean_:function(e,t,r){t===void 0&&(t=null),r===void 0&&(r=!1);var n=V(e,"x","mean"),a=$n(t,n.shape),i=Qe(ma(n.shape,a)[1]);return Ej(function(o){var l=Fe(i);return{value:(l.dtype===o.dtype?o:o.cast(l.dtype)).div(l).sum(t,r),gradFunc:function(c){var u=o.shape.slice();return a.forEach(function(d){u[d]=1}),c.reshape(u).mul(Jp(o.shape,"float32")).div(i)}}})(n)}}),Pve=Q({min_:function(e,t,r){t===void 0&&(t=null),r===void 0&&(r=!1);var n=V(e,"x","min"),a=n,i=$n(t,n.shape),o=i,l=Vo(o,n.rank);l!=null&&(n=n.transpose(l),o=zo(o.length,n.rank));var c=[n],u=J.runKernelFunc(function(h,f){var p=h.min(n,o);return f([a,p]),p},{x:n},function(h,f){return Iq(h,f[1],f[0],i,l)},"Min",{axes:o},c,[!0]);if(r){var d=ls(u.shape,i);u=u.reshape(d)}return u}}),Tve=Q({moments_:function(e,t,r){t===void 0&&(t=null),r===void 0&&(r=!1);var n=$n(t,(e=V(e,"x","moments")).shape),a=e.mean(n,r),i=a.shape;r||(i=ls(a.shape,n));var o=e.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:o.mean(n,r)}}}),Dq=Q({sum_:function(e,t,r){t===void 0&&(t=null),r===void 0&&(r=!1);var n=V(e,"x","sum");n.dtype==="bool"&&(n=n.toInt());var a=$n(t,n.shape);return Ej(function(i){var o=Vo(a,i.rank),l=a,c=i;o!=null&&(c=i.transpose(o),l=zo(l.length,i.rank));var u=function(p){var m=i.shape.slice();return a.forEach(function(v){m[v]=1}),p.reshape(m).mul(Jp(i.shape,"float32"))},d={axes:l},h=J.runKernelFunc(function(p){return p.sum(c,l)},{x:c},function(p){return{x:function(){return u(p)}}},"Sum",d);if(r){var f=ls(h.shape,a);h=h.reshape(f)}return{value:h,gradFunc:u}})(n)}}),Rve=Q({prod_:function(e,t,r){t===void 0&&(t=null),r===void 0&&(r=!1);var n=V(e,"x","prod");n.dtype==="bool"&&(n=n.toInt());var a=$n(t,n.shape),i=Vo(a,n.rank),o=a,l=n;i!=null&&(l=n.transpose(i),o=zo(o.length,n.rank));var c=J.runKernelFunc(function(d){return d.prod(l,o)},{permutedX:l});if(r){var u=ls(c.shape,a);c=c.reshape(u)}return c}}),Mq=Q({elu_:function(e){var t=V(e,"x","elu");return J.runKernelFunc(function(r,n){var a=r.elu(t);return n([a]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){return J.runKernelFunc(function(i){return i.eluDer(r,a)},{dy:r,y:a})}}})}}),Ove=Q({leakyRelu_:function(e,t){t===void 0&&(t=.2);var r=V(e,"x","leakyRelu");return rR(Fe(t).mul(r),r)}}),$q=Q({prelu_:function(e,t){var r=V(e,"x","prelu"),n=V(t,"alpha","prelu");return J.runKernelFunc(function(a,i){var o=a.prelu(r,n);return i([r,n]),o},{x:r,alpha:n},function(a,i){var o=i[0],l=i[1],c=o.greater(0);return{x:function(){return Od(c,a,a.mul(l))},alpha:function(){var u=Od(c,Xt(a),a.mul(o)),d=In(l.shape,a.shape);return d.length>0&&(u=u.sum(d)),u.reshape(l.shape)}}},"Prelu")}}),Dr=Q({relu_:function(e){var t=V(e,"x","relu");return t.dtype==="bool"?t.toInt():J.runKernelFunc(function(r,n){var a=r.relu(t);return n([t]),a},{x:t},function(r,n){var a=n[0];return{x:function(){return r.mulStrict(a.step().toFloat())}}},"Relu")}}),Fq=Q({relu6_:function(e){var t=V(e,"x","relu6");return t.dtype==="bool"?t.toInt():J.runKernelFunc(function(r,n){var a=r.relu6(t);return n([t]),a},{x:t},function(r,n){var a=n[0],i=a.lessEqual(6).mul(a.step());return{x:function(){return r.mulStrict(i.toFloat())}}},"Relu6")}}),Ive=Q({selu_:function(e){var t=V(e,"x","selu");return J.runKernelFunc(function(r,n){var a=r.selu(t);return n([t]),a},{$x:t},function(r,n){var a=n[0];return{$x:function(){var i=a.greater(Fe(0)),o=Fe(JT),l=Fe(eR),c=r.mul(l),u=r.mul(o).mul(a.toFloat().exp());return Od(i,c,u)}}})}}),eu=Q({transpose_:function(e,t){var r=V(e,"x","transpose");if(t==null&&(t=r.shape.map(function(a,i){return i}).reverse()),z(r.rank===t.length,function(){return"Error in transpose: rank of input "+r.rank+" must match length of perm "+t+"."}),t.forEach(function(a){z(a>=0&&a<r.rank,function(){return"All entries in 'perm' must be between 0 and "+(r.rank-1)+" but got "+t})}),r.rank<=1)return r.clone();var n={perm:t};return J.runKernelFunc(function(a){return a.transpose(r,t)},{x:r},function(a){var i=zT(t);return{x:function(){return a.transpose(i)}}},"Transpose",n)}}),Dve=Q({localResponseNormalization_:function(e,t,r,n,a){t===void 0&&(t=5),r===void 0&&(r=1),n===void 0&&(n=1),a===void 0&&(a=.5);var i=V(e,"x","localResponseNormalization");z(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),z(rn(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var o=i,l=!1;i.rank===3&&(l=!0,o=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var c=J.runKernelFunc(function(u,d){var h=u.localResponseNormalization4D(o,t,r,n,a);return d([o,h]),h},{x4D:o},function(u,d){var h=d[0],f=d[1];return{x4D:function(){return J.runKernelFunc(function(p){return p.LRNGrad(u,h,f,t,r,n,a)},{})}}});return l?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),Lq=Q({norm_:function(e,t,r,n){t===void 0&&(t="euclidean"),r===void 0&&(r=null),n===void 0&&(n=!1);var a=function l(c,u,d){if(d===void 0&&(d=null),c.rank===0)return c.abs();if(c.rank!==1&&d===null)return l(c.reshape([-1]),u,d);if(c.rank===1||typeof d=="number"||Array.isArray(d)&&d.length===1){if(u===1)return c.abs().sum(d);if(u===1/0)return c.abs().max(d);if(u===-1/0)return c.abs().min(d);if(u==="euclidean"||u===2)return c.abs().pow(Fe(2,"int32")).sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+u)}if(Array.isArray(d)&&d.length===2){if(u===1)return c.abs().sum(d[0]).max(d[1]-1);if(u===1/0)return c.abs().sum(d[1]).max(d[0]);if(u===-1/0)return c.abs().sum(d[1]).min(d[0]);if(u==="fro"||u==="euclidean")return c.square().sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+u)}throw new Error("Error in norm: invalid axis: "+d)}(e=V(e,"x","norm"),t,r),i=a.shape;if(n){var o=$n(r,e.shape);i=ls(a.shape,o)}return a.reshape(i)}}),Mve=Q({basicLSTMCell_:function(e,t,r,n,a,i){var o=V(e,"forgetBias","basicLSTMCell"),l=V(t,"lstmKernel","basicLSTMCell"),c=V(r,"lstmBias","basicLSTMCell"),u=V(n,"data","basicLSTMCell"),d=V(a,"c","basicLSTMCell"),h=V(i,"h","basicLSTMCell"),f=u.concat(h,1).matMul(l).add(c),p=f.shape[0],m=f.shape[1]/4,v=[p,m],g=f.slice([0,0],v),x=f.slice([0,m],v),y=f.slice([0,2*m],v),b=f.slice([0,3*m],v),N=g.sigmoid().mulStrict(x.tanh()).addStrict(d.mulStrict(o.add(y).sigmoid())),j=N.tanh().mulStrict(b.sigmoid());return[N,j]}}),$ve=Q({multiRNNCell_:function(e,t,r,n){for(var a=V(t,"data","multiRNNCell"),i=X0(r,"c","multiRNNCell"),o=X0(n,"h","multiRNNCell"),l=a,c=[],u=0;u<e.length;u++){var d=e[u](l,i[u],o[u]);c.push(d[0]),c.push(d[1]),l=d[1]}var h=[],f=[];for(u=0;u<c.length;u+=2)h.push(c[u]),f.push(c[u+1]);return[h,f]}}),Fve=Q({movingAverage_:function(e,t,r,n,a){a===void 0&&(a=!0);var i=V(e,"v","movingAverage"),o=V(t,"x","movingAverage"),l=V(r,"decay","movingAverage");Dde(i,o),z(Gn(i.shape,o.shape),function(){return"Shape mismatch in v and x"});var c=Fe(1),u=c.sub(l),d=o.sub(i).mul(u);if(a){z(n!=null,function(){return"When using zeroDebias: true, step is required."});var h=V(n,"step","movingAverage");d=d.div(c.sub(iw(l,h)))}return i.add(d)}}),Lve=Q({stridedSlice_:function(e,t,r,n,a,i,o,l,c){if(a===void 0&&(a=0),i===void 0&&(i=0),o===void 0&&(o=0),l===void 0&&(l=0),c===void 0&&(c=0),n==null&&(n=new Array(t.length)),o!==0)throw new Error("ellipsis mask is not yet supported");var u=V(e,"x","stridedSlice"),d=XM(l),h=u.shape.slice();d.forEach(function(g){t[g]=0,r[g]=1,h.splice(g,0,1)}),u=u.reshape(h);for(var f=0;f<u.rank;f++)t[f]=Yhe(a,t,n,u.shape,f),r[f]=Xhe(i,r,n,u.shape,f),n[f]=n[f]||1;var p=XM(c);p.forEach(function(g){r[g]=t[g]+1,n[g]=1});var m=HT(t,r,n),v=m.filter(function(g,x){return p.indexOf(x)===-1});return n.every(function(g){return g===1})?Do(u,t,m).reshape(v):J.runKernelFunc(function(g){return g.stridedSlice(u,t,r,n)},{$x:u}).reshape(v)}}),Bve=Q({topk_:function(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!0);var n=V(e,"x","topk");if(n.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var a=n.shape[n.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+t);var i=J.runKernelFunc(function(o){return o.topk(n,t,r)},{$x:n});return{values:i[0],indices:i[1]}}}),Uve=Q({scatterND_:function(e,t,r){var n=V(e,"indices","scatterND","int32"),a=V(t,"updates","scatterND");return Hhe(a,n,r),J.runKernelFunc(function(i){return i.scatterND(n,a,r)},{indices:n,updates:a},null,"ScatterNd",{shape:r})}}),iR=Q({fft_:function(e){z(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],r=e.size/t,n=e.as2D(r,t);return J.runKernelFunc(function(a){return a.fft(n)},{input:e}).reshape(e.shape)}}),ow=Q({ifft_:function(e){z(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],r=e.size/t,n=e.as2D(r,t);return J.runKernelFunc(function(a){return a.ifft(n)},{input:e}).reshape(e.shape)}}),oR=Q({rfft_:function(e,t){z(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var r,n=e.shape[e.shape.length-1],a=e.size/n;if(t!=null&&t<n){var i=e.shape.map(function(x){return 0}),o=e.shape.map(function(x){return x});o[e.shape.length-1]=t,r=e.slice(i,o),n=t}else if(t!=null&&t>n){var l=e.shape.map(function(x){return x});l[e.shape.length-1]=t-n,r=e.concat(_r(l),e.shape.length-1),n=t}else r=e;var c=r.zerosLike(),u=ea(r,c).as2D(a,n),d=iR(u),h=Math.floor(n/2)+1,f=Zs(d),p=vo(d),m=f.split([h,n-h],f.shape.length-1),v=p.split([h,n-h],p.shape.length-1),g=r.shape.slice();return g[r.shape.length-1]=h,ea(m[0],v[0]).reshape(g)}}),Bq=Q({irfft_:function(e){var t=e.shape[e.shape.length-1],r=e.size/t;if(t<=2){var n=e.as2D(r,t),a=ow(n);return Zs(a)}var i=[r,2*(t-1)],o=Zs(e).as2D(r,t),l=vo(e).as2D(r,t),c=o.slice([0,1],[r,t-2]).reverse(1),u=l.slice([0,1],[r,t-2]).reverse(1).mul(Fe(-1)),d=o.concat(c,1),h=l.concat(u,1);return n=ea(d,h).as2D(i[0],i[1]),a=ow(n),Zs(a)}}),Vve=Object.freeze({fft:iR,ifft:ow,rfft:oR,irfft:Bq}),zve=Q({sparseToDense_:function(e,t,r,n){n===void 0&&(n=0);var a=V(e,"sparseIndices","sparseToDense","int32"),i=V(t,"sparseValues","sparseToDense"),o=V(n,"defaultValue","sparseToDense",i.dtype);return function(l,c,u,d){if(l.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+l.dtype+".");if(l.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+l.shape+".");var h=l.rank>0?l.shape[0]:1,f=l.rank>1?l.shape[1]:1;if(u.length!==f)throw new Error("outputShape has incorrect number of elements:, "+u.length+", should be: "+f+".");var p=c.size;if(c.rank!==0&&(c.rank!==1||p!==h))throw new Error("sparseValues has incorrect shape "+c.shape+", should be [] or ["+h+"]");if(c.dtype!==d.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,r,o),J.runKernelFunc(function(l){return l.sparseToDense(a,i,r,o)},{$sparseIndices:a,$sparseValues:i,$defaultValue:o})}}),Wve=Q({gatherND_:function(e,t){var r=V(t,"indices","gatherND","int32"),n=V(e,"x","gatherND");return J.runKernelFunc(function(a){return a.gatherND(n,r)},{x:n,indices:r},null,"GatherNd")}}),qve=Q({diag_:function(e){var t=V(e,"x","diag").flatten(),r=e.shape.concat(e.shape);return J.runKernelFunc(function(n){return n.diag(t)},{$x:t}).reshape(r)}}),Gve=Q({dropout_:function(e,t,r,n){var a=V(e,"x","dropout");if(z(a.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."}),z(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof Ir?a.clone():a;var i=function(c,u){if(u==null)return c.shape.slice();if(Gn(c.shape,u))return u;if(c.shape.length===u.length){for(var d=[],h=0;h<c.shape.length;h++)u[h]==null&&c.shape[h]!=null?d.push(c.shape[h]):d.push(u[h]);return d}return u}(a,r),o=1-t,l=$W(i,0,1,"float32",n).add(o).floor().div(o);return a.mul(l)}});function Uq(e,t,r){for(var n=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+n-1);a[i]=t-r*Math.cos(o)}return dn(a,"float32")}var lR=Q({hannWindow_:function(e){return Uq(e,.5,.5)}}),Vq=Q({hammingWindow_:function(e){return Uq(e,.54,.46)}}),cR=Q({frame_:function(e,t,r,n,a){n===void 0&&(n=!1),a===void 0&&(a=0);for(var i=0,o=[];i+t<=e.size;)o.push(Do(e,i,t)),i+=r;if(n)for(;i<e.size;){var l=i+t-e.size,c=Tn([Do(e,i,t-l),Ao([l],a)]);o.push(c),i+=r}return o.length===0?Vc([],[0,t]):Tn(o).as2D(o.length,t)}}),zq=Q({stft_:function(e,t,r,n,a){var i;a===void 0&&(a=lR),n==null&&(i=t,n=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var o=cR(e,t,r),l=ja(o,a(t)),c=[],u=0;u<o.shape[0];u++)c.push(oR(l.slice([u,0],[1,t]),n));return Tn(c)}}),Hve=Object.freeze({hannWindow:lR,hammingWindow:Vq,frame:cR,stft:zq}),wa,Kve=function(e,t,r){return r===void 0&&(r=1),Ye(this,void 0,void 0,function(){var n,a,i,o,l,c,u,d,h,f,p,m,v,g;return Xe(this,function(x){switch(x.label){case 0:return n=V(e,"predictions","inTopK"),a=V(t,"targets","inTopK"),z(n.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+n.rank}),z(n.rank-1===a.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+n.rank+" and targets rank "+a.rank}),nr(n.shape.slice(0,n.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=n.shape[n.shape.length-1],z(r>0&&r<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+r}),[4,n.data()];case 1:return o=x.sent(),[4,a.data()];case 2:for(l=x.sent(),c=[o.length/i,i],d=c[1],h=xg("bool",u=c[0]),f=0;f<u;f++){for(p=f*d,m=o.subarray(p,p+d),v=[],g=0;g<m.length;g++)v.push({value:m[g],index:g});for(v.sort(function(y,b){return b.value-y.value}),h[f]=0,g=0;g<r;g++)if(v[g].index===l[f]){h[f]=1;break}}return e!==n&&n.dispose(),t!==a&&a.dispose(),[2,ra(h,a.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(wa||(wa={}));var Yve=Q({absoluteDifference_:function(e,t,r,n){n===void 0&&(n=wa.SUM_BY_NONZERO_WEIGHTS);var a=V(e,"labels","absoluteDifference"),i=V(t,"predictions","absoluteDifference"),o=null;r!=null&&(o=V(r,"weights","absoluteDifference")),nr(a.shape,i.shape,"Error in absoluteDifference: ");var l=a.sub(i).abs();return $l(l,o,n)}}),$l=Q({computeWeightedLoss_:function(e,t,r){r===void 0&&(r=wa.SUM_BY_NONZERO_WEIGHTS);var n=V(e,"losses","computeWeightedLoss"),a=null;t!=null&&(a=V(t,"weights","computeWeightedLoss"));var i=a==null?n:n.mul(a);if(r===wa.NONE)return i;if(r===wa.SUM)return i.sum();if(r===wa.MEAN){if(a==null)return i.mean();var o=n.size/a.size,l=i.sum().div(a.sum());return o>1?l.div(Fe(o)):l}if(r===wa.SUM_BY_NONZERO_WEIGHTS){if(a==null)return i.sum().div(Fe(n.size));var c=a.mul(Jp(n.shape)).notEqual(Fe(0)).sum().toFloat();return i.sum().div(c)}throw Error("Unknown reduction: "+r)}}),Xve=Q({cosineDistance_:function(e,t,r,n,a){a===void 0&&(a=wa.SUM_BY_NONZERO_WEIGHTS);var i=V(e,"labels","cosineDistance"),o=V(t,"predictions","cosineDistance"),l=null;n!=null&&(l=V(n,"weights","cosineDistance")),nr(i.shape,o.shape,"Error in cosineDistance: ");var c=Fe(1).sub(i.mul(o).sum(r,!0));return $l(c,l,a)}}),Qve=Q({hingeLoss_:function(e,t,r,n){n===void 0&&(n=wa.SUM_BY_NONZERO_WEIGHTS);var a=V(e,"labels","hingeLoss"),i=V(t,"predictions","hingeLoss"),o=null;r!=null&&(o=V(r,"weights","hingeLoss")),nr(a.shape,i.shape,"Error in hingeLoss: ");var l=Fe(1);a=Fe(2).mul(a).sub(l);var c=l.sub(a.mul(i)).relu();return $l(c,o,n)}}),Zve=Q({huberLoss_:function(e,t,r,n,a){n===void 0&&(n=1),a===void 0&&(a=wa.SUM_BY_NONZERO_WEIGHTS);var i=V(e,"labels","huberLoss"),o=V(t,"predictions","huberLoss"),l=null;r!=null&&(l=V(r,"weights","huberLoss")),nr(i.shape,o.shape,"Error in huberLoss: ");var c=Fe(n),u=o.sub(i).abs(),d=jq(u,c),h=u.sub(d),f=Fe(.5).mul(d.square()).add(c.mul(h));return $l(f,l,a)}}),Jve=Q({logLoss_:function(e,t,r,n,a){n===void 0&&(n=1e-7),a===void 0&&(a=wa.SUM_BY_NONZERO_WEIGHTS);var i=V(e,"labels","logLoss"),o=V(t,"predictions","logLoss"),l=null;r!=null&&(l=V(r,"weights","logLoss")),nr(i.shape,o.shape,"Error in logLoss: ");var c=Fe(1),u=Fe(n),d=i.mul(o.add(u).log()).neg().sub(c.sub(i).mul(c.sub(o).add(u).log()));return $l(d,l,a)}}),ege=Q({meanSquaredError_:function(e,t,r,n){n===void 0&&(n=wa.SUM_BY_NONZERO_WEIGHTS);var a=V(e,"labels","meanSquaredError"),i=V(t,"predictions","meanSquaredError"),o=null;r!=null&&(o=V(r,"weights","meanSquaredError")),nr(a.shape,i.shape,"Error in meanSquaredError: ");var l=a.squaredDifference(i);return $l(l,o,n)}}),tge=Q({sigmoidCrossEntropy_:function(e,t,r,n,a){n===void 0&&(n=0),a===void 0&&(a=wa.SUM_BY_NONZERO_WEIGHTS);var i=V(e,"multiClassLabels","sigmoidCrossEntropy"),o=V(t,"logits","sigmoidCrossEntropy"),l=null;if(r!=null&&(l=V(r,"weights","sigmoidCrossEntropy")),nr(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),n>0){var c=Fe(n),u=Fe(1),d=Fe(.5);i=i.mul(u.sub(c)).add(d.mul(c))}var h=function(f,p){var m=V(f,"labels","sigmoidCrossEntropyWithLogits"),v=V(p,"logits","sigmoidCrossEntropyWithLogits");nr(m.shape,v.shape,"Error in sigmoidCrossEntropyWithLogits: ");var g=v.relu(),x=v.mul(m),y=v.abs().neg().exp().log1p();return g.sub(x).add(y)}(i,o);return $l(h,l,a)}}),rge=Q({softmaxCrossEntropy_:function(e,t,r,n,a){n===void 0&&(n=0),a===void 0&&(a=wa.SUM_BY_NONZERO_WEIGHTS);var i=V(e,"onehotLabels","softmaxCrossEntropy"),o=V(t,"logits","softmaxCrossEntropy"),l=null;if(r!=null&&(l=V(r,"weights","softmaxCrossEntropy")),nr(i.shape,o.shape,"Error in softmaxCrossEntropy: "),n>0){var c=Fe(n),u=Fe(1),d=Fe(i.shape[1]);i=i.mul(u.sub(c)).add(c.div(d))}var h=function(f,p,m){if(m===void 0&&(m=-1),m===-1&&(m=p.rank-1),m!==p.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+p.rank+" and dim was "+m);return Ej(function(v,g,x){var y=g.logSumExp([m],!0),b=g.toFloat().sub(y);return x([v,b]),{value:b.mul(v).neg().sum([m]),gradFunc:function(N,j){var _=j[0],S=j[1],C=ls(N.shape,[m]);return[N.reshape(C).mul(_.toFloat().sub(S.exp())),N.reshape(C).mul(S.exp().sub(_.toFloat()))]}}})(f,p)}(i,o);return $l(h,l,a)}}),nge=Object.freeze({get Reduction(){return wa},absoluteDifference:Yve,computeWeightedLoss:$l,cosineDistance:Xve,hingeLoss:Qve,huberLoss:Zve,logLoss:Jve,meanSquaredError:ege,sigmoidCrossEntropy:tge,softmaxCrossEntropy:rge});function x3(e,t){return t===void 0&&(t=!1),J.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var r=e.shape[0],n=e.shape[1],a=MW(r),i=e.clone(),o=Vc([[1]],[1,1]),l=o.clone(),c=r>=n?n:r,u=function(h){var f,p=i,m=l,v=a;f=J.tidy(function(){var g=i.slice([h,h],[r-h,1]),x=g.norm(),y=i.slice([h,h],[1,1]),b=Vc([[-1]]).where(y.greater(0),Vc([[1]])),N=y.sub(b.mul(x)),j=g.div(N);l=j.shape[0]===1?o.clone():o.concat(j.slice([1,0],[j.shape[0]-1,j.shape[1]]),0);var _=b.matMul(N).div(x).neg(),S=i.slice([h,0],[r-h,n]),C=_.mul(l);if(h===0)i=S.sub(C.matMul(l.transpose().matMul(S)));else{var E=S.sub(C.matMul(l.transpose().matMul(S)));i=i.slice([0,0],[h,n]).concat(E,0)}var k=a.slice([0,h],[r,a.shape[1]-h]);if(h===0)a=k.sub(k.matMul(l).matMul(C.transpose()));else{var P=k.sub(k.matMul(l).matMul(C.transpose()));a=a.slice([0,0],[r,h]).concat(P,1)}return[l,i,a]}),l=f[0],i=f[1],a=f[2],os([p,m,v])},d=0;d<c;++d)u(d);return!t&&r>n&&(a=a.slice([0,0],[r,n]),i=i.slice([0,0],[n,n])),[a,i]})}var age=Q({bandPart_:function(e,t,r){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(r%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+r+".");var n=V(e,"a","bandPart");if(n.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+n.rank+".");var a=n.shape,i=n.shape.slice(-2),o=i[0],l=i[1];if(!(t<=o))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+o+").");if(!(r<=l))throw new Error("bandPart(): numUpper ("+r+") must not be greater than the number of columns ("+l+").");t<0&&(t=o),r<0&&(r=l);var c=Q0(0,o,1,"int32").reshape([-1,1]),u=Q0(0,l,1,"int32"),d=Dn(c,u),h=Aj(d.lessEqual(Fe(+t,"int32")),d.greaterEqual(Fe(-r,"int32"))),f=_r([o,l],n.dtype);return Is(Rn(n.reshape([-1,o,l])).map(function(p){return Od(h,p,f)})).reshape(a)}}),sge=Q({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,z(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var r=e[0].shape[0],n=function(c){z(e[c].shape[0]===r,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[c].shape[0]+" vs. "+r+")"})},a=1;a<e.length;++a)n(a)}else t=!0,e=qT(e,e.shape[0],0).map(function(c){return LW(c,[0])});z(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var i=[],o=e,l=function(c){i.push(J.tidy(function(){var u=o[c];if(c>0)for(var d=0;d<c;++d){var h=Dq(i[d].mulStrict(u)).mul(i[d]);u=u.sub(h)}return u.div(Lq(u,"euclidean"))}))};for(a=0;a<e.length;++a)l(a);return t?Is(i,0):i}}),ige=Q({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return x3(e,t);var r=e.shape.slice(0,e.shape.length-2).reduce(function(o,l){return o*l}),n=Rn(e.reshape([r,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];return n.forEach(function(o){var l=x3(o,t),c=l[0],u=l[1];a.push(c),i.push(u)}),[Is(a,0).reshape(e.shape),Is(i,0).reshape(e.shape)]}}),oge=Object.freeze({bandPart:age,gramSchmidt:sge,qr:ige});function Oj(e,t,r,n,a,i){n==null&&(n=.5),a==null&&(a=Number.NEGATIVE_INFINITY),i==null&&(i=0);var o=e.shape[0];return r=Math.min(r,o),z(0<=n&&n<=1,function(){return"iouThreshold must be in [0, 1], but was '"+n+"'"}),z(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),z(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),z(t.rank===1,function(){return"scores must be a 1D tensor"}),z(t.shape[0]===o,function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+t.shape[0]}),z(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:r,iouThreshold:n,scoreThreshold:a,softNmsSigma:i}}var lge=Q({resizeBilinear_:function(e,t,r){r===void 0&&(r=!1);var n=V(e,"images","resizeBilinear");z(n.rank===3||n.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+n.rank+"."}),z(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var a=n,i=!1;n.rank===3&&(i=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var o=t[0],l=t[1],c=J.runKernelFunc(function(u,d){return d([a]),u.resizeBilinear(a,o,l,r)},{x:a},function(u,d){return{x:function(){return J.runKernelFunc(function(h){return h.resizeBilinearBackprop(u,d[0],r)},{})}}},"ResizeBilinear",{alignCorners:r,newHeight:o,newWidth:l});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),cge=Q({resizeNearestNeighbor_:function(e,t,r){r===void 0&&(r=!1);var n=V(e,"images","resizeNearestNeighbor");z(n.rank===3||n.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+n.rank+"."}),z(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),z(n.dtype==="float32"||n.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var a=n,i=!1;n.rank===3&&(i=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var o=t[0],l=t[1],c=J.runKernelFunc(function(u,d){return d([a]),u.resizeNearestNeighbor(a,o,l,r)},{batchImages:a},function(u,d){return{batchImages:function(){return J.runKernelFunc(function(h){return h.resizeNearestNeighborBackprop(u,d[0],r)},{})}}});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),uge=Q({nonMaxSuppression_:function(e,t,r,n,a){n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY);var i=V(e,"boxes","nonMaxSuppression"),o=V(t,"scores","nonMaxSuppression"),l=Oj(i,o,r,n,a);r=l.maxOutputSize,n=l.iouThreshold,a=l.scoreThreshold;var c={maxOutputSize:r,iouThreshold:n,scoreThreshold:a};return J.runKernelFunc(function(u){return u.nonMaxSuppression(i,o,r,n,a)},{boxes:i,scores:o},null,"NonMaxSuppressionV3",c)}}),dge=function(e,t,r,n,a){return n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),Ye(this,void 0,void 0,function(){var i,o,l,c,u,d,h;return Xe(this,function(f){switch(f.label){case 0:return i=V(e,"boxes","nonMaxSuppressionAsync"),o=V(t,"scores","nonMaxSuppressionAsync"),l=Oj(i,o,r,n,a),r=l.maxOutputSize,n=l.iouThreshold,a=l.scoreThreshold,[4,Promise.all([i.data(),o.data()])];case 1:return c=f.sent(),u=c[0],d=c[1],h=YT(u,d,r,n,a),i!==e&&i.dispose(),o!==t&&o.dispose(),[2,h]}})})},hge=Q({nonMaxSuppressionWithScore_:function(e,t,r,n,a,i){n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var o=V(e,"boxes","nonMaxSuppression"),l=V(t,"scores","nonMaxSuppression"),c=Oj(o,l,r,n,a,i),u={maxOutputSize:r=c.maxOutputSize,iouThreshold:n=c.iouThreshold,scoreThreshold:a=c.scoreThreshold,softNmsSigma:i=c.softNmsSigma},d=J.runKernel("NonMaxSuppressionV5",{boxes:o,scores:l},u);return{selectedIndices:d[0],selectedScores:d[1]}}}),fge=function(e,t,r,n,a,i){return n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),Ye(this,void 0,void 0,function(){var o,l,c,u,d,h,f;return Xe(this,function(p){switch(p.label){case 0:return o=V(e,"boxes","nonMaxSuppressionAsync"),l=V(t,"scores","nonMaxSuppressionAsync"),c=Oj(o,l,r,n,a,i),r=c.maxOutputSize,n=c.iouThreshold,a=c.scoreThreshold,i=c.softNmsSigma,[4,Promise.all([o.data(),l.data()])];case 1:return u=p.sent(),d=u[0],h=u[1],f=XT(d,h,r,n,a,i),o!==e&&o.dispose(),l!==t&&l.dispose(),[2,f]}})})},pge=Q({cropAndResize_:function(e,t,r,n,a,i){var o=V(e,"image","cropAndResize"),l=V(t,"boxes","cropAndResize","float32"),c=V(r,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var u=l.shape[0];return z(o.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."}),z(l.rank===2&&l.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+u+",4] but had shape "+l.shape+"."}),z(c.rank===1&&c.shape[0]===u,function(){return"Error in cropAndResize: boxInd must be have size ["+u+"] but had shape "+l.shape+"."}),z(n.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+n.length+"."}),z(n[0]>=1&&n[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+n}),z(a==="bilinear"||a==="nearest",function(){return"method must be bilinear or nearest, but was "+a}),J.runKernelFunc(function(d,h){return d.cropAndResize(o,l,c,n,a,i)},{images:o,boxes:l,boxInd:c},null,"CropAndResize",{method:a,extrapolationValue:i,cropSize:n})}}),uR=Object.freeze({resizeBilinear:lge,resizeNearestNeighbor:cge,nonMaxSuppression:uge,nonMaxSuppressionAsync:dge,nonMaxSuppressionWithScore:hge,nonMaxSuppressionWithScoreAsync:fge,cropAndResize:pge}),dR=function(e,t){return!(e>0)||t==="linear"},hR=function(e,t,r){if(r==null||r==="linear")return e;if(r==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+r+" has not been implemented yet.")},fR=function(e,t){var r=t,n=In(e.shape,t.shape);return n.length>0&&(r=r.sum(n)),r.reshape(e.shape)},pR=function(e,t,r){if(t==="linear")return e;if(t==="relu")return Dr(e);if(t==="elu")return Mq(e);if(t==="relu6")return Fq(e);if(t==="prelu")return $q(e,r);throw new Error("Unknown fused activation "+t+".")},mge=Q({fusedMatMul_:function(e){var t,r=e.a,n=e.b,a=e.transposeA,i=a!==void 0&&a,o=e.transposeB,l=o!==void 0&&o,c=e.bias,u=e.activation,d=u===void 0?"linear":u,h=e.preluActivationWeights;if(dR(J.state.gradientDepth,d)===!1){var f=Tj(r,n,i,l);return c!=null&&(f=Mt(f,c)),pR(f,d,h)}var p=V(r,"a","fused matMul"),m=V(n,"b","fused matMul");t=Lr(p,m),p=t[0],m=t[1];var v=i?p.shape[p.rank-2]:p.shape[p.rank-1],g=l?m.shape[m.rank-1]:m.shape[m.rank-2],x=i?p.shape[p.rank-1]:p.shape[p.rank-2],y=l?m.shape[m.rank-2]:m.shape[m.rank-1],b=p.shape.slice(0,-2),N=m.shape.slice(0,-2),j=Qe(b),_=Qe(N);z(p.rank>=2&&m.rank>=2&&p.rank===m.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+p.rank+" and "+m.rank+"."}),z(Gn(b,N),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+N+") of Tensors with shapes "+p.shape+" and "+m.shape+" must match."}),z(v===g,function(){return"Error in fused matMul: inner shapes ("+v+") and ("+g+") of Tensors with shapes "+p.shape+" and "+m.shape+" and transposeA="+i+" and transposeB="+l+" must match."});var S,C,E=p.shape.slice(0,-2).concat([x,y]),k=i?p.as3D(j,v,x):p.as3D(j,x,v),P=l?m.as3D(_,y,g):m.as3D(_,g,y);c!=null&&Vt(E,(S=Lr(S=V(c,"bias","fused matMul"),p)[0]).shape),h!=null&&(C=V(h,"prelu weights","fused matMul"));var A={a:k,b:P};c!=null&&(A.bias=S),h!=null&&(A.preluActivationWeights=C);var O=[k,P];return J.runKernelFunc(function(I,R){var M=I.fusedBatchMatMul({a:k,b:P,transposeA:i,transposeB:l,bias:S,activation:d,preluActivationWeights:C});return R([k,P,M]),M},A,function(I,R){var M=R[0],B=R[1],$=R[2],D=hR(I,$,d),W={};return c!=null&&(W={bias:function(){return fR(S,D)}}),Object.assign(i||l?!i&&l?{a:function(){return D.matMul(B,!1,!1)},b:function(){return D.matMul(M,!0,!1)}}:i&&!l?{a:function(){return B.matMul(D,!1,!0)},b:function(){return M.matMul(D,!1,!1)}}:{a:function(){return B.matMul(D,!0,!0)},b:function(){return D.matMul(M,!0,!0)}}:{a:function(){return D.matMul(B,!1,!0)},b:function(){return M.matMul(D,!0,!1)}},W)},"_FusedMatMul",{transposeA:i,transposeB:l,activation:d},O,[!0]).reshape(E)}}),vge=Q({fusedConv2d_:function(e){var t=e.x,r=e.filter,n=e.strides,a=e.pad,i=e.dataFormat,o=i===void 0?"NHWC":i,l=e.dilations,c=l===void 0?[1,1]:l,u=e.dimRoundingMode,d=e.bias,h=e.activation,f=h===void 0?"linear":h,p=e.preluActivationWeights;if(f=f||"linear",dR(J.state.gradientDepth,f)===!1){var m=di(t,r,n,a,o,c,u);return d!=null&&(m=Mt(m,d)),pR(m,f,p)}var v=V(t,"x","conv2d"),g=V(r,"filter","conv2d"),x=v,y=!1;v.rank===3&&(y=!0,x=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),z(x.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+x.rank+"."}),z(g.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+g.rank+"."}),u!=null&&z(rn(a),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+a+"."}),z(x.shape[3]===g.shape[2],function(){return"Error in conv2d: depth of input ("+x.shape[3]+") must match input depth for filter "+g.shape[2]+"."}),z(cs(n,c),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+c+"'"}),z(o==="NHWC",function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."});var b,N,j=th(x.shape,g.shape,n,c,a,u);d!=null&&(b=Lr(b=V(d,"bias","fused conv2d"),v)[0],Vt(j.outShape,b.shape)),p!=null&&(N=V(p,"prelu weights","fused conv2d"));var _={x,filter:g};d!=null&&(_.bias=b),p!=null&&(_.preluActivationWeights=N);var S=[g,x],C=J.runKernelFunc(function(E,k){var P=E.fusedConv2d({input:x,filter:g,convInfo:j,bias:b,activation:f,preluActivationWeights:N});return k([g,x,P]),P},_,function(E,k){var P=k,A=P[0],O=P[1],I=P[2],R=hR(E,I,f);z(rp(c),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+c+"'"});var M={};return d!=null&&(M={bias:function(){return fR(b,R)}}),Object.assign({x:function(){return kq(O.shape,R,A,n,a)},filter:function(){return aR(O,R,A.shape,n,a)}},M)},"FusedConv2D",{convInfo:j,activation:f},S,[!0]);return y?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),gge=Q({fusedDepthwiseConv2d_:function(e){var t=e.x,r=e.filter,n=e.strides,a=e.pad,i=e.dataFormat,o=i===void 0?"NHWC":i,l=e.dilations,c=l===void 0?[1,1]:l,u=e.dimRoundingMode,d=e.bias,h=e.activation,f=h===void 0?"linear":h,p=e.preluActivationWeights;if(dR(J.state.gradientDepth,f)===!1){var m=Pj(t,r,n,a,o,c,u);return d!=null&&(m=Mt(m,d)),pR(m,f,p)}var v=V(t,"x","depthwiseConv2d"),g=V(r,"filter","depthwiseConv2d"),x=v,y=!1;v.rank===3&&(y=!0,x=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),z(x.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+x.rank+"."}),z(g.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."}),z(x.shape[3]===g.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+x.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."}),c==null&&(c=[1,1]),z(cs(n,c),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+c+"'"}),u!=null&&z(rn(a),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+u+" but got pad "+a+"."});var b,N,j=th(x.shape,g.shape,n,c,a,u,!0);d!=null&&(b=Lr(b=V(d,"bias","fused conv2d"),v)[0],Vt(j.outShape,b.shape)),p!=null&&(N=V(p,"prelu weights","fused depthwiseConv2d"));var _={x,filter:g};d!=null&&(_.bias=b),p!=null&&(_.preluActivationWeights=N);var S=[g,x],C=J.runKernelFunc(function(E,k){var P=E.fusedDepthwiseConv2D({input:x,filter:g,convInfo:j,bias:b,activation:f,preluActivationWeights:N});return k([g,x,P]),P},_,function(E,k){z(rp(c),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+c+"'"});var P=k[0],A=k[1],O=k[2],I=hR(E,O,f),R={};return d!=null&&(R={bias:function(){return fR(b,I)}}),Object.assign({x:function(){return Aq(A.shape,I,P,j)},filter:function(){return Pq(A,I,P.shape,j)}},R)},"FusedDepthwiseConv2D",{convInfo:j,activation:f},S,[!0]);return y?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),xge=Object.freeze({matMul:mge,conv2d:vge,depthwiseConv2d:gge}),yge=Object.freeze({image:uR,linalg:oge,losses:nge,spectral:Vve,fused:xge,signal:Hve,square:Jpe,squaredDifference:hq,conv1d:lve,conv2d:di,conv3d:cve,depthwiseConv2d:Pj,separableConv2d:sR,conv2dTranspose:uve,conv3dTranspose:dve,op:Q,batchNormalization2d:Ame,batchNormalization3d:Pme,batchNormalization4d:Tme,batchNormalization:Rme,batchNorm:xq,batchNorm2d:Ome,batchNorm3d:Ime,batchNorm4d:Dme,booleanMaskAsync:ove,complex:ea,real:Zs,imag:vo,concat:Tn,concat1d:xhe,concat2d:yhe,concat3d:bhe,concat4d:whe,split:qT,matMul:Tj,dot:hve,outerProduct:fve,reverse:Ix,reverse1d:pve,reverse2d:mve,reverse3d:vve,reverse4d:gve,maxPool:Un,avgPool:Dx,pool:xve,maxPool3d:yve,avgPool3d:bve,slice:Do,slice1d:wve,slice2d:jve,slice3d:Oq,slice4d:Nve,abs:eme,acos:tme,acosh:rme,asin:nme,asinh:ame,atan:sme,atanh:ime,ceil:ome,clipByValue:tR,cos:lme,cosh:cme,erf:ume,exp:TE,expm1:dme,floor:hme,log:fme,log1p:pme,logSigmoid:mme,neg:sw,reciprocal:vme,round:gme,rsqrt:fq,sigmoid:pq,sign:xme,isNaN:yme,isInf:bme,isFinite:wme,sin:jme,sinh:Nme,softplus:_me,sqrt:Sme,step:Cme,tan:Eme,tanh:kme,all:_ve,any:Sve,argMax:Cve,argMin:Eve,logSumExp:kve,max:Rj,mean:Ave,min:Pve,moments:Tve,sum:Dq,prod:Rve,equal:Nq,equalStrict:Qme,greater:Zme,greaterEqual:_q,greaterEqualStrict:Jme,greaterStrict:eve,less:tve,lessEqual:rve,lessEqualStrict:nve,lessStrict:ave,notEqual:sve,notEqualStrict:ive,add:Mt,addN:Fme,addStrict:Lme,atan2:Bme,div:Ti,divNoNan:Ume,divStrict:Vme,floorDiv:wq,maximum:rR,maximumStrict:zme,minimum:jq,minimumStrict:Wme,mod:qme,modStrict:Gme,mul:ja,mulStrict:Hme,pow:iw,powStrict:Kme,squaredDifferenceStrict:Yme,sub:Dn,subStrict:Xme,elu:Mq,leakyRelu:Ove,prelu:$q,relu:Dr,relu6:Fq,selu:Ive,logicalAnd:Aj,logicalNot:Mme,logicalOr:yq,logicalXor:$me,where:Od,whereAsync:bq,buffer:yt,print:Phe,batchToSpaceND:DW,broadcastTo:The,cast:Rhe,clone:Ohe,cumsum:Ihe,depthToSpace:Dhe,expandDims:Qs,eye:MW,multinomial:Mhe,oneHot:EE,pad:eh,pad1d:$he,pad2d:Fhe,pad3d:Lhe,pad4d:Bhe,rand:Uhe,randomNormal:Vhe,randomGamma:zhe,randomUniform:$W,reshape:Mi,spaceToBatchND:FW,squeeze:LW,stack:Is,tile:vf,truncatedNormal:Whe,unstack:Rn,setdiff1dAsync:qhe,fill:Ao,linspace:ghe,ones:Jp,range:Q0,scalar:Fe,tensor:ra,tensor1d:dn,tensor2d:Vc,tensor3d:WT,tensor4d:es,tensor5d:phe,tensor6d:mhe,variable:vhe,zeros:_r,onesLike:IW,zerosLike:Xt,transpose:eu,softmax:Ml,logSoftmax:Zhe,localResponseNormalization:Dve,norm:Lq,gather:nR,unsortedSegmentSum:Sq,basicLSTMCell:Mve,multiRNNCell:$ve,movingAverage:Fve,stridedSlice:Lve,topk:Bve,scatterND:Uve,fft:iR,ifft:ow,rfft:oR,irfft:Bq,sparseToDense:zve,gatherND:Wve,diag:qve,dropout:Gve,hannWindow:lR,hammingWindow:Vq,frame:cR,stft:zq,inTopKAsync:Kve});function we(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(r){r!=null&&z(r.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function E2(e,t,r,n){if(r==="linear")return e.linear(t);if(r==="relu")return e.relu(t);if(r==="elu")return e.elu(t);if(r==="relu6")return e.relu6(t);if(r==="prelu")return e.prelu(t,n);throw new Error("Activation "+r+" has not been implemented for the CPU backend.")}var bge=function(e){function t(){var r=e.call(this)||this;return r.blockSize=48,r.firstUse=!0,r.data=new GW(r,J),r}return Ji(t,e),t.prototype.write=function(r,n,a){this.firstUse&&(this.firstUse=!1,fe().get("IS_NODE")&&Y0(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:r,dtype:a}),i},t.prototype.move=function(r,n,a,i){this.data.set(r,{values:n,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(r){return Ye(this,void 0,void 0,function(){return Xe(this,function(n){return[2,this.readSync(r)]})})},t.prototype.readSync=function(r){var n=this.data.get(r),a=n.dtype,i=n.complexTensors;return a==="complex64"?PE(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(r).values},t.prototype.bufferSync=function(r){var n=this.readSync(r.dataId),a=n;if(r.dtype==="string")try{a=n.map(function(i){return G0(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return yt(r.shape,r.dtype,a)},t.prototype.makeOutput=function(r,n,a){var i=this.write(r,n,a);return J.makeTensorFromDataId(i,n,a,this)},t.prototype.disposeData=function(r){if(this.data.has(r)){var n=this.data.get(r).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.data.delete(r)}},t.prototype.time=function(r){return Ye(this,void 0,void 0,function(){var n;return Xe(this,function(a){return n=fo(),r(),[2,{kernelMs:fo()-n}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(r,n){var a=this.makeOutput(null,r.shape,"complex64");return this.data.get(a.dataId).complexTensors={real:J.keep(r.clone()),imag:J.keep(n.clone())},a},t.prototype.real=function(r){return this.data.get(r.dataId).complexTensors.real.clone()},t.prototype.imag=function(r){return this.data.get(r.dataId).complexTensors.imag.clone()},t.prototype.slice=function(r,n,a){if(we(r,"slice"),WW(r.shape,n,a)){var i=qW(n,r.strides),o=Qe(a);return ra(this.readSync(r.dataId).subarray(i,i+o),a,r.dtype)}for(var l=yt(a,r.dtype),c=this.bufferSync(r),u=0;u<l.size;++u){var d=l.indexToLoc(u).map(function(h,f){return h+n[f]});l.values[u]=c.get.apply(c,d)}return l.toTensor()},t.prototype.stridedSlice=function(r,n,a,i){we(r,"stridedSlice");var o=HT(n,a,i);if(o.some(function(p){return p===0}))return ra([],o);for(var l=yt(o,r.dtype),c=this.bufferSync(r),u=0;u<l.size;u++){for(var d=l.indexToLoc(u),h=new Array(d.length),f=0;f<h.length;f++)h[f]=d[f]*i[f]+n[f];l.set.apply(l,[c.get.apply(c,h)].concat(d))}return l.toTensor()},t.prototype.diag=function(r){for(var n=this.readSync(r.dataId),a=yt([r.size,r.size],r.dtype),i=a.values,o=0;o<n.length;o++)i[o*r.size+o]=n[o];return a.toTensor()},t.prototype.unstack=function(r,n){for(var a=r.shape[n],i=new Array(r.rank-1),o=0,l=0;l<r.rank;l++)l!==n&&(i[o++]=r.shape[l]);var c=new Array(r.rank).fill(0),u=r.shape.slice();u[n]=1;var d=new Array(a);for(l=0;l<d.length;l++)c[n]=l,d[l]=this.slice(r,c,u).reshape(i);return d},t.prototype.reverse=function(r,n){we(r,"reverse");for(var a=yt(r.shape,r.dtype),i=this.bufferSync(r),o=function(c){var u=a.indexToLoc(c),d=u.slice();n.forEach(function(h){return d[h]=r.shape[h]-1-d[h]}),a.set.apply(a,[i.get.apply(i,d)].concat(u))},l=0;l<a.size;l++)o(l);return a.toTensor()},t.prototype.concat=function(r,n){var a=this;if(r[0].dtype==="complex64"){var i=r.map(function(p){return Zs(p)}),o=r.map(function(p){return vo(p)});return ea(this.concat(i,n),this.concat(o,n))}var l=r.map(function(p){var m=Qe(p.shape.slice(n));return p.as2D(-1,m)}),c=tp(l.map(function(p){return p.shape}),1),u=yt(c,r[0].dtype).values;if(l[0].shape[0]===1){var d=0;l.forEach(function(p){u.set(a.readSync(p.dataId),d),d+=p.size})}else{var h=0;l.forEach(function(p){for(var m=a.readSync(p.dataId),v=0,g=0;g<p.shape[0];++g)for(var x=g*c[1]+h,y=0;y<p.shape[1];++y)u[x+y]=m[v++];h+=p.shape[1]})}var f=tp(r.map(function(p){return p.shape}),n);return ra(u,f,r[0].dtype)},t.prototype.neg=function(r){return we(r,"neg"),this.multiply(Fe(-1),r)},t.prototype.add=function(r,n){return r.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(r.cast("complex64"),n.cast("complex64"),function(a,i,o,l){return{real:a+o,imag:i+l}}):this.broadcastedBinaryOp(r,n,ta(r.dtype,n.dtype),function(a,i){return a+i})},t.prototype.addN=function(r){var n=this;we(r,"addN");for(var a=r.map(function(d){return n.readSync(d.dataId)}),i=yt(r[0].shape,r[0].dtype),o=i.values,l=0;l<r.length;l++)for(var c=a[l],u=0;u<o.length;u++)o[u]+=c[u];return i.toTensor()},t.prototype.softmax=function(r,n){var a=$n([n],r.shape),i=this.max(r,a),o=ls(i.shape,a),l=this.subtract(r,i.reshape(o)),c=this.exp(l),u=this.sum(c,a).reshape(o);return this.realDivide(c,u)},t.prototype.subtract=function(r,n){return r.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(r.cast("complex64"),n.cast("complex64"),function(a,i,o,l){return{real:a-o,imag:i-l}}):this.broadcastedBinaryOp(r,n,ta(r.dtype,n.dtype),function(a,i){return a-i})},t.prototype.pow=function(r,n){return we([r,n],"pow"),this.broadcastedBinaryOp(r,n,r.dtype,function(a,i){return Math.pow(a,i)})},t.prototype.batchMatMul=function(r,n,a,i){we([r,n],"matMul");for(var o=a?r.shape[1]:r.shape[2],l=a?r.shape[2]:r.shape[1],c=i?n.shape[1]:n.shape[2],u=r.shape[0],d=this.readSync(r.dataId),h=this.readSync(n.dataId),f=a?[r.strides[0],1,r.strides[1]]:[r.strides[0],r.strides[1],1],p=f[0],m=f[1],v=f[2],g=i?[1,n.strides[1],n.strides[0]]:[n.strides[1],1,n.strides[0]],x=g[0],y=g[1],b=g[2],N=l*c,j=yt([u,l,c],r.dtype),_=j.values,S=this.blockSize,C=0;C<u;C++)for(var E=0;E<l;E+=S)for(var k=0;k<c;k+=S)for(var P=0;P<o;P+=S)for(var A=Math.min(E+S,l),O=Math.min(k+S,c),I=Math.min(P+S,o),R=E;R<A;R++)for(var M=k;M<O;M++){for(var B=0,$=P;$<I;$++)B+=d[C*p+R*m+$*v]*h[$*x+M*y+C*b];_[C*N+(R*c+M)]+=B}return j.toTensor()},t.prototype.fusedBatchMatMul=function(r){var n=r.a,a=r.b,i=r.transposeA,o=r.transposeB,l=r.bias,c=r.activation,u=r.preluActivationWeights,d=this.batchMatMul(n,a,i,o);return l&&(d=this.add(d,l)),c&&(d=E2(this,d,c,u)),d},t.prototype.multiply=function(r,n){return r.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(r.cast("complex64"),n.cast("complex64"),function(a,i,o,l){return{real:a*o-i*l,imag:a*l+i*o}}):this.broadcastedBinaryOp(r,n,ta(r.dtype,n.dtype),function(a,i){return a*i})},t.prototype.realDivide=function(r,n){return we([r,n],"realDivide"),this.broadcastedBinaryOp(r,n,"float32",function(a,i){return a/i})},t.prototype.floorDiv=function(r,n){return we([r,n],"floorDiv"),this.broadcastedBinaryOp(r,n,"int32",function(a,i){return Math.floor(a/i)})},t.prototype.sum=function(r,n){we(r,"sum"),bs("sum",n,r.rank);for(var a=ma(r.shape,n),i=a[0],o=a[1],l=_r(i,ta(r.dtype,"int32")),c=Qe(o),u=this.readSync(l.dataId),d=this.readSync(r.dataId),h=0;h<u.length;++h){for(var f=h*c,p=0,m=0;m<c;++m)p+=d[f+m];u[h]=p}return l},t.prototype.prod=function(r,n){we(r,"sum");for(var a=ma(r.shape,n),i=a[0],o=a[1],l=_r(i,ta(r.dtype,"int32")),c=Qe(o),u=this.readSync(l.dataId),d=this.readSync(r.dataId),h=0;h<u.length;++h){for(var f=h*c,p=1,m=0;m<c;++m)p*=d[f+m];u[h]=p}return l},t.prototype.unsortedSegmentSum=function(r,n,a){we(r,"unsortedSegmentSum");for(var i=[],o=r.rank-n.rank,l=0;l<o;++l)n=n.expandDims(l+1);for(l=0;l<a;++l){var c=Fe(l,"int32"),u=Nq(c,n).asType("float32").mul(r).sum(0);i.push(u)}return Is(i)},t.prototype.argMin=function(r,n){we(r,"argMin");var a=[n];bs("argMin",a,r.rank);for(var i=ma(r.shape,a),o=i[0],l=i[1],c=_r(o,"int32"),u=Qe(l),d=this.readSync(c.dataId),h=this.readSync(r.dataId),f=0;f<d.length;++f){for(var p=f*u,m=h[p],v=0,g=0;g<u;++g){var x=h[p+g];x<m&&(m=x,v=g)}d[f]=v}return c},t.prototype.argMax=function(r,n){we(r,"argMax");var a=[n];bs("argMax",a,r.rank);for(var i=ma(r.shape,a),o=i[0],l=i[1],c=_r(o,"int32"),u=Qe(l),d=this.readSync(c.dataId),h=this.readSync(r.dataId),f=0;f<d.length;++f){for(var p=f*u,m=h[p],v=0,g=0;g<u;++g){var x=h[p+g];x>m&&(m=x,v=g)}d[f]=v}return c},t.prototype.cumsum=function(r,n,a,i){if(we(r,"cumsum"),n!==r.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(r.rank-1)+" but got axis="+n);for(var o=ta(r.dtype,"int32"),l=_r(r.shape,o),c=this.readSync(l.dataId),u=this.readSync(r.dataId),d=r.shape[r.rank-1],h=i?function(g,x){return g+d-x-1}:function(g,x){return g+x},f=0;f<u.length;f+=d)for(var p=0;p<d;p++){var m=h(f,p);if(p===0)c[m]=a?0:u[m];else{var v=h(f,p-1);c[m]=a?u[v]+c[v]:u[m]+c[v]}}return l},t.prototype.equal=function(r,n){return we([r,n],"equal"),this.broadcastedBinaryOp(r,n,"bool",function(a,i){return a===i?1:0})},t.prototype.notEqual=function(r,n){return we([r,n],"notEqual"),this.broadcastedBinaryOp(r,n,"bool",function(a,i){return a!==i?1:0})},t.prototype.less=function(r,n){return we([r,n],"less"),this.broadcastedBinaryOp(r,n,"bool",function(a,i){return a<i?1:0})},t.prototype.lessEqual=function(r,n){return we([r,n],"lessEqual"),this.broadcastedBinaryOp(r,n,"bool",function(a,i){return a<=i?1:0})},t.prototype.greater=function(r,n){return we([r,n],"greater"),this.broadcastedBinaryOp(r,n,"bool",function(a,i){return a>i?1:0})},t.prototype.greaterEqual=function(r,n){return we([r,n],"greaterEqual"),this.broadcastedBinaryOp(r,n,"bool",function(a,i){return a>=i?1:0})},t.prototype.logicalNot=function(r){we(r,"logicalNot");for(var n=this.readSync(r.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)a[i]=n[i]?0:1;return this.makeOutput(a,r.shape,"bool")},t.prototype.logicalAnd=function(r,n){return we([r,n],"logicalAnd"),this.broadcastedBinaryOp(r,n,"bool",function(a,i){return a&&i})},t.prototype.logicalOr=function(r,n){return we([r,n],"logicalOr"),this.broadcastedBinaryOp(r,n,"bool",function(a,i){return a||i})},t.prototype.select=function(r,n,a){we([r,n,a],"select");for(var i=this.readSync(r.dataId),o=this.readSync(n.dataId),l=this.readSync(a.dataId),c=_r(n.shape,ta(n.dtype,a.dtype)),u=this.readSync(c.dataId),d=0,h=r.rank===0||r.rank>1||n.rank===1?1:Qe(n.shape.slice(1)),f=0;f<i.length;f++)for(var p=0;p<h;p++)i[f]===1?u[d++]=o[f]:u[d++]=l[f];return c},t.prototype.where=function(r){we([r],"where");var n=this.readSync(r.dataId);return QT(r.shape,n)},t.prototype.topk=function(r,n,a){return we(r,"topk"),eq(this.readSync(r.dataId),r.shape,r.dtype,n)},t.prototype.min=function(r,n){we(r,"min"),bs("min",n,r.rank);for(var a=ma(r.shape,n),i=a[0],o=a[1],l=_r(i,r.dtype),c=Qe(o),u=this.readSync(l.dataId),d=this.readSync(r.dataId),h=0;h<u.length;++h){for(var f=h*c,p=d[f],m=0;m<c;++m){var v=d[f+m];v<p&&(p=v)}u[h]=p}return l},t.prototype.minimum=function(r,n){return we([r,n],"minimum"),this.broadcastedBinaryOp(r,n,r.dtype,function(a,i){return Math.min(a,i)})},t.prototype.mod=function(r,n){return we([r,n],"mod"),this.broadcastedBinaryOp(r,n,r.dtype,function(a,i){var o=a%i;return a<0&&i<0||a>=0&&i>=0?o:(o+i)%i})},t.prototype.max=function(r,n){we(r,"max"),bs("max",n,r.rank);for(var a=ma(r.shape,n),i=a[0],o=a[1],l=_r(i,r.dtype),c=Qe(o),u=this.readSync(l.dataId),d=this.readSync(r.dataId),h=0;h<u.length;++h){for(var f=h*c,p=d[f],m=0;m<c;++m){var v=d[f+m];v>p&&(p=v)}u[h]=p}return l},t.prototype.maximum=function(r,n){return we([r,n],"maximum"),this.broadcastedBinaryOp(r,n,r.dtype,function(a,i){return Math.max(a,i)})},t.prototype.all=function(r,n){we(r,"all"),bs("all",n,r.rank);for(var a=ma(r.shape,n),i=a[0],o=a[1],l=_r(i,r.dtype),c=Qe(o),u=this.readSync(l.dataId),d=this.readSync(r.dataId),h=0;h<u.length;++h){for(var f=h*c,p=d[f],m=0;m<c;++m){var v=d[f+m];p=p&&v}u[h]=p}return l},t.prototype.any=function(r,n){we(r,"any"),bs("any",n,r.rank);for(var a=ma(r.shape,n),i=a[0],o=a[1],l=_r(i,r.dtype),c=Qe(o),u=this.readSync(l.dataId),d=this.readSync(r.dataId),h=0;h<u.length;++h){for(var f=h*c,p=d[f],m=0;m<c;++m){var v=d[f+m];p=p||v}u[h]=p}return l},t.prototype.squaredDifference=function(r,n){return we([r,n],"squaredDifference"),this.broadcastedBinaryOp(r,n,r.dtype,function(a,i){var o=a-i;return o*o})},t.prototype.ceil=function(r){we(r,"ceil");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.ceil(n[i]);return this.makeOutput(a,r.shape,"float32")},t.prototype.floor=function(r){we(r,"floor");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.floor(n[i]);return this.makeOutput(a,r.shape,"float32")},t.prototype.sign=function(r){we(r,"x");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)n[i]<0?a[i]=-1:n[i]>0?a[i]=1:a[i]=0;return this.makeOutput(a,r.shape,"float32")},t.prototype.isNaN=function(r){we(r,"x");for(var n=this.readSync(r.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Number.isNaN(n[i])&&(a[i]=1);return this.makeOutput(a,r.shape,"bool")},t.prototype.isInf=function(r){we(r,"x");for(var n=this.readSync(r.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Math.abs(n[i])===1/0&&(a[i]=1);return this.makeOutput(a,r.shape,"bool")},t.prototype.isFinite=function(r){we(r,"x");for(var n=this.readSync(r.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Number.isFinite(n[i])&&(a[i]=1);return this.makeOutput(a,r.shape,"bool")},t.prototype.round=function(r){we(r,"round");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var o=Math.floor(n[i]);n[i]-o<.5?a[i]=Math.floor(n[i]):n[i]-o>.5?a[i]=Math.ceil(n[i]):a[i]=o%2==0?o:o+1}return this.makeOutput(a,r.shape,"float32")},t.prototype.exp=function(r){we(r,"exp");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.exp(n[i]);return this.makeOutput(a,r.shape,"float32")},t.prototype.expm1=function(r){we(r,"expm1");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.expm1(n[i]);return this.makeOutput(a,r.shape,"float32")},t.prototype.log=function(r){we(r,"log");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var o=n[i];a[i]=Math.log(o)}return this.makeOutput(a,r.shape,"float32")},t.prototype.log1p=function(r){we(r,"log1p");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var o=n[i];a[i]=Math.log1p(o)}return this.makeOutput(a,r.shape,"float32")},t.prototype.sqrt=function(r){we(r,"sqrt");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var o=n[i];a[i]=Math.sqrt(o)}return this.makeOutput(a,r.shape,"float32")},t.prototype.rsqrt=function(r){we(r,"rsqrt");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var o=n[i];a[i]=1/Math.sqrt(o)}return this.makeOutput(a,r.shape,"float32")},t.prototype.reciprocal=function(r){we(r,"reciprocal");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=1/n[i];return this.makeOutput(a,r.shape,"float32")},t.prototype.linear=function(r){return r},t.prototype.relu=function(r){we(r,"relu");for(var n=_r(r.shape,r.dtype),a=this.readSync(n.dataId),i=this.readSync(r.dataId),o=0;o<i.length;++o)a[o]=Math.max(0,i[o]);return n},t.prototype.relu6=function(r){we(r,"relu");for(var n=_r(r.shape,r.dtype),a=this.readSync(n.dataId),i=this.readSync(r.dataId),o=0;o<i.length;++o)a[o]=Math.min(Math.max(0,i[o]),6);return n},t.prototype.prelu=function(r,n){return we([r,n],"prelu"),this.broadcastedBinaryOp(r,n,r.dtype,function(a,i){return a<0?i*a:a})},t.prototype.elu=function(r){we(r,"elu");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i){var o=a[i];n[i]=o>=0?o:Math.exp(o)-1}return this.makeOutput(n,r.shape,"float32")},t.prototype.eluDer=function(r,n){we([r,n],"eluDer");for(var a=new Float32Array(n.size),i=this.readSync(n.dataId),o=this.readSync(r.dataId),l=0;l<i.length;++l){var c=i[l];a[l]=c>=1?o[l]:o[l]*(c+1)}return this.makeOutput(a,n.shape,"float32")},t.prototype.selu=function(r){we(r,"selu");for(var n=JT,a=eR,i=new Float32Array(r.size),o=this.readSync(r.dataId),l=0;l<o.length;++l){var c=o[l];i[l]=c>=0?a*c:n*(Math.exp(c)-1)}return this.makeOutput(i,r.shape,"float32")},t.prototype.clip=function(r,n,a){we(r,"clip");for(var i=new Float32Array(r.size),o=this.readSync(r.dataId),l=0;l<o.length;++l){var c=o[l];i[l]=c>a?a:c<n?n:c}return this.makeOutput(i,r.shape,"float32")},t.prototype.abs=function(r){for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.abs(a[i]);return this.makeOutput(n,r.shape,"float32")},t.prototype.complexAbs=function(r){for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<r.size;++i){var o=a[2*i],l=a[2*i+1];n[i]=Math.hypot(o,l)}return this.makeOutput(n,r.shape,"float32")},t.prototype.int=function(r){we(r,"int");for(var n=new Int32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=a[i];return this.makeOutput(n,r.shape,"int32")},t.prototype.sigmoid=function(r){we(r,"sigmoid");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=1/(1+Math.exp(-a[i]));return this.makeOutput(n,r.shape,"float32")},t.prototype.softplus=function(r){we(r,"softplus");for(var n=Math.log(11920928955078125e-23)+2,a=new Float32Array(r.size),i=this.readSync(r.dataId),o=0;o<i.length;++o){var l=i[o]>-n,c=i[o]<n,u=Math.exp(i[o]),d=void 0;d=c?u:l?i[o]:Math.log(1+u),a[o]=d}return this.makeOutput(a,r.shape,"float32")},t.prototype.sin=function(r){we(r,"sin");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.sin(a[i]);return this.makeOutput(n,r.shape,"float32")},t.prototype.cos=function(r){we(r,"cos");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.cos(a[i]);return this.makeOutput(n,r.shape,"float32")},t.prototype.tan=function(r){we(r,"tan");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.tan(a[i]);return this.makeOutput(n,r.shape,"float32")},t.prototype.asin=function(r){we(r,"asin");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.asin(a[i]);return this.makeOutput(n,r.shape,"float32")},t.prototype.acos=function(r){we(r,"acos");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.acos(a[i]);return this.makeOutput(n,r.shape,"float32")},t.prototype.atan=function(r){we(r,"atan");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.atan(a[i]);return this.makeOutput(n,r.shape,"float32")},t.prototype.atan2=function(r,n){return we([r,n],"atan2"),this.broadcastedBinaryOp(r,n,r.dtype,function(a,i){return Math.atan2(a,i)})},t.prototype.sinh=function(r){we(r,"sinh");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.sinh(a[i]);return this.makeOutput(n,r.shape,"float32")},t.prototype.cosh=function(r){we(r,"cosh");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.cosh(a[i]);return this.makeOutput(n,r.shape,"float32")},t.prototype.tanh=function(r){we(r,"tanh");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=wde(a[i]);return this.makeOutput(n,r.shape,"float32")},t.prototype.asinh=function(r){we(r,"asinh");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.asinh(a[i]);return this.makeOutput(n,r.shape,"float32")},t.prototype.acosh=function(r){we(r,"acosh");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.acosh(a[i]);return this.makeOutput(n,r.shape,"float32")},t.prototype.atanh=function(r){we(r,"atanh");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.atanh(a[i]);return this.makeOutput(n,r.shape,"float32")},t.prototype.erf=function(r){we(r,"erf");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i){var o=Math.sign(a[i]),l=Math.abs(a[i]),c=1/(1+.3275911*l);n[i]=o*(1-((((1.061405429*c-1.453152027)*c+1.421413741)*c-.284496736)*c+.254829592)*c*Math.exp(-l*l))}return this.makeOutput(n,r.shape,"float32")},t.prototype.step=function(r,n){n===void 0&&(n=0),we(r,"step");for(var a=new Float32Array(r.size),i=this.readSync(r.dataId),o=0;o<i.length;++o){var l=i[o];isNaN(l)?a[o]=NaN:a[o]=l>0?1:n}return this.makeOutput(a,r.shape,"float32")},t.prototype.fusedConv2d=function(r){var n=r.input,a=r.filter,i=r.convInfo,o=r.bias,l=r.activation,c=r.preluActivationWeights,u=this.conv2d(n,a,i);return o&&(u=this.add(u,o)),l&&(u=E2(this,u,l,c)),u},t.prototype.conv2d=function(r,n,a){we([r,n],"conv2d");for(var i=a.filterHeight,o=a.filterWidth,l=a.dilationHeight,c=a.dilationWidth,u=a.padInfo.left,d=a.padInfo.top,h=a.dataFormat==="channelsLast",f=yt(a.outShape,r.dtype),p=r.strides[0],m=h?r.strides[1]:r.strides[2],v=h?r.strides[2]:1,g=h?1:r.strides[1],x=f.strides[0],y=h?f.strides[1]:f.strides[2],b=h?f.strides[2]:1,N=h?1:f.strides[1],j=this.readSync(r.dataId),_=this.readSync(n.dataId),S=f.values,C=0;C<a.batchSize;++C)for(var E=C*p,k=C*x,P=0;P<a.outHeight;++P)for(var A=k+P*y,O=P*a.strideHeight-d,I=0;I<i;I++){var R=O+I*l;if(!(R<0||R>=a.inHeight))for(var M=I*n.strides[0],B=E+R*m,$=0;$<a.outWidth;++$)for(var D=A+$*b,W=$*a.strideWidth-u,Z=0;Z<o;Z++){var U=W+Z*c;if(!(U<0||U>=a.inWidth))for(var Y=B+U*v,ae=M+Z*n.strides[1],ie=0;ie<a.inChannels;++ie){for(var he=j[Y+ie*g],se=0;se<a.outChannels;++se)S[D+se*N]+=he*_[ae+se];ae+=a.outChannels}}}return f.toTensor()},t.prototype.conv3d=function(r,n,a){for(var i=a.filterDepth,o=a.filterHeight,l=a.filterWidth,c=a.dilationDepth,u=a.dilationHeight,d=a.dilationWidth,h=a.padInfo.front,f=a.padInfo.left,p=a.padInfo.top,m=yt(a.outShape,r.dtype),v=this.readSync(r.dataId),g=this.readSync(n.dataId),x=m.values,y=0;y<a.batchSize;++y)for(var b=y*r.strides[0],N=y*m.strides[0],j=0;j<a.outDepth;++j)for(var _=N+j*m.strides[1],S=j*a.strideDepth-h,C=0;C<i;C++){var E=S+C*c;if(!(E<0||E>=a.inDepth))for(var k=C*n.strides[0],P=b+E*r.strides[1],A=0;A<a.outHeight;++A)for(var O=_+A*m.strides[2],I=A*a.strideHeight-p,R=0;R<o;R++){var M=I+R*u;if(!(M<0||M>=a.inHeight))for(var B=k+R*n.strides[1],$=P+M*r.strides[2],D=0;D<a.outWidth;++D)for(var W=O+D*a.outChannels,Z=D*a.strideWidth-f,U=0;U<l;U++){var Y=Z+U*d;if(!(Y<0||Y>=a.inWidth))for(var ae=B+U*n.strides[2],ie=$+Y*a.inChannels,he=ae,se=0;se<a.inChannels;++se){for(var ye=v[ie+se],ne=0;ne<a.outChannels;++ne)x[W+ne]+=ye*g[he+ne];he+=a.outChannels}}}}return m.toTensor()},t.prototype.conv2dDerInput=function(r,n,a){we([r,n],"conv2dDerInput");for(var i=yt(a.inShape,"float32"),o=i.values,l=this.readSync(r.dataId),c=this.readSync(n.dataId),u=n.strides,d=u[0],h=u[1],f=u[2],p=a.batchSize,m=a.filterHeight,v=a.filterWidth,g=a.inChannels,x=a.inHeight,y=a.inWidth,b=a.outChannels,N=a.outHeight,j=a.outWidth,_=a.strideHeight,S=a.strideWidth,C=a.dataFormat,E=m-1-a.padInfo.top,k=v-1-a.padInfo.left,P=C==="channelsLast",A=i.strides[0],O=P?i.strides[1]:i.strides[2],I=P?i.strides[2]:1,R=P?1:i.strides[1],M=r.strides[0],B=P?r.strides[1]:r.strides[2],$=P?r.strides[2]:1,D=P?1:r.strides[1],W=0;W<p;++W)for(var Z=0;Z<g;++Z)for(var U=0;U<x;++U)for(var Y=U-E,ae=Math.max(0,Math.ceil(Y/_)),ie=Math.min(N,(m+Y)/_),he=0;he<y;++he){for(var se=he-k,ye=Math.max(0,Math.ceil(se/S)),ne=Math.min(j,(v+se)/S),le=0,ve=ae;ve<ie;++ve)for(var K=ve*_-Y,ke=ye;ke<ne;++ke)for(var Ce=M*W+B*ve+$*ke,Ge=d*(m-1-K)+h*(v-1-(ke*S-se))+f*Z,He=0;He<b;++He)le+=l[Ce+D*He]*c[Ge+He];o[A*W+O*U+I*he+R*Z]=le}return i.toTensor()},t.prototype.conv3dDerInput=function(r,n,a){for(var i=yt(a.inShape,"float32"),o=i.values,l=i.strides,c=l[0],u=l[1],d=l[2],h=l[3],f=this.readSync(r.dataId),p=r.strides,m=p[0],v=p[1],g=p[2],x=p[3],y=this.readSync(n.dataId),b=n.strides,N=b[0],j=b[1],_=b[2],S=b[3],C=a.batchSize,E=a.filterDepth,k=a.filterHeight,P=a.filterWidth,A=a.inChannels,O=a.inDepth,I=a.inHeight,R=a.inWidth,M=a.outChannels,B=a.outDepth,$=a.outHeight,D=a.outWidth,W=a.strideDepth,Z=a.strideHeight,U=a.strideWidth,Y=E-1-a.padInfo.front,ae=k-1-a.padInfo.top,ie=P-1-a.padInfo.left,he=0;he<C;++he)for(var se=0;se<A;++se)for(var ye=0;ye<O;++ye)for(var ne=ye-Y,le=Math.max(0,Math.ceil(ne/W)),ve=Math.min(B,(E+ne)/W),K=0;K<I;++K)for(var ke=K-ae,Ce=Math.max(0,Math.ceil(ke/Z)),Ge=Math.min($,(k+ke)/Z),He=0;He<R;++He){for(var It=He-ie,ar=Math.max(0,Math.ceil(It/U)),Kt=Math.min(D,(P+It)/U),G=0,te=le;te<ve;++te)for(var ce=te*W-ne,_e=Ce;_e<Ge;++_e)for(var Ae=_e*Z-ke,je=ar;je<Kt;++je)for(var Le=m*he+v*te+g*_e+x*je,it=N*(E-1-ce)+j*(k-1-Ae)+_*(P-1-(je*U-It))+S*se,ft=0;ft<M;++ft)G+=f[Le+ft]*y[it+ft];o[c*he+u*ye+d*K+h*He+se]=G}return i.toTensor()},t.prototype.conv2dDerFilter=function(r,n,a){we([r,n],"conv2dDerFilter");for(var i=a.strideHeight,o=a.strideWidth,l=a.filterHeight,c=a.filterWidth,u=a.dataFormat==="channelsLast",d=yt(a.filterShape,"float32"),h=a.padInfo.left,f=a.padInfo.top,p=this.bufferSync(r),m=this.bufferSync(n),v=0;v<l;++v)for(var g=Math.max(0,Math.ceil((f-v)/i)),x=Math.min(a.outHeight,(a.inHeight+f-v)/i),y=0;y<c;++y)for(var b=Math.max(0,Math.ceil((h-y)/o)),N=Math.min(a.outWidth,(a.inWidth+h-y)/o),j=0;j<a.inChannels;++j)for(var _=0;_<a.outChannels;++_){for(var S=0,C=0;C<a.batchSize;++C)for(var E=g;E<x;++E)for(var k=v+E*i-f,P=b;P<N;++P){var A=y+P*o-h;S+=u?p.get(C,k,A,j)*m.get(C,E,P,_):p.get(C,j,k,A)*m.get(C,_,E,P)}d.set(S,v,y,j,_)}return d.toTensor()},t.prototype.conv3dDerFilter=function(r,n,a){for(var i=a.strideDepth,o=a.strideHeight,l=a.strideWidth,c=a.filterDepth,u=a.filterHeight,d=a.filterWidth,h=yt(a.filterShape,"float32"),f=h.values,p=h.strides,m=p[0],v=p[1],g=p[2],x=p[3],y=this.readSync(n.dataId),b=n.strides,N=b[0],j=b[1],_=b[2],S=b[3],C=this.readSync(r.dataId),E=r.strides,k=E[0],P=E[1],A=E[2],O=E[3],I=a.padInfo.front,R=a.padInfo.left,M=a.padInfo.top,B=0;B<c;++B)for(var $=Math.max(0,Math.ceil((I-B)/i)),D=Math.min(a.outDepth,(a.inDepth+I-B)/i),W=B*m,Z=0;Z<u;++Z)for(var U=Math.max(0,Math.ceil((M-Z)/o)),Y=Math.min(a.outHeight,(a.inHeight+M-Z)/o),ae=Z*v+W,ie=0;ie<d;++ie)for(var he=Math.max(0,Math.ceil((R-ie)/l)),se=Math.min(a.outWidth,(a.inWidth+R-ie)/l),ye=ie*g+ae,ne=0;ne<a.inChannels;++ne)for(var le=ne*x+ye,ve=0;ve<a.outChannels;++ve){for(var K=0,ke=0;ke<a.batchSize;++ke)for(var Ce=ke*k,Ge=ke*N,He=$;He<D;++He)for(var It=(B+He*i-I)*P+Ce,ar=He*j+Ge,Kt=U;Kt<Y;++Kt)for(var G=(Z+Kt*o-M)*A+It,te=Kt*_+ar,ce=he;ce<se;++ce){var _e=ce*S+te;K+=C[(ie+ce*l-R)*O+G+ne]*y[_e+ve]}f[le+ve]=K}return h.toTensor()},t.prototype.fusedDepthwiseConv2D=function(r){var n=r.input,a=r.filter,i=r.convInfo,o=r.bias,l=r.activation,c=r.preluActivationWeights,u=this.depthwiseConv2D(n,a,i);return o&&(u=this.add(u,o)),l&&(u=E2(this,u,l,c)),u},t.prototype.depthwiseConv2D=function(r,n,a){we([r,n],"depthwiseConv2D");for(var i=a.filterHeight,o=a.filterWidth,l=a.dilationHeight,c=a.dilationWidth,u=a.padInfo.left,d=a.padInfo.top,h=a.outChannels/a.inChannels,f=yt(a.outShape,r.dtype),p=this.readSync(r.dataId),m=this.readSync(n.dataId),v=f.values,g=0;g<a.batchSize;++g)for(var x=g*r.strides[0],y=g*f.strides[0],b=0;b<a.outHeight;++b)for(var N=y+b*f.strides[1],j=b*a.strideHeight-u,_=0;_<i;++_){var S=j+_*l;if(!(S<0||S>=a.inHeight))for(var C=_*n.strides[0],E=x+S*r.strides[1],k=0;k<a.outWidth;++k)for(var P=N+k*f.strides[2],A=k*a.strideWidth-d,O=0;O<o;++O){var I=A+O*c;if(!(I<0||I>=a.inWidth))for(var R=C+O*n.strides[1],M=E+I*a.inChannels,B=P,$=R,D=0;D<a.inChannels;++D){for(var W=p[M+D],Z=0;Z<h;++Z)v[B+Z]+=W*m[$+Z];B+=h,$+=h}}}return f.toTensor()},t.prototype.depthwiseConv2DDerInput=function(r,n,a){we([r,n],"depthwiseConv2DDerInput");for(var i=yt(a.inShape,"float32"),o=i.values,l=i.strides,c=l[0],u=l[1],d=l[2],h=this.readSync(r.dataId),f=r.strides,p=f[0],m=f[1],v=f[2],g=this.readSync(n.dataId),x=n.strides,y=x[0],b=x[1],N=x[2],j=a.batchSize,_=a.filterHeight,S=a.filterWidth,C=a.inChannels,E=a.inHeight,k=a.inWidth,P=a.outChannels,A=a.outHeight,O=a.outWidth,I=a.strideHeight,R=a.strideWidth,M=_-1-a.padInfo.top,B=S-1-a.padInfo.left,$=P/C,D=0;D<j;++D)for(var W=0;W<C;++W)for(var Z=0;Z<E;++Z)for(var U=Z-M,Y=Math.max(0,Math.ceil(U/I)),ae=Math.min(A,(_+U)/I),ie=0;ie<k;++ie){for(var he=ie-B,se=Math.max(0,Math.ceil(he/R)),ye=Math.min(O,(S+he)/R),ne=0,le=Y;le<ae;++le)for(var ve=le*I-U,K=se;K<ye;++K)for(var ke=p*D+m*le+v*K,Ce=y*(_-1-ve)+b*(S-1-(K*R-he))+N*W,Ge=0;Ge<$;++Ge)ne+=h[ke+(W*$+Ge)]*g[Ce+Ge];o[c*D+u*Z+d*ie+W]=ne}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(r,n,a){we([r,n],"depthwiseConv2DDerFilter");for(var i=a.strideHeight,o=a.strideWidth,l=a.filterHeight,c=a.filterWidth,u=yt(a.filterShape,"float32"),d=a.padInfo.left,h=a.padInfo.top,f=a.outChannels/a.inChannels,p=this.bufferSync(r),m=this.bufferSync(n),v=0;v<l;++v)for(var g=Math.max(0,Math.ceil((h-v)/i)),x=Math.min(a.outHeight,(a.inHeight+h-v)/i),y=0;y<c;++y)for(var b=Math.max(0,Math.ceil((d-y)/o)),N=Math.min(a.outWidth,(a.inWidth+d-y)/o),j=0;j<a.outChannels;++j){for(var _=Math.trunc(j/f),S=j%f,C=0,E=0;E<a.batchSize;++E)for(var k=g;k<x;++k)for(var P=v+k*i-h,A=b;A<N;++A){var O=y+A*o-d;C+=p.get(E,P,O,_)*m.get(E,k,A,j)}u.set(C,v,y,_,S)}return u.toTensor()},t.prototype.tile=function(r,n){return we(r,"tile"),JW(this.bufferSync(r),n)},t.prototype.pad=function(r,n,a){we(r,"pad");var i=n.map(function(f,p){return f[0]+r.shape[p]+f[1]}),o=n.map(function(f){return f[0]}),l=this.bufferSync(r),c=yt(i,r.dtype);a!==0&&c.values.fill(a);for(var u=0;u<r.size;u++){var d=l.indexToLoc(u),h=d.map(function(f,p){return f+o[p]});c.set.apply(c,[l.get.apply(l,d)].concat(h))}return c.toTensor()},t.prototype.transpose=function(r,n){we(r,"transpose");for(var a=new Array(r.rank),i=0;i<a.length;i++)a[i]=r.shape[n[i]];var o=this.readSync(r.dataId),l=yt(a,r.dtype),c=this.bufferSync(r);for(i=0;i<r.size;++i){for(var u=c.indexToLoc(i),d=new Array(u.length),h=0;h<d.length;h++)d[h]=u[n[h]];var f=l.locToIndex(d);l.values[f]=o[i]}return l.toTensor()},t.prototype.gather=function(r,n,a){we([r,n],"gather");var i=r.shape.slice(),o=this.readSync(n.dataId);i[a]=o.length;for(var l=yt(i,r.dtype),c=this.bufferSync(r),u=0;u<l.size;++u){var d=l.indexToLoc(u),h=d.slice();h[a]=o[d[a]];var f=c.locToIndex(h);l.values[u]=c.values[f]}return l.toTensor()},t.prototype.batchToSpaceND=function(r,n,a){we([r],"batchToSpaceND");var i=n.reduce(function(h,f){return h*f}),o=Z0(r.shape,n,i),l=J0(o.length,n.length),c=ew(r.shape,n,i),u=BW(a,n.length),d=UW(c,a,n.length);return r.reshape(o).transpose(l).reshape(c).slice(u,d)},t.prototype.spaceToBatchND=function(r,n,a){we([r],"spaceToBatchND");var i=n.reduce(function(f,p){return f*p}),o=[[0,0]];o.push.apply(o,a);for(var l=1+n.length;l<r.shape.length;++l)o.push([0,0]);var c=r.pad(o),u=Z0(c.shape,n,i,!1),d=J0(u.length,n.length,!1),h=ew(c.shape,n,i,!1);return c.reshape(u).transpose(d).reshape(h)},t.prototype.pool=function(r,n,a){we(r,"pool");for(var i=n.strideHeight,o=n.strideWidth,l=n.dilationHeight,c=n.dilationWidth,u=n.effectiveFilterHeight,d=n.effectiveFilterWidth,h=n.padInfo.top,f=n.padInfo.left,p=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=this.readSync(r.dataId),v=yt(n.outShape,r.dtype),g=v.values,x=n.outShape[1]*n.outShape[2]*n.outShape[3],y=n.outShape[2]*n.outShape[3],b=n.outShape[3],N=0;N<n.batchSize;++N)for(var j=N*x,_=N*r.strides[0],S=0;S<n.inChannels;++S)for(var C=0;C<n.outHeight;++C)for(var E=C*i-h,k=Math.max(0,E),P=Math.min(n.inHeight,u+E),A=j+C*y,O=0;O<n.outWidth;++O){for(var I=O*o-f,R=Math.max(0,I),M=Math.min(n.inWidth,d+I),B=p,$=0,D=0,W=k;W<P;W+=l){for(var Z=_+W*r.strides[1],U=R;U<M;U+=c){var Y=m[Z+U*r.strides[2]+S];a==="max"&&Y>B?B=Y:a==="avg"&&($+=Y,D++)}if(isNaN(B))break}g[A+O*b+S]=a==="avg"?$/D:B}return v.toTensor()},t.prototype.maxPool=function(r,n){return this.pool(r,n,"max")},t.prototype.maxPoolPositions=function(r,n){for(var a=yt(n.outShape,"int32"),i=n.strideHeight,o=n.strideWidth,l=n.dilationHeight,c=n.dilationWidth,u=n.effectiveFilterHeight,d=n.effectiveFilterWidth,h=n.padInfo.top,f=n.padInfo.left,p=this.bufferSync(r),m=0;m<n.batchSize;++m)for(var v=0;v<n.inChannels;++v)for(var g=0;g<n.outHeight;++g){for(var x=g*i-h,y=x;y<0;)y+=l;for(var b=Math.min(n.inHeight,u+x),N=0;N<n.outWidth;++N){for(var j=N*o-f,_=j;_<0;)_+=c;for(var S=Math.min(n.inWidth,d+j),C=Number.NEGATIVE_INFINITY,E=-1,k=y;k<b;k+=l)for(var P=k-x,A=_;A<S;A+=c){var O=A-j,I=p.get(m,k,A,v);I>C&&(C=I,E=P*d+O)}a.set(E,m,g,N,v)}}return a.toTensor()},t.prototype.maxPoolBackprop=function(r,n,a,i){we([n,a],"maxPoolBackprop");for(var o=this.maxPoolPositions(n,i),l=i.strideHeight,c=i.strideWidth,u=i.dilationHeight,d=i.dilationWidth,h=i.effectiveFilterHeight,f=i.effectiveFilterWidth,p=f-1-i.padInfo.left,m=h-1-i.padInfo.top,v=yt(n.shape,"float32"),g=this.bufferSync(o),x=this.bufferSync(r),y=0;y<i.batchSize;++y)for(var b=0;b<i.inChannels;++b)for(var N=0;N<i.inHeight;++N)for(var j=0;j<i.inWidth;++j){for(var _=N-m,S=j-p,C=0,E=0;E<h;E+=u){var k=(_+E)/l;if(!(k<0||k>=i.outHeight||Math.floor(k)!==k))for(var P=0;P<f;P+=d){var A=(S+P)/c;if(!(A<0||A>=i.outWidth||Math.floor(A)!==A)){var O=h*f-1-g.get(y,k,A,b)===E*f+P?1:0;O!==0&&(C+=x.get(y,k,A,b)*O)}}}v.set(C,y,N,j,b)}return v.toTensor()},t.prototype.avgPoolBackprop=function(r,n,a){we([r,n],"avgPoolBackprop");for(var i=a.strideHeight,o=a.strideWidth,l=a.filterHeight,c=a.filterWidth,u=a.dilationHeight,d=a.dilationWidth,h=a.effectiveFilterHeight,f=a.effectiveFilterWidth,p=f-1-a.padInfo.left,m=h-1-a.padInfo.top,v=yt(n.shape,"float32"),g=1/(l*c),x=this.bufferSync(r),y=0;y<a.batchSize;++y)for(var b=0;b<a.inChannels;++b)for(var N=0;N<a.inHeight;++N)for(var j=0;j<a.inWidth;++j){for(var _=N-m,S=j-p,C=0,E=0;E<h;E+=u){var k=(_+E)/i;if(!(k<0||k>=a.outHeight||Math.floor(k)!==k))for(var P=0;P<f;P+=d){var A=(S+P)/o;A<0||A>=a.outWidth||Math.floor(A)!==A||(C+=x.get(y,k,A,b))}}v.set(C*g,y,N,j,b)}return v.toTensor()},t.prototype.pool3d=function(r,n,a){we(r,"pool3d");for(var i=n.strideDepth,o=n.strideHeight,l=n.strideWidth,c=n.dilationDepth,u=n.dilationHeight,d=n.dilationWidth,h=n.effectiveFilterDepth,f=n.effectiveFilterHeight,p=n.effectiveFilterWidth,m=n.padInfo.front,v=n.padInfo.top,g=n.padInfo.left,x=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(r.dataId),b=yt(n.outShape,r.dtype),N=b.values,j=n.outShape[1]*n.outShape[2]*n.outShape[3]*n.outShape[4],_=n.outShape[2]*n.outShape[3]*n.outShape[4],S=n.outShape[3]*n.outShape[4],C=n.outShape[4],E=0;E<n.batchSize;++E)for(var k=E*j,P=E*r.strides[0],A=0;A<n.inChannels;++A)for(var O=0;O<n.outDepth;++O){for(var I=O*i-m,R=I;R<0;)R+=c;for(var M=Math.min(n.inDepth,h+I),B=k+O*_,$=0;$<n.outHeight;++$){for(var D=$*o-v,W=D;W<0;)W+=u;for(var Z=Math.min(n.inHeight,f+D),U=B+$*S,Y=0;Y<n.outWidth;++Y){for(var ae=Y*l-g,ie=ae;ie<0;)ie+=d;for(var he=Math.min(n.inWidth,p+ae),se=U+Y*C,ye=x,ne=0,le=0,ve=R;ve<M;ve+=c){for(var K=P+ve*r.strides[1],ke=W;ke<Z;ke+=u){for(var Ce=K+ke*r.strides[2],Ge=ie;Ge<he;Ge+=d){var He=y[Ce+Ge*r.strides[3]+A];if(a==="max"&&He>ye?ye=He:a==="avg"&&(ne+=He,le++),isNaN(ye))break}if(isNaN(ye))break}if(isNaN(ye))break}N[se+A]=a==="avg"?ne/le:ye}}}return b.toTensor()},t.prototype.avgPool3d=function(r,n){return we(r,"avgPool3d"),this.pool3d(r,n,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(r,n,a){we([r,n],"avgPool3dBackprop");for(var i=a.strideDepth,o=a.strideHeight,l=a.strideWidth,c=a.filterDepth,u=a.filterHeight,d=a.filterWidth,h=a.dilationDepth,f=a.dilationHeight,p=a.dilationWidth,m=a.effectiveFilterDepth,v=a.effectiveFilterHeight,g=a.effectiveFilterWidth,x=m-1-a.padInfo.front,y=g-1-a.padInfo.left,b=v-1-a.padInfo.top,N=yt(n.shape,"float32"),j=1/(c*u*d),_=this.bufferSync(r),S=0;S<a.batchSize;++S)for(var C=0;C<a.inChannels;++C)for(var E=0;E<a.inDepth;++E)for(var k=0;k<a.inHeight;++k)for(var P=0;P<a.inWidth;++P){for(var A=E-x,O=k-b,I=P-y,R=0,M=0;M<m;M+=h){var B=(A+M)/i;if(!(B<0||B>=a.outDepth||Math.floor(B)!==B))for(var $=0;$<v;$+=f){var D=(O+$)/o;if(!(D<0||D>=a.outHeight||Math.floor(D)!==D))for(var W=0;W<g;W+=p){var Z=(I+W)/l;Z<0||Z>=a.outWidth||Math.floor(Z)!==Z||(R+=_.get(S,B,D,Z,C))}}}N.set(R*j,S,E,k,P,C)}return N.toTensor()},t.prototype.maxPool3d=function(r,n){return we(r,"maxPool3d"),this.pool3d(r,n,"max").toFloat()},t.prototype.maxPool3dPositions=function(r,n){for(var a=yt(n.outShape,"int32"),i=n.strideDepth,o=n.strideHeight,l=n.strideWidth,c=n.dilationDepth,u=n.dilationHeight,d=n.dilationWidth,h=n.effectiveFilterDepth,f=n.effectiveFilterHeight,p=n.effectiveFilterWidth,m=n.padInfo.front,v=n.padInfo.top,g=n.padInfo.left,x=this.bufferSync(r),y=0;y<n.batchSize;++y)for(var b=0;b<n.inChannels;++b)for(var N=0;N<n.outDepth;++N){for(var j=N*i-m,_=j;_<0;)_+=c;for(var S=Math.min(n.inDepth,h+j),C=0;C<n.outHeight;++C){for(var E=C*o-v,k=E;k<0;)k+=u;for(var P=Math.min(n.inHeight,f+E),A=0;A<n.outWidth;++A){for(var O=A*l-g,I=O;I<0;)I+=d;for(var R=Math.min(n.inWidth,p+O),M=Number.NEGATIVE_INFINITY,B=-1,$=_;$<S;$+=c)for(var D=$-j,W=k;W<P;W+=u)for(var Z=W-E,U=I;U<R;U+=d){var Y=U-O,ae=x.get(y,$,W,U,b);ae>=M&&(M=ae,B=D*f*p+Z*f+Y)}a.set(B,y,N,C,A,b)}}}return a.toTensor()},t.prototype.maxPool3dBackprop=function(r,n,a,i){we([n,a],"maxPool3dBackprop");for(var o=this.maxPool3dPositions(n,i),l=i.strideDepth,c=i.strideHeight,u=i.strideWidth,d=i.dilationDepth,h=i.dilationHeight,f=i.dilationWidth,p=i.effectiveFilterDepth,m=i.effectiveFilterHeight,v=i.effectiveFilterWidth,g=p-1-i.padInfo.front,x=v-1-i.padInfo.left,y=m-1-i.padInfo.top,b=yt(n.shape,"float32"),N=this.bufferSync(o),j=this.bufferSync(r),_=0;_<i.batchSize;++_)for(var S=0;S<i.inChannels;++S)for(var C=0;C<i.inDepth;++C)for(var E=0;E<i.inHeight;++E)for(var k=0;k<i.inWidth;++k){for(var P=C-g,A=E-y,O=k-x,I=0,R=0;R<p;R+=d){var M=(P+R)/l;if(!(M<0||M>=i.outDepth||Math.floor(M)!==M))for(var B=0;B<m;B+=h){var $=(A+B)/c;if(!($<0||$>=i.outHeight||Math.floor($)!==$))for(var D=0;D<v;D+=f){var W=(O+D)/u;if(!(W<0||W>=i.outWidth||Math.floor(W)!==W)){var Z=p*m*v-1-N.get(_,M,$,W,S)===R*m*v+B*v+D?1:0;Z!==0&&(I+=j.get(_,M,$,W,S)*Z)}}}}b.set(I,_,C,E,k,S)}return b.toTensor()},t.prototype.cast=function(r,n){return YW(r,n,this)},t.prototype.reshape=function(r,n){return AE(r,n)},t.prototype.avgPool=function(r,n){return we(r,"avgPool"),this.pool(r,n,"avg").toFloat()},t.prototype.resizeBilinear=function(r,n,a,i){we(r,"resizeBilinear");for(var o=r.shape,l=o[0],c=o[1],u=o[2],d=o[3],h=this.readSync(r.dataId),f=new Float32Array(Qe([l,n,a,d])),p=[i&&n>1?c-1:c,i&&a>1?u-1:u],m=[i&&n>1?n-1:n,i&&a>1?a-1:a],v=0,g=p[0]/m[0],x=p[1]/m[1],y=0;y<l;y++)for(var b=0;b<n;b++)for(var N=g*b,j=Math.floor(N),_=N-j,S=Math.min(c-1,Math.ceil(N)),C=y*r.strides[0]+j*r.strides[1],E=y*r.strides[0]+S*r.strides[1],k=0;k<a;k++)for(var P=x*k,A=Math.floor(P),O=P-A,I=Math.min(u-1,Math.ceil(P)),R=C+A*r.strides[2],M=E+A*r.strides[2],B=C+I*r.strides[2],$=E+I*r.strides[2],D=0;D<d;D++){var W=h[R+D],Z=h[M+D],U=W+(h[B+D]-W)*O,Y=U+(Z+(h[$+D]-Z)*O-U)*_;f[v++]=Y}return ra(f,[l,n,a,d])},t.prototype.resizeBilinearBackprop=function(r,n,a){we([r,n],"resizeBilinearBackprop");for(var i=n.shape,o=i[0],l=i[1],c=i[2],u=i[3],d=r.shape,h=d[1],f=d[2],p=new Float32Array(o*l*c*u),m=[a&&h>1?l-1:l,a&&f>1?c-1:c],v=[a&&h>1?h-1:h,a&&f>1?f-1:f],g=m[0]/v[0],x=m[1]/v[1],y=this.readSync(r.dataId),b=0,N=0;N<o;N++)for(var j=N*n.strides[0],_=0;_<h;_++)for(var S=_*g,C=Math.floor(S),E=Math.min(Math.ceil(S),l-1),k=j+C*n.strides[1],P=j+E*n.strides[1],A=S-C,O=1-A,I=0;I<f;I++)for(var R=I*x,M=Math.floor(R),B=Math.min(Math.ceil(R),c-1),$=R-M,D=1-$,W=k+M*n.strides[2],Z=k+B*n.strides[2],U=P+M*n.strides[2],Y=P+B*n.strides[2],ae=O*D,ie=O*$,he=A*D,se=A*$,ye=0;ye<u;ye++){var ne=y[b++];p[W+ye]+=ne*ae,p[Z+ye]+=ne*ie,p[U+ye]+=ne*he,p[Y+ye]+=ne*se}return es(p,[o,c,l,u],n.dtype)},t.prototype.resizeNearestNeighbor=function(r,n,a,i){we(r,"resizeNearestNeighbor");for(var o=r.shape,l=o[0],c=o[1],u=o[2],d=o[3],h=this.readSync(r.dataId),f=new Float32Array(l*n*a*d),p=[i&&n>1?c-1:c,i&&a>1?u-1:u],m=[i&&n>1?n-1:n,i&&a>1?a-1:a],v=p[0]/m[0],g=p[1]/m[1],x=0,y=0;y<l;y++)for(var b=y*r.strides[0],N=0;N<n;N++)for(var j=v*N,_=b+Math.min(c-1,i?Math.round(j):Math.floor(j))*r.strides[1],S=0;S<a;S++)for(var C=g*S,E=_+Math.min(u-1,i?Math.round(C):Math.floor(C))*r.strides[2],k=0;k<d;k++){var P=h[E+k];f[x++]=P}return ra(f,[l,n,a,d],r.dtype)},t.prototype.resizeNearestNeighborBackprop=function(r,n,a){we([r,n],"resizeNearestNeighborBackprop");for(var i=n.shape,o=i[0],l=i[1],c=i[2],u=i[3],d=r.shape,h=d[1],f=d[2],p=new Float32Array(o*l*c*u),m=this.readSync(r.dataId),v=[a&&h>1?l-1:l,a&&f>1?c-1:c],g=[a&&h>1?h-1:h,a&&f>1?f-1:f],x=v[0]/g[0],y=v[1]/g[1],b=1/x,N=1/y,j=2*Math.ceil(b)+2,_=2*Math.ceil(N)+2,S=0;S<o;S++)for(var C=S*n.strides[0],E=0;E<l;E++)for(var k=C+E*n.strides[1],P=Math.floor(E*b),A=Math.floor(P-j/2),O=0;O<c;O++)for(var I=k+O*n.strides[2],R=Math.floor(O*N),M=Math.floor(R-_/2),B=0;B<u;B++){for(var $=0,D=0;D<j;D++){var W=D+A;if(!(W<0||W>=h)){var Z=C+W*r.strides[1],U=W*x;if(E===Math.min(l-1,a?Math.round(U):Math.floor(U)))for(var Y=0;Y<_;Y++){var ae=Y+M;if(!(ae<0||ae>=f)){var ie=Z+ae*r.strides[2],he=ae*y;O===Math.min(c-1,a?Math.round(he):Math.floor(he))&&($+=m[ie+B])}}}}p[I+B]=$}return es(p,n.shape,n.dtype)},t.prototype.batchNormalization=function(r,n,a,i,o,l){we([r,n,a,o,l],"batchNorm");for(var c=this.readSync(r.dataId),u=this.readSync(n.dataId),d=this.readSync(a.dataId),h=o?this.readSync(o.dataId):new Float32Array([1]),f=l?this.readSync(l.dataId):new Float32Array([0]),p=new Float32Array(c.length),m=f.length,v=h.length,g=d.length,x=u.length,y=0,b=0,N=0,j=0,_=0;_<c.length;++_)p[_]=f[y++]+(c[_]-u[b++])*h[N++]/Math.sqrt(d[j++]+i),y>=m&&(y=0),b>=x&&(b=0),N>=v&&(N=0),j>=g&&(j=0);return es(p,r.shape)},t.prototype.localResponseNormalization4D=function(r,n,a,i,o){we(r,"localResponseNormalization4D");var l=r.shape[3],c=l-1,u=this.readSync(r.dataId),d=r.size,h=new Float32Array(d);function f(g){for(var x=g%l,y=g-x+Math.max(0,x-n),b=g-x+Math.min(x+n,c),N=0;y<=b;y++){var j=u[y];N+=j*j}return N}for(var p=0;p<d;p++){var m=f(p),v=u[p]*Math.pow(a+i*m,-o);h[p]=v}return es(h,r.shape)},t.prototype.LRNGrad=function(r,n,a,i,o,l,c){we(r,"LRNGrad");for(var u=r.shape[3],d=this.readSync(r.dataId),h=this.readSync(n.dataId),f=this.readSync(a.dataId),p=new Float32Array(r.size),m=r.size,v=0;v<m;v++){for(var g=v%u,x=v-g+Math.max(0,g-i),y=v-g+Math.min(u,g+i+1),b=0,N=x;N<y;N++)b+=Math.pow(h[N],2);for(b=l*b+o,N=x;N<y;N++){var j=-2*l*c*h[N]*f[v]/b;v===N&&(j+=Math.pow(b,-c)),j*=d[v],p[N]+=j}}return es(p,r.shape)},t.prototype.multinomial=function(r,n,a,i){we(r,"multinomial");for(var o=n?r:Ml(r),l=o.shape[0],c=o.shape[1],u=_r([l,a],"int32"),d=this.readSync(u.dataId),h=this.readSync(o.dataId),f=0;f<l;++f){var p=f*c,m=new Float32Array(c-1);m[0]=h[p];for(var v=1;v<m.length;++v)m[v]=m[v-1]+h[p+v];for(var g=Cj(i.toString()),x=f*a,y=0;y<a;++y){var b=g();d[x+y]=m.length;for(var N=0;N<m.length;N++)if(b<m[N]){d[x+y]=N;break}}}return u},t.prototype.oneHot=function(r,n,a,i){we(r,"oneHot");var o=new Float32Array(r.size*n);o.fill(i);for(var l=this.readSync(r.dataId),c=0;c<r.size;++c)l[c]>=0&&l[c]<n&&(o[c*n+l[c]]=a);return Vc(o,[r.size,n],"int32")},t.prototype.nonMaxSuppression=function(r,n,a,i,o){return we(r,"nonMaxSuppression"),YT(this.readSync(r.dataId),this.readSync(n.dataId),a,i,o)},t.prototype.fft=function(r){return this.fftBatch(r,!1)},t.prototype.ifft=function(r){return this.fftBatch(r,!0)},t.prototype.fftBatch=function(r,n){for(var a=r.shape[0],i=r.shape[1],o=yt(r.shape,"float32"),l=yt(r.shape,"float32"),c=Zs(r).as2D(a,i),u=vo(r).as2D(a,i),d=0;d<a;d++)for(var h=c.slice([d,0],[1,i]),f=u.slice([d,0],[1,i]),p=ea(h,f),m=this.readSync(this.fftImpl(p,n).dataId),v=0;v<i;v++){var g=QM(m,v);o.values[d*i+v]=g.real,l.values[d*i+v]=g.imag}return ea(o.toTensor(),l.toTensor()).as2D(a,i)},t.prototype.fftImpl=function(r,n){var a=r.as1D(),i=a.size;if(this.isExponentOf2(i)){var o=this.fftRadix2(a,i,n).as2D(r.shape[0],r.shape[1]);return n&&(o=ea(Zs(o).div(Fe(i)),vo(o).div(Fe(i)))),o}var l=this.readSync(r.dataId),c=function(u){for(var d=new Float32Array(u.length/2),h=new Float32Array(u.length/2),f=0;f<u.length;f+=2)d[f/2]=u[f],h[f/2]=u[f+1];return{real:d,imag:h}}(this.fourierTransformByMatmul(l,i,n));return ea(c.real,c.imag).as2D(r.shape[0],r.shape[1])},t.prototype.isExponentOf2=function(r){return(r&r-1)==0},t.prototype.fftRadix2=function(r,n,a){if(n===1)return r;var i=this.readSync(r.dataId),o=n/2,l=function(x){for(var y=Math.ceil(x.length/4),b=new Float32Array(y),N=new Float32Array(y),j=0;j<x.length;j+=4)b[Math.floor(j/4)]=x[j],N[Math.floor(j/4)]=x[j+1];return{real:b,imag:N}}(i),c=ea(l.real,l.imag).as1D(),u=function(x){for(var y=Math.floor(x.length/4),b=new Float32Array(y),N=new Float32Array(y),j=2;j<x.length;j+=4)b[Math.floor(j/4)]=x[j],N[Math.floor(j/4)]=x[j+1];return{real:b,imag:N}}(i),d=ea(u.real,u.imag).as1D();c=this.fftRadix2(c,o,a),d=this.fftRadix2(d,o,a);var h=function(x,y){for(var b=new Float32Array(x/2),N=new Float32Array(x/2),j=0;j<Math.ceil(x/2);j++){var _=(y?2:-2)*Math.PI*(j/x);b[j]=Math.cos(_),N[j]=Math.sin(_)}return{real:b,imag:N}}(n,a),f=ea(h.real,h.imag).mul(d),p=c.add(f),m=c.sub(f),v=Zs(p).concat(Zs(m)),g=vo(p).concat(vo(m));return ea(v,g).as1D()},t.prototype.fourierTransformByMatmul=function(r,n,a){for(var i=new Float32Array(2*n),o=0;o<n;o++){for(var l=0,c=0,u=0;u<n;u++){var d=efe(o*u,n,a),h=QM(r,u);l+=h.real*d.real-h.imag*d.imag,c+=h.real*d.imag+h.imag*d.real}a&&(l/=n,c/=n),Jhe(i,l,c,o)}return i},t.prototype.depthToSpace=function(r,n,a){z(a==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+a}),z(n>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+n});for(var i=r.shape[0],o=r.shape[1],l=r.shape[2],c=r.shape[3],u=o*n,d=l*n,h=c/(n*n),f=this.readSync(r.dataId),p=new Float32Array(i*u*d*h),m=0,v=0;v<i;++v)for(var g=0;g<u;++g)for(var x=Math.floor(g/n),y=g%n,b=0;b<d;++b)for(var N=Math.floor(b/n),j=(y*n+b%n)*h,_=0;_<h;++_){var S=_+j+c*(N+l*(x+o*v));p[m++]=f[S]}return es(p,[i,u,d,h])},t.prototype.broadcastedBinaryOp=function(r,n,a,i){var o=Vt(r.shape,n.shape),l=yt(o,a),c=this.readSync(r.dataId),u=this.readSync(n.dataId),d=_c(r.shape,o),h=_c(n.shape,o),f=l.values;if(d.length+h.length===0)for(var p=0;p<f.length;++p)f[p]=i(c[p%c.length],u[p%u.length]);else{var m=this.bufferSync(r),v=this.bufferSync(n),g=function(x){var y=l.indexToLoc(x),b=y.slice(-r.rank);d.forEach(function(S){return b[S]=0});var N=m.locToIndex(b),j=y.slice(-n.rank);h.forEach(function(S){return j[S]=0});var _=v.locToIndex(j);f[x]=i(c[N],u[_])};for(p=0;p<f.length;++p)g(p)}return l.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(r,n,a){var i=Vt(r.shape,n.shape),o=yt(i,"float32"),l=yt(i,"float32"),c=this.readSync(r.dataId),u=this.readSync(n.dataId),d=_c(r.shape,i),h=_c(n.shape,i),f=o.values,p=l.values;if(d.length+h.length===0)for(var m=0;m<f.length;m++){var v=m%c.length,g=m%u.length,x=a(c[2*v],c[2*v+1],u[2*g],u[2*g+1]);f[m]=x.real,p[m]=x.imag}else{var y=this.bufferSync(this.data.get(r.dataId).complexTensors.real),b=this.bufferSync(this.data.get(n.dataId).complexTensors.real),N=function(j){var _=o.indexToLoc(j),S=_.slice(-r.rank);d.forEach(function(A){return S[A]=0});var C=y.locToIndex(S),E=_.slice(-n.rank);h.forEach(function(A){return E[A]=0});var k=b.locToIndex(E),P=a(c[2*C],c[2*C+1],u[2*k],u[2*k+1]);f[j]=P.real,p[j]=P.imag};for(m=0;m<f.length;m++)N(m)}return this.complex(o.toTensor(),l.toTensor())},t.prototype.split=function(r,n,a){return ZW(r,n,a)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(r,n,a,i,o,l){for(var c=r.shape,u=c[0],d=c[1],h=c[2],f=c[3],p=n.shape[0],m=i[0],v=i[1],g=yt([p,m,v,f],"float32"),x=this.readSync(n.dataId),y=this.readSync(a.dataId),b=this.readSync(r.dataId),N=r.strides,j=g.strides,_=0;_<p;_++){var S=4*_,C=x[S],E=x[S+1],k=x[S+2],P=x[S+3],A=y[_];if(!(A>=u))for(var O=m>1?(k-C)*(d-1)/(m-1):0,I=v>1?(P-E)*(h-1)/(v-1):0,R=0;R<m;R++){var M=m>1?C*(d-1)+R*O:.5*(C+k)*(d-1);if(M<0||M>d-1)for(var B=0;B<v;B++)for(var $=0;$<f;$++){var D=$+B*j[2]+R*j[1]+_*j[0];g.values[D]=l}else if(o==="bilinear"){var W=Math.floor(M),Z=Math.ceil(M),U=M-W;for(B=0;B<v;B++)if((ve=v>1?E*(h-1)+B*I:.5*(E+P)*(h-1))<0||ve>h-1)for($=0;$<f;$++)D=$+B*j[2]+R*j[1]+_*j[0],g.values[D]=l;else{var Y=Math.floor(ve),ae=Math.ceil(ve),ie=ve-Y;for($=0;$<f;$++){var he=b[D=$+Y*N[2]+W*N[1]+A*N[0]],se=b[D=$+ae*N[2]+W*N[1]+A*N[0]],ye=b[D=$+Y*N[2]+Z*N[1]+A*N[0]],ne=he+(se-he)*ie,le=ye+(b[D=$+ae*N[2]+Z*N[1]+A*N[0]]-ye)*ie;D=$+B*j[2]+R*j[1]+_*j[0],g.values[D]=ne+(le-ne)*U}}}else for(B=0;B<v;++B){var ve;if((ve=v>1?E*(h-1)+B*I:.5*(E+P)*(h-1))<0||ve>h-1)for($=0;$<f;$++)D=$+B*j[2]+R*j[1]+_*j[0],g.values[D]=l;else{var K=Math.round(ve),ke=Math.round(M);for($=0;$<f;$++){var Ce=$+K*N[2]+ke*N[1]+A*N[0],Ge=$+B*j[2]+R*j[1]+_*j[0];g.values[Ge]=b[Ce]}}}}}return g.toTensor()},t.prototype.sparseToDense=function(r,n,a,i){var o=tw(0,r,a),l=o.sliceRank,c=o.numUpdates,u=o.sliceSize,d=o.strides,h=o.outputSize;return this.scatter(r,n,a,h,u,c,l,d,i,!1)},t.prototype.gatherND=function(r,n){var a=n.shape,i=a[a.length-1],o=VW(r,n),l=o[0],c=o[1],u=o[2],d=o[3];if(c===0)return ra([],l,r.dtype);for(var h=new yg([c,u],r.dtype),f=this.readSync(n.dataId),p=this.readSync(r.dataId),m=0;m<c;m++){for(var v=[],g=0,x=0;x<i;x++){var y=f[m*i+x];g+=y*d[x],v.push(y)}if(g<0||g>=r.size/u)throw new Error("Invalid indices: "+v+" does not index into "+r.shape);for(var b=0;b<u;b++)h.values[m*u+b]=p[g*u+b]}return h.toTensor().reshape(l)},t.prototype.scatterND=function(r,n,a){var i=tw(0,r,a),o=i.sliceRank,l=i.numUpdates,c=i.sliceSize,u=i.strides,d=i.outputSize,h=Fe(0);return this.scatter(r,n,a,d,c,l,o,u,h,!0)},t.prototype.fill=function(r,n,a){var i=q0(a=a||Ax(n),Qe(r));return i.fill(n),J.makeTensor(i,r,a,this)},t.prototype.onesLike=function(r){if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(r.shape,1,r.dtype)},t.prototype.zerosLike=function(r){var n=q0(r.dtype,Qe(r.shape));return this.makeOutput(n,r.shape,r.dtype)},t.prototype.linspace=function(r,n,a){return XW(r,n,a)},t.prototype.scatter=function(r,n,a,i,o,l,c,u,d,h){var f=[i/o,o],p=this.readSync(r.dataId),m=this.readSync(n.dataId);if(i===0)return ra([],a,n.dtype);var v=new yg(f,n.dtype);v.values.fill(this.readSync(d.dataId)[0]);for(var g=0;g<l;g++){for(var x=[],y=0,b=0;b<c;b++){var N=p[g*c+b];x.push(N),y+=N*u[b]}if(y<0||y>=i/o)throw new Error("Invalid indices: "+x+" does not index into "+a);for(var j=0;j<o;j++)h?v.values[y*o+j]+=m[g*o+j]:v.values[y*o+j]=n.rank===0?m[0]:m[g*o+j]}return v.toTensor().reshape(a)},t}(HW);J.registerBackend("cpu",function(){return new bge},1);for(var k2=0,y3=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,r=e.backend,n=e.attrs,a=t,i=a.boxes,o=a.scores,l=n,c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h=l.softNmsSigma,f=r;we(i,"NonMaxSuppressionWithScore");var p=XT(f.data.get(i.dataId).values,f.data.get(o.dataId).values,c,u,d,h);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,r=e.backend,n=t.x,a=r;we(n,"square");for(var i=a.data.get(n.dataId).values,o=new Float32Array(i.length),l=0;l<i.length;++l){var c=i[l];o[l]=c*c}return{dataId:a.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},{kernelName:jg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,r=e.backend,n=t,a=n.a,i=n.b,o=r;we([a,i],jg);var l=o.data.get(a.dataId).values,c=o.data.get(i.dataId).values,u=function(f,p,m,v,g,x){var y=Vt(f,p),b=y.length,N=ko(y),j=xg(g,Qe(y)),_=f.length,S=p.length,C=ko(f),E=ko(p),k=_c(f,y),P=_c(p,y);if(k.length+P.length===0)for(var A=0;A<j.length;++A)j[A]=x(m[A%m.length],v[A%v.length]);else{var O=function(I){var R=Pde(I,b,N),M=R.slice(-_);k.forEach(function(W){return M[W]=0});var B=VM(M,_,C),$=R.slice(-S);P.forEach(function(W){return $[W]=0});var D=VM($,S,E);j[I]=x(m[B],v[D])};for(A=0;A<j.length;++A)O(A)}return[j,y]}(a.shape,i.shape,l,c,a.dtype,function(f,p){var m=f-p;return m*m}),d=u[0],h=u[1];return{dataId:o.write(d,h,a.dtype),shape:h,dtype:a.dtype}}}];k2<y3.length;k2++)wW(y3[k2]);var yh,wge=function(e){this.variableNames=["A"];var t=ba(),r=e[0],n=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+n+".0, "+r+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},jge=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=ba(),r=e[0],n=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+n+".0, "+r+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var A2=0,b3=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,r=e.backend,n=e.attrs,a=t.pixels,i=n.numChannels,o=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,l=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,c=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],u=c[0],d=c[1],h=[d,u],f=[d,u,i];(l||o)&&(yh==null&&(yh=document.createElement("canvas").getContext("2d")),yh.canvas.width=u,yh.canvas.height=d,yh.drawImage(a,0,0,u,d),a=yh.canvas);var p=r.makeTensorInfo(h,"int32");r.texData.get(p.dataId).usage=ks.PIXELS,r.gpgpu.uploadPixelDataToTexture(r.getTexture(p.dataId),a);var m=fe().getBool("WEBGL_PACK")?new jge(f):new wge(f),v=r.runWebGLProgram(m,[p],"int32");return r.disposeData(p.dataId),v}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,r=e.backend,n=e.attrs;Y0("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t,i=a.boxes,o=a.scores,l=n,c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h=l.softNmsSigma,f=r,p=XT(f.readSync(i.dataId),f.readSync(o.dataId),c,u,d,h);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,r=e.backend,n=t.x,a=r,i=new Nt(n.shape,"return x * x;");return a.runWebGLProgram(i,[n],n.dtype)}},{kernelName:jg,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,r=e.backend,n=t,a=n.a,i=n.b,o=r,l=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Jo("return (a - b) * (a - b);",a.shape,i.shape):new zr("return (a - b) * (a - b);",a.shape,i.shape);return o.compileAndRun(l,[a,i])}}];A2<b3.length;A2++)wW(b3[A2]);for(var P2=0,w3=[{kernelName:"Square",gradFunc:function(e,t){var r=t[0];return{x:function(){return e.mul(r.toFloat().mul(2))}}}},{kernelName:jg,gradFunc:function(e,t){var r=t[0],n=t[1],a=Fe(2);return{a:function(){return ja(e,ja(a,Dn(r,n)))},b:function(){return ja(e,ja(a,Dn(n,r)))}}}}];P2<w3.length;P2++)yde(w3[P2]);var Nge=function(){function e(){}return e.prototype.fetch=function(t,r){return fetch(t,r)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,r){if(r!=="utf-8"&&r!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+r);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,r){return new TextDecoder(r).decode(t)},e}();fe().get("IS_BROWSER")&&fe().setPlatform("browser",new Nge);var T2,_ge=function(){return require("node-fetch")},Sge=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,r){return fe().global.fetch!=null?fe().global.fetch(t,r):(T2==null&&(T2=_ge()),T2(t,r))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,r){if(r!=="utf-8"&&r!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+r);return this.textEncoder.encode(t)},e.prototype.decode=function(t,r){return t.length===0?"":new this.util.TextDecoder(r).decode(t)},e}();fe().get("IS_NODE")&&fe().setPlatform("node",new Sge);var RE={float32:4,int32:4,uint16:2,uint8:1,bool:1},lw=4;function Wq(e,t){for(var r={},n=0,a=function(l){var c=l.name,u=l.dtype,d=l.shape,h=Qe(d),f=void 0;if("quantization"in l){var p=l.quantization;if(p.dtype!=="uint8"&&p.dtype!=="uint16")throw new Error("Weight "+l.name+" has unknown quantization dtype "+p.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var m=RE[p.dtype],v=e.slice(n,n+h*m),g=p.dtype==="uint8"?new Uint8Array(v):new Uint16Array(v);if(u==="float32")f=Float32Array.from(g,function(_){return _*p.scale+p.min});else{if(u!=="int32")throw new Error("Unsupported dtype in weight '"+c+"': "+u);f=Int32Array.from(g,function(_){return Math.round(_*p.scale+p.min)})}n+=h*m}else if(u==="string"){var x=Qe(l.shape);f=[];for(var y=0;y<x;y++){var b=new Uint32Array(e.slice(n,n+lw))[0];n+=lw;var N=new Uint8Array(e.slice(n,n+b));f.push(N),n+=b}}else{var j=RE[u];if(v=e.slice(n,n+h*j),u==="float32")f=new Float32Array(v);else if(u==="int32")f=new Int32Array(v);else{if(u!=="bool")throw new Error("Unsupported dtype in weight '"+c+"': "+u);f=new Uint8Array(v)}n+=h*j}r[c]=ra(f,d,u)},i=0,o=t;i<o.length;i++)a(o[i]);return r}function Cge(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,r=[];e.forEach(function(i){if(t+=i.byteLength,r.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var n=new Uint8Array(t),a=0;return r.forEach(function(i){n.set(new Uint8Array(i.buffer),a),a+=i.byteLength}),n.buffer}var OE=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function j3(e){return OE?Buffer.byteLength(e):new Blob([e]).size}function mR(e){var t=0;e.forEach(function(a){t+=a.byteLength});var r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(new Uint8Array(a),n),n+=a.byteLength}),r.buffer}function N3(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Mx(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:j3(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:j3(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var As=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,r){return e.getHandlers(t,"load",r)},e.getHandlers=function(t,r,n){var a=[];return(r==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(i){var o=i(t,n);o!==null&&a.push(o)}),a},e}(),xf="://",zc=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,r){z(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(xf)&&(t=t.slice(0,t.indexOf(xf))),z(t.length>0,function(){return"scheme must not be an empty string."});var n=e.getInstance();z(n.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),n.managers[t]=r},e.getManager=function(t){var r=this.getInstance().managers[t];if(r==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return r},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function Kb(e){if(e.indexOf(xf)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+zc.getSchemes().join(","));return{scheme:e.split(xf)[0],path:e.split(xf)[1]}}function _3(e,t,r){return r===void 0&&(r=!1),Ye(this,void 0,void 0,function(){var n,a,i,o,l,c,u,d,h;return Xe(this,function(f){switch(f.label){case 0:return z(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),z((n=As.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),z(n.length<2,function(){return"Copying failed because more than one ("+n.length+") load handlers for source URL "+e+"."}),a=n[0],z((i=As.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),z(i.length<2,function(){return"Copying failed because more than one ("+n.length+") save handlers for destination URL "+t+"."}),o=i[0],l=Kb(e).scheme,c=Kb(e).path,u=l===Kb(e).scheme,[4,a.load()];case 1:return d=f.sent(),r&&u?[4,zc.getManager(l).removeModel(c)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,o.save(d)];case 4:return h=f.sent(),!r||u?[3,6]:[4,zc.getManager(l).removeModel(c)];case 5:f.sent(),f.label=6;case 6:return[2,h.modelArtifactsInfo]}})})}var Yu="models_store",Sc="model_info_store";function qq(){if(!fe().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function IE(e){var t=e.result;t.createObjectStore(Yu,{keyPath:"modelPath"}),t.createObjectStore(Sc,{keyPath:"modelPath"})}var yf=function(){function e(t){if(this.indexedDB=qq(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return Ye(this,void 0,void 0,function(){return Xe(this,function(r){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return Ye(this,void 0,void 0,function(){return Xe(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,r){var n=this;return new Promise(function(a,i){var o=n.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return IE(o)},o.onsuccess=function(){var l=o.result;if(r==null){var c=l.transaction(Yu,"readonly"),u=c.objectStore(Yu).get(n.modelPath);u.onsuccess=function(){if(u.result==null)return l.close(),i(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));a(u.result.modelArtifacts)},u.onerror=function(v){return l.close(),i(u.error)},c.oncomplete=function(){return l.close()}}else{var d,h=Mx(r),f=l.transaction(Sc,"readwrite"),p=f.objectStore(Sc),m=p.put({modelPath:n.modelPath,modelArtifactsInfo:h});m.onsuccess=function(){var v=(d=l.transaction(Yu,"readwrite")).objectStore(Yu).put({modelPath:n.modelPath,modelArtifacts:r,modelArtifactsInfo:h});v.onsuccess=function(){return a({modelArtifactsInfo:h})},v.onerror=function(g){var x=(p=f.objectStore(Sc)).delete(n.modelPath);x.onsuccess=function(){return l.close(),i(v.error)},x.onerror=function(y){return l.close(),i(v.error)}}},m.onerror=function(v){return l.close(),i(m.error)},f.oncomplete=function(){d==null?l.close():d.oncomplete=function(){return l.close()}}}},o.onerror=function(l){return i(o.error)}})},e.URL_SCHEME="indexeddb://",e}(),S3=function(e){return fe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(yf.URL_SCHEME)?(t=e.slice(yf.URL_SCHEME.length),new yf(t)):null;var t};As.registerSaveRouter(S3),As.registerLoadRouter(S3);var Ege=function(){function e(){this.indexedDB=qq()}return e.prototype.listModels=function(){return Ye(this,void 0,void 0,function(){var t=this;return Xe(this,function(r){return[2,new Promise(function(n,a){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return IE(i)},i.onsuccess=function(){var o=i.result,l=o.transaction(Sc,"readonly"),c=l.objectStore(Sc).getAll();c.onsuccess=function(){for(var u={},d=0,h=c.result;d<h.length;d++){var f=h[d];u[f.modelPath]=f.modelArtifactsInfo}n(u)},c.onerror=function(u){return o.close(),a(c.error)},l.oncomplete=function(){return o.close()}},i.onerror=function(o){return a(i.error)}})]})})},e.prototype.removeModel=function(t){return Ye(this,void 0,void 0,function(){var r=this;return Xe(this,function(n){var a;return t=(a=t).startsWith(yf.URL_SCHEME)?a.slice(yf.URL_SCHEME.length):a,[2,new Promise(function(i,o){var l=r.indexedDB.open("tensorflowjs",1);l.onupgradeneeded=function(){return IE(l)},l.onsuccess=function(){var c,u=l.result,d=u.transaction(Sc,"readwrite"),h=d.objectStore(Sc),f=h.get(t);f.onsuccess=function(){if(f.result==null)return u.close(),o(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var p=h.delete(t),m=function(){var v=(c=u.transaction(Yu,"readwrite")).objectStore(Yu).delete(t);v.onsuccess=function(){return i(f.result.modelArtifactsInfo)},v.onerror=function(g){return o(f.error)}};p.onsuccess=m,p.onerror=function(v){return m(),u.close(),o(f.error)}},f.onerror=function(p){return u.close(),o(f.error)},d.oncomplete=function(){c==null?u.close():c.oncomplete=function(){return u.close()}}},l.onerror=function(c){return o(l.error)}})]})})},e}();if(fe().getBool("IS_BROWSER"))try{zc.registerManager(yf.URL_SCHEME,new Ege)}catch{}var sl="/",$h="tensorflowjs_models",Gq="info",kge="model_topology",Age="weight_specs",Pge="weight_data",Tge="model_metadata";function Hq(e){return{info:[$h,e,Gq].join(sl),topology:[$h,e,kge].join(sl),weightSpecs:[$h,e,Age].join(sl),weightData:[$h,e,Pge].join(sl),modelMetadata:[$h,e,Tge].join(sl)}}function Rge(e){var t=e.split(sl);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(sl)}var bf=function(){function e(t){if(!fe().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=Hq(this.modelPath)}return e.prototype.save=function(t){return Ye(this,void 0,void 0,function(){var r,n,a;return Xe(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");r=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),a=Mx(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,r),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(o){if(OE)return Buffer.from(o).toString("base64");for(var l=new Uint8Array(o),c="",u=0,d=l.length;u<d;u++)c+=String.fromCharCode(l[u]);return btoa(c)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:a}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+a.modelTopologyBytes+", weightSpecsBytes="+a.weightSpecsBytes+", weightDataBytes="+a.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return Ye(this,void 0,void 0,function(){var t,r,n,a,i,o,l;return Xe(this,function(c){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(r={},(n=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(r.modelTopology=n,(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(r.weightSpecs=a,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(o=JSON.parse(i),r.format=o.format,r.generatedBy=o.generatedBy,r.convertedBy=o.convertedBy,r.userDefinedMetadata=o.userDefinedMetadata),(l=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return r.weightData=function(u){if(OE){var d=Buffer.from(u,"base64");return d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength)}for(var h=atob(u),f=new Uint8Array(h.length),p=0;p<h.length;++p)f.set([h.charCodeAt(p)],p);return f.buffer}(l),[2,r]})})},e.URL_SCHEME="localstorage://",e}(),C3=function(e){return fe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(bf.URL_SCHEME)?(t=e.slice(bf.URL_SCHEME.length),new bf(t)):null;var t};As.registerSaveRouter(C3),As.registerLoadRouter(C3);var Oge=function(){function e(){z(fe().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),z(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return Ye(this,void 0,void 0,function(){var t,r,n,a,i,o;return Xe(this,function(l){for(t={},r=$h+sl,n=sl+Gq,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(r)&&i.endsWith(n)&&(o=Rge(i),t[o]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},e.prototype.removeModel=function(t){return Ye(this,void 0,void 0,function(){var r,n;return Xe(this,function(a){var i;if(t=(i=t).startsWith(bf.URL_SCHEME)?i.slice(bf.URL_SCHEME.length):i,r=Hq(t),this.LS.getItem(r.info)==null)throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(r.info)),this.LS.removeItem(r.info),this.LS.removeItem(r.topology),this.LS.removeItem(r.weightSpecs),this.LS.removeItem(r.weightData),[2,n]})})},e}();if(fe().getBool("IS_BROWSER"))try{zc.registerManager(bf.URL_SCHEME,new Oge)}catch{}var Ige="model",Dge=".json",Mge=".weights.bin";function E3(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var R2=function(){function e(t){if(!fe().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=Ige),this.modelTopologyFileName=t+Dge,this.weightDataFileName=t+Mge}return e.prototype.save=function(t){return Ye(this,void 0,void 0,function(){var r,n,a,i,o,l;return Xe(this,function(c){switch(c.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(r=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n},i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(o=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=i,[4,E3(function(){return o.dispatchEvent(new MouseEvent("click"))})];case 2:return c.sent(),t.weightData==null?[3,4]:((l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,l.href=r,[4,E3(function(){return l.dispatchEvent(new MouseEvent("click"))})]);case 3:c.sent(),c.label=4;case 4:return[2,{modelArtifactsInfo:Mx(t)}]}})})},e.URL_SCHEME="downloads://",e}(),$ge=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return Ye(this,void 0,void 0,function(){var t,r,n=this;return Xe(this,function(a){return t=this.files[0],r=this.files.slice(1),[2,new Promise(function(i,o){var l=new FileReader;l.onload=function(c){var u=JSON.parse(c.target.result),d=u.modelTopology;if(d!=null){r.length===0&&i({modelTopology:d});var h=u.weightsManifest;if(h!=null){var f;try{f=n.checkManifestAndWeightFiles(h,r)}catch(g){return void o(g)}var p=[],m=[],v=[];h.forEach(function(g){g.paths.forEach(function(x){m.push(x),v.push(null)}),p.push.apply(p,g.weights)}),h.forEach(function(g){g.paths.forEach(function(x){var y=new FileReader;y.onload=function(b){var N=b.target.result,j=m.indexOf(x);v[j]=N,v.indexOf(null)===-1&&i({modelTopology:d,weightSpecs:p,weightData:mR(v),format:u.format,generatedBy:u.generatedBy,convertedBy:u.convertedBy,userDefinedMetadata:u.userDefinedMetadata})},y.onerror=function(b){return o("Failed to weights data from file of path '"+x+"'.")},y.readAsArrayBuffer(f[x])})})}else o(new Error("weightManifest field is missing from file "+t.name))}else o(new Error("modelTopology field is missing from file "+t.name))},l.onerror=function(c){return o("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},l.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,r){for(var n=[],a=r.map(function(c){return N3(c.name)}),i={},o=0,l=t;o<l.length;o++)l[o].paths.forEach(function(c){var u=N3(c);if(n.indexOf(u)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+u+"'");if(n.push(u),a.indexOf(u)===-1)throw new Error("Weight file with basename '"+u+"' is not provided.");i[c]=r[a.indexOf(u)]});if(n.length!==r.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+r.length+").");return i},e}();function k3(e,t,r,n){(function(i){z(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(e),function(i,o){z(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),z(o>=0&&o<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+o}),z(o>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+o})}(r=r??0,n=n??1);var a=0;return Promise.all(e.map(function(i){return i.then(function(o){var l=r+ ++a/e.length*(n-r);return t(l),o}),i}))}function Kq(e,t){return Ye(this,void 0,void 0,function(){var r,n,a,i,o,l,c,u,d;return Xe(this,function(h){switch(h.label){case 0:return t==null&&(t={}),r=t.fetchFunc==null?fe().platform.fetch:t.fetchFunc,n=e.map(function(f){return r(f,t.requestInit,{isBinary:!0})}),a=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(n)];case 1:return o=h.sent(),[3,4];case 2:return[4,k3(n,t.onProgress,a,i)];case 3:o=h.sent(),h.label=4;case 4:return l=o.map(function(f){return f.arrayBuffer()}),c=.5,u=1,t.onProgress!=null?[3,6]:[4,Promise.all(l)];case 5:return d=h.sent(),[3,8];case 6:return[4,k3(l,t.onProgress,c,u)];case 7:d=h.sent(),h.label=8;case 8:return[2,d]}})})}function A3(e){var t=this;return function(r,n,a){return n===void 0&&(n=""),Ye(t,void 0,void 0,function(){var i,o,l,c,u,d,h,f,p,m;return Xe(this,function(v){switch(v.label){case 0:if(i=r.map(function(){return!1}),o={},l=a!=null?a.map(function(){return!1}):[],c=[],r.forEach(function(g,x){var y=0;g.weights.forEach(function(b){var N="quantization"in b?b.quantization.dtype:b.dtype,j=RE[N]*Qe(b.shape),_=function(){i[x]=!0,o[x]==null&&(o[x]=[]),o[x].push({manifestEntry:b,groupOffset:y,sizeBytes:j})};a!=null?a.forEach(function(S,C){S===b.name&&(_(),l[C]=!0)}):_(),c.push(b.name),y+=j})}),!l.every(function(g){return g}))throw u=a.filter(function(g,x){return!l[x]}),new Error("Could not find weights in manifest with names: "+u.join(", ")+`. 
Manifest JSON has weights with names: `+c.join(", ")+".");return d=i.reduce(function(g,x,y){return x&&g.push(y),g},[]),h=[],d.forEach(function(g){r[g].paths.forEach(function(x){var y=n+(n.endsWith("/")?"":"/")+x;h.push(y)})}),[4,e(h)];case 1:return f=v.sent(),p={},m=0,d.forEach(function(g){for(var x=r[g].paths.length,y=0,b=0;b<x;b++)y+=f[m+b].byteLength;for(var N=new ArrayBuffer(y),j=new Uint8Array(N),_=0,S=0;S<x;S++){var C=new Uint8Array(f[m+S]);j.set(C,_),_+=C.byteLength}o[g].forEach(function(E){var k=Wq(N.slice(E.groupOffset,E.groupOffset+E.sizeBytes),[E.manifestEntry]);for(var P in k)p[P]=k[P]}),m+=x}),[2,p]}})})}}As.registerSaveRouter(function(e){return fe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(R2.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new R2(t)}(e.slice(R2.URL_SCHEME.length)):null});var Yq=function(){function e(t,r){if(this.DEFAULT_METHOD="POST",r==null&&(r={}),this.weightPathPrefix=r.weightPathPrefix,this.onProgress=r.onProgress,r.fetchFunc!=null?(z(typeof r.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=r.fetchFunc):this.fetch=fe().platform.fetch,z(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&z(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,r.requestInit!=null&&r.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=r.requestInit||{}}return e.prototype.save=function(t){return Ye(this,void 0,void 0,function(){var r,n,a,i;return Xe(this,function(o){switch(o.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(r=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:n},r.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),t.weightData!=null&&r.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,r)];case 1:if((i=o.sent()).ok)return[2,{modelArtifactsInfo:Mx(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},e.prototype.load=function(){return Ye(this,void 0,void 0,function(){var t,r,n,a,i,o,l,c,u,d,h,f;return Xe(this,function(p){switch(p.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=p.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");p.label=2;case 2:return p.trys.push([2,4,,5]),[4,t.json()];case 3:return r=p.sent(),[3,5];case 4:throw p.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(a=r.modelTopology,i=r.weightsManifest,o=r.generatedBy,l=r.convertedBy,c=r.format,u=r.userDefinedMetadata,a==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:f=p.sent(),d=f[0],h=f[1],p.label=7;case 7:return[2,{modelTopology:a,weightSpecs:d,weightData:h,userDefinedMetadata:u,generatedBy:o,convertedBy:l,format:c}]}})})},e.prototype.loadWeights=function(t){return Ye(this,void 0,void 0,function(){var r,n,a,i,o,l,c,u,d,h,f;return Xe(this,function(p){switch(p.label){case 0:for(r=Array.isArray(this.path)?this.path[1]:this.path,n=function(m){var v=m.lastIndexOf("/"),g=m.lastIndexOf("?"),x=m.substring(0,v),y=g>v?m.substring(g):"";return[x+"/",y]}(r),a=n[0],i=n[1],o=this.weightPathPrefix||a,l=[],c=0,u=t;c<u.length;c++)d=u[c],l.push.apply(l,d.weights);return h=[],t.forEach(function(m){m.paths.forEach(function(v){h.push(o+v+i)})}),[4,Kq(h,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=p.sent(),[2,[l,mR(f)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function DE(e){return e.match(Yq.URL_SCHEME_REGEX)!=null}var P3=function(e,t){return typeof fetch>"u"?null:(Array.isArray(e)?e.every(function(r){return DE(r)}):DE(e))?ME(e,{onProgress:t}):null};function ME(e,t){return new Yq(e,t)}As.registerSaveRouter(P3),As.registerLoadRouter(P3);var O2=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return Ye(this,void 0,void 0,function(){return Xe(this,function(t){return[2,this.modelArtifacts]})})},e}(),Fge=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return Ye(this,void 0,void 0,function(){return Xe(this,function(r){return[2,this.saveHandler(t)]})})},e}(),Xq=Object.freeze({browserFiles:function(e){return new $ge(e)},browserHTTPRequest:function(e,t){return ME(e,t)},concatenateArrayBuffers:mR,decodeWeights:Wq,encodeWeights:function(e,t){return Ye(this,void 0,void 0,function(){var r,n,a,i,o,l=this;return Xe(this,function(c){switch(c.label){case 0:for(r=[],n=[],a=Array.isArray(e)?e.map(function(u){return u.name}):Object.keys(e),i=function(u){var d=a[u],h=Array.isArray(e)?e[u].tensor:e[d];if(h.dtype!=="float32"&&h.dtype!=="int32"&&h.dtype!=="bool"&&h.dtype!=="string")throw new Error("Unsupported dtype in weight '"+d+"': "+h.dtype);var f={name:d,shape:h.shape,dtype:h.dtype};if(h.dtype==="string"){var p=new Promise(function(m){return Ye(l,void 0,void 0,function(){var v,g,x,y,b,N,j;return Xe(this,function(_){switch(_.label){case 0:return[4,h.bytes()];case 1:for(v=_.sent(),g=v.reduce(function(S,C){return S+C.length},0)+lw*v.length,x=new Uint8Array(g),y=0,b=0;b<v.length;b++)N=v[b],j=new Uint8Array(new Uint32Array([N.length]).buffer),x.set(j,y),y+=lw,x.set(N,y),y+=N.length;return m(x),[2]}})})});n.push(p)}else n.push(h.data());t!=null&&(f.group=t),r.push(f)},o=0;o<a.length;++o)i(o);return[4,Promise.all(n)];case 1:return[2,{data:Cge(c.sent()),specs:r}]}})})},fromMemory:function(e,t,r,n){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new O2(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new O2({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new O2({modelTopology:e,weightSpecs:t,weightData:r,trainingConfig:n}))},getLoadHandlers:function(e,t){return As.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:Mx,getSaveHandlers:function(e){return As.getSaveHandlers(e)},http:ME,isHTTPScheme:DE,loadWeights:function(e,t,r,n){return t===void 0&&(t=""),Ye(this,void 0,void 0,function(){return Xe(this,function(a){return[2,A3(function(i){return Kq(i,{requestInit:n})})(e,t,r)]})})},registerLoadRouter:function(e){return As.registerLoadRouter(e)},registerSaveRouter:function(e){return As.registerSaveRouter(e)},weightsLoaderFactory:A3,withSaveHandler:function(e){return new Fge(e)},copyModel:function(e,t){return Ye(this,void 0,void 0,function(){return Xe(this,function(r){return[2,_3(e,t,!1)]})})},listModels:function(){return Ye(this,void 0,void 0,function(){var e,t,r,n,a,i,o;return Xe(this,function(l){switch(l.label){case 0:e=zc.getSchemes(),t={},r=0,n=e,l.label=1;case 1:return r<n.length?(a=n[r],[4,zc.getManager(a).listModels()]):[3,4];case 2:for(o in i=l.sent())t[a+xf+o]=i[o];l.label=3;case 3:return r++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return Ye(this,void 0,void 0,function(){return Xe(this,function(r){return[2,_3(e,t,!0)]})})},removeModel:function(e){return Ye(this,void 0,void 0,function(){var t;return Xe(this,function(r){return t=Kb(e),[2,zc.getManager(t.scheme).removeModel(t.path)]})})}}),bh;Q({confusionMatrix_:function(e,t,r){var n=V(e,"labels","confusionMatrix"),a=V(t,"predictions","confusionMatrix");z(r==null||r>0&&Number.isInteger(r),function(){return"If provided, numClasses must be a positive integer, but got "+r}),z(n.rank===1,function(){return"Expected the rank of labels to be 1, but got "+n.rank}),z(a.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+a.rank}),z(n.shape[0]===a.shape[0],function(){return"Mismatch in the number of examples: "+n.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."}),z(r>0&&Number.isInteger(r),function(){return"numClasses is required to be a positive integer, but got "+r});var i=EE(n.asType("int32"),r),o=EE(a.asType("int32"),r);return i.transpose().matMul(o).asType("int32")}});var Lge=Q({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var r=!1,n=!1,a=!1,i=!1,o=!1;if(e.data instanceof Uint8Array)r=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)n=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)i=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);o=!0}if(a&&a&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(bW("FromPixels",J.backendName)!=null)return J.runKernel("FromPixels",{pixels:e},{numChannels:t});var l,c,u=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],d=u[0],h=u[1];if(o?l=e.getContext("2d").getImageData(0,0,d,h).data:n||r?l=e.data:(i||a)&&(bh==null&&(bh=document.createElement("canvas").getContext("2d")),bh.canvas.width=d,bh.canvas.height=h,bh.drawImage(e,0,0,d,h),l=bh.getImageData(0,0,d,h).data),t===4)c=new Int32Array(l);else{var f=d*h;c=new Int32Array(f*t);for(var p=0;p<f;p++)for(var m=0;m<t;++m)c[p*t+m]=l[4*p+m]}return WT(c,[h,d,t],"int32")}}),vR=Object.freeze({toPixels:function(e,t){return Ye(this,void 0,void 0,function(){var r,n,a,i,o,l,c,u,d,h,f,p,m,v,g,x,y,b,N,j,_,S,C;return Xe(this,function(E){switch(E.label){case 0:if(r=V(e,"img","toPixels"),e instanceof Ir||(r=r.toInt()),r.rank!==2&&r.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+r.rank+".");if(n=r.shape.slice(0,2),a=n[0],i=n[1],(o=r.rank===2?1:r.shape[2])>4||o===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,r.data()];case 1:return l=E.sent(),c=r.min(),u=r.max(),[4,Promise.all([c.data(),u.data()])];case 2:if(d=E.sent(),h=d[0],f=d[1],p=h[0],m=f[0],c.dispose(),u.dispose(),r.dtype==="float32"){if(p<0||m>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+p+" - "+m+"].")}else{if(r.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+r.dtype+". Please use float32 or int32 tensors.");if(p<0||m>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+p+" - "+m+"].")}for(v=r.dtype==="float32"?255:1,g=new Uint8ClampedArray(i*a*4),x=0;x<a*i;++x)y=void 0,b=void 0,N=void 0,j=void 0,o===1?(y=l[x]*v,b=l[x]*v,N=l[x]*v,j=255):o===3?(y=l[3*x]*v,b=l[3*x+1]*v,N=l[3*x+2]*v,j=255):o===4&&(y=l[4*x]*v,b=l[4*x+1]*v,N=l[4*x+2]*v,j=l[4*x+3]*v),g[(_=4*x)+0]=Math.round(y),g[_+1]=Math.round(b),g[_+2]=Math.round(N),g[_+3]=Math.round(j);return t!=null&&(t.width=i,t.height=a,S=t.getContext("2d"),C=new ImageData(g,i,a),S.putImageData(C,0,0)),r!==e&&r.dispose(),[2,g]}})})},fromPixels:Lge}),Bge=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,r){return new t(r)},e}(),Uge=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function rh(e){z(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),z(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),z(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),Uge.register(e)}var nh=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ji(t,e),t.prototype.minimize=function(r,n,a){n===void 0&&(n=!1);var i=this.computeGradients(r,a),o=i.value,l=i.grads;if(a!=null){var c=a.map(function(u){return{name:u.name,tensor:l[u.name]}});this.applyGradients(c)}else this.applyGradients(l);return os(l),n?o:(o.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(r,n){return Qhe(r,n)},t.prototype.dispose=function(){this.iterations_!=null&&os(this.iterations_)},t.prototype.saveIterations=function(){return Ye(this,void 0,void 0,function(){return Xe(this,function(r){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:Fe(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return Ye(this,void 0,void 0,function(){return Xe(this,function(r){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(r){return Ye(this,void 0,void 0,function(){return Xe(this,function(n){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(r){return Ye(this,void 0,void 0,function(){var n;return Xe(this,function(a){switch(a.label){case 0:return n=this,[4,r[0].tensor.data()];case 1:return n.iterations_=a.sent()[0],[2,r.slice(1)]}})})},t}(Bge);Object.defineProperty(nh,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var Vge=function(e){function t(r,n,a){a===void 0&&(a=null);var i=e.call(this)||this;return i.learningRate=r,i.rho=n,i.epsilon=a,i.accumulatedGrads=[],i.accumulatedUpdates=[],a==null&&(i.epsilon=J.backend.epsilon()),i}return Ji(t,e),t.prototype.applyGradients=function(r){var n=this;(Array.isArray(r)?r.map(function(a){return a.name}):Object.keys(r)).forEach(function(a,i){var o=J.registeredVariables[a];n.accumulatedGrads[i]==null&&(n.accumulatedGrads[i]={originalName:a+"/accum_grad",variable:Ve(function(){return Xt(o).variable(!1)})}),n.accumulatedUpdates[i]==null&&(n.accumulatedUpdates[i]={originalName:a+"/accum_var",variable:Ve(function(){return Xt(o).variable(!1)})});var l=Array.isArray(r)?r[i].tensor:r[a];if(l!=null){var c=n.accumulatedGrads[i].variable,u=n.accumulatedUpdates[i].variable;Ve(function(){var d=c.mul(n.rho).add(l.square().mul(1-n.rho)),h=u.add(n.epsilon).sqrt().div(c.add(n.epsilon).sqrt()).mul(l),f=u.mul(n.rho).add(h.square().mul(1-n.rho));c.assign(d),u.assign(f);var p=h.mul(-n.learningRate).add(o);o.assign(p)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(os(this.accumulatedGrads.map(function(r){return r.variable})),os(this.accumulatedUpdates.map(function(r){return r.variable})))},t.prototype.getWeights=function(){return Ye(this,void 0,void 0,function(){var r;return Xe(this,function(n){switch(n.label){case 0:return r=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(r.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(r){return Ye(this,void 0,void 0,function(){var n;return Xe(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(r)];case 1:return r=a.sent(),n=r.length/2,this.accumulatedGrads=r.slice(0,n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=r.slice(n,2*n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(r,n){return new r(n.learningRate,n.rho,n.epsilon)},t.className="Adadelta",t}(nh);rh(Vge);var zge=function(e){function t(r,n){n===void 0&&(n=.1);var a=e.call(this)||this;return a.learningRate=r,a.initialAccumulatorValue=n,a.accumulatedGrads=[],a}return Ji(t,e),t.prototype.applyGradients=function(r){var n=this;(Array.isArray(r)?r.map(function(a){return a.name}):Object.keys(r)).forEach(function(a,i){var o=J.registeredVariables[a];n.accumulatedGrads[i]==null&&(n.accumulatedGrads[i]={originalName:a+"/accumulator",variable:Ve(function(){return Ao(o.shape,n.initialAccumulatorValue).variable(!1)})});var l=Array.isArray(r)?r[i].tensor:r[a];if(l!=null){var c=n.accumulatedGrads[i].variable;Ve(function(){var u=c.add(l.square());c.assign(u);var d=l.div(u.add(J.backend.epsilon()).sqrt()).mul(-n.learningRate).add(o);o.assign(d)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&os(this.accumulatedGrads.map(function(r){return r.variable}))},t.prototype.getWeights=function(){return Ye(this,void 0,void 0,function(){return Xe(this,function(r){switch(r.label){case 0:return[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(this.accumulatedGrads.map(function(n){return{name:n.originalName,tensor:n.variable}}))]}})})},t.prototype.setWeights=function(r){return Ye(this,void 0,void 0,function(){return Xe(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(r)];case 1:return r=n.sent(),this.accumulatedGrads=r.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(r,n){return new r(n.learningRate,n.initialAccumulatorValue)},t.className="Adagrad",t}(nh);rh(zge);var Wge=function(e){function t(r,n,a,i){i===void 0&&(i=null);var o=e.call(this)||this;return o.learningRate=r,o.beta1=n,o.beta2=a,o.epsilon=i,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],Ve(function(){o.accBeta1=Fe(n).variable(),o.accBeta2=Fe(a).variable()}),i==null&&(o.epsilon=J.backend.epsilon()),o}return Ji(t,e),t.prototype.applyGradients=function(r){var n=this,a=Array.isArray(r)?r.map(function(i){return i.name}):Object.keys(r);Ve(function(){var i=Dn(1,n.accBeta1),o=Dn(1,n.accBeta2);a.forEach(function(l,c){var u=J.registeredVariables[l];n.accumulatedFirstMoment[c]==null&&(n.accumulatedFirstMoment[c]={originalName:l+"/m",variable:Ve(function(){return Xt(u).variable(!1)})}),n.accumulatedSecondMoment[c]==null&&(n.accumulatedSecondMoment[c]={originalName:l+"/v",variable:Ve(function(){return Xt(u).variable(!1)})});var d=Array.isArray(r)?r[c].tensor:r[l];if(d!=null){var h=n.accumulatedFirstMoment[c].variable,f=n.accumulatedSecondMoment[c].variable,p=h.mul(n.beta1).add(d.mul(1-n.beta1)),m=f.mul(n.beta2).add(d.square().mul(1-n.beta2)),v=p.div(i),g=m.div(o);h.assign(p),f.assign(m);var x=v.div(g.sqrt().add(n.epsilon)).mul(-n.learningRate).add(u);u.assign(x)}}),n.accBeta1.assign(n.accBeta1.mul(n.beta1)),n.accBeta2.assign(n.accBeta2.mul(n.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&os(this.accumulatedFirstMoment.map(function(r){return r.variable})),this.accumulatedSecondMoment!=null&&os(this.accumulatedSecondMoment.map(function(r){return r.variable}))},t.prototype.getWeights=function(){return Ye(this,void 0,void 0,function(){var r;return Xe(this,function(n){switch(n.label){case 0:return r=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(r.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(r){return Ye(this,void 0,void 0,function(){var n,a=this;return Xe(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(r)];case 1:return r=i.sent(),Ve(function(){a.accBeta1.assign(iw(a.beta1,a.iterations_+1)),a.accBeta2.assign(iw(a.beta2,a.iterations_+1))}),n=r.length/2,this.accumulatedFirstMoment=r.slice(0,n).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedSecondMoment=r.slice(n,2*n).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(r,n){return new r(n.learningRate,n.beta1,n.beta2,n.epsilon)},t.className="Adam",t}(nh);rh(Wge);var qge=function(e){function t(r,n,a,i,o){i===void 0&&(i=null),o===void 0&&(o=0);var l=e.call(this)||this;return l.learningRate=r,l.beta1=n,l.beta2=a,l.epsilon=i,l.decay=o,l.accumulatedFirstMoment=[],l.accumulatedWeightedInfNorm=[],Ve(function(){l.iteration=Fe(0).variable(),l.accBeta1=Fe(n).variable()}),i==null&&(l.epsilon=J.backend.epsilon()),l}return Ji(t,e),t.prototype.applyGradients=function(r){var n=this,a=Array.isArray(r)?r.map(function(i){return i.name}):Object.keys(r);Ve(function(){var i=Dn(1,n.accBeta1),o=Ti(-n.learningRate,n.iteration.mul(n.decay).add(1));a.forEach(function(l,c){var u=J.registeredVariables[l];n.accumulatedFirstMoment[c]==null&&(n.accumulatedFirstMoment[c]={originalName:l+"/m",variable:Xt(u).variable(!1)}),n.accumulatedWeightedInfNorm[c]==null&&(n.accumulatedWeightedInfNorm[c]={originalName:l+"/v",variable:Xt(u).variable(!1)});var d=Array.isArray(r)?r[c].tensor:r[l];if(d!=null){var h=n.accumulatedFirstMoment[c].variable,f=n.accumulatedWeightedInfNorm[c].variable,p=h.mul(n.beta1).add(d.mul(1-n.beta1)),m=f.mul(n.beta2),v=d.abs(),g=m.maximum(v);h.assign(p),f.assign(g);var x=o.div(i).mul(p.div(g.add(n.epsilon))).add(u);u.assign(x)}}),n.iteration.assign(n.iteration.add(1)),n.accBeta1.assign(n.accBeta1.mul(n.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&os(this.accumulatedFirstMoment.map(function(r){return r.variable})),this.accumulatedWeightedInfNorm!=null&&os(this.accumulatedWeightedInfNorm.map(function(r){return r.variable}))},t.prototype.getWeights=function(){return Ye(this,void 0,void 0,function(){return Xe(this,function(r){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(r){return Ye(this,void 0,void 0,function(){return Xe(this,function(n){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(r,n){return new r(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)},t.className="Adamax",t}(nh);rh(qge);var Qq=function(e){function t(r){var n=e.call(this)||this;return n.learningRate=r,n.setLearningRate(r),n}return Ji(t,e),t.prototype.applyGradients=function(r){var n=this;(Array.isArray(r)?r.map(function(a){return a.name}):Object.keys(r)).forEach(function(a,i){var o=Array.isArray(r)?r[i].tensor:r[a];if(o!=null){var l=J.registeredVariables[a];Ve(function(){var c=n.c.mul(o).add(l);l.assign(c)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(r){this.learningRate=r,this.c!=null&&this.c.dispose(),this.c=dhe(Fe(-r))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return Ye(this,void 0,void 0,function(){return Xe(this,function(r){switch(r.label){case 0:return[4,this.saveIterations()];case 1:return[2,[r.sent()]]}})})},t.prototype.setWeights=function(r){return Ye(this,void 0,void 0,function(){return Xe(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(r)];case 1:if((r=n.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(r,n){return new r(n.learningRate)},t.className="SGD",t}(nh);rh(Qq);var Gge=function(e){function t(r,n,a){a===void 0&&(a=!1);var i=e.call(this,r)||this;return i.learningRate=r,i.momentum=n,i.useNesterov=a,i.accumulations=[],i.m=Fe(i.momentum),i}return Ji(t,e),t.prototype.applyGradients=function(r){var n=this;(Array.isArray(r)?r.map(function(a){return a.name}):Object.keys(r)).forEach(function(a,i){var o=J.registeredVariables[a];n.accumulations[i]==null&&(n.accumulations[i]={originalName:a+"/momentum",variable:Ve(function(){return Xt(o).variable(!1)})});var l=n.accumulations[i].variable,c=Array.isArray(r)?r[i].tensor:r[a];c!=null&&Ve(function(){var u,d=n.m.mul(l).add(c);u=n.useNesterov?n.c.mul(c.add(d.mul(n.m))).add(o):n.c.mul(d).add(o),l.assign(d),o.assign(u)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&os(this.accumulations.map(function(r){return r.variable}))},t.prototype.setMomentum=function(r){this.momentum=r},t.prototype.getWeights=function(){return Ye(this,void 0,void 0,function(){return Xe(this,function(r){switch(r.label){case 0:return[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(this.accumulations.map(function(n){return{name:n.originalName,tensor:n.variable}}))]}})})},t.prototype.setWeights=function(r){return Ye(this,void 0,void 0,function(){return Xe(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(r)];case 1:return r=n.sent(),this.accumulations=r.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(r,n){return new r(n.learningRate,n.momentum,n.useNesterov)},t.className="Momentum",t}(Qq);rh(Gge);var Hge=function(e){function t(r,n,a,i,o){n===void 0&&(n=.9),a===void 0&&(a=0),i===void 0&&(i=null),o===void 0&&(o=!1);var l=e.call(this)||this;if(l.learningRate=r,l.decay=n,l.momentum=a,l.epsilon=i,l.accumulatedMeanSquares=[],l.accumulatedMoments=[],l.accumulatedMeanGrads=[],l.centered=o,i==null&&(l.epsilon=J.backend.epsilon()),r==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return l}return Ji(t,e),t.prototype.applyGradients=function(r){var n=this;(Array.isArray(r)?r.map(function(a){return a.name}):Object.keys(r)).forEach(function(a,i){var o=J.registeredVariables[a];n.accumulatedMeanSquares[i]==null&&(n.accumulatedMeanSquares[i]={originalName:a+"/rms",variable:Ve(function(){return Xt(o).variable(!1)})}),n.accumulatedMoments[i]==null&&(n.accumulatedMoments[i]={originalName:a+"/momentum",variable:Ve(function(){return Xt(o).variable(!1)})}),n.accumulatedMeanGrads[i]==null&&n.centered&&(n.accumulatedMeanGrads[i]={originalName:a+"/mg",variable:Ve(function(){return Xt(o).variable(!1)})});var l=Array.isArray(r)?r[i].tensor:r[a];if(l!=null){var c=n.accumulatedMeanSquares[i].variable,u=n.accumulatedMoments[i].variable;Ve(function(){var d=c.mul(n.decay).add(l.square().mul(1-n.decay));if(n.centered){var h=n.accumulatedMeanGrads[i].variable,f=h.mul(n.decay).add(l.mul(1-n.decay)),p=u.mul(n.momentum).add(l.mul(n.learningRate).div(d.sub(f.square().add(n.epsilon)).sqrt()));c.assign(d),h.assign(f),u.assign(p);var m=o.sub(p);o.assign(m)}else{var v=c.mul(n.decay).add(l.square().mul(1-n.decay));p=u.mul(n.momentum).add(l.mul(n.learningRate).div(v.add(n.epsilon).sqrt())),c.assign(v),u.assign(p),m=o.sub(p),o.assign(m)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&os(this.accumulatedMeanSquares.map(function(r){return r.variable})),this.accumulatedMeanGrads!=null&&this.centered&&os(this.accumulatedMeanGrads.map(function(r){return r.variable})),this.accumulatedMoments!=null&&os(this.accumulatedMoments.map(function(r){return r.variable}))},t.prototype.getWeights=function(){return Ye(this,void 0,void 0,function(){var r;return Xe(this,function(n){switch(n.label){case 0:return r=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&r.push.apply(r,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(r.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(r){return Ye(this,void 0,void 0,function(){var n;return Xe(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(r)];case 1:return r=a.sent(),n=this.centered?r.length/3:r.length/2,this.accumulatedMeanSquares=r.slice(0,n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=r.slice(n,2*n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=r.slice(2*n,3*n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(r,n){return new r(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)},t.className="RMSProp",t}(nh);rh(Hge);Ir.prototype.squaredDifference=function(e){return hq(this,e)},ue=yge;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var $E=function(e,t){return $E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},$E(e,t)};function xt(e,t){$E(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ga=function(){return ga=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},ga.apply(this,arguments)};function tt(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{u(n.next(d))}catch(h){o(h)}}function c(d){try{u(n.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((n=n.apply(e,[])).next())})}function rt(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=u[0]&2?a.return:u[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,u[1])).done)return i;switch(a=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(d){u=[6,d],a=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Tv(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var i=arguments[t],o=0,l=i.length;o<l;o++,a++)n[a]=i[o];return n}var wf=function(){function e(t,r){if(!gd(t)||!gd(r))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:r}));this._width=t,this._height=r}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function Ij(e,t){return e instanceof Ir&&e.shape.length===t}function Kge(e){return Ij(e,2)}function Dj(e){return Ij(e,3)}function Wc(e){return Ij(e,4)}function Yge(e){return e%1!==0}function T3(e){return e%2===0}function Xge(e,t){t===void 0&&(t=2);var r=Math.pow(10,t);return Math.floor(e*r)/r}function R3(e){return e&&e.width&&e.height}function Qge(e,t){var r=e.width,n=e.height,a=t/Math.max(n,r);return new wf(Math.round(r*a),Math.round(n*a))}function gR(e){return e.reduce(function(t,r){return t.add(r)},new er(0,0)).div(new er(e.length,e.length))}function Ng(e,t,r){return Array(e).fill(0).map(function(n,a){return t+a*r})}function gd(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||e===0}function O3(e){return gd(e)&&0<=e&&e<=1}var er=function(){function e(t,r){this._x=t,this._y=r}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),tu=function(){function e(t,r){r===void 0&&(r=!0);var n=t||{},a=[n.left,n.top,n.right,n.bottom].every(gd),i=[n.x,n.y,n.width,n.height].every(gd);if(!i&&!a)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(n));var o=i?[n.x,n.y,n.width,n.height]:[n.left,n.top,n.right-n.left,n.bottom-n.top],l=o[0],c=o[1],u=o[2],d=o[3];e.assertIsValidBox({x:l,y:c,width:u,height:d},"Box.constructor",r),this._x=l,this._y=c,this._width=u,this._height=d}return e.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(gd)},e.assertIsValidBox=function(t,r,n){if(n===void 0&&(n=!1),!e.isRect(t))throw new Error(r+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!n&&(t.width<0||t.height<0))throw new Error(r+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new er(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new er(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new er(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new er(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(o){return Math.round(o)}),r=t[0],n=t[1],a=t[2],i=t[3];return new e({x:r,y:n,width:a,height:i})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(o){return Math.floor(o)}),r=t[0],n=t[1],a=t[2],i=t[3];return new e({x:r,y:n,width:a,height:i})},e.prototype.toSquare=function(){var t=this,r=t.x,n=t.y,a=t.width,i=t.height,o=Math.abs(a-i);return a<i&&(r-=o/2,a+=o),i<a&&(n-=o/2,i+=o),new e({x:r,y:n,width:a,height:i})},e.prototype.rescale=function(t){var r=R3(t)?t.width:t,n=R3(t)?t.height:t;return new e({x:this.x*r,y:this.y*n,width:this.width*r,height:this.height*n})},e.prototype.pad=function(t,r){var n=[this.x-t/2,this.y-r/2,this.width+t,this.height+r],a=n[0],i=n[1],o=n[2],l=n[3];return new e({x:a,y:i,width:o,height:l})},e.prototype.clipAtImageBorders=function(t,r){var n=this,a=n.x,i=n.y,o=n.right,l=n.bottom,c=Math.max(a,0),u=Math.max(i,0),d=o-c,h=l-u,f=Math.min(d,t-c),p=Math.min(h,r-u);return new e({x:c,y:u,width:f,height:p}).floor()},e.prototype.shift=function(t,r){var n=this,a=n.width,i=n.height,o=this.x+t,l=this.y+r;return new e({x:o,y:l,width:a,height:i})},e.prototype.padAtBorders=function(t,r){var n=this.width+1,a=this.height+1,i=1,o=1,l=n,c=a,u=this.left,d=this.top,h=this.right,f=this.bottom;return h>r&&(l=-h+r+n,h=r),f>t&&(c=-f+t+a,f=t),u<1&&(c=2-u,u=1),d<1&&(c=2-d,d=1),{dy:o,edy:c,dx:i,edx:l,y:d,ey:f,x:u,ex:h,w:n,h:a}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),Mj=function(e){xt(t,e);function t(r,n,a,i,o){return o===void 0&&(o=!1),e.call(this,{left:r,top:n,right:a,bottom:i},o)||this}return t}(tu),Zq=function(){function e(t,r,n,a,i){this._imageDims=new wf(i.width,i.height),this._score=t,this._classScore=r,this._className=n,this._box=new tu(a).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new tu(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,r){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:r})},e}(),Wo=function(e){xt(t,e);function t(r,n,a){return e.call(this,r,r,"",n,a)||this}return t.prototype.forSize=function(r,n){var a=e.prototype.forSize.call(this,r,n),i=a.score,o=a.relativeBox,l=a.imageDims;return new t(i,o,l)},t}(Zq);function Zge(e,t,r){r===void 0&&(r=!0);var n=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),a=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),i=n*a;return r?i/(e.area+t.area-i):i/Math.min(e.area,t.area)}function Jge(e){var t=e.map(function(l){return l.x}),r=e.map(function(l){return l.y}),n=t.reduce(function(l,c){return c<l?c:l},1/0),a=r.reduce(function(l,c){return c<l?c:l},1/0),i=t.reduce(function(l,c){return l<c?c:l},0),o=r.reduce(function(l,c){return l<c?c:l},0);return new Mj(n,a,i,o)}function _g(e,t,r,n){n===void 0&&(n=!0);for(var a=t.map(function(l,c){return{score:l,boxIndex:c}}).sort(function(l,c){return l.score-c.score}).map(function(l){return l.boxIndex}),i=[],o=function(){var l=a.pop();i.push(l);for(var c=a,u=[],d=0;d<c.length;d++){var h=c[d],f=e[l],p=e[h];u.push(Zge(f,p,n))}a=a.filter(function(m,v){return u[v]<=r})};a.length>0;)o();return i}function $x(e,t){return Ve(function(){var r=t[0],n=t[1],a=t[2],i=Ao(Tv(e.shape.slice(0,3),[1]),r),o=Ao(Tv(e.shape.slice(0,3),[1]),n),l=Ao(Tv(e.shape.slice(0,3),[1]),a),c=Tn([i,o,l],3);return Dn(e,c)})}function exe(e,t){return t===void 0&&(t=!1),Ve(function(){var r=e.shape.slice(1),n=r[0],a=r[1];if(n===a)return e;var i=Math.abs(n-a),o=Math.round(i*(t?.5:1)),l=n>a?2:1,c=function(p){var m=e.shape.slice();return m[l]=p,Ao(m,0)},u=c(o),d=i-u.shape[l],h=t&&d?c(d):null,f=[h,e,u].filter(function(p){return!!p}).map(function(p){return p.toFloat()});return Tn(f,l)})}function I2(e){return 1/(1+Math.exp(-e))}var xR=function(e){xt(t,e);function t(r,n,a,i,o){return o===void 0&&(o=!1),e.call(this,{x:r,y:n,width:a,height:i},o)||this}return t}(tu),txe=.5,rxe=.43,nxe=.45,cw=function(){function e(t,r,n){n===void 0&&(n=new er(0,0));var a=r.width,i=r.height;this._imgDims=new wf(a,i),this._shift=n,this._positions=t.map(function(o){return o.mul(new er(a,i)).add(n)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new er(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(r){return r.sub(t._shift).div(new er(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,r){return new this.constructor(this.relativePositions,{width:t,height:r})},e.prototype.shiftBy=function(t,r){return new this.constructor(this.relativePositions,this._imgDims,new er(t,r))},e.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},e.prototype.align=function(t,r){if(r===void 0&&(r={}),t){var n=t instanceof Wo?t.box.floor():new tu(t);return this.shiftBy(n.x,n.y).align(null,r)}var a=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},r),i=a.useDlibAlignment,o=a.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(o)},e.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),r=t[0],n=t[1],a=t[2],i=function(h){return a.sub(h).magnitude()},o=(i(r)+i(n))/2,l=Math.floor(o/nxe),c=gR(t),u=Math.floor(Math.max(0,c.x-txe*l)),d=Math.floor(Math.max(0,c.y-rxe*l));return new xR(u,d,Math.min(l,this.imageWidth+u),Math.min(l,this.imageHeight+d))},e.prototype.alignMinBbox=function(t){var r=Jge(this.positions);return r.pad(r.width*t,r.height*t)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),axe=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var r=this.positions;return[r[0],r[1],gR([r[3],r[4]])]},t}(cw),sxe=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(gR)},t}(cw),I3=function(){function e(t,r){this._label=t,this._distance=r}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+Xge(this.distance)+")":"")},e}(),D3=function(e){xt(t,e);function t(r,n){var a=e.call(this,r)||this;return a._label=n,a}return t.assertIsValidLabeledBox=function(r,n){if(tu.assertIsValidBox(r,n),!gd(r.label))throw new Error(n+" - expected property label ("+r.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(tu),rb=function(){function e(t,r){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(r)||r.some(function(n){return!(n instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=r}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},e.fromJSON=function(t){var r=t.descriptors.map(function(n){return new Float32Array(n)});return new e(t.label,r)},e}();(function(e){xt(t,e);function t(r,n,a,i){var o=e.call(this,r,n)||this;return o._score=a,o._classScore=i,o}return t.assertIsValidPredictedBox=function(r,n){if(D3.assertIsValidLabeledBox(r,n),!O3(r.score)||!O3(r.classScore))throw new Error(n+" - expected properties score ("+r.score+") and ("+r.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(D3);function ixe(e){return e.detection instanceof Wo}function yR(e,t){var r={detection:t};return Object.assign({},e,r)}function Jq(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:t}}function eG(e){var t="";if(!e)try{e=require("fs")}catch(n){t=n.toString()}var r=e?function(n){return new Promise(function(a,i){e.readFile(n,function(o,l){return o?i(o):a(l)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:r}}function tG(){var e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,r=function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},n=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},a=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=eG();return ga({Canvas:e||function(){function o(){}return o}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function o(){}return o}(),Image:t||function(){function o(){}return o}(),ImageData:global.ImageData||function(){function o(){}return o}(),Video:global.HTMLVideoElement||function(){function o(){}return o}(),createCanvasElement:r,createImageElement:n,fetch:a},i)}function rG(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function nG(){return typeof global=="object"&&typeof require=="function"&&typeof _ee<"u"&&typeof process<"u"&&!!process.version}var jn;function oxe(){if(!jn)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return jn}function FE(e){jn=e}function bR(){rG()&&FE(Jq()),nG()&&FE(tG())}function lxe(e){if(jn||bR(),!jn)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,r=t===void 0?jn.Canvas:t,n=e.Image,a=n===void 0?jn.Image:n;jn.Canvas=r,jn.Image=a,jn.createCanvasElement=e.createCanvasElement||function(){return new r},jn.createImageElement=e.createImageElement||function(){return new a},jn.ImageData=e.ImageData||jn.ImageData,jn.Video=e.Video||jn.Video,jn.fetch=e.fetch||jn.fetch,jn.readFile=e.readFile||jn.readFile}var Sa={getEnv:oxe,setEnv:FE,initialize:bR,createBrowserEnv:Jq,createFileSystem:eG,createNodejsEnv:tG,monkeyPatch:lxe,isBrowser:rG,isNodejs:nG};bR();function aG(e){return!Sa.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function Id(e){var t=Sa.getEnv(),r=t.Canvas,n=t.CanvasRenderingContext2D;if(e instanceof n)return e;var a=aG(e);if(!(a instanceof r))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=a.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var M3;(function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"})(M3||(M3={}));function sG(e){var t=Sa.getEnv(),r=t.Image,n=t.Video;return e instanceof r&&e.complete||e instanceof n&&e.readyState>=3}function cxe(e){return new Promise(function(t,r){if(e instanceof Sa.getEnv().Canvas||sG(e))return t();function n(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",n),i.currentTarget.removeEventListener("error",a),t(i))}function a(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",n),i.currentTarget.removeEventListener("error",a),r(i))}e.addEventListener("load",n),e.addEventListener("error",a)})}function iG(e){var t=Sa.getEnv(),r=t.Image,n=t.Video;return e instanceof r?new wf(e.naturalWidth,e.naturalHeight):e instanceof n?new wf(e.videoWidth,e.videoHeight):new wf(e.width,e.height)}function $j(e){var t=e.width,r=e.height,n=Sa.getEnv().createCanvasElement,a=n();return a.width=t,a.height=r,a}function wR(e,t){var r=Sa.getEnv().ImageData;if(!(e instanceof r)&&!sG(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var n=iG(e),a=n.width,i=n.height,o=$j({width:a,height:i});return e instanceof r?Id(o).putImageData(e,0,0):Id(o).drawImage(e,0,0,a,i),o}function uxe(e,t){return tt(this,void 0,void 0,function(){var r,n,a,i,o,l;return rt(this,function(c){switch(c.label){case 0:return r=Sa.getEnv().createCanvasElement(),n=e.shape.slice(Wc(e)?1:0),a=n[0],i=n[1],o=n[2],l=Ve(function(){return e.as3D(a,i,o).toInt()}),[4,vR.toPixels(l,r)];case 1:return c.sent(),l.dispose(),[2,r]}})})}function $3(e){var t=Sa.getEnv(),r=t.Image,n=t.Canvas,a=t.Video;return e instanceof r||e instanceof n||e instanceof a}function dxe(e,t,r){r===void 0&&(r=!1);var n=Sa.getEnv(),a=n.Image,i=n.Canvas;if(!(e instanceof a||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var o=iG(e),l=t/Math.max(o.height,o.width),c=l*o.width,u=l*o.height,d=$j({width:t,height:t}),h=e instanceof i?e:wR(e),f=Math.abs(c-u)/2,p=r&&c<u?f:0,m=r&&u<c?f:0;return Id(d).drawImage(h,p,m,c,u),d}var uw=function(){function e(t,r){var n=this;if(r===void 0&&(r=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=r,this._batchSize=t.length,t.forEach(function(a,i){if(Dj(a)){n._imageTensors[i]=a,n._inputDimensions[i]=a.shape;return}if(Wc(a)){var o=a.shape[0];if(o!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+o+" passed, but not supported in input array");n._imageTensors[i]=a,n._inputDimensions[i]=a.shape.slice(1);return}var l=a instanceof Sa.getEnv().Canvas?a:wR(a);n._canvases[i]=l,n._inputDimensions[i]=[l.height,l.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var t=this;return Ng(this.batchSize,0,1).map(function(r,n){return t.getReshapedInputDimensions(n)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},e.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},e.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},e.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},e.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var r=this.getInputWidth(t),n=this.getInputHeight(t);return Qge({width:r,height:n},this.inputSize)},e.prototype.toBatchTensor=function(t,r){var n=this;return r===void 0&&(r=!0),this._inputSize=t,Ve(function(){var a=Ng(n.batchSize,0,1).map(function(o){var l=n.getInput(o);if(l instanceof Ir){var c=Wc(l)?l:l.expandDims();return c=exe(c,r),(c.shape[1]!==t||c.shape[2]!==t)&&(c=uR.resizeBilinear(c,[t,t])),c.as3D(t,t,3)}if(l instanceof Sa.getEnv().Canvas)return vR.fromPixels(dxe(l,t,r));throw new Error("toBatchTensor - at batchIdx "+o+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+l)}),i=Is(a.map(function(o){return o.toFloat()})).as4D(n.batchSize,t,t,3);return i})},e}();function Xn(e){return tt(this,void 0,void 0,function(){var t,r,n;return rt(this,function(a){switch(a.label){case 0:if(e instanceof uw)return[2,e];if(t=Array.isArray(e)?e:[e],!t.length)throw new Error("toNetInput - empty array passed as input");return r=function(i){return Array.isArray(e)?" at input index "+i+":":""},n=t.map(aG),n.forEach(function(i,o){if(!$3(i)&&!Dj(i)&&!Wc(i))throw typeof t[o]=="string"?new Error("toNetInput -"+r(o)+" string passed, but could not resolve HTMLElement for element id "+t[o]):new Error("toNetInput -"+r(o)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Wc(i)){var l=i.shape[0];if(l!==1)throw new Error("toNetInput -"+r(o)+" tf.Tensor4D with batchSize "+l+" passed, but not supported in input array")}}),[4,Promise.all(n.map(function(i){return $3(i)&&cxe(i)}))];case 1:return a.sent(),[2,new uw(n,Array.isArray(e))]}})})}function jR(e,t){return tt(this,void 0,void 0,function(){var r,n,a,i,o,l,c;return rt(this,function(u){switch(u.label){case 0:return r=Sa.getEnv().Canvas,n=e,e instanceof r?[3,5]:[4,Xn(e)];case 1:if(a=u.sent(),a.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=a.getInput(0),i instanceof r?(o=i,[3,4]):[3,2];case 2:return[4,uxe(i)];case 3:o=u.sent(),u.label=4;case 4:n=o,u.label=5;case 5:return l=Id(n),c=t.map(function(d){return d instanceof Wo?d.forSize(n.width,n.height).box.floor():d}).map(function(d){return d.clipAtImageBorders(n.width,n.height)}),[2,c.map(function(d){var h=d.x,f=d.y,p=d.width,m=d.height,v=$j({width:p,height:m});return Id(v).putImageData(l.getImageData(h,f,p,m),0,0),v})]}})})}function NR(e,t){return tt(this,void 0,void 0,function(){return rt(this,function(r){if(!Dj(e)&&!Wc(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Wc(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,Ve(function(){var n=e.shape.slice(Wc(e)?1:0),a=n[0],i=n[1],o=n[2],l=t.map(function(u){return u instanceof Wo?u.forSize(i,a).box:u}).map(function(u){return u.clipAtImageBorders(i,a)}),c=l.map(function(u){var d=u.x,h=u.y,f=u.width,p=u.height;return Oq(e.as3D(a,i,o),[h,d,0],[p,f,o])});return c})]})})}function hxe(e,t){return tt(this,void 0,void 0,function(){var r,n;return rt(this,function(a){switch(a.label){case 0:return r=Sa.getEnv().fetch,[4,r(e,t)];case 1:if(n=a.sent(),!(n.status<400))throw new Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}})})}function fxe(e){return tt(this,void 0,void 0,function(){return rt(this,function(t){switch(t.label){case 0:return[4,hxe(e)];case 1:return[2,t.sent().json()]}})})}function oG(e,t){var r=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:r};if(e==="/")return{modelBaseUri:"/",manifestUri:"/"+r};var n=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(n,"");var a=e.split("/").filter(function(l){return l}),i=e.endsWith(".json")?a[a.length-1]:r,o=n+(e.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return o=e.startsWith("/")?"/"+o:o,{modelBaseUri:o,manifestUri:o==="/"?"/"+i:o+"/"+i}}function pxe(e,t){return tt(this,void 0,void 0,function(){var r,n,a,i;return rt(this,function(o){switch(o.label){case 0:return r=oG(e,t),n=r.manifestUri,a=r.modelBaseUri,[4,fxe(n)];case 1:return i=o.sent(),[2,Xq.loadWeights(i,a)]}})})}var Fl=function(){function e(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(t){var r=this.traversePropertyPath(t),n=r.obj,a=r.objProp;return n[a]},e.prototype.reassignParamFromPath=function(t,r){var n=this.traversePropertyPath(t),a=n.obj,i=n.objProp;a[i].dispose(),a[i]=r},e.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(r){var n=r.paramPath;return{path:n,tensor:t.getParamFromPath(n)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof ep})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof ep)})},e.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(r){var n=r.path,a=r.tensor;t.reassignParamFromPath(n,a.variable())})},e.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(r){var n=r.path,a=r.tensor,i=ra(a.dataSync());a.dispose(),t.reassignParamFromPath(n,i)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(r){if(t&&r.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+r.path);r.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var r=t.tensor;return Array.from(r.dataSync())}).reduce(function(t,r){return t.concat(r)}))},e.prototype.load=function(t){return tt(this,void 0,void 0,function(){return rt(this,function(r){switch(r.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return r.sent(),[2]}})})},e.prototype.loadFromUri=function(t){return tt(this,void 0,void 0,function(){var r;return rt(this,function(n){switch(n.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,pxe(t,this.getDefaultModelName())];case 1:return r=n.sent(),this.loadFromWeightMap(r),[2]}})})},e.prototype.loadFromDisk=function(t){return tt(this,void 0,void 0,function(){var r,n,a,i,o,l,c,u,d,h;return rt(this,function(f){switch(f.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return r=Sa.getEnv().readFile,n=oG(t,this.getDefaultModelName()),a=n.manifestUri,i=n.modelBaseUri,o=function(p){return Promise.all(p.map(function(m){return r(m).then(function(v){return v.buffer})}))},l=Xq.weightsLoaderFactory(o),d=(u=JSON).parse,[4,r(a)];case 1:return c=d.apply(u,[f.sent().toString()]),[4,l(c,i)];case 2:return h=f.sent(),this.loadFromWeightMap(h),[2]}})})},e.prototype.loadFromWeightMap=function(t){var r=this.extractParamsFromWeigthMap(t),n=r.paramMappings,a=r.params;this._paramMappings=n,this._params=a},e.prototype.extractWeights=function(t){var r=this.extractParams(t),n=r.paramMappings,a=r.params;this._paramMappings=n,this._params=a},e.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var r=t.split("/").reduce(function(i,o){if(!i.nextObj.hasOwnProperty(o))throw new Error("traversePropertyPath - object does not have property "+o+", for path "+t);return{obj:i.nextObj,objProp:o,nextObj:i.nextObj[o]}},{nextObj:this.params}),n=r.obj,a=r.objProp;if(!n||!a||!(n[a]instanceof Ir))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:n,objProp:a}},e}();function Ps(e,t,r){return Ve(function(){var n=sR(e,t.depthwise_filter,t.pointwise_filter,r,"same");return n=Mt(n,t.bias),n})}function D2(e,t,r){return r===void 0&&(r=!1),Ve(function(){var n=Dr(r?Mt(di(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Ps(e,t.conv0,[2,2])),a=Ps(n,t.conv1,[1,1]),i=Dr(Mt(n,a)),o=Ps(i,t.conv2,[1,1]);return Dr(Mt(n,Mt(a,o)))})}function nb(e,t,r,n){return r===void 0&&(r=!1),n===void 0&&(n=!0),Ve(function(){var a=Dr(r?Mt(di(e,t.conv0.filters,n?[2,2]:[1,1],"same"),t.conv0.bias):Ps(e,t.conv0,n?[2,2]:[1,1])),i=Ps(a,t.conv1,[1,1]),o=Dr(Mt(a,i)),l=Ps(o,t.conv2,[1,1]),c=Dr(Mt(a,Mt(i,l))),u=Ps(c,t.conv3,[1,1]);return Dr(Mt(a,Mt(i,Mt(l,u))))})}function Ui(e,t,r,n){return r===void 0&&(r="same"),n===void 0&&(n=!1),Ve(function(){var a=Mt(di(e,t.filters,[1,1],r),t.bias);return n?Dr(a):a})}function Ll(e,t){Object.keys(e).forEach(function(r){t.some(function(n){return n.originalPath===r})||e[r].dispose()})}function Fj(e,t){return function(r,n,a,i){var o=es(e(r*n*a*a),[a,a,r,n]),l=dn(e(n));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:o,bias:l}}}function _R(e,t){return function(r,n,a){var i=Vc(e(r*n),[r,n]),o=dn(e(n));return t.push({paramPath:a+"/weights"},{paramPath:a+"/bias"}),{weights:i,bias:o}}}var lG=function(){function e(t,r,n){this.depthwise_filter=t,this.pointwise_filter=r,this.bias=n}return e}();function SR(e,t){return function(r,n,a){var i=es(e(9*r),[3,3,r,1]),o=es(e(r*n),[1,1,r,n]),l=dn(e(n));return t.push({paramPath:a+"/depthwise_filter"},{paramPath:a+"/pointwise_filter"},{paramPath:a+"/bias"}),new lG(i,o,l)}}function CR(e){return function(t){var r=e(t+"/depthwise_filter",4),n=e(t+"/pointwise_filter",4),a=e(t+"/bias",1);return new lG(r,n,a)}}function fu(e,t){return function(r,n,a){var i=e[r];if(!Ij(i,n))throw new Error("expected weightMap["+r+"] to be a Tensor"+n+"D, instead have "+i);return t.push({originalPath:r,paramPath:a||r}),i}}function Bl(e){var t=e;function r(a){var i=t.slice(0,a);return t=t.slice(a),i}function n(){return t}return{extractWeights:r,getRemainingWeights:n}}function cG(e,t){var r=Fj(e,t),n=SR(e,t);function a(o,l,c,u){u===void 0&&(u=!1);var d=u?r(o,l,3,c+"/conv0"):n(o,l,c+"/conv0"),h=n(l,l,c+"/conv1"),f=n(l,l,c+"/conv2");return{conv0:d,conv1:h,conv2:f}}function i(o,l,c,u){u===void 0&&(u=!1);var d=a(o,l,c,u),h=d.conv0,f=d.conv1,p=d.conv2,m=n(l,l,c+"/conv3");return{conv0:h,conv1:f,conv2:p,conv3:m}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:i}}function mxe(e){var t=[],r=Bl(e),n=r.extractWeights,a=r.getRemainingWeights,i=cG(n,t).extractDenseBlock4Params,o=i(3,32,"dense0",!0),l=i(32,64,"dense1"),c=i(64,128,"dense2"),u=i(128,256,"dense3");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:o,dense1:l,dense2:c,dense3:u}}}function uG(e){return function(t){var r=e(t+"/filters",4),n=e(t+"/bias",1);return{filters:r,bias:n}}}function dG(e,t){var r=fu(e,t),n=uG(r),a=CR(r);function i(l,c){c===void 0&&(c=!1);var u=c?n(l+"/conv0"):a(l+"/conv0"),d=a(l+"/conv1"),h=a(l+"/conv2");return{conv0:u,conv1:d,conv2:h}}function o(l,c){c===void 0&&(c=!1);var u=c?n(l+"/conv0"):a(l+"/conv0"),d=a(l+"/conv1"),h=a(l+"/conv2"),f=a(l+"/conv3");return{conv0:u,conv1:d,conv2:h,conv3:f}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:o}}function vxe(e){var t=[],r=dG(e,t).extractDenseBlock4Params,n={dense0:r("dense0",!0),dense1:r("dense1"),dense2:r("dense2"),dense3:r("dense3")};return Ll(e,t),{params:n,paramMappings:t}}var hG=function(e){xt(t,e);function t(){return e.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(r){var n=this.params;if(!n)throw new Error("FaceFeatureExtractor - load model before inference");return Ve(function(){var a=r.toBatchTensor(112,!0),i=[122.782,117.001,104.298],o=$x(a,i).div(Fe(255)),l=nb(o,n.dense0,!0);return l=nb(l,n.dense1),l=nb(l,n.dense2),l=nb(l,n.dense3),l=Dx(l,[7,7],[2,2],"valid"),l})},t.prototype.forward=function(r){return tt(this,void 0,void 0,function(){var n;return rt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,Xn(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(r){return vxe(r)},t.prototype.extractParams=function(r){return mxe(r)},t}(Fl);function xo(e,t){return Ve(function(){return Mt(Tj(e,t.weights),t.bias)})}function gxe(e,t,r){var n=[],a=Bl(e),i=a.extractWeights,o=a.getRemainingWeights,l=_R(i,n),c=l(t,r,"fc");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:n,params:{fc:c}}}function xxe(e){var t=[],r=fu(e,t);function n(i){var o=r(i+"/weights",2),l=r(i+"/bias",1);return{weights:o,bias:l}}var a={fc:n("fc")};return Ll(e,t),{params:a,paramMappings:t}}function fG(e){var t={},r={};return Object.keys(e).forEach(function(n){var a=n.startsWith("fc")?r:t;a[n]=e[n]}),{featureExtractorMap:t,classifierMap:r}}var pG=function(e){xt(t,e);function t(r,n){var a=e.call(this,r)||this;return a._faceFeatureExtractor=n,a}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(r){var n=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return Ve(function(){var i=r instanceof uw?n.faceFeatureExtractor.forwardInput(r):r;return xo(i.as2D(i.shape[0],-1),a.fc)})},t.prototype.dispose=function(r){r===void 0&&(r=!0),this.faceFeatureExtractor.dispose(r),e.prototype.dispose.call(this,r)},t.prototype.loadClassifierParams=function(r){var n=this.extractClassifierParams(r),a=n.params,i=n.paramMappings;this._params=a,this._paramMappings=i},t.prototype.extractClassifierParams=function(r){return gxe(r,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(r){var n=fG(r),a=n.featureExtractorMap,i=n.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),xxe(i)},t.prototype.extractParams=function(r){var n=this.getClassifierChannelsIn(),a=this.getClassifierChannelsOut(),i=a*n+a,o=r.slice(0,r.length-i),l=r.slice(r.length-i);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(l)},t}(Fl),F3=["neutral","happy","sad","angry","fearful","disgusted","surprised"],yxe=function(){function e(t){var r=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);F3.forEach(function(n,a){r[n]=t[a]})}return e.prototype.asSortedArray=function(){var t=this;return F3.map(function(r){return{expression:r,probability:t[r]}}).sort(function(r,n){return n.probability-r.probability})},e}(),bxe=function(e){xt(t,e);function t(r){return r===void 0&&(r=new hG),e.call(this,"FaceExpressionNet",r)||this}return t.prototype.forwardInput=function(r){var n=this;return Ve(function(){return Ml(n.runNet(r))})},t.prototype.forward=function(r){return tt(this,void 0,void 0,function(){var n;return rt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,Xn(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.predictExpressions=function(r){return tt(this,void 0,void 0,function(){var n,a,i,o,l=this;return rt(this,function(c){switch(c.label){case 0:return[4,Xn(r)];case 1:return n=c.sent(),[4,this.forwardInput(n)];case 2:return a=c.sent(),[4,Promise.all(Rn(a).map(function(u){return tt(l,void 0,void 0,function(){var d;return rt(this,function(h){switch(h.label){case 0:return[4,u.data()];case 1:return d=h.sent(),u.dispose(),[2,d]}})})}))];case 3:return i=c.sent(),a.dispose(),o=i.map(function(u){return new yxe(u)}),[2,n.isBatchInput?o:o[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(pG);function mG(e,t){var r={expressions:t};return Object.assign({},e,r)}function wxe(e){return ixe(e)&&e.landmarks instanceof cw&&e.unshiftedLandmarks instanceof cw&&e.alignedRect instanceof Wo}function ER(e,t){var r=e.detection.box,n=t.shiftBy(r.x,r.y),a=n.align(),i=e.detection.imageDims,o=new Wo(e.detection.score,a.rescale(i.reverse()),i),l={landmarks:n,unshiftedLandmarks:t,alignedRect:o};return Object.assign({},e,l)}function jxe(e,t){var r=Fj(e,t),n=SR(e,t);function a(o,l,c){var u=n(o,l,c+"/separable_conv0"),d=n(l,l,c+"/separable_conv1"),h=r(o,l,1,c+"/expansion_conv");return{separable_conv0:u,separable_conv1:d,expansion_conv:h}}function i(o,l){var c=n(o,o,l+"/separable_conv0"),u=n(o,o,l+"/separable_conv1"),d=n(o,o,l+"/separable_conv2");return{separable_conv0:c,separable_conv1:u,separable_conv2:d}}return{extractConvParams:r,extractSeparableConvParams:n,extractReductionBlockParams:a,extractMainBlockParams:i}}function Nxe(e,t){var r=[],n=Bl(e),a=n.extractWeights,i=n.getRemainingWeights,o=jxe(a,r),l=o.extractConvParams,c=o.extractSeparableConvParams,u=o.extractReductionBlockParams,d=o.extractMainBlockParams,h=l(3,32,3,"entry_flow/conv_in"),f=u(32,64,"entry_flow/reduction_block_0"),p=u(64,128,"entry_flow/reduction_block_1"),m={conv_in:h,reduction_block_0:f,reduction_block_1:p},v={};Ng(t,0,1).forEach(function(b){v["main_block_"+b]=d(128,"middle_flow/main_block_"+b)});var g=u(128,256,"exit_flow/reduction_block"),x=c(256,512,"exit_flow/separable_conv"),y={reduction_block:g,separable_conv:x};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:r,params:{entry_flow:m,middle_flow:v,exit_flow:y}}}function _xe(e,t){var r=fu(e,t),n=uG(r),a=CR(r);function i(l){var c=a(l+"/separable_conv0"),u=a(l+"/separable_conv1"),d=n(l+"/expansion_conv");return{separable_conv0:c,separable_conv1:u,expansion_conv:d}}function o(l){var c=a(l+"/separable_conv0"),u=a(l+"/separable_conv1"),d=a(l+"/separable_conv2");return{separable_conv0:c,separable_conv1:u,separable_conv2:d}}return{extractConvParams:n,extractSeparableConvParams:a,extractReductionBlockParams:i,extractMainBlockParams:o}}function Sxe(e,t){var r=[],n=_xe(e,r),a=n.extractConvParams,i=n.extractSeparableConvParams,o=n.extractReductionBlockParams,l=n.extractMainBlockParams,c=a("entry_flow/conv_in"),u=o("entry_flow/reduction_block_0"),d=o("entry_flow/reduction_block_1"),h={conv_in:c,reduction_block_0:u,reduction_block_1:d},f={};Ng(t,0,1).forEach(function(g){f["main_block_"+g]=l("middle_flow/main_block_"+g)});var p=o("exit_flow/reduction_block"),m=i("exit_flow/separable_conv"),v={reduction_block:p,separable_conv:m};return Ll(e,r),{params:{entry_flow:h,middle_flow:f,exit_flow:v},paramMappings:r}}function vG(e,t,r){return Mt(di(e,t.filters,r,"same"),t.bias)}function M2(e,t,r){r===void 0&&(r=!0);var n=r?Dr(e):e;return n=Ps(n,t.separable_conv0,[1,1]),n=Ps(Dr(n),t.separable_conv1,[1,1]),n=Un(n,[3,3],[2,2],"same"),n=Mt(n,vG(e,t.expansion_conv,[2,2])),n}function Cxe(e,t){var r=Ps(Dr(e),t.separable_conv0,[1,1]);return r=Ps(Dr(r),t.separable_conv1,[1,1]),r=Ps(Dr(r),t.separable_conv2,[1,1]),r=Mt(r,e),r}var Exe=function(e){xt(t,e);function t(r){var n=e.call(this,"TinyXception")||this;return n._numMainBlocks=r,n}return t.prototype.forwardInput=function(r){var n=this,a=this.params;if(!a)throw new Error("TinyXception - load model before inference");return Ve(function(){var i=r.toBatchTensor(112,!0),o=[122.782,117.001,104.298],l=$x(i,o).div(Fe(256)),c=Dr(vG(l,a.entry_flow.conv_in,[2,2]));return c=M2(c,a.entry_flow.reduction_block_0,!1),c=M2(c,a.entry_flow.reduction_block_1),Ng(n._numMainBlocks,0,1).forEach(function(u){c=Cxe(c,a.middle_flow["main_block_"+u])}),c=M2(c,a.exit_flow.reduction_block),c=Dr(Ps(c,a.exit_flow.separable_conv,[1,1])),c})},t.prototype.forward=function(r){return tt(this,void 0,void 0,function(){var n;return rt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,Xn(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(r){return Sxe(r,this._numMainBlocks)},t.prototype.extractParams=function(r){return Nxe(r,this._numMainBlocks)},t}(Fl);function kxe(e){var t=[],r=Bl(e),n=r.extractWeights,a=r.getRemainingWeights,i=_R(n,t),o=i(512,1,"fc/age"),l=i(512,2,"fc/gender");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{fc:{age:o,gender:l}}}}function Axe(e){var t=[],r=fu(e,t);function n(i){var o=r(i+"/weights",2),l=r(i+"/bias",1);return{weights:o,bias:l}}var a={fc:{age:n("fc/age"),gender:n("fc/gender")}};return Ll(e,t),{params:a,paramMappings:t}}var dw;(function(e){e.FEMALE="female",e.MALE="male"})(dw||(dw={}));var Pxe=function(e){xt(t,e);function t(r){r===void 0&&(r=new Exe(2));var n=e.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=r,n}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(r){var n=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return Ve(function(){var i=r instanceof uw?n.faceFeatureExtractor.forwardInput(r):r,o=Dx(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),l=xo(o,a.fc.age).as1D(),c=xo(o,a.fc.gender);return{age:l,gender:c}})},t.prototype.forwardInput=function(r){var n=this;return Ve(function(){var a=n.runNet(r),i=a.age,o=a.gender;return{age:i,gender:Ml(o)}})},t.prototype.forward=function(r){return tt(this,void 0,void 0,function(){var n;return rt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,Xn(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.predictAgeAndGender=function(r){return tt(this,void 0,void 0,function(){var n,a,i,o,l,c,u=this;return rt(this,function(d){switch(d.label){case 0:return[4,Xn(r)];case 1:return n=d.sent(),[4,this.forwardInput(n)];case 2:return a=d.sent(),i=Rn(a.age),o=Rn(a.gender),l=i.map(function(h,f){return{ageTensor:h,genderTensor:o[f]}}),[4,Promise.all(l.map(function(h){var f=h.ageTensor,p=h.genderTensor;return tt(u,void 0,void 0,function(){var m,v,g,x,y;return rt(this,function(b){switch(b.label){case 0:return[4,f.data()];case 1:return m=b.sent()[0],[4,p.data()];case 2:return v=b.sent()[0],g=v>.5,x=g?dw.MALE:dw.FEMALE,y=g?v:1-v,f.dispose(),p.dispose(),[2,{age:m,gender:x,genderProbability:y}]}})})}))];case 3:return c=d.sent(),a.age.dispose(),a.gender.dispose(),[2,n.isBatchInput?c:c[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(r){r===void 0&&(r=!0),this.faceFeatureExtractor.dispose(r),e.prototype.dispose.call(this,r)},t.prototype.loadClassifierParams=function(r){var n=this.extractClassifierParams(r),a=n.params,i=n.paramMappings;this._params=a,this._paramMappings=i},t.prototype.extractClassifierParams=function(r){return kxe(r)},t.prototype.extractParamsFromWeigthMap=function(r){var n=fG(r),a=n.featureExtractorMap,i=n.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),Axe(i)},t.prototype.extractParams=function(r){var n=1539,a=r.slice(0,r.length-n),i=r.slice(r.length-n);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(i)},t}(Fl),gG=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.postProcess=function(r,n,a){var i=a.map(function(l){var c=l.width,u=l.height,d=n/Math.max(u,c);return{width:c*d,height:u*d}}),o=i.length;return Ve(function(){var l=function(f,p){return Is([Ao([68],f),Ao([68],p)],1).as2D(1,136).as1D()},c=function(f,p){var m=i[f],v=m.width,g=m.height;return p(v,g)?Math.abs(v-g)/2:0},u=function(f){return c(f,function(p,m){return p<m})},d=function(f){return c(f,function(p,m){return m<p})},h=r.mul(Ao([o,136],n)).sub(Is(Array.from(Array(o),function(f,p){return l(u(p),d(p))}))).div(Is(Array.from(Array(o),function(f,p){return l(i[p].width,i[p].height)})));return h})},t.prototype.forwardInput=function(r){var n=this;return Ve(function(){var a=n.runNet(r);return n.postProcess(a,r.inputSize,r.inputDimensions.map(function(i){var o=i[0],l=i[1];return{height:o,width:l}}))})},t.prototype.forward=function(r){return tt(this,void 0,void 0,function(){var n;return rt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,Xn(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.detectLandmarks=function(r){return tt(this,void 0,void 0,function(){var n,a,i,o=this;return rt(this,function(l){switch(l.label){case 0:return[4,Xn(r)];case 1:return n=l.sent(),a=Ve(function(){return Rn(o.forwardInput(n))}),[4,Promise.all(a.map(function(c,u){return tt(o,void 0,void 0,function(){var d,h,f,p,m;return rt(this,function(v){switch(v.label){case 0:return f=(h=Array).from,[4,c.data()];case 1:return d=f.apply(h,[v.sent()]),p=d.filter(function(g,x){return T3(x)}),m=d.filter(function(g,x){return!T3(x)}),[2,new sxe(Array(68).fill(0).map(function(g,x){return new er(p[x],m[x])}),{height:n.getInputHeight(u),width:n.getInputWidth(u)})]}})})}))];case 2:return i=l.sent(),a.forEach(function(c){return c.dispose()}),[2,n.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(pG),xG=function(e){xt(t,e);function t(r){return r===void 0&&(r=new hG),e.call(this,"FaceLandmark68Net",r)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(gG);function Txe(e){var t=[],r=dG(e,t).extractDenseBlock3Params,n={dense0:r("dense0",!0),dense1:r("dense1"),dense2:r("dense2")};return Ll(e,t),{params:n,paramMappings:t}}function Rxe(e){var t=[],r=Bl(e),n=r.extractWeights,a=r.getRemainingWeights,i=cG(n,t).extractDenseBlock3Params,o=i(3,32,"dense0",!0),l=i(32,64,"dense1"),c=i(64,128,"dense2");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:o,dense1:l,dense2:c}}}var Oxe=function(e){xt(t,e);function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(r){var n=this.params;if(!n)throw new Error("TinyFaceFeatureExtractor - load model before inference");return Ve(function(){var a=r.toBatchTensor(112,!0),i=[122.782,117.001,104.298],o=$x(a,i).div(Fe(255)),l=D2(o,n.dense0,!0);return l=D2(l,n.dense1),l=D2(l,n.dense2),l=Dx(l,[14,14],[2,2],"valid"),l})},t.prototype.forward=function(r){return tt(this,void 0,void 0,function(){var n;return rt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,Xn(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(r){return Txe(r)},t.prototype.extractParams=function(r){return Rxe(r)},t}(Fl),Ixe=function(e){xt(t,e);function t(r){return r===void 0&&(r=new Oxe),e.call(this,"FaceLandmark68TinyNet",r)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(gG);(function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(xG);function Dxe(e,t){return Mt(ja(e,t.weights),t.biases)}function kR(e,t,r,n,a){a===void 0&&(a="same");var i=t.conv,o=i.filters,l=i.bias,c=di(e,o,r,a);return c=Mt(c,l),c=Dxe(c,t.scale),n?Dr(c):c}function Mxe(e,t){return kR(e,t,[1,1],!0)}function yG(e,t){return kR(e,t,[1,1],!1)}function bG(e,t){return kR(e,t,[2,2],!0,"valid")}function $xe(e,t){function r(l,c,u){var d=e(l),h=d.length/(c*u*u);if(Yge(h))throw new Error("depth has to be an integer: "+h+", weights.length: "+d.length+", numFilters: "+c+", filterSize: "+u);return Ve(function(){return eu(es(d,[c,h,u,u]),[2,3,1,0])})}function n(l,c,u,d){var h=r(l,c,u),f=dn(e(c));return t.push({paramPath:d+"/filters"},{paramPath:d+"/bias"}),{filters:h,bias:f}}function a(l,c){var u=dn(e(l)),d=dn(e(l));return t.push({paramPath:c+"/weights"},{paramPath:c+"/biases"}),{weights:u,biases:d}}function i(l,c,u,d){var h=n(l,c,u,d+"/conv"),f=a(c,d+"/scale");return{conv:h,scale:f}}function o(l,c,u,d,h){h===void 0&&(h=!1);var f=i((h?.5:1)*l,c,u,d+"/conv1"),p=i(l,c,u,d+"/conv2");return{conv1:f,conv2:p}}return{extractConvLayerParams:i,extractResidualLayerParams:o}}function Fxe(e){var t=Bl(e),r=t.extractWeights,n=t.getRemainingWeights,a=[],i=$xe(r,a),o=i.extractConvLayerParams,l=i.extractResidualLayerParams,c=o(4704,32,7,"conv32_down"),u=l(9216,32,3,"conv32_1"),d=l(9216,32,3,"conv32_2"),h=l(9216,32,3,"conv32_3"),f=l(36864,64,3,"conv64_down",!0),p=l(36864,64,3,"conv64_1"),m=l(36864,64,3,"conv64_2"),v=l(36864,64,3,"conv64_3"),g=l(147456,128,3,"conv128_down",!0),x=l(147456,128,3,"conv128_1"),y=l(147456,128,3,"conv128_2"),b=l(589824,256,3,"conv256_down",!0),N=l(589824,256,3,"conv256_1"),j=l(589824,256,3,"conv256_2"),_=l(589824,256,3,"conv256_down_out"),S=Ve(function(){return eu(Vc(r(256*128),[128,256]),[1,0])});if(a.push({paramPath:"fc"}),n().length!==0)throw new Error("weights remaing after extract: "+n().length);var C={conv32_down:c,conv32_1:u,conv32_2:d,conv32_3:h,conv64_down:f,conv64_1:p,conv64_2:m,conv64_3:v,conv128_down:g,conv128_1:x,conv128_2:y,conv256_down:b,conv256_1:N,conv256_2:j,conv256_down_out:_,fc:S};return{params:C,paramMappings:a}}function Lxe(e,t){var r=fu(e,t);function n(o){var l=r(o+"/scale/weights",1),c=r(o+"/scale/biases",1);return{weights:l,biases:c}}function a(o){var l=r(o+"/conv/filters",4),c=r(o+"/conv/bias",1),u=n(o);return{conv:{filters:l,bias:c},scale:u}}function i(o){return{conv1:a(o+"/conv1"),conv2:a(o+"/conv2")}}return{extractConvLayerParams:a,extractResidualLayerParams:i}}function Bxe(e){var t=[],r=Lxe(e,t),n=r.extractConvLayerParams,a=r.extractResidualLayerParams,i=n("conv32_down"),o=a("conv32_1"),l=a("conv32_2"),c=a("conv32_3"),u=a("conv64_down"),d=a("conv64_1"),h=a("conv64_2"),f=a("conv64_3"),p=a("conv128_down"),m=a("conv128_1"),v=a("conv128_2"),g=a("conv256_down"),x=a("conv256_1"),y=a("conv256_2"),b=a("conv256_down_out"),N=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!Kge(N))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+N);var j={conv32_down:i,conv32_1:o,conv32_2:l,conv32_3:c,conv64_down:u,conv64_1:d,conv64_2:h,conv64_3:f,conv128_down:p,conv128_1:m,conv128_2:v,conv256_down:g,conv256_1:x,conv256_2:y,conv256_down_out:b,fc:N};return Ll(e,t),{params:j,paramMappings:t}}function so(e,t){var r=Mxe(e,t.conv1);return r=yG(r,t.conv2),r=Mt(r,e),r=Dr(r),r}function ab(e,t){var r=bG(e,t.conv1);r=yG(r,t.conv2);var n=Dx(e,2,2,"valid"),a=_r(n.shape),i=n.shape[3]!==r.shape[3],o=n.shape[1]!==r.shape[1]||n.shape[2]!==r.shape[2];if(o){var l=Tv(r.shape);l[1]=1;var c=_r(l);r=Tn([r,c],1);var u=Tv(r.shape);u[2]=1;var d=_r(u);r=Tn([r,d],2)}return n=i?Tn([n,a],3):n,r=Mt(n,r),r=Dr(r),r}var Uxe=function(e){xt(t,e);function t(){return e.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(r){var n=this.params;if(!n)throw new Error("FaceRecognitionNet - load model before inference");return Ve(function(){var a=r.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],o=$x(a,i).div(Fe(256)),l=bG(o,n.conv32_down);l=Un(l,3,2,"valid"),l=so(l,n.conv32_1),l=so(l,n.conv32_2),l=so(l,n.conv32_3),l=ab(l,n.conv64_down),l=so(l,n.conv64_1),l=so(l,n.conv64_2),l=so(l,n.conv64_3),l=ab(l,n.conv128_down),l=so(l,n.conv128_1),l=so(l,n.conv128_2),l=ab(l,n.conv256_down),l=so(l,n.conv256_1),l=so(l,n.conv256_2),l=ab(l,n.conv256_down_out);var c=l.mean([1,2]),u=Tj(c,n.fc);return u})},t.prototype.forward=function(r){return tt(this,void 0,void 0,function(){var n;return rt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,Xn(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.computeFaceDescriptor=function(r){return tt(this,void 0,void 0,function(){var n,a,i,o=this;return rt(this,function(l){switch(l.label){case 0:return[4,Xn(r)];case 1:return n=l.sent(),a=Ve(function(){return Rn(o.forwardInput(n))}),[4,Promise.all(a.map(function(c){return c.data()}))];case 2:return i=l.sent(),a.forEach(function(c){return c.dispose()}),[2,n.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(r){return Bxe(r)},t.prototype.extractParams=function(r){return Fxe(r)},t}(Fl);function wG(e,t){var r={descriptor:t};return Object.assign({},e,r)}function jG(e,t){var r={age:t};return Object.assign({},e,r)}function NG(e,t,r){var n={gender:t,genderProbability:r};return Object.assign({},e,n)}var _G=function(){function e(t){var r=t===void 0?{}:t,n=r.minFaceSize,a=r.scaleFactor,i=r.maxNumScales,o=r.scoreThresholds,l=r.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=a||.709,this._maxNumScales=i||10,this._scoreThresholds=o||[.6,.7,.7],this._scaleSteps=l,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(c){return typeof c!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(c){return typeof c!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function Vxe(e,t){function r(c,u){var d=es(e(9*c),[3,3,c,1]),h=dn(e(c)),f=dn(e(c)),p=dn(e(c)),m=dn(e(c));return t.push({paramPath:u+"/filters"},{paramPath:u+"/batch_norm_scale"},{paramPath:u+"/batch_norm_offset"},{paramPath:u+"/batch_norm_mean"},{paramPath:u+"/batch_norm_variance"}),{filters:d,batch_norm_scale:h,batch_norm_offset:f,batch_norm_mean:p,batch_norm_variance:m}}function n(c,u,d,h,f){var p=es(e(c*u*d*d),[d,d,c,u]),m=dn(e(u));return t.push({paramPath:h+"/filters"},{paramPath:h+"/"+(f?"batch_norm_offset":"bias")}),{filters:p,bias:m}}function a(c,u,d,h){var f=n(c,u,d,h,!0),p=f.filters,m=f.bias;return{filters:p,batch_norm_offset:m}}function i(c,u,d){var h=r(c,d+"/depthwise_conv"),f=a(c,u,1,d+"/pointwise_conv");return{depthwise_conv:h,pointwise_conv:f}}function o(){var c=a(3,32,3,"mobilenetv1/conv_0"),u=i(32,64,"mobilenetv1/conv_1"),d=i(64,128,"mobilenetv1/conv_2"),h=i(128,128,"mobilenetv1/conv_3"),f=i(128,256,"mobilenetv1/conv_4"),p=i(256,256,"mobilenetv1/conv_5"),m=i(256,512,"mobilenetv1/conv_6"),v=i(512,512,"mobilenetv1/conv_7"),g=i(512,512,"mobilenetv1/conv_8"),x=i(512,512,"mobilenetv1/conv_9"),y=i(512,512,"mobilenetv1/conv_10"),b=i(512,512,"mobilenetv1/conv_11"),N=i(512,1024,"mobilenetv1/conv_12"),j=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:c,conv_1:u,conv_2:d,conv_3:h,conv_4:f,conv_5:p,conv_6:m,conv_7:v,conv_8:g,conv_9:x,conv_10:y,conv_11:b,conv_12:N,conv_13:j}}function l(){var c=a(1024,256,1,"prediction_layer/conv_0"),u=a(256,512,3,"prediction_layer/conv_1"),d=a(512,128,1,"prediction_layer/conv_2"),h=a(128,256,3,"prediction_layer/conv_3"),f=a(256,128,1,"prediction_layer/conv_4"),p=a(128,256,3,"prediction_layer/conv_5"),m=a(256,64,1,"prediction_layer/conv_6"),v=a(64,128,3,"prediction_layer/conv_7"),g=n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),x=n(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),y=n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),b=n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),N=n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),j=n(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),_=n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),S=n(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),C=n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),E=n(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),k=n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),P=n(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),A={box_encoding_predictor:g,class_predictor:x},O={box_encoding_predictor:y,class_predictor:b},I={box_encoding_predictor:N,class_predictor:j},R={box_encoding_predictor:_,class_predictor:S},M={box_encoding_predictor:C,class_predictor:E},B={box_encoding_predictor:k,class_predictor:P};return{conv_0:c,conv_1:u,conv_2:d,conv_3:h,conv_4:f,conv_5:p,conv_6:m,conv_7:v,box_predictor_0:A,box_predictor_1:O,box_predictor_2:I,box_predictor_3:R,box_predictor_4:M,box_predictor_5:B}}return{extractMobilenetV1Params:o,extractPredictionLayerParams:l}}function zxe(e){var t=[],r=Bl(e),n=r.extractWeights,a=r.getRemainingWeights,i=Vxe(n,t),o=i.extractMobilenetV1Params,l=i.extractPredictionLayerParams,c=o(),u=l(),d=WT(n(5118*4),[1,5118,4]),h={extra_dim:d};if(t.push({paramPath:"output_layer/extra_dim"}),a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:{mobilenetv1:c,prediction_layer:u,output_layer:h},paramMappings:t}}function Wxe(e,t){var r=fu(e,t);function n(u,d,h){var f=r(u+"/Conv2d_"+d+"_pointwise/weights",4,h+"/filters"),p=r(u+"/Conv2d_"+d+"_pointwise/convolution_bn_offset",1,h+"/batch_norm_offset");return{filters:f,batch_norm_offset:p}}function a(u){var d="mobilenetv1/conv_"+u,h="MobilenetV1/Conv2d_"+u+"_depthwise",f=d+"/depthwise_conv",p=d+"/pointwise_conv",m=r(h+"/depthwise_weights",4,f+"/filters"),v=r(h+"/BatchNorm/gamma",1,f+"/batch_norm_scale"),g=r(h+"/BatchNorm/beta",1,f+"/batch_norm_offset"),x=r(h+"/BatchNorm/moving_mean",1,f+"/batch_norm_mean"),y=r(h+"/BatchNorm/moving_variance",1,f+"/batch_norm_variance");return{depthwise_conv:{filters:m,batch_norm_scale:v,batch_norm_offset:g,batch_norm_mean:x,batch_norm_variance:y},pointwise_conv:n("MobilenetV1",u,p)}}function i(){return{conv_0:n("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}}function o(u,d){var h=r(u+"/weights",4,d+"/filters"),f=r(u+"/biases",1,d+"/bias");return{filters:h,bias:f}}function l(u){var d=o("Prediction/BoxPredictor_"+u+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+u+"/box_encoding_predictor"),h=o("Prediction/BoxPredictor_"+u+"/ClassPredictor","prediction_layer/box_predictor_"+u+"/class_predictor");return{box_encoding_predictor:d,class_predictor:h}}function c(){return{conv_0:n("Prediction",0,"prediction_layer/conv_0"),conv_1:n("Prediction",1,"prediction_layer/conv_1"),conv_2:n("Prediction",2,"prediction_layer/conv_2"),conv_3:n("Prediction",3,"prediction_layer/conv_3"),conv_4:n("Prediction",4,"prediction_layer/conv_4"),conv_5:n("Prediction",5,"prediction_layer/conv_5"),conv_6:n("Prediction",6,"prediction_layer/conv_6"),conv_7:n("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:l(0),box_predictor_1:l(1),box_predictor_2:l(2),box_predictor_3:l(3),box_predictor_4:l(4),box_predictor_5:l(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:c}}function qxe(e){var t=[],r=Wxe(e,t),n=r.extractMobilenetV1Params,a=r.extractPredictionLayerParams,i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Dj(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var o={mobilenetv1:n(),prediction_layer:a(),output_layer:{extra_dim:i}};return Ll(e,t),{params:o,paramMappings:t}}function oo(e,t,r){return Ve(function(){var n=di(e,t.filters,r,"same");return n=Mt(n,t.batch_norm_offset),tR(n,0,6)})}var Gxe=.0010000000474974513;function Hxe(e,t,r){return Ve(function(){var n=Pj(e,t.filters,r,"same");return n=xq(n,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,Gxe),tR(n,0,6)})}function Kxe(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}function Yxe(e,t){return Ve(function(){var r=null,n=oo(e,t.conv_0,[2,2]),a=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(a.forEach(function(i,o){var l=o+1,c=Kxe(l);n=Hxe(n,i.depthwise_conv,c),n=oo(n,i.pointwise_conv,[1,1]),l===11&&(r=n)}),r===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:n,conv11:r}})}function Xxe(e,t,r,n,a){var i=e.shape[0],o=Math.min(r,i),l=t.map(function(d,h){return{score:d,boxIndex:h}}).filter(function(d){return d.score>a}).sort(function(d,h){return h.score-d.score}),c=function(d){return d<=n?1:0},u=[];return l.forEach(function(d){if(!(u.length>=o)){for(var h=d.score,f=u.length-1;f>=0;--f){var p=Qxe(e,d.boxIndex,u[f]);if(p!==0&&(d.score*=c(p),d.score<=a))break}h===d.score&&u.push(d.boxIndex)}}),u}function Qxe(e,t,r){var n=e.arraySync(),a=Math.min(n[t][0],n[t][2]),i=Math.min(n[t][1],n[t][3]),o=Math.max(n[t][0],n[t][2]),l=Math.max(n[t][1],n[t][3]),c=Math.min(n[r][0],n[r][2]),u=Math.min(n[r][1],n[r][3]),d=Math.max(n[r][0],n[r][2]),h=Math.max(n[r][1],n[r][3]),f=(o-a)*(l-i),p=(d-c)*(h-u);if(f<=0||p<=0)return 0;var m=Math.max(a,c),v=Math.max(i,u),g=Math.min(o,d),x=Math.min(l,h),y=Math.max(g-m,0)*Math.max(x-v,0);return y/(f+p-y)}function Zxe(e){var t=Rn(eu(e,[1,0])),r=[Dn(t[2],t[0]),Dn(t[3],t[1])],n=[Mt(t[0],Ti(r[0],Fe(2))),Mt(t[1],Ti(r[1],Fe(2)))];return{sizes:r,centers:n}}function Jxe(e,t){var r=Zxe(e),n=r.sizes,a=r.centers,i=Rn(eu(t,[1,0])),o=Ti(ja(TE(Ti(i[2],Fe(5))),n[0]),Fe(2)),l=Mt(ja(Ti(i[0],Fe(10)),n[0]),a[0]),c=Ti(ja(TE(Ti(i[3],Fe(5))),n[1]),Fe(2)),u=Mt(ja(Ti(i[1],Fe(10)),n[1]),a[1]);return eu(Is([Dn(l,o),Dn(u,c),Mt(l,o),Mt(u,c)]),[1,0])}function eye(e,t,r){return Ve(function(){var n=e.shape[0],a=Jxe(Mi(vf(r.extra_dim,[n,1,1]),[-1,4]),Mi(e,[-1,4]));a=Mi(a,[n,a.shape[0]/n,4]);var i=pq(Do(t,[0,0,1],[-1,-1,-1])),o=Do(i,[0,0,0],[-1,-1,1]);o=Mi(o,[n,o.shape[1]]);var l=Rn(a),c=Rn(o);return{boxes:l,scores:c}})}function wh(e,t){return Ve(function(){var r=e.shape[0],n=Mi(Ui(e,t.box_encoding_predictor),[r,-1,1,4]),a=Mi(Ui(e,t.class_predictor),[r,-1,3]);return{boxPredictionEncoding:n,classPrediction:a}})}function tye(e,t,r){return Ve(function(){var n=oo(e,r.conv_0,[1,1]),a=oo(n,r.conv_1,[2,2]),i=oo(a,r.conv_2,[1,1]),o=oo(i,r.conv_3,[2,2]),l=oo(o,r.conv_4,[1,1]),c=oo(l,r.conv_5,[2,2]),u=oo(c,r.conv_6,[1,1]),d=oo(u,r.conv_7,[2,2]),h=wh(t,r.box_predictor_0),f=wh(e,r.box_predictor_1),p=wh(a,r.box_predictor_2),m=wh(o,r.box_predictor_3),v=wh(c,r.box_predictor_4),g=wh(d,r.box_predictor_5),x=Tn([h.boxPredictionEncoding,f.boxPredictionEncoding,p.boxPredictionEncoding,m.boxPredictionEncoding,v.boxPredictionEncoding,g.boxPredictionEncoding],1),y=Tn([h.classPrediction,f.classPrediction,p.classPrediction,m.classPrediction,v.classPrediction,g.classPrediction],1);return{boxPredictions:x,classPredictions:y}})}var Fx=function(){function e(t){var r=t===void 0?{}:t,n=r.minConfidence,a=r.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=a||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),SG=function(e){xt(t,e);function t(){return e.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(r){var n=this.params;if(!n)throw new Error("SsdMobilenetv1 - load model before inference");return Ve(function(){var a=r.toBatchTensor(512,!1).toFloat(),i=Dn(ja(a,Fe(.007843137718737125)),Fe(1)),o=Yxe(i,n.mobilenetv1),l=tye(o.out,o.conv11,n.prediction_layer),c=l.boxPredictions,u=l.classPredictions;return eye(c,u,n.output_layer)})},t.prototype.forward=function(r){return tt(this,void 0,void 0,function(){var n;return rt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,Xn(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.locateFaces=function(r,n){return n===void 0&&(n={}),tt(this,void 0,void 0,function(){var a,i,o,l,c,u,d,h,f,p,m,v,g,x,y,b,N,j,_,S,C;return rt(this,function(E){switch(E.label){case 0:return a=new Fx(n),i=a.maxResults,o=a.minConfidence,[4,Xn(r)];case 1:for(l=E.sent(),c=this.forwardInput(l),u=c.boxes,d=c.scores,h=u[0],f=d[0],p=1;p<u.length;p++)u[p].dispose(),d[p].dispose();return g=(v=Array).from,[4,f.data()];case 2:return m=g.apply(v,[E.sent()]),x=.5,y=Xxe(h,m,i,x,o),b=l.getReshapedInputDimensions(0),N=l.inputSize,j=N/b.width,_=N/b.height,S=h.arraySync(),C=y.map(function(k){var P=[Math.max(0,S[k][0]),Math.min(1,S[k][2])].map(function(B){return B*_}),A=P[0],O=P[1],I=[Math.max(0,S[k][1]),Math.min(1,S[k][3])].map(function(B){return B*j}),R=I[0],M=I[1];return new Wo(m[k],new xR(R,A,M-R,O-A),{height:l.getInputHeight(0),width:l.getInputWidth(0)})}),h.dispose(),f.dispose(),[2,C]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(r){return qxe(r)},t.prototype.extractParams=function(r){return zxe(r)},t}(Fl);(function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(SG);var rye=.4,nye=[new er(.738768,.874946),new er(2.42204,2.65704),new er(4.30971,7.04493),new er(10.246,4.59428),new er(12.6868,11.8741)],aye=[new er(1.603231,2.094468),new er(6.041143,7.080126),new er(2.882459,3.518061),new er(4.266906,5.178857),new er(9.041765,10.66308)],sye=[117.001,114.697,97.404],iye="tiny_yolov2_model",oye="tiny_yolov2_separable_conv_model",sb=function(e){return typeof e=="number"};function lye(e){if(!e)throw new Error("invalid config: "+e);if(typeof e.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!sb(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(t){return t||{}}).every(function(t){return sb(t.x)&&sb(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(sb)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}function AR(e){return Ve(function(){var t=ja(e,Fe(.10000000149011612));return Mt(Dr(Dn(e,t)),t)})}function Xl(e,t){return Ve(function(){var r=eh(e,[[0,0],[1,1],[1,1],[0,0]]);return r=di(r,t.conv.filters,[1,1],"valid"),r=Dn(r,t.bn.sub),r=ja(r,t.bn.truediv),r=Mt(r,t.conv.bias),AR(r)})}function Ql(e,t){return Ve(function(){var r=eh(e,[[0,0],[1,1],[1,1],[0,0]]);return r=sR(r,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),r=Mt(r,t.bias),AR(r)})}function cye(e,t){var r=Fj(e,t);function n(o,l){var c=dn(e(o)),u=dn(e(o));return t.push({paramPath:l+"/sub"},{paramPath:l+"/truediv"}),{sub:c,truediv:u}}function a(o,l,c){var u=r(o,l,3,c+"/conv"),d=n(l,c+"/bn");return{conv:u,bn:d}}var i=SR(e,t);return{extractConvParams:r,extractConvWithBatchNormParams:a,extractSeparableConvParams:i}}function uye(e,t,r,n){var a=Bl(e),i=a.extractWeights,o=a.getRemainingWeights,l=[],c=cye(i,l),u=c.extractConvParams,d=c.extractConvWithBatchNormParams,h=c.extractSeparableConvParams,f;if(t.withSeparableConvs){var p=n[0],m=n[1],v=n[2],g=n[3],x=n[4],y=n[5],b=n[6],N=n[7],j=n[8],_=t.isFirstLayerConv2d?u(p,m,3,"conv0"):h(p,m,"conv0"),S=h(m,v,"conv1"),C=h(v,g,"conv2"),E=h(g,x,"conv3"),k=h(x,y,"conv4"),P=h(y,b,"conv5"),A=N?h(b,N,"conv6"):void 0,O=j?h(N,j,"conv7"):void 0,I=u(j||N||b,5*r,1,"conv8");f={conv0:_,conv1:S,conv2:C,conv3:E,conv4:k,conv5:P,conv6:A,conv7:O,conv8:I}}else{var p=n[0],m=n[1],v=n[2],g=n[3],x=n[4],y=n[5],b=n[6],N=n[7],j=n[8],_=d(p,m,"conv0"),S=d(m,v,"conv1"),C=d(v,g,"conv2"),E=d(g,x,"conv3"),k=d(x,y,"conv4"),P=d(y,b,"conv5"),A=d(b,N,"conv6"),O=d(N,j,"conv7"),I=u(j,5*r,1,"conv8");f={conv0:_,conv1:S,conv2:C,conv3:E,conv4:k,conv5:P,conv6:A,conv7:O,conv8:I}}if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{params:f,paramMappings:l}}function dye(e,t){var r=fu(e,t);function n(l){var c=r(l+"/sub",1),u=r(l+"/truediv",1);return{sub:c,truediv:u}}function a(l){var c=r(l+"/filters",4),u=r(l+"/bias",1);return{filters:c,bias:u}}function i(l){var c=a(l+"/conv"),u=n(l+"/bn");return{conv:c,bn:u}}var o=CR(r);return{extractConvParams:a,extractConvWithBatchNormParams:i,extractSeparableConvParams:o}}function hye(e,t){var r=[],n=dye(e,r),a=n.extractConvParams,i=n.extractConvWithBatchNormParams,o=n.extractSeparableConvParams,l;if(t.withSeparableConvs){var c=t.filterSizes&&t.filterSizes.length||9;l={conv0:t.isFirstLayerConv2d?a("conv0"):o("conv0"),conv1:o("conv1"),conv2:o("conv2"),conv3:o("conv3"),conv4:o("conv4"),conv5:o("conv5"),conv6:c>7?o("conv6"):void 0,conv7:c>8?o("conv7"):void 0,conv8:a("conv8")}}else l={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:a("conv8")};return Ll(e,r),{params:l,paramMappings:r}}var L3;(function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"})(L3||(L3={}));var PR=function(){function e(t){var r=t===void 0?{}:t,n=r.inputSize,a=r.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=a||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),CG=function(e){xt(t,e);function t(r){var n=e.call(this,"TinyYolov2")||this;return lye(r),n._config=r,n}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(r,n){var a=Xl(r,n.conv0);return a=Un(a,[2,2],[2,2],"same"),a=Xl(a,n.conv1),a=Un(a,[2,2],[2,2],"same"),a=Xl(a,n.conv2),a=Un(a,[2,2],[2,2],"same"),a=Xl(a,n.conv3),a=Un(a,[2,2],[2,2],"same"),a=Xl(a,n.conv4),a=Un(a,[2,2],[2,2],"same"),a=Xl(a,n.conv5),a=Un(a,[2,2],[1,1],"same"),a=Xl(a,n.conv6),a=Xl(a,n.conv7),Ui(a,n.conv8,"valid",!1)},t.prototype.runMobilenet=function(r,n){var a=this.config.isFirstLayerConv2d?AR(Ui(r,n.conv0,"valid",!1)):Ql(r,n.conv0);return a=Un(a,[2,2],[2,2],"same"),a=Ql(a,n.conv1),a=Un(a,[2,2],[2,2],"same"),a=Ql(a,n.conv2),a=Un(a,[2,2],[2,2],"same"),a=Ql(a,n.conv3),a=Un(a,[2,2],[2,2],"same"),a=Ql(a,n.conv4),a=Un(a,[2,2],[2,2],"same"),a=Ql(a,n.conv5),a=Un(a,[2,2],[1,1],"same"),a=n.conv6?Ql(a,n.conv6):a,a=n.conv7?Ql(a,n.conv7):a,Ui(a,n.conv8,"valid",!1)},t.prototype.forwardInput=function(r,n){var a=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return Ve(function(){var o=r.toBatchTensor(n,!1).toFloat();return o=a.config.meanRgb?$x(o,a.config.meanRgb):o,o=o.div(Fe(256)),a.config.withSeparableConvs?a.runMobilenet(o,i):a.runTinyYolov2(o,i)})},t.prototype.forward=function(r,n){return tt(this,void 0,void 0,function(){var a;return rt(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,Xn(r)];case 1:return[4,a.apply(this,[i.sent(),n])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(r,n){return n===void 0&&(n={}),tt(this,void 0,void 0,function(){var a,i,o,l,c,u,d,h,f,p,m,v,g,x,y=this;return rt(this,function(b){switch(b.label){case 0:return a=new PR(n),i=a.inputSize,o=a.scoreThreshold,[4,Xn(r)];case 1:return l=b.sent(),[4,this.forwardInput(l,i)];case 2:return c=b.sent(),u=Ve(function(){return Rn(c)[0].expandDims()}),d={width:l.getInputWidth(0),height:l.getInputHeight(0)},[4,this.extractBoxes(u,l.getReshapedInputDimensions(0),o)];case 3:return h=b.sent(),c.dispose(),u.dispose(),f=h.map(function(N){return N.box}),p=h.map(function(N){return N.score}),m=h.map(function(N){return N.classScore}),v=h.map(function(N){return y.config.classes[N.label]}),g=_g(f.map(function(N){return N.rescale(i)}),p,this.config.iouThreshold,!0),x=g.map(function(N){return new Zq(p[N],m[N],v[N],f[N],d)}),[2,x]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(r){return hye(r,this.config)},t.prototype.extractParams=function(r){var n=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,a=n?n.length:void 0;if(a!==7&&a!==8&&a!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+a+" filterSizes in config");return uye(r,this.config,this.boxEncodingSize,n)},t.prototype.extractBoxes=function(r,n,a){return tt(this,void 0,void 0,function(){var i,o,l,c,u,d,h,f,p,m,v,g,x,y,b,N,j,_,S,C,E,k,P,A,O,I,R,M,B,$=this;return rt(this,function(D){switch(D.label){case 0:return i=n.width,o=n.height,l=Math.max(i,o),c=l/i,u=l/o,d=r.shape[1],h=this.config.anchors.length,f=Ve(function(){var W=r.reshape([d,d,h,$.boxEncodingSize]),Z=W.slice([0,0,0,0],[d,d,h,4]),U=W.slice([0,0,0,4],[d,d,h,1]),Y=$.withClassScores?Ml(W.slice([0,0,0,5],[d,d,h,$.config.classes.length]),3):Fe(0);return[Z,U,Y]}),p=f[0],m=f[1],v=f[2],g=[],[4,m.array()];case 1:return x=D.sent(),[4,p.array()];case 2:y=D.sent(),b=0,D.label=3;case 3:if(!(b<d))return[3,12];N=0,D.label=4;case 4:if(!(N<d))return[3,11];j=0,D.label=5;case 5:return j<h?(_=I2(x[b][N][j][0]),!a||_>a?(S=(N+I2(y[b][N][j][0]))/d*c,C=(b+I2(y[b][N][j][1]))/d*u,E=Math.exp(y[b][N][j][2])*this.config.anchors[j].x/d*c,k=Math.exp(y[b][N][j][3])*this.config.anchors[j].y/d*u,P=S-E/2,A=C-k/2,O={row:b,col:N,anchor:j},this.withClassScores?[4,this.extractPredictedClass(v,O)]:[3,7]):[3,9]):[3,10];case 6:return B=D.sent(),[3,8];case 7:B={classScore:1,label:0},D.label=8;case 8:I=B,R=I.classScore,M=I.label,g.push(ga({box:new Mj(P,A,P+E,A+k),score:_,classScore:_*R,label:M},O)),D.label=9;case 9:return j++,[3,5];case 10:return N++,[3,4];case 11:return b++,[3,3];case 12:return p.dispose(),m.dispose(),v.dispose(),[2,g]}})})},t.prototype.extractPredictedClass=function(r,n){return tt(this,void 0,void 0,function(){var a,i,o,l;return rt(this,function(c){switch(c.label){case 0:return a=n.row,i=n.col,o=n.anchor,[4,r.array()];case 1:return l=c.sent(),[2,Array(this.config.classes.length).fill(0).map(function(u,d){return l[a][i][o][d]}).map(function(u,d){return{classScore:u,label:d}}).reduce(function(u,d){return u.classScore>d.classScore?u:d})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(Fl),fye=function(e){xt(t,e);function t(r){r===void 0&&(r=!0);var n=this,a=Object.assign({},{withSeparableConvs:r,iouThreshold:rye,classes:["face"]},r?{anchors:aye,meanRgb:sye}:{anchors:nye,withClassScores:!0});return n=e.call(this,a)||this,n}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(r,n){return tt(this,void 0,void 0,function(){var a;return rt(this,function(i){switch(i.label){case 0:return[4,this.detect(r,n)];case 1:return a=i.sent(),[2,a.map(function(o){return new Wo(o.score,o.relativeBox,{width:o.imageWidth,height:o.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?oye:iye},t.prototype.extractParamsFromWeigthMap=function(r){return e.prototype.extractParamsFromWeigthMap.call(this,r)},t}(CG),Yb=function(e){xt(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r._name="TinyFaceDetectorOptions",r}return t}(PR),Lx=function(){function e(){}return e.prototype.then=function(t){return tt(this,void 0,void 0,function(){var r;return rt(this,function(n){switch(n.label){case 0:return r=t,[4,this.run()];case 1:return[2,r.apply(void 0,[n.sent()])]}})})},e.prototype.run=function(){return tt(this,void 0,void 0,function(){return rt(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},e}();function Lj(e,t,r,n,a){return a===void 0&&(a=function(i){var o=i.alignedRect;return o}),tt(this,void 0,void 0,function(){var i,o,l,c,u;return rt(this,function(d){switch(d.label){case 0:return i=e.map(function(h){return wxe(h)?a(h):h.detection}),l=n,l?[3,5]:t instanceof Ir?[4,NR(t,i)]:[3,2];case 1:return c=d.sent(),[3,4];case 2:return[4,jR(t,i)];case 3:c=d.sent(),d.label=4;case 4:l=c,d.label=5;case 5:return o=l,[4,r(o)];case 6:return u=d.sent(),o.forEach(function(h){return h instanceof Ir&&h.dispose()}),[2,u]}})})}function TR(e,t,r,n,a){return tt(this,void 0,void 0,function(){var i=this;return rt(this,function(o){return[2,Lj([e],t,function(l){return tt(i,void 0,void 0,function(){return rt(this,function(c){return[2,r(l[0])]})})},n,a)]})})}function pye(e){return Ve(function(){return Is(Rn(e,3).reverse(),3)})}var ib=2,hw=12;function mye(e,t){var r=Fj(e,t),n=_R(e,t);function a(u,d){var h=dn(e(u));return t.push({paramPath:d}),h}function i(u,d,h){h===void 0&&(h=!1);var f=r(u[0],u[1],3,d+"/conv1"),p=a(u[1],d+"/prelu1_alpha"),m=r(u[1],u[2],3,d+"/conv2"),v=a(u[2],d+"/prelu2_alpha"),g=r(u[2],u[3],h?2:3,d+"/conv3"),x=a(u[3],d+"/prelu3_alpha");return{conv1:f,prelu1_alpha:p,conv2:m,prelu2_alpha:v,conv3:g,prelu3_alpha:x}}function o(){var u=i([3,10,16,32],"pnet"),d=r(32,2,1,"pnet/conv4_1"),h=r(32,4,1,"pnet/conv4_2");return ga(ga({},u),{conv4_1:d,conv4_2:h})}function l(){var u=i([3,28,48,64],"rnet",!0),d=n(576,128,"rnet/fc1"),h=a(128,"rnet/prelu4_alpha"),f=n(128,2,"rnet/fc2_1"),p=n(128,4,"rnet/fc2_2");return ga(ga({},u),{fc1:d,prelu4_alpha:h,fc2_1:f,fc2_2:p})}function c(){var u=i([3,32,64,64],"onet"),d=r(64,128,2,"onet/conv4"),h=a(128,"onet/prelu4_alpha"),f=n(1152,256,"onet/fc1"),p=a(256,"onet/prelu5_alpha"),m=n(256,2,"onet/fc2_1"),v=n(256,4,"onet/fc2_2"),g=n(256,10,"onet/fc2_3");return ga(ga({},u),{conv4:d,prelu4_alpha:h,fc1:f,prelu5_alpha:p,fc2_1:m,fc2_2:v,fc2_3:g})}return{extractPNetParams:o,extractRNetParams:l,extractONetParams:c}}function vye(e){var t=Bl(e),r=t.extractWeights,n=t.getRemainingWeights,a=[],i=mye(r,a),o=i.extractPNetParams,l=i.extractRNetParams,c=i.extractONetParams,u=o(),d=l(),h=c();if(n().length!==0)throw new Error("weights remaing after extract: "+n().length);return{params:{pnet:u,rnet:d,onet:h},paramMappings:a}}function gye(e,t){var r=fu(e,t);function n(d){var h=r(d+"/weights",4,d+"/filters"),f=r(d+"/bias",1);return{filters:h,bias:f}}function a(d){var h=r(d+"/weights",2),f=r(d+"/bias",1);return{weights:h,bias:f}}function i(d){return r(d,1)}function o(d){var h=n(d+"/conv1"),f=i(d+"/prelu1_alpha"),p=n(d+"/conv2"),m=i(d+"/prelu2_alpha"),v=n(d+"/conv3"),g=i(d+"/prelu3_alpha");return{conv1:h,prelu1_alpha:f,conv2:p,prelu2_alpha:m,conv3:v,prelu3_alpha:g}}function l(){var d=o("pnet"),h=n("pnet/conv4_1"),f=n("pnet/conv4_2");return ga(ga({},d),{conv4_1:h,conv4_2:f})}function c(){var d=o("rnet"),h=a("rnet/fc1"),f=i("rnet/prelu4_alpha"),p=a("rnet/fc2_1"),m=a("rnet/fc2_2");return ga(ga({},d),{fc1:h,prelu4_alpha:f,fc2_1:p,fc2_2:m})}function u(){var d=o("onet"),h=n("onet/conv4"),f=i("onet/prelu4_alpha"),p=a("onet/fc1"),m=i("onet/prelu5_alpha"),v=a("onet/fc2_1"),g=a("onet/fc2_2"),x=a("onet/fc2_3");return ga(ga({},d),{conv4:h,prelu4_alpha:f,fc1:p,prelu5_alpha:m,fc2_1:v,fc2_2:g,fc2_3:x})}return{extractPNetParams:l,extractRNetParams:c,extractONetParams:u}}function xye(e){var t=[],r=gye(e,t),n=r.extractPNetParams,a=r.extractRNetParams,i=r.extractONetParams,o=n(),l=a(),c=i();return Ll(e,t),{params:{pnet:o,rnet:l,onet:c},paramMappings:t}}function LE(e,t){var r=t[0],n=t[1];return{height:Math.floor(r*e),width:Math.floor(n*e)}}function yye(e,t,r){for(var n=r[0],a=r[1],i=hw/e,o=[],l=Math.min(n,a)*i,c=0;l>=12;)o.push(i*Math.pow(t,c)),l=l*t,c+=1;return o}var RR=function(e){xt(t,e);function t(r,n,a,i){return e.call(this,{left:r,top:n,right:a,bottom:i},!0)||this}return t}(tu);function EG(e){return Ve(function(){return ja(Dn(e,Fe(127.5)),Fe(.0078125))})}function jf(e,t){return Ve(function(){return Mt(Dr(e),ja(t,sw(Dr(sw(e)))))})}function OR(e,t,r){return r===void 0&&(r=!1),Ve(function(){var n=Ui(e,t.conv1,"valid");return n=jf(n,t.prelu1_alpha),n=Un(n,r?[2,2]:[3,3],[2,2],"same"),n=Ui(n,t.conv2,"valid"),n=jf(n,t.prelu2_alpha),n=r?n:Un(n,[3,3],[2,2],"valid"),n=Ui(n,t.conv3,"valid"),n=jf(n,t.prelu3_alpha),n})}function bye(e,t){return Ve(function(){var r=OR(e,t,!0),n=Ui(r,t.conv4_1,"valid"),a=Qs(Rj(n,3),3),i=Ml(Dn(n,a),3),o=Ui(r,t.conv4_2,"valid");return{prob:i,regions:o}})}function wye(e,t){return Ve(function(){var r=LE(t,e.shape.slice(1)),n=r.height,a=r.width,i=uR.resizeBilinear(e,[n,a]),o=EG(i);return eu(o,[0,2,1,3])})}function jye(e,t,r,n){for(var a=[],i=e.arraySync(),o=0;o<e.shape[0];o++)for(var l=0;l<e.shape[1];l++)i[o][l]>=n&&a.push(new er(l,o));var c=a.map(function(u){var d=new Mj(Math.round((u.y*ib+1)/r),Math.round((u.x*ib+1)/r),Math.round((u.y*ib+hw)/r),Math.round((u.x*ib+hw)/r)),h=i[u.y][u.x],f=t.arraySync(),p=new RR(f[u.y][u.x][0],f[u.y][u.x][1],f[u.y][u.x][2],f[u.y][u.x][3]);return{cell:d,score:h,region:p}});return c}function Nye(e,t,r,n,a){a.stage1=[];var i=t.map(function(f){return Ve(function(){var p={scale:f},m=wye(e,f),v=Date.now(),g=bye(m,n),x=g.prob,y=g.regions;p.pnet=Date.now()-v;var b=Rn(Rn(x,3)[1])[0],N=Rn(y)[0];return{scoresTensor:b,regionsTensor:N,scale:f,statsForScale:p}})}),o=i.map(function(f){var p=f.scoresTensor,m=f.regionsTensor,v=f.scale,g=f.statsForScale,x=jye(p,m,v,r);if(p.dispose(),m.dispose(),!x.length)return a.stage1.push(g),[];var y=Date.now(),b=_g(x.map(function(N){return N.cell}),x.map(function(N){return N.score}),.5);return g.nms=Date.now()-y,g.numBoxes=b.length,a.stage1.push(g),b.map(function(N){return x[N]})}),l=o.reduce(function(f,p){return f.concat(p)},[]),c=[],u=[];if(l.length>0){var d=Date.now(),h=_g(l.map(function(f){return f.cell}),l.map(function(f){return f.score}),.7);a.stage1_nms=Date.now()-d,u=h.map(function(f){return l[f].score}),c=h.map(function(f){return l[f]}).map(function(f){var p=f.cell,m=f.region;return new Mj(p.left+m.left*p.width,p.top+m.top*p.height,p.right+m.right*p.width,p.bottom+m.bottom*p.height).toSquare().round()})}return{boxes:c,scores:u}}function kG(e,t,r){var n=r.width,a=r.height;return tt(this,void 0,void 0,function(){var i,o,l,c=this;return rt(this,function(u){switch(u.label){case 0:return i=Id(e),[4,Promise.all(t.map(function(d){return tt(c,void 0,void 0,function(){var h,f,p,m,v,g,x,y;return rt(this,function(b){return h=d.padAtBorders(e.height,e.width),f=h.y,p=h.ey,m=h.x,v=h.ex,g=m-1,x=f-1,y=i.getImageData(g,x,v-g,p-x),[2,Sa.isNodejs()?wR(y):createImageBitmap(y)]})})}))];case 1:return o=u.sent(),l=[],o.forEach(function(d){var h=$j({width:n,height:a}),f=Id(h);f.drawImage(d,0,0,n,a);for(var p=f.getImageData(0,0,n,a).data,m=[],v=0;v<p.length;v+=4)m.push(p[v+2]),m.push(p[v+1]),m.push(p[v]);l.push(m)}),[2,l.map(function(d){var h=Ve(function(){var f=eu(es(d,[1,n,a,3]),[0,2,1,3]).toFloat();return EG(f)});return h})]}})})}function _ye(e,t){return Ve(function(){var r=OR(e,t),n=Mi(r,[r.shape[0],t.fc1.weights.shape[0]]),a=xo(n,t.fc1),i=jf(a,t.prelu4_alpha),o=xo(i,t.fc2_1),l=Qs(Rj(o,1),1),c=Ml(Dn(o,l),1),u=xo(i,t.fc2_2),d=Rn(c,1)[1];return{scores:d,regions:u}})}function Sye(e,t,r,n,a){return tt(this,void 0,void 0,function(){var i,o,l,c,u,d,h,f,p,m,v,g,x,y;return rt(this,function(b){switch(b.label){case 0:return i=Date.now(),[4,kG(e,t,{width:24,height:24})];case 1:return o=b.sent(),a.stage2_extractImagePatches=Date.now()-i,i=Date.now(),l=o.map(function(N){var j=_ye(N,n);return N.dispose(),j}),a.stage2_rnet=Date.now()-i,c=l.length>1?Tn(l.map(function(N){return N.scores})):l[0].scores,h=(d=Array).from,[4,c.data()];case 2:return u=h.apply(d,[b.sent()]),c.dispose(),f=u.map(function(N,j){return{score:N,idx:j}}).filter(function(N){return N.score>r}).map(function(N){var j=N.idx;return j}),p=f.map(function(N){return t[N]}),m=f.map(function(N){return u[N]}),v=[],g=[],p.length>0&&(i=Date.now(),x=_g(p,m,.7),a.stage2_nms=Date.now()-i,y=x.map(function(N){var j=l[f[N]].regions.arraySync();return new RR(j[0][0],j[0][1],j[0][2],j[0][3])}),g=x.map(function(N){return m[N]}),v=x.map(function(N,j){return p[N].calibrate(y[j])})),l.forEach(function(N){N.regions.dispose(),N.scores.dispose()}),[2,{boxes:v,scores:g}]}})})}function Cye(e,t){return Ve(function(){var r=OR(e,t);r=Un(r,[2,2],[2,2],"same"),r=Ui(r,t.conv4,"valid"),r=jf(r,t.prelu4_alpha);var n=Mi(r,[r.shape[0],t.fc1.weights.shape[0]]),a=xo(n,t.fc1),i=jf(a,t.prelu5_alpha),o=xo(i,t.fc2_1),l=Qs(Rj(o,1),1),c=Ml(Dn(o,l),1),u=xo(i,t.fc2_2),d=xo(i,t.fc2_3),h=Rn(c,1)[1];return{scores:h,regions:u,points:d}})}function Eye(e,t,r,n,a){return tt(this,void 0,void 0,function(){var i,o,l,c,u,d,h,f,p,m,v,g,x,y,b;return rt(this,function(N){switch(N.label){case 0:return i=Date.now(),[4,kG(e,t,{width:48,height:48})];case 1:return o=N.sent(),a.stage3_extractImagePatches=Date.now()-i,i=Date.now(),l=o.map(function(j){var _=Cye(j,n);return j.dispose(),_}),a.stage3_onet=Date.now()-i,c=l.length>1?Tn(l.map(function(j){return j.scores})):l[0].scores,h=(d=Array).from,[4,c.data()];case 2:return u=h.apply(d,[N.sent()]),c.dispose(),f=u.map(function(j,_){return{score:j,idx:_}}).filter(function(j){return j.score>r}).map(function(j){var _=j.idx;return _}),p=f.map(function(j){var _=l[j].regions.arraySync();return new RR(_[0][0],_[0][1],_[0][2],_[0][3])}),m=f.map(function(j,_){return t[j].calibrate(p[_])}),v=f.map(function(j){return u[j]}),g=[],x=[],y=[],m.length>0&&(i=Date.now(),b=_g(m,v,.7,!1),a.stage3_nms=Date.now()-i,g=b.map(function(j){return m[j]}),x=b.map(function(j){return v[j]}),y=b.map(function(j,_){return Array(5).fill(0).map(function(S,C){var E=l[j].points.arraySync();return new er(E[0][C]*(g[_].width+1)+g[_].left,E[0][C+5]*(g[_].height+1)+g[_].top)})})),l.forEach(function(j){j.regions.dispose(),j.scores.dispose(),j.points.dispose()}),[2,{boxes:g,scores:x,points:y}]}})})}var kye=function(e){xt(t,e);function t(){return e.call(this,"Mtcnn")||this}return t.prototype.load=function(r){return tt(this,void 0,void 0,function(){return rt(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,r)]})})},t.prototype.loadFromDisk=function(r){return tt(this,void 0,void 0,function(){return rt(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,r)]})})},t.prototype.forwardInput=function(r,n){return n===void 0&&(n={}),tt(this,void 0,void 0,function(){var a,i,o,l,c,u,d,h,f,p,m,v,g,x,y,b,N,j,_,S,C;return rt(this,function(E){switch(E.label){case 0:if(a=this.params,!a)throw new Error("Mtcnn - load model before inference");if(i=r.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return o={},l=Date.now(),c=Ve(function(){return pye(Qs(vR.fromPixels(i)).toFloat())}),u=function(k){return c.dispose(),o.total=Date.now()-l,k},d=c.shape.slice(1),h=d[0],f=d[1],p=new _G(n),m=p.minFaceSize,v=p.scaleFactor,g=p.maxNumScales,x=p.scoreThresholds,y=p.scaleSteps,b=(y||yye(m,v,[h,f])).filter(function(k){var P=LE(k,[h,f]);return Math.min(P.width,P.height)>hw}).slice(0,g),o.scales=b,o.pyramid=b.map(function(k){return LE(k,[h,f])}),N=Date.now(),[4,Nye(c,b,x[0],a.pnet,o)];case 1:return j=E.sent(),o.total_stage1=Date.now()-N,j.boxes.length?(o.stage2_numInputBoxes=j.boxes.length,N=Date.now(),[4,Sye(i,j.boxes,x[1],a.rnet,o)]):[2,u({results:[],stats:o})];case 2:return _=E.sent(),o.total_stage2=Date.now()-N,_.boxes.length?(o.stage3_numInputBoxes=_.boxes.length,N=Date.now(),[4,Eye(i,_.boxes,x[2],a.onet,o)]):[2,u({results:[],stats:o})];case 3:return S=E.sent(),o.total_stage3=Date.now()-N,C=S.boxes.map(function(k,P){return ER(yR({},new Wo(S.scores[P],new xR(k.left/f,k.top/h,k.width/f,k.height/h),{height:h,width:f})),new axe(S.points[P].map(function(A){return A.sub(new er(k.left,k.top)).div(new er(k.width,k.height))}),{width:k.width,height:k.height}))}),[2,u({results:C,stats:o})]}})})},t.prototype.forward=function(r,n){return n===void 0&&(n={}),tt(this,void 0,void 0,function(){var a;return rt(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,Xn(r)];case 1:return[4,a.apply(this,[i.sent(),n])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(r,n){return n===void 0&&(n={}),tt(this,void 0,void 0,function(){var a;return rt(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,Xn(r)];case 1:return[2,a.apply(this,[i.sent(),n])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(r){return xye(r)},t.prototype.extractParams=function(r){return vye(r)},t}(Fl),Aye=.4,Pye=[new er(1.603231,2.094468),new er(6.041143,7.080126),new er(2.882459,3.518061),new er(4.266906,5.178857),new er(9.041765,10.66308)],Tye=[117.001,114.697,97.404],Rye=function(e){xt(t,e);function t(){var r=this,n={withSeparableConvs:!0,iouThreshold:Aye,classes:["face"],anchors:Pye,meanRgb:Tye,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return r=e.call(this,n)||this,r}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(r,n){return tt(this,void 0,void 0,function(){var a;return rt(this,function(i){switch(i.label){case 0:return[4,this.detect(r,n)];case 1:return a=i.sent(),[2,a.map(function(o){return new Wo(o.score,o.relativeBox,{width:o.imageWidth,height:o.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(r){return e.prototype.extractParamsFromWeigthMap.call(this,r)},t}(CG),$a={ssdMobilenetv1:new SG,tinyFaceDetector:new Rye,tinyYolov2:new fye,mtcnn:new kye,faceLandmark68Net:new xG,faceLandmark68TinyNet:new Ixe,faceRecognitionNet:new Uxe,faceExpressionNet:new bxe,ageGenderNet:new Pxe},AG=function(e){xt(t,e);function t(r,n,a){var i=e.call(this)||this;return i.parentTask=r,i.input=n,i.extractedFaces=a,i}return t}(Lx),IR=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return tt(this,void 0,void 0,function(){var r,n,a=this;return rt(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return r=i.sent(),[4,Lj(r,this.input,function(o){return tt(a,void 0,void 0,function(){return rt(this,function(l){switch(l.label){case 0:return[4,Promise.all(o.map(function(c){return $a.faceExpressionNet.predictExpressions(c)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return n=i.sent(),[2,r.map(function(o,l){return mG(o,n[l])})]}})})},t.prototype.withAgeAndGender=function(){return new FR(this,this.input)},t}(AG),DR=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return tt(this,void 0,void 0,function(){var r,n;return rt(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return r=a.sent(),r?[4,TR(r,this.input,function(i){return $a.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return n=a.sent(),[2,mG(r,n)]}})})},t.prototype.withAgeAndGender=function(){return new LR(this,this.input)},t}(AG),MR=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new BR(this,this.input)},t.prototype.withFaceDescriptors=function(){return new VR(this,this.input)},t}(IR),$R=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new UR(this,this.input)},t.prototype.withFaceDescriptor=function(){return new zR(this,this.input)},t}(DR),PG=function(e){xt(t,e);function t(r,n,a){var i=e.call(this)||this;return i.parentTask=r,i.input=n,i.extractedFaces=a,i}return t}(Lx),FR=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return tt(this,void 0,void 0,function(){var r,n,a=this;return rt(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return r=i.sent(),[4,Lj(r,this.input,function(o){return tt(a,void 0,void 0,function(){return rt(this,function(l){switch(l.label){case 0:return[4,Promise.all(o.map(function(c){return $a.ageGenderNet.predictAgeAndGender(c)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return n=i.sent(),[2,r.map(function(o,l){var c=n[l],u=c.age,d=c.gender,h=c.genderProbability;return jG(NG(o,d,h),u)})]}})})},t.prototype.withFaceExpressions=function(){return new IR(this,this.input)},t}(PG),LR=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return tt(this,void 0,void 0,function(){var r,n,a,i,o;return rt(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return r=l.sent(),r?[4,TR(r,this.input,function(c){return $a.ageGenderNet.predictAgeAndGender(c)},this.extractedFaces)]:[2];case 2:return n=l.sent(),a=n.age,i=n.gender,o=n.genderProbability,[2,jG(NG(r,i,o),a)]}})})},t.prototype.withFaceExpressions=function(){return new DR(this,this.input)},t}(PG),BR=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new MR(this,this.input)},t.prototype.withFaceDescriptors=function(){return new VR(this,this.input)},t}(FR),UR=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new $R(this,this.input)},t.prototype.withFaceDescriptor=function(){return new zR(this,this.input)},t}(LR),TG=function(e){xt(t,e);function t(r,n){var a=e.call(this)||this;return a.parentTask=r,a.input=n,a}return t}(Lx),VR=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return tt(this,void 0,void 0,function(){var r,n;return rt(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return r=a.sent(),[4,Lj(r,this.input,function(i){return Promise.all(i.map(function(o){return $a.faceRecognitionNet.computeFaceDescriptor(o)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return n=a.sent(),[2,n.map(function(i,o){return wG(r[o],i)})]}})})},t.prototype.withFaceExpressions=function(){return new MR(this,this.input)},t.prototype.withAgeAndGender=function(){return new BR(this,this.input)},t}(TG),zR=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return tt(this,void 0,void 0,function(){var r,n;return rt(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return r=a.sent(),r?[4,TR(r,this.input,function(i){return $a.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return n=a.sent(),[2,wG(r,n)]}})})},t.prototype.withFaceExpressions=function(){return new $R(this,this.input)},t.prototype.withAgeAndGender=function(){return new UR(this,this.input)},t}(TG),RG=function(e){xt(t,e);function t(r,n,a){var i=e.call(this)||this;return i.parentTask=r,i.input=n,i.useTinyLandmarkNet=a,i}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?$a.faceLandmark68TinyNet:$a.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(Lx),Oye=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return tt(this,void 0,void 0,function(){var r,n,a,i,o,l=this;return rt(this,function(c){switch(c.label){case 0:return[4,this.parentTask];case 1:return r=c.sent(),n=r.map(function(u){return u.detection}),this.input instanceof Ir?[4,NR(this.input,n)]:[3,3];case 2:return i=c.sent(),[3,5];case 3:return[4,jR(this.input,n)];case 4:i=c.sent(),c.label=5;case 5:return a=i,[4,Promise.all(a.map(function(u){return l.landmarkNet.detectLandmarks(u)}))];case 6:return o=c.sent(),a.forEach(function(u){return u instanceof Ir&&u.dispose()}),[2,r.map(function(u,d){return ER(u,o[d])})]}})})},t.prototype.withFaceExpressions=function(){return new MR(this,this.input)},t.prototype.withAgeAndGender=function(){return new BR(this,this.input)},t.prototype.withFaceDescriptors=function(){return new VR(this,this.input)},t}(RG),Iye=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return tt(this,void 0,void 0,function(){var r,n,a,i,o;return rt(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return r=l.sent(),r?(n=r.detection,this.input instanceof Ir?[4,NR(this.input,[n])]:[3,3]):[2];case 2:return i=l.sent(),[3,5];case 3:return[4,jR(this.input,[n])];case 4:i=l.sent(),l.label=5;case 5:return a=i,[4,this.landmarkNet.detectLandmarks(a[0])];case 6:return o=l.sent(),a.forEach(function(c){return c instanceof Ir&&c.dispose()}),[2,ER(r,o)]}})})},t.prototype.withFaceExpressions=function(){return new $R(this,this.input)},t.prototype.withAgeAndGender=function(){return new UR(this,this.input)},t.prototype.withFaceDescriptor=function(){return new zR(this,this.input)},t}(RG),OG=function(e){xt(t,e);function t(r,n){n===void 0&&(n=new Fx);var a=e.call(this)||this;return a.input=r,a.options=n,a}return t}(Lx),IG=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return tt(this,void 0,void 0,function(){var r,n,a,i;return rt(this,function(o){switch(o.label){case 0:return r=this,n=r.input,a=r.options,a instanceof _G?[4,$a.mtcnn.forward(n,a)]:[3,2];case 1:return[2,o.sent().map(function(l){return l.detection})];case 2:if(i=a instanceof Yb?function(l){return $a.tinyFaceDetector.locateFaces(l,a)}:a instanceof Fx?function(l){return $a.ssdMobilenetv1.locateFaces(l,a)}:a instanceof PR?function(l){return $a.tinyYolov2.locateFaces(l,a)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(n)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var r=this;return new Promise(function(n){return tt(r,void 0,void 0,function(){var a;return rt(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return a=i.sent(),[2,n(a.map(function(o){return yR({},o)}))]}})})})},t.prototype.withFaceLandmarks=function(r){return r===void 0&&(r=!1),new Oye(this.runAndExtendWithFaceDetections(),this.input,r)},t.prototype.withFaceExpressions=function(){return new IR(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new FR(this.runAndExtendWithFaceDetections(),this.input)},t}(OG),Dye=function(e){xt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return tt(this,void 0,void 0,function(){var r,n;return rt(this,function(a){switch(a.label){case 0:return[4,new IG(this.input,this.options)];case 1:return r=a.sent(),n=r[0],r.forEach(function(i){i.score>n.score&&(n=i)}),[2,n]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var r=this;return new Promise(function(n){return tt(r,void 0,void 0,function(){var a;return rt(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return a=i.sent(),[2,n(a?yR({},a):void 0)]}})})})},t.prototype.withFaceLandmarks=function(r){return r===void 0&&(r=!1),new Iye(this.runAndExtendWithFaceDetection(),this.input,r)},t.prototype.withFaceExpressions=function(){return new DR(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new LR(this.runAndExtendWithFaceDetection(),this.input)},t}(OG);function B3(e,t){return t===void 0&&(t=new Fx),new Dye(e,t)}function Mye(e,t){return t===void 0&&(t=new Fx),new IG(e,t)}function DG(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var r=Array.from(e),n=Array.from(t);return Math.sqrt(r.map(function(a,i){return a-n[i]}).reduce(function(a,i){return a+Math.pow(i,2)},0))}(function(){function e(t,r){r===void 0&&(r=.6),this._distanceThreshold=r;var n=Array.isArray(t)?t:[t];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var a=1,i=function(){return"person "+a++};this._labeledDescriptors=n.map(function(o){if(o instanceof rb)return o;if(o instanceof Float32Array)return new rb(i(),[o]);if(o.descriptor&&o.descriptor instanceof Float32Array)return new rb(i(),[o.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(t,r){return r.map(function(n){return DG(n,t)}).reduce(function(n,a){return n+a},0)/(r.length||1)},e.prototype.matchDescriptor=function(t){var r=this;return this.labeledDescriptors.map(function(n){var a=n.descriptors,i=n.label;return new I3(i,r.computeMeanDistance(t,a))}).reduce(function(n,a){return n.distance<a.distance?n:a})},e.prototype.findBestMatch=function(t){var r=this.matchDescriptor(t);return r.distance<this.distanceThreshold?r:new I3("unknown",r.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},e.fromJSON=function(t){var r=t.labeledDescriptors.map(function(n){return rb.fromJSON(n)});return new e(r,t.distanceThreshold)},e})();function $ye({vaiNumber:e,storedPhotoUrl:t,onSuccess:r,onFailure:n,onFallback:a}){const{toast:i}=Et(),o=w.useRef(null),l=w.useRef(null),[c,u]=w.useState(!0),[d,h]=w.useState(!1),[f,p]=w.useState(!1),[m,v]=w.useState(!1),[g,x]=w.useState(null),y=w.useRef(null);w.useEffect(()=>{(async()=>{try{const j="/models";await Promise.all([$a.tinyFaceDetector.loadFromUri(j),$a.faceLandmark68Net.loadFromUri(j),$a.faceRecognitionNet.loadFromUri(j)]),h(!0),u(!1)}catch(j){console.error("Failed to load face-api.js models:",j),i({title:"Model Loading Failed",description:"Facial recognition models could not be loaded. Please use email/password login.",variant:"destructive"}),u(!1),a()}})()},[i,a]),w.useEffect(()=>!d||!o.current?void 0:((async()=>{try{const j=await navigator.mediaDevices.getUserMedia({video:{width:640,height:480,facingMode:"user"}});y.current=j,o.current&&(o.current.srcObject=j)}catch(j){console.error("Camera access error:",j),i({title:"Camera Access Denied",description:"Please allow camera access or use email/password login.",variant:"destructive"}),a()}})(),()=>{y.current&&y.current.getTracks().forEach(j=>j.stop())}),[d,i,a]),w.useEffect(()=>{if(!d||!o.current||!l.current)return;(async()=>{if(!o.current||!l.current)return;const j=o.current,_=l.current,S=_.getContext("2d");if(!S)return;_.width=j.videoWidth,_.height=j.videoHeight;const C=async()=>{if(!j||j.readyState!==j.HAVE_ENOUGH_DATA){requestAnimationFrame(C);return}const E=await Mye(j,new Yb).withFaceLandmarks().withFaceDescriptors();S.clearRect(0,0,_.width,_.height),S.drawImage(j,0,0,_.width,_.height),E.forEach(k=>{const P=k.detection.box;S.strokeStyle=E.length===1?"#10b981":"#ef4444",S.lineWidth=2,S.strokeRect(P.x,P.y,P.width,P.height),k.landmarks&&(S.fillStyle="#10b981",k.landmarks.positions.forEach(A=>{S.beginPath(),S.arc(A.x,A.y,2,0,2*Math.PI),S.fill()}))}),!f&&!m&&requestAnimationFrame(C)};C()})()},[d,f,m]);const b=async()=>{if(!(!o.current||!l.current||!d)){p(!0),v(!0);try{const N=o.current,j=document.createElement("canvas");j.width=N.videoWidth,j.height=N.videoHeight;const _=j.getContext("2d");if(!_)throw new Error("Could not get canvas context");_.drawImage(N,0,0);const C=j.toDataURL("image/jpeg",.9).split(",")[1],E=await new Promise((M,B)=>{const $=new Image;$.crossOrigin="anonymous",$.onload=()=>M($),$.onerror=B,$.src=t}),k=document.createElement("canvas");k.width=E.width,k.height=E.height;const P=k.getContext("2d");if(!P)throw new Error("Could not get stored canvas context");P.drawImage(E,0,0);const[A,O]=await Promise.all([B3(j,new Yb).withFaceLandmarks().withFaceDescriptor(),B3(k,new Yb).withFaceLandmarks().withFaceDescriptor()]);if(!A||!O)throw new Error("Could not detect face in one or both images");const I=DG(A.descriptor,O.descriptor),R=Math.max(0,Math.min(100,(1-I)*100));if(x(R),console.log("Face comparison - Distance:",I,"Confidence:",R),R>=85)i({title:"Verification Successful",description:`Identity confirmed (${R.toFixed(1)}% match)`}),r();else throw new Error(`Verification failed. Confidence: ${R.toFixed(1)}% (required: 85%)`)}catch(N){console.error("Face verification error:",N),x(null),i({title:"Verification Failed",description:N.message||"Face verification failed. Please try again.",variant:"destructive"}),v(!1),p(!1),n()}}};return c?s.jsxs("div",{className:"flex flex-col items-center justify-center p-8 space-y-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"}),s.jsx("p",{className:"text-muted-foreground text-sm",children:"Loading facial recognition models..."})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"Facial Recognition Login"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Position your face in the frame. Make sure you have good lighting."})]}),s.jsxs("div",{className:"relative aspect-[3/4] bg-black rounded-xl overflow-hidden border-2 border-border",children:[s.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),s.jsx("canvas",{ref:l,className:"absolute inset-0 pointer-events-none"}),m&&s.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"text-white font-medium",children:"Verifying..."}),g!==null&&s.jsxs("p",{className:"text-white/80 text-sm",children:["Confidence: ",g.toFixed(1),"%"]})]})})]}),s.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2 text-sm",children:[s.jsxs("p",{className:"font-medium flex items-center gap-2",children:[s.jsx(ut,{className:"w-4 h-4 text-green-500"}),"Face centered in frame"]}),s.jsxs("p",{className:"font-medium flex items-center gap-2",children:[s.jsx(ut,{className:"w-4 h-4 text-green-500"}),"Good lighting (face well-lit)"]}),s.jsxs("p",{className:"font-medium flex items-center gap-2",children:[s.jsx(ut,{className:"w-4 h-4 text-green-500"}),"Remove glasses if possible"]}),s.jsxs("p",{className:"font-medium flex items-center gap-2",children:[s.jsx(ut,{className:"w-4 h-4 text-green-500"}),"Look directly at camera"]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs(L,{onClick:b,disabled:m||!d,className:"w-full h-14 bg-gradient-primary hover:brightness-110 text-primary-foreground font-semibold text-base",children:[s.jsx(Na,{className:"w-5 h-5 mr-2"}),m?"Verifying...":"Capture & Verify"]}),s.jsx(L,{onClick:a,variant:"outline",className:"w-full",disabled:m,children:"Use Email/Password Instead"})]}),g!==null&&g<85&&s.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4",children:s.jsxs("p",{className:"text-sm text-destructive flex items-center gap-2",children:[s.jsx(Xs,{className:"w-4 h-4"}),"Verification failed (",g.toFixed(1),"% confidence). Please try again or use email/password."]})})]})}const Fye=()=>{const e=Oe(),[t]=Ex(),{toast:r}=Et(),[n,a]=w.useState("identity"),[i,o]=w.useState("email"),[l,c]=w.useState("password"),[u,d]=w.useState(!1),[h,f]=w.useState(!1),[p,m]=w.useState(""),[v,g]=w.useState(""),[x,y]=w.useState(""),[b,N]=w.useState(""),[j,_]=w.useState(""),[S,C]=w.useState(!1),[E,k]=w.useState(""),[P,A]=w.useState(!1),[O,I]=w.useState("");w.useEffect(()=>{T.auth.signOut()},[]),w.useEffect(()=>{const K=t.get("vai");K&&(o("vai"),m(K),a("vai-auth"),c("face"))},[t]),w.useEffect(()=>{(async()=>{const{data:{session:ke}}=await T.auth.getSession();if(ke){const{data:Ce}=await T.from("provider_profiles").select("username").eq("user_id",ke.user.id).single();Ce!=null&&Ce.username?e("/feed"):e("/pricing")}})()},[e]);const R=K=>{o(K),K==="vai"?a("vai-auth"):K==="email"?a("email-auth"):K==="phone"&&a("phone-otp")},M=()=>{a("identity"),m(""),g(""),y(""),N(""),_(""),k(""),c("face")},B=()=>{a("forgot-password")},$=()=>{a("trouble-signin")},D=()=>{console.log("Sending password reset to:",E),alert("Password reset link sent! Check your email."),M()},W=()=>{console.log("Sending OTP to:",b),alert("OTP code sent to your phone!")},Z=()=>{console.log("Verifying OTP:",j),e("/feed")},[U,Y]=w.useState(!1),[ae,ie]=w.useState(null),he=async()=>{if(!p||p.length!==7){r({title:"Invalid V.A.I. Number",description:"Please enter your 7-character V.A.I. number first",variant:"destructive"});return}f(!0);try{const{data:K,error:ke}=await T.from("vai_verifications").select("biometric_photo_url").eq("vai_number",p.toUpperCase()).single();if(ke||!(K!=null&&K.biometric_photo_url)){r({title:"V.A.I. Not Found",description:"Could not find your V.A.I. number. Please check and try again.",variant:"destructive"}),f(!1);return}ie(K.biometric_photo_url),Y(!0)}catch(K){console.error("Error fetching VAI verification:",K),r({title:"Error",description:"Failed to load verification data. Please try again.",variant:"destructive"})}finally{f(!1)}},se=async()=>{f(!0);try{const{data:K,error:ke}=await T.functions.invoke("verify-vai-login",{body:{vaiNumber:p.toUpperCase(),facialAuth:!0}});if(ke||!(K!=null&&K.success))throw new Error((K==null?void 0:K.error)||"Authentication failed");const{data:{user:Ce}}=await T.auth.getUser();if(Ce&&(K!=null&&K.sessionUrl))await T.from("profiles").update({login_preference:"facial"}).eq("id",Ce.id),window.location.href=K.sessionUrl;else if(K!=null&&K.sessionUrl)window.location.href=K.sessionUrl;else throw new Error("No session URL received")}catch(K){console.error("Facial recognition auth error:",K),r({title:"Authentication Failed",description:K.message||"Failed to authenticate. Please try again.",variant:"destructive"}),Y(!1)}finally{f(!1)}},ye=()=>{Y(!1),r({title:"Verification Failed",description:"Face verification failed. Please try again or use email/password.",variant:"destructive"})},ne=()=>{Y(!1),c("password")},le=async()=>{if(!v||!x){r({title:"Missing Information",description:"Please enter both email and password",variant:"destructive"});return}f(!0),console.log(" Attempting login with email:",v),console.log(" Password length:",x.length);try{const{data:K,error:ke}=await T.auth.signInWithPassword({email:v,password:x});if(ke)throw console.error(" Login error:",ke),ke;console.log(" Login successful, user ID:",K.user.id),await T.from("profiles").update({login_preference:i==="vai"?"facial":"password"}).eq("id",K.user.id),r({title:"Welcome back!",description:"Successfully signed in"});const{data:Ce}=await T.from("provider_profiles").select("username").eq("user_id",K.user.id).single();if(Ce!=null&&Ce.username)e("/feed");else{const Ge=sessionStorage.getItem("vairify_user"),He=Ge?JSON.parse(Ge).referralVAI:null;He&&/^(FC|FM|EA)\d{4}$/i.test(He)?e("/onboarding/founding-member"):e("/pricing")}}catch(K){r({title:"Login Failed",description:K.message||"Invalid email or password",variant:"destructive"})}finally{f(!1)}},ve=async()=>{if(!v||!x){r({title:"Missing Information",description:"Please enter both email and password",variant:"destructive"});return}if(x.length<6){r({title:"Weak Password",description:"Password must be at least 6 characters",variant:"destructive"});return}f(!0);try{const{error:K}=await T.auth.signUp({email:v,password:x,options:{emailRedirectTo:`${window.location.origin}/profile-creation`}});if(K)throw K;r({title:"Account Created!",description:"Please choose your membership tier"}),e("/pricing")}catch(K){r({title:"Signup Failed",description:K.message||"Could not create account",variant:"destructive"})}finally{f(!1)}};return s.jsxs("div",{className:"min-h-screen bg-gradient-hero flex flex-col",children:[s.jsxs("header",{className:"pt-12 md:pt-16 pb-8 text-center",children:[s.jsx("img",{src:Zi,alt:"Vairify",className:"h-16 md:h-20 mx-auto mb-4"}),s.jsx("h1",{className:"text-white text-2xl font-light mb-2",children:"Welcome Back"}),s.jsx("p",{className:"text-white/70 text-sm md:text-base",children:n==="identity"?"Sign in to your account":"Verify your identity"})]}),s.jsx("main",{className:"flex-1 flex items-center justify-center px-4 pb-12",children:s.jsxs("div",{className:"w-full max-w-[440px]",children:[s.jsxs("div",{className:"bg-card rounded-2xl shadow-xl p-8 md:p-12",children:[n==="identity"&&s.jsxs("div",{className:"space-y-8",children:[s.jsx("h2",{className:"text-foreground text-2xl font-semibold",children:"How would you like to identify yourself?"}),s.jsxs("button",{onClick:()=>R("vai"),className:"w-full h-[100px] border-2 border-border hover:border-primary rounded-xl bg-card hover:shadow-md transition-all duration-200 p-4 flex items-center gap-4 group",children:[s.jsx("div",{className:"flex-shrink-0 w-12 h-12 flex items-center justify-center",children:s.jsx(Y_,{className:"w-12 h-12 text-primary"})}),s.jsxs("div",{className:"flex-1 text-left",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"text-foreground text-lg font-semibold",children:"I have my V.A.I. Number"}),s.jsx("span",{className:"px-2 py-0.5 bg-primary text-primary-foreground text-xs rounded-full font-medium",children:"Recommended"})]}),s.jsx("p",{className:"text-muted-foreground text-sm",children:"Most Secure"})]})]}),s.jsxs("button",{onClick:()=>R("email"),className:"w-full h-[100px] border-2 border-border hover:border-primary rounded-xl bg-card hover:shadow-md transition-all duration-200 p-4 flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0 w-12 h-12 flex items-center justify-center",children:s.jsx(ai,{className:"w-12 h-12 text-muted-foreground"})}),s.jsxs("div",{className:"flex-1 text-left",children:[s.jsx("span",{className:"text-foreground text-lg font-semibold block mb-1",children:"I'll use my Email"}),s.jsx("p",{className:"text-muted-foreground text-sm",children:"If you forgot your V.A.I."})]})]}),s.jsx("p",{className:"text-muted-foreground text-sm leading-relaxed",children:"Don't know your V.A.I. number? Use email - we'll show it on your dashboard after you login."})]}),n==="vai-auth"&&s.jsxs("div",{className:"space-y-6",children:[!t.get("vai")&&s.jsxs("button",{onClick:M,className:"flex items-center gap-2 text-primary hover:text-primary-light transition-colors",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Back"})]}),t.get("vai")&&s.jsx("div",{className:"bg-gradient-to-r from-primary/10 via-secondary/10 to-primary/10 border-2 border-primary/20 rounded-xl p-6 mb-6",children:s.jsxs("div",{className:"text-center space-y-3",children:[s.jsx("div",{className:"text-3xl",children:""}),s.jsx("h2",{className:"text-foreground text-xl font-semibold leading-tight",children:"Welcome to Vairify!"}),s.jsx("p",{className:"text-muted-foreground text-sm leading-relaxed",children:"You're joining a verified community where every connection is real. Your V.A.I. unlocks safer connections with complete privacy and total accountability."}),s.jsxs("div",{className:"flex items-center justify-center gap-2 text-primary text-sm font-medium pt-2",children:[s.jsx(lt,{className:"w-4 h-4"}),s.jsx("span",{children:"Verified & Secure"})]})]})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-foreground text-sm font-medium mb-2",children:"V.A.I. Number"}),s.jsxs("div",{className:"relative",children:[s.jsx(Y_,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-primary"}),s.jsx(De,{type:"text",placeholder:"Enter your 7-character V.A.I.",value:p,onChange:K=>m(K.target.value.toUpperCase()),maxLength:7,className:"h-14 pl-10 pr-4 text-base font-mono",readOnly:!!t.get("vai")})]}),s.jsx("p",{className:"text-muted-foreground text-xs mt-1 ml-1",children:t.get("vai")?"Your V.A.I. from ChainPass":"Example: ABC123D"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-foreground text-xl font-semibold",children:t.get("vai")?"Ready to verify your identity":"How would you like to authenticate?"}),l==="face"?s.jsxs(s.Fragment,{children:[U&&ae?s.jsx($ye,{vaiNumber:p,storedPhotoUrl:ae,onSuccess:se,onFailure:ye,onFallback:ne}):s.jsxs(s.Fragment,{children:[P&&s.jsx("div",{className:"bg-primary/10 border border-primary/20 rounded-lg p-4 mb-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-primary"}),s.jsx("p",{className:"text-sm text-foreground",children:O})]})}),s.jsx("button",{onClick:he,disabled:p.length!==7||h||P,className:"w-full h-[160px] bg-gradient-primary hover:brightness-110 rounded-xl transition-all duration-200 hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 flex flex-col items-center justify-center gap-3",children:h||P?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-primary-foreground"}),s.jsx("span",{className:"text-primary-foreground text-xl font-semibold",children:P?"Syncing...":"Verifying..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Na,{className:"w-16 h-16 text-primary-foreground",strokeWidth:1.5}),s.jsx("span",{className:"text-primary-foreground text-xl font-semibold",children:"Scan My Face to Sign In"}),s.jsx("span",{className:"text-primary-foreground/90 text-sm",children:"Fastest & Most Secure Method"})]})})]}),s.jsxs("div",{className:"relative my-6",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-border"})}),s.jsx("div",{className:"relative flex justify-center",children:s.jsx("span",{className:"px-4 text-sm text-muted-foreground bg-card",children:"OR"})})]}),s.jsxs("button",{onClick:()=>c("password"),className:"w-full text-primary hover:text-primary-light transition-colors flex items-center justify-center gap-2",children:[s.jsx(Or,{className:"w-4 h-4"}),s.jsx("span",{className:"text-base font-medium",children:"Use password instead"})]}),s.jsx("p",{className:"text-muted-foreground text-sm text-center",children:"If camera is not working"})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-foreground text-sm font-medium mb-2",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(Or,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),s.jsx(De,{type:S?"text":"password",placeholder:"Enter your password",value:x,onChange:K=>y(K.target.value),className:"h-14 pl-10 pr-12 text-base"}),s.jsx("button",{type:"button",onClick:()=>C(!S),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:S?s.jsx(P0,{className:"h-5 w-5"}):s.jsx(Ri,{className:"h-5 w-5"})})]}),s.jsx("div",{className:"flex justify-end mt-2",children:s.jsx("button",{onClick:B,className:"text-sm text-primary hover:text-primary-light hover:underline transition-colors",children:"Forgot password?"})})]}),s.jsxs(L,{onClick:le,disabled:p.length!==7||!x,className:"w-full h-14 bg-gradient-primary hover:brightness-110 text-primary-foreground font-semibold text-base",children:[s.jsx(Or,{className:"h-4 w-4 mr-2"}),"Sign In with Password"]}),s.jsxs("p",{className:"text-muted-foreground text-sm text-center",children:["Want the faster method?"," ",s.jsx("button",{onClick:()=>c("face"),className:"text-primary hover:text-primary-light hover:underline",children:"Use face scan above"})]})]})]})]}),n==="email-auth"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("button",{onClick:M,className:"flex items-center gap-2 text-primary hover:text-primary-light transition-colors",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Back"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-foreground text-sm font-medium mb-2",children:"Email Address"}),s.jsxs("div",{className:"relative",children:[s.jsx(ai,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),s.jsx(De,{type:"email",placeholder:"Enter your email",value:v,onChange:K=>g(K.target.value),className:"h-14 pl-10 pr-4 text-base"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-foreground text-sm font-medium mb-2",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(Or,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),s.jsx(De,{type:S?"text":"password",placeholder:"Enter your password",value:x,onChange:K=>y(K.target.value),className:"h-14 pl-10 pr-12 text-base"}),s.jsx("button",{type:"button",onClick:()=>C(!S),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:S?s.jsx(P0,{className:"h-5 w-5"}):s.jsx(Ri,{className:"h-5 w-5"})})]}),s.jsx("div",{className:"flex justify-end mt-2",children:s.jsx("button",{onClick:B,className:"text-sm text-primary hover:text-primary-light hover:underline transition-colors",children:"Forgot password?"})})]}),s.jsxs(L,{onClick:u?ve:le,disabled:!v||!x||h,className:"w-full h-14 bg-gradient-primary hover:brightness-110 text-primary-foreground font-semibold text-base",children:[s.jsx(Or,{className:"h-4 w-4 mr-2"}),h?"Please wait...":u?"Create Account":"Sign In Securely"]}),s.jsx("div",{className:"text-center pt-4",children:s.jsxs("p",{className:"text-muted-foreground text-sm",children:[u?"Already have an account?":"Don't have an account?"," ",s.jsx("button",{onClick:()=>d(!u),className:"text-primary hover:text-primary-light hover:underline font-medium",children:u?"Sign In":"Sign Up"})]})}),s.jsxs("div",{className:"pt-4 border-t border-border",children:[s.jsx("p",{className:"text-muted-foreground text-sm text-center mb-3",children:"Want to skip typing your password?"}),s.jsxs(L,{onClick:()=>{c("face")},variant:"outline",className:"w-full h-12",children:[s.jsx(Na,{className:"w-4 h-4 mr-2"}),"Use Face ID Instead"]})]}),s.jsx("p",{className:"text-muted-foreground text-sm text-center",children:"Don't know your V.A.I.? It will be shown on your dashboard after login."})]}),n==="forgot-password"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("button",{onClick:M,className:"flex items-center gap-2 text-primary hover:text-primary-light transition-colors",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Back to login"})]}),s.jsxs("div",{className:"text-center mb-6",children:[s.jsx(lt,{className:"w-16 h-16 text-primary mx-auto mb-4"}),s.jsx("h2",{className:"text-foreground text-2xl font-semibold mb-2",children:"Reset Your Password"}),s.jsx("p",{className:"text-muted-foreground text-sm",children:"We'll send you a secure link to reset your password"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-foreground text-sm font-medium mb-2",children:"Email Address"}),s.jsxs("div",{className:"relative",children:[s.jsx(ai,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),s.jsx(De,{type:"email",placeholder:"Enter your registered email",value:E,onChange:K=>k(K.target.value),className:"h-14 pl-10 pr-4 text-base"})]})]}),s.jsx(L,{onClick:D,disabled:!E,className:"w-full h-14 bg-gradient-primary hover:brightness-110 text-primary-foreground font-semibold text-base",children:"Send Reset Link"}),s.jsxs("div",{className:"pt-4 border-t border-border text-center",children:[s.jsx("p",{className:"text-muted-foreground text-sm mb-3",children:"Can't access your email?"}),s.jsx("button",{onClick:()=>a("phone-otp"),className:"text-primary hover:text-primary-light hover:underline text-sm font-medium",children:"Try Phone Verification Instead"})]})]}),n==="phone-otp"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("button",{onClick:M,className:"flex items-center gap-2 text-primary hover:text-primary-light transition-colors",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Back to login"})]}),s.jsxs("div",{className:"text-center mb-6",children:[s.jsx(Bc,{className:"w-16 h-16 text-primary mx-auto mb-4"}),s.jsx("h2",{className:"text-foreground text-2xl font-semibold mb-2",children:"Emergency Phone Access"}),s.jsx("p",{className:"text-muted-foreground text-sm",children:"We'll send a one-time code to your registered phone"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-foreground text-sm font-medium mb-2",children:"Phone Number"}),s.jsxs("div",{className:"relative",children:[s.jsx(Bc,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),s.jsx(De,{type:"tel",placeholder:"+1 (555) 000-0000",value:b,onChange:K=>N(K.target.value),className:"h-14 pl-10 pr-4 text-base"})]}),s.jsx("p",{className:"text-muted-foreground text-xs mt-1 ml-1",children:"Must match the phone on your account"})]}),b&&!j?s.jsx(L,{onClick:W,className:"w-full h-14 bg-gradient-primary hover:brightness-110 text-primary-foreground font-semibold text-base",children:"Send Verification Code"}):b&&j?s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-foreground text-sm font-medium mb-2",children:"Verification Code"}),s.jsx(De,{type:"text",placeholder:"Enter 6-digit code",value:j,onChange:K=>_(K.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,className:"h-14 text-center text-2xl font-mono tracking-widest"}),s.jsxs("p",{className:"text-muted-foreground text-xs mt-2 text-center",children:["Code sent to ",b]})]}),s.jsx(L,{onClick:Z,disabled:j.length!==6,className:"w-full h-14 bg-gradient-primary hover:brightness-110 text-primary-foreground font-semibold text-base",children:"Verify & Sign In"}),s.jsx("button",{onClick:W,className:"w-full text-center text-sm text-primary hover:text-primary-light hover:underline",children:"Didn't receive code? Resend"})]}):null,s.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:s.jsxs("p",{className:"text-xs text-muted-foreground leading-relaxed",children:[s.jsx("strong",{children:"Security Note:"})," This emergency access method should only be used when you cannot access your email. For security reasons, this option may require additional verification steps."]})})]}),n==="trouble-signin"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("button",{onClick:M,className:"flex items-center gap-2 text-primary hover:text-primary-light transition-colors",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Back to login"})]}),s.jsxs("div",{className:"text-center mb-6",children:[s.jsx(A0,{className:"w-16 h-16 text-primary mx-auto mb-4"}),s.jsx("h2",{className:"text-foreground text-2xl font-semibold mb-2",children:"Having Trouble?"}),s.jsx("p",{className:"text-muted-foreground text-sm",children:"Choose the option that best describes your situation"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("button",{onClick:()=>a("forgot-password"),className:"w-full p-4 border-2 border-border hover:border-primary rounded-xl bg-card hover:shadow-md transition-all text-left",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Or,{className:"w-5 h-5 text-primary flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-foreground font-semibold mb-1",children:"I forgot my password"}),s.jsx("p",{className:"text-muted-foreground text-sm",children:"Reset your password via email"})]})]})}),s.jsx("button",{onClick:()=>a("phone-otp"),className:"w-full p-4 border-2 border-border hover:border-primary rounded-xl bg-card hover:shadow-md transition-all text-left",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Bc,{className:"w-5 h-5 text-primary flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-foreground font-semibold mb-1",children:"I can't access my email"}),s.jsx("p",{className:"text-muted-foreground text-sm",children:"Use phone verification as backup"})]})]})}),s.jsx("button",{onClick:()=>{a("vai-auth"),c("face")},className:"w-full p-4 border-2 border-border hover:border-primary rounded-xl bg-card hover:shadow-md transition-all text-left",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Y_,{className:"w-5 h-5 text-primary flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-foreground font-semibold mb-1",children:"I know my V.A.I. number"}),s.jsx("p",{className:"text-muted-foreground text-sm",children:"Use V.A.I. + Face ID (fastest method)"})]})]})}),s.jsx("button",{onClick:()=>{a("email-auth"),c("face")},className:"w-full p-4 border-2 border-border hover:border-primary rounded-xl bg-card hover:shadow-md transition-all text-left",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Na,{className:"w-5 h-5 text-primary flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-foreground font-semibold mb-1",children:"My camera isn't working"}),s.jsx("p",{className:"text-muted-foreground text-sm",children:"Try password login instead"})]})]})})]}),s.jsxs("div",{className:"pt-4 border-t border-border text-center",children:[s.jsx("p",{className:"text-muted-foreground text-sm mb-2",children:"Still need help?"}),s.jsx("a",{href:"#",className:"text-primary hover:text-primary-light hover:underline text-sm font-medium",children:"Contact Support Team"})]})]})]}),(n==="identity"||n==="vai-auth"||n==="email-auth")&&s.jsx("div",{className:"mt-6 text-center",children:s.jsxs("button",{onClick:$,className:"text-white/80 hover:text-white text-sm font-medium flex items-center gap-2 mx-auto group",children:[s.jsx(A0,{className:"w-4 h-4"}),s.jsx("span",{children:"Having trouble signing in?"})]})}),s.jsxs("div",{className:"mt-8 text-center space-y-6",children:[s.jsxs("p",{className:"text-xs text-white/50 max-w-md mx-auto leading-relaxed",children:["By signing in, you agree to our"," ",s.jsx("a",{href:"#",className:"text-primary-light hover:underline",children:"Terms of Service"})," ","and"," ",s.jsx("a",{href:"#",className:"text-primary-light hover:underline",children:"Privacy Policy"})]}),s.jsxs("div",{className:"flex items-center justify-center gap-2 text-white/40 text-xs",children:[s.jsx(Or,{className:"h-3 w-3"}),s.jsx("span",{children:"256-bit Encryption"})]})]})]})})]})},Lye=zp("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function xe({className:e,variant:t,...r}){return s.jsx("div",{className:me(Lye({variant:t}),e),...r})}const Bye=()=>{const{theme:e,setTheme:t}=_V();return s.jsxs(L,{variant:"ghost",size:"icon",onClick:()=>t(e==="dark"?"light":"dark"),className:"rounded-full",children:[s.jsx(Nae,{className:"h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),s.jsx(pae,{className:"absolute h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),s.jsx("span",{className:"sr-only",children:"Toggle theme"})]})};var Uye=w.createContext(void 0);function ah(e){const t=w.useContext(Uye);return e||t||"ltr"}var $2=0;function Bj(){w.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??U3()),document.body.insertAdjacentElement("beforeend",e[1]??U3()),$2++,()=>{$2===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),$2--}},[])}function U3(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var F2="focusScope.autoFocusOnMount",L2="focusScope.autoFocusOnUnmount",V3={bubbles:!1,cancelable:!0},Vye="FocusScope",Bx=w.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...o}=e,[l,c]=w.useState(null),u=Yr(a),d=Yr(i),h=w.useRef(null),f=ct(t,v=>c(v)),p=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(n){let v=function(b){if(p.paused||!l)return;const N=b.target;l.contains(N)?h.current=N:ec(h.current,{select:!0})},g=function(b){if(p.paused||!l)return;const N=b.relatedTarget;N!==null&&(l.contains(N)||ec(h.current,{select:!0}))},x=function(b){if(document.activeElement===document.body)for(const j of b)j.removedNodes.length>0&&ec(l)};document.addEventListener("focusin",v),document.addEventListener("focusout",g);const y=new MutationObserver(x);return l&&y.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",g),y.disconnect()}}},[n,l,p.paused]),w.useEffect(()=>{if(l){W3.add(p);const v=document.activeElement;if(!l.contains(v)){const x=new CustomEvent(F2,V3);l.addEventListener(F2,u),l.dispatchEvent(x),x.defaultPrevented||(zye(Kye(MG(l)),{select:!0}),document.activeElement===v&&ec(l))}return()=>{l.removeEventListener(F2,u),setTimeout(()=>{const x=new CustomEvent(L2,V3);l.addEventListener(L2,d),l.dispatchEvent(x),x.defaultPrevented||ec(v??document.body,{select:!0}),l.removeEventListener(L2,d),W3.remove(p)},0)}}},[l,u,d,p]);const m=w.useCallback(v=>{if(!r&&!n||p.paused)return;const g=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,x=document.activeElement;if(g&&x){const y=v.currentTarget,[b,N]=Wye(y);b&&N?!v.shiftKey&&x===N?(v.preventDefault(),r&&ec(b,{select:!0})):v.shiftKey&&x===b&&(v.preventDefault(),r&&ec(N,{select:!0})):x===y&&v.preventDefault()}},[r,n,p.paused]);return s.jsx(Me.div,{tabIndex:-1,...o,ref:f,onKeyDown:m})});Bx.displayName=Vye;function zye(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(ec(n,{select:t}),document.activeElement!==r)return}function Wye(e){const t=MG(e),r=z3(t,e),n=z3(t.reverse(),e);return[r,n]}function MG(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function z3(e,t){for(const r of e)if(!qye(r,{upTo:t}))return r}function qye(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Gye(e){return e instanceof HTMLInputElement&&"select"in e}function ec(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&Gye(e)&&t&&e.select()}}var W3=Hye();function Hye(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=q3(e,t),e.unshift(t)},remove(t){var r;e=q3(e,t),(r=e[0])==null||r.resume()}}}function q3(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function Kye(e){return e.filter(t=>t.tagName!=="A")}var B2="rovingFocusGroup.onEntryFocus",Yye={bubbles:!1,cancelable:!0},Ux="RovingFocusGroup",[BE,$G,Xye]=wx(Ux),[Qye,em]=an(Ux,[Xye]),[Zye,Jye]=Qye(Ux),FG=w.forwardRef((e,t)=>s.jsx(BE.Provider,{scope:e.__scopeRovingFocusGroup,children:s.jsx(BE.Slot,{scope:e.__scopeRovingFocusGroup,children:s.jsx(ebe,{...e,ref:t})})}));FG.displayName=Ux;var ebe=w.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...h}=e,f=w.useRef(null),p=ct(t,f),m=ah(i),[v,g]=Ba({prop:o,defaultProp:l??null,onChange:c,caller:Ux}),[x,y]=w.useState(!1),b=Yr(u),N=$G(r),j=w.useRef(!1),[_,S]=w.useState(0);return w.useEffect(()=>{const C=f.current;if(C)return C.addEventListener(B2,b),()=>C.removeEventListener(B2,b)},[b]),s.jsx(Zye,{scope:r,orientation:n,dir:m,loop:a,currentTabStopId:v,onItemFocus:w.useCallback(C=>g(C),[g]),onItemShiftTab:w.useCallback(()=>y(!0),[]),onFocusableItemAdd:w.useCallback(()=>S(C=>C+1),[]),onFocusableItemRemove:w.useCallback(()=>S(C=>C-1),[]),children:s.jsx(Me.div,{tabIndex:x||_===0?-1:0,"data-orientation":n,...h,ref:p,style:{outline:"none",...e.style},onMouseDown:Ne(e.onMouseDown,()=>{j.current=!0}),onFocus:Ne(e.onFocus,C=>{const E=!j.current;if(C.target===C.currentTarget&&E&&!x){const k=new CustomEvent(B2,Yye);if(C.currentTarget.dispatchEvent(k),!k.defaultPrevented){const P=N().filter(M=>M.focusable),A=P.find(M=>M.active),O=P.find(M=>M.id===v),R=[A,O,...P].filter(Boolean).map(M=>M.ref.current);UG(R,d)}}j.current=!1}),onBlur:Ne(e.onBlur,()=>y(!1))})})}),LG="RovingFocusGroupItem",BG=w.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:i,children:o,...l}=e,c=pn(),u=i||c,d=Jye(LG,r),h=d.currentTabStopId===u,f=$G(r),{onFocusableItemAdd:p,onFocusableItemRemove:m,currentTabStopId:v}=d;return w.useEffect(()=>{if(n)return p(),()=>m()},[n,p,m]),s.jsx(BE.ItemSlot,{scope:r,id:u,focusable:n,active:a,children:s.jsx(Me.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...l,ref:t,onMouseDown:Ne(e.onMouseDown,g=>{n?d.onItemFocus(u):g.preventDefault()}),onFocus:Ne(e.onFocus,()=>d.onItemFocus(u)),onKeyDown:Ne(e.onKeyDown,g=>{if(g.key==="Tab"&&g.shiftKey){d.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const x=nbe(g,d.orientation,d.dir);if(x!==void 0){if(g.metaKey||g.ctrlKey||g.altKey||g.shiftKey)return;g.preventDefault();let b=f().filter(N=>N.focusable).map(N=>N.ref.current);if(x==="last")b.reverse();else if(x==="prev"||x==="next"){x==="prev"&&b.reverse();const N=b.indexOf(g.currentTarget);b=d.loop?abe(b,N+1):b.slice(N+1)}setTimeout(()=>UG(b))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:v!=null}):o})})});BG.displayName=LG;var tbe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function rbe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function nbe(e,t,r){const n=rbe(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return tbe[n]}function UG(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function abe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var WR=FG,qR=BG,sbe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},jh=new WeakMap,ob=new WeakMap,lb={},U2=0,VG=function(e){return e&&(e.host||VG(e.parentNode))},ibe=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=VG(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},obe=function(e,t,r,n){var a=ibe(t,Array.isArray(e)?e:[e]);lb[r]||(lb[r]=new WeakMap);var i=lb[r],o=[],l=new Set,c=new Set(a),u=function(h){!h||l.has(h)||(l.add(h),u(h.parentNode))};a.forEach(u);var d=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(f){if(l.has(f))d(f);else try{var p=f.getAttribute(n),m=p!==null&&p!=="false",v=(jh.get(f)||0)+1,g=(i.get(f)||0)+1;jh.set(f,v),i.set(f,g),o.push(f),v===1&&m&&ob.set(f,!0),g===1&&f.setAttribute(r,"true"),m||f.setAttribute(n,"true")}catch(x){console.error("aria-hidden: cannot operate on ",f,x)}})};return d(t),l.clear(),U2++,function(){o.forEach(function(h){var f=jh.get(h)-1,p=i.get(h)-1;jh.set(h,f),i.set(h,p),f||(ob.has(h)||h.removeAttribute(n),ob.delete(h)),p||h.removeAttribute(r)}),U2--,U2||(jh=new WeakMap,jh=new WeakMap,ob=new WeakMap,lb={})}},Uj=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=sbe(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live]"))),obe(n,a,r,"aria-hidden")):function(){return null}},Xb="right-scroll-bar-position",Qb="width-before-scroll-bar",lbe="with-scroll-bars-hidden",cbe="--removed-body-scroll-bar-size";function V2(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function ube(e,t){var r=w.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var dbe=typeof window<"u"?w.useLayoutEffect:w.useEffect,G3=new WeakMap;function hbe(e,t){var r=ube(null,function(n){return e.forEach(function(a){return V2(a,n)})});return dbe(function(){var n=G3.get(r);if(n){var a=new Set(n),i=new Set(e),o=r.current;a.forEach(function(l){i.has(l)||V2(l,null)}),i.forEach(function(l){a.has(l)||V2(l,o)})}G3.set(r,e)},[e]),r}function fbe(e){return e}function pbe(e,t){t===void 0&&(t=fbe);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(i){var o=t(i,n);return r.push(o),function(){r=r.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(n=!0;r.length;){var o=r;r=[],o.forEach(i)}r={push:function(l){return i(l)},filter:function(){return r}}},assignMedium:function(i){n=!0;var o=[];if(r.length){var l=r;r=[],l.forEach(i),o=r}var c=function(){var d=o;o=[],d.forEach(i)},u=function(){return Promise.resolve().then(c)};u(),r={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),r}}}};return a}function mbe(e){e===void 0&&(e={});var t=pbe(null);return t.options=ur({async:!0,ssr:!1},e),t}var zG=function(e){var t=e.sideCar,r=cu(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return w.createElement(n,ur({},r))};zG.isSideCarExport=!0;function vbe(e,t){return e.useMedium(t),zG}var WG=mbe(),z2=function(){},Vj=w.forwardRef(function(e,t){var r=w.useRef(null),n=w.useState({onScrollCapture:z2,onWheelCapture:z2,onTouchMoveCapture:z2}),a=n[0],i=n[1],o=e.forwardProps,l=e.children,c=e.className,u=e.removeScrollBar,d=e.enabled,h=e.shards,f=e.sideCar,p=e.noRelative,m=e.noIsolation,v=e.inert,g=e.allowPinchZoom,x=e.as,y=x===void 0?"div":x,b=e.gapMode,N=cu(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),j=f,_=hbe([r,t]),S=ur(ur({},N),a);return w.createElement(w.Fragment,null,d&&w.createElement(j,{sideCar:WG,removeScrollBar:u,shards:h,noRelative:p,noIsolation:m,inert:v,setCallbacks:i,allowPinchZoom:!!g,lockRef:r,gapMode:b}),o?w.cloneElement(w.Children.only(l),ur(ur({},S),{ref:_})):w.createElement(y,ur({},S,{className:c,ref:_}),l))});Vj.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Vj.classNames={fullWidth:Qb,zeroRight:Xb};var gbe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function xbe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=gbe();return t&&e.setAttribute("nonce",t),e}function ybe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function bbe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var wbe=function(){var e=0,t=null;return{add:function(r){e==0&&(t=xbe())&&(ybe(t,r),bbe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},jbe=function(){var e=wbe();return function(t,r){w.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},qG=function(){var e=jbe(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},Nbe={left:0,top:0,right:0,gap:0},W2=function(e){return parseInt(e||"",10)||0},_be=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[W2(r),W2(n),W2(a)]},Sbe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Nbe;var t=_be(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},Cbe=qG(),Nf="data-scroll-locked",Ebe=function(e,t,r,n){var a=e.left,i=e.top,o=e.right,l=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(lbe,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(Nf,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Xb,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(Qb,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(Xb," .").concat(Xb,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Qb," .").concat(Qb,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Nf,`] {
    `).concat(cbe,": ").concat(l,`px;
  }
`)},H3=function(){var e=parseInt(document.body.getAttribute(Nf)||"0",10);return isFinite(e)?e:0},kbe=function(){w.useEffect(function(){return document.body.setAttribute(Nf,(H3()+1).toString()),function(){var e=H3()-1;e<=0?document.body.removeAttribute(Nf):document.body.setAttribute(Nf,e.toString())}},[])},Abe=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;kbe();var i=w.useMemo(function(){return Sbe(a)},[a]);return w.createElement(Cbe,{styles:Ebe(i,!t,a,r?"":"!important")})},UE=!1;if(typeof window<"u")try{var cb=Object.defineProperty({},"passive",{get:function(){return UE=!0,!0}});window.addEventListener("test",cb,cb),window.removeEventListener("test",cb,cb)}catch{UE=!1}var Nh=UE?{passive:!1}:!1,Pbe=function(e){return e.tagName==="TEXTAREA"},GG=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Pbe(e)&&r[t]==="visible")},Tbe=function(e){return GG(e,"overflowY")},Rbe=function(e){return GG(e,"overflowX")},K3=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=HG(e,n);if(a){var i=KG(e,n),o=i[1],l=i[2];if(o>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Obe=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Ibe=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},HG=function(e,t){return e==="v"?Tbe(t):Rbe(t)},KG=function(e,t){return e==="v"?Obe(t):Ibe(t)},Dbe=function(e,t){return e==="h"&&t==="rtl"?-1:1},Mbe=function(e,t,r,n,a){var i=Dbe(e,window.getComputedStyle(t).direction),o=i*n,l=r.target,c=t.contains(l),u=!1,d=o>0,h=0,f=0;do{if(!l)break;var p=KG(e,l),m=p[0],v=p[1],g=p[2],x=v-g-i*m;(m||x)&&HG(e,l)&&(h+=x,f+=m);var y=l.parentNode;l=y&&y.nodeType===Node.DOCUMENT_FRAGMENT_NODE?y.host:y}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(d&&(Math.abs(h)<1||!a)||!d&&(Math.abs(f)<1||!a))&&(u=!0),u},ub=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Y3=function(e){return[e.deltaX,e.deltaY]},X3=function(e){return e&&"current"in e?e.current:e},$be=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Fbe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Lbe=0,_h=[];function Bbe(e){var t=w.useRef([]),r=w.useRef([0,0]),n=w.useRef(),a=w.useState(Lbe++)[0],i=w.useState(qG)[0],o=w.useRef(e);w.useEffect(function(){o.current=e},[e]),w.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var v=RT([e.lockRef.current],(e.shards||[]).map(X3),!0).filter(Boolean);return v.forEach(function(g){return g.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),v.forEach(function(g){return g.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var l=w.useCallback(function(v,g){if("touches"in v&&v.touches.length===2||v.type==="wheel"&&v.ctrlKey)return!o.current.allowPinchZoom;var x=ub(v),y=r.current,b="deltaX"in v?v.deltaX:y[0]-x[0],N="deltaY"in v?v.deltaY:y[1]-x[1],j,_=v.target,S=Math.abs(b)>Math.abs(N)?"h":"v";if("touches"in v&&S==="h"&&_.type==="range")return!1;var C=K3(S,_);if(!C)return!0;if(C?j=S:(j=S==="v"?"h":"v",C=K3(S,_)),!C)return!1;if(!n.current&&"changedTouches"in v&&(b||N)&&(n.current=j),!j)return!0;var E=n.current||j;return Mbe(E,g,v,E==="h"?b:N,!0)},[]),c=w.useCallback(function(v){var g=v;if(!(!_h.length||_h[_h.length-1]!==i)){var x="deltaY"in g?Y3(g):ub(g),y=t.current.filter(function(j){return j.name===g.type&&(j.target===g.target||g.target===j.shadowParent)&&$be(j.delta,x)})[0];if(y&&y.should){g.cancelable&&g.preventDefault();return}if(!y){var b=(o.current.shards||[]).map(X3).filter(Boolean).filter(function(j){return j.contains(g.target)}),N=b.length>0?l(g,b[0]):!o.current.noIsolation;N&&g.cancelable&&g.preventDefault()}}},[]),u=w.useCallback(function(v,g,x,y){var b={name:v,delta:g,target:x,should:y,shadowParent:Ube(x)};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(N){return N!==b})},1)},[]),d=w.useCallback(function(v){r.current=ub(v),n.current=void 0},[]),h=w.useCallback(function(v){u(v.type,Y3(v),v.target,l(v,e.lockRef.current))},[]),f=w.useCallback(function(v){u(v.type,ub(v),v.target,l(v,e.lockRef.current))},[]);w.useEffect(function(){return _h.push(i),e.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,Nh),document.addEventListener("touchmove",c,Nh),document.addEventListener("touchstart",d,Nh),function(){_h=_h.filter(function(v){return v!==i}),document.removeEventListener("wheel",c,Nh),document.removeEventListener("touchmove",c,Nh),document.removeEventListener("touchstart",d,Nh)}},[]);var p=e.removeScrollBar,m=e.inert;return w.createElement(w.Fragment,null,m?w.createElement(i,{styles:Fbe(a)}):null,p?w.createElement(Abe,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function Ube(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Vbe=vbe(WG,Bbe);var Vx=w.forwardRef(function(e,t){return w.createElement(Vj,ur({},e,{ref:t,sideCar:Vbe}))});Vx.classNames=Vj.classNames;var VE=["Enter"," "],zbe=["ArrowDown","PageUp","Home"],YG=["ArrowUp","PageDown","End"],Wbe=[...zbe,...YG],qbe={ltr:[...VE,"ArrowRight"],rtl:[...VE,"ArrowLeft"]},Gbe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},zx="Menu",[Sg,Hbe,Kbe]=wx(zx),[sh,XG]=an(zx,[Kbe,lu,em]),zj=lu(),QG=em(),[Ybe,ih]=sh(zx),[Xbe,Wx]=sh(zx),ZG=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:a,onOpenChange:i,modal:o=!0}=e,l=zj(t),[c,u]=w.useState(null),d=w.useRef(!1),h=Yr(i),f=ah(a);return w.useEffect(()=>{const p=()=>{d.current=!0,document.addEventListener("pointerdown",m,{capture:!0,once:!0}),document.addEventListener("pointermove",m,{capture:!0,once:!0})},m=()=>d.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",m,{capture:!0}),document.removeEventListener("pointermove",m,{capture:!0})}},[]),s.jsx(fj,{...l,children:s.jsx(Ybe,{scope:t,open:r,onOpenChange:h,content:c,onContentChange:u,children:s.jsx(Xbe,{scope:t,onClose:w.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:f,modal:o,children:n})})})};ZG.displayName=zx;var Qbe="MenuAnchor",GR=w.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=zj(r);return s.jsx(Sx,{...a,...n,ref:t})});GR.displayName=Qbe;var HR="MenuPortal",[Zbe,JG]=sh(HR,{forceMount:void 0}),eH=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:a}=e,i=ih(HR,t);return s.jsx(Zbe,{scope:t,forceMount:r,children:s.jsx(gn,{present:r||i.open,children:s.jsx(Vp,{asChild:!0,container:a,children:n})})})};eH.displayName=HR;var si="MenuContent",[Jbe,KR]=sh(si),tH=w.forwardRef((e,t)=>{const r=JG(si,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,i=ih(si,e.__scopeMenu),o=Wx(si,e.__scopeMenu);return s.jsx(Sg.Provider,{scope:e.__scopeMenu,children:s.jsx(gn,{present:n||i.open,children:s.jsx(Sg.Slot,{scope:e.__scopeMenu,children:o.modal?s.jsx(e0e,{...a,ref:t}):s.jsx(t0e,{...a,ref:t})})})})}),e0e=w.forwardRef((e,t)=>{const r=ih(si,e.__scopeMenu),n=w.useRef(null),a=ct(t,n);return w.useEffect(()=>{const i=n.current;if(i)return Uj(i)},[]),s.jsx(YR,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Ne(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),t0e=w.forwardRef((e,t)=>{const r=ih(si,e.__scopeMenu);return s.jsx(YR,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),r0e=Xc("MenuContent.ScrollLock"),YR=w.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:p,disableOutsideScroll:m,...v}=e,g=ih(si,r),x=Wx(si,r),y=zj(r),b=QG(r),N=Hbe(r),[j,_]=w.useState(null),S=w.useRef(null),C=ct(t,S,g.onContentChange),E=w.useRef(0),k=w.useRef(""),P=w.useRef(0),A=w.useRef(null),O=w.useRef("right"),I=w.useRef(0),R=m?Vx:w.Fragment,M=m?{as:r0e,allowPinchZoom:!0}:void 0,B=D=>{var se,ye;const W=k.current+D,Z=N().filter(ne=>!ne.disabled),U=document.activeElement,Y=(se=Z.find(ne=>ne.ref.current===U))==null?void 0:se.textValue,ae=Z.map(ne=>ne.textValue),ie=p0e(ae,W,Y),he=(ye=Z.find(ne=>ne.textValue===ie))==null?void 0:ye.ref.current;(function ne(le){k.current=le,window.clearTimeout(E.current),le!==""&&(E.current=window.setTimeout(()=>ne(""),1e3))})(W),he&&setTimeout(()=>he.focus())};w.useEffect(()=>()=>window.clearTimeout(E.current),[]),Bj();const $=w.useCallback(D=>{var Z,U;return O.current===((Z=A.current)==null?void 0:Z.side)&&v0e(D,(U=A.current)==null?void 0:U.area)},[]);return s.jsx(Jbe,{scope:r,searchRef:k,onItemEnter:w.useCallback(D=>{$(D)&&D.preventDefault()},[$]),onItemLeave:w.useCallback(D=>{var W;$(D)||((W=S.current)==null||W.focus(),_(null))},[$]),onTriggerLeave:w.useCallback(D=>{$(D)&&D.preventDefault()},[$]),pointerGraceTimerRef:P,onPointerGraceIntentChange:w.useCallback(D=>{A.current=D},[]),children:s.jsx(R,{...M,children:s.jsx(Bx,{asChild:!0,trapped:a,onMountAutoFocus:Ne(i,D=>{var W;D.preventDefault(),(W=S.current)==null||W.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:s.jsx(Yd,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:p,children:s.jsx(WR,{asChild:!0,...b,dir:x.dir,orientation:"vertical",loop:n,currentTabStopId:j,onCurrentTabStopIdChange:_,onEntryFocus:Ne(c,D=>{x.isUsingKeyboardRef.current||D.preventDefault()}),preventScrollOnEntryFocus:!0,children:s.jsx(pj,{role:"menu","aria-orientation":"vertical","data-state":gH(g.open),"data-radix-menu-content":"",dir:x.dir,...y,...v,ref:C,style:{outline:"none",...v.style},onKeyDown:Ne(v.onKeyDown,D=>{const Z=D.target.closest("[data-radix-menu-content]")===D.currentTarget,U=D.ctrlKey||D.altKey||D.metaKey,Y=D.key.length===1;Z&&(D.key==="Tab"&&D.preventDefault(),!U&&Y&&B(D.key));const ae=S.current;if(D.target!==ae||!Wbe.includes(D.key))return;D.preventDefault();const he=N().filter(se=>!se.disabled).map(se=>se.ref.current);YG.includes(D.key)&&he.reverse(),h0e(he)}),onBlur:Ne(e.onBlur,D=>{D.currentTarget.contains(D.target)||(window.clearTimeout(E.current),k.current="")}),onPointerMove:Ne(e.onPointerMove,Cg(D=>{const W=D.target,Z=I.current!==D.clientX;if(D.currentTarget.contains(W)&&Z){const U=D.clientX>I.current?"right":"left";O.current=U,I.current=D.clientX}}))})})})})})})});tH.displayName=si;var n0e="MenuGroup",XR=w.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return s.jsx(Me.div,{role:"group",...n,ref:t})});XR.displayName=n0e;var a0e="MenuLabel",rH=w.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return s.jsx(Me.div,{...n,ref:t})});rH.displayName=a0e;var fw="MenuItem",Q3="menu.itemSelect",Wj=w.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...a}=e,i=w.useRef(null),o=Wx(fw,e.__scopeMenu),l=KR(fw,e.__scopeMenu),c=ct(t,i),u=w.useRef(!1),d=()=>{const h=i.current;if(!r&&h){const f=new CustomEvent(Q3,{bubbles:!0,cancelable:!0});h.addEventListener(Q3,p=>n==null?void 0:n(p),{once:!0}),sT(h,f),f.defaultPrevented?u.current=!1:o.onClose()}};return s.jsx(nH,{...a,ref:c,disabled:r,onClick:Ne(e.onClick,d),onPointerDown:h=>{var f;(f=e.onPointerDown)==null||f.call(e,h),u.current=!0},onPointerUp:Ne(e.onPointerUp,h=>{var f;u.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:Ne(e.onKeyDown,h=>{const f=l.searchRef.current!=="";r||f&&h.key===" "||VE.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});Wj.displayName=fw;var nH=w.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:a,...i}=e,o=KR(fw,r),l=QG(r),c=w.useRef(null),u=ct(t,c),[d,h]=w.useState(!1),[f,p]=w.useState("");return w.useEffect(()=>{const m=c.current;m&&p((m.textContent??"").trim())},[i.children]),s.jsx(Sg.ItemSlot,{scope:r,disabled:n,textValue:a??f,children:s.jsx(qR,{asChild:!0,...l,focusable:!n,children:s.jsx(Me.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:u,onPointerMove:Ne(e.onPointerMove,Cg(m=>{n?o.onItemLeave(m):(o.onItemEnter(m),m.defaultPrevented||m.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Ne(e.onPointerLeave,Cg(m=>o.onItemLeave(m))),onFocus:Ne(e.onFocus,()=>h(!0)),onBlur:Ne(e.onBlur,()=>h(!1))})})})}),s0e="MenuCheckboxItem",aH=w.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...a}=e;return s.jsx(cH,{scope:e.__scopeMenu,checked:r,children:s.jsx(Wj,{role:"menuitemcheckbox","aria-checked":pw(r)?"mixed":r,...a,ref:t,"data-state":ZR(r),onSelect:Ne(a.onSelect,()=>n==null?void 0:n(pw(r)?!0:!r),{checkForDefaultPrevented:!1})})})});aH.displayName=s0e;var sH="MenuRadioGroup",[i0e,o0e]=sh(sH,{value:void 0,onValueChange:()=>{}}),iH=w.forwardRef((e,t)=>{const{value:r,onValueChange:n,...a}=e,i=Yr(n);return s.jsx(i0e,{scope:e.__scopeMenu,value:r,onValueChange:i,children:s.jsx(XR,{...a,ref:t})})});iH.displayName=sH;var oH="MenuRadioItem",lH=w.forwardRef((e,t)=>{const{value:r,...n}=e,a=o0e(oH,e.__scopeMenu),i=r===a.value;return s.jsx(cH,{scope:e.__scopeMenu,checked:i,children:s.jsx(Wj,{role:"menuitemradio","aria-checked":i,...n,ref:t,"data-state":ZR(i),onSelect:Ne(n.onSelect,()=>{var o;return(o=a.onValueChange)==null?void 0:o.call(a,r)},{checkForDefaultPrevented:!1})})})});lH.displayName=oH;var QR="MenuItemIndicator",[cH,l0e]=sh(QR,{checked:!1}),uH=w.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...a}=e,i=l0e(QR,r);return s.jsx(gn,{present:n||pw(i.checked)||i.checked===!0,children:s.jsx(Me.span,{...a,ref:t,"data-state":ZR(i.checked)})})});uH.displayName=QR;var c0e="MenuSeparator",dH=w.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return s.jsx(Me.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});dH.displayName=c0e;var u0e="MenuArrow",hH=w.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=zj(r);return s.jsx(mj,{...a,...n,ref:t})});hH.displayName=u0e;var d0e="MenuSub",[dQe,fH]=sh(d0e),uv="MenuSubTrigger",pH=w.forwardRef((e,t)=>{const r=ih(uv,e.__scopeMenu),n=Wx(uv,e.__scopeMenu),a=fH(uv,e.__scopeMenu),i=KR(uv,e.__scopeMenu),o=w.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,u={__scopeMenu:e.__scopeMenu},d=w.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return w.useEffect(()=>d,[d]),w.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),c(null)}},[l,c]),s.jsx(GR,{asChild:!0,...u,children:s.jsx(nH,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":gH(r.open),...e,ref:Sl(t,a.onTriggerChange),onClick:h=>{var f;(f=e.onClick)==null||f.call(e,h),!(e.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Ne(e.onPointerMove,Cg(h=>{i.onItemEnter(h),!h.defaultPrevented&&!e.disabled&&!r.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{r.onOpenChange(!0),d()},100))})),onPointerLeave:Ne(e.onPointerLeave,Cg(h=>{var p,m;d();const f=(p=r.content)==null?void 0:p.getBoundingClientRect();if(f){const v=(m=r.content)==null?void 0:m.dataset.side,g=v==="right",x=g?-5:5,y=f[g?"left":"right"],b=f[g?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+x,y:h.clientY},{x:y,y:f.top},{x:b,y:f.top},{x:b,y:f.bottom},{x:y,y:f.bottom}],side:v}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Ne(e.onKeyDown,h=>{var p;const f=i.searchRef.current!=="";e.disabled||f&&h.key===" "||qbe[n.dir].includes(h.key)&&(r.onOpenChange(!0),(p=r.content)==null||p.focus(),h.preventDefault())})})})});pH.displayName=uv;var mH="MenuSubContent",vH=w.forwardRef((e,t)=>{const r=JG(si,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,i=ih(si,e.__scopeMenu),o=Wx(si,e.__scopeMenu),l=fH(mH,e.__scopeMenu),c=w.useRef(null),u=ct(t,c);return s.jsx(Sg.Provider,{scope:e.__scopeMenu,children:s.jsx(gn,{present:n||i.open,children:s.jsx(Sg.Slot,{scope:e.__scopeMenu,children:s.jsx(YR,{id:l.contentId,"aria-labelledby":l.triggerId,...a,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;o.isUsingKeyboardRef.current&&((h=c.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:Ne(e.onFocusOutside,d=>{d.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Ne(e.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:Ne(e.onKeyDown,d=>{var p;const h=d.currentTarget.contains(d.target),f=Gbe[o.dir].includes(d.key);h&&f&&(i.onOpenChange(!1),(p=l.trigger)==null||p.focus(),d.preventDefault())})})})})})});vH.displayName=mH;function gH(e){return e?"open":"closed"}function pw(e){return e==="indeterminate"}function ZR(e){return pw(e)?"indeterminate":e?"checked":"unchecked"}function h0e(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function f0e(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function p0e(e,t,r){const a=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=f0e(e,Math.max(i,0));a.length===1&&(o=o.filter(u=>u!==r));const c=o.find(u=>u.toLowerCase().startsWith(a.toLowerCase()));return c!==r?c:void 0}function m0e(e,t){const{x:r,y:n}=e;let a=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i],c=t[o],u=l.x,d=l.y,h=c.x,f=c.y;d>n!=f>n&&r<(h-u)*(n-d)/(f-d)+u&&(a=!a)}return a}function v0e(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return m0e(r,t)}function Cg(e){return t=>t.pointerType==="mouse"?e(t):void 0}var g0e=ZG,x0e=GR,y0e=eH,b0e=tH,w0e=XR,j0e=rH,N0e=Wj,_0e=aH,S0e=iH,C0e=lH,E0e=uH,k0e=dH,A0e=hH,P0e=pH,T0e=vH,qj="DropdownMenu",[R0e,hQe]=an(qj,[XG]),qa=XG(),[O0e,xH]=R0e(qj),yH=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:a,defaultOpen:i,onOpenChange:o,modal:l=!0}=e,c=qa(t),u=w.useRef(null),[d,h]=Ba({prop:a,defaultProp:i??!1,onChange:o,caller:qj});return s.jsx(O0e,{scope:t,triggerId:pn(),triggerRef:u,contentId:pn(),open:d,onOpenChange:h,onOpenToggle:w.useCallback(()=>h(f=>!f),[h]),modal:l,children:s.jsx(g0e,{...c,open:d,onOpenChange:h,dir:n,modal:l,children:r})})};yH.displayName=qj;var bH="DropdownMenuTrigger",wH=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...a}=e,i=xH(bH,r),o=qa(r);return s.jsx(x0e,{asChild:!0,...o,children:s.jsx(Me.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...a,ref:Sl(t,i.triggerRef),onPointerDown:Ne(e.onPointerDown,l=>{!n&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:Ne(e.onKeyDown,l=>{n||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});wH.displayName=bH;var I0e="DropdownMenuPortal",jH=e=>{const{__scopeDropdownMenu:t,...r}=e,n=qa(t);return s.jsx(y0e,{...n,...r})};jH.displayName=I0e;var NH="DropdownMenuContent",_H=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xH(NH,r),i=qa(r),o=w.useRef(!1);return s.jsx(b0e,{id:a.contentId,"aria-labelledby":a.triggerId,...i,...n,ref:t,onCloseAutoFocus:Ne(e.onCloseAutoFocus,l=>{var c;o.current||(c=a.triggerRef.current)==null||c.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:Ne(e.onInteractOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,d=c.button===2||u;(!a.modal||d)&&(o.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});_H.displayName=NH;var D0e="DropdownMenuGroup",M0e=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=qa(r);return s.jsx(w0e,{...a,...n,ref:t})});M0e.displayName=D0e;var $0e="DropdownMenuLabel",SH=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=qa(r);return s.jsx(j0e,{...a,...n,ref:t})});SH.displayName=$0e;var F0e="DropdownMenuItem",CH=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=qa(r);return s.jsx(N0e,{...a,...n,ref:t})});CH.displayName=F0e;var L0e="DropdownMenuCheckboxItem",EH=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=qa(r);return s.jsx(_0e,{...a,...n,ref:t})});EH.displayName=L0e;var B0e="DropdownMenuRadioGroup",U0e=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=qa(r);return s.jsx(S0e,{...a,...n,ref:t})});U0e.displayName=B0e;var V0e="DropdownMenuRadioItem",kH=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=qa(r);return s.jsx(C0e,{...a,...n,ref:t})});kH.displayName=V0e;var z0e="DropdownMenuItemIndicator",AH=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=qa(r);return s.jsx(E0e,{...a,...n,ref:t})});AH.displayName=z0e;var W0e="DropdownMenuSeparator",PH=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=qa(r);return s.jsx(k0e,{...a,...n,ref:t})});PH.displayName=W0e;var q0e="DropdownMenuArrow",G0e=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=qa(r);return s.jsx(A0e,{...a,...n,ref:t})});G0e.displayName=q0e;var H0e="DropdownMenuSubTrigger",TH=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=qa(r);return s.jsx(P0e,{...a,...n,ref:t})});TH.displayName=H0e;var K0e="DropdownMenuSubContent",RH=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=qa(r);return s.jsx(T0e,{...a,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});RH.displayName=K0e;var Y0e=yH,X0e=wH,Q0e=jH,OH=_H,IH=SH,DH=CH,MH=EH,$H=kH,FH=AH,LH=PH,BH=TH,UH=RH;const VH=Y0e,zH=X0e,Z0e=w.forwardRef(({className:e,inset:t,children:r,...n},a)=>s.jsxs(BH,{ref:a,className:me("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",t&&"pl-8",e),...n,children:[r,s.jsx(Wp,{className:"ml-auto h-4 w-4"})]}));Z0e.displayName=BH.displayName;const J0e=w.forwardRef(({className:e,...t},r)=>s.jsx(UH,{ref:r,className:me("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));J0e.displayName=UH.displayName;const JR=w.forwardRef(({className:e,sideOffset:t=4,...r},n)=>s.jsx(Q0e,{children:s.jsx(OH,{ref:n,sideOffset:t,className:me("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));JR.displayName=OH.displayName;const Xu=w.forwardRef(({className:e,inset:t,...r},n)=>s.jsx(DH,{ref:n,className:me("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t&&"pl-8",e),...r}));Xu.displayName=DH.displayName;const ewe=w.forwardRef(({className:e,children:t,checked:r,...n},a)=>s.jsxs(MH,{ref:a,className:me("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),checked:r,...n,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(FH,{children:s.jsx($t,{className:"h-4 w-4"})})}),t]}));ewe.displayName=MH.displayName;const twe=w.forwardRef(({className:e,children:t,...r},n)=>s.jsxs($H,{ref:n,className:me("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(FH,{children:s.jsx(cT,{className:"h-2 w-2 fill-current"})})}),t]}));twe.displayName=$H.displayName;const rwe=w.forwardRef(({className:e,inset:t,...r},n)=>s.jsx(IH,{ref:n,className:me("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));rwe.displayName=IH.displayName;const mw=w.forwardRef(({className:e,...t},r)=>s.jsx(LH,{ref:r,className:me("-mx-1 my-1 h-px bg-muted",e),...t}));mw.displayName=LH.displayName;var Gj="Dialog",[WH,qH]=an(Gj),[nwe,to]=WH(Gj),GH=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:i,modal:o=!0}=e,l=w.useRef(null),c=w.useRef(null),[u,d]=Ba({prop:n,defaultProp:a??!1,onChange:i,caller:Gj});return s.jsx(nwe,{scope:t,triggerRef:l,contentRef:c,contentId:pn(),titleId:pn(),descriptionId:pn(),open:u,onOpenChange:d,onOpenToggle:w.useCallback(()=>d(h=>!h),[d]),modal:o,children:r})};GH.displayName=Gj;var HH="DialogTrigger",KH=w.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=to(HH,r),i=ct(t,a.triggerRef);return s.jsx(Me.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":rO(a.open),...n,ref:i,onClick:Ne(e.onClick,a.onOpenToggle)})});KH.displayName=HH;var eO="DialogPortal",[awe,YH]=WH(eO,{forceMount:void 0}),XH=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=e,i=to(eO,t);return s.jsx(awe,{scope:t,forceMount:r,children:w.Children.map(n,o=>s.jsx(gn,{present:r||i.open,children:s.jsx(Vp,{asChild:!0,container:a,children:o})}))})};XH.displayName=eO;var vw="DialogOverlay",QH=w.forwardRef((e,t)=>{const r=YH(vw,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,i=to(vw,e.__scopeDialog);return i.modal?s.jsx(gn,{present:n||i.open,children:s.jsx(iwe,{...a,ref:t})}):null});QH.displayName=vw;var swe=Xc("DialogOverlay.RemoveScroll"),iwe=w.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=to(vw,r);return s.jsx(Vx,{as:swe,allowPinchZoom:!0,shards:[a.contentRef],children:s.jsx(Me.div,{"data-state":rO(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),Dd="DialogContent",ZH=w.forwardRef((e,t)=>{const r=YH(Dd,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,i=to(Dd,e.__scopeDialog);return s.jsx(gn,{present:n||i.open,children:i.modal?s.jsx(owe,{...a,ref:t}):s.jsx(lwe,{...a,ref:t})})});ZH.displayName=Dd;var owe=w.forwardRef((e,t)=>{const r=to(Dd,e.__scopeDialog),n=w.useRef(null),a=ct(t,r.contentRef,n);return w.useEffect(()=>{const i=n.current;if(i)return Uj(i)},[]),s.jsx(JH,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ne(e.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Ne(e.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&i.preventDefault()}),onFocusOutside:Ne(e.onFocusOutside,i=>i.preventDefault())})}),lwe=w.forwardRef((e,t)=>{const r=to(Dd,e.__scopeDialog),n=w.useRef(!1),a=w.useRef(!1);return s.jsx(JH,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{var c,u;(c=e.onInteractOutside)==null||c.call(e,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((u=r.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),JH=w.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,...o}=e,l=to(Dd,r),c=w.useRef(null),u=ct(t,c);return Bj(),s.jsxs(s.Fragment,{children:[s.jsx(Bx,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:s.jsx(Yd,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":rO(l.open),...o,ref:u,onDismiss:()=>l.onOpenChange(!1)})}),s.jsxs(s.Fragment,{children:[s.jsx(uwe,{titleId:l.titleId}),s.jsx(hwe,{contentRef:c,descriptionId:l.descriptionId})]})]})}),tO="DialogTitle",e9=w.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=to(tO,r);return s.jsx(Me.h2,{id:a.titleId,...n,ref:t})});e9.displayName=tO;var t9="DialogDescription",r9=w.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=to(t9,r);return s.jsx(Me.p,{id:a.descriptionId,...n,ref:t})});r9.displayName=t9;var n9="DialogClose",a9=w.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=to(n9,r);return s.jsx(Me.button,{type:"button",...n,ref:t,onClick:Ne(e.onClick,()=>a.onOpenChange(!1))})});a9.displayName=n9;function rO(e){return e?"open":"closed"}var s9="DialogTitleWarning",[cwe,i9]=une(s9,{contentName:Dd,titleName:tO,docsSlug:"dialog"}),uwe=({titleId:e})=>{const t=i9(s9),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return w.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},dwe="DialogDescriptionWarning",hwe=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${i9(dwe).contentName}}.`;return w.useEffect(()=>{var i;const a=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},Hj=GH,nO=KH,Kj=XH,tm=QH,rm=ZH,qx=e9,Gx=r9,Yj=a9;const Ca=Hj,Xj=nO,fwe=Kj,o9=w.forwardRef(({className:e,...t},r)=>s.jsx(tm,{ref:r,className:me("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));o9.displayName=tm.displayName;const oa=w.forwardRef(({className:e,children:t,...r},n)=>s.jsxs(fwe,{children:[s.jsx(o9,{}),s.jsxs(rm,{ref:n,className:me("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,s.jsxs(Yj,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[s.jsx(vn,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));oa.displayName=rm.displayName;const Ea=({className:e,...t})=>s.jsx("div",{className:me("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Ea.displayName="DialogHeader";const Hx=({className:e,...t})=>s.jsx("div",{className:me("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Hx.displayName="DialogFooter";const ka=w.forwardRef(({className:e,...t},r)=>s.jsx(qx,{ref:r,className:me("text-lg font-semibold leading-none tracking-tight",e),...t}));ka.displayName=qx.displayName;const pu=w.forwardRef(({className:e,...t},r)=>s.jsx(Gx,{ref:r,className:me("text-sm text-muted-foreground",e),...t}));pu.displayName=Gx.displayName;const pwe=({open:e,onOpenChange:t})=>{const r=["Unlimited V.A.I.-CHECK verifications","Priority DateGuard response","Advanced TrueRevu analytics","Premium badge on profile","Early access to new features","Priority support"];return s.jsx(Ca,{open:e,onOpenChange:t,children:s.jsxs(oa,{className:"max-w-md",children:[s.jsxs(Ea,{children:[s.jsx(ka,{className:"text-2xl",children:"Upgrade to Premium"}),s.jsx(pu,{children:"Unlock all features and get the most out of Vairify"})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gradient-to-br from-primary/10 to-accent/10 rounded-lg p-6 text-center",children:[s.jsx("div",{className:"text-4xl font-bold text-primary mb-2",children:"$29.99"}),s.jsx("div",{className:"text-muted-foreground",children:"per month"})]}),s.jsx("div",{className:"space-y-3",children:r.map((n,a)=>s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx($t,{className:"w-5 h-5 text-success shrink-0 mt-0.5"}),s.jsx("span",{className:"text-sm",children:n})]},a))}),s.jsx(L,{className:"w-full",size:"lg",children:"Upgrade Now"}),s.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"Cancel anytime. No hidden fees."})]})]})})},mwe=()=>{const[e,t]=w.useState(!1);return w.useEffect(()=>{const n=async()=>{try{const{data:{user:i}}=await T.auth.getUser();if(!i)return;const{data:o}=await T.from("influencer_applications").select("status").eq("user_id",i.id).order("created_at",{ascending:!1}).limit(1).single();o&&o.status==="pending"&&t(!0);const l=localStorage.getItem(`app_status_${i.id}`);o&&l&&l!==o.status&&t(!0)}catch(i){console.error("Error checking application status:",i)}};n();const a=T.channel("application-status-changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"influencer_applications"},()=>{n()}).subscribe();return()=>{T.removeChannel(a)}},[]),{hasPendingNotification:e,clearNotification:async()=>{try{const{data:{user:n}}=await T.auth.getUser();if(!n)return;const{data:a}=await T.from("influencer_applications").select("status").eq("user_id",n.id).order("created_at",{ascending:!1}).limit(1).single();a&&localStorage.setItem(`app_status_${n.id}`,a.status),t(!1)}catch(n){console.error("Error clearing notification:",n)}}}},vwe=()=>{const[e,t]=w.useState(0);return w.useEffect(()=>{const r=async()=>{try{const{data:{user:a}}=await T.auth.getUser();if(!a)return;const{count:i,error:o}=await T.from("notifications").select("*",{count:"exact",head:!0}).eq("user_id",a.id).eq("read",!1);if(o){console.error("Error fetching unread count:",o);return}t(i||0)}catch(a){console.error("Error in fetchUnreadCount:",a)}};r();const n=T.channel("notifications-count").on("postgres_changes",{event:"*",schema:"public",table:"notifications"},()=>{r()}).subscribe();return()=>{T.removeChannel(n)}},[]),{unreadCount:e}},gwe=()=>{const e=Oe(),[t,r]=w.useState(!1),{hasPendingNotification:n,clearNotification:a}=mwe(),{unreadCount:i}=vwe(),o=()=>{a(),e("/settings")},l=async()=>{await T.auth.signOut(),e("/")};return s.jsxs(s.Fragment,{children:[s.jsx("header",{className:"sticky top-0 z-50 bg-background border-b border-border shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 max-w-2xl mx-auto",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("img",{src:"/src/assets/vairify-logo.png",alt:"Logo",className:"h-8 w-auto"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(L,{size:"sm",variant:"outline",onClick:()=>e("/available-now"),className:"flex items-center gap-1.5 text-xs font-medium border-green-500/50 hover:border-green-500 hover:bg-green-500/10",children:[s.jsx(hn,{className:"w-3.5 h-3.5 text-green-600"}),s.jsx("span",{className:"hidden sm:inline",children:"Available Now"}),s.jsx("span",{className:"inline sm:hidden",children:"Now"}),s.jsxs("span",{className:"relative flex h-2 w-2",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),s.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-green-500"})]})]}),s.jsx(Bye,{}),s.jsx("button",{className:"p-2 hover:bg-accent rounded-full transition-colors",children:s.jsx(lt,{className:"w-5 h-5 text-muted-foreground"})}),s.jsx("button",{className:"p-2 hover:bg-accent rounded-full transition-colors",children:s.jsx(xe,{className:"w-5 h-5 bg-primary text-primary-foreground"})}),s.jsxs("button",{onClick:()=>e("/notifications"),className:"p-2 hover:bg-accent rounded-full transition-colors relative",children:[s.jsx(tz,{className:"w-5 h-5 text-muted-foreground"}),i>0&&s.jsx("span",{className:"absolute top-1 right-1 min-w-[18px] h-[18px] bg-destructive text-white text-[10px] font-bold rounded-full flex items-center justify-center px-1",children:i>9?"9+":i})]}),s.jsxs(VH,{children:[s.jsx(zH,{asChild:!0,children:s.jsx("button",{className:"p-2 hover:bg-accent rounded-full transition-colors",children:s.jsx(fn,{className:"w-5 h-5 text-muted-foreground"})})}),s.jsxs(JR,{align:"end",className:"w-48",children:[s.jsxs(Xu,{onClick:()=>r(!0),children:[s.jsx(zi,{className:"w-4 h-4 mr-2 text-warning"}),"Upgrade to Premium"]}),s.jsx(mw,{}),s.jsx(Xu,{onClick:()=>e("/profile"),children:"Profile"}),s.jsxs(Xu,{onClick:o,children:[s.jsxs("div",{className:"relative",children:[s.jsx(oj,{className:"w-4 h-4 mr-2"}),n&&s.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-destructive rounded-full"})]}),"Settings"]}),s.jsx(mw,{}),s.jsx(Xu,{onClick:l,children:"Sign out"})]})]})]})]})}),s.jsx(pwe,{open:t,onOpenChange:r})]})},aO=({activeTab:e})=>{const t=Oe(),r=[{id:"feed",icon:lae,label:"Feed",path:"/feed"},{id:"chat",icon:sj,label:"Chat",path:"/chat"},{id:"vai",icon:lt,label:"VAI",path:"/vai-check/show-qr",isCenter:!0},{id:"search",icon:Cl,label:"Search",path:"/search"},{id:"profile",icon:fn,label:"Profile",path:"/profile-creation"}];return s.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-40 bg-card border-t border-border shadow-lg",children:s.jsx("div",{className:"flex items-center justify-around max-w-2xl mx-auto",children:r.map(n=>{const a=n.icon,i=e===n.id,o=n.isCenter;return s.jsx("button",{onClick:()=>t(n.path),className:`flex flex-col items-center gap-1 py-3 px-4 flex-1 transition-colors relative ${i?"text-primary":"text-muted-foreground"} ${o?"-mt-6":""}`,children:o?s.jsx("div",{className:"w-14 h-14 bg-primary rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-shadow",children:s.jsx(a,{className:"w-7 h-7 text-primary-foreground"})}):s.jsxs(s.Fragment,{children:[s.jsx(a,{className:`w-6 h-6 ${i?"text-primary":""}`}),s.jsx("span",{className:`text-xs font-medium ${i?"text-primary":""}`,children:n.label})]})},n.id)})})})};var l9="AlertDialog",[xwe,fQe]=an(l9,[qH]),Ul=qH(),c9=e=>{const{__scopeAlertDialog:t,...r}=e,n=Ul(t);return s.jsx(Hj,{...n,...r,modal:!0})};c9.displayName=l9;var ywe="AlertDialogTrigger",u9=w.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Ul(r);return s.jsx(nO,{...a,...n,ref:t})});u9.displayName=ywe;var bwe="AlertDialogPortal",d9=e=>{const{__scopeAlertDialog:t,...r}=e,n=Ul(t);return s.jsx(Kj,{...n,...r})};d9.displayName=bwe;var wwe="AlertDialogOverlay",h9=w.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Ul(r);return s.jsx(tm,{...a,...n,ref:t})});h9.displayName=wwe;var _f="AlertDialogContent",[jwe,Nwe]=xwe(_f),_we=EV("AlertDialogContent"),f9=w.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...a}=e,i=Ul(r),o=w.useRef(null),l=ct(t,o),c=w.useRef(null);return s.jsx(cwe,{contentName:_f,titleName:p9,docsSlug:"alert-dialog",children:s.jsx(jwe,{scope:r,cancelRef:c,children:s.jsxs(rm,{role:"alertdialog",...i,...a,ref:l,onOpenAutoFocus:Ne(a.onOpenAutoFocus,u=>{var d;u.preventDefault(),(d=c.current)==null||d.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[s.jsx(_we,{children:n}),s.jsx(Cwe,{contentRef:o})]})})})});f9.displayName=_f;var p9="AlertDialogTitle",m9=w.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Ul(r);return s.jsx(qx,{...a,...n,ref:t})});m9.displayName=p9;var v9="AlertDialogDescription",g9=w.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Ul(r);return s.jsx(Gx,{...a,...n,ref:t})});g9.displayName=v9;var Swe="AlertDialogAction",x9=w.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Ul(r);return s.jsx(Yj,{...a,...n,ref:t})});x9.displayName=Swe;var y9="AlertDialogCancel",b9=w.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:a}=Nwe(y9,r),i=Ul(r),o=ct(t,a);return s.jsx(Yj,{...i,...n,ref:o})});b9.displayName=y9;var Cwe=({contentRef:e})=>{const t=`\`${_f}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${_f}\` by passing a \`${v9}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${_f}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return w.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},Ewe=c9,kwe=u9,Awe=d9,w9=h9,j9=f9,N9=x9,_9=b9,S9=m9,C9=g9;const sO=Ewe,E9=kwe,Pwe=Awe,k9=w.forwardRef(({className:e,...t},r)=>s.jsx(w9,{className:me("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));k9.displayName=w9.displayName;const Qj=w.forwardRef(({className:e,...t},r)=>s.jsxs(Pwe,{children:[s.jsx(k9,{}),s.jsx(j9,{ref:r,className:me("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));Qj.displayName=j9.displayName;const Zj=({className:e,...t})=>s.jsx("div",{className:me("flex flex-col space-y-2 text-center sm:text-left",e),...t});Zj.displayName="AlertDialogHeader";const Jj=({className:e,...t})=>s.jsx("div",{className:me("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Jj.displayName="AlertDialogFooter";const eN=w.forwardRef(({className:e,...t},r)=>s.jsx(S9,{ref:r,className:me("text-lg font-semibold",e),...t}));eN.displayName=S9.displayName;const tN=w.forwardRef(({className:e,...t},r)=>s.jsx(C9,{ref:r,className:me("text-sm text-muted-foreground",e),...t}));tN.displayName=C9.displayName;const rN=w.forwardRef(({className:e,...t},r)=>s.jsx(N9,{ref:r,className:me(AT(),e),...t}));rN.displayName=N9.displayName;const nN=w.forwardRef(({className:e,...t},r)=>s.jsx(_9,{ref:r,className:me(AT({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));nN.displayName=_9.displayName;const Twe=()=>{const[e,t]=w.useState(!1),[r,n]=w.useState(!1),a=()=>new Promise(o=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(l=>{const c=`${l.coords.latitude},${l.coords.longitude}`;o({gps:c,address:`GPS: ${l.coords.latitude.toFixed(4)}, ${l.coords.longitude.toFixed(4)}`})},()=>{o({gps:"unknown",address:"Location unavailable"})}):o({gps:"unknown",address:"Location unavailable"})}),i=async()=>{n(!0);try{const{data:{user:o}}=await T.auth.getUser();if(!o){H.error("Authentication required"),n(!1);return}const l=await a(),{data:c,error:u}=await T.functions.invoke("send-emergency-alert",{body:{user_id:o.id,location_gps:l.gps,location_address:l.address,trigger_type:"panic_button"}});if(u)throw u;H.success(` DATEGUARD SOS ACTIVATED
Notified ${c.guardians_notified} guardian(s)`,{duration:5e3,className:"bg-destructive text-destructive-foreground"}),t(!1)}catch(o){console.error("Emergency alert error:",o),H.error("Failed to send emergency alert. Please call 911 directly.")}finally{n(!1)}};return s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>t(!0),className:"fixed bottom-20 right-4 z-50 w-14 h-14 bg-destructive rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition-transform active:scale-95 animate-pulse","aria-label":"DateGuard SOS",children:s.jsx(tn,{className:"w-7 h-7 text-destructive-foreground"})}),s.jsx(sO,{open:e,onOpenChange:t,children:s.jsxs(Qj,{className:"border-destructive/50",children:[s.jsxs(Zj,{children:[s.jsxs(eN,{className:"text-destructive flex items-center gap-2",children:[s.jsx(tn,{className:"w-5 h-5"}),"DATEGUARD SOS"]}),s.jsxs(tN,{className:"space-y-3",children:[s.jsx("p",{className:"font-semibold text-foreground",children:"This will immediately:"}),s.jsxs("ul",{className:"space-y-1 text-sm",children:[s.jsx("li",{children:" Alert ALL your guardians"}),s.jsx("li",{children:" Share your GPS location"}),s.jsx("li",{children:" Create time-stamped emergency record"}),s.jsx("li",{children:" Trigger emergency protocol"})]}),s.jsx("p",{className:"text-destructive font-semibold mt-4",children:"Only press if you are in real danger."})]})]}),s.jsxs(Jj,{children:[s.jsx(nN,{disabled:r,children:"Cancel"}),s.jsx(rN,{onClick:i,disabled:r,className:"bg-destructive hover:bg-destructive/90",children:r?"ACTIVATING DATEGUARD SOS...":" ACTIVATE DATEGUARD SOS"})]})]})})]})},q=w.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:me("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));q.displayName="Card";const ge=w.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:me("flex flex-col space-y-1.5 p-6",e),...t}));ge.displayName="CardHeader";const be=w.forwardRef(({className:e,...t},r)=>s.jsx("h3",{ref:r,className:me("text-2xl font-semibold leading-none tracking-tight",e),...t}));be.displayName="CardTitle";const Re=w.forwardRef(({className:e,...t},r)=>s.jsx("p",{ref:r,className:me("text-sm text-muted-foreground",e),...t}));Re.displayName="CardDescription";const ee=w.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:me("p-6 pt-0",e),...t}));ee.displayName="CardContent";const zE=w.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:me("flex items-center p-6 pt-0",e),...t}));zE.displayName="CardFooter";function Rwe(){const e=Oe(),[t,r]=w.useState(null),[n,a]=w.useState(!0),[i,o]=w.useState(0);w.useEffect(()=>{l()},[]),w.useEffect(()=>{if(t&&t.earningsThisMonth>0){const p=t.earningsThisMonth/30;let m=0;const v=setInterval(()=>{m+=p,m>=t.earningsThisMonth?(o(t.earningsThisMonth),clearInterval(v)):o(m)},1e3/30);return()=>clearInterval(v)}},[t]);const l=async()=>{try{const{data:{user:h}}=await T.auth.getUser();if(!h)return;const{data:f}=await T.from("referral_codes").select("tier, commission_rate").eq("user_id",h.id).single(),{data:p}=await T.from("referrals").select("subscription_status").eq("referrer_id",h.id),m=(p==null?void 0:p.length)||0,v=(p==null?void 0:p.filter(_=>_.subscription_status==="premium").length)||0,g=new Date,x=`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}`,{data:y}=await T.from("referral_earnings").select("amount").eq("referrer_id",h.id).eq("month_year",x),b=(y==null?void 0:y.reduce((_,S)=>_+Number(S.amount),0))||0,{data:N}=await T.from("referral_earnings").select("amount").eq("referrer_id",h.id),j=(N==null?void 0:N.reduce((_,S)=>_+Number(S.amount),0))||0;r({totalReferrals:m,premiumReferrals:v,activeReferrals:m,earningsThisMonth:b,earningsLifetime:j,tier:(f==null?void 0:f.tier)||"earlyaccess",commissionRate:Number(f==null?void 0:f.commission_rate)||0})}catch(h){console.error("Error fetching referral stats:",h)}finally{a(!1)}},c=async()=>{try{const{data:{user:h}}=await T.auth.getUser();if(!h)return;const{data:f}=await T.from("referral_codes").select("referral_code").eq("user_id",h.id).single();if(f!=null&&f.referral_code){const p=`${window.location.origin}?ref=${f.referral_code}`;await navigator.clipboard.writeText(p),H.success("Referral link copied to clipboard!")}}catch{H.error("Failed to copy link")}};if(n)return s.jsx("div",{className:"px-4 py-6",children:s.jsx(q,{className:"animate-pulse",children:s.jsx(ee,{className:"p-6",children:s.jsx("div",{className:"h-32 bg-muted rounded"})})})});if(!t)return null;const d=(()=>{switch(t.tier){case"founding":return{badge:"Founding Council ",rate:"10% for life",color:"text-yellow-500"};case"firstmover":return{badge:"First Mover ",rate:"5% for life",color:"text-gray-400"};default:return{badge:"Early Access",rate:"No commission",color:"text-blue-400"}}})();return t.totalReferrals===0?s.jsxs("div",{className:"px-4 py-6",children:[s.jsx("h2",{className:"text-xl font-bold text-foreground mb-4",children:" Earn Lifetime Commissions"}),s.jsx(q,{className:"bg-gradient-to-br from-cyan-600 to-blue-700 border-0 shadow-lg",children:s.jsxs(ee,{className:"p-6 text-center space-y-4",children:[s.jsx("div",{className:"text-6xl mb-2",children:""}),s.jsx("h3",{className:"text-2xl font-bold text-white",children:"GET STARTED NOW!"}),s.jsxs("div",{className:"bg-white/10 rounded-lg p-4 backdrop-blur-sm",children:[s.jsxs("p",{className:"text-white font-semibold text-lg mb-2",children:["YOU EARN ",d.rate.toUpperCase()]}),s.jsx("p",{className:`${d.color} font-bold text-sm`,children:d.badge})]}),s.jsxs("p",{className:"text-white/90 text-sm leading-relaxed",children:["Invite friends. They get verified safety. You earn $",(t.commissionRate*20).toFixed(2),"/month per Premium subscriber. Forever."]}),s.jsx("div",{className:"bg-white/10 rounded-lg p-3 backdrop-blur-sm",children:s.jsxs("p",{className:"text-white text-sm",children:[s.jsx("span",{className:"font-bold",children:"Example:"})," 10 friends = $",(t.commissionRate*200).toFixed(0),"/month = $",(t.commissionRate*2400).toFixed(0),"/year"]})}),s.jsx(L,{onClick:()=>e("/referrals"),size:"lg",className:"w-full bg-white text-cyan-600 hover:bg-white/90 font-bold text-lg h-14 mt-4",children:" START INVITING"}),s.jsx("button",{onClick:()=>e("/referrals/help"),className:"text-white/80 hover:text-white text-sm underline",children:"Learn How It Works "})]})})]}):t.premiumReferrals<5?s.jsxs("div",{className:"px-4 py-6",children:[s.jsx("h2",{className:"text-xl font-bold text-foreground mb-4",children:" Earn Lifetime Commissions"}),s.jsx(q,{className:"bg-gradient-to-br from-blue-600 to-cyan-600 border-0 shadow-lg",children:s.jsxs(ee,{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(kd,{className:"w-5 h-5 text-yellow-400"}),s.jsx("h3",{className:"text-xl font-bold text-white",children:"YOU'RE EARNING!"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"bg-white/10 rounded-lg p-3 backdrop-blur-sm",children:[s.jsxs("p",{className:"text-yellow-400 text-2xl font-bold",children:["$",i.toFixed(2)]}),s.jsx("p",{className:"text-white/70 text-xs",children:"/month"})]}),s.jsxs("div",{className:"bg-white/10 rounded-lg p-3 backdrop-blur-sm",children:[s.jsxs("p",{className:"text-yellow-400 text-2xl font-bold",children:["$",t.earningsLifetime.toFixed(2)]}),s.jsx("p",{className:"text-white/70 text-xs",children:"lifetime"})]})]}),s.jsxs("p",{className:"text-white text-sm",children:[t.activeReferrals," Active  ",t.premiumReferrals," Premium"]}),s.jsx("div",{className:"bg-white/10 rounded-lg p-3 backdrop-blur-sm",children:s.jsxs("p",{className:"text-white text-sm",children:[" Invite ",5-t.premiumReferrals," more friends to reach $",(5*t.commissionRate*20).toFixed(0),"/month!"]})}),s.jsxs(L,{onClick:()=>e("/referrals/invite-email"),className:"w-full bg-white text-blue-600 hover:bg-white/90 font-semibold",children:[s.jsx(ai,{className:"w-4 h-4 mr-2"}),"INVITE FRIENDS"]}),s.jsx("button",{onClick:()=>e("/referrals"),className:"text-white/80 hover:text-white text-sm underline w-full",children:" Full Dashboard "})]})})]}):t.premiumReferrals>=10?s.jsxs("div",{className:"px-4 py-6",children:[s.jsx("h2",{className:"text-xl font-bold text-foreground mb-4",children:" Referral Earnings"}),s.jsx(q,{className:"bg-gradient-to-br from-purple-600 to-blue-600 border-0 shadow-lg",children:s.jsxs(ee,{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(en,{className:"w-6 h-6 text-yellow-400 animate-pulse"}),s.jsx("h3",{className:"text-xl font-bold text-white",children:"TOP EARNER!"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"bg-white/10 rounded-lg p-4 backdrop-blur-sm",children:[s.jsxs("p",{className:"text-yellow-400 text-3xl font-bold",children:["$",i.toFixed(2)]}),s.jsx("p",{className:"text-white/70 text-xs",children:"/month"})]}),s.jsxs("div",{className:"bg-white/10 rounded-lg p-4 backdrop-blur-sm",children:[s.jsxs("p",{className:"text-yellow-400 text-3xl font-bold",children:["$",t.earningsLifetime.toFixed(2)]}),s.jsx("p",{className:"text-white/70 text-xs",children:"lifetime"})]})]}),s.jsxs("div",{className:"text-white text-sm space-y-1",children:[s.jsxs("p",{children:[t.activeReferrals," Active  ",t.premiumReferrals," Premium"]}),s.jsxs("p",{className:"text-yellow-400",children:[" ",d.badge]})]}),s.jsxs(L,{onClick:()=>e("/referrals"),className:"w-full bg-white text-purple-600 hover:bg-white/90 font-semibold h-12",children:[s.jsx(TD,{className:"w-4 h-4 mr-2"}),"FULL DASHBOARD"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs(L,{onClick:()=>e("/referrals/invite-email"),variant:"outline",size:"sm",className:"bg-white/10 text-white border-white/20 hover:bg-white/20",children:[s.jsx(ai,{className:"w-4 h-4 mr-1"}),"Invite"]}),s.jsxs(L,{onClick:()=>e("/referrals/invite-sms"),variant:"outline",size:"sm",className:"bg-white/10 text-white border-white/20 hover:bg-white/20",children:[s.jsx(Ed,{className:"w-4 h-4 mr-1"}),"SMS"]})]})]})})]}):s.jsxs("div",{className:"px-4 py-6",children:[s.jsx("h2",{className:"text-xl font-bold text-foreground mb-4",children:" Referral Earnings"}),s.jsx(q,{className:"bg-gradient-to-r from-cyan-600 to-blue-600 border-0",children:s.jsxs(ee,{className:"p-4",children:[s.jsx("div",{className:"flex items-center justify-between mb-3",children:s.jsxs("div",{className:"text-white",children:[s.jsxs("p",{className:"text-2xl font-bold",children:["$",t.earningsThisMonth.toFixed(2),"/mo"]}),s.jsxs("p",{className:"text-xs text-white/70",children:[t.activeReferrals," active  ",t.premiumReferrals," premium"]})]})}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs(L,{onClick:()=>e("/referrals"),size:"sm",className:"bg-white text-cyan-600 hover:bg-white/90",children:[s.jsx(TD,{className:"w-4 h-4 mr-1"}),"Stats"]}),s.jsxs(L,{onClick:()=>e("/referrals/invite-email"),size:"sm",className:"bg-white/10 text-white border-white/20 hover:bg-white/20",children:[s.jsx(ai,{className:"w-4 h-4 mr-1"}),"Email"]}),s.jsxs(L,{onClick:c,size:"sm",className:"bg-white/10 text-white border-white/20 hover:bg-white/20",children:[s.jsx(sg,{className:"w-4 h-4 mr-1"}),"Copy"]})]})]})})]})}var iO="Progress",oO=100,[Owe,pQe]=an(iO),[Iwe,Dwe]=Owe(iO),A9=w.forwardRef((e,t)=>{const{__scopeProgress:r,value:n=null,max:a,getValueLabel:i=Mwe,...o}=e;(a||a===0)&&!Z3(a)&&console.error($we(`${a}`,"Progress"));const l=Z3(a)?a:oO;n!==null&&!J3(n,l)&&console.error(Fwe(`${n}`,"Progress"));const c=J3(n,l)?n:null,u=gw(c)?i(c,l):void 0;return s.jsx(Iwe,{scope:r,value:c,max:l,children:s.jsx(Me.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":gw(c)?c:void 0,"aria-valuetext":u,role:"progressbar","data-state":R9(c,l),"data-value":c??void 0,"data-max":l,...o,ref:t})})});A9.displayName=iO;var P9="ProgressIndicator",T9=w.forwardRef((e,t)=>{const{__scopeProgress:r,...n}=e,a=Dwe(P9,r);return s.jsx(Me.div,{"data-state":R9(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...n,ref:t})});T9.displayName=P9;function Mwe(e,t){return`${Math.round(e/t*100)}%`}function R9(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function gw(e){return typeof e=="number"}function Z3(e){return gw(e)&&!isNaN(e)&&e>0}function J3(e,t){return gw(e)&&!isNaN(e)&&e<=t&&e>=0}function $we(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${oO}\`.`}function Fwe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${oO} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var O9=A9,Lwe=T9;const aN=w.forwardRef(({className:e,value:t,...r},n)=>s.jsx(O9,{ref:n,className:me("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:s.jsx(Lwe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));aN.displayName=O9.displayName;const Bwe=()=>{const e=Oe(),[t,r]=w.useState([]),[n,a]=w.useState(!0);w.useEffect(()=>{i()},[]);const i=async()=>{try{const{data:{user:d}}=await T.auth.getUser();if(!d)return;const{data:h}=await T.from("profiles").select("*").eq("id",d.id).single(),{data:f}=await T.from("provider_profiles").select("*").eq("user_id",d.id).maybeSingle(),{data:p}=await T.from("vai_verifications").select("*").eq("user_id",d.id).maybeSingle(),{data:m}=await T.from("user_payment_methods").select("*").eq("user_id",d.id).limit(1),{data:v}=await T.from("guardians").select("*").eq("user_id",d.id).limit(1),g=[{id:"basic_info",title:"Complete Basic Info",description:"Add your name and profile photo",completed:!!(h!=null&&h.full_name&&(h!=null&&h.avatar_url)),route:"/settings"},{id:"vai_verification",title:"Get V.A.I. Verified",description:"Complete your identity verification",completed:!!p,route:"/onboarding/success"},{id:"provider_profile",title:"Setup Provider Profile",description:"Add services and availability",completed:!!f&&f.profile_completion_percentage>=80,route:"/profile-creation"},{id:"payment_setup",title:"Add Payment Method",description:"Setup Vairipay for transactions",completed:!!m&&m.length>0,route:"/vairipay/setup"},{id:"dateguard_setup",title:"Setup DateGuard",description:"Add guardians for safety",completed:!!v&&v.length>0,route:"/dateguard/guardians"}];r(g)}catch(d){console.error("Error checking profile completion:",d),H.error("Failed to load profile completion status")}finally{a(!1)}},o=t.filter(d=>d.completed).length,l=t.length,c=l>0?o/l*100:0,u=o===l;return n?s.jsx(q,{children:s.jsx(ee,{className:"p-6",children:s.jsxs("div",{className:"animate-pulse space-y-3",children:[s.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),s.jsx("div",{className:"h-2 bg-muted rounded w-full"}),s.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]})})}):u?null:s.jsxs(q,{className:"border-primary/20 bg-gradient-to-br from-primary/5 to-transparent",children:[s.jsxs(ge,{children:[s.jsx("div",{className:"flex items-start justify-between",children:s.jsxs("div",{children:[s.jsxs(be,{className:"flex items-center gap-2",children:["Complete Your Profile",s.jsxs(xe,{variant:"secondary",children:[o,"/",l]})]}),s.jsx(Re,{children:"Unlock all features by completing your profile"})]})}),s.jsxs("div",{className:"mt-4",children:[s.jsx(aN,{value:c,className:"h-2"}),s.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[Math.round(c),"% complete"]})]})]}),s.jsx(ee,{children:s.jsx("div",{className:"space-y-2",children:t.map(d=>s.jsxs("button",{onClick:()=>e(d.route),className:"w-full flex items-center gap-3 p-3 rounded-lg hover:bg-accent transition-colors text-left group",children:[d.completed?s.jsx(EC,{className:"h-5 w-5 text-primary flex-shrink-0"}):s.jsx(cT,{className:"h-5 w-5 text-muted-foreground flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:`font-medium text-sm ${d.completed?"text-muted-foreground line-through":""}`,children:d.title}),s.jsx("p",{className:"text-xs text-muted-foreground truncate",children:d.description})]}),!d.completed&&s.jsx(Wp,{className:"h-4 w-4 text-muted-foreground group-hover:text-foreground transition-colors flex-shrink-0"})]},d.id))})})]})},I9=Hj,D9=nO,Uwe=Kj,M9=w.forwardRef(({className:e,...t},r)=>s.jsx(tm,{className:me("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));M9.displayName=tm.displayName;const Vwe=zp("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),lO=w.forwardRef(({side:e="right",className:t,children:r,...n},a)=>s.jsxs(Uwe,{children:[s.jsx(M9,{}),s.jsxs(rm,{ref:a,className:me(Vwe({side:e}),t),...n,children:[r,s.jsxs(Yj,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[s.jsx(vn,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));lO.displayName=rm.displayName;const cO=({className:e,...t})=>s.jsx("div",{className:me("flex flex-col space-y-2 text-center sm:text-left",e),...t});cO.displayName="SheetHeader";const uO=w.forwardRef(({className:e,...t},r)=>s.jsx(qx,{ref:r,className:me("text-lg font-semibold text-foreground",e),...t}));uO.displayName=qx.displayName;const zwe=w.forwardRef(({className:e,...t},r)=>s.jsx(Gx,{ref:r,className:me("text-sm text-muted-foreground",e),...t}));zwe.displayName=Gx.displayName;const e$="/assets/venice-bridge-B1FSl7U0.jpg";function Wwe(){const[e,t]=w.useState("");return w.useEffect(()=>{const r=new Date().getHours();r<12?t("Good morning"):r<18?t("Good afternoon"):t("Good evening")},[]),s.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[s.jsx(gwe,{}),s.jsxs("main",{className:"max-w-2xl mx-auto px-4 py-6 space-y-6 animate-fade-in",children:[s.jsx(Bwe,{}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("h1",{className:"text-2xl font-bold text-foreground",children:[" ",e,", Sarah"]}),s.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-2",children:["Founding Member Council  Rocket Base",s.jsx(xe,{variant:"secondary",className:"text-xs",children:"FOUNDING"})]})]}),s.jsxs(q,{className:"border-accent/20 bg-gradient-card shadow-lg",children:[s.jsx(ge,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"flex items-center gap-2 text-lg font-bold text-foreground",children:" Your Safety Status"}),s.jsx(xe,{className:"bg-success text-success-foreground",children:"Active"})]})}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"p-3 bg-background rounded-lg border border-border",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(ut,{className:"w-4 h-4 text-success"}),s.jsx("span",{className:"text-xs font-medium text-foreground",children:"V.A.I. VERIFIED"})]}),s.jsx("p",{className:"text-xs font-semibold text-foreground",children:"#9I7T35L"})]}),s.jsxs("div",{className:"p-3 bg-background rounded-lg border border-border",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(hr,{className:"w-4 h-4 text-yellow-500"}),s.jsx("span",{className:"text-xs font-medium text-foreground",children:"TrueRevu"})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"No reviews yet"})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs(L,{variant:"outline",className:"flex-col h-24 gap-1 justify-center",onClick:()=>window.location.href="/dateguard",children:[s.jsx(lt,{className:"w-5 h-5 text-accent"}),s.jsx("span",{className:"text-xs font-semibold",children:"DateGuard"}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"Set Up"})]}),s.jsxs(L,{className:"flex-col h-24 gap-1 justify-center bg-gradient-primary hover:opacity-90",onClick:()=>window.location.href="/vai-check",children:[s.jsx(Na,{className:"w-5 h-5"}),s.jsx("span",{className:"text-xs font-semibold",children:"VAI Check"}),s.jsx("span",{className:"text-xs opacity-80",children:"Verify ID"})]}),s.jsxs(L,{className:"flex-col h-24 gap-1 justify-center bg-gradient-to-br from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white",onClick:()=>window.location.href="/available-now",children:[s.jsx(hn,{className:"w-5 h-5"}),s.jsx("span",{className:"text-xs font-semibold",children:"Available Now"}),s.jsx("span",{className:"text-xs opacity-80",children:"Go Live"})]})]})]})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-foreground mb-3",children:" Social Hub"}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[s.jsxs(q,{className:"p-3 text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-foreground",children:"12"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Messages"})]}),s.jsxs(q,{className:"p-3 text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-foreground",children:"3"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Notifications"})]}),s.jsxs(q,{className:"p-3 text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-foreground",children:"5"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Requests"})]})]}),s.jsxs(I9,{children:[s.jsx(D9,{asChild:!0,children:s.jsxs(q,{className:"cursor-pointer animate-fade-in border-border overflow-hidden hover:border-primary/50 transition-colors mb-4",children:[s.jsx(ge,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-pink-500 to-purple-500"}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-semibold text-foreground flex items-center gap-1",children:["Jessica M.",s.jsx(ut,{className:"w-4 h-4 text-success"})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Venice, Italy  2h ago"})]})]}),s.jsx(L,{variant:"ghost",size:"sm",children:""})]})}),s.jsx("div",{className:"aspect-square relative overflow-hidden",children:s.jsx("img",{src:e$,alt:"Venice Bridge",className:"w-full h-full object-cover"})}),s.jsxs(ee,{className:"pt-3 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{className:"flex items-center gap-1 hover-scale",children:s.jsx(hr,{className:"w-5 h-5 text-foreground"})}),s.jsx("button",{className:"flex items-center gap-1 hover-scale",children:s.jsx(Ri,{className:"w-5 h-5 text-foreground"})}),s.jsx("button",{className:"flex items-center gap-1 hover-scale",children:s.jsx(en,{className:"w-5 h-5 text-foreground"})})]}),s.jsx(xe,{variant:"secondary",className:"text-xs",children:"Available Now"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-foreground",children:"342 likes"}),s.jsxs("p",{className:"text-sm text-foreground mt-1",children:[s.jsx("span",{className:"font-semibold",children:"Jessica M."})," Venice is nice this time of year "]}),s.jsx("button",{className:"text-xs text-muted-foreground mt-1",children:"View all 28 comments"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"2 HOURS AGO"})]})]}),s.jsx("p",{className:"text-xs text-center text-muted-foreground p-3 border-t",children:"Tap to see more posts"})]})}),s.jsxs(lO,{side:"bottom",className:"h-[95vh] p-0",children:[s.jsx(cO,{className:"p-4 border-b sticky top-0 bg-background z-10",children:s.jsx(uO,{children:"Social Feed"})}),s.jsxs("div",{className:"overflow-y-auto h-full pb-20 px-4 pt-4 space-y-4",children:[s.jsxs(q,{className:"animate-fade-in border-border overflow-hidden",children:[s.jsx(ge,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-pink-500 to-purple-500"}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-semibold text-foreground flex items-center gap-1",children:["Jessica M.",s.jsx(ut,{className:"w-4 h-4 text-success"})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Venice, Italy  2h ago"})]})]}),s.jsx(L,{variant:"ghost",size:"sm",children:""})]})}),s.jsx("div",{className:"aspect-square relative overflow-hidden",children:s.jsx("img",{src:e$,alt:"Venice Bridge",className:"w-full h-full object-cover"})}),s.jsxs(ee,{className:"pt-3 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{className:"flex items-center gap-1 hover-scale",children:s.jsx(hr,{className:"w-5 h-5 text-foreground"})}),s.jsx("button",{className:"flex items-center gap-1 hover-scale",children:s.jsx(Ri,{className:"w-5 h-5 text-foreground"})}),s.jsx("button",{className:"flex items-center gap-1 hover-scale",children:s.jsx(en,{className:"w-5 h-5 text-foreground"})})]}),s.jsx(xe,{variant:"secondary",className:"text-xs",children:"Available Now"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-foreground",children:"342 likes"}),s.jsxs("p",{className:"text-sm text-foreground mt-1",children:[s.jsx("span",{className:"font-semibold",children:"Jessica M."})," Venice is nice this time of year "]}),s.jsx("button",{className:"text-xs text-muted-foreground mt-1",children:"View all 28 comments"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"2 HOURS AGO"})]})]})]}),s.jsxs(q,{className:"animate-fade-in border-border overflow-hidden",children:[s.jsx(ge,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500"}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-semibold text-foreground flex items-center gap-1",children:["Sarah K.",s.jsx(ut,{className:"w-4 h-4 text-success"})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Miami, FL  5h ago"})]})]}),s.jsx(L,{variant:"ghost",size:"sm",children:""})]})}),s.jsx("div",{className:"aspect-square bg-gradient-to-br from-blue-400 to-cyan-400 relative",children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx(Na,{className:"w-16 h-16 text-white/30"})})}),s.jsxs(ee,{className:"pt-3 space-y-3",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{className:"flex items-center gap-1 hover-scale",children:s.jsx(hr,{className:"w-5 h-5 text-foreground"})}),s.jsx("button",{className:"flex items-center gap-1 hover-scale",children:s.jsx(Ri,{className:"w-5 h-5 text-foreground"})}),s.jsx("button",{className:"flex items-center gap-1 hover-scale",children:s.jsx(en,{className:"w-5 h-5 text-foreground"})})]})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-foreground",children:"234 likes"}),s.jsxs("p",{className:"text-sm text-foreground mt-1",children:[s.jsx("span",{className:"font-semibold",children:"Sarah K."})," Beach vibes  Perfect day in Miami!"]}),s.jsx("button",{className:"text-xs text-muted-foreground mt-1",children:"View all 45 comments"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"5 HOURS AGO"})]})]})]}),s.jsxs(q,{className:"animate-fade-in border-border overflow-hidden",children:[s.jsx(ge,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-green-500 to-emerald-500"}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-semibold text-foreground flex items-center gap-1",children:["Emma R.",s.jsx(ut,{className:"w-4 h-4 text-success"})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Los Angeles, CA  1d ago"})]})]}),s.jsx(L,{variant:"ghost",size:"sm",children:""})]})}),s.jsx("div",{className:"aspect-square bg-gradient-to-br from-green-400 to-emerald-400 relative",children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx(Na,{className:"w-16 h-16 text-white/30"})})}),s.jsxs(ee,{className:"pt-3 space-y-3",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{className:"flex items-center gap-1 hover-scale",children:s.jsx(hr,{className:"w-5 h-5 text-foreground"})}),s.jsx("button",{className:"flex items-center gap-1 hover-scale",children:s.jsx(Ri,{className:"w-5 h-5 text-foreground"})}),s.jsx("button",{className:"flex items-center gap-1 hover-scale",children:s.jsx(en,{className:"w-5 h-5 text-foreground"})})]})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-foreground",children:"189 likes"}),s.jsxs("p",{className:"text-sm text-foreground mt-1",children:[s.jsx("span",{className:"font-semibold",children:"Emma R."})," Just completed my 50th verified encounter! #VAIrify"]}),s.jsx("button",{className:"text-xs text-muted-foreground mt-1",children:"View all 31 comments"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"1 DAY AGO"})]})]})]})]})]})]}),s.jsxs(q,{className:"animate-fade-in border-accent/30 overflow-hidden bg-gradient-to-br from-primary/5 to-accent/5",children:[s.jsx(ge,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-primary flex items-center justify-center",children:s.jsx(lt,{className:"w-5 h-5 text-primary-foreground"})}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-semibold text-foreground flex items-center gap-1",children:["VAIrify Official",s.jsx(ut,{className:"w-4 h-4 text-primary"})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Announcement  2h ago"})]})]}),s.jsx(L,{variant:"ghost",size:"sm",children:""})]})}),s.jsx("div",{className:"relative bg-gradient-to-br from-primary/10 to-accent/10 p-8 flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("img",{src:Zi,alt:"VAIrify",className:"w-24 h-24 mx-auto object-contain"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-4xl font-bold text-foreground",children:"20,000+"}),s.jsx("p",{className:"text-lg text-muted-foreground mt-1",children:"Community Members"})]})]})}),s.jsxs(ee,{className:"pt-3 space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{className:"flex items-center gap-1 hover-scale",children:s.jsx(hr,{className:"w-5 h-5 text-foreground"})}),s.jsx("button",{className:"flex items-center gap-1 hover-scale",children:s.jsx(Ri,{className:"w-5 h-5 text-foreground"})}),s.jsx("button",{className:"flex items-center gap-1 hover-scale",children:s.jsx(en,{className:"w-5 h-5 text-foreground"})})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-foreground",children:"1.2K likes"}),s.jsxs("p",{className:"text-sm text-foreground mt-1",children:[s.jsx("span",{className:"font-semibold",children:"VAIrify Official"}),"  We've reached 20,000 community members! Thank you for trusting VAIrify to keep you safe."]})]})]})]})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-foreground mb-3",children:" Community Bulletin"}),s.jsx(q,{className:"border-border",children:s.jsxs(ee,{className:"p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start gap-3 pb-3 border-b border-border",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-primary mt-2 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-semibold text-foreground",children:"New Safety Features Released"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Enhanced DateGuard now includes real-time location sharing  2h ago"})]})]}),s.jsxs("div",{className:"flex items-start gap-3 pb-3 border-b border-border",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-accent mt-2 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-semibold text-foreground",children:"Community Milestone"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"10,000 verified encounters completed safely!  5h ago"})]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-success mt-2 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-semibold text-foreground",children:"Referral Program Update"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"New tier structure with increased commissions  1d ago"})]})]})]})})]}),s.jsx(Rwe,{}),s.jsx(q,{className:"hover-scale cursor-pointer border-2 border-purple-500/30 bg-gradient-to-br from-purple-600/10 to-pink-600/10 hover:border-purple-500 hover:shadow-lg transition-all group",onClick:()=>window.location.href="/apply/influencer",children:s.jsx(ee,{className:"py-4 px-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-600 to-pink-600 rounded-full flex items-center justify-center shadow-md group-hover:shadow-purple-500/50 transition-shadow flex-shrink-0",children:s.jsx(aj,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-bold text-foreground text-sm",children:"BECOME AN INFLUENCER"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:"Earn higher commissions & exclusive perks"})]}),s.jsx(en,{className:"w-5 h-5 text-purple-500 flex-shrink-0"})]})})})]}),s.jsx(Twe,{}),s.jsx(aO,{activeTab:"feed"})]})}const qwe=()=>{const e=Oe(),[t,r]=w.useState("intro"),[n,a]=w.useState(""),i=w.useRef(null),o=w.useRef(null);w.useEffect(()=>()=>{o.current&&o.current.getTracks().forEach(f=>f.stop())},[]);const l=()=>{const f="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let p="";for(let m=0;m<7;m++)p+=f.charAt(Math.floor(Math.random()*f.length));return p},c=async()=>{try{const f=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!1});i.current&&(i.current.srcObject=f,o.current=f),r("camera")}catch(f){console.error("Camera access error:",f),alert("Unable to access camera. Please ensure camera permissions are granted.")}},u=()=>{o.current&&(o.current.getTracks().forEach(f=>f.stop()),o.current=null),r("processing"),setTimeout(()=>{const f=l();a(f),r("success")},2e3)},d=()=>{e("/feed")},h=()=>{o.current&&(o.current.getTracks().forEach(f=>f.stop()),o.current=null),e("/login")};return s.jsx("div",{className:"min-h-screen bg-gradient-hero flex items-center justify-center px-4",children:s.jsx("div",{className:"w-full max-w-md",children:s.jsxs("div",{className:"bg-card rounded-2xl shadow-xl p-8",children:[t==="intro"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("button",{onClick:h,className:"flex items-center gap-2 text-primary hover:text-primary/80 transition-colors",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Back to Login"})]}),s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"w-20 h-20 mx-auto bg-primary/10 rounded-full flex items-center justify-center",children:s.jsx(Na,{className:"w-10 h-10 text-primary"})}),s.jsx("h2",{className:"text-foreground text-2xl font-semibold",children:"Create Your V.A.I."}),s.jsx("p",{className:"text-muted-foreground",children:"Take a quick selfie to create your verified identity"})]}),s.jsxs(L,{onClick:c,className:"w-full h-14 bg-gradient-primary hover:brightness-110 text-primary-foreground font-semibold",children:[s.jsx(Na,{className:"w-5 h-5 mr-2"}),"Start Camera"]}),s.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"We use your photo to create a secure, anonymous identity that protects your privacy"})]}),t==="camera"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-foreground text-xl font-semibold mb-2",children:"Position Your Face"}),s.jsx("p",{className:"text-muted-foreground text-sm",children:"Align your face within the circle"})]}),s.jsxs("div",{className:"relative aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[s.jsx("video",{ref:i,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),s.jsxs("div",{className:"absolute inset-0 flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/60"}),s.jsxs("div",{className:"relative z-10",children:[s.jsxs("div",{className:"relative w-64 h-64",children:[s.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 100 100",children:[s.jsx("circle",{cx:"50",cy:"50",r:"48",fill:"none",stroke:"hsl(var(--primary))",strokeWidth:"2",className:"opacity-80"}),s.jsx("circle",{cx:"50",cy:"50",r:"48",fill:"none",stroke:"hsl(var(--primary))",strokeWidth:"3",strokeDasharray:"75 225",strokeLinecap:"round",className:"animate-spin opacity-100",style:{transformOrigin:"center",animationDuration:"2s"}})]}),s.jsx("div",{className:"absolute top-4 left-4 w-6 h-6 border-l-3 border-t-3 border-primary rounded-tl-lg"}),s.jsx("div",{className:"absolute top-4 right-4 w-6 h-6 border-r-3 border-t-3 border-primary rounded-tr-lg"}),s.jsx("div",{className:"absolute bottom-4 left-4 w-6 h-6 border-l-3 border-b-3 border-primary rounded-bl-lg"}),s.jsx("div",{className:"absolute bottom-4 right-4 w-6 h-6 border-r-3 border-b-3 border-primary rounded-br-lg"})]}),s.jsx("div",{className:"absolute -bottom-12 left-1/2 transform -translate-x-1/2 whitespace-nowrap",children:s.jsx("span",{className:"text-white text-sm font-medium bg-black/70 px-4 py-2 rounded-full border border-primary/30",children:"Position face in circle"})})]})]})]}),s.jsxs(L,{onClick:u,className:"w-full h-14 bg-gradient-primary hover:brightness-110 text-primary-foreground font-semibold",children:[s.jsx(Na,{className:"w-5 h-5 mr-2"}),"CAPTURE PHOTO"]}),s.jsx("button",{onClick:h,className:"w-full text-center text-sm text-muted-foreground hover:text-foreground transition-colors",children:"Cancel"})]}),t==="processing"&&s.jsxs("div",{className:"py-12 text-center space-y-6",children:[s.jsx("div",{className:"w-20 h-20 mx-auto border-4 border-primary border-t-transparent rounded-full animate-spin"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-foreground text-xl font-semibold mb-2",children:"Processing..."}),s.jsx("p",{className:"text-muted-foreground",children:"Creating your V.A.I..."})]})]}),t==="success"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"w-20 h-20 mx-auto bg-green-500/10 rounded-full flex items-center justify-center",children:s.jsx($t,{className:"w-10 h-10 text-green-500"})}),s.jsx("h2",{className:"text-foreground text-2xl font-semibold",children:" V.A.I. Created!"})]}),s.jsxs("div",{className:"bg-muted rounded-xl p-6 space-y-3",children:[s.jsx("p",{className:"text-muted-foreground text-sm text-center",children:"Your V.A.I. Number:"}),s.jsx("p",{className:"text-foreground text-3xl font-mono font-bold text-center tracking-wider",children:n})]}),s.jsxs("div",{className:"bg-primary/5 border border-primary/20 rounded-lg p-4",children:[s.jsx("p",{className:"text-foreground text-sm font-medium mb-1",children:" Save this number"}),s.jsx("p",{className:"text-muted-foreground text-sm",children:"Use it to login securely. You can also find it on your dashboard."})]}),s.jsx(L,{onClick:d,className:"w-full h-14 bg-gradient-primary hover:brightness-110 text-primary-foreground font-semibold",children:"Continue to App"})]})]})})})},Gwe=()=>{const e=Oe(),t=[{icon:"",title:"DateGuard",description:"Your protection - your people - your way",isCustomIcon:!1},{icon:"check",title:"VAI-CHECK",description:"In-person verification instantly",isCustomIcon:!0},{icon:"",title:"TruRevu",description:"Accurate unfakeable reviews",isCustomIcon:!1}];return s.jsxs("div",{className:"min-h-screen bg-gradient-hero flex flex-col items-center justify-center p-4 relative overflow-hidden",children:[s.jsx("button",{onClick:()=>e("/onboarding/language"),className:"absolute top-6 right-6 z-20 bg-white/10 backdrop-blur-sm rounded-full p-3 border border-white/20 hover:bg-white/20 transition-all duration-300 hover:scale-110 group","aria-label":"Select language",children:s.jsx(So,{className:"w-6 h-6 text-white group-hover:rotate-12 transition-transform duration-300"})}),s.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[s.jsx("div",{className:"absolute top-20 left-10 w-32 h-32 bg-primary-light/10 rounded-full blur-3xl animate-float",style:{animationDelay:"0s"}}),s.jsx("div",{className:"absolute bottom-20 right-10 w-40 h-40 bg-primary-light/10 rounded-full blur-3xl animate-float",style:{animationDelay:"1s"}}),s.jsx("div",{className:"absolute top-1/2 left-1/4 w-24 h-24 bg-primary-light/10 rounded-full blur-3xl animate-float",style:{animationDelay:"2s"}})]}),s.jsxs("div",{className:"w-full max-w-lg relative z-10 animate-fade-in",children:[s.jsx("div",{className:"text-center mb-12",children:s.jsx("div",{className:"flex items-center justify-center mb-6",children:s.jsx("img",{src:Zi,alt:"VAIRIFY",className:"w-52 h-52 md:w-64 md:h-64"})})}),s.jsxs("div",{className:"text-center space-y-6 mb-12",children:[s.jsxs("h1",{className:"text-5xl md:text-6xl font-bold text-white leading-tight",children:["Stop Hoping.",s.jsx("br",{}),"Start Knowing."]}),s.jsx("p",{className:"text-xl text-white/90 max-w-md mx-auto",children:"The first platform with V.A.I. verified anonymous identity for every encounter."}),s.jsx("p",{className:"text-lg text-white/80 font-semibold tracking-wide",children:"Verified - Anonymous - Accountable"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-12",children:t.map((r,n)=>s.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-2xl p-6 text-center border border-white/20 hover:bg-white/15 transition-all duration-300 animate-slide-up",style:{animationDelay:`${n*.1}s`},children:[s.jsx("div",{className:"mb-3 flex justify-center",children:r.isCustomIcon?s.jsx($t,{className:"w-10 h-10 text-[#00FF00]",strokeWidth:4}):s.jsx("span",{className:"text-4xl",children:r.icon})}),s.jsx("h3",{className:"text-white font-semibold text-lg mb-1",children:r.title}),s.jsx("p",{className:"text-white/80 text-sm",children:r.description})]},n))}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(L,{onClick:()=>e("/onboarding/registration"),size:"lg",className:"w-full h-14 text-lg font-semibold bg-white text-primary hover:bg-white/90 transition-all duration-300 hover:scale-105",children:"Get Started"}),s.jsxs("button",{onClick:()=>e("/login"),className:"w-full text-white/90 hover:text-white text-sm transition-colors",children:["Already have an account? ",s.jsx("span",{className:"underline font-semibold",children:"Login"})]})]})]})]})},Hwe=()=>{const e=Oe();return w.useEffect(()=>{e("/onboarding/registration",{replace:!0})},[e]),null},Kwe=()=>{const e=Oe(),t=r=>{sessionStorage.setItem("vairify_role",r),e("/onboarding/registration")};return s.jsxs("div",{className:"min-h-screen bg-gradient-hero flex flex-col",children:[s.jsxs("div",{className:"p-6 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/onboarding/language"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-6 h-6"})}),s.jsx("div",{className:"flex items-center",children:s.jsx("img",{src:Zi,alt:"VAIRIFY",className:"w-30 h-30 md:w-48 md:h-48"})}),s.jsx("div",{className:"w-10"})]}),s.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:s.jsxs("div",{className:"w-full max-w-4xl animate-fade-in",children:[s.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white text-center mb-4",children:"I Am Looking To Use"}),s.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-white text-center mb-16",children:"Vairify As:"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 max-w-3xl mx-auto",children:[s.jsxs("button",{onClick:()=>t("provider"),className:"group bg-white/10 backdrop-blur-sm rounded-3xl p-10 border-2 border-white/20 hover:bg-white/20 hover:border-white/40 hover:scale-105 transition-all duration-300 animate-slide-up",children:[s.jsx("div",{className:"bg-white/20 rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform",children:s.jsx(fn,{className:"w-10 h-10 text-white"})}),s.jsx("h3",{className:"text-2xl font-bold text-white mb-3",children:"Provider"}),s.jsx("p",{className:"text-white/80 text-lg",children:"Offer services, build reputation, stay safe"})]}),s.jsxs("button",{onClick:()=>t("client"),className:"group bg-white/10 backdrop-blur-sm rounded-3xl p-10 border-2 border-white/20 hover:bg-white/20 hover:border-white/40 hover:scale-105 transition-all duration-300 animate-slide-up",style:{animationDelay:"0.1s"},children:[s.jsx("div",{className:"bg-white/20 rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform",children:s.jsx(Cl,{className:"w-10 h-10 text-white"})}),s.jsx("h3",{className:"text-2xl font-bold text-white mb-3",children:"Client/Hobbyist"}),s.jsx("p",{className:"text-white/80 text-lg",children:"Find verified providers, book safely"})]})]})]})})]})},Ywe="modulepreload",Xwe=function(e){return"/"+e},t$={},Qwe=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=Xwe(c),c in t$)return;t$[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":Ywe,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})};var Zwe="Label",$9=w.forwardRef((e,t)=>s.jsx(Me.label,{...e,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));$9.displayName=Zwe;var F9=$9;const Jwe=zp("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),de=w.forwardRef(({className:e,...t},r)=>s.jsx(F9,{ref:r,className:me(Jwe(),e),...t}));de.displayName=F9.displayName;function sN(e){const t=w.useRef({value:e,previous:e});return w.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var iN="Checkbox",[e1e,mQe]=an(iN),[t1e,dO]=e1e(iN);function r1e(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:a,disabled:i,form:o,name:l,onCheckedChange:c,required:u,value:d="on",internal_do_not_use_render:h}=e,[f,p]=Ba({prop:r,defaultProp:a??!1,onChange:c,caller:iN}),[m,v]=w.useState(null),[g,x]=w.useState(null),y=w.useRef(!1),b=m?!!o||!!m.closest("form"):!0,N={checked:f,disabled:i,setChecked:p,control:m,setControl:v,name:l,form:o,value:d,hasConsumerStoppedPropagationRef:y,required:u,defaultChecked:qc(a)?!1:a,isFormControl:b,bubbleInput:g,setBubbleInput:x};return s.jsx(t1e,{scope:t,...N,children:n1e(h)?h(N):n})}var L9="CheckboxTrigger",B9=w.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},a)=>{const{control:i,value:o,disabled:l,checked:c,required:u,setControl:d,setChecked:h,hasConsumerStoppedPropagationRef:f,isFormControl:p,bubbleInput:m}=dO(L9,e),v=ct(a,d),g=w.useRef(c);return w.useEffect(()=>{const x=i==null?void 0:i.form;if(x){const y=()=>h(g.current);return x.addEventListener("reset",y),()=>x.removeEventListener("reset",y)}},[i,h]),s.jsx(Me.button,{type:"button",role:"checkbox","aria-checked":qc(c)?"mixed":c,"aria-required":u,"data-state":q9(c),"data-disabled":l?"":void 0,disabled:l,value:o,...n,ref:v,onKeyDown:Ne(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:Ne(r,x=>{h(y=>qc(y)?!0:!y),m&&p&&(f.current=x.isPropagationStopped(),f.current||x.stopPropagation())})})});B9.displayName=L9;var hO=w.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:a,defaultChecked:i,required:o,disabled:l,value:c,onCheckedChange:u,form:d,...h}=e;return s.jsx(r1e,{__scopeCheckbox:r,checked:a,defaultChecked:i,disabled:l,required:o,onCheckedChange:u,name:n,form:d,value:c,internal_do_not_use_render:({isFormControl:f})=>s.jsxs(s.Fragment,{children:[s.jsx(B9,{...h,ref:t,__scopeCheckbox:r}),f&&s.jsx(W9,{__scopeCheckbox:r})]})})});hO.displayName=iN;var U9="CheckboxIndicator",V9=w.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...a}=e,i=dO(U9,r);return s.jsx(gn,{present:n||qc(i.checked)||i.checked===!0,children:s.jsx(Me.span,{"data-state":q9(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});V9.displayName=U9;var z9="CheckboxBubbleInput",W9=w.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:a,checked:i,defaultChecked:o,required:l,disabled:c,name:u,value:d,form:h,bubbleInput:f,setBubbleInput:p}=dO(z9,e),m=ct(r,p),v=sN(i),g=hj(n);w.useEffect(()=>{const y=f;if(!y)return;const b=window.HTMLInputElement.prototype,j=Object.getOwnPropertyDescriptor(b,"checked").set,_=!a.current;if(v!==i&&j){const S=new Event("click",{bubbles:_});y.indeterminate=qc(i),j.call(y,qc(i)?!1:i),y.dispatchEvent(S)}},[f,v,i,a]);const x=w.useRef(qc(i)?!1:i);return s.jsx(Me.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??x.current,required:l,disabled:c,name:u,value:d,form:h,...t,tabIndex:-1,ref:m,style:{...t.style,...g,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});W9.displayName=z9;function n1e(e){return typeof e=="function"}function qc(e){return e==="indeterminate"}function q9(e){return qc(e)?"indeterminate":e?"checked":"unchecked"}const Al=w.forwardRef(({className:e,...t},r)=>s.jsx(hO,{ref:r,className:me("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:s.jsx(V9,{className:me("flex items-center justify-center text-current"),children:s.jsx($t,{className:"h-4 w-4"})})}));Al.displayName=hO.displayName;const a1e=()=>{const e=Oe(),[t,r]=w.useState(!1),[n,a]=w.useState(!1),[i,o]=w.useState({email:"",password:"",referralVAI:"",couponCode:"",termsAccepted:!1,hasExistingVAI:!1,existingVAINumber:""}),[l,c]=w.useState(!1),[u,d]=w.useState({}),[h,f]=w.useState({}),[p,m]=w.useState({strength:"weak",score:0,checks:{minLength:!1,hasUppercase:!1,hasNumber:!1}}),v=N=>{const j={minLength:N.length>=8,hasUppercase:/[A-Z]/.test(N),hasNumber:/\d/.test(N)},_=Object.values(j).filter(Boolean).length;let S="weak";return _===3?S="strong":_===2&&(S="medium"),{strength:S,score:_,checks:j}},g=(N,j)=>{switch(N){case"email":if(!j)return"Email is required";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(j))return"Please enter a valid email address";break;case"password":if(!j)return"Password is required";if(j.length<8)return"Password must be at least 8 characters";if(!/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(j))return"Password must contain uppercase, lowercase, and number";break;case"referralVAI":if(j&&!/^[A-Z0-9]{7}$/.test(j))return"V.A.I. codes are 7 characters (letters and numbers only)";break;case"couponCode":if(j&&!/^[A-Z]{2}\d{4}$/.test(j))return"Coupon format: 2 letters + 4 digits (e.g., FC0001)";break;case"existingVAINumber":if(i.hasExistingVAI&&!j)return"Please enter your VAI number";if(i.hasExistingVAI&&j&&!/^[A-Z0-9]{7,}$/.test(j))return"VAI number format is invalid";break;case"termsAccepted":if(!j)return"You must agree to the Terms of Service";break}},x=N=>{const{name:j,value:_}=N.target;if(o(S=>({...S,[j]:_})),j==="password"&&m(v(_)),h[j]){const S=g(j,_);d(C=>({...C,[j]:S}))}},y=N=>{f(_=>({..._,[N]:!0}));const j=g(N,i[N]);d(_=>({..._,[N]:j}))},b=async N=>{N.preventDefault();const j={};if(Object.keys(i).forEach(_=>{const S=g(_,i[_]);S&&(j[_]=S)}),Object.keys(j).length>0){d(j),f(Object.keys(i).reduce((_,S)=>({..._,[S]:!0}),{})),H.error("Please fix the errors in the form");return}a(!0);try{const{supabase:_}=await Qwe(async()=>{const{supabase:A}=await Promise.resolve().then(()=>mde);return{supabase:A}},void 0),{data:S,error:C}=await _.from("signup_sessions").insert({email:i.email,referral_vai:i.referralVAI||null,coupon_code:i.couponCode||null,has_existing_vai:i.hasExistingVAI,existing_vai_number:i.hasExistingVAI?i.existingVAINumber:null}).select("session_id").single();if(C)throw console.error("Failed to create signup session:",C),new Error("Failed to create session. Please try again.");if(!(S!=null&&S.session_id))throw new Error("Session creation failed. Please try again.");const E=S.session_id;if(i.hasExistingVAI&&i.existingVAINumber){c(!0);try{const{data:A,error:O}=await _.functions.invoke("check-vai-requirements",{body:{vai_number:i.existingVAINumber.toUpperCase(),session_id:E}});if(O)throw O;if(!(A!=null&&A.success))throw new Error((A==null?void 0:A.error)||"Failed to check VAI requirements");const I=A.status;if(await _.from("signup_sessions").update({password_hash:i.password}).eq("session_id",E),sessionStorage.setItem("vairify_user",JSON.stringify(i)),sessionStorage.setItem("signup_session_id",E),sessionStorage.setItem("vai_status",I),sessionStorage.setItem("existing_vai_number",i.existingVAINumber.toUpperCase()),i.couponCode&&sessionStorage.setItem("founding_coupon",i.couponCode),I==="fully_qualified"){H.success("VAI verified! Sending verification code...");const{data:R,error:M}=await _.functions.invoke("send-verification-otp",{body:{email:i.email,resend:!1}});if(M)throw M;e("/onboarding/verify-otp");return}else if(I==="missing_requirements"){H.info("VAI found but missing requirements. Redirecting to ChainPass...");const R=`https://chainpass.com/complete-requirements?session_id=${E}&vai=${i.existingVAINumber.toUpperCase()}`;window.location.href=R;return}else H.warning("VAI not found. Proceeding with new VAI creation...")}catch(A){console.error("VAI check error:",A),H.error(A.message||"Failed to verify VAI. Proceeding with new VAI creation...")}finally{c(!1)}}await _.from("signup_sessions").update({password_hash:i.password}).eq("session_id",E);const{data:k,error:P}=await _.functions.invoke("send-verification-otp",{body:{email:i.email,resend:!1}});if(P)throw P;sessionStorage.setItem("vairify_user",JSON.stringify(i)),sessionStorage.setItem("signup_session_id",E),i.couponCode&&sessionStorage.setItem("founding_coupon",i.couponCode),H.success("Verification code sent! Please check your email."),e("/onboarding/verify-otp")}catch(_){console.error("Registration error:",_),H.error(_.message||"Failed to send verification code. Please try again.")}finally{a(!1),c(!1)}};return s.jsxs("div",{className:"min-h-screen bg-gradient-hero flex flex-col",children:[s.jsxs("div",{className:"p-6 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/onboarding/role"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-6 h-6"})}),s.jsx("div",{className:"flex items-center",children:s.jsx("img",{src:Zi,alt:"VAIRIFY",className:"w-30 h-30 md:w-48 md:h-48"})}),s.jsx("div",{className:"w-10"})]}),s.jsx("div",{className:"flex-1 flex items-center justify-center p-6 overflow-y-auto",children:s.jsxs("div",{className:"w-full max-w-md animate-fade-in",children:[s.jsx("h1",{className:"text-4xl font-bold text-white text-center mb-8",children:"Create Your Account"}),s.jsxs("form",{onSubmit:b,className:"space-y-6 bg-white/10 backdrop-blur-sm rounded-3xl p-8 border border-white/20",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"email",className:"text-white text-base",children:"Email"}),s.jsxs("div",{className:"relative",children:[s.jsx(De,{id:"email",name:"email",type:"email",value:i.email,onChange:x,onBlur:()=>y("email"),className:"h-12 bg-white/20 border-white/30 text-white placeholder:text-white/50 focus:bg-white/25",placeholder:"your@email.com"}),h.email&&!u.email&&i.email&&s.jsx($t,{className:"absolute right-3 top-3 w-5 h-5 text-green-400"})]}),h.email&&u.email&&s.jsxs("p",{className:"text-red-300 text-sm flex items-center gap-1",children:[s.jsx(Xs,{className:"w-4 h-4"}),u.email]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(de,{htmlFor:"password",className:"text-white text-base",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(De,{id:"password",name:"password",type:t?"text":"password",value:i.password,onChange:x,onBlur:()=>y("password"),className:"h-12 bg-white/20 border-white/30 text-white placeholder:text-white/50 focus:bg-white/25 pr-12",placeholder:"Min 8 characters"}),s.jsx("button",{type:"button",onClick:()=>r(!t),className:"absolute right-3 top-3 text-white/70 hover:text-white",children:t?s.jsx(P0,{className:"w-5 h-5"}):s.jsx(Ri,{className:"w-5 h-5"})})]}),i.password&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-[2px]",children:[s.jsx("div",{className:"h-1 flex-1 rounded-full transition-all duration-300",style:{backgroundColor:p.score>=1?p.strength==="weak"?"#ef4444":p.strength==="medium"?"#f59e0b":"#10b981":"rgba(255, 255, 255, 0.1)"}}),s.jsx("div",{className:"h-1 flex-1 rounded-full transition-all duration-300",style:{backgroundColor:p.score>=2?p.strength==="medium"?"#f59e0b":p.strength==="strong"?"#10b981":"rgba(255, 255, 255, 0.1)":"rgba(255, 255, 255, 0.1)"}}),s.jsx("div",{className:"h-1 flex-1 rounded-full transition-all duration-300",style:{backgroundColor:p.score===3?"#10b981":"rgba(255, 255, 255, 0.1)"}})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center transition-all duration-200 ${p.checks.minLength?"bg-[#10b981] border-[#10b981] scale-100":"border-[#9ca3af] scale-80"}`,children:p.checks.minLength&&s.jsx($t,{className:"w-3 h-3 text-white",strokeWidth:3})}),s.jsx("span",{className:"text-sm transition-colors duration-200",style:{color:p.checks.minLength?"#10b981":"#9ca3af"},children:"At least 8 characters"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center transition-all duration-200 ${p.checks.hasUppercase?"bg-[#10b981] border-[#10b981] scale-100":"border-[#9ca3af] scale-80"}`,children:p.checks.hasUppercase&&s.jsx($t,{className:"w-3 h-3 text-white",strokeWidth:3})}),s.jsx("span",{className:"text-sm transition-colors duration-200",style:{color:p.checks.hasUppercase?"#10b981":"#9ca3af"},children:"One uppercase letter"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center transition-all duration-200 ${p.checks.hasNumber?"bg-[#10b981] border-[#10b981] scale-100":"border-[#9ca3af] scale-80"}`,children:p.checks.hasNumber&&s.jsx($t,{className:"w-3 h-3 text-white",strokeWidth:3})}),s.jsx("span",{className:"text-sm transition-colors duration-200",style:{color:p.checks.hasNumber?"#10b981":"#9ca3af"},children:"One number"})]})]})]}),h.password&&u.password&&s.jsxs("p",{className:"text-red-300 text-sm flex items-center gap-1",children:[s.jsx(Xs,{className:"w-4 h-4"}),u.password]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"couponCode",className:"text-white text-lg font-bold",children:"Founding Member Coupon Code"}),s.jsx(De,{id:"couponCode",name:"couponCode",value:i.couponCode,onChange:N=>{const j=N.target.value.toUpperCase();if(o(_=>({..._,couponCode:j})),h.couponCode){const _=g("couponCode",j);d(S=>({...S,couponCode:_}))}},onBlur:()=>y("couponCode"),className:"h-12 bg-white/20 border-white/30 text-white dark:text-white placeholder:text-white/50 focus:bg-white/25 text-base font-semibold",placeholder:"FC0001 / FM1001 / EA3001",maxLength:6}),h.couponCode&&u.couponCode&&s.jsxs("p",{className:"text-red-300 text-sm flex items-center gap-1",children:[s.jsx(Xs,{className:"w-4 h-4"}),u.couponCode]})]}),s.jsxs("div",{className:"space-y-3 p-4 bg-white/5 rounded-xl border border-white/10",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Al,{id:"hasExistingVAI",checked:i.hasExistingVAI,onCheckedChange:N=>{o(j=>({...j,hasExistingVAI:N,existingVAINumber:N?j.existingVAINumber:""})),f(j=>({...j,hasExistingVAI:!0}))},className:"mt-1 bg-white/20 border-white/30 data-[state=checked]:bg-white data-[state=checked]:text-primary"}),s.jsx("label",{htmlFor:"hasExistingVAI",className:"text-white/90 text-sm leading-relaxed cursor-pointer flex-1",children:"I have a VAI number from another platform"})]}),i.hasExistingVAI&&s.jsxs("div",{className:"space-y-2 mt-3",children:[s.jsxs(de,{htmlFor:"existingVAINumber",className:"text-white text-sm",children:["Your VAI Number ",s.jsx("span",{className:"text-white/70",children:"(from ChainPass or another platform)"})]}),s.jsx(De,{id:"existingVAINumber",name:"existingVAINumber",value:i.existingVAINumber,onChange:N=>{const j=N.target.value.toUpperCase().replace(/[^A-Z0-9]/g,"");if(o(_=>({..._,existingVAINumber:j})),h.existingVAINumber){const _=g("existingVAINumber",j);d(S=>({...S,existingVAINumber:_}))}},onBlur:()=>y("existingVAINumber"),className:"h-12 bg-white/20 border-white/30 text-white placeholder:text-white/50 focus:bg-white/25 font-mono",placeholder:"Enter your VAI number",maxLength:20}),h.existingVAINumber&&u.existingVAINumber&&s.jsxs("p",{className:"text-red-300 text-sm flex items-center gap-1",children:[s.jsx(Xs,{className:"w-4 h-4"}),u.existingVAINumber]}),s.jsx("p",{className:"text-xs text-white/60",children:"We'll verify your VAI and check if any additional requirements are needed."})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(de,{htmlFor:"referralVAI",className:"text-white text-base",children:"Referral V.A.I. (Optional)"}),s.jsxs("div",{className:"group relative",children:[s.jsx(iz,{className:"w-4 h-4 text-white/70 cursor-help"}),s.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-[280px] bg-[#1f2937] text-white text-sm rounded-lg p-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10",style:{boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:"If someone referred you, enter their V.A.I. code. You'll both earn revenue share benefits."})]})]}),s.jsx(De,{id:"referralVAI",name:"referralVAI",value:i.referralVAI,onChange:x,onBlur:()=>y("referralVAI"),className:"h-12 bg-white/20 border-white/30 text-white placeholder:text-white/50 focus:bg-white/25",placeholder:"Example: 9I7T35L",maxLength:7}),h.referralVAI&&u.referralVAI&&s.jsxs("p",{className:"text-red-300 text-sm flex items-center gap-1",children:[s.jsx(Xs,{className:"w-4 h-4"}),u.referralVAI]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Al,{id:"terms",checked:i.termsAccepted,onCheckedChange:N=>{o(j=>({...j,termsAccepted:N})),f(j=>({...j,termsAccepted:!0}))},className:"mt-1 bg-white/20 border-white/30 data-[state=checked]:bg-white data-[state=checked]:text-primary"}),s.jsxs("label",{htmlFor:"terms",className:"text-white/90 text-sm leading-relaxed cursor-pointer",children:["I have read and agree to the"," ",s.jsx("a",{href:"/terms",className:"underline hover:text-white",children:"Terms of Service"})," and"," ",s.jsx("a",{href:"/privacy",className:"underline hover:text-white",children:"Privacy Policy"}),", and confirm I am at least 18 years of age"]})]}),h.termsAccepted&&u.termsAccepted&&s.jsxs("p",{className:"text-red-300 text-sm flex items-center gap-1",children:[s.jsx(Xs,{className:"w-4 h-4"}),u.termsAccepted]})]}),s.jsx(L,{type:"submit",disabled:n||l,className:"w-full h-14 text-lg font-semibold bg-white text-primary hover:bg-white/90 transition-all duration-300 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:l?"Verifying VAI...":n?"Creating Account...":"Create Account"}),s.jsxs("button",{type:"button",onClick:()=>e("/login"),className:"w-full text-white/90 hover:text-white text-sm transition-colors",children:["Already have an account? ",s.jsx("span",{className:"underline font-semibold",children:"Login"})]}),s.jsx("p",{className:"w-full text-center text-sm text-white/60 mt-4",children:" Language: English (Change in Settings)"})]})]})})]})},s1e=()=>{const e=Oe(),[t,r]=w.useState(["","","","","",""]),[n,a]=w.useState(!1),[i,o]=w.useState(null),[l,c]=w.useState("");w.useEffect(()=>{const m=sessionStorage.getItem("signup_session_id"),v=sessionStorage.getItem("vairify_user");if(m&&o(m),v)try{const g=JSON.parse(v);c(g.email||"")}catch(g){console.error("Error parsing stored user data:",g)}},[]);const u=(m,v)=>{if(v.length>1||!/^\d*$/.test(v))return;const g=[...t];if(g[m]=v,r(g),v&&m<5){const x=document.getElementById(`otp-${m+1}`);x==null||x.focus()}},d=(m,v)=>{if(v.key==="Backspace"&&!t[m]&&m>0){const g=document.getElementById(`otp-${m-1}`);g==null||g.focus()}},h=m=>{var g;m.preventDefault();const v=m.clipboardData.getData("text").slice(0,6);if(/^\d{6}$/.test(v)){const x=v.split("");r(x),(g=document.getElementById("otp-5"))==null||g.focus()}},f=async m=>{var g;m.preventDefault();const v=t.join("");if(v.length!==6){H.error("Please enter the complete 6-digit code");return}a(!0);try{const{data:x,error:y}=await T.functions.invoke("verify-otp",{body:{email:l,otp:v}});if(y)throw y;if(!(x!=null&&x.success))throw new Error((x==null?void 0:x.error)||"Invalid verification code");if(!i)throw new Error("Session ID not found. Please start over.");const{data:b,error:N}=await T.from("signup_sessions").select("*").eq("session_id",i).single();if(N||!b)throw new Error("Failed to retrieve signup data. Please start over.");const{data:{user:j,session:_}}=await T.auth.getUser();if(!j||!_){const{data:E,error:k}=await T.auth.signInWithPassword({email:l,password:b.password_hash||""});if(k||!(E!=null&&E.session)){const{data:P,error:A}=await T.auth.signUp({email:l,password:b.password_hash||"",options:{emailRedirectTo:`${window.location.origin}/onboarding/success`,data:{session_id:i}}});if(A)throw console.error("Sign up error:",A),new Error(A.message||"Failed to create account. Please try again.");if(!(P!=null&&P.user))throw new Error("Account creation failed. Please try again.");const{data:O,error:I}=await T.auth.signInWithPassword({email:l,password:b.password_hash||""});I&&console.error("Final sign in error:",I);const{data:{session:R}}=await T.auth.getSession();R||console.warn("No session created. User may need to sign in manually.")}}const S=sessionStorage.getItem("vai_status"),C=sessionStorage.getItem("existing_vai_number");S==="fully_qualified"&&C?(H.success("Email verified! Linking your existing VAI..."),e(`/onboarding/vai-callback?session_id=${i}`)):S==="missing_requirements"?(H.success("Email verified! Redirecting to ChainPass..."),e(`/onboarding/vai-callback?session_id=${i}`)):(H.success("Email verified! Account created successfully."),e(`/onboarding/success?session_id=${i}`))}catch(x){console.error("OTP verification error:",x),H.error(x.message||"Invalid verification code. Please try again."),r(["","","","","",""]),(g=document.getElementById("otp-0"))==null||g.focus()}finally{a(!1)}},p=async()=>{var m;if(!l){H.error("Email not found. Please start over."),e("/onboarding/registration");return}try{const{data:v,error:g}=await T.functions.invoke("send-verification-otp",{body:{email:l,resend:!0}});if(g)throw g;H.success("Verification code resent! Please check your email."),r(["","","","","",""]),(m=document.getElementById("otp-0"))==null||m.focus()}catch(v){console.error("Resend error:",v),H.error(v.message||"Failed to resend code. Please try again.")}};return s.jsxs("div",{className:"min-h-screen bg-gradient-hero flex flex-col",children:[s.jsxs("div",{className:"p-6 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/onboarding/registration"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-6 h-6"})}),s.jsx("div",{className:"flex items-center",children:s.jsx("img",{src:Zi,alt:"VAIRIFY",className:"w-30 h-30 md:w-48 md:h-48"})}),s.jsx("div",{className:"w-10"})]}),s.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:s.jsxs("div",{className:"w-full max-w-md animate-fade-in",children:[s.jsx("h1",{className:"text-4xl font-bold text-white text-center mb-4",children:"Verify Your Email"}),s.jsxs("p",{className:"text-white/80 text-center mb-8",children:["We sent a 6-digit code to ",s.jsx("strong",{children:l||"your email"})]}),s.jsxs("form",{onSubmit:f,className:"space-y-6 bg-white/10 backdrop-blur-sm rounded-3xl p-8 border border-white/20",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx(de,{className:"text-white text-center block",children:"Enter Verification Code"}),s.jsx("div",{className:"flex gap-3 justify-center",onPaste:h,children:t.map((m,v)=>s.jsx(De,{id:`otp-${v}`,type:"text",inputMode:"numeric",maxLength:1,value:m,onChange:g=>u(v,g.target.value),onKeyDown:g=>d(v,g),className:"w-14 h-14 text-center text-2xl font-bold bg-white/20 border-white/30 text-white focus:bg-white/25"},v))})]}),s.jsx(L,{type:"submit",disabled:n||t.join("").length!==6,className:"w-full h-14 text-lg font-semibold bg-white text-primary hover:bg-white/90 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:n?s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"w-5 h-5 mr-2 animate-spin"}),"Verifying..."]}):"Verify Email"}),s.jsx("div",{className:"text-center",children:s.jsx("button",{type:"button",onClick:p,className:"text-white/80 hover:text-white text-sm underline",children:"Didn't receive code? Resend"})})]})]})})]})},i1e=()=>window.location.hostname.includes("devtest"),o1e=()=>i1e()?"https://devtest.vairify.io":"https://vairify.io",l1e=()=>{const e=Oe(),[t,r]=w.useState(!1),[n,a]=w.useState(null);w.useEffect(()=>{(async()=>{const l=sessionStorage.getItem("vairify_user");if(console.log(" Session storage data:",l),!l){console.log(" No stored user data, redirecting to welcome"),e("/onboarding/welcome");return}const c=JSON.parse(l);a(c),r(!!c.referralVAI);const{data:{user:u}}=await T.auth.getUser();console.log(" Success page loaded. User authenticated:",!!u,"User ID:",u==null?void 0:u.id)})()},[e]);const i=async()=>{var m;console.log(" Get VAI button clicked");const{data:{session:o},error:l}=await T.auth.getSession();console.log(" Session check:",(m=o==null?void 0:o.user)==null?void 0:m.id,"Session error:",l);let c=o==null?void 0:o.user;if(!c){const{data:{user:v},error:g}=await T.auth.getUser();console.log(" User data:",v==null?void 0:v.id,"Auth error:",g),c=v}if(!c){console.log(" Attempting to sign in with stored credentials...");const v=sessionStorage.getItem("signup_session_id");if(v)try{const{data:g}=await T.from("signup_sessions").select("password_hash, email").eq("session_id",v).single();if(g!=null&&g.password_hash&&(g!=null&&g.email)){const{data:x,error:y}=await T.auth.signInWithPassword({email:g.email,password:g.password_hash});y?console.error(" Sign in error:",y):x!=null&&x.user&&(console.log(" Successfully signed in:",x.user.id),c=x.user)}}catch(g){console.error(" Error retrieving session data:",g)}if(!c&&(n!=null&&n.email)&&(n!=null&&n.password))try{const{data:g,error:x}=await T.auth.signInWithPassword({email:n.email,password:n.password});x?console.error(" Sign in error with userData:",x):g!=null&&g.user&&(console.log(" Successfully signed in with userData:",g.user.id),c=g.user)}catch(g){console.error(" Error signing in with userData:",g)}}if(!c){console.error(" No authenticated user found after all attempts"),alert("You must be logged in to get a V.A.I. Please try logging in again or refresh the page.");return}const u="https://devtest.chainpass.id",d=o1e();console.log(" ChainPass URL:",u),console.log(" Vairify URL:",d);const h=sessionStorage.getItem("signup_session_id"),f=new URLSearchParams;f.append("user_id",c.id),f.append("return_url",`${d}/onboarding/vai-callback`),h&&(f.append("session_id",h),console.log(" Passing session_id to ChainPass:",h)),t&&(n!=null&&n.referralVAI)&&(console.log(" Adding coupon:",n.referralVAI),f.append("coupon",n.referralVAI));const p=`${u}/?${f.toString()}`;console.log(" Full redirect URL:",p),console.log(" Redirecting now..."),window.location.assign(p)};return s.jsxs("div",{className:"min-h-screen bg-gradient-hero flex flex-col items-center justify-center p-4 md:p-6 relative overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[s.jsx("div",{className:"absolute top-20 left-10 w-32 h-32 bg-primary-light/10 rounded-full blur-3xl animate-float",style:{animationDelay:"0s"}}),s.jsx("div",{className:"absolute bottom-20 right-10 w-40 h-40 bg-primary-light/10 rounded-full blur-3xl animate-float",style:{animationDelay:"1s"}}),s.jsx("div",{className:"absolute top-1/2 left-1/4 w-24 h-24 bg-primary-light/10 rounded-full blur-3xl animate-float",style:{animationDelay:"2s"}})]}),s.jsxs("div",{className:"w-full max-w-[520px] relative z-10",children:[s.jsx("div",{className:"flex items-center justify-center mt-10 mb-8 animate-fade-in",children:s.jsx("img",{src:Zi,alt:"VAIRIFY",className:"w-20 h-20"})}),s.jsx("div",{className:"flex items-center justify-center mb-8 animate-scale-in",style:{animationDelay:"0.2s"},children:s.jsx("div",{className:"w-20 h-20 rounded-full bg-[#10b981]/20 flex items-center justify-center",children:s.jsx(ut,{className:"w-10 h-10 text-[#10b981]",strokeWidth:2.5})})}),s.jsx("h1",{className:"text-3xl font-bold text-white text-center mb-8 animate-fade-in",style:{animationDelay:"0.3s"},children:"Account Created Successfully!"}),s.jsx("div",{className:"w-4/5 h-px bg-white/10 mx-auto mb-8"}),s.jsxs("div",{className:"bg-[rgba(30,58,138,0.3)] backdrop-blur-[10px] border border-white/10 rounded-3xl p-6 mb-4 animate-fade-in",style:{animationDelay:"0.4s"},children:[s.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"One More Step"}),s.jsx("p",{className:"text-base text-white/80 leading-relaxed mb-6",children:"To unlock DateGuard, VAI-CHECK, and TruRevu, you need a V.A.I. (Verified Anonymous Identity)."}),s.jsxs("div",{className:"bg-gradient-to-r from-[#4169e1] to-[#3b5998] rounded-2xl p-5 flex flex-col sm:flex-row items-center justify-center gap-4 mb-5",children:[s.jsx("div",{className:"w-16 h-16 rounded-full border-2 border-white/60 flex items-center justify-center",children:s.jsx(fn,{className:"w-8 h-8 text-white/60"})}),s.jsx("div",{className:"text-2xl text-white/50",children:"+"}),s.jsx("div",{className:"bg-white/10 px-4 py-3 rounded-lg",children:s.jsx("span",{className:"font-mono text-xl text-white font-semibold",children:"9I7T35L"})})]}),s.jsx("p",{className:"text-base font-medium text-white text-center mb-4",children:"A verified photo + unique code"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(ut,{className:"w-5 h-5 text-[#10b981] flex-shrink-0 mt-0.5"}),s.jsx("span",{className:"text-sm text-white/80 leading-relaxed",children:"Proves you're real (verified with ID)"})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(lt,{className:"w-5 h-5 text-[#10b981] flex-shrink-0 mt-0.5"}),s.jsx("span",{className:"text-sm text-white/80 leading-relaxed",children:"Keeps you private (no name/address stored)"})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(xae,{className:"w-5 h-5 text-[#10b981] flex-shrink-0 mt-0.5"}),s.jsx("span",{className:"text-sm text-white/80 leading-relaxed",children:"Works for every encounter"})]})]})]}),s.jsxs("div",{className:"bg-[rgba(30,58,138,0.3)] backdrop-blur-[10px] border border-white/10 rounded-3xl p-6 mb-4 animate-fade-in",style:{animationDelay:"0.5s"},children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"How it works:"}),s.jsxs("div",{className:"space-y-3 mb-5",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-2xl flex-shrink-0",children:"1"}),s.jsx("span",{className:"text-base text-white/80 leading-relaxed",children:"Go to ChainPass (our verification partner)"})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-2xl flex-shrink-0",children:"2"}),s.jsx("span",{className:"text-base text-white/80 leading-relaxed",children:"Upload your government ID"})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-2xl flex-shrink-0",children:"3"}),s.jsx("span",{className:"text-base text-white/80 leading-relaxed",children:"Take a quick selfie"})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-2xl flex-shrink-0",children:"4"}),s.jsx("span",{className:"text-base text-white/80 leading-relaxed",children:"Return here with your V.A.I."})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 bg-white/5 px-3 py-2 rounded-lg",children:[s.jsx("span",{className:"text-base",children:""}),s.jsx("span",{className:"text-sm text-white/70",children:"Takes 3 minutes"})]}),s.jsxs("div",{className:"inline-flex items-center gap-2 bg-white/5 px-3 py-2 rounded-lg",children:[s.jsx("span",{className:"text-base",children:""}),s.jsx("span",{className:"text-sm text-white/70",children:"Identity data never reaches Vairify"})]}),s.jsxs("div",{className:"inline-flex items-center gap-2 bg-white/5 px-3 py-2 rounded-lg",children:[s.jsx("span",{className:"text-base",children:""}),s.jsx("span",{className:"text-sm text-white/70",children:"Required for all safety features"})]})]})]}),s.jsxs("div",{className:"bg-[rgba(30,58,138,0.3)] backdrop-blur-[10px] border border-white/10 rounded-3xl p-5 mb-8 animate-fade-in",style:{animationDelay:"0.6s"},children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"You'll need:"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"text-base text-white/80 leading-relaxed",children:" Government ID (license, passport, etc.)"}),s.jsx("div",{className:"text-base text-white/80 leading-relaxed",children:" Smartphone camera"})]})]}),s.jsxs("div",{className:"space-y-3 animate-fade-in",style:{animationDelay:"0.7s"},children:[s.jsx(L,{onClick:i,className:"w-full h-14 bg-white text-[#1e40af] text-base font-semibold rounded-xl shadow-lg hover:bg-[#f3f4f6] hover:scale-[1.02] transition-all duration-150",children:"Get My V.A.I. Now (3 min)"}),s.jsx(L,{onClick:()=>e("/pricing"),variant:"outline",className:"w-full h-14 border-2 border-white text-white text-base font-semibold rounded-xl hover:bg-white hover:text-[#1e40af] transition-all duration-150",children:"Continue to Pricing"}),s.jsx("p",{className:"text-sm text-white/60 text-center max-w-[480px] mx-auto leading-relaxed mt-4",children:"Note: DateGuard, VAI-CHECK, and TruRevu will be locked until you complete V.A.I. verification."})]})]})]})},c1e=()=>{const e=Oe(),[t]=Ex(),[r,n]=w.useState("checking"),[a,i]=w.useState("Checking your verification status..."),[o,l]=w.useState(0);return w.useEffect(()=>{(async()=>{const u=t.get("session_id"),{data:{user:d}}=await T.auth.getUser();if(!d&&u){i("Retrieving signup data...");try{const{data:p,error:m}=await T.from("signup_sessions").select("*").eq("session_id",u).single();if(m||!p){n("error"),i("Session expired or invalid. Please sign up again.");return}if(new Date(p.expires_at)<new Date){n("error"),i("Session expired. Please sign up again."),await T.from("signup_sessions").delete().eq("session_id",u);return}const{data:v}=await T.auth.getUser();if(!v){const{data:x,error:y}=await T.auth.signUp({email:p.email,password:p.password_hash||"",options:{emailRedirectTo:`${window.location.origin}/onboarding/vai-callback`}});if(y||!(x!=null&&x.user)){n("error"),i("Failed to create account. Please try again.");return}}const{data:{user:g}}=await T.auth.getUser();if(!g){n("error"),i("Authentication failed. Please try again.");return}if(p.has_existing_vai&&p.vai_status==="fully_qualified"&&p.existing_vai_number&&g)try{const{error:x}=await T.from("vai_verifications").insert({user_id:g.id,vai_number:p.existing_vai_number,verification_status:"verified",verified_at:new Date().toISOString(),verified_photo_url:null});x&&x.code!=="23505"&&console.error("Error creating VAI verification:",x),await T.from("profiles").upsert({id:g.id,vai_number:p.existing_vai_number,updated_at:new Date().toISOString()},{onConflict:"id"}),(p.referral_vai||p.coupon_code)&&console.log("Linking referral data:",{referral_vai:p.referral_vai,coupon_code:p.coupon_code}),await T.from("signup_sessions").delete().eq("session_id",u),n("success"),i("Your existing VAI has been linked! Redirecting to profile setup..."),setTimeout(()=>{e("/profile-wizard")},2e3);return}catch(x){console.error("Error linking existing VAI:",x)}(p.referral_vai||p.coupon_code)&&console.log("Linking referral data:",{referral_vai:p.referral_vai,coupon_code:p.coupon_code})}catch(p){console.error("Session retrieval error:",p),n("error"),i("Failed to retrieve signup data. Please try again.");return}}if(!d){n("error"),i("User not authenticated. Please log in.");return}const h=20,f=1500;for(let p=0;p<h;p++){l(p+1),i(`Waiting for verification data from ChainPass... (${p+1}/${h})`);try{const{data:m,error:v}=await T.from("vai_verifications").select("*").eq("user_id",d.id).maybeSingle();if(m&&!v){console.log("V.A.I. verification found:",m),n("success"),i("Verification complete! Redirecting..."),setTimeout(()=>{e("/pricing")},2e3);return}await new Promise(g=>setTimeout(g,f))}catch(m){console.error("Polling error:",m)}}n("error"),i("Verification data not received yet. This might take a few moments. You can continue and check back later.")})()},[e,t]),s.jsxs("div",{className:"min-h-screen bg-gradient-hero flex flex-col items-center justify-center p-4",children:[s.jsx("div",{className:"flex items-center justify-center mb-8",children:s.jsx("img",{src:Zi,alt:"VAIRIFY",className:"w-20 h-20"})}),s.jsx("div",{className:"bg-card/80 backdrop-blur-lg border border-white/10 rounded-3xl p-8 max-w-md w-full",children:s.jsxs("div",{className:"flex flex-col items-center text-center",children:[r==="checking"&&s.jsx("div",{className:"mb-6",children:s.jsx(Er,{className:"w-16 h-16 text-primary animate-spin"})}),r==="success"&&s.jsx("div",{className:"mb-6",children:s.jsx("div",{className:"w-16 h-16 rounded-full bg-green-500/20 flex items-center justify-center",children:s.jsx(ut,{className:"w-10 h-10 text-green-500"})})}),r==="error"&&s.jsx("div",{className:"mb-6",children:s.jsx("div",{className:"w-16 h-16 rounded-full bg-red-500/20 flex items-center justify-center",children:s.jsx(Qd,{className:"w-10 h-10 text-red-500"})})}),s.jsxs("h2",{className:"text-2xl font-bold text-foreground mb-4",children:[r==="checking"&&"Processing Verification",r==="success"&&"Verification Complete!",r==="error"&&"Verification Pending"]}),s.jsx("p",{className:"text-muted-foreground mb-6",children:a}),r==="error"&&s.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[s.jsx(L,{onClick:()=>e("/pricing"),className:"w-full",children:"Continue to Pricing"}),s.jsx(L,{onClick:()=>window.location.reload(),variant:"outline",className:"w-full",children:"Check Again"})]}),r==="checking"&&s.jsxs("div",{className:"text-sm text-muted-foreground",children:["Attempt ",o," of 20"]})]})}),s.jsx("p",{className:"text-sm text-muted-foreground mt-6 text-center max-w-md",children:"Your verification data is being processed by ChainPass. This usually takes just a few moments."})]})},u1e={FC:{name:"Founding Council",duration:"Lifetime Premium",perks:["Free Premium Forever","100% Free VAI Verifications","Early Access: December 10th","Governance & Voting Rights","Founding Council Badge","Vote on Premium Features (Dec 27)","Ambassador Status"],icon:s.jsx(zi,{className:"w-12 h-12"}),gradient:"from-yellow-400 via-yellow-500 to-amber-600"},FM:{name:"First Movers",duration:"1 Year Free",perks:["Free Premium for 1 Year","5% Discount on All VAI","Early Access: December 15th","First Mover Badge","Vote on Premium Features (Dec 27)","Ambassador Status"],icon:s.jsx(lz,{className:"w-12 h-12"}),gradient:"from-purple-400 via-purple-500 to-indigo-600"},EA:{name:"Early Access",duration:"6 Months Free + 20% Forever",perks:["Free Premium for 6 Months","20% Off Premium Forever","Early Access: December 20th","Early Access Badge","Vote on Premium Features (Dec 27)","Ambassador Status"],icon:s.jsx(kd,{className:"w-12 h-12"}),gradient:"from-blue-400 via-blue-500 to-cyan-600"}},d1e=()=>{const e=Oe(),[t,r]=w.useState(null),[n,a]=w.useState(!0);w.useEffect(()=>{(async()=>{try{const{data:{user:c}}=await T.auth.getUser();if(!c){e("/login");return}const u=sessionStorage.getItem("vairify_user");if(!u){e("/pricing");return}const h=JSON.parse(u).referralVAI;if(!h){e("/pricing");return}const f=h.substring(0,2).toUpperCase();f==="FC"||f==="FM"||f==="EA"?r(f):e("/pricing")}catch(c){console.error("Error checking founding member status:",c),e("/pricing")}finally{a(!1)}})()},[e]);const i=()=>{e("/profile-creation")};if(n||!t)return s.jsx("div",{className:"min-h-screen bg-gradient-hero flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"})});const o=u1e[t];return s.jsxs("div",{className:"min-h-screen bg-gradient-hero flex flex-col items-center justify-center p-4 md:p-6 relative overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[s.jsx("div",{className:"absolute top-20 left-10 w-32 h-32 bg-primary-light/10 rounded-full blur-3xl animate-float",style:{animationDelay:"0s"}}),s.jsx("div",{className:"absolute bottom-20 right-10 w-40 h-40 bg-primary-light/10 rounded-full blur-3xl animate-float",style:{animationDelay:"1s"}}),s.jsx("div",{className:"absolute top-1/2 left-1/4 w-24 h-24 bg-primary-light/10 rounded-full blur-3xl animate-float",style:{animationDelay:"2s"}})]}),s.jsxs("div",{className:"w-full max-w-[600px] relative z-10",children:[s.jsx("div",{className:"flex items-center justify-center mb-8 animate-fade-in",children:s.jsx("img",{src:Zi,alt:"VAIRIFY",className:"w-20 h-20"})}),s.jsx("div",{className:"flex items-center justify-center mb-6 animate-scale-in",style:{animationDelay:"0.1s"},children:s.jsx("div",{className:`w-24 h-24 rounded-full bg-gradient-to-br ${o.gradient} flex items-center justify-center shadow-2xl`,children:s.jsx("div",{className:"text-white",children:o.icon})})}),s.jsxs("h1",{className:"text-4xl md:text-5xl font-bold text-white text-center mb-4 animate-fade-in",style:{animationDelay:"0.2s"},children:["You're In The ",o.name,"!"]}),s.jsx("p",{className:"text-xl text-white/90 text-center mb-8 animate-fade-in",style:{animationDelay:"0.3s"},children:"You're part of an exclusive group building the future of safety."}),s.jsxs("div",{className:"bg-[rgba(30,58,138,0.4)] backdrop-blur-[12px] border-2 border-white/20 rounded-3xl p-8 mb-6 animate-fade-in",style:{animationDelay:"0.4s"},children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 bg-white/10 px-4 py-2 rounded-full mb-4",children:[s.jsx(iae,{className:"w-5 h-5 text-white"}),s.jsx("span",{className:"text-white font-semibold",children:"Your Premium Access"})]}),s.jsx("div",{className:`text-6xl font-bold bg-gradient-to-r ${o.gradient} bg-clip-text text-transparent mb-2`,children:o.duration}),s.jsx("p",{className:"text-white/80 text-lg",children:"of Premium Features  Completely Free"})]}),s.jsx("div",{className:"w-full h-px bg-white/20 mb-8"}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsx("h3",{className:"text-white text-xl font-semibold mb-4 text-center",children:"Your Exclusive Perks:"}),o.perks.map((l,c)=>s.jsxs("div",{className:"flex items-start gap-3 bg-white/5 rounded-xl p-4 animate-fade-in",style:{animationDelay:`${.5+c*.1}s`},children:[s.jsx("div",{className:`flex-shrink-0 w-6 h-6 rounded-full bg-gradient-to-br ${o.gradient} flex items-center justify-center mt-0.5`,children:s.jsx("span",{className:"text-white text-sm font-bold",children:""})}),s.jsx("p",{className:"text-white/90 leading-relaxed",children:l})]},c))]}),s.jsx("div",{className:"bg-white/10 rounded-2xl p-6 border border-white/20",children:s.jsxs("p",{className:"text-white text-center leading-relaxed",children:[s.jsx("span",{className:"font-semibold",children:"You believed in our mission early."})," You're not just a useryou're a founding member of a movement to bring safety and accountability to one of the world's most dangerous industries."]})})]}),s.jsx("div",{className:"bg-[rgba(30,58,138,0.3)] backdrop-blur-[10px] border border-white/10 rounded-2xl p-6 mb-8 animate-fade-in",style:{animationDelay:"0.9s"},children:s.jsxs("p",{className:"text-white/90 text-center text-sm leading-relaxed",children:[s.jsx("span",{className:"font-semibold text-white",children:"Remember:"})," All safety features (DateGuard, V.A.I.-CHECK, TruRevu, Emergency Button) are ",s.jsx("span",{className:"font-bold text-white",children:"FREE FOREVER"})," for everyone. Your premium membership gives you convenience upgradesbut safety is our gift to the community."]})}),s.jsx(L,{onClick:i,className:"w-full h-16 bg-white text-primary text-lg font-bold rounded-xl shadow-xl hover:bg-white/90 hover:scale-[1.02] transition-all duration-200 animate-fade-in",style:{animationDelay:"1s"},children:"Continue to Build Your Profile"}),s.jsx("p",{className:"text-white/60 text-sm text-center mt-6 animate-fade-in",style:{animationDelay:"1.1s"},children:"Let's set up your account and get you connected to the community"})]})]})},Mn=w.forwardRef(({className:e,...t},r)=>s.jsx("textarea",{className:me("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));Mn.displayName="Textarea";var fO="Radio",[h1e,G9]=an(fO),[f1e,p1e]=h1e(fO),H9=w.forwardRef((e,t)=>{const{__scopeRadio:r,name:n,checked:a=!1,required:i,disabled:o,value:l="on",onCheck:c,form:u,...d}=e,[h,f]=w.useState(null),p=ct(t,g=>f(g)),m=w.useRef(!1),v=h?u||!!h.closest("form"):!0;return s.jsxs(f1e,{scope:r,checked:a,disabled:o,children:[s.jsx(Me.button,{type:"button",role:"radio","aria-checked":a,"data-state":Q9(a),"data-disabled":o?"":void 0,disabled:o,value:l,...d,ref:p,onClick:Ne(e.onClick,g=>{a||c==null||c(),v&&(m.current=g.isPropagationStopped(),m.current||g.stopPropagation())})}),v&&s.jsx(X9,{control:h,bubbles:!m.current,name:n,value:l,checked:a,required:i,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});H9.displayName=fO;var K9="RadioIndicator",Y9=w.forwardRef((e,t)=>{const{__scopeRadio:r,forceMount:n,...a}=e,i=p1e(K9,r);return s.jsx(gn,{present:n||i.checked,children:s.jsx(Me.span,{"data-state":Q9(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:t})})});Y9.displayName=K9;var m1e="RadioBubbleInput",X9=w.forwardRef(({__scopeRadio:e,control:t,checked:r,bubbles:n=!0,...a},i)=>{const o=w.useRef(null),l=ct(o,i),c=sN(r),u=hj(t);return w.useEffect(()=>{const d=o.current;if(!d)return;const h=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(h,"checked").set;if(c!==r&&p){const m=new Event("click",{bubbles:n});p.call(d,r),d.dispatchEvent(m)}},[c,r,n]),s.jsx(Me.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:l,style:{...a.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});X9.displayName=m1e;function Q9(e){return e?"checked":"unchecked"}var v1e=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],oN="RadioGroup",[g1e,vQe]=an(oN,[em,G9]),Z9=em(),J9=G9(),[x1e,y1e]=g1e(oN),e7=w.forwardRef((e,t)=>{const{__scopeRadioGroup:r,name:n,defaultValue:a,value:i,required:o=!1,disabled:l=!1,orientation:c,dir:u,loop:d=!0,onValueChange:h,...f}=e,p=Z9(r),m=ah(u),[v,g]=Ba({prop:i,defaultProp:a??null,onChange:h,caller:oN});return s.jsx(x1e,{scope:r,name:n,required:o,disabled:l,value:v,onValueChange:g,children:s.jsx(WR,{asChild:!0,...p,orientation:c,dir:m,loop:d,children:s.jsx(Me.div,{role:"radiogroup","aria-required":o,"aria-orientation":c,"data-disabled":l?"":void 0,dir:m,...f,ref:t})})})});e7.displayName=oN;var t7="RadioGroupItem",r7=w.forwardRef((e,t)=>{const{__scopeRadioGroup:r,disabled:n,...a}=e,i=y1e(t7,r),o=i.disabled||n,l=Z9(r),c=J9(r),u=w.useRef(null),d=ct(t,u),h=i.value===a.value,f=w.useRef(!1);return w.useEffect(()=>{const p=v=>{v1e.includes(v.key)&&(f.current=!0)},m=()=>f.current=!1;return document.addEventListener("keydown",p),document.addEventListener("keyup",m),()=>{document.removeEventListener("keydown",p),document.removeEventListener("keyup",m)}},[]),s.jsx(qR,{asChild:!0,...l,focusable:!o,active:h,children:s.jsx(H9,{disabled:o,required:i.required,checked:h,...c,...a,name:i.name,ref:d,onCheck:()=>i.onValueChange(a.value),onKeyDown:Ne(p=>{p.key==="Enter"&&p.preventDefault()}),onFocus:Ne(a.onFocus,()=>{var p;f.current&&((p=u.current)==null||p.click())})})})});r7.displayName=t7;var b1e="RadioGroupIndicator",n7=w.forwardRef((e,t)=>{const{__scopeRadioGroup:r,...n}=e,a=J9(r);return s.jsx(Y9,{...a,...n,ref:t})});n7.displayName=b1e;var a7=e7,s7=r7,w1e=n7;const nm=w.forwardRef(({className:e,...t},r)=>s.jsx(a7,{className:me("grid gap-2",e),...t,ref:r}));nm.displayName=a7.displayName;const Ts=w.forwardRef(({className:e,...t},r)=>s.jsx(s7,{ref:r,className:me("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:s.jsx(w1e,{className:"flex items-center justify-center",children:s.jsx(cT,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Ts.displayName=s7.displayName;function j1e(){const e=Oe(),{toast:t}=Et(),[r,n]=w.useState(!1),[a,i]=w.useState({businessName:"",businessType:"service",description:"",address:"",phone:"",email:"",website:""}),o=async l=>{l.preventDefault(),n(!0);try{const{data:{user:c}}=await T.auth.getUser();if(!c)throw new Error("Not authenticated");const{data:u,error:d}=await T.from("businesses").insert({owner_id:c.id,business_name:a.businessName,business_type:a.businessType,description:a.description,address:a.address,phone:a.phone,email:a.email,website:a.website}).select().single();if(d)throw d;t({title:"Business Registered!",description:"Your business has been created with 3 V.A.I. coupons"}),e(`/business/${u.id}/control-panel`)}catch(c){t({title:"Registration Failed",description:c.message,variant:"destructive"})}finally{n(!1)}};return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"sticky top-0 z-10 border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:s.jsxs("div",{className:"container flex h-16 items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e(-1),children:s.jsx(ze,{className:"h-5 w-5"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(_o,{className:"h-5 w-5 text-primary"}),s.jsx("h1",{className:"text-lg font-semibold",children:"Register Business"})]})]})}),s.jsx("main",{className:"container max-w-2xl py-8",children:s.jsxs("form",{onSubmit:o,className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"businessName",children:"Business Name *"}),s.jsx(De,{id:"businessName",required:!0,value:a.businessName,onChange:l=>i({...a,businessName:l.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{children:"Business Type *"}),s.jsxs(nm,{value:a.businessType,onValueChange:l=>i({...a,businessType:l}),children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ts,{value:"service",id:"service"}),s.jsx(de,{htmlFor:"service",children:"Service Business (sexual component)"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ts,{value:"non_service",id:"non_service"}),s.jsx(de,{htmlFor:"non_service",children:"Non-Service Business (no sexual component)"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"description",children:"Description"}),s.jsx(Mn,{id:"description",rows:4,value:a.description,onChange:l=>i({...a,description:l.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"address",children:"Address"}),s.jsx(De,{id:"address",value:a.address,onChange:l=>i({...a,address:l.target.value})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"phone",children:"Phone"}),s.jsx(De,{id:"phone",type:"tel",value:a.phone,onChange:l=>i({...a,phone:l.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"email",children:"Email"}),s.jsx(De,{id:"email",type:"email",value:a.email,onChange:l=>i({...a,email:l.target.value})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"website",children:"Website"}),s.jsx(De,{id:"website",type:"url",value:a.website,onChange:l=>i({...a,website:l.target.value})})]}),s.jsx(L,{type:"submit",className:"w-full",disabled:r,children:r?"Creating Business...":"Register Business"})]})})]})}var lN="Tabs",[N1e,gQe]=an(lN,[em]),i7=em(),[_1e,pO]=N1e(lN),o7=w.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:a,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic",...u}=e,d=ah(l),[h,f]=Ba({prop:n,onChange:a,defaultProp:i??"",caller:lN});return s.jsx(_1e,{scope:r,baseId:pn(),value:h,onValueChange:f,orientation:o,dir:d,activationMode:c,children:s.jsx(Me.div,{dir:d,"data-orientation":o,...u,ref:t})})});o7.displayName=lN;var l7="TabsList",c7=w.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...a}=e,i=pO(l7,r),o=i7(r);return s.jsx(WR,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:n,children:s.jsx(Me.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:t})})});c7.displayName=l7;var u7="TabsTrigger",d7=w.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:a=!1,...i}=e,o=pO(u7,r),l=i7(r),c=p7(o.baseId,n),u=m7(o.baseId,n),d=n===o.value;return s.jsx(qR,{asChild:!0,...l,focusable:!a,active:d,children:s.jsx(Me.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...i,ref:t,onMouseDown:Ne(e.onMouseDown,h=>{!a&&h.button===0&&h.ctrlKey===!1?o.onValueChange(n):h.preventDefault()}),onKeyDown:Ne(e.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(n)}),onFocus:Ne(e.onFocus,()=>{const h=o.activationMode!=="manual";!d&&!a&&h&&o.onValueChange(n)})})})});d7.displayName=u7;var h7="TabsContent",f7=w.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:a,children:i,...o}=e,l=pO(h7,r),c=p7(l.baseId,n),u=m7(l.baseId,n),d=n===l.value,h=w.useRef(d);return w.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),s.jsx(gn,{present:a||d,children:({present:f})=>s.jsx(Me.div,{"data-state":d?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:u,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:h.current?"0s":void 0},children:f&&i})})});f7.displayName=h7;function p7(e,t){return`${e}-trigger-${t}`}function m7(e,t){return`${e}-content-${t}`}var S1e=o7,v7=c7,g7=d7,x7=f7;const Ga=S1e,Aa=w.forwardRef(({className:e,...t},r)=>s.jsx(v7,{ref:r,className:me("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Aa.displayName=v7.displayName;const mt=w.forwardRef(({className:e,...t},r)=>s.jsx(g7,{ref:r,className:me("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",e),...t}));mt.displayName=g7.displayName;const Rt=w.forwardRef(({className:e,...t},r)=>s.jsx(x7,{ref:r,className:me("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));Rt.displayName=x7.displayName;var C1e=Array.isArray,ds=C1e,E1e=typeof my=="object"&&my&&my.Object===Object&&my,y7=E1e,k1e=y7,A1e=typeof self=="object"&&self&&self.Object===Object&&self,P1e=k1e||A1e||Function("return this")(),qo=P1e,T1e=qo,R1e=T1e.Symbol,Kx=R1e,r$=Kx,b7=Object.prototype,O1e=b7.hasOwnProperty,I1e=b7.toString,Um=r$?r$.toStringTag:void 0;function D1e(e){var t=O1e.call(e,Um),r=e[Um];try{e[Um]=void 0;var n=!0}catch{}var a=I1e.call(e);return n&&(t?e[Um]=r:delete e[Um]),a}var M1e=D1e,$1e=Object.prototype,F1e=$1e.toString;function L1e(e){return F1e.call(e)}var B1e=L1e,n$=Kx,U1e=M1e,V1e=B1e,z1e="[object Null]",W1e="[object Undefined]",a$=n$?n$.toStringTag:void 0;function q1e(e){return e==null?e===void 0?W1e:z1e:a$&&a$ in Object(e)?U1e(e):V1e(e)}var Vl=q1e;function G1e(e){return e!=null&&typeof e=="object"}var zl=G1e,H1e=Vl,K1e=zl,Y1e="[object Symbol]";function X1e(e){return typeof e=="symbol"||K1e(e)&&H1e(e)==Y1e}var am=X1e,Q1e=ds,Z1e=am,J1e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,eje=/^\w*$/;function tje(e,t){if(Q1e(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Z1e(e)?!0:eje.test(e)||!J1e.test(e)||t!=null&&e in Object(t)}var mO=tje;function rje(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var mu=rje;const sm=lr(mu);var nje=Vl,aje=mu,sje="[object AsyncFunction]",ije="[object Function]",oje="[object GeneratorFunction]",lje="[object Proxy]";function cje(e){if(!aje(e))return!1;var t=nje(e);return t==ije||t==oje||t==sje||t==lje}var vO=cje;const bt=lr(vO);var uje=qo,dje=uje["__core-js_shared__"],hje=dje,q2=hje,s$=function(){var e=/[^.]+$/.exec(q2&&q2.keys&&q2.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function fje(e){return!!s$&&s$ in e}var pje=fje,mje=Function.prototype,vje=mje.toString;function gje(e){if(e!=null){try{return vje.call(e)}catch{}try{return e+""}catch{}}return""}var w7=gje,xje=vO,yje=pje,bje=mu,wje=w7,jje=/[\\^$.*+?()[\]{}|]/g,Nje=/^\[object .+?Constructor\]$/,_je=Function.prototype,Sje=Object.prototype,Cje=_je.toString,Eje=Sje.hasOwnProperty,kje=RegExp("^"+Cje.call(Eje).replace(jje,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Aje(e){if(!bje(e)||yje(e))return!1;var t=xje(e)?kje:Nje;return t.test(wje(e))}var Pje=Aje;function Tje(e,t){return e==null?void 0:e[t]}var Rje=Tje,Oje=Pje,Ije=Rje;function Dje(e,t){var r=Ije(e,t);return Oje(r)?r:void 0}var oh=Dje,Mje=oh,$je=Mje(Object,"create"),cN=$je,i$=cN;function Fje(){this.__data__=i$?i$(null):{},this.size=0}var Lje=Fje;function Bje(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Uje=Bje,Vje=cN,zje="__lodash_hash_undefined__",Wje=Object.prototype,qje=Wje.hasOwnProperty;function Gje(e){var t=this.__data__;if(Vje){var r=t[e];return r===zje?void 0:r}return qje.call(t,e)?t[e]:void 0}var Hje=Gje,Kje=cN,Yje=Object.prototype,Xje=Yje.hasOwnProperty;function Qje(e){var t=this.__data__;return Kje?t[e]!==void 0:Xje.call(t,e)}var Zje=Qje,Jje=cN,eNe="__lodash_hash_undefined__";function tNe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Jje&&t===void 0?eNe:t,this}var rNe=tNe,nNe=Lje,aNe=Uje,sNe=Hje,iNe=Zje,oNe=rNe;function im(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}im.prototype.clear=nNe;im.prototype.delete=aNe;im.prototype.get=sNe;im.prototype.has=iNe;im.prototype.set=oNe;var lNe=im;function cNe(){this.__data__=[],this.size=0}var uNe=cNe;function dNe(e,t){return e===t||e!==e&&t!==t}var gO=dNe,hNe=gO;function fNe(e,t){for(var r=e.length;r--;)if(hNe(e[r][0],t))return r;return-1}var uN=fNe,pNe=uN,mNe=Array.prototype,vNe=mNe.splice;function gNe(e){var t=this.__data__,r=pNe(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():vNe.call(t,r,1),--this.size,!0}var xNe=gNe,yNe=uN;function bNe(e){var t=this.__data__,r=yNe(t,e);return r<0?void 0:t[r][1]}var wNe=bNe,jNe=uN;function NNe(e){return jNe(this.__data__,e)>-1}var _Ne=NNe,SNe=uN;function CNe(e,t){var r=this.__data__,n=SNe(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var ENe=CNe,kNe=uNe,ANe=xNe,PNe=wNe,TNe=_Ne,RNe=ENe;function om(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}om.prototype.clear=kNe;om.prototype.delete=ANe;om.prototype.get=PNe;om.prototype.has=TNe;om.prototype.set=RNe;var dN=om,ONe=oh,INe=qo,DNe=ONe(INe,"Map"),xO=DNe,o$=lNe,MNe=dN,$Ne=xO;function FNe(){this.size=0,this.__data__={hash:new o$,map:new($Ne||MNe),string:new o$}}var LNe=FNe;function BNe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var UNe=BNe,VNe=UNe;function zNe(e,t){var r=e.__data__;return VNe(t)?r[typeof t=="string"?"string":"hash"]:r.map}var hN=zNe,WNe=hN;function qNe(e){var t=WNe(this,e).delete(e);return this.size-=t?1:0,t}var GNe=qNe,HNe=hN;function KNe(e){return HNe(this,e).get(e)}var YNe=KNe,XNe=hN;function QNe(e){return XNe(this,e).has(e)}var ZNe=QNe,JNe=hN;function e_e(e,t){var r=JNe(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var t_e=e_e,r_e=LNe,n_e=GNe,a_e=YNe,s_e=ZNe,i_e=t_e;function lm(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}lm.prototype.clear=r_e;lm.prototype.delete=n_e;lm.prototype.get=a_e;lm.prototype.has=s_e;lm.prototype.set=i_e;var yO=lm,j7=yO,o_e="Expected a function";function bO(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(o_e);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var o=e.apply(this,n);return r.cache=i.set(a,o)||i,o};return r.cache=new(bO.Cache||j7),r}bO.Cache=j7;var N7=bO;const l_e=lr(N7);var c_e=N7,u_e=500;function d_e(e){var t=c_e(e,function(n){return r.size===u_e&&r.clear(),n}),r=t.cache;return t}var h_e=d_e,f_e=h_e,p_e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,m_e=/\\(\\)?/g,v_e=f_e(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(p_e,function(r,n,a,i){t.push(a?i.replace(m_e,"$1"):n||r)}),t}),g_e=v_e;function x_e(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var wO=x_e,l$=Kx,y_e=wO,b_e=ds,w_e=am,j_e=1/0,c$=l$?l$.prototype:void 0,u$=c$?c$.toString:void 0;function _7(e){if(typeof e=="string")return e;if(b_e(e))return y_e(e,_7)+"";if(w_e(e))return u$?u$.call(e):"";var t=e+"";return t=="0"&&1/e==-j_e?"-0":t}var N_e=_7,__e=N_e;function S_e(e){return e==null?"":__e(e)}var S7=S_e,C_e=ds,E_e=mO,k_e=g_e,A_e=S7;function P_e(e,t){return C_e(e)?e:E_e(e,t)?[e]:k_e(A_e(e))}var C7=P_e,T_e=am,R_e=1/0;function O_e(e){if(typeof e=="string"||T_e(e))return e;var t=e+"";return t=="0"&&1/e==-R_e?"-0":t}var fN=O_e,I_e=C7,D_e=fN;function M_e(e,t){t=I_e(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[D_e(t[r++])];return r&&r==n?e:void 0}var jO=M_e,$_e=jO;function F_e(e,t,r){var n=e==null?void 0:$_e(e,t);return n===void 0?r:n}var E7=F_e;const ii=lr(E7);function L_e(e){return e==null}var B_e=L_e;const Ot=lr(B_e);var U_e=Vl,V_e=ds,z_e=zl,W_e="[object String]";function q_e(e){return typeof e=="string"||!V_e(e)&&z_e(e)&&U_e(e)==W_e}var G_e=q_e;const Md=lr(G_e);var k7={exports:{}},cr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NO=Symbol.for("react.element"),_O=Symbol.for("react.portal"),pN=Symbol.for("react.fragment"),mN=Symbol.for("react.strict_mode"),vN=Symbol.for("react.profiler"),gN=Symbol.for("react.provider"),xN=Symbol.for("react.context"),H_e=Symbol.for("react.server_context"),yN=Symbol.for("react.forward_ref"),bN=Symbol.for("react.suspense"),wN=Symbol.for("react.suspense_list"),jN=Symbol.for("react.memo"),NN=Symbol.for("react.lazy"),K_e=Symbol.for("react.offscreen"),A7;A7=Symbol.for("react.module.reference");function hi(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case NO:switch(e=e.type,e){case pN:case vN:case mN:case bN:case wN:return e;default:switch(e=e&&e.$$typeof,e){case H_e:case xN:case yN:case NN:case jN:case gN:return e;default:return t}}case _O:return t}}}cr.ContextConsumer=xN;cr.ContextProvider=gN;cr.Element=NO;cr.ForwardRef=yN;cr.Fragment=pN;cr.Lazy=NN;cr.Memo=jN;cr.Portal=_O;cr.Profiler=vN;cr.StrictMode=mN;cr.Suspense=bN;cr.SuspenseList=wN;cr.isAsyncMode=function(){return!1};cr.isConcurrentMode=function(){return!1};cr.isContextConsumer=function(e){return hi(e)===xN};cr.isContextProvider=function(e){return hi(e)===gN};cr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===NO};cr.isForwardRef=function(e){return hi(e)===yN};cr.isFragment=function(e){return hi(e)===pN};cr.isLazy=function(e){return hi(e)===NN};cr.isMemo=function(e){return hi(e)===jN};cr.isPortal=function(e){return hi(e)===_O};cr.isProfiler=function(e){return hi(e)===vN};cr.isStrictMode=function(e){return hi(e)===mN};cr.isSuspense=function(e){return hi(e)===bN};cr.isSuspenseList=function(e){return hi(e)===wN};cr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===pN||e===vN||e===mN||e===bN||e===wN||e===K_e||typeof e=="object"&&e!==null&&(e.$$typeof===NN||e.$$typeof===jN||e.$$typeof===gN||e.$$typeof===xN||e.$$typeof===yN||e.$$typeof===A7||e.getModuleId!==void 0)};cr.typeOf=hi;k7.exports=cr;var Y_e=k7.exports,X_e=Vl,Q_e=zl,Z_e="[object Number]";function J_e(e){return typeof e=="number"||Q_e(e)&&X_e(e)==Z_e}var P7=J_e;const e2e=lr(P7);var t2e=P7;function r2e(e){return t2e(e)&&e!=+e}var n2e=r2e;const cm=lr(n2e);var $i=function(t){return t===0?0:t>0?1:-1},Qu=function(t){return Md(t)&&t.indexOf("%")===t.length-1},Te=function(t){return e2e(t)&&!cm(t)},a2e=function(t){return Ot(t)},kn=function(t){return Te(t)||Md(t)},s2e=0,um=function(t){var r=++s2e;return"".concat(t||"").concat(r)},$d=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Te(t)&&!Md(t))return n;var i;if(Qu(t)){var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return cm(i)&&(i=n),a&&i>r&&(i=r),i},uc=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},i2e=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},na=function(t,r){return Te(t)&&Te(r)?function(n){return t+n*(r-t)}:function(){return r}};function xw(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):ii(n,t))===r})}var o2e=function(t,r){return Te(t)&&Te(r)?t-r:Md(t)&&Md(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function Sf(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function WE(e){"@babel/helpers - typeof";return WE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WE(e)}var l2e=["viewBox","children"],c2e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],d$=["points","pathLength"],G2={svg:l2e,polygon:d$,polyline:d$},SO=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],yw=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(w.isValidElement(t)&&(n=t.props),!sm(n))return null;var a={};return Object.keys(n).forEach(function(i){SO.includes(i)&&(a[i]=r||function(o){return n[i](n,o)})}),a},u2e=function(t,r,n){return function(a){return t(r,n,a),null}},bw=function(t,r,n){if(!sm(t)||WE(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var o=t[i];SO.includes(i)&&typeof o=="function"&&(a||(a={}),a[i]=u2e(o,r,n))}),a},d2e=["children"],h2e=["children"];function h$(e,t){if(e==null)return{};var r=f2e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function f2e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function qE(e){"@babel/helpers - typeof";return qE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qE(e)}var f$={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},pl=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},p$=null,H2=null,CO=function e(t){if(t===p$&&Array.isArray(H2))return H2;var r=[];return w.Children.forEach(t,function(n){Ot(n)||(Y_e.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),H2=r,p$=t,r};function oi(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return pl(a)}):n=[pl(t)],CO(e).forEach(function(a){var i=ii(a,"type.displayName")||ii(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function ys(e,t){var r=oi(e,t);return r&&r[0]}var m$=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!Te(n)||n<=0||!Te(a)||a<=0)},p2e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],m2e=function(t){return t&&t.type&&Md(t.type)&&p2e.indexOf(t.type)>=0},T7=function(t){return t&&qE(t)==="object"&&"clipDot"in t},v2e=function(t,r,n,a){var i,o=(i=G2==null?void 0:G2[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!bt(t)&&(a&&o.includes(r)||c2e.includes(r))||n&&SO.includes(r)},Ct=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(w.isValidElement(t)&&(a=t.props),!sm(a))return null;var i={};return Object.keys(a).forEach(function(o){var l;v2e((l=a)===null||l===void 0?void 0:l[o],o,r,n)&&(i[o]=a[o])}),i},GE=function e(t,r){if(t===r)return!0;var n=w.Children.count(t);if(n!==w.Children.count(r))return!1;if(n===0)return!0;if(n===1)return v$(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],o=r[a];if(Array.isArray(i)||Array.isArray(o)){if(!e(i,o))return!1}else if(!v$(i,o))return!1}return!0},v$=function(t,r){if(Ot(t)&&Ot(r))return!0;if(!Ot(t)&&!Ot(r)){var n=t.props||{},a=n.children,i=h$(n,d2e),o=r.props||{},l=o.children,c=h$(o,h2e);return a&&l?Sf(i,c)&&GE(a,l):!a&&!l?Sf(i,c):!1}return!1},g$=function(t,r){var n=[],a={};return CO(t).forEach(function(i,o){if(m2e(i))n.push(i);else if(i){var l=pl(i.type),c=r[l]||{},u=c.handler,d=c.once;if(u&&(!d||!a[l])){var h=u(i,l,o);n.push(h),a[l]=!0}}}),n},g2e=function(t){var r=t&&t.type;return r&&f$[r]?f$[r]:null},x2e=function(t,r){return CO(r).indexOf(t)},y2e=["children","width","height","viewBox","className","style","title","desc"];function HE(){return HE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HE.apply(this,arguments)}function b2e(e,t){if(e==null)return{};var r=w2e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function w2e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function KE(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,o=e.style,l=e.title,c=e.desc,u=b2e(e,y2e),d=a||{width:r,height:n,x:0,y:0},h=Ut("recharts-surface",i);return F.createElement("svg",HE({},Ct(u,!0,"svg"),{className:h,width:r,height:n,style:o,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height)}),F.createElement("title",null,l),F.createElement("desc",null,c),t)}var j2e=["children","className"];function YE(){return YE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},YE.apply(this,arguments)}function N2e(e,t){if(e==null)return{};var r=_2e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _2e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var yr=F.forwardRef(function(e,t){var r=e.children,n=e.className,a=N2e(e,j2e),i=Ut("recharts-layer",n);return F.createElement("g",YE({className:i},Ct(a,!0),{ref:t}),r)}),ml=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function S2e(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}var C2e=S2e,E2e=C2e;function k2e(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:E2e(e,t,r)}var A2e=k2e,P2e="\\ud800-\\udfff",T2e="\\u0300-\\u036f",R2e="\\ufe20-\\ufe2f",O2e="\\u20d0-\\u20ff",I2e=T2e+R2e+O2e,D2e="\\ufe0e\\ufe0f",M2e="\\u200d",$2e=RegExp("["+M2e+P2e+I2e+D2e+"]");function F2e(e){return $2e.test(e)}var R7=F2e;function L2e(e){return e.split("")}var B2e=L2e,O7="\\ud800-\\udfff",U2e="\\u0300-\\u036f",V2e="\\ufe20-\\ufe2f",z2e="\\u20d0-\\u20ff",W2e=U2e+V2e+z2e,q2e="\\ufe0e\\ufe0f",G2e="["+O7+"]",XE="["+W2e+"]",QE="\\ud83c[\\udffb-\\udfff]",H2e="(?:"+XE+"|"+QE+")",I7="[^"+O7+"]",D7="(?:\\ud83c[\\udde6-\\uddff]){2}",M7="[\\ud800-\\udbff][\\udc00-\\udfff]",K2e="\\u200d",$7=H2e+"?",F7="["+q2e+"]?",Y2e="(?:"+K2e+"(?:"+[I7,D7,M7].join("|")+")"+F7+$7+")*",X2e=F7+$7+Y2e,Q2e="(?:"+[I7+XE+"?",XE,D7,M7,G2e].join("|")+")",Z2e=RegExp(QE+"(?="+QE+")|"+Q2e+X2e,"g");function J2e(e){return e.match(Z2e)||[]}var eSe=J2e,tSe=B2e,rSe=R7,nSe=eSe;function aSe(e){return rSe(e)?nSe(e):tSe(e)}var sSe=aSe,iSe=A2e,oSe=R7,lSe=sSe,cSe=S7;function uSe(e){return function(t){t=cSe(t);var r=oSe(t)?lSe(t):void 0,n=r?r[0]:t.charAt(0),a=r?iSe(r,1).join(""):t.slice(1);return n[e]()+a}}var dSe=uSe,hSe=dSe,fSe=hSe("toUpperCase"),pSe=fSe;const _N=lr(pSe);function vr(e){return function(){return e}}const L7=Math.cos,ww=Math.sin,ro=Math.sqrt,jw=Math.PI,SN=2*jw,ZE=Math.PI,JE=2*ZE,Mu=1e-6,mSe=JE-Mu;function B7(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function vSe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return B7;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class gSe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?B7:vSe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,o){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=n-t,u=a-r,d=o-t,h=l-r,f=d*d+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(f>Mu)if(!(Math.abs(h*c-u*d)>Mu)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-o,m=a-l,v=c*c+u*u,g=p*p+m*m,x=Math.sqrt(v),y=Math.sqrt(f),b=i*Math.tan((ZE-Math.acos((v+f-g)/(2*x*y)))/2),N=b/y,j=b/x;Math.abs(N-1)>Mu&&this._append`L${t+N*d},${r+N*h}`,this._append`A${i},${i},0,0,${+(h*p>d*m)},${this._x1=t+j*c},${this._y1=r+j*u}`}}arc(t,r,n,a,i,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),u=t+l,d=r+c,h=1^o,f=o?a-i:i-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Mu||Math.abs(this._y1-d)>Mu)&&this._append`L${u},${d}`,n&&(f<0&&(f=f%JE+JE),f>mSe?this._append`A${n},${n},0,1,${h},${t-l},${r-c}A${n},${n},0,1,${h},${this._x1=u},${this._y1=d}`:f>Mu&&this._append`A${n},${n},0,${+(f>=ZE)},${h},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function EO(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new gSe(t)}function kO(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function U7(e){this._context=e}U7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function CN(e){return new U7(e)}function V7(e){return e[0]}function z7(e){return e[1]}function W7(e,t){var r=vr(!0),n=null,a=CN,i=null,o=EO(l);e=typeof e=="function"?e:e===void 0?V7:vr(e),t=typeof t=="function"?t:t===void 0?z7:vr(t);function l(c){var u,d=(c=kO(c)).length,h,f=!1,p;for(n==null&&(i=a(p=o())),u=0;u<=d;++u)!(u<d&&r(h=c[u],u,c))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(h,u,c),+t(h,u,c));if(p)return i=null,p+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:vr(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:vr(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:vr(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),l):n},l}function db(e,t,r){var n=null,a=vr(!0),i=null,o=CN,l=null,c=EO(u);e=typeof e=="function"?e:e===void 0?V7:vr(+e),t=typeof t=="function"?t:vr(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?z7:vr(+r);function u(h){var f,p,m,v=(h=kO(h)).length,g,x=!1,y,b=new Array(v),N=new Array(v);for(i==null&&(l=o(y=c())),f=0;f<=v;++f){if(!(f<v&&a(g=h[f],f,h))===x)if(x=!x)p=f,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),m=f-1;m>=p;--m)l.point(b[m],N[m]);l.lineEnd(),l.areaEnd()}x&&(b[f]=+e(g,f,h),N[f]=+t(g,f,h),l.point(n?+n(g,f,h):b[f],r?+r(g,f,h):N[f]))}if(y)return l=null,y+""||null}function d(){return W7().defined(a).curve(o).context(i)}return u.x=function(h){return arguments.length?(e=typeof h=="function"?h:vr(+h),n=null,u):e},u.x0=function(h){return arguments.length?(e=typeof h=="function"?h:vr(+h),u):e},u.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:vr(+h),u):n},u.y=function(h){return arguments.length?(t=typeof h=="function"?h:vr(+h),r=null,u):t},u.y0=function(h){return arguments.length?(t=typeof h=="function"?h:vr(+h),u):t},u.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:vr(+h),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(h){return arguments.length?(a=typeof h=="function"?h:vr(!!h),u):a},u.curve=function(h){return arguments.length?(o=h,i!=null&&(l=o(i)),u):o},u.context=function(h){return arguments.length?(h==null?i=l=null:l=o(i=h),u):i},u}class q7{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function xSe(e){return new q7(e,!0)}function ySe(e){return new q7(e,!1)}const AO={draw(e,t){const r=ro(t/jw);e.moveTo(r,0),e.arc(0,0,r,0,SN)}},bSe={draw(e,t){const r=ro(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},G7=ro(1/3),wSe=G7*2,jSe={draw(e,t){const r=ro(t/wSe),n=r*G7;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},NSe={draw(e,t){const r=ro(t),n=-r/2;e.rect(n,n,r,r)}},_Se=.8908130915292852,H7=ww(jw/10)/ww(7*jw/10),SSe=ww(SN/10)*H7,CSe=-L7(SN/10)*H7,ESe={draw(e,t){const r=ro(t*_Se),n=SSe*r,a=CSe*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const o=SN*i/5,l=L7(o),c=ww(o);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*a,c*n+l*a)}e.closePath()}},K2=ro(3),kSe={draw(e,t){const r=-ro(t/(K2*3));e.moveTo(0,r*2),e.lineTo(-K2*r,-r),e.lineTo(K2*r,-r),e.closePath()}},Us=-.5,Vs=ro(3)/2,ek=1/ro(12),ASe=(ek/2+1)*3,PSe={draw(e,t){const r=ro(t/ASe),n=r/2,a=r*ek,i=n,o=r*ek+r,l=-i,c=o;e.moveTo(n,a),e.lineTo(i,o),e.lineTo(l,c),e.lineTo(Us*n-Vs*a,Vs*n+Us*a),e.lineTo(Us*i-Vs*o,Vs*i+Us*o),e.lineTo(Us*l-Vs*c,Vs*l+Us*c),e.lineTo(Us*n+Vs*a,Us*a-Vs*n),e.lineTo(Us*i+Vs*o,Us*o-Vs*i),e.lineTo(Us*l+Vs*c,Us*c-Vs*l),e.closePath()}};function TSe(e,t){let r=null,n=EO(a);e=typeof e=="function"?e:vr(e||AO),t=typeof t=="function"?t:vr(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:vr(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:vr(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Nw(){}function _w(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function K7(e){this._context=e}K7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:_w(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:_w(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function RSe(e){return new K7(e)}function Y7(e){this._context=e}Y7.prototype={areaStart:Nw,areaEnd:Nw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:_w(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function OSe(e){return new Y7(e)}function X7(e){this._context=e}X7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:_w(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ISe(e){return new X7(e)}function Q7(e){this._context=e}Q7.prototype={areaStart:Nw,areaEnd:Nw,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function DSe(e){return new Q7(e)}function x$(e){return e<0?-1:1}function y$(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),o=(r-e._y1)/(a||n<0&&-0),l=(i*a+o*n)/(n+a);return(x$(i)+x$(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function b$(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Y2(e,t,r){var n=e._x0,a=e._y0,i=e._x1,o=e._y1,l=(i-n)/3;e._context.bezierCurveTo(n+l,a+l*t,i-l,o-l*r,i,o)}function Sw(e){this._context=e}Sw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Y2(this,this._t0,b$(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Y2(this,b$(this,r=y$(this,e,t)),r);break;default:Y2(this,this._t0,r=y$(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function Z7(e){this._context=new J7(e)}(Z7.prototype=Object.create(Sw.prototype)).point=function(e,t){Sw.prototype.point.call(this,t,e)};function J7(e){this._context=e}J7.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function MSe(e){return new Sw(e)}function $Se(e){return new Z7(e)}function eK(e){this._context=e}eK.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=w$(e),a=w$(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function w$(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function FSe(e){return new eK(e)}function EN(e,t){this._context=e,this._t=t}EN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function LSe(e){return new EN(e,.5)}function BSe(e){return new EN(e,0)}function USe(e){return new EN(e,1)}function np(e,t){if((o=e.length)>1)for(var r=1,n,a,i=e[t[0]],o,l=i.length;r<o;++r)for(a=i,i=e[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function tk(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function VSe(e,t){return e[t]}function zSe(e){const t=[];return t.key=e,t}function WSe(){var e=vr([]),t=tk,r=np,n=VSe;function a(i){var o=Array.from(e.apply(this,arguments),zSe),l,c=o.length,u=-1,d;for(const h of i)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(h,o[l].key,u,i)]).data=h;for(l=0,d=kO(t(o));l<c;++l)o[d[l]].index=l;return r(o,d),o}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:vr(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:vr(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?tk:typeof i=="function"?i:vr(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??np,a):r},a}function qSe(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,o;a<i;++a){for(o=r=0;r<n;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<n;++r)e[r][a][1]/=o}np(e,t)}}function GSe(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var o=0,l=0;o<a;++o)l+=e[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}np(e,t)}}function HSe(e,t){if(!(!((o=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,o;n<i;++n){for(var l=0,c=0,u=0;l<o;++l){for(var d=e[t[l]],h=d[n][1]||0,f=d[n-1][1]||0,p=(h-f)/2,m=0;m<l;++m){var v=e[t[m]],g=v[n][1]||0,x=v[n-1][1]||0;p+=g-x}c+=h,u+=p*h}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,np(e,t)}}function Eg(e){"@babel/helpers - typeof";return Eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eg(e)}var KSe=["type","size","sizeType"];function rk(){return rk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rk.apply(this,arguments)}function j$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function N$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j$(Object(r),!0).forEach(function(n){YSe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YSe(e,t,r){return t=XSe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XSe(e){var t=QSe(e,"string");return Eg(t)=="symbol"?t:t+""}function QSe(e,t){if(Eg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZSe(e,t){if(e==null)return{};var r=JSe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function JSe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var tK={symbolCircle:AO,symbolCross:bSe,symbolDiamond:jSe,symbolSquare:NSe,symbolStar:ESe,symbolTriangle:kSe,symbolWye:PSe},eCe=Math.PI/180,tCe=function(t){var r="symbol".concat(_N(t));return tK[r]||AO},rCe=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*eCe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},nCe=function(t,r){tK["symbol".concat(_N(t))]=r},PO=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,o=t.sizeType,l=o===void 0?"area":o,c=ZSe(t,KSe),u=N$(N$({},c),{},{type:n,size:i,sizeType:l}),d=function(){var g=tCe(n),x=TSe().type(g).size(rCe(i,l,n));return x()},h=u.className,f=u.cx,p=u.cy,m=Ct(u,!0);return f===+f&&p===+p&&i===+i?F.createElement("path",rk({},m,{className:Ut("recharts-symbols",h),transform:"translate(".concat(f,", ").concat(p,")"),d:d()})):null};PO.registerSymbol=nCe;function ap(e){"@babel/helpers - typeof";return ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ap(e)}function nk(){return nk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nk.apply(this,arguments)}function _$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function aCe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_$(Object(r),!0).forEach(function(n){kg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iCe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nK(n.key),n)}}function oCe(e,t,r){return t&&iCe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function lCe(e,t,r){return t=Cw(t),cCe(e,rK()?Reflect.construct(t,r||[],Cw(e).constructor):t.apply(e,r))}function cCe(e,t){if(t&&(ap(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uCe(e)}function uCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rK=function(){return!!e})()}function Cw(e){return Cw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cw(e)}function dCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ak(e,t)}function ak(e,t){return ak=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},ak(e,t)}function kg(e,t,r){return t=nK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nK(e){var t=hCe(e,"string");return ap(t)=="symbol"?t:t+""}function hCe(e,t){if(ap(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ap(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zs=32,TO=function(e){function t(){return sCe(this,t),lCe(this,t,arguments)}return dCe(t,e),oCe(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=zs/2,o=zs/6,l=zs/3,c=n.inactive?a:n.color;if(n.type==="plainline")return F.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:zs,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return F.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(l,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*l,",").concat(i,`
            H`).concat(zs,"M").concat(2*l,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(l,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return F.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(zs/8,"h").concat(zs,"v").concat(zs*3/4,"h").concat(-zs,"z"),className:"recharts-legend-icon"});if(F.isValidElement(n.legendIcon)){var u=aCe({},n);return delete u.legendIcon,F.cloneElement(n.legendIcon,u)}return F.createElement(PO,{fill:c,cx:i,cy:i,size:zs,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,o=a.iconSize,l=a.layout,c=a.formatter,u=a.inactiveColor,d={x:0,y:0,width:zs,height:zs},h={display:l==="horizontal"?"inline-block":"block",marginRight:10},f={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(p,m){var v=p.formatter||c,g=Ut(kg(kg({"recharts-legend-item":!0},"legend-item-".concat(m),!0),"inactive",p.inactive));if(p.type==="none")return null;var x=bt(p.value)?null:p.value;ml(!bt(p.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var y=p.inactive?u:p.color;return F.createElement("li",nk({className:g,style:h,key:"legend-item-".concat(m)},bw(n.props,p,m)),F.createElement(KE,{width:o,height:o,viewBox:d,style:f},n.renderIcon(p)),F.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},v?v(x,p,m):x))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,o=n.align;if(!a||!a.length)return null;var l={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return F.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(w.PureComponent);kg(TO,"displayName","Legend");kg(TO,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var fCe=dN;function pCe(){this.__data__=new fCe,this.size=0}var mCe=pCe;function vCe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var gCe=vCe;function xCe(e){return this.__data__.get(e)}var yCe=xCe;function bCe(e){return this.__data__.has(e)}var wCe=bCe,jCe=dN,NCe=xO,_Ce=yO,SCe=200;function CCe(e,t){var r=this.__data__;if(r instanceof jCe){var n=r.__data__;if(!NCe||n.length<SCe-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new _Ce(n)}return r.set(e,t),this.size=r.size,this}var ECe=CCe,kCe=dN,ACe=mCe,PCe=gCe,TCe=yCe,RCe=wCe,OCe=ECe;function dm(e){var t=this.__data__=new kCe(e);this.size=t.size}dm.prototype.clear=ACe;dm.prototype.delete=PCe;dm.prototype.get=TCe;dm.prototype.has=RCe;dm.prototype.set=OCe;var aK=dm,ICe="__lodash_hash_undefined__";function DCe(e){return this.__data__.set(e,ICe),this}var MCe=DCe;function $Ce(e){return this.__data__.has(e)}var FCe=$Ce,LCe=yO,BCe=MCe,UCe=FCe;function Ew(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new LCe;++t<r;)this.add(e[t])}Ew.prototype.add=Ew.prototype.push=BCe;Ew.prototype.has=UCe;var sK=Ew;function VCe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var iK=VCe;function zCe(e,t){return e.has(t)}var oK=zCe,WCe=sK,qCe=iK,GCe=oK,HCe=1,KCe=2;function YCe(e,t,r,n,a,i){var o=r&HCe,l=e.length,c=t.length;if(l!=c&&!(o&&c>l))return!1;var u=i.get(e),d=i.get(t);if(u&&d)return u==t&&d==e;var h=-1,f=!0,p=r&KCe?new WCe:void 0;for(i.set(e,t),i.set(t,e);++h<l;){var m=e[h],v=t[h];if(n)var g=o?n(v,m,h,t,e,i):n(m,v,h,e,t,i);if(g!==void 0){if(g)continue;f=!1;break}if(p){if(!qCe(t,function(x,y){if(!GCe(p,y)&&(m===x||a(m,x,r,n,i)))return p.push(y)})){f=!1;break}}else if(!(m===v||a(m,v,r,n,i))){f=!1;break}}return i.delete(e),i.delete(t),f}var lK=YCe,XCe=qo,QCe=XCe.Uint8Array,ZCe=QCe;function JCe(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var eEe=JCe;function tEe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var RO=tEe,S$=Kx,C$=ZCe,rEe=gO,nEe=lK,aEe=eEe,sEe=RO,iEe=1,oEe=2,lEe="[object Boolean]",cEe="[object Date]",uEe="[object Error]",dEe="[object Map]",hEe="[object Number]",fEe="[object RegExp]",pEe="[object Set]",mEe="[object String]",vEe="[object Symbol]",gEe="[object ArrayBuffer]",xEe="[object DataView]",E$=S$?S$.prototype:void 0,X2=E$?E$.valueOf:void 0;function yEe(e,t,r,n,a,i,o){switch(r){case xEe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case gEe:return!(e.byteLength!=t.byteLength||!i(new C$(e),new C$(t)));case lEe:case cEe:case hEe:return rEe(+e,+t);case uEe:return e.name==t.name&&e.message==t.message;case fEe:case mEe:return e==t+"";case dEe:var l=aEe;case pEe:var c=n&iEe;if(l||(l=sEe),e.size!=t.size&&!c)return!1;var u=o.get(e);if(u)return u==t;n|=oEe,o.set(e,t);var d=nEe(l(e),l(t),n,a,i,o);return o.delete(e),d;case vEe:if(X2)return X2.call(e)==X2.call(t)}return!1}var bEe=yEe;function wEe(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var cK=wEe,jEe=cK,NEe=ds;function _Ee(e,t,r){var n=t(e);return NEe(e)?n:jEe(n,r(e))}var SEe=_Ee;function CEe(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[a++]=o)}return i}var EEe=CEe;function kEe(){return[]}var AEe=kEe,PEe=EEe,TEe=AEe,REe=Object.prototype,OEe=REe.propertyIsEnumerable,k$=Object.getOwnPropertySymbols,IEe=k$?function(e){return e==null?[]:(e=Object(e),PEe(k$(e),function(t){return OEe.call(e,t)}))}:TEe,DEe=IEe;function MEe(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var $Ee=MEe,FEe=Vl,LEe=zl,BEe="[object Arguments]";function UEe(e){return LEe(e)&&FEe(e)==BEe}var VEe=UEe,A$=VEe,zEe=zl,uK=Object.prototype,WEe=uK.hasOwnProperty,qEe=uK.propertyIsEnumerable,GEe=A$(function(){return arguments}())?A$:function(e){return zEe(e)&&WEe.call(e,"callee")&&!qEe.call(e,"callee")},OO=GEe,kw={exports:{}};function HEe(){return!1}var KEe=HEe;kw.exports;(function(e,t){var r=qo,n=KEe,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===a,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,u=c||n;e.exports=u})(kw,kw.exports);var dK=kw.exports,YEe=9007199254740991,XEe=/^(?:0|[1-9]\d*)$/;function QEe(e,t){var r=typeof e;return t=t??YEe,!!t&&(r=="number"||r!="symbol"&&XEe.test(e))&&e>-1&&e%1==0&&e<t}var IO=QEe,ZEe=9007199254740991;function JEe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=ZEe}var DO=JEe,eke=Vl,tke=DO,rke=zl,nke="[object Arguments]",ake="[object Array]",ske="[object Boolean]",ike="[object Date]",oke="[object Error]",lke="[object Function]",cke="[object Map]",uke="[object Number]",dke="[object Object]",hke="[object RegExp]",fke="[object Set]",pke="[object String]",mke="[object WeakMap]",vke="[object ArrayBuffer]",gke="[object DataView]",xke="[object Float32Array]",yke="[object Float64Array]",bke="[object Int8Array]",wke="[object Int16Array]",jke="[object Int32Array]",Nke="[object Uint8Array]",_ke="[object Uint8ClampedArray]",Ske="[object Uint16Array]",Cke="[object Uint32Array]",Nr={};Nr[xke]=Nr[yke]=Nr[bke]=Nr[wke]=Nr[jke]=Nr[Nke]=Nr[_ke]=Nr[Ske]=Nr[Cke]=!0;Nr[nke]=Nr[ake]=Nr[vke]=Nr[ske]=Nr[gke]=Nr[ike]=Nr[oke]=Nr[lke]=Nr[cke]=Nr[uke]=Nr[dke]=Nr[hke]=Nr[fke]=Nr[pke]=Nr[mke]=!1;function Eke(e){return rke(e)&&tke(e.length)&&!!Nr[eke(e)]}var kke=Eke;function Ake(e){return function(t){return e(t)}}var hK=Ake,Aw={exports:{}};Aw.exports;(function(e,t){var r=y7,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,o=i&&r.process,l=function(){try{var c=a&&a.require&&a.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l})(Aw,Aw.exports);var Pke=Aw.exports,Tke=kke,Rke=hK,P$=Pke,T$=P$&&P$.isTypedArray,Oke=T$?Rke(T$):Tke,fK=Oke,Ike=$Ee,Dke=OO,Mke=ds,$ke=dK,Fke=IO,Lke=fK,Bke=Object.prototype,Uke=Bke.hasOwnProperty;function Vke(e,t){var r=Mke(e),n=!r&&Dke(e),a=!r&&!n&&$ke(e),i=!r&&!n&&!a&&Lke(e),o=r||n||a||i,l=o?Ike(e.length,String):[],c=l.length;for(var u in e)(t||Uke.call(e,u))&&!(o&&(u=="length"||a&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Fke(u,c)))&&l.push(u);return l}var zke=Vke,Wke=Object.prototype;function qke(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Wke;return e===r}var Gke=qke;function Hke(e,t){return function(r){return e(t(r))}}var pK=Hke,Kke=pK,Yke=Kke(Object.keys,Object),Xke=Yke,Qke=Gke,Zke=Xke,Jke=Object.prototype,eAe=Jke.hasOwnProperty;function tAe(e){if(!Qke(e))return Zke(e);var t=[];for(var r in Object(e))eAe.call(e,r)&&r!="constructor"&&t.push(r);return t}var rAe=tAe,nAe=vO,aAe=DO;function sAe(e){return e!=null&&aAe(e.length)&&!nAe(e)}var Yx=sAe,iAe=zke,oAe=rAe,lAe=Yx;function cAe(e){return lAe(e)?iAe(e):oAe(e)}var kN=cAe,uAe=SEe,dAe=DEe,hAe=kN;function fAe(e){return uAe(e,hAe,dAe)}var pAe=fAe,R$=pAe,mAe=1,vAe=Object.prototype,gAe=vAe.hasOwnProperty;function xAe(e,t,r,n,a,i){var o=r&mAe,l=R$(e),c=l.length,u=R$(t),d=u.length;if(c!=d&&!o)return!1;for(var h=c;h--;){var f=l[h];if(!(o?f in t:gAe.call(t,f)))return!1}var p=i.get(e),m=i.get(t);if(p&&m)return p==t&&m==e;var v=!0;i.set(e,t),i.set(t,e);for(var g=o;++h<c;){f=l[h];var x=e[f],y=t[f];if(n)var b=o?n(y,x,f,t,e,i):n(x,y,f,e,t,i);if(!(b===void 0?x===y||a(x,y,r,n,i):b)){v=!1;break}g||(g=f=="constructor")}if(v&&!g){var N=e.constructor,j=t.constructor;N!=j&&"constructor"in e&&"constructor"in t&&!(typeof N=="function"&&N instanceof N&&typeof j=="function"&&j instanceof j)&&(v=!1)}return i.delete(e),i.delete(t),v}var yAe=xAe,bAe=oh,wAe=qo,jAe=bAe(wAe,"DataView"),NAe=jAe,_Ae=oh,SAe=qo,CAe=_Ae(SAe,"Promise"),EAe=CAe,kAe=oh,AAe=qo,PAe=kAe(AAe,"Set"),mK=PAe,TAe=oh,RAe=qo,OAe=TAe(RAe,"WeakMap"),IAe=OAe,sk=NAe,ik=xO,ok=EAe,lk=mK,ck=IAe,vK=Vl,hm=w7,O$="[object Map]",DAe="[object Object]",I$="[object Promise]",D$="[object Set]",M$="[object WeakMap]",$$="[object DataView]",MAe=hm(sk),$Ae=hm(ik),FAe=hm(ok),LAe=hm(lk),BAe=hm(ck),$u=vK;(sk&&$u(new sk(new ArrayBuffer(1)))!=$$||ik&&$u(new ik)!=O$||ok&&$u(ok.resolve())!=I$||lk&&$u(new lk)!=D$||ck&&$u(new ck)!=M$)&&($u=function(e){var t=vK(e),r=t==DAe?e.constructor:void 0,n=r?hm(r):"";if(n)switch(n){case MAe:return $$;case $Ae:return O$;case FAe:return I$;case LAe:return D$;case BAe:return M$}return t});var UAe=$u,Q2=aK,VAe=lK,zAe=bEe,WAe=yAe,F$=UAe,L$=ds,B$=dK,qAe=fK,GAe=1,U$="[object Arguments]",V$="[object Array]",hb="[object Object]",HAe=Object.prototype,z$=HAe.hasOwnProperty;function KAe(e,t,r,n,a,i){var o=L$(e),l=L$(t),c=o?V$:F$(e),u=l?V$:F$(t);c=c==U$?hb:c,u=u==U$?hb:u;var d=c==hb,h=u==hb,f=c==u;if(f&&B$(e)){if(!B$(t))return!1;o=!0,d=!1}if(f&&!d)return i||(i=new Q2),o||qAe(e)?VAe(e,t,r,n,a,i):zAe(e,t,c,r,n,a,i);if(!(r&GAe)){var p=d&&z$.call(e,"__wrapped__"),m=h&&z$.call(t,"__wrapped__");if(p||m){var v=p?e.value():e,g=m?t.value():t;return i||(i=new Q2),a(v,g,r,n,i)}}return f?(i||(i=new Q2),WAe(e,t,r,n,a,i)):!1}var YAe=KAe,XAe=YAe,W$=zl;function gK(e,t,r,n,a){return e===t?!0:e==null||t==null||!W$(e)&&!W$(t)?e!==e&&t!==t:XAe(e,t,r,n,gK,a)}var MO=gK,QAe=aK,ZAe=MO,JAe=1,ePe=2;function tPe(e,t,r,n){var a=r.length,i=a,o=!n;if(e==null)return!i;for(e=Object(e);a--;){var l=r[a];if(o&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++a<i;){l=r[a];var c=l[0],u=e[c],d=l[1];if(o&&l[2]){if(u===void 0&&!(c in e))return!1}else{var h=new QAe;if(n)var f=n(u,d,c,e,t,h);if(!(f===void 0?ZAe(d,u,JAe|ePe,n,h):f))return!1}}return!0}var rPe=tPe,nPe=mu;function aPe(e){return e===e&&!nPe(e)}var xK=aPe,sPe=xK,iPe=kN;function oPe(e){for(var t=iPe(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,sPe(a)]}return t}var lPe=oPe;function cPe(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var yK=cPe,uPe=rPe,dPe=lPe,hPe=yK;function fPe(e){var t=dPe(e);return t.length==1&&t[0][2]?hPe(t[0][0],t[0][1]):function(r){return r===e||uPe(r,e,t)}}var pPe=fPe;function mPe(e,t){return e!=null&&t in Object(e)}var vPe=mPe,gPe=C7,xPe=OO,yPe=ds,bPe=IO,wPe=DO,jPe=fN;function NPe(e,t,r){t=gPe(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var o=jPe(t[n]);if(!(i=e!=null&&r(e,o)))break;e=e[o]}return i||++n!=a?i:(a=e==null?0:e.length,!!a&&wPe(a)&&bPe(o,a)&&(yPe(e)||xPe(e)))}var _Pe=NPe,SPe=vPe,CPe=_Pe;function EPe(e,t){return e!=null&&CPe(e,t,SPe)}var kPe=EPe,APe=MO,PPe=E7,TPe=kPe,RPe=mO,OPe=xK,IPe=yK,DPe=fN,MPe=1,$Pe=2;function FPe(e,t){return RPe(e)&&OPe(t)?IPe(DPe(e),t):function(r){var n=PPe(r,e);return n===void 0&&n===t?TPe(r,e):APe(t,n,MPe|$Pe)}}var LPe=FPe;function BPe(e){return e}var fm=BPe;function UPe(e){return function(t){return t==null?void 0:t[e]}}var VPe=UPe,zPe=jO;function WPe(e){return function(t){return zPe(t,e)}}var qPe=WPe,GPe=VPe,HPe=qPe,KPe=mO,YPe=fN;function XPe(e){return KPe(e)?GPe(YPe(e)):HPe(e)}var QPe=XPe,ZPe=pPe,JPe=LPe,eTe=fm,tTe=ds,rTe=QPe;function nTe(e){return typeof e=="function"?e:e==null?eTe:typeof e=="object"?tTe(e)?JPe(e[0],e[1]):ZPe(e):rTe(e)}var vu=nTe;function aTe(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var bK=aTe;function sTe(e){return e!==e}var iTe=sTe;function oTe(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var lTe=oTe,cTe=bK,uTe=iTe,dTe=lTe;function hTe(e,t,r){return t===t?dTe(e,t,r):cTe(e,uTe,r)}var fTe=hTe,pTe=fTe;function mTe(e,t){var r=e==null?0:e.length;return!!r&&pTe(e,t,0)>-1}var vTe=mTe;function gTe(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var xTe=gTe;function yTe(){}var bTe=yTe,Z2=mK,wTe=bTe,jTe=RO,NTe=1/0,_Te=Z2&&1/jTe(new Z2([,-0]))[1]==NTe?function(e){return new Z2(e)}:wTe,STe=_Te,CTe=sK,ETe=vTe,kTe=xTe,ATe=oK,PTe=STe,TTe=RO,RTe=200;function OTe(e,t,r){var n=-1,a=ETe,i=e.length,o=!0,l=[],c=l;if(r)o=!1,a=kTe;else if(i>=RTe){var u=t?null:PTe(e);if(u)return TTe(u);o=!1,a=ATe,c=new CTe}else c=t?[]:l;e:for(;++n<i;){var d=e[n],h=t?t(d):d;if(d=r||d!==0?d:0,o&&h===h){for(var f=c.length;f--;)if(c[f]===h)continue e;t&&c.push(h),l.push(d)}else a(c,h,r)||(c!==l&&c.push(h),l.push(d))}return l}var ITe=OTe,DTe=vu,MTe=ITe;function $Te(e,t){return e&&e.length?MTe(e,DTe(t)):[]}var FTe=$Te;const q$=lr(FTe);function wK(e,t,r){return t===!0?q$(e,r):bt(t)?q$(e,t):e}function sp(e){"@babel/helpers - typeof";return sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sp(e)}var LTe=["ref"];function G$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Xo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G$(Object(r),!0).forEach(function(n){AN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NK(n.key),n)}}function UTe(e,t,r){return t&&H$(e.prototype,t),r&&H$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VTe(e,t,r){return t=Pw(t),zTe(e,jK()?Reflect.construct(t,r||[],Pw(e).constructor):t.apply(e,r))}function zTe(e,t){if(t&&(sp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WTe(e)}function WTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jK=function(){return!!e})()}function Pw(e){return Pw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pw(e)}function qTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uk(e,t)}function uk(e,t){return uk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},uk(e,t)}function AN(e,t,r){return t=NK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NK(e){var t=GTe(e,"string");return sp(t)=="symbol"?t:t+""}function GTe(e,t){if(sp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HTe(e,t){if(e==null)return{};var r=KTe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function KTe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function YTe(e){return e.value}function XTe(e,t){if(F.isValidElement(e))return F.cloneElement(e,t);if(typeof e=="function")return F.createElement(e,t);t.ref;var r=HTe(t,LTe);return F.createElement(TO,r)}var K$=1,Cf=function(e){function t(){var r;BTe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=VTe(this,t,[].concat(a)),AN(r,"lastBoundingBox",{width:-1,height:-1}),r}return qTe(t,e),UTe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>K$||Math.abs(a.height-this.lastBoundingBox.height)>K$)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Xo({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,o=a.align,l=a.verticalAlign,c=a.margin,u=a.chartWidth,d=a.chartHeight,h,f;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&i==="vertical"){var p=this.getBBoxSnapshot();h={left:((u||0)-p.width)/2}}else h=o==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(l==="middle"){var m=this.getBBoxSnapshot();f={top:((d||0)-m.height)/2}}else f=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return Xo(Xo({},h),f)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,o=a.width,l=a.height,c=a.wrapperStyle,u=a.payloadUniqBy,d=a.payload,h=Xo(Xo({position:"absolute",width:o||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return F.createElement("div",{className:"recharts-legend-wrapper",style:h,ref:function(p){n.wrapperNode=p}},XTe(i,Xo(Xo({},this.props),{},{payload:wK(d,u,YTe)})))}}],[{key:"getWithHeight",value:function(n,a){var i=Xo(Xo({},this.defaultProps),n.props),o=i.layout;return o==="vertical"&&Te(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||a}:null}}])}(w.PureComponent);AN(Cf,"displayName","Legend");AN(Cf,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var Y$=Kx,QTe=OO,ZTe=ds,X$=Y$?Y$.isConcatSpreadable:void 0;function JTe(e){return ZTe(e)||QTe(e)||!!(X$&&e&&e[X$])}var eRe=JTe,tRe=cK,rRe=eRe;function _K(e,t,r,n,a){var i=-1,o=e.length;for(r||(r=rRe),a||(a=[]);++i<o;){var l=e[i];t>0&&r(l)?t>1?_K(l,t-1,r,n,a):tRe(a,l):n||(a[a.length]=l)}return a}var SK=_K;function nRe(e){return function(t,r,n){for(var a=-1,i=Object(t),o=n(t),l=o.length;l--;){var c=o[e?l:++a];if(r(i[c],c,i)===!1)break}return t}}var aRe=nRe,sRe=aRe,iRe=sRe(),oRe=iRe,lRe=oRe,cRe=kN;function uRe(e,t){return e&&lRe(e,t,cRe)}var CK=uRe,dRe=Yx;function hRe(e,t){return function(r,n){if(r==null)return r;if(!dRe(r))return e(r,n);for(var a=r.length,i=t?a:-1,o=Object(r);(t?i--:++i<a)&&n(o[i],i,o)!==!1;);return r}}var fRe=hRe,pRe=CK,mRe=fRe,vRe=mRe(pRe),$O=vRe,gRe=$O,xRe=Yx;function yRe(e,t){var r=-1,n=xRe(e)?Array(e.length):[];return gRe(e,function(a,i,o){n[++r]=t(a,i,o)}),n}var EK=yRe;function bRe(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var wRe=bRe,Q$=am;function jRe(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,i=Q$(e),o=t!==void 0,l=t===null,c=t===t,u=Q$(t);if(!l&&!u&&!i&&e>t||i&&o&&c&&!l&&!u||n&&o&&c||!r&&c||!a)return 1;if(!n&&!i&&!u&&e<t||u&&r&&a&&!n&&!i||l&&r&&a||!o&&a||!c)return-1}return 0}var NRe=jRe,_Re=NRe;function SRe(e,t,r){for(var n=-1,a=e.criteria,i=t.criteria,o=a.length,l=r.length;++n<o;){var c=_Re(a[n],i[n]);if(c){if(n>=l)return c;var u=r[n];return c*(u=="desc"?-1:1)}}return e.index-t.index}var CRe=SRe,J2=wO,ERe=jO,kRe=vu,ARe=EK,PRe=wRe,TRe=hK,RRe=CRe,ORe=fm,IRe=ds;function DRe(e,t,r){t.length?t=J2(t,function(i){return IRe(i)?function(o){return ERe(o,i.length===1?i[0]:i)}:i}):t=[ORe];var n=-1;t=J2(t,TRe(kRe));var a=ARe(e,function(i,o,l){var c=J2(t,function(u){return u(i)});return{criteria:c,index:++n,value:i}});return PRe(a,function(i,o){return RRe(i,o,r)})}var MRe=DRe;function $Re(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var FRe=$Re,LRe=FRe,Z$=Math.max;function BRe(e,t,r){return t=Z$(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=Z$(n.length-t,0),o=Array(i);++a<i;)o[a]=n[t+a];a=-1;for(var l=Array(t+1);++a<t;)l[a]=n[a];return l[t]=r(o),LRe(e,this,l)}}var URe=BRe;function VRe(e){return function(){return e}}var zRe=VRe,WRe=oh,qRe=function(){try{var e=WRe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),kK=qRe,GRe=zRe,J$=kK,HRe=fm,KRe=J$?function(e,t){return J$(e,"toString",{configurable:!0,enumerable:!1,value:GRe(t),writable:!0})}:HRe,YRe=KRe,XRe=800,QRe=16,ZRe=Date.now;function JRe(e){var t=0,r=0;return function(){var n=ZRe(),a=QRe-(n-r);if(r=n,a>0){if(++t>=XRe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var eOe=JRe,tOe=YRe,rOe=eOe,nOe=rOe(tOe),aOe=nOe,sOe=fm,iOe=URe,oOe=aOe;function lOe(e,t){return oOe(iOe(e,t,sOe),e+"")}var cOe=lOe,uOe=gO,dOe=Yx,hOe=IO,fOe=mu;function pOe(e,t,r){if(!fOe(r))return!1;var n=typeof t;return(n=="number"?dOe(r)&&hOe(t,r.length):n=="string"&&t in r)?uOe(r[t],e):!1}var PN=pOe,mOe=SK,vOe=MRe,gOe=cOe,eF=PN,xOe=gOe(function(e,t){if(e==null)return[];var r=t.length;return r>1&&eF(e,t[0],t[1])?t=[]:r>2&&eF(t[0],t[1],t[2])&&(t=[t[0]]),vOe(e,mOe(t,1),[])}),yOe=xOe;const FO=lr(yOe);function Ag(e){"@babel/helpers - typeof";return Ag=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ag(e)}function dk(){return dk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dk.apply(this,arguments)}function bOe(e,t){return _Oe(e)||NOe(e,t)||jOe(e,t)||wOe()}function wOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jOe(e,t){if(e){if(typeof e=="string")return tF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tF(e,t)}}function tF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function _Oe(e){if(Array.isArray(e))return e}function rF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function eS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rF(Object(r),!0).forEach(function(n){SOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SOe(e,t,r){return t=COe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function COe(e){var t=EOe(e,"string");return Ag(t)=="symbol"?t:t+""}function EOe(e,t){if(Ag(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ag(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kOe(e){return Array.isArray(e)&&kn(e[0])&&kn(e[1])?e.join(" ~ "):e}var AOe=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,o=t.itemStyle,l=o===void 0?{}:o,c=t.labelStyle,u=c===void 0?{}:c,d=t.payload,h=t.formatter,f=t.itemSorter,p=t.wrapperClassName,m=t.labelClassName,v=t.label,g=t.labelFormatter,x=t.accessibilityLayer,y=x===void 0?!1:x,b=function(){if(d&&d.length){var A={padding:0,margin:0},O=(f?FO(d,f):d).map(function(I,R){if(I.type==="none")return null;var M=eS({display:"block",paddingTop:4,paddingBottom:4,color:I.color||"#000"},l),B=I.formatter||h||kOe,$=I.value,D=I.name,W=$,Z=D;if(B&&W!=null&&Z!=null){var U=B($,D,I,R,d);if(Array.isArray(U)){var Y=bOe(U,2);W=Y[0],Z=Y[1]}else W=U}return F.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(R),style:M},kn(Z)?F.createElement("span",{className:"recharts-tooltip-item-name"},Z):null,kn(Z)?F.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,F.createElement("span",{className:"recharts-tooltip-item-value"},W),F.createElement("span",{className:"recharts-tooltip-item-unit"},I.unit||""))});return F.createElement("ul",{className:"recharts-tooltip-item-list",style:A},O)}return null},N=eS({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),j=eS({margin:0},u),_=!Ot(v),S=_?v:"",C=Ut("recharts-default-tooltip",p),E=Ut("recharts-tooltip-label",m);_&&g&&d!==void 0&&d!==null&&(S=g(v,d));var k=y?{role:"status","aria-live":"assertive"}:{};return F.createElement("div",dk({className:C,style:N},k),F.createElement("p",{className:E,style:j},F.isValidElement(S)?S:"".concat(S)),b())};function Pg(e){"@babel/helpers - typeof";return Pg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pg(e)}function fb(e,t,r){return t=POe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function POe(e){var t=TOe(e,"string");return Pg(t)=="symbol"?t:t+""}function TOe(e,t){if(Pg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vm="recharts-tooltip-wrapper",ROe={visibility:"hidden"};function OOe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return Ut(Vm,fb(fb(fb(fb({},"".concat(Vm,"-right"),Te(r)&&t&&Te(t.x)&&r>=t.x),"".concat(Vm,"-left"),Te(r)&&t&&Te(t.x)&&r<t.x),"".concat(Vm,"-bottom"),Te(n)&&t&&Te(t.y)&&n>=t.y),"".concat(Vm,"-top"),Te(n)&&t&&Te(t.y)&&n<t.y))}function nF(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,i=e.position,o=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,u=e.viewBoxDimension;if(i&&Te(i[n]))return i[n];var d=r[n]-l-a,h=r[n]+a;if(t[n])return o[n]?d:h;if(o[n]){var f=d,p=c[n];return f<p?Math.max(h,c[n]):Math.max(d,c[n])}var m=h+l,v=c[n]+u;return m>v?Math.max(d,c[n]):Math.max(h,c[n])}function IOe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function DOe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,i=e.reverseDirection,o=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,u,d,h;return o.height>0&&o.width>0&&r?(d=nF({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),h=nF({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),u=IOe({translateX:d,translateY:h,useTranslate3d:l})):u=ROe,{cssProperties:u,cssClasses:OOe({translateX:d,translateY:h,coordinate:r})}}function ip(e){"@babel/helpers - typeof";return ip=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ip(e)}function aF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aF(Object(r),!0).forEach(function(n){fk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $Oe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PK(n.key),n)}}function FOe(e,t,r){return t&&$Oe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function LOe(e,t,r){return t=Tw(t),BOe(e,AK()?Reflect.construct(t,r||[],Tw(e).constructor):t.apply(e,r))}function BOe(e,t){if(t&&(ip(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UOe(e)}function UOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(AK=function(){return!!e})()}function Tw(e){return Tw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tw(e)}function VOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hk(e,t)}function hk(e,t){return hk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},hk(e,t)}function fk(e,t,r){return t=PK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PK(e){var t=zOe(e,"string");return ip(t)=="symbol"?t:t+""}function zOe(e,t){if(ip(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ip(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iF=1,WOe=function(e){function t(){var r;MOe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=LOe(this,t,[].concat(a)),fk(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),fk(r,"handleKeyDown",function(o){if(o.key==="Escape"){var l,c,u,d;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(u=(d=r.props.coordinate)===null||d===void 0?void 0:d.y)!==null&&u!==void 0?u:0}})}}),r}return VOe(t,e),FOe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>iF||Math.abs(n.height-this.state.lastBoundingBox.height)>iF)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,u=a.children,d=a.coordinate,h=a.hasPayload,f=a.isAnimationActive,p=a.offset,m=a.position,v=a.reverseDirection,g=a.useTranslate3d,x=a.viewBox,y=a.wrapperStyle,b=DOe({allowEscapeViewBox:o,coordinate:d,offsetTopLeft:p,position:m,reverseDirection:v,tooltipBox:this.state.lastBoundingBox,useTranslate3d:g,viewBox:x}),N=b.cssClasses,j=b.cssProperties,_=sF(sF({transition:f&&i?"transform ".concat(l,"ms ").concat(c):void 0},j),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&h?"visible":"hidden",position:"absolute",top:0,left:0},y);return F.createElement("div",{tabIndex:-1,className:N,style:_,ref:function(C){n.wrapperNode=C}},u)}}])}(w.PureComponent),qOe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Po={isSsr:qOe(),get:function(t){return Po[t]},set:function(t,r){if(typeof t=="string")Po[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(a){Po[a]=t[a]})}}};function op(e){"@babel/helpers - typeof";return op=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},op(e)}function oF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oF(Object(r),!0).forEach(function(n){LO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HOe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RK(n.key),n)}}function KOe(e,t,r){return t&&HOe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function YOe(e,t,r){return t=Rw(t),XOe(e,TK()?Reflect.construct(t,r||[],Rw(e).constructor):t.apply(e,r))}function XOe(e,t){if(t&&(op(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QOe(e)}function QOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(TK=function(){return!!e})()}function Rw(e){return Rw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rw(e)}function ZOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pk(e,t)}function pk(e,t){return pk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},pk(e,t)}function LO(e,t,r){return t=RK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RK(e){var t=JOe(e,"string");return op(t)=="symbol"?t:t+""}function JOe(e,t){if(op(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(op(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eIe(e){return e.dataKey}function tIe(e,t){return F.isValidElement(e)?F.cloneElement(e,t):typeof e=="function"?F.createElement(e,t):F.createElement(AOe,t)}var lo=function(e){function t(){return GOe(this,t),YOe(this,t,arguments)}return ZOe(t,e),KOe(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,u=a.content,d=a.coordinate,h=a.filterNull,f=a.isAnimationActive,p=a.offset,m=a.payload,v=a.payloadUniqBy,g=a.position,x=a.reverseDirection,y=a.useTranslate3d,b=a.viewBox,N=a.wrapperStyle,j=m??[];h&&j.length&&(j=wK(m.filter(function(S){return S.value!=null&&(S.hide!==!0||n.props.includeHidden)}),v,eIe));var _=j.length>0;return F.createElement(WOe,{allowEscapeViewBox:o,animationDuration:l,animationEasing:c,isAnimationActive:f,active:i,coordinate:d,hasPayload:_,offset:p,position:g,reverseDirection:x,useTranslate3d:y,viewBox:b,wrapperStyle:N},tIe(u,lF(lF({},this.props),{},{payload:j})))}}])}(w.PureComponent);LO(lo,"displayName","Tooltip");LO(lo,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Po.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var rIe=qo,nIe=function(){return rIe.Date.now()},aIe=nIe,sIe=/\s/;function iIe(e){for(var t=e.length;t--&&sIe.test(e.charAt(t)););return t}var oIe=iIe,lIe=oIe,cIe=/^\s+/;function uIe(e){return e&&e.slice(0,lIe(e)+1).replace(cIe,"")}var dIe=uIe,hIe=dIe,cF=mu,fIe=am,uF=NaN,pIe=/^[-+]0x[0-9a-f]+$/i,mIe=/^0b[01]+$/i,vIe=/^0o[0-7]+$/i,gIe=parseInt;function xIe(e){if(typeof e=="number")return e;if(fIe(e))return uF;if(cF(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=cF(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=hIe(e);var r=mIe.test(e);return r||vIe.test(e)?gIe(e.slice(2),r?2:8):pIe.test(e)?uF:+e}var OK=xIe,yIe=mu,tS=aIe,dF=OK,bIe="Expected a function",wIe=Math.max,jIe=Math.min;function NIe(e,t,r){var n,a,i,o,l,c,u=0,d=!1,h=!1,f=!0;if(typeof e!="function")throw new TypeError(bIe);t=dF(t)||0,yIe(r)&&(d=!!r.leading,h="maxWait"in r,i=h?wIe(dF(r.maxWait)||0,t):i,f="trailing"in r?!!r.trailing:f);function p(_){var S=n,C=a;return n=a=void 0,u=_,o=e.apply(C,S),o}function m(_){return u=_,l=setTimeout(x,t),d?p(_):o}function v(_){var S=_-c,C=_-u,E=t-S;return h?jIe(E,i-C):E}function g(_){var S=_-c,C=_-u;return c===void 0||S>=t||S<0||h&&C>=i}function x(){var _=tS();if(g(_))return y(_);l=setTimeout(x,v(_))}function y(_){return l=void 0,f&&n?p(_):(n=a=void 0,o)}function b(){l!==void 0&&clearTimeout(l),u=0,n=c=a=l=void 0}function N(){return l===void 0?o:y(tS())}function j(){var _=tS(),S=g(_);if(n=arguments,a=this,c=_,S){if(l===void 0)return m(c);if(h)return clearTimeout(l),l=setTimeout(x,t),p(c)}return l===void 0&&(l=setTimeout(x,t)),o}return j.cancel=b,j.flush=N,j}var _Ie=NIe,SIe=_Ie,CIe=mu,EIe="Expected a function";function kIe(e,t,r){var n=!0,a=!0;if(typeof e!="function")throw new TypeError(EIe);return CIe(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),SIe(e,t,{leading:n,maxWait:t,trailing:a})}var AIe=kIe;const IK=lr(AIe);function Tg(e){"@babel/helpers - typeof";return Tg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tg(e)}function hF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hF(Object(r),!0).forEach(function(n){PIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PIe(e,t,r){return t=TIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TIe(e){var t=RIe(e,"string");return Tg(t)=="symbol"?t:t+""}function RIe(e,t){if(Tg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function OIe(e,t){return $Ie(e)||MIe(e,t)||DIe(e,t)||IIe()}function IIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DIe(e,t){if(e){if(typeof e=="string")return fF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fF(e,t)}}function fF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function $Ie(e){if(Array.isArray(e))return e}var FIe=w.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=e.width,o=i===void 0?"100%":i,l=e.height,c=l===void 0?"100%":l,u=e.minWidth,d=u===void 0?0:u,h=e.minHeight,f=e.maxHeight,p=e.children,m=e.debounce,v=m===void 0?0:m,g=e.id,x=e.className,y=e.onResize,b=e.style,N=b===void 0?{}:b,j=w.useRef(null),_=w.useRef();_.current=y,w.useImperativeHandle(t,function(){return Object.defineProperty(j.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),j.current},configurable:!0})});var S=w.useState({containerWidth:a.width,containerHeight:a.height}),C=OIe(S,2),E=C[0],k=C[1],P=w.useCallback(function(O,I){k(function(R){var M=Math.round(O),B=Math.round(I);return R.containerWidth===M&&R.containerHeight===B?R:{containerWidth:M,containerHeight:B}})},[]);w.useEffect(function(){var O=function(D){var W,Z=D[0].contentRect,U=Z.width,Y=Z.height;P(U,Y),(W=_.current)===null||W===void 0||W.call(_,U,Y)};v>0&&(O=IK(O,v,{trailing:!0,leading:!1}));var I=new ResizeObserver(O),R=j.current.getBoundingClientRect(),M=R.width,B=R.height;return P(M,B),I.observe(j.current),function(){I.disconnect()}},[P,v]);var A=w.useMemo(function(){var O=E.containerWidth,I=E.containerHeight;if(O<0||I<0)return null;ml(Qu(o)||Qu(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,c),ml(!r||r>0,"The aspect(%s) must be greater than zero.",r);var R=Qu(o)?O:o,M=Qu(c)?I:c;r&&r>0&&(R?M=R/r:M&&(R=M*r),f&&M>f&&(M=f)),ml(R>0||M>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,R,M,o,c,d,h,r);var B=!Array.isArray(p)&&pl(p.type).endsWith("Chart");return F.Children.map(p,function($){return F.isValidElement($)?w.cloneElement($,pb({width:R,height:M},B?{style:pb({height:"100%",width:"100%",maxHeight:M,maxWidth:R},$.props.style)}:{})):$})},[r,p,c,f,h,d,E,o]);return F.createElement("div",{id:g?"".concat(g):void 0,className:Ut("recharts-responsive-container",x),style:pb(pb({},N),{},{width:o,height:c,minWidth:d,minHeight:h,maxHeight:f}),ref:j},A)}),DK=function(t){return null};DK.displayName="Cell";function Rg(e){"@babel/helpers - typeof";return Rg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rg(e)}function pF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pF(Object(r),!0).forEach(function(n){LIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LIe(e,t,r){return t=BIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BIe(e){var t=UIe(e,"string");return Rg(t)=="symbol"?t:t+""}function UIe(e,t){if(Rg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sh={widthCache:{},cacheCount:0},VIe=2e3,zIe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},mF="recharts_measurement_span";function WIe(e){var t=mk({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var Rv=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Po.isSsr)return{width:0,height:0};var n=WIe(r),a=JSON.stringify({text:t,copyStyle:n});if(Sh.widthCache[a])return Sh.widthCache[a];try{var i=document.getElementById(mF);i||(i=document.createElement("span"),i.setAttribute("id",mF),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=mk(mk({},zIe),n);Object.assign(i.style,o),i.textContent="".concat(t);var l=i.getBoundingClientRect(),c={width:l.width,height:l.height};return Sh.widthCache[a]=c,++Sh.cacheCount>VIe&&(Sh.cacheCount=0,Sh.widthCache={}),c}catch{return{width:0,height:0}}},qIe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Og(e){"@babel/helpers - typeof";return Og=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Og(e)}function Ow(e,t){return YIe(e)||KIe(e,t)||HIe(e,t)||GIe()}function GIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HIe(e,t){if(e){if(typeof e=="string")return vF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vF(e,t)}}function vF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function YIe(e){if(Array.isArray(e))return e}function XIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZIe(n.key),n)}}function QIe(e,t,r){return t&&gF(e.prototype,t),r&&gF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZIe(e){var t=JIe(e,"string");return Og(t)=="symbol"?t:t+""}function JIe(e,t){if(Og(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Og(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var xF=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,yF=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,e4e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,t4e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,MK={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},r4e=Object.keys(MK),tf="NaN";function n4e(e,t){return e*MK[t]}var mb=function(){function e(t,r){XIe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!e4e.test(r)&&(this.num=NaN,this.unit=""),r4e.includes(r)&&(this.num=n4e(t,r),this.unit="px")}return QIe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=t4e.exec(r))!==null&&n!==void 0?n:[],i=Ow(a,3),o=i[1],l=i[2];return new e(parseFloat(o),l??"")}}])}();function $K(e){if(e.includes(tf))return tf;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=xF.exec(t))!==null&&r!==void 0?r:[],a=Ow(n,4),i=a[1],o=a[2],l=a[3],c=mb.parse(i??""),u=mb.parse(l??""),d=o==="*"?c.multiply(u):c.divide(u);if(d.isNaN())return tf;t=t.replace(xF,d.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var h,f=(h=yF.exec(t))!==null&&h!==void 0?h:[],p=Ow(f,4),m=p[1],v=p[2],g=p[3],x=mb.parse(m??""),y=mb.parse(g??""),b=v==="+"?x.add(y):x.subtract(y);if(b.isNaN())return tf;t=t.replace(yF,b.toString())}return t}var bF=/\(([^()]*)\)/;function a4e(e){for(var t=e;t.includes("(");){var r=bF.exec(t),n=Ow(r,2),a=n[1];t=t.replace(bF,$K(a))}return t}function s4e(e){var t=e.replace(/\s+/g,"");return t=a4e(t),t=$K(t),t}function i4e(e){try{return s4e(e)}catch{return tf}}function rS(e){var t=i4e(e.slice(5,-1));return t===tf?"":t}var o4e=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],l4e=["dx","dy","angle","className","breakAll"];function vk(){return vk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vk.apply(this,arguments)}function wF(e,t){if(e==null)return{};var r=c4e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function c4e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function jF(e,t){return f4e(e)||h4e(e,t)||d4e(e,t)||u4e()}function u4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d4e(e,t){if(e){if(typeof e=="string")return NF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NF(e,t)}}function NF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h4e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function f4e(e){if(Array.isArray(e))return e}var FK=/[ \f\n\r\t\v\u2028\u2029]+/,LK=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];Ot(r)||(n?i=r.toString().split(""):i=r.toString().split(FK));var o=i.map(function(c){return{word:c,width:Rv(c,a).width}}),l=n?0:Rv("",a).width;return{wordsWithComputedWidth:o,spaceWidth:l}}catch{return null}},p4e=function(t,r,n,a,i){var o=t.maxLines,l=t.children,c=t.style,u=t.breakAll,d=Te(o),h=l,f=function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return R.reduce(function(M,B){var $=B.word,D=B.width,W=M[M.length-1];if(W&&(a==null||i||W.width+D+n<Number(a)))W.words.push($),W.width+=D+n;else{var Z={words:[$],width:D};M.push(Z)}return M},[])},p=f(r),m=function(R){return R.reduce(function(M,B){return M.width>B.width?M:B})};if(!d)return p;for(var v="",g=function(R){var M=h.slice(0,R),B=LK({breakAll:u,style:c,children:M+v}).wordsWithComputedWidth,$=f(B),D=$.length>o||m($).width>Number(a);return[D,$]},x=0,y=h.length-1,b=0,N;x<=y&&b<=h.length-1;){var j=Math.floor((x+y)/2),_=j-1,S=g(_),C=jF(S,2),E=C[0],k=C[1],P=g(j),A=jF(P,1),O=A[0];if(!E&&!O&&(x=j+1),E&&O&&(y=j-1),!E&&O){N=k;break}b++}return N||p},_F=function(t){var r=Ot(t)?[]:t.toString().split(FK);return[{words:r}]},m4e=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,o=t.breakAll,l=t.maxLines;if((r||n)&&!Po.isSsr){var c,u,d=LK({breakAll:o,children:a,style:i});if(d){var h=d.wordsWithComputedWidth,f=d.spaceWidth;c=h,u=f}else return _F(a);return p4e({breakAll:o,children:a,maxLines:l,style:i},c,u,r,n)}return _F(a)},SF="#808080",Iw=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.lineHeight,l=o===void 0?"1em":o,c=t.capHeight,u=c===void 0?"0.71em":c,d=t.scaleToFit,h=d===void 0?!1:d,f=t.textAnchor,p=f===void 0?"start":f,m=t.verticalAnchor,v=m===void 0?"end":m,g=t.fill,x=g===void 0?SF:g,y=wF(t,o4e),b=w.useMemo(function(){return m4e({breakAll:y.breakAll,children:y.children,maxLines:y.maxLines,scaleToFit:h,style:y.style,width:y.width})},[y.breakAll,y.children,y.maxLines,h,y.style,y.width]),N=y.dx,j=y.dy,_=y.angle,S=y.className,C=y.breakAll,E=wF(y,l4e);if(!kn(n)||!kn(i))return null;var k=n+(Te(N)?N:0),P=i+(Te(j)?j:0),A;switch(v){case"start":A=rS("calc(".concat(u,")"));break;case"middle":A=rS("calc(".concat((b.length-1)/2," * -").concat(l," + (").concat(u," / 2))"));break;default:A=rS("calc(".concat(b.length-1," * -").concat(l,")"));break}var O=[];if(h){var I=b[0].width,R=y.width;O.push("scale(".concat((Te(R)?R/I:1)/I,")"))}return _&&O.push("rotate(".concat(_,", ").concat(k,", ").concat(P,")")),O.length&&(E.transform=O.join(" ")),F.createElement("text",vk({},Ct(E,!0),{x:k,y:P,className:Ut("recharts-text",S),textAnchor:p,fill:x.includes("url")?SF:x}),b.map(function(M,B){var $=M.words.join(C?"":" ");return F.createElement("tspan",{x:k,dy:B===0?A:l,key:"".concat($,"-").concat(B)},$)}))};function Gc(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function v4e(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function BO(e){let t,r,n;e.length!==2?(t=Gc,r=(l,c)=>Gc(e(l),c),n=(l,c)=>e(l)-c):(t=e===Gc||e===v4e?e:g4e,r=e,n=e);function a(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const h=u+d>>>1;r(l[h],c)<0?u=h+1:d=h}while(u<d)}return u}function i(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const h=u+d>>>1;r(l[h],c)<=0?u=h+1:d=h}while(u<d)}return u}function o(l,c,u=0,d=l.length){const h=a(l,c,u,d-1);return h>u&&n(l[h-1],c)>-n(l[h],c)?h-1:h}return{left:a,center:o,right:i}}function g4e(){return 0}function BK(e){return e===null?NaN:+e}function*x4e(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const y4e=BO(Gc),Xx=y4e.right;BO(BK).center;class CF extends Map{constructor(t,r=j4e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(EF(this,t))}has(t){return super.has(EF(this,t))}set(t,r){return super.set(b4e(this,t),r)}delete(t){return super.delete(w4e(this,t))}}function EF({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function b4e({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function w4e({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function j4e(e){return e!==null&&typeof e=="object"?e.valueOf():e}function N4e(e=Gc){if(e===Gc)return UK;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function UK(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const _4e=Math.sqrt(50),S4e=Math.sqrt(10),C4e=Math.sqrt(2);function Dw(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),o=i>=_4e?10:i>=S4e?5:i>=C4e?2:1;let l,c,u;return a<0?(u=Math.pow(10,-a)/o,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,a)*o,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=r&&r<2?Dw(e,t,r*2):[l,c,u]}function gk(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,o]=n?Dw(t,e,r):Dw(e,t,r);if(!(i>=a))return[];const l=i-a+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(i-u)/-o;else for(let u=0;u<l;++u)c[u]=(i-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(a+u)/-o;else for(let u=0;u<l;++u)c[u]=(a+u)*o;return c}function xk(e,t,r){return t=+t,e=+e,r=+r,Dw(e,t,r)[2]}function yk(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?xk(t,e,r):xk(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function kF(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function AF(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function VK(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?UK:N4e(a);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),h=.5*Math.exp(2*d/3),f=.5*Math.sqrt(d*h*(c-h)/c)*(u-c/2<0?-1:1),p=Math.max(r,Math.floor(t-u*h/c+f)),m=Math.min(n,Math.floor(t+(c-u)*h/c+f));VK(e,t,p,m,a)}const i=e[t];let o=r,l=n;for(zm(e,r,t),a(e[n],i)>0&&zm(e,r,n);o<l;){for(zm(e,o,l),++o,--l;a(e[o],i)<0;)++o;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?zm(e,r,l):(++l,zm(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function zm(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function E4e(e,t,r){if(e=Float64Array.from(x4e(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return AF(e);if(t>=1)return kF(e);var n,a=(n-1)*t,i=Math.floor(a),o=kF(VK(e,i).subarray(0,i+1)),l=AF(e.subarray(i+1));return o+(l-o)*(a-i)}}function k4e(e,t,r=BK){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),o=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return o+(l-o)*(a-i)}}function A4e(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function fi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Wl(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const bk=Symbol("implicit");function UO(){var e=new CF,t=[],r=[],n=bk;function a(i){let o=e.get(i);if(o===void 0){if(n!==bk)return n;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new CF;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return UO(t,r).unknown(n)},fi.apply(a,arguments),a}function Ig(){var e=UO().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,o,l=!1,c=0,u=0,d=.5;delete e.unknown;function h(){var f=t().length,p=a<n,m=p?a:n,v=p?n:a;i=(v-m)/Math.max(1,f-c+u*2),l&&(i=Math.floor(i)),m+=(v-m-i*(f-c))*d,o=i*(1-c),l&&(m=Math.round(m),o=Math.round(o));var g=A4e(f).map(function(x){return m+i*x});return r(p?g.reverse():g)}return e.domain=function(f){return arguments.length?(t(f),h()):t()},e.range=function(f){return arguments.length?([n,a]=f,n=+n,a=+a,h()):[n,a]},e.rangeRound=function(f){return[n,a]=f,n=+n,a=+a,l=!0,h()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(l=!!f,h()):l},e.padding=function(f){return arguments.length?(c=Math.min(1,u=+f),h()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),h()):c},e.paddingOuter=function(f){return arguments.length?(u=+f,h()):u},e.align=function(f){return arguments.length?(d=Math.max(0,Math.min(1,f)),h()):d},e.copy=function(){return Ig(t(),[n,a]).round(l).paddingInner(c).paddingOuter(u).align(d)},fi.apply(h(),arguments)}function zK(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return zK(t())},e}function Ov(){return zK(Ig.apply(null,arguments).paddingInner(1))}function VO(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function WK(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Qx(){}var Dg=.7,Mw=1/Dg,Ef="\\s*([+-]?\\d+)\\s*",Mg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",To="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",P4e=/^#([0-9a-f]{3,8})$/,T4e=new RegExp(`^rgb\\(${Ef},${Ef},${Ef}\\)$`),R4e=new RegExp(`^rgb\\(${To},${To},${To}\\)$`),O4e=new RegExp(`^rgba\\(${Ef},${Ef},${Ef},${Mg}\\)$`),I4e=new RegExp(`^rgba\\(${To},${To},${To},${Mg}\\)$`),D4e=new RegExp(`^hsl\\(${Mg},${To},${To}\\)$`),M4e=new RegExp(`^hsla\\(${Mg},${To},${To},${Mg}\\)$`),PF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};VO(Qx,$g,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:TF,formatHex:TF,formatHex8:$4e,formatHsl:F4e,formatRgb:RF,toString:RF});function TF(){return this.rgb().formatHex()}function $4e(){return this.rgb().formatHex8()}function F4e(){return qK(this).formatHsl()}function RF(){return this.rgb().formatRgb()}function $g(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=P4e.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?OF(t):r===3?new ns(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?vb(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?vb(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=T4e.exec(e))?new ns(t[1],t[2],t[3],1):(t=R4e.exec(e))?new ns(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=O4e.exec(e))?vb(t[1],t[2],t[3],t[4]):(t=I4e.exec(e))?vb(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=D4e.exec(e))?MF(t[1],t[2]/100,t[3]/100,1):(t=M4e.exec(e))?MF(t[1],t[2]/100,t[3]/100,t[4]):PF.hasOwnProperty(e)?OF(PF[e]):e==="transparent"?new ns(NaN,NaN,NaN,0):null}function OF(e){return new ns(e>>16&255,e>>8&255,e&255,1)}function vb(e,t,r,n){return n<=0&&(e=t=r=NaN),new ns(e,t,r,n)}function L4e(e){return e instanceof Qx||(e=$g(e)),e?(e=e.rgb(),new ns(e.r,e.g,e.b,e.opacity)):new ns}function wk(e,t,r,n){return arguments.length===1?L4e(e):new ns(e,t,r,n??1)}function ns(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}VO(ns,wk,WK(Qx,{brighter(e){return e=e==null?Mw:Math.pow(Mw,e),new ns(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Dg:Math.pow(Dg,e),new ns(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ns(xd(this.r),xd(this.g),xd(this.b),$w(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:IF,formatHex:IF,formatHex8:B4e,formatRgb:DF,toString:DF}));function IF(){return`#${Zu(this.r)}${Zu(this.g)}${Zu(this.b)}`}function B4e(){return`#${Zu(this.r)}${Zu(this.g)}${Zu(this.b)}${Zu((isNaN(this.opacity)?1:this.opacity)*255)}`}function DF(){const e=$w(this.opacity);return`${e===1?"rgb(":"rgba("}${xd(this.r)}, ${xd(this.g)}, ${xd(this.b)}${e===1?")":`, ${e})`}`}function $w(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function xd(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Zu(e){return e=xd(e),(e<16?"0":"")+e.toString(16)}function MF(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Oi(e,t,r,n)}function qK(e){if(e instanceof Oi)return new Oi(e.h,e.s,e.l,e.opacity);if(e instanceof Qx||(e=$g(e)),!e)return new Oi;if(e instanceof Oi)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),o=NaN,l=i-a,c=(i+a)/2;return l?(t===i?o=(r-n)/l+(r<n)*6:r===i?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?i+a:2-i-a,o*=60):l=c>0&&c<1?0:o,new Oi(o,l,c,e.opacity)}function U4e(e,t,r,n){return arguments.length===1?qK(e):new Oi(e,t,r,n??1)}function Oi(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}VO(Oi,U4e,WK(Qx,{brighter(e){return e=e==null?Mw:Math.pow(Mw,e),new Oi(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Dg:Math.pow(Dg,e),new Oi(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new ns(nS(e>=240?e-240:e+120,a,n),nS(e,a,n),nS(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Oi($F(this.h),gb(this.s),gb(this.l),$w(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=$w(this.opacity);return`${e===1?"hsl(":"hsla("}${$F(this.h)}, ${gb(this.s)*100}%, ${gb(this.l)*100}%${e===1?")":`, ${e})`}`}}));function $F(e){return e=(e||0)%360,e<0?e+360:e}function gb(e){return Math.max(0,Math.min(1,e||0))}function nS(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const zO=e=>()=>e;function V4e(e,t){return function(r){return e+r*t}}function z4e(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function W4e(e){return(e=+e)==1?GK:function(t,r){return r-t?z4e(t,r,e):zO(isNaN(t)?r:t)}}function GK(e,t){var r=t-e;return r?V4e(e,r):zO(isNaN(e)?t:e)}const FF=function e(t){var r=W4e(t);function n(a,i){var o=r((a=wk(a)).r,(i=wk(i)).r),l=r(a.g,i.g),c=r(a.b,i.b),u=GK(a.opacity,i.opacity);return function(d){return a.r=o(d),a.g=l(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=e,n}(1);function q4e(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function G4e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function H4e(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)a[o]=pm(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(l){for(o=0;o<n;++o)i[o]=a[o](l);return i}}function K4e(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Fw(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Y4e(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=pm(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var jk=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,aS=new RegExp(jk.source,"g");function X4e(e){return function(){return e}}function Q4e(e){return function(t){return e(t)+""}}function Z4e(e,t){var r=jk.lastIndex=aS.lastIndex=0,n,a,i,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=jk.exec(e))&&(a=aS.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[o]?l[o]+=i:l[++o]=i),(n=n[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:Fw(n,a)})),r=aS.lastIndex;return r<t.length&&(i=t.slice(r),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?Q4e(c[0].x):X4e(t):(t=c.length,function(u){for(var d=0,h;d<t;++d)l[(h=c[d]).i]=h.x(u);return l.join("")})}function pm(e,t){var r=typeof t,n;return t==null||r==="boolean"?zO(t):(r==="number"?Fw:r==="string"?(n=$g(t))?(t=n,FF):Z4e:t instanceof $g?FF:t instanceof Date?K4e:G4e(t)?q4e:Array.isArray(t)?H4e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Y4e:Fw)(e,t)}function WO(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function J4e(e,t){t===void 0&&(t=e,e=pm);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return i[l](o-l)}}function eDe(e){return function(){return e}}function Lw(e){return+e}var LF=[0,1];function Fa(e){return e}function Nk(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:eDe(isNaN(t)?NaN:.5)}function tDe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function rDe(e,t,r){var n=e[0],a=e[1],i=t[0],o=t[1];return a<n?(n=Nk(a,n),i=r(o,i)):(n=Nk(n,a),i=r(i,o)),function(l){return i(n(l))}}function nDe(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)a[o]=Nk(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(l){var c=Xx(e,l,1,n)-1;return i[c](a[c](l))}}function Zx(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function TN(){var e=LF,t=LF,r=pm,n,a,i,o=Fa,l,c,u;function d(){var f=Math.min(e.length,t.length);return o!==Fa&&(o=tDe(e[0],e[f-1])),l=f>2?nDe:rDe,c=u=null,h}function h(f){return f==null||isNaN(f=+f)?i:(c||(c=l(e.map(n),t,r)))(n(o(f)))}return h.invert=function(f){return o(a((u||(u=l(t,e.map(n),Fw)))(f)))},h.domain=function(f){return arguments.length?(e=Array.from(f,Lw),d()):e.slice()},h.range=function(f){return arguments.length?(t=Array.from(f),d()):t.slice()},h.rangeRound=function(f){return t=Array.from(f),r=WO,d()},h.clamp=function(f){return arguments.length?(o=f?!0:Fa,d()):o!==Fa},h.interpolate=function(f){return arguments.length?(r=f,d()):r},h.unknown=function(f){return arguments.length?(i=f,h):i},function(f,p){return n=f,a=p,d()}}function qO(){return TN()(Fa,Fa)}function aDe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Bw(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function lp(e){return e=Bw(Math.abs(e)),e?e[1]:NaN}function sDe(e,t){return function(r,n){for(var a=r.length,i=[],o=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),i.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=e[o=(o+1)%e.length];return i.reverse().join(t)}}function iDe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var oDe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Fg(e){if(!(t=oDe.exec(e)))throw new Error("invalid format: "+e);var t;return new GO({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Fg.prototype=GO.prototype;function GO(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}GO.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function lDe(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var HK;function cDe(e,t){var r=Bw(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(HK=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Bw(e,Math.max(0,t+i-1))[0]}function BF(e,t){var r=Bw(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const UF={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:aDe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>BF(e*100,t),r:BF,s:cDe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function VF(e){return e}var zF=Array.prototype.map,WF=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function uDe(e){var t=e.grouping===void 0||e.thousands===void 0?VF:sDe(zF.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?VF:iDe(zF.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(h){h=Fg(h);var f=h.fill,p=h.align,m=h.sign,v=h.symbol,g=h.zero,x=h.width,y=h.comma,b=h.precision,N=h.trim,j=h.type;j==="n"?(y=!0,j="g"):UF[j]||(b===void 0&&(b=12),N=!0,j="g"),(g||f==="0"&&p==="=")&&(g=!0,f="0",p="=");var _=v==="$"?r:v==="#"&&/[boxX]/.test(j)?"0"+j.toLowerCase():"",S=v==="$"?n:/[%p]/.test(j)?o:"",C=UF[j],E=/[defgprs%]/.test(j);b=b===void 0?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function k(P){var A=_,O=S,I,R,M;if(j==="c")O=C(P)+O,P="";else{P=+P;var B=P<0||1/P<0;if(P=isNaN(P)?c:C(Math.abs(P),b),N&&(P=lDe(P)),B&&+P==0&&m!=="+"&&(B=!1),A=(B?m==="("?m:l:m==="-"||m==="("?"":m)+A,O=(j==="s"?WF[8+HK/3]:"")+O+(B&&m==="("?")":""),E){for(I=-1,R=P.length;++I<R;)if(M=P.charCodeAt(I),48>M||M>57){O=(M===46?a+P.slice(I+1):P.slice(I))+O,P=P.slice(0,I);break}}}y&&!g&&(P=t(P,1/0));var $=A.length+P.length+O.length,D=$<x?new Array(x-$+1).join(f):"";switch(y&&g&&(P=t(D+P,D.length?x-O.length:1/0),D=""),p){case"<":P=A+P+O+D;break;case"=":P=A+D+P+O;break;case"^":P=D.slice(0,$=D.length>>1)+A+P+O+D.slice($);break;default:P=D+A+P+O;break}return i(P)}return k.toString=function(){return h+""},k}function d(h,f){var p=u((h=Fg(h),h.type="f",h)),m=Math.max(-8,Math.min(8,Math.floor(lp(f)/3)))*3,v=Math.pow(10,-m),g=WF[8+m/3];return function(x){return p(v*x)+g}}return{format:u,formatPrefix:d}}var xb,HO,KK;dDe({thousands:",",grouping:[3],currency:["$",""]});function dDe(e){return xb=uDe(e),HO=xb.format,KK=xb.formatPrefix,xb}function hDe(e){return Math.max(0,-lp(Math.abs(e)))}function fDe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(lp(t)/3)))*3-lp(Math.abs(e)))}function pDe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,lp(t)-lp(e))+1}function YK(e,t,r,n){var a=yk(e,t,r),i;switch(n=Fg(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=fDe(a,o))&&(n.precision=i),KK(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=pDe(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=hDe(a))&&(n.precision=i-(n.type==="%")*2);break}}return HO(n)}function gu(e){var t=e.domain;return e.ticks=function(r){var n=t();return gk(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return YK(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,o=n[a],l=n[i],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=a,a=i,i=u);d-- >0;){if(u=xk(o,l,r),u===c)return n[a]=o,n[i]=l,t(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function Uw(){var e=qO();return e.copy=function(){return Zx(e,Uw())},fi.apply(e,arguments),gu(e)}function XK(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Lw),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return XK(e).unknown(t)},e=arguments.length?Array.from(e,Lw):[0,1],gu(r)}function QK(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],o;return i<a&&(o=r,r=n,n=o,o=a,a=i,i=o),e[r]=t.floor(a),e[n]=t.ceil(i),e}function qF(e){return Math.log(e)}function GF(e){return Math.exp(e)}function mDe(e){return-Math.log(-e)}function vDe(e){return-Math.exp(-e)}function gDe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function xDe(e){return e===10?gDe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function yDe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function HF(e){return(t,r)=>-e(-t,r)}function KO(e){const t=e(qF,GF),r=t.domain;let n=10,a,i;function o(){return a=yDe(n),i=xDe(n),r()[0]<0?(a=HF(a),i=HF(i),e(mDe,vDe)):e(qF,GF),t}return t.base=function(l){return arguments.length?(n=+l,o()):n},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const h=d<u;h&&([u,d]=[d,u]);let f=a(u),p=a(d),m,v;const g=l==null?10:+l;let x=[];if(!(n%1)&&p-f<g){if(f=Math.floor(f),p=Math.ceil(p),u>0){for(;f<=p;++f)for(m=1;m<n;++m)if(v=f<0?m/i(-f):m*i(f),!(v<u)){if(v>d)break;x.push(v)}}else for(;f<=p;++f)for(m=n-1;m>=1;--m)if(v=f>0?m/i(-f):m*i(f),!(v<u)){if(v>d)break;x.push(v)}x.length*2<g&&(x=gk(u,d,g))}else x=gk(f,p,Math.min(p-f,g)).map(i);return h?x.reverse():x},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=Fg(c)).precision==null&&(c.trim=!0),c=HO(c)),l===1/0)return c;const u=Math.max(1,n*l/t.ticks().length);return d=>{let h=d/i(Math.round(a(d)));return h*n<n-.5&&(h*=n),h<=u?c(d):""}},t.nice=()=>r(QK(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function ZK(){const e=KO(TN()).domain([1,10]);return e.copy=()=>Zx(e,ZK()).base(e.base()),fi.apply(e,arguments),e}function KF(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function YF(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function YO(e){var t=1,r=e(KF(t),YF(t));return r.constant=function(n){return arguments.length?e(KF(t=+n),YF(t)):t},gu(r)}function JK(){var e=YO(TN());return e.copy=function(){return Zx(e,JK()).constant(e.constant())},fi.apply(e,arguments)}function XF(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function bDe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function wDe(e){return e<0?-e*e:e*e}function XO(e){var t=e(Fa,Fa),r=1;function n(){return r===1?e(Fa,Fa):r===.5?e(bDe,wDe):e(XF(r),XF(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},gu(t)}function QO(){var e=XO(TN());return e.copy=function(){return Zx(e,QO()).exponent(e.exponent())},fi.apply(e,arguments),e}function jDe(){return QO.apply(null,arguments).exponent(.5)}function QF(e){return Math.sign(e)*e*e}function NDe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function eY(){var e=qO(),t=[0,1],r=!1,n;function a(i){var o=NDe(e(i));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(i){return e.invert(QF(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,Lw)).map(QF)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return eY(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},fi.apply(a,arguments),gu(a)}function tY(){var e=[],t=[],r=[],n;function a(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=k4e(e,o/l);return i}function i(o){return o==null||isNaN(o=+o)?n:t[Xx(r,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Gc),a()},i.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return tY().domain(e).range(t).unknown(n)},fi.apply(i,arguments)}function rY(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function o(c){return c!=null&&c<=c?a[Xx(n,c,0,r)]:i}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},o.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return rY().domain([e,t]).range(a).unknown(i)},fi.apply(gu(o),arguments)}function nY(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[Xx(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return nY().domain(e).range(t).unknown(r)},fi.apply(a,arguments)}const sS=new Date,iS=new Date;function Fn(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const o=a(i),l=a.ceil(i);return i-o<l-i?o:l},a.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,l)=>{const c=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let u;do c.push(u=new Date(+i)),t(i,l),e(i);while(u<i&&i<o);return c},a.filter=i=>Fn(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),r&&(a.count=(i,o)=>(sS.setTime(+i),iS.setTime(+o),e(sS),e(iS),Math.floor(r(sS,iS))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?o=>n(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const Vw=Fn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Vw.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Fn(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Vw);Vw.range;const cl=1e3,ri=cl*60,ul=ri*60,Pl=ul*24,ZO=Pl*7,ZF=Pl*30,oS=Pl*365,Ju=Fn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*cl)},(e,t)=>(t-e)/cl,e=>e.getUTCSeconds());Ju.range;const JO=Fn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*cl)},(e,t)=>{e.setTime(+e+t*ri)},(e,t)=>(t-e)/ri,e=>e.getMinutes());JO.range;const eI=Fn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ri)},(e,t)=>(t-e)/ri,e=>e.getUTCMinutes());eI.range;const tI=Fn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*cl-e.getMinutes()*ri)},(e,t)=>{e.setTime(+e+t*ul)},(e,t)=>(t-e)/ul,e=>e.getHours());tI.range;const rI=Fn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*ul)},(e,t)=>(t-e)/ul,e=>e.getUTCHours());rI.range;const Jx=Fn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ri)/Pl,e=>e.getDate()-1);Jx.range;const RN=Fn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Pl,e=>e.getUTCDate()-1);RN.range;const aY=Fn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Pl,e=>Math.floor(e/Pl));aY.range;function lh(e){return Fn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*ri)/ZO)}const ON=lh(0),zw=lh(1),_De=lh(2),SDe=lh(3),cp=lh(4),CDe=lh(5),EDe=lh(6);ON.range;zw.range;_De.range;SDe.range;cp.range;CDe.range;EDe.range;function ch(e){return Fn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/ZO)}const IN=ch(0),Ww=ch(1),kDe=ch(2),ADe=ch(3),up=ch(4),PDe=ch(5),TDe=ch(6);IN.range;Ww.range;kDe.range;ADe.range;up.range;PDe.range;TDe.range;const nI=Fn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());nI.range;const aI=Fn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());aI.range;const Tl=Fn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Tl.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Fn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Tl.range;const Rl=Fn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Rl.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Fn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Rl.range;function sY(e,t,r,n,a,i){const o=[[Ju,1,cl],[Ju,5,5*cl],[Ju,15,15*cl],[Ju,30,30*cl],[i,1,ri],[i,5,5*ri],[i,15,15*ri],[i,30,30*ri],[a,1,ul],[a,3,3*ul],[a,6,6*ul],[a,12,12*ul],[n,1,Pl],[n,2,2*Pl],[r,1,ZO],[t,1,ZF],[t,3,3*ZF],[e,1,oS]];function l(u,d,h){const f=d<u;f&&([u,d]=[d,u]);const p=h&&typeof h.range=="function"?h:c(u,d,h),m=p?p.range(u,+d+1):[];return f?m.reverse():m}function c(u,d,h){const f=Math.abs(d-u)/h,p=BO(([,,g])=>g).right(o,f);if(p===o.length)return e.every(yk(u/oS,d/oS,h));if(p===0)return Vw.every(Math.max(yk(u,d,h),1));const[m,v]=o[f/o[p-1][2]<o[p][2]/f?p-1:p];return m.every(v)}return[l,c]}const[RDe,ODe]=sY(Rl,aI,IN,aY,rI,eI),[IDe,DDe]=sY(Tl,nI,ON,Jx,tI,JO);function lS(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function cS(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Wm(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function MDe(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,u=qm(a),d=Gm(a),h=qm(i),f=Gm(i),p=qm(o),m=Gm(o),v=qm(l),g=Gm(l),x=qm(c),y=Gm(c),b={a:B,A:$,b:D,B:W,c:null,d:a5,e:a5,f:sMe,g:mMe,G:gMe,H:rMe,I:nMe,j:aMe,L:iY,m:iMe,M:oMe,p:Z,q:U,Q:o5,s:l5,S:lMe,u:cMe,U:uMe,V:dMe,w:hMe,W:fMe,x:null,X:null,y:pMe,Y:vMe,Z:xMe,"%":i5},N={a:Y,A:ae,b:ie,B:he,c:null,d:s5,e:s5,f:jMe,g:RMe,G:IMe,H:yMe,I:bMe,j:wMe,L:lY,m:NMe,M:_Me,p:se,q:ye,Q:o5,s:l5,S:SMe,u:CMe,U:EMe,V:kMe,w:AMe,W:PMe,x:null,X:null,y:TMe,Y:OMe,Z:DMe,"%":i5},j={a:k,A:P,b:A,B:O,c:I,d:r5,e:r5,f:ZDe,g:t5,G:e5,H:n5,I:n5,j:KDe,L:QDe,m:HDe,M:YDe,p:E,q:GDe,Q:eMe,s:tMe,S:XDe,u:UDe,U:VDe,V:zDe,w:BDe,W:WDe,x:R,X:M,y:t5,Y:e5,Z:qDe,"%":JDe};b.x=_(r,b),b.X=_(n,b),b.c=_(t,b),N.x=_(r,N),N.X=_(n,N),N.c=_(t,N);function _(ne,le){return function(ve){var K=[],ke=-1,Ce=0,Ge=ne.length,He,It,ar;for(ve instanceof Date||(ve=new Date(+ve));++ke<Ge;)ne.charCodeAt(ke)===37&&(K.push(ne.slice(Ce,ke)),(It=JF[He=ne.charAt(++ke)])!=null?He=ne.charAt(++ke):It=He==="e"?" ":"0",(ar=le[He])&&(He=ar(ve,It)),K.push(He),Ce=ke+1);return K.push(ne.slice(Ce,ke)),K.join("")}}function S(ne,le){return function(ve){var K=Wm(1900,void 0,1),ke=C(K,ne,ve+="",0),Ce,Ge;if(ke!=ve.length)return null;if("Q"in K)return new Date(K.Q);if("s"in K)return new Date(K.s*1e3+("L"in K?K.L:0));if(le&&!("Z"in K)&&(K.Z=0),"p"in K&&(K.H=K.H%12+K.p*12),K.m===void 0&&(K.m="q"in K?K.q:0),"V"in K){if(K.V<1||K.V>53)return null;"w"in K||(K.w=1),"Z"in K?(Ce=cS(Wm(K.y,0,1)),Ge=Ce.getUTCDay(),Ce=Ge>4||Ge===0?Ww.ceil(Ce):Ww(Ce),Ce=RN.offset(Ce,(K.V-1)*7),K.y=Ce.getUTCFullYear(),K.m=Ce.getUTCMonth(),K.d=Ce.getUTCDate()+(K.w+6)%7):(Ce=lS(Wm(K.y,0,1)),Ge=Ce.getDay(),Ce=Ge>4||Ge===0?zw.ceil(Ce):zw(Ce),Ce=Jx.offset(Ce,(K.V-1)*7),K.y=Ce.getFullYear(),K.m=Ce.getMonth(),K.d=Ce.getDate()+(K.w+6)%7)}else("W"in K||"U"in K)&&("w"in K||(K.w="u"in K?K.u%7:"W"in K?1:0),Ge="Z"in K?cS(Wm(K.y,0,1)).getUTCDay():lS(Wm(K.y,0,1)).getDay(),K.m=0,K.d="W"in K?(K.w+6)%7+K.W*7-(Ge+5)%7:K.w+K.U*7-(Ge+6)%7);return"Z"in K?(K.H+=K.Z/100|0,K.M+=K.Z%100,cS(K)):lS(K)}}function C(ne,le,ve,K){for(var ke=0,Ce=le.length,Ge=ve.length,He,It;ke<Ce;){if(K>=Ge)return-1;if(He=le.charCodeAt(ke++),He===37){if(He=le.charAt(ke++),It=j[He in JF?le.charAt(ke++):He],!It||(K=It(ne,ve,K))<0)return-1}else if(He!=ve.charCodeAt(K++))return-1}return K}function E(ne,le,ve){var K=u.exec(le.slice(ve));return K?(ne.p=d.get(K[0].toLowerCase()),ve+K[0].length):-1}function k(ne,le,ve){var K=p.exec(le.slice(ve));return K?(ne.w=m.get(K[0].toLowerCase()),ve+K[0].length):-1}function P(ne,le,ve){var K=h.exec(le.slice(ve));return K?(ne.w=f.get(K[0].toLowerCase()),ve+K[0].length):-1}function A(ne,le,ve){var K=x.exec(le.slice(ve));return K?(ne.m=y.get(K[0].toLowerCase()),ve+K[0].length):-1}function O(ne,le,ve){var K=v.exec(le.slice(ve));return K?(ne.m=g.get(K[0].toLowerCase()),ve+K[0].length):-1}function I(ne,le,ve){return C(ne,t,le,ve)}function R(ne,le,ve){return C(ne,r,le,ve)}function M(ne,le,ve){return C(ne,n,le,ve)}function B(ne){return o[ne.getDay()]}function $(ne){return i[ne.getDay()]}function D(ne){return c[ne.getMonth()]}function W(ne){return l[ne.getMonth()]}function Z(ne){return a[+(ne.getHours()>=12)]}function U(ne){return 1+~~(ne.getMonth()/3)}function Y(ne){return o[ne.getUTCDay()]}function ae(ne){return i[ne.getUTCDay()]}function ie(ne){return c[ne.getUTCMonth()]}function he(ne){return l[ne.getUTCMonth()]}function se(ne){return a[+(ne.getUTCHours()>=12)]}function ye(ne){return 1+~~(ne.getUTCMonth()/3)}return{format:function(ne){var le=_(ne+="",b);return le.toString=function(){return ne},le},parse:function(ne){var le=S(ne+="",!1);return le.toString=function(){return ne},le},utcFormat:function(ne){var le=_(ne+="",N);return le.toString=function(){return ne},le},utcParse:function(ne){var le=S(ne+="",!0);return le.toString=function(){return ne},le}}}var JF={"-":"",_:" ",0:"0"},Qn=/^\s*\d+/,$De=/^%/,FDe=/[\\^$*+?|[\]().{}]/g;function Jt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function LDe(e){return e.replace(FDe,"\\$&")}function qm(e){return new RegExp("^(?:"+e.map(LDe).join("|")+")","i")}function Gm(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function BDe(e,t,r){var n=Qn.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function UDe(e,t,r){var n=Qn.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function VDe(e,t,r){var n=Qn.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function zDe(e,t,r){var n=Qn.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function WDe(e,t,r){var n=Qn.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function e5(e,t,r){var n=Qn.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function t5(e,t,r){var n=Qn.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function qDe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function GDe(e,t,r){var n=Qn.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function HDe(e,t,r){var n=Qn.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function r5(e,t,r){var n=Qn.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function KDe(e,t,r){var n=Qn.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function n5(e,t,r){var n=Qn.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function YDe(e,t,r){var n=Qn.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function XDe(e,t,r){var n=Qn.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function QDe(e,t,r){var n=Qn.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function ZDe(e,t,r){var n=Qn.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function JDe(e,t,r){var n=$De.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function eMe(e,t,r){var n=Qn.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function tMe(e,t,r){var n=Qn.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function a5(e,t){return Jt(e.getDate(),t,2)}function rMe(e,t){return Jt(e.getHours(),t,2)}function nMe(e,t){return Jt(e.getHours()%12||12,t,2)}function aMe(e,t){return Jt(1+Jx.count(Tl(e),e),t,3)}function iY(e,t){return Jt(e.getMilliseconds(),t,3)}function sMe(e,t){return iY(e,t)+"000"}function iMe(e,t){return Jt(e.getMonth()+1,t,2)}function oMe(e,t){return Jt(e.getMinutes(),t,2)}function lMe(e,t){return Jt(e.getSeconds(),t,2)}function cMe(e){var t=e.getDay();return t===0?7:t}function uMe(e,t){return Jt(ON.count(Tl(e)-1,e),t,2)}function oY(e){var t=e.getDay();return t>=4||t===0?cp(e):cp.ceil(e)}function dMe(e,t){return e=oY(e),Jt(cp.count(Tl(e),e)+(Tl(e).getDay()===4),t,2)}function hMe(e){return e.getDay()}function fMe(e,t){return Jt(zw.count(Tl(e)-1,e),t,2)}function pMe(e,t){return Jt(e.getFullYear()%100,t,2)}function mMe(e,t){return e=oY(e),Jt(e.getFullYear()%100,t,2)}function vMe(e,t){return Jt(e.getFullYear()%1e4,t,4)}function gMe(e,t){var r=e.getDay();return e=r>=4||r===0?cp(e):cp.ceil(e),Jt(e.getFullYear()%1e4,t,4)}function xMe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Jt(t/60|0,"0",2)+Jt(t%60,"0",2)}function s5(e,t){return Jt(e.getUTCDate(),t,2)}function yMe(e,t){return Jt(e.getUTCHours(),t,2)}function bMe(e,t){return Jt(e.getUTCHours()%12||12,t,2)}function wMe(e,t){return Jt(1+RN.count(Rl(e),e),t,3)}function lY(e,t){return Jt(e.getUTCMilliseconds(),t,3)}function jMe(e,t){return lY(e,t)+"000"}function NMe(e,t){return Jt(e.getUTCMonth()+1,t,2)}function _Me(e,t){return Jt(e.getUTCMinutes(),t,2)}function SMe(e,t){return Jt(e.getUTCSeconds(),t,2)}function CMe(e){var t=e.getUTCDay();return t===0?7:t}function EMe(e,t){return Jt(IN.count(Rl(e)-1,e),t,2)}function cY(e){var t=e.getUTCDay();return t>=4||t===0?up(e):up.ceil(e)}function kMe(e,t){return e=cY(e),Jt(up.count(Rl(e),e)+(Rl(e).getUTCDay()===4),t,2)}function AMe(e){return e.getUTCDay()}function PMe(e,t){return Jt(Ww.count(Rl(e)-1,e),t,2)}function TMe(e,t){return Jt(e.getUTCFullYear()%100,t,2)}function RMe(e,t){return e=cY(e),Jt(e.getUTCFullYear()%100,t,2)}function OMe(e,t){return Jt(e.getUTCFullYear()%1e4,t,4)}function IMe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?up(e):up.ceil(e),Jt(e.getUTCFullYear()%1e4,t,4)}function DMe(){return"+0000"}function i5(){return"%"}function o5(e){return+e}function l5(e){return Math.floor(+e/1e3)}var Ch,uY,dY;MMe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function MMe(e){return Ch=MDe(e),uY=Ch.format,Ch.parse,dY=Ch.utcFormat,Ch.utcParse,Ch}function $Me(e){return new Date(e)}function FMe(e){return e instanceof Date?+e:+new Date(+e)}function sI(e,t,r,n,a,i,o,l,c,u){var d=qO(),h=d.invert,f=d.domain,p=u(".%L"),m=u(":%S"),v=u("%I:%M"),g=u("%I %p"),x=u("%a %d"),y=u("%b %d"),b=u("%B"),N=u("%Y");function j(_){return(c(_)<_?p:l(_)<_?m:o(_)<_?v:i(_)<_?g:n(_)<_?a(_)<_?x:y:r(_)<_?b:N)(_)}return d.invert=function(_){return new Date(h(_))},d.domain=function(_){return arguments.length?f(Array.from(_,FMe)):f().map($Me)},d.ticks=function(_){var S=f();return e(S[0],S[S.length-1],_??10)},d.tickFormat=function(_,S){return S==null?j:u(S)},d.nice=function(_){var S=f();return(!_||typeof _.range!="function")&&(_=t(S[0],S[S.length-1],_??10)),_?f(QK(S,_)):d},d.copy=function(){return Zx(d,sI(e,t,r,n,a,i,o,l,c,u))},d}function LMe(){return fi.apply(sI(IDe,DDe,Tl,nI,ON,Jx,tI,JO,Ju,uY).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function BMe(){return fi.apply(sI(RDe,ODe,Rl,aI,IN,RN,rI,eI,Ju,dY).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function DN(){var e=0,t=1,r,n,a,i,o=Fa,l=!1,c;function u(h){return h==null||isNaN(h=+h)?c:o(a===0?.5:(h=(i(h)-r)*a,l?Math.max(0,Math.min(1,h)):h))}u.domain=function(h){return arguments.length?([e,t]=h,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(h){return arguments.length?(l=!!h,u):l},u.interpolator=function(h){return arguments.length?(o=h,u):o};function d(h){return function(f){var p,m;return arguments.length?([p,m]=f,o=h(p,m),u):[o(0),o(1)]}}return u.range=d(pm),u.rangeRound=d(WO),u.unknown=function(h){return arguments.length?(c=h,u):c},function(h){return i=h,r=h(e),n=h(t),a=r===n?0:1/(n-r),u}}function xu(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function hY(){var e=gu(DN()(Fa));return e.copy=function(){return xu(e,hY())},Wl.apply(e,arguments)}function fY(){var e=KO(DN()).domain([1,10]);return e.copy=function(){return xu(e,fY()).base(e.base())},Wl.apply(e,arguments)}function pY(){var e=YO(DN());return e.copy=function(){return xu(e,pY()).constant(e.constant())},Wl.apply(e,arguments)}function iI(){var e=XO(DN());return e.copy=function(){return xu(e,iI()).exponent(e.exponent())},Wl.apply(e,arguments)}function UMe(){return iI.apply(null,arguments).exponent(.5)}function mY(){var e=[],t=Fa;function r(n){if(n!=null&&!isNaN(n=+n))return t((Xx(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Gc),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>E4e(e,i/n))},r.copy=function(){return mY(t).domain(e)},Wl.apply(r,arguments)}function MN(){var e=0,t=.5,r=1,n=1,a,i,o,l,c,u=Fa,d,h=!1,f;function p(v){return isNaN(v=+v)?f:(v=.5+((v=+d(v))-i)*(n*v<n*i?l:c),u(h?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,t,r]=v,a=d(e=+e),i=d(t=+t),o=d(r=+r),l=a===i?0:.5/(i-a),c=i===o?0:.5/(o-i),n=i<a?-1:1,p):[e,t,r]},p.clamp=function(v){return arguments.length?(h=!!v,p):h},p.interpolator=function(v){return arguments.length?(u=v,p):u};function m(v){return function(g){var x,y,b;return arguments.length?([x,y,b]=g,u=J4e(v,[x,y,b]),p):[u(0),u(.5),u(1)]}}return p.range=m(pm),p.rangeRound=m(WO),p.unknown=function(v){return arguments.length?(f=v,p):f},function(v){return d=v,a=v(e),i=v(t),o=v(r),l=a===i?0:.5/(i-a),c=i===o?0:.5/(o-i),n=i<a?-1:1,p}}function vY(){var e=gu(MN()(Fa));return e.copy=function(){return xu(e,vY())},Wl.apply(e,arguments)}function gY(){var e=KO(MN()).domain([.1,1,10]);return e.copy=function(){return xu(e,gY()).base(e.base())},Wl.apply(e,arguments)}function xY(){var e=YO(MN());return e.copy=function(){return xu(e,xY()).constant(e.constant())},Wl.apply(e,arguments)}function oI(){var e=XO(MN());return e.copy=function(){return xu(e,oI()).exponent(e.exponent())},Wl.apply(e,arguments)}function VMe(){return oI.apply(null,arguments).exponent(.5)}const c5=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Ig,scaleDiverging:vY,scaleDivergingLog:gY,scaleDivergingPow:oI,scaleDivergingSqrt:VMe,scaleDivergingSymlog:xY,scaleIdentity:XK,scaleImplicit:bk,scaleLinear:Uw,scaleLog:ZK,scaleOrdinal:UO,scalePoint:Ov,scalePow:QO,scaleQuantile:tY,scaleQuantize:rY,scaleRadial:eY,scaleSequential:hY,scaleSequentialLog:fY,scaleSequentialPow:iI,scaleSequentialQuantile:mY,scaleSequentialSqrt:UMe,scaleSequentialSymlog:pY,scaleSqrt:jDe,scaleSymlog:JK,scaleThreshold:nY,scaleTime:LMe,scaleUtc:BMe,tickFormat:YK},Symbol.toStringTag,{value:"Module"}));var zMe=am;function WMe(e,t,r){for(var n=-1,a=e.length;++n<a;){var i=e[n],o=t(i);if(o!=null&&(l===void 0?o===o&&!zMe(o):r(o,l)))var l=o,c=i}return c}var yY=WMe;function qMe(e,t){return e>t}var GMe=qMe,HMe=yY,KMe=GMe,YMe=fm;function XMe(e){return e&&e.length?HMe(e,YMe,KMe):void 0}var QMe=XMe;const Cc=lr(QMe);function ZMe(e,t){return e<t}var JMe=ZMe,e3e=yY,t3e=JMe,r3e=fm;function n3e(e){return e&&e.length?e3e(e,r3e,t3e):void 0}var a3e=n3e;const $N=lr(a3e);var s3e=wO,i3e=vu,o3e=EK,l3e=ds;function c3e(e,t){var r=l3e(e)?s3e:o3e;return r(e,i3e(t))}var u3e=c3e,d3e=SK,h3e=u3e;function f3e(e,t){return d3e(h3e(e,t),1)}var p3e=f3e;const m3e=lr(p3e);var v3e=MO;function g3e(e,t){return v3e(e,t)}var x3e=g3e;const dp=lr(x3e);var mm=1e9,y3e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},cI,Pr=!0,ui="[DecimalError] ",yd=ui+"Invalid argument: ",lI=ui+"Exponent out of range: ",vm=Math.floor,Fu=Math.pow,b3e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Cs,Vn=1e7,Sr=7,bY=9007199254740991,qw=vm(bY/Sr),qe={};qe.absoluteValue=qe.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};qe.comparedTo=qe.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};qe.decimalPlaces=qe.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Sr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};qe.dividedBy=qe.div=function(e){return vl(this,new this.constructor(e))};qe.dividedToIntegerBy=qe.idiv=function(e){var t=this,r=t.constructor;return fr(vl(t,new r(e),0,1),r.precision)};qe.equals=qe.eq=function(e){return!this.cmp(e)};qe.exponent=function(){return mn(this)};qe.greaterThan=qe.gt=function(e){return this.cmp(e)>0};qe.greaterThanOrEqualTo=qe.gte=function(e){return this.cmp(e)>=0};qe.isInteger=qe.isint=function(){return this.e>this.d.length-2};qe.isNegative=qe.isneg=function(){return this.s<0};qe.isPositive=qe.ispos=function(){return this.s>0};qe.isZero=function(){return this.s===0};qe.lessThan=qe.lt=function(e){return this.cmp(e)<0};qe.lessThanOrEqualTo=qe.lte=function(e){return this.cmp(e)<1};qe.logarithm=qe.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Cs))throw Error(ui+"NaN");if(r.s<1)throw Error(ui+(r.s?"NaN":"-Infinity"));return r.eq(Cs)?new n(0):(Pr=!1,t=vl(Lg(r,i),Lg(e,i),i),Pr=!0,fr(t,a))};qe.minus=qe.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?NY(t,e):wY(t,(e.s=-e.s,e))};qe.modulo=qe.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(ui+"NaN");return r.s?(Pr=!1,t=vl(r,e,0,1).times(e),Pr=!0,r.minus(t)):fr(new n(r),a)};qe.naturalExponential=qe.exp=function(){return jY(this)};qe.naturalLogarithm=qe.ln=function(){return Lg(this)};qe.negated=qe.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};qe.plus=qe.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?wY(t,e):NY(t,(e.s=-e.s,e))};qe.precision=qe.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(yd+e);if(t=mn(a)+1,n=a.d.length-1,r=n*Sr+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};qe.squareRoot=qe.sqrt=function(){var e,t,r,n,a,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(ui+"NaN")}for(e=mn(l),Pr=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=yo(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=vm((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=o=r+3;;)if(i=n,n=i.plus(vl(l,i,o+2)).times(.5),yo(i.d).slice(0,o)===(t=yo(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(fr(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;o+=4}return Pr=!0,fr(n,r)};qe.times=qe.mul=function(e){var t,r,n,a,i,o,l,c,u,d=this,h=d.constructor,f=d.d,p=(e=new h(e)).d;if(!d.s||!e.s)return new h(0);for(e.s*=d.s,r=d.e+e.e,c=f.length,u=p.length,c<u&&(i=f,f=p,p=i,o=c,c=u,u=o),i=[],o=c+u,n=o;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=c+n;a>n;)l=i[a]+p[n]*f[a-n-1]+t,i[a--]=l%Vn|0,t=l/Vn|0;i[a]=(i[a]+t)%Vn|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Pr?fr(e,h.precision):e};qe.toDecimalPlaces=qe.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Mo(e,0,mm),t===void 0?t=n.rounding:Mo(t,0,8),fr(r,e+mn(r)+1,t))};qe.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Fd(n,!0):(Mo(e,0,mm),t===void 0?t=a.rounding:Mo(t,0,8),n=fr(new a(n),e+1,t),r=Fd(n,!0,e+1)),r};qe.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Fd(a):(Mo(e,0,mm),t===void 0?t=i.rounding:Mo(t,0,8),n=fr(new i(a),e+mn(a)+1,t),r=Fd(n.abs(),!1,e+mn(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};qe.toInteger=qe.toint=function(){var e=this,t=e.constructor;return fr(new t(e),mn(e)+1,t.rounding)};qe.toNumber=function(){return+this};qe.toPower=qe.pow=function(e){var t,r,n,a,i,o,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Cs);if(l=new c(l),!l.s){if(e.s<1)throw Error(ui+"Infinity");return l}if(l.eq(Cs))return l;if(n=c.precision,e.eq(Cs))return fr(l,n);if(t=e.e,r=e.d.length-1,o=t>=r,i=l.s,o){if((r=d<0?-d:d)<=bY){for(a=new c(Cs),t=Math.ceil(n/Sr+4),Pr=!1;r%2&&(a=a.times(l),d5(a.d,t)),r=vm(r/2),r!==0;)l=l.times(l),d5(l.d,t);return Pr=!0,e.s<0?new c(Cs).div(a):fr(a,n)}}else if(i<0)throw Error(ui+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,Pr=!1,a=e.times(Lg(l,n+u)),Pr=!0,a=jY(a),a.s=i,a};qe.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=mn(a),n=Fd(a,r<=i.toExpNeg||r>=i.toExpPos)):(Mo(e,1,mm),t===void 0?t=i.rounding:Mo(t,0,8),a=fr(new i(a),e,t),r=mn(a),n=Fd(a,e<=r||r<=i.toExpNeg,e)),n};qe.toSignificantDigits=qe.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Mo(e,1,mm),t===void 0?t=n.rounding:Mo(t,0,8)),fr(new n(r),e,t)};qe.toString=qe.valueOf=qe.val=qe.toJSON=qe[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=mn(e),r=e.constructor;return Fd(e,t<=r.toExpNeg||t>=r.toExpPos)};function wY(e,t){var r,n,a,i,o,l,c,u,d=e.constructor,h=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),Pr?fr(t,h):t;if(c=e.d,u=t.d,o=e.e,a=t.e,c=c.slice(),i=o-a,i){for(i<0?(n=c,i=-i,l=u.length):(n=u,a=o,l=c.length),o=Math.ceil(h/Sr),l=o>l?o+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=c.length,i=u.length,l-i<0&&(i=l,n=u,u=c,c=n),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/Vn|0,c[i]%=Vn;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,Pr?fr(t,h):t}function Mo(e,t,r){if(e!==~~e||e<t||e>r)throw Error(yd+e)}function yo(e){var t,r,n,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)n=e[t]+"",r=Sr-n.length,r&&(i+=ac(r)),i+=n;o=e[t],n=o+"",r=Sr-n.length,r&&(i+=ac(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var vl=function(){function e(n,a){var i,o=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+o,n[l]=i%Vn|0,o=i/Vn|0;return o&&n.unshift(o),n}function t(n,a,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,i){for(var o=0;i--;)n[i]-=o,o=n[i]<a[i]?1:0,n[i]=o*Vn+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,o){var l,c,u,d,h,f,p,m,v,g,x,y,b,N,j,_,S,C,E=n.constructor,k=n.s==a.s?1:-1,P=n.d,A=a.d;if(!n.s)return new E(n);if(!a.s)throw Error(ui+"Division by zero");for(c=n.e-a.e,S=A.length,j=P.length,p=new E(k),m=p.d=[],u=0;A[u]==(P[u]||0);)++u;if(A[u]>(P[u]||0)&&--c,i==null?y=i=E.precision:o?y=i+(mn(n)-mn(a))+1:y=i,y<0)return new E(0);if(y=y/Sr+2|0,u=0,S==1)for(d=0,A=A[0],y++;(u<j||d)&&y--;u++)b=d*Vn+(P[u]||0),m[u]=b/A|0,d=b%A|0;else{for(d=Vn/(A[0]+1)|0,d>1&&(A=e(A,d),P=e(P,d),S=A.length,j=P.length),N=S,v=P.slice(0,S),g=v.length;g<S;)v[g++]=0;C=A.slice(),C.unshift(0),_=A[0],A[1]>=Vn/2&&++_;do d=0,l=t(A,v,S,g),l<0?(x=v[0],S!=g&&(x=x*Vn+(v[1]||0)),d=x/_|0,d>1?(d>=Vn&&(d=Vn-1),h=e(A,d),f=h.length,g=v.length,l=t(h,v,f,g),l==1&&(d--,r(h,S<f?C:A,f))):(d==0&&(l=d=1),h=A.slice()),f=h.length,f<g&&h.unshift(0),r(v,h,g),l==-1&&(g=v.length,l=t(A,v,S,g),l<1&&(d++,r(v,S<g?C:A,g))),g=v.length):l===0&&(d++,v=[0]),m[u++]=d,l&&v[0]?v[g++]=P[N]||0:(v=[P[N]],g=1);while((N++<j||v[0]!==void 0)&&y--)}return m[0]||m.shift(),p.e=c,fr(p,o?i+mn(p)+1:i)}}();function jY(e,t){var r,n,a,i,o,l,c=0,u=0,d=e.constructor,h=d.precision;if(mn(e)>16)throw Error(lI+mn(e));if(!e.s)return new d(Cs);for(t==null?(Pr=!1,l=h):l=t,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(n=Math.log(Fu(2,u))/Math.LN10*2+5|0,l+=n,r=a=i=new d(Cs),d.precision=l;;){if(a=fr(a.times(e),l),r=r.times(++c),o=i.plus(vl(a,r,l)),yo(o.d).slice(0,l)===yo(i.d).slice(0,l)){for(;u--;)i=fr(i.times(i),l);return d.precision=h,t==null?(Pr=!0,fr(i,h)):i}i=o}}function mn(e){for(var t=e.e*Sr,r=e.d[0];r>=10;r/=10)t++;return t}function uS(e,t,r){if(t>e.LN10.sd())throw Pr=!0,r&&(e.precision=r),Error(ui+"LN10 precision limit exceeded");return fr(new e(e.LN10),t)}function ac(e){for(var t="";e--;)t+="0";return t}function Lg(e,t){var r,n,a,i,o,l,c,u,d,h=1,f=10,p=e,m=p.d,v=p.constructor,g=v.precision;if(p.s<1)throw Error(ui+(p.s?"NaN":"-Infinity"));if(p.eq(Cs))return new v(0);if(t==null?(Pr=!1,u=g):u=t,p.eq(10))return t==null&&(Pr=!0),uS(v,u);if(u+=f,v.precision=u,r=yo(m),n=r.charAt(0),i=mn(p),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=yo(p.d),n=r.charAt(0),h++;i=mn(p),n>1?(p=new v("0."+r),i++):p=new v(n+"."+r.slice(1))}else return c=uS(v,u+2,g).times(i+""),p=Lg(new v(n+"."+r.slice(1)),u-f).plus(c),v.precision=g,t==null?(Pr=!0,fr(p,g)):p;for(l=o=p=vl(p.minus(Cs),p.plus(Cs),u),d=fr(p.times(p),u),a=3;;){if(o=fr(o.times(d),u),c=l.plus(vl(o,new v(a),u)),yo(c.d).slice(0,u)===yo(l.d).slice(0,u))return l=l.times(2),i!==0&&(l=l.plus(uS(v,u+2,g).times(i+""))),l=vl(l,new v(h),u),v.precision=g,t==null?(Pr=!0,fr(l,g)):l;l=c,a+=2}}function u5(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=vm(r/Sr),e.d=[],n=(r+1)%Sr,r<0&&(n+=Sr),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Sr;n<a;)e.d.push(+t.slice(n,n+=Sr));t=t.slice(n),n=Sr-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Pr&&(e.e>qw||e.e<-qw))throw Error(lI+r)}else e.s=0,e.e=0,e.d=[0];return e}function fr(e,t,r){var n,a,i,o,l,c,u,d,h=e.d;for(o=1,i=h[0];i>=10;i/=10)o++;if(n=t-o,n<0)n+=Sr,a=t,u=h[d=0];else{if(d=Math.ceil((n+1)/Sr),i=h.length,d>=i)return e;for(u=i=h[d],o=1;i>=10;i/=10)o++;n%=Sr,a=n-Sr+o}if(r!==void 0&&(i=Fu(10,o-a-1),l=u/i%10|0,c=t<0||h[d+1]!==void 0||u%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?u/Fu(10,o-a):0:h[d-1])%10&1||r==(e.s<0?8:7))),t<1||!h[0])return c?(i=mn(e),h.length=1,t=t-i-1,h[0]=Fu(10,(Sr-t%Sr)%Sr),e.e=vm(-t/Sr)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(n==0?(h.length=d,i=1,d--):(h.length=d+1,i=Fu(10,Sr-n),h[d]=a>0?(u/Fu(10,o-a)%Fu(10,a)|0)*i:0),c)for(;;)if(d==0){(h[0]+=i)==Vn&&(h[0]=1,++e.e);break}else{if(h[d]+=i,h[d]!=Vn)break;h[d--]=0,i=1}for(n=h.length;h[--n]===0;)h.pop();if(Pr&&(e.e>qw||e.e<-qw))throw Error(lI+mn(e));return e}function NY(e,t){var r,n,a,i,o,l,c,u,d,h,f=e.constructor,p=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),Pr?fr(t,p):t;if(c=e.d,h=t.d,n=t.e,u=e.e,c=c.slice(),o=u-n,o){for(d=o<0,d?(r=c,o=-o,l=h.length):(r=h,n=u,l=c.length),a=Math.max(Math.ceil(p/Sr),l)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=h.length,d=a<l,d&&(l=a),a=0;a<l;a++)if(c[a]!=h[a]){d=c[a]<h[a];break}o=0}for(d&&(r=c,c=h,h=r,t.s=-t.s),l=c.length,a=h.length-l;a>0;--a)c[l++]=0;for(a=h.length;a>o;){if(c[--a]<h[a]){for(i=a;i&&c[--i]===0;)c[i]=Vn-1;--c[i],c[a]+=Vn}c[a]-=h[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,Pr?fr(t,p):t):new f(0)}function Fd(e,t,r){var n,a=mn(e),i=yo(e.d),o=i.length;return t?(r&&(n=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+ac(n):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+ac(-a-1)+i,r&&(n=r-o)>0&&(i+=ac(n))):a>=o?(i+=ac(a+1-o),r&&(n=r-a-1)>0&&(i=i+"."+ac(n))):((n=a+1)<o&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(i+="."),i+=ac(n))),e.s<0?"-"+i:i}function d5(e,t){if(e.length>t)return e.length=t,!0}function _Y(e){var t,r,n;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(yd+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return u5(o,i.toString())}else if(typeof i!="string")throw Error(yd+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,b3e.test(i))u5(o,i);else throw Error(yd+i)}if(a.prototype=qe,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=_Y,a.config=a.set=w3e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function w3e(e){if(!e||typeof e!="object")throw Error(ui+"Object expected");var t,r,n,a=["precision",1,mm,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(vm(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(yd+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(yd+r+": "+n);return this}var cI=_Y(y3e);Cs=new cI(1);const dr=cI;function j3e(e){return C3e(e)||S3e(e)||_3e(e)||N3e()}function N3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _3e(e,t){if(e){if(typeof e=="string")return _k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _k(e,t)}}function S3e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function C3e(e){if(Array.isArray(e))return _k(e)}function _k(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var E3e=function(t){return t},SY={"@@functional/placeholder":!0},CY=function(t){return t===SY},h5=function(t){return function r(){return arguments.length===0||arguments.length===1&&CY(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},k3e=function e(t,r){return t===1?r:h5(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=a.filter(function(l){return l!==SY}).length;return o>=t?r.apply(void 0,a):e(t-o,h5(function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var d=a.map(function(h){return CY(h)?c.shift():h});return r.apply(void 0,j3e(d).concat(c))}))})},FN=function(t){return k3e(t.length,t)},Sk=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},A3e=FN(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),P3e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return E3e;var a=r.reverse(),i=a[0],o=a.slice(1);return function(){return o.reduce(function(l,c){return c(l)},i.apply(void 0,arguments))}},Ck=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},EY=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return r&&i.every(function(l,c){return l===r[c]})||(r=i,n=t.apply(void 0,i)),n}};function T3e(e){var t;return e===0?t=1:t=Math.floor(new dr(e).abs().log(10).toNumber())+1,t}function R3e(e,t,r){for(var n=new dr(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var O3e=FN(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),I3e=FN(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),D3e=FN(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const LN={rangeStep:R3e,getDigitCount:T3e,interpolateNumber:O3e,uninterpolateNumber:I3e,uninterpolateTruncation:D3e};function Ek(e){return F3e(e)||$3e(e)||kY(e)||M3e()}function M3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $3e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function F3e(e){if(Array.isArray(e))return kk(e)}function Bg(e,t){return U3e(e)||B3e(e,t)||kY(e,t)||L3e()}function L3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kY(e,t){if(e){if(typeof e=="string")return kk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kk(e,t)}}function kk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B3e(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var o=e[Symbol.iterator](),l;!(n=(l=o.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(c){a=!0,i=c}finally{try{!n&&o.return!=null&&o.return()}finally{if(a)throw i}}return r}}function U3e(e){if(Array.isArray(e))return e}function AY(e){var t=Bg(e,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function PY(e,t,r){if(e.lte(0))return new dr(0);var n=LN.getDigitCount(e.toNumber()),a=new dr(10).pow(n),i=e.div(a),o=n!==1?.05:.1,l=new dr(Math.ceil(i.div(o).toNumber())).add(r).mul(o),c=l.mul(a);return t?c:new dr(Math.ceil(c))}function V3e(e,t,r){var n=1,a=new dr(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new dr(10).pow(LN.getDigitCount(e)-1),a=new dr(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new dr(Math.floor(e)))}else e===0?a=new dr(Math.floor((t-1)/2)):r||(a=new dr(Math.floor(e)));var o=Math.floor((t-1)/2),l=P3e(A3e(function(c){return a.add(new dr(c-o).mul(n)).toNumber()}),Sk);return l(0,t)}function TY(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new dr(0),tickMin:new dr(0),tickMax:new dr(0)};var i=PY(new dr(t).sub(e).div(r-1),n,a),o;e<=0&&t>=0?o=new dr(0):(o=new dr(e).add(t).div(2),o=o.sub(new dr(o).mod(i)));var l=Math.ceil(o.sub(e).div(i).toNumber()),c=Math.ceil(new dr(t).sub(o).div(i).toNumber()),u=l+c+1;return u>r?TY(e,t,r,n,a+1):(u<r&&(c=t>0?c+(r-u):c,l=t>0?l:l+(r-u)),{step:i,tickMin:o.sub(new dr(l).mul(i)),tickMax:o.add(new dr(c).mul(i))})}function z3e(e){var t=Bg(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),l=AY([r,n]),c=Bg(l,2),u=c[0],d=c[1];if(u===-1/0||d===1/0){var h=d===1/0?[u].concat(Ek(Sk(0,a-1).map(function(){return 1/0}))):[].concat(Ek(Sk(0,a-1).map(function(){return-1/0})),[d]);return r>n?Ck(h):h}if(u===d)return V3e(u,a,i);var f=TY(u,d,o,i),p=f.step,m=f.tickMin,v=f.tickMax,g=LN.rangeStep(m,v.add(new dr(.1).mul(p)),p);return r>n?Ck(g):g}function W3e(e,t){var r=Bg(e,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=AY([n,a]),l=Bg(o,2),c=l[0],u=l[1];if(c===-1/0||u===1/0)return[n,a];if(c===u)return[c];var d=Math.max(t,2),h=PY(new dr(u).sub(c).div(d-1),i,0),f=[].concat(Ek(LN.rangeStep(new dr(c),new dr(u).sub(new dr(.99).mul(h)),h)),[u]);return n>a?Ck(f):f}var q3e=EY(z3e),G3e=EY(W3e),H3e="Invariant failed";function Ld(e,t){throw new Error(H3e)}var K3e=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function hp(e){"@babel/helpers - typeof";return hp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hp(e)}function Gw(){return Gw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gw.apply(this,arguments)}function Y3e(e,t){return J3e(e)||Z3e(e,t)||Q3e(e,t)||X3e()}function X3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Q3e(e,t){if(e){if(typeof e=="string")return f5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f5(e,t)}}function f5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Z3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function J3e(e){if(Array.isArray(e))return e}function e$e(e,t){if(e==null)return{};var r=t$e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function t$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function r$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n$e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IY(n.key),n)}}function a$e(e,t,r){return t&&n$e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function s$e(e,t,r){return t=Hw(t),i$e(e,RY()?Reflect.construct(t,r||[],Hw(e).constructor):t.apply(e,r))}function i$e(e,t){if(t&&(hp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o$e(e)}function o$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RY=function(){return!!e})()}function Hw(e){return Hw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hw(e)}function l$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ak(e,t)}function Ak(e,t){return Ak=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Ak(e,t)}function OY(e,t,r){return t=IY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IY(e){var t=c$e(e,"string");return hp(t)=="symbol"?t:t+""}function c$e(e,t){if(hp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ey=function(e){function t(){return r$e(this,t),s$e(this,t,arguments)}return l$e(t,e),a$e(t,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,o=n.width,l=n.dataKey,c=n.data,u=n.dataPointFormatter,d=n.xAxis,h=n.yAxis,f=e$e(n,K3e),p=Ct(f,!1);this.props.direction==="x"&&d.type!=="number"&&Ld();var m=c.map(function(v){var g=u(v,l),x=g.x,y=g.y,b=g.value,N=g.errorVal;if(!N)return null;var j=[],_,S;if(Array.isArray(N)){var C=Y3e(N,2);_=C[0],S=C[1]}else _=S=N;if(i==="vertical"){var E=d.scale,k=y+a,P=k+o,A=k-o,O=E(b-_),I=E(b+S);j.push({x1:I,y1:P,x2:I,y2:A}),j.push({x1:O,y1:k,x2:I,y2:k}),j.push({x1:O,y1:P,x2:O,y2:A})}else if(i==="horizontal"){var R=h.scale,M=x+a,B=M-o,$=M+o,D=R(b-_),W=R(b+S);j.push({x1:B,y1:W,x2:$,y2:W}),j.push({x1:M,y1:D,x2:M,y2:W}),j.push({x1:B,y1:D,x2:$,y2:D})}return F.createElement(yr,Gw({className:"recharts-errorBar",key:"bar-".concat(j.map(function(Z){return"".concat(Z.x1,"-").concat(Z.x2,"-").concat(Z.y1,"-").concat(Z.y2)}))},p),j.map(function(Z){return F.createElement("line",Gw({},Z,{key:"line-".concat(Z.x1,"-").concat(Z.x2,"-").concat(Z.y1,"-").concat(Z.y2)}))}))});return F.createElement(yr,{className:"recharts-errorBars"},m)}}])}(F.Component);OY(ey,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});OY(ey,"displayName","ErrorBar");function Ug(e){"@babel/helpers - typeof";return Ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ug(e)}function p5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p5(Object(r),!0).forEach(function(n){u$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u$e(e,t,r){return t=d$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d$e(e){var t=h$e(e,"string");return Ug(t)=="symbol"?t:t+""}function h$e(e,t){if(Ug(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ug(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DY=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,o=ys(r,Cf);if(!o)return null;var l=Cf.defaultProps,c=l!==void 0?Pu(Pu({},l),o.props):{},u;return o.props&&o.props.payload?u=o.props&&o.props.payload:i==="children"?u=(n||[]).reduce(function(d,h){var f=h.item,p=h.props,m=p.sectors||p.data||[];return d.concat(m.map(function(v){return{type:o.props.iconType||f.props.legendType,value:v.name,color:v.fill,payload:v}}))},[]):u=(n||[]).map(function(d){var h=d.item,f=h.type.defaultProps,p=f!==void 0?Pu(Pu({},f),h.props):{},m=p.dataKey,v=p.name,g=p.legendType,x=p.hide;return{inactive:x,dataKey:m,type:c.iconType||g||"square",color:uI(h),value:v||m,payload:p}}),Pu(Pu(Pu({},c),Cf.getWithHeight(o,a)),{},{payload:u,item:o})};function Vg(e){"@babel/helpers - typeof";return Vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vg(e)}function m5(e){return v$e(e)||m$e(e)||p$e(e)||f$e()}function f$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function p$e(e,t){if(e){if(typeof e=="string")return Pk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pk(e,t)}}function m$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function v$e(e){if(Array.isArray(e))return Pk(e)}function Pk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v5(Object(r),!0).forEach(function(n){kf(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kf(e,t,r){return t=g$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g$e(e){var t=x$e(e,"string");return Vg(t)=="symbol"?t:t+""}function x$e(e,t){if(Vg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ua(e,t,r){return Ot(e)||Ot(t)?r:kn(t)?ii(e,t,r):bt(t)?t(e):r}function Iv(e,t,r,n){var a=m3e(e,function(l){return Ua(l,t)});if(r==="number"){var i=a.filter(function(l){return Te(l)||parseFloat(l)});return i.length?[$N(i),Cc(i)]:[1/0,-1/0]}var o=n?a.filter(function(l){return!Ot(l)}):a;return o.map(function(l){return kn(l)||l instanceof Date?l:""})}var y$e=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,l=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,u=0;u<l;u++){var d=u>0?a[u-1].coordinate:a[l-1].coordinate,h=a[u].coordinate,f=u>=l-1?a[0].coordinate:a[u+1].coordinate,p=void 0;if($i(h-d)!==$i(f-h)){var m=[];if($i(f-h)===$i(c[1]-c[0])){p=f;var v=h+c[1]-c[0];m[0]=Math.min(v,(v+d)/2),m[1]=Math.max(v,(v+d)/2)}else{p=d;var g=f+c[1]-c[0];m[0]=Math.min(h,(g+h)/2),m[1]=Math.max(h,(g+h)/2)}var x=[Math.min(h,(p+h)/2),Math.max(h,(p+h)/2)];if(t>x[0]&&t<=x[1]||t>=m[0]&&t<=m[1]){o=a[u].index;break}}else{var y=Math.min(d,f),b=Math.max(d,f);if(t>(y+h)/2&&t<=(b+h)/2){o=a[u].index;break}}}else for(var N=0;N<l;N++)if(N===0&&t<=(n[N].coordinate+n[N+1].coordinate)/2||N>0&&N<l-1&&t>(n[N].coordinate+n[N-1].coordinate)/2&&t<=(n[N].coordinate+n[N+1].coordinate)/2||N===l-1&&t>(n[N].coordinate+n[N-1].coordinate)/2){o=n[N].index;break}return o},uI=function(t){var r,n=t,a=n.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Kr(Kr({},t.type.defaultProps),t.props):t.props,o=i.stroke,l=i.fill,c;switch(a){case"Line":c=o;break;case"Area":case"Radar":c=o&&o!=="none"?o:l;break;default:c=l;break}return c},b$e=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var o={},l=Object.keys(i),c=0,u=l.length;c<u;c++)for(var d=i[l[c]].stackGroups,h=Object.keys(d),f=0,p=h.length;f<p;f++){var m=d[h[f]],v=m.items,g=m.cateAxisId,x=v.filter(function(S){return pl(S.type).indexOf("Bar")>=0});if(x&&x.length){var y=x[0].type.defaultProps,b=y!==void 0?Kr(Kr({},y),x[0].props):x[0].props,N=b.barSize,j=b[g];o[j]||(o[j]=[]);var _=Ot(N)?r:N;o[j].push({item:x[0],stackList:x.slice(1),barSize:Ot(_)?void 0:$d(_,n,0)})}}return o},w$e=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,o=i===void 0?[]:i,l=t.maxBarSize,c=o.length;if(c<1)return null;var u=$d(r,a,0,!0),d,h=[];if(o[0].barSize===+o[0].barSize){var f=!1,p=a/c,m=o.reduce(function(N,j){return N+j.barSize||0},0);m+=(c-1)*u,m>=a&&(m-=(c-1)*u,u=0),m>=a&&p>0&&(f=!0,p*=.9,m=c*p);var v=(a-m)/2>>0,g={offset:v-u,size:0};d=o.reduce(function(N,j){var _={item:j.item,position:{offset:g.offset+g.size+u,size:f?p:j.barSize}},S=[].concat(m5(N),[_]);return g=S[S.length-1].position,j.stackList&&j.stackList.length&&j.stackList.forEach(function(C){S.push({item:C,position:g})}),S},h)}else{var x=$d(n,a,0,!0);a-2*x-(c-1)*u<=0&&(u=0);var y=(a-2*x-(c-1)*u)/c;y>1&&(y>>=0);var b=l===+l?Math.min(y,l):y;d=o.reduce(function(N,j,_){var S=[].concat(m5(N),[{item:j.item,position:{offset:x+(y+u)*_+(y-b)/2,size:b}}]);return j.stackList&&j.stackList.length&&j.stackList.forEach(function(C){S.push({item:C,position:S[S.length-1].position})}),S},h)}return d},j$e=function(t,r,n,a){var i=n.children,o=n.width,l=n.margin,c=o-(l.left||0)-(l.right||0),u=DY({children:i,legendWidth:c});if(u){var d=a||{},h=d.width,f=d.height,p=u.align,m=u.verticalAlign,v=u.layout;if((v==="vertical"||v==="horizontal"&&m==="middle")&&p!=="center"&&Te(t[p]))return Kr(Kr({},t),{},kf({},p,t[p]+(h||0)));if((v==="horizontal"||v==="vertical"&&p==="center")&&m!=="middle"&&Te(t[m]))return Kr(Kr({},t),{},kf({},m,t[m]+(f||0)))}return t},N$e=function(t,r,n){return Ot(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},MY=function(t,r,n,a,i){var o=r.props.children,l=oi(o,ey).filter(function(u){return N$e(a,i,u.props.direction)});if(l&&l.length){var c=l.map(function(u){return u.props.dataKey});return t.reduce(function(u,d){var h=Ua(d,n);if(Ot(h))return u;var f=Array.isArray(h)?[$N(h),Cc(h)]:[h,h],p=c.reduce(function(m,v){var g=Ua(d,v,0),x=f[0]-Math.abs(Array.isArray(g)?g[0]:g),y=f[1]+Math.abs(Array.isArray(g)?g[1]:g);return[Math.min(x,m[0]),Math.max(y,m[1])]},[1/0,-1/0]);return[Math.min(p[0],u[0]),Math.max(p[1],u[1])]},[1/0,-1/0])}return null},_$e=function(t,r,n,a,i){var o=r.map(function(l){return MY(t,l,n,i,a)}).filter(function(l){return!Ot(l)});return o&&o.length?o.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},$Y=function(t,r,n,a,i){var o=r.map(function(c){var u=c.props.dataKey;return n==="number"&&u&&MY(t,c,u,a)||Iv(t,u,n,i)});if(n==="number")return o.reduce(function(c,u){return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);var l={};return o.reduce(function(c,u){for(var d=0,h=u.length;d<h;d++)l[u[d]]||(l[u[d]]=!0,c.push(u[d]));return c},[])},FY=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},LY=function(t,r,n,a){if(a)return t.map(function(c){return c.coordinate});var i,o,l=t.map(function(c){return c.coordinate===r&&(i=!0),c.coordinate===n&&(o=!0),c.coordinate});return i||l.push(r),o||l.push(n),l},dl=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,o=t.type,l=t.range,c=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,u=(r||n)&&o==="category"&&a.bandwidth?a.bandwidth()/c:0;if(u=t.axisType==="angleAxis"&&(l==null?void 0:l.length)>=2?$i(l[0]-l[1])*2*u:u,r&&(t.ticks||t.niceTicks)){var d=(t.ticks||t.niceTicks).map(function(h){var f=i?i.indexOf(h):h;return{coordinate:a(f)+u,value:h,offset:u}});return d.filter(function(h){return!cm(h.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(h,f){return{coordinate:a(h)+u,value:h,index:f,offset:u}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(h){return{coordinate:a(h)+u,value:h,offset:u}}):a.domain().map(function(h,f){return{coordinate:a(h)+u,value:i?i[h]:h,index:f,offset:u}})},dS=new WeakMap,yb=function(t,r){if(typeof r!="function")return t;dS.has(t)||dS.set(t,new WeakMap);var n=dS.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},S$e=function(t,r,n){var a=t.scale,i=t.type,o=t.layout,l=t.axisType;if(a==="auto")return o==="radial"&&l==="radiusAxis"?{scale:Ig(),realScaleType:"band"}:o==="radial"&&l==="angleAxis"?{scale:Uw(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:Ov(),realScaleType:"point"}:i==="category"?{scale:Ig(),realScaleType:"band"}:{scale:Uw(),realScaleType:"linear"};if(Md(a)){var c="scale".concat(_N(a));return{scale:(c5[c]||Ov)(),realScaleType:c5[c]?c:"point"}}return bt(a)?{scale:a}:{scale:Ov(),realScaleType:"point"}},g5=1e-4,C$e=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-g5,o=Math.max(a[0],a[1])+g5,l=t(r[0]),c=t(r[n-1]);(l<i||l>o||c<i||c>o)&&t.domain([r[0],r[n-1]])}},E$e=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},k$e=function(t,r){if(!r||r.length!==2||!Te(r[0])||!Te(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!Te(t[0])||t[0]<n)&&(i[0]=n),(!Te(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},A$e=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0,l=0;l<r;++l){var c=cm(t[l][n][1])?t[l][n][0]:t[l][n][1];c>=0?(t[l][n][0]=i,t[l][n][1]=i+c,i=t[l][n][1]):(t[l][n][0]=o,t[l][n][1]=o+c,o=t[l][n][1])}},P$e=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0;o<r;++o){var l=cm(t[o][n][1])?t[o][n][0]:t[o][n][1];l>=0?(t[o][n][0]=i,t[o][n][1]=i+l,i=t[o][n][1]):(t[o][n][0]=0,t[o][n][1]=0)}},T$e={sign:A$e,expand:qSe,none:np,silhouette:GSe,wiggle:HSe,positive:P$e},R$e=function(t,r,n){var a=r.map(function(l){return l.props.dataKey}),i=T$e[n],o=WSe().keys(a).value(function(l,c){return+Ua(l,c,0)}).order(tk).offset(i);return o(t)},O$e=function(t,r,n,a,i,o){if(!t)return null;var l=o?r.reverse():r,c={},u=l.reduce(function(h,f){var p,m=(p=f.type)!==null&&p!==void 0&&p.defaultProps?Kr(Kr({},f.type.defaultProps),f.props):f.props,v=m.stackId,g=m.hide;if(g)return h;var x=m[n],y=h[x]||{hasStack:!1,stackGroups:{}};if(kn(v)){var b=y.stackGroups[v]||{numericAxisId:n,cateAxisId:a,items:[]};b.items.push(f),y.hasStack=!0,y.stackGroups[v]=b}else y.stackGroups[um("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[f]};return Kr(Kr({},h),{},kf({},x,y))},c),d={};return Object.keys(u).reduce(function(h,f){var p=u[f];if(p.hasStack){var m={};p.stackGroups=Object.keys(p.stackGroups).reduce(function(v,g){var x=p.stackGroups[g];return Kr(Kr({},v),{},kf({},g,{numericAxisId:n,cateAxisId:a,items:x.items,stackedData:R$e(t,x.items,i)}))},m)}return Kr(Kr({},h),{},kf({},f,p))},d)},I$e=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,o=r.originalDomain,l=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&a==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var u=t.domain();if(!u.length)return null;var d=q3e(u,i,l);return t.domain([$N(d),Cc(d)]),{niceTicks:d}}if(i&&a==="number"){var h=t.domain(),f=G3e(h,i,l);return{niceTicks:f}}return null};function Kw(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,i=e.index,o=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Ot(a[t.dataKey])){var l=xw(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=Ua(a,Ot(o)?t.dataKey:o);return Ot(c)?null:t.scale(c)}var x5=function(t){var r=t.axis,n=t.ticks,a=t.offset,i=t.bandSize,o=t.entry,l=t.index;if(r.type==="category")return n[l]?n[l].coordinate+a:null;var c=Ua(o,r.dataKey,r.domain[l]);return Ot(c)?null:r.scale(c)-i/2+a},D$e=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},M$e=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Kr(Kr({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(kn(i)){var o=r[i];if(o){var l=o.items.indexOf(t);return l>=0?o.stackedData[l]:null}}return null},$$e=function(t){return t.reduce(function(r,n){return[$N(n.concat([r[0]]).filter(Te)),Cc(n.concat([r[1]]).filter(Te))]},[1/0,-1/0])},BY=function(t,r,n){return Object.keys(t).reduce(function(a,i){var o=t[i],l=o.stackedData,c=l.reduce(function(u,d){var h=$$e(d.slice(r,n+1));return[Math.min(u[0],h[0]),Math.max(u[1],h[1])]},[1/0,-1/0]);return[Math.min(c[0],a[0]),Math.max(c[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},y5=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,b5=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Tk=function(t,r,n){if(bt(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(Te(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(y5.test(t[0])){var i=+y5.exec(t[0])[1];a[0]=r[0]-i}else bt(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(Te(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(b5.test(t[1])){var o=+b5.exec(t[1])[1];a[1]=r[1]+o}else bt(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},Yw=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=FO(r,function(h){return h.coordinate}),o=1/0,l=1,c=i.length;l<c;l++){var u=i[l],d=i[l-1];o=Math.min((u.coordinate||0)-(d.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},w5=function(t,r,n){return!t||!t.length||dp(t,ii(n,"type.defaultProps.domain"))?r:t},UY=function(t,r){var n=t.type.defaultProps?Kr(Kr({},t.type.defaultProps),t.props):t.props,a=n.dataKey,i=n.name,o=n.unit,l=n.formatter,c=n.tooltipType,u=n.chartType,d=n.hide;return Kr(Kr({},Ct(t,!1)),{},{dataKey:a,unit:o,formatter:l,name:i||a,color:uI(t),value:Ua(r,a),type:c,payload:r,chartType:u,hide:d})};function zg(e){"@babel/helpers - typeof";return zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zg(e)}function j5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function N5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j5(Object(r),!0).forEach(function(n){F$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function F$e(e,t,r){return t=L$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L$e(e){var t=B$e(e,"string");return zg(t)=="symbol"?t:t+""}function B$e(e,t){if(zg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xw=Math.PI/180,U$e=function(t){return t*180/Math.PI},aa=function(t,r,n,a){return{x:t+Math.cos(-Xw*a)*n,y:r+Math.sin(-Xw*a)*n}},V$e=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-o,2))},z$e=function(t,r){var n=t.x,a=t.y,i=r.cx,o=r.cy,l=V$e({x:n,y:a},{x:i,y:o});if(l<=0)return{radius:l};var c=(n-i)/l,u=Math.acos(c);return a>o&&(u=2*Math.PI-u),{radius:l,angle:U$e(u),angleInRadian:u}},W$e=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),o=Math.min(a,i);return{startAngle:r-o*360,endAngle:n-o*360}},q$e=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),o=Math.floor(a/360),l=Math.min(i,o);return t+l*360},_5=function(t,r){var n=t.x,a=t.y,i=z$e({x:n,y:a},r),o=i.radius,l=i.angle,c=r.innerRadius,u=r.outerRadius;if(o<c||o>u)return!1;if(o===0)return!0;var d=W$e(r),h=d.startAngle,f=d.endAngle,p=l,m;if(h<=f){for(;p>f;)p-=360;for(;p<h;)p+=360;m=p>=h&&p<=f}else{for(;p>h;)p-=360;for(;p<f;)p+=360;m=p>=f&&p<=h}return m?N5(N5({},r),{},{radius:o,angle:q$e(p,r)}):null};function Wg(e){"@babel/helpers - typeof";return Wg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wg(e)}var G$e=["offset"];function H$e(e){return Q$e(e)||X$e(e)||Y$e(e)||K$e()}function K$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y$e(e,t){if(e){if(typeof e=="string")return Rk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rk(e,t)}}function X$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Q$e(e){if(Array.isArray(e))return Rk(e)}function Rk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Z$e(e,t){if(e==null)return{};var r=J$e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function J$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function S5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S5(Object(r),!0).forEach(function(n){eFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eFe(e,t,r){return t=tFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tFe(e){var t=rFe(e,"string");return Wg(t)=="symbol"?t:t+""}function rFe(e,t){if(Wg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qg(){return qg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qg.apply(this,arguments)}var nFe=function(t){var r=t.value,n=t.formatter,a=Ot(t.children)?r:t.children;return bt(n)?n(a):a},aFe=function(t,r){var n=$i(r-t),a=Math.min(Math.abs(r-t),360);return n*a},sFe=function(t,r,n){var a=t.position,i=t.viewBox,o=t.offset,l=t.className,c=i,u=c.cx,d=c.cy,h=c.innerRadius,f=c.outerRadius,p=c.startAngle,m=c.endAngle,v=c.clockWise,g=(h+f)/2,x=aFe(p,m),y=x>=0?1:-1,b,N;a==="insideStart"?(b=p+y*o,N=v):a==="insideEnd"?(b=m-y*o,N=!v):a==="end"&&(b=m+y*o,N=v),N=x<=0?N:!N;var j=aa(u,d,g,b),_=aa(u,d,g,b+(N?1:-1)*359),S="M".concat(j.x,",").concat(j.y,`
    A`).concat(g,",").concat(g,",0,1,").concat(N?0:1,`,
    `).concat(_.x,",").concat(_.y),C=Ot(t.id)?um("recharts-radial-line-"):t.id;return F.createElement("text",qg({},n,{dominantBaseline:"central",className:Ut("recharts-radial-bar-label",l)}),F.createElement("defs",null,F.createElement("path",{id:C,d:S})),F.createElement("textPath",{xlinkHref:"#".concat(C)},r))},iFe=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,o=i.cx,l=i.cy,c=i.innerRadius,u=i.outerRadius,d=i.startAngle,h=i.endAngle,f=(d+h)/2;if(a==="outside"){var p=aa(o,l,u+n,f),m=p.x,v=p.y;return{x:m,y:v,textAnchor:m>=o?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"end"};var g=(c+u)/2,x=aa(o,l,g,f),y=x.x,b=x.y;return{x:y,y:b,textAnchor:"middle",verticalAnchor:"middle"}},oFe=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,o=r,l=o.x,c=o.y,u=o.width,d=o.height,h=d>=0?1:-1,f=h*a,p=h>0?"end":"start",m=h>0?"start":"end",v=u>=0?1:-1,g=v*a,x=v>0?"end":"start",y=v>0?"start":"end";if(i==="top"){var b={x:l+u/2,y:c-h*a,textAnchor:"middle",verticalAnchor:p};return yn(yn({},b),n?{height:Math.max(c-n.y,0),width:u}:{})}if(i==="bottom"){var N={x:l+u/2,y:c+d+f,textAnchor:"middle",verticalAnchor:m};return yn(yn({},N),n?{height:Math.max(n.y+n.height-(c+d),0),width:u}:{})}if(i==="left"){var j={x:l-g,y:c+d/2,textAnchor:x,verticalAnchor:"middle"};return yn(yn({},j),n?{width:Math.max(j.x-n.x,0),height:d}:{})}if(i==="right"){var _={x:l+u+g,y:c+d/2,textAnchor:y,verticalAnchor:"middle"};return yn(yn({},_),n?{width:Math.max(n.x+n.width-_.x,0),height:d}:{})}var S=n?{width:u,height:d}:{};return i==="insideLeft"?yn({x:l+g,y:c+d/2,textAnchor:y,verticalAnchor:"middle"},S):i==="insideRight"?yn({x:l+u-g,y:c+d/2,textAnchor:x,verticalAnchor:"middle"},S):i==="insideTop"?yn({x:l+u/2,y:c+f,textAnchor:"middle",verticalAnchor:m},S):i==="insideBottom"?yn({x:l+u/2,y:c+d-f,textAnchor:"middle",verticalAnchor:p},S):i==="insideTopLeft"?yn({x:l+g,y:c+f,textAnchor:y,verticalAnchor:m},S):i==="insideTopRight"?yn({x:l+u-g,y:c+f,textAnchor:x,verticalAnchor:m},S):i==="insideBottomLeft"?yn({x:l+g,y:c+d-f,textAnchor:y,verticalAnchor:p},S):i==="insideBottomRight"?yn({x:l+u-g,y:c+d-f,textAnchor:x,verticalAnchor:p},S):sm(i)&&(Te(i.x)||Qu(i.x))&&(Te(i.y)||Qu(i.y))?yn({x:l+$d(i.x,u),y:c+$d(i.y,d),textAnchor:"end",verticalAnchor:"end"},S):yn({x:l+u/2,y:c+d/2,textAnchor:"middle",verticalAnchor:"middle"},S)},lFe=function(t){return"cx"in t&&Te(t.cx)};function xa(e){var t=e.offset,r=t===void 0?5:t,n=Z$e(e,G$e),a=yn({offset:r},n),i=a.viewBox,o=a.position,l=a.value,c=a.children,u=a.content,d=a.className,h=d===void 0?"":d,f=a.textBreakAll;if(!i||Ot(l)&&Ot(c)&&!w.isValidElement(u)&&!bt(u))return null;if(w.isValidElement(u))return w.cloneElement(u,a);var p;if(bt(u)){if(p=w.createElement(u,a),w.isValidElement(p))return p}else p=nFe(a);var m=lFe(i),v=Ct(a,!0);if(m&&(o==="insideStart"||o==="insideEnd"||o==="end"))return sFe(a,p,v);var g=m?iFe(a):oFe(a);return F.createElement(Iw,qg({className:Ut("recharts-label",h)},v,g,{breakAll:f}),p)}xa.displayName="Label";var VY=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,o=t.endAngle,l=t.r,c=t.radius,u=t.innerRadius,d=t.outerRadius,h=t.x,f=t.y,p=t.top,m=t.left,v=t.width,g=t.height,x=t.clockWise,y=t.labelViewBox;if(y)return y;if(Te(v)&&Te(g)){if(Te(h)&&Te(f))return{x:h,y:f,width:v,height:g};if(Te(p)&&Te(m))return{x:p,y:m,width:v,height:g}}return Te(h)&&Te(f)?{x:h,y:f,width:0,height:0}:Te(r)&&Te(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:o||a||0,innerRadius:u||0,outerRadius:d||c||l||0,clockWise:x}:t.viewBox?t.viewBox:{}},cFe=function(t,r){return t?t===!0?F.createElement(xa,{key:"label-implicit",viewBox:r}):kn(t)?F.createElement(xa,{key:"label-implicit",viewBox:r,value:t}):w.isValidElement(t)?t.type===xa?w.cloneElement(t,{key:"label-implicit",viewBox:r}):F.createElement(xa,{key:"label-implicit",content:t,viewBox:r}):bt(t)?F.createElement(xa,{key:"label-implicit",content:t,viewBox:r}):sm(t)?F.createElement(xa,qg({viewBox:r},t,{key:"label-implicit"})):null:null},uFe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=VY(t),o=oi(a,xa).map(function(c,u){return w.cloneElement(c,{viewBox:r||i,key:"label-".concat(u)})});if(!n)return o;var l=cFe(t.label,r||i);return[l].concat(H$e(o))};xa.parseViewBox=VY;xa.renderCallByParent=uFe;function dFe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var hFe=dFe;const fFe=lr(hFe);function Gg(e){"@babel/helpers - typeof";return Gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gg(e)}var pFe=["valueAccessor"],mFe=["data","dataKey","clockWise","id","textBreakAll"];function vFe(e){return bFe(e)||yFe(e)||xFe(e)||gFe()}function gFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xFe(e,t){if(e){if(typeof e=="string")return Ok(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ok(e,t)}}function yFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bFe(e){if(Array.isArray(e))return Ok(e)}function Ok(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Qw(){return Qw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qw.apply(this,arguments)}function C5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function E5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C5(Object(r),!0).forEach(function(n){wFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wFe(e,t,r){return t=jFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jFe(e){var t=NFe(e,"string");return Gg(t)=="symbol"?t:t+""}function NFe(e,t){if(Gg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function k5(e,t){if(e==null)return{};var r=_Fe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _Fe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var SFe=function(t){return Array.isArray(t.value)?fFe(t.value):t.value};function gl(e){var t=e.valueAccessor,r=t===void 0?SFe:t,n=k5(e,pFe),a=n.data,i=n.dataKey,o=n.clockWise,l=n.id,c=n.textBreakAll,u=k5(n,mFe);return!a||!a.length?null:F.createElement(yr,{className:"recharts-label-list"},a.map(function(d,h){var f=Ot(i)?r(d,h):Ua(d&&d.payload,i),p=Ot(l)?{}:{id:"".concat(l,"-").concat(h)};return F.createElement(xa,Qw({},Ct(d,!0),u,p,{parentViewBox:d.parentViewBox,value:f,textBreakAll:c,viewBox:xa.parseViewBox(Ot(o)?d:E5(E5({},d),{},{clockWise:o})),key:"label-".concat(h),index:h}))}))}gl.displayName="LabelList";function CFe(e,t){return e?e===!0?F.createElement(gl,{key:"labelList-implicit",data:t}):F.isValidElement(e)||bt(e)?F.createElement(gl,{key:"labelList-implicit",data:t,content:e}):sm(e)?F.createElement(gl,Qw({data:t},e,{key:"labelList-implicit"})):null:null}function EFe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=oi(n,gl).map(function(o,l){return w.cloneElement(o,{data:t,key:"labelList-".concat(l)})});if(!r)return a;var i=CFe(e.label,t);return[i].concat(vFe(a))}gl.renderCallByParent=EFe;function Hg(e){"@babel/helpers - typeof";return Hg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hg(e)}function Ik(){return Ik=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ik.apply(this,arguments)}function A5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function P5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A5(Object(r),!0).forEach(function(n){kFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kFe(e,t,r){return t=AFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AFe(e){var t=PFe(e,"string");return Hg(t)=="symbol"?t:t+""}function PFe(e,t){if(Hg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TFe=function(t,r){var n=$i(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},bb=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,o=t.sign,l=t.isExternal,c=t.cornerRadius,u=t.cornerIsExternal,d=c*(l?1:-1)+a,h=Math.asin(c/d)/Xw,f=u?i:i+o*h,p=aa(r,n,d,f),m=aa(r,n,a,f),v=u?i-o*h:i,g=aa(r,n,d*Math.cos(h*Xw),v);return{center:p,circleTangency:m,lineTangency:g,theta:h}},zY=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.startAngle,l=t.endAngle,c=TFe(o,l),u=o+c,d=aa(r,n,i,o),h=aa(r,n,i,u),f="M ".concat(d.x,",").concat(d.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(o>u),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(a>0){var p=aa(r,n,a,o),m=aa(r,n,a,u);f+="L ".concat(m.x,",").concat(m.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(o<=u),`,
            `).concat(p.x,",").concat(p.y," Z")}else f+="L ".concat(r,",").concat(n," Z");return f},RFe=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,u=t.startAngle,d=t.endAngle,h=$i(d-u),f=bb({cx:r,cy:n,radius:i,angle:u,sign:h,cornerRadius:o,cornerIsExternal:c}),p=f.circleTangency,m=f.lineTangency,v=f.theta,g=bb({cx:r,cy:n,radius:i,angle:d,sign:-h,cornerRadius:o,cornerIsExternal:c}),x=g.circleTangency,y=g.lineTangency,b=g.theta,N=c?Math.abs(u-d):Math.abs(u-d)-v-b;if(N<0)return l?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):zY({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:d});var j="M ".concat(m.x,",").concat(m.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(N>180),",").concat(+(h<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(y.x,",").concat(y.y,`
  `);if(a>0){var _=bb({cx:r,cy:n,radius:a,angle:u,sign:h,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),S=_.circleTangency,C=_.lineTangency,E=_.theta,k=bb({cx:r,cy:n,radius:a,angle:d,sign:-h,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),P=k.circleTangency,A=k.lineTangency,O=k.theta,I=c?Math.abs(u-d):Math.abs(u-d)-E-O;if(I<0&&o===0)return"".concat(j,"L").concat(r,",").concat(n,"Z");j+="L".concat(A.x,",").concat(A.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(P.x,",").concat(P.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(I>180),",").concat(+(h>0),",").concat(S.x,",").concat(S.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(C.x,",").concat(C.y,"Z")}else j+="L".concat(r,",").concat(n,"Z");return j},OFe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},WY=function(t){var r=P5(P5({},OFe),t),n=r.cx,a=r.cy,i=r.innerRadius,o=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,u=r.cornerIsExternal,d=r.startAngle,h=r.endAngle,f=r.className;if(o<i||d===h)return null;var p=Ut("recharts-sector",f),m=o-i,v=$d(l,m,0,!0),g;return v>0&&Math.abs(d-h)<360?g=RFe({cx:n,cy:a,innerRadius:i,outerRadius:o,cornerRadius:Math.min(v,m/2),forceCornerRadius:c,cornerIsExternal:u,startAngle:d,endAngle:h}):g=zY({cx:n,cy:a,innerRadius:i,outerRadius:o,startAngle:d,endAngle:h}),F.createElement("path",Ik({},Ct(r,!0),{className:p,d:g,role:"img"}))};function Kg(e){"@babel/helpers - typeof";return Kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kg(e)}function Dk(){return Dk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dk.apply(this,arguments)}function T5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function R5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T5(Object(r),!0).forEach(function(n){IFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IFe(e,t,r){return t=DFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DFe(e){var t=MFe(e,"string");return Kg(t)=="symbol"?t:t+""}function MFe(e,t){if(Kg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var O5={curveBasisClosed:OSe,curveBasisOpen:ISe,curveBasis:RSe,curveBumpX:xSe,curveBumpY:ySe,curveLinearClosed:DSe,curveLinear:CN,curveMonotoneX:MSe,curveMonotoneY:$Se,curveNatural:FSe,curveStep:LSe,curveStepAfter:USe,curveStepBefore:BSe},wb=function(t){return t.x===+t.x&&t.y===+t.y},Hm=function(t){return t.x},Km=function(t){return t.y},$Fe=function(t,r){if(bt(t))return t;var n="curve".concat(_N(t));return(n==="curveMonotone"||n==="curveBump")&&r?O5["".concat(n).concat(r==="vertical"?"Y":"X")]:O5[n]||CN},FFe=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,o=t.baseLine,l=t.layout,c=t.connectNulls,u=c===void 0?!1:c,d=$Fe(n,l),h=u?i.filter(function(v){return wb(v)}):i,f;if(Array.isArray(o)){var p=u?o.filter(function(v){return wb(v)}):o,m=h.map(function(v,g){return R5(R5({},v),{},{base:p[g]})});return l==="vertical"?f=db().y(Km).x1(Hm).x0(function(v){return v.base.x}):f=db().x(Hm).y1(Km).y0(function(v){return v.base.y}),f.defined(wb).curve(d),f(m)}return l==="vertical"&&Te(o)?f=db().y(Km).x1(Hm).x0(o):Te(o)?f=db().x(Hm).y1(Km).y0(o):f=W7().x(Hm).y(Km),f.defined(wb).curve(d),f(h)},Af=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var o=n&&n.length?FFe(t):a;return w.createElement("path",Dk({},Ct(t,!1),yw(t),{className:Ut("recharts-curve",r),d:o,ref:i}))},qY={exports:{}},LFe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",BFe=LFe,UFe=BFe;function GY(){}function HY(){}HY.resetWarningCache=GY;var VFe=function(){function e(n,a,i,o,l,c){if(c!==UFe){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:HY,resetWarningCache:GY};return r.PropTypes=r,r};qY.exports=VFe();var zFe=qY.exports;const tr=lr(zFe);var WFe=Object.getOwnPropertyNames,qFe=Object.getOwnPropertySymbols,GFe=Object.prototype.hasOwnProperty;function I5(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function jb(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var i=a.cache,o=i.get(r),l=i.get(n);if(o&&l)return o===n&&l===r;i.set(r,n),i.set(n,r);var c=e(r,n,a);return i.delete(r),i.delete(n),c}}function D5(e){return WFe(e).concat(qFe(e))}var HFe=Object.hasOwn||function(e,t){return GFe.call(e,t)};function uh(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var KFe="__v",YFe="__o",XFe="_owner",M5=Object.getOwnPropertyDescriptor,$5=Object.keys;function QFe(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function ZFe(e,t){return uh(e.getTime(),t.getTime())}function JFe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function e5e(e,t){return e===t}function F5(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.entries(),o,l,c=0;(o=i.next())&&!o.done;){for(var u=t.entries(),d=!1,h=0;(l=u.next())&&!l.done;){if(a[h]){h++;continue}var f=o.value,p=l.value;if(r.equals(f[0],p[0],c,h,e,t,r)&&r.equals(f[1],p[1],f[0],p[0],e,t,r)){d=a[h]=!0;break}h++}if(!d)return!1;c++}return!0}var t5e=uh;function r5e(e,t,r){var n=$5(e),a=n.length;if($5(t).length!==a)return!1;for(;a-- >0;)if(!KY(e,t,r,n[a]))return!1;return!0}function Ym(e,t,r){var n=D5(e),a=n.length;if(D5(t).length!==a)return!1;for(var i,o,l;a-- >0;)if(i=n[a],!KY(e,t,r,i)||(o=M5(e,i),l=M5(t,i),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function n5e(e,t){return uh(e.valueOf(),t.valueOf())}function a5e(e,t){return e.source===t.source&&e.flags===t.flags}function L5(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.values(),o,l;(o=i.next())&&!o.done;){for(var c=t.values(),u=!1,d=0;(l=c.next())&&!l.done;){if(!a[d]&&r.equals(o.value,l.value,o.value,l.value,e,t,r)){u=a[d]=!0;break}d++}if(!u)return!1}return!0}function s5e(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function i5e(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function KY(e,t,r,n){return(n===XFe||n===YFe||n===KFe)&&(e.$$typeof||t.$$typeof)?!0:HFe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var o5e="[object Arguments]",l5e="[object Boolean]",c5e="[object Date]",u5e="[object Error]",d5e="[object Map]",h5e="[object Number]",f5e="[object Object]",p5e="[object RegExp]",m5e="[object Set]",v5e="[object String]",g5e="[object URL]",x5e=Array.isArray,B5=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,U5=Object.assign,y5e=Object.prototype.toString.call.bind(Object.prototype.toString);function b5e(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,i=e.areMapsEqual,o=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,u=e.areRegExpsEqual,d=e.areSetsEqual,h=e.areTypedArraysEqual,f=e.areUrlsEqual;return function(m,v,g){if(m===v)return!0;if(m==null||v==null)return!1;var x=typeof m;if(x!==typeof v)return!1;if(x!=="object")return x==="number"?o(m,v,g):x==="function"?a(m,v,g):!1;var y=m.constructor;if(y!==v.constructor)return!1;if(y===Object)return l(m,v,g);if(x5e(m))return t(m,v,g);if(B5!=null&&B5(m))return h(m,v,g);if(y===Date)return r(m,v,g);if(y===RegExp)return u(m,v,g);if(y===Map)return i(m,v,g);if(y===Set)return d(m,v,g);var b=y5e(m);return b===c5e?r(m,v,g):b===p5e?u(m,v,g):b===d5e?i(m,v,g):b===m5e?d(m,v,g):b===f5e?typeof m.then!="function"&&typeof v.then!="function"&&l(m,v,g):b===g5e?f(m,v,g):b===u5e?n(m,v,g):b===o5e?l(m,v,g):b===l5e||b===h5e||b===v5e?c(m,v,g):!1}}function w5e(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?Ym:QFe,areDatesEqual:ZFe,areErrorsEqual:JFe,areFunctionsEqual:e5e,areMapsEqual:n?I5(F5,Ym):F5,areNumbersEqual:t5e,areObjectsEqual:n?Ym:r5e,arePrimitiveWrappersEqual:n5e,areRegExpsEqual:a5e,areSetsEqual:n?I5(L5,Ym):L5,areTypedArraysEqual:n?Ym:s5e,areUrlsEqual:i5e};if(r&&(a=U5({},a,r(a))),t){var i=jb(a.areArraysEqual),o=jb(a.areMapsEqual),l=jb(a.areObjectsEqual),c=jb(a.areSetsEqual);a=U5({},a,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:l,areSetsEqual:c})}return a}function j5e(e){return function(t,r,n,a,i,o,l){return e(t,r,l)}}function N5e(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,i=e.strict;if(n)return function(c,u){var d=n(),h=d.cache,f=h===void 0?t?new WeakMap:void 0:h,p=d.meta;return r(c,u,{cache:f,equals:a,meta:p,strict:i})};if(t)return function(c,u){return r(c,u,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var o={cache:void 0,equals:a,meta:void 0,strict:i};return function(c,u){return r(c,u,o)}}var _5e=yu();yu({strict:!0});yu({circular:!0});yu({circular:!0,strict:!0});yu({createInternalComparator:function(){return uh}});yu({strict:!0,createInternalComparator:function(){return uh}});yu({circular:!0,createInternalComparator:function(){return uh}});yu({circular:!0,createInternalComparator:function(){return uh},strict:!0});function yu(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,i=e.strict,o=i===void 0?!1:i,l=w5e(e),c=b5e(l),u=n?n(c):j5e(c);return N5e({circular:r,comparator:c,createState:a,equals:u,strict:o})}function S5e(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function V5(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):S5e(a)};requestAnimationFrame(n)}function Mk(e){"@babel/helpers - typeof";return Mk=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mk(e)}function C5e(e){return P5e(e)||A5e(e)||k5e(e)||E5e()}function E5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k5e(e,t){if(e){if(typeof e=="string")return z5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z5(e,t)}}function z5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function A5e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function P5e(e){if(Array.isArray(e))return e}function T5e(){var e={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,l=C5e(o),c=l[0],u=l.slice(1);if(typeof c=="number"){V5(a.bind(null,u),c);return}a(c),V5(a.bind(null,u));return}Mk(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function Yg(e){"@babel/helpers - typeof";return Yg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yg(e)}function W5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function q5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W5(Object(r),!0).forEach(function(n){YY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YY(e,t,r){return t=R5e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R5e(e){var t=O5e(e,"string");return Yg(t)==="symbol"?t:String(t)}function O5e(e,t){if(Yg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I5e=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},D5e=function(t){return t},M5e=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},Dv=function(t,r){return Object.keys(r).reduce(function(n,a){return q5(q5({},n),{},YY({},a,t(a,r[a])))},{})},G5=function(t,r,n){return t.map(function(a){return"".concat(M5e(a)," ").concat(r,"ms ").concat(n)}).join(",")};function $5e(e,t){return B5e(e)||L5e(e,t)||XY(e,t)||F5e()}function F5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L5e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function B5e(e){if(Array.isArray(e))return e}function U5e(e){return W5e(e)||z5e(e)||XY(e)||V5e()}function V5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XY(e,t){if(e){if(typeof e=="string")return $k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $k(e,t)}}function z5e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function W5e(e){if(Array.isArray(e))return $k(e)}function $k(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Zw=1e-4,QY=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},ZY=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},H5=function(t,r){return function(n){var a=QY(t,r);return ZY(a,n)}},q5e=function(t,r){return function(n){var a=QY(t,r),i=[].concat(U5e(a.map(function(o,l){return o*l}).slice(1)),[0]);return ZY(i,n)}},K5=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],o=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,o=1,l=1;break;case"ease":a=.25,i=.1,o=.25,l=1;break;case"ease-in":a=.42,i=0,o=1,l=1;break;case"ease-out":a=.42,i=0,o=.58,l=1;break;case"ease-in-out":a=0,i=0,o=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var u=c[1].split(")")[0].split(",").map(function(g){return parseFloat(g)}),d=$5e(u,4);a=d[0],i=d[1],o=d[2],l=d[3]}}}var h=H5(a,o),f=H5(i,l),p=q5e(a,o),m=function(x){return x>1?1:x<0?0:x},v=function(x){for(var y=x>1?1:x,b=y,N=0;N<8;++N){var j=h(b)-y,_=p(b);if(Math.abs(j-y)<Zw||_<Zw)return f(b);b=m(b-j/_)}return f(b)};return v.isStepper=!1,v},G5e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,o=t.dt,l=o===void 0?17:o,c=function(d,h,f){var p=-(d-h)*n,m=f*i,v=f+(p-m)*l/1e3,g=f*l/1e3+d;return Math.abs(g-h)<Zw&&Math.abs(v)<Zw?[h,0]:[g,v]};return c.isStepper=!0,c.dt=l,c},H5e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return K5(a);case"spring":return G5e();default:if(a.split("(")[0]==="cubic-bezier")return K5(a)}return typeof a=="function"?a:null};function Xg(e){"@babel/helpers - typeof";return Xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xg(e)}function Y5(e){return X5e(e)||Y5e(e)||JY(e)||K5e()}function K5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y5e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function X5e(e){if(Array.isArray(e))return Lk(e)}function X5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Zn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X5(Object(r),!0).forEach(function(n){Fk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fk(e,t,r){return t=Q5e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q5e(e){var t=Z5e(e,"string");return Xg(t)==="symbol"?t:String(t)}function Z5e(e,t){if(Xg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function J5e(e,t){return rLe(e)||tLe(e,t)||JY(e,t)||eLe()}function eLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JY(e,t){if(e){if(typeof e=="string")return Lk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lk(e,t)}}function Lk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function rLe(e){if(Array.isArray(e))return e}var Jw=function(t,r,n){return t+(r-t)*n},Bk=function(t){var r=t.from,n=t.to;return r!==n},nLe=function e(t,r,n){var a=Dv(function(i,o){if(Bk(o)){var l=t(o.from,o.to,o.velocity),c=J5e(l,2),u=c[0],d=c[1];return Zn(Zn({},o),{},{from:u,velocity:d})}return o},r);return n<1?Dv(function(i,o){return Bk(o)?Zn(Zn({},o),{},{velocity:Jw(o.velocity,a[i].velocity,n),from:Jw(o.from,a[i].from,n)}):o},r):e(t,a,n-1)};const aLe=function(e,t,r,n,a){var i=I5e(e,t),o=i.reduce(function(g,x){return Zn(Zn({},g),{},Fk({},x,[e[x],t[x]]))},{}),l=i.reduce(function(g,x){return Zn(Zn({},g),{},Fk({},x,{from:e[x],velocity:0,to:t[x]}))},{}),c=-1,u,d,h=function(){return null},f=function(){return Dv(function(x,y){return y.from},l)},p=function(){return!Object.values(l).filter(Bk).length},m=function(x){u||(u=x);var y=x-u,b=y/r.dt;l=nLe(r,l,b),a(Zn(Zn(Zn({},e),t),f())),u=x,p()||(c=requestAnimationFrame(h))},v=function(x){d||(d=x);var y=(x-d)/n,b=Dv(function(j,_){return Jw.apply(void 0,Y5(_).concat([r(y)]))},o);if(a(Zn(Zn(Zn({},e),t),b)),y<1)c=requestAnimationFrame(h);else{var N=Dv(function(j,_){return Jw.apply(void 0,Y5(_).concat([r(1)]))},o);a(Zn(Zn(Zn({},e),t),N))}};return h=r.isStepper?m:v,function(){return requestAnimationFrame(h),function(){cancelAnimationFrame(c)}}};function fp(e){"@babel/helpers - typeof";return fp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fp(e)}var sLe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function iLe(e,t){if(e==null)return{};var r=oLe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function oLe(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function hS(e){return dLe(e)||uLe(e)||cLe(e)||lLe()}function lLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cLe(e,t){if(e){if(typeof e=="string")return Uk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Uk(e,t)}}function uLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dLe(e){if(Array.isArray(e))return Uk(e)}function Uk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Q5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q5(Object(r),!0).forEach(function(n){dv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dv(e,t,r){return t=eX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fLe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eX(n.key),n)}}function pLe(e,t,r){return t&&fLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function eX(e){var t=mLe(e,"string");return fp(t)==="symbol"?t:String(t)}function mLe(e,t){if(fp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vk(e,t)}function Vk(e,t){return Vk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Vk(e,t)}function gLe(e){var t=xLe();return function(){var n=e1(e),a;if(t){var i=e1(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return zk(this,a)}}function zk(e,t){if(t&&(fp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wk(e)}function Wk(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function e1(e){return e1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},e1(e)}var $o=function(e){vLe(r,e);var t=gLe(r);function r(n,a){var i;hLe(this,r),i=t.call(this,n,a);var o=i.props,l=o.isActive,c=o.attributeName,u=o.from,d=o.to,h=o.steps,f=o.children,p=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(Wk(i)),i.changeStyle=i.changeStyle.bind(Wk(i)),!l||p<=0)return i.state={style:{}},typeof f=="function"&&(i.state={style:d}),zk(i);if(h&&h.length)i.state={style:h[0].style};else if(u){if(typeof f=="function")return i.state={style:u},zk(i);i.state={style:c?dv({},c,u):u}}else i.state={style:{}};return i}return pLe(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,o=a.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,o=i.isActive,l=i.canBegin,c=i.attributeName,u=i.shouldReAnimate,d=i.to,h=i.from,f=this.state.style;if(l){if(!o){var p={style:c?dv({},c,d):d};this.state&&f&&(c&&f[c]!==d||!c&&f!==d)&&this.setState(p);return}if(!(_5e(a.to,d)&&a.canBegin&&a.isActive)){var m=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var v=m||u?h:a.to;if(this.state&&f){var g={style:c?dv({},c,v):v};(c&&f[c]!==v||!c&&f!==v)&&this.setState(g)}this.runAnimation(xi(xi({},this.props),{},{from:v,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,o=a.from,l=a.to,c=a.duration,u=a.easing,d=a.begin,h=a.onAnimationEnd,f=a.onAnimationStart,p=aLe(o,l,H5e(u),c,this.changeStyle),m=function(){i.stopJSAnimation=p()};this.manager.start([f,d,m,c,h])}},{key:"runStepAnimation",value:function(a){var i=this,o=a.steps,l=a.begin,c=a.onAnimationStart,u=o[0],d=u.style,h=u.duration,f=h===void 0?0:h,p=function(v,g,x){if(x===0)return v;var y=g.duration,b=g.easing,N=b===void 0?"ease":b,j=g.style,_=g.properties,S=g.onAnimationEnd,C=x>0?o[x-1]:g,E=_||Object.keys(j);if(typeof N=="function"||N==="spring")return[].concat(hS(v),[i.runJSAnimation.bind(i,{from:C.style,to:j,duration:y,easing:N}),y]);var k=G5(E,y,N),P=xi(xi(xi({},C.style),j),{},{transition:k});return[].concat(hS(v),[P,y,S]).filter(D5e)};return this.manager.start([c].concat(hS(o.reduce(p,[d,Math.max(f,l)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=T5e());var i=a.begin,o=a.duration,l=a.attributeName,c=a.to,u=a.easing,d=a.onAnimationStart,h=a.onAnimationEnd,f=a.steps,p=a.children,m=this.manager;if(this.unSubscribe=m.subscribe(this.handleStyleChange),typeof u=="function"||typeof p=="function"||u==="spring"){this.runJSAnimation(a);return}if(f.length>1){this.runStepAnimation(a);return}var v=l?dv({},l,c):c,g=G5(Object.keys(v),o,u);m.start([d,i,xi(xi({},v),{},{transition:g}),o,h])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var o=a.duration;a.attributeName,a.easing;var l=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var c=iLe(a,sLe),u=w.Children.count(i),d=this.state.style;if(typeof i=="function")return i(d);if(!l||u===0||o<=0)return i;var h=function(p){var m=p.props,v=m.style,g=v===void 0?{}:v,x=m.className,y=w.cloneElement(p,xi(xi({},c),{},{style:xi(xi({},g),d),className:x}));return y};return u===1?h(w.Children.only(i)):F.createElement("div",null,w.Children.map(i,function(f){return h(f)}))}}]),r}(w.PureComponent);$o.displayName="Animate";$o.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};$o.propTypes={from:tr.oneOfType([tr.object,tr.string]),to:tr.oneOfType([tr.object,tr.string]),attributeName:tr.string,duration:tr.number,begin:tr.number,easing:tr.oneOfType([tr.string,tr.func]),steps:tr.arrayOf(tr.shape({duration:tr.number.isRequired,style:tr.object.isRequired,easing:tr.oneOfType([tr.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),tr.func]),properties:tr.arrayOf("string"),onAnimationEnd:tr.func})),children:tr.oneOfType([tr.node,tr.func]),isActive:tr.bool,canBegin:tr.bool,onAnimationEnd:tr.func,shouldReAnimate:tr.bool,onAnimationStart:tr.func,onAnimationReStart:tr.func};function Qg(e){"@babel/helpers - typeof";return Qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qg(e)}function t1(){return t1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},t1.apply(this,arguments)}function yLe(e,t){return NLe(e)||jLe(e,t)||wLe(e,t)||bLe()}function bLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wLe(e,t){if(e){if(typeof e=="string")return Z5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z5(e,t)}}function Z5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function NLe(e){if(Array.isArray(e))return e}function J5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function eL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J5(Object(r),!0).forEach(function(n){_Le(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Le(e,t,r){return t=SLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SLe(e){var t=CLe(e,"string");return Qg(t)=="symbol"?t:t+""}function CLe(e,t){if(Qg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tL=function(t,r,n,a,i){var o=Math.min(Math.abs(n)/2,Math.abs(a)/2),l=a>=0?1:-1,c=n>=0?1:-1,u=a>=0&&n>=0||a<0&&n<0?1:0,d;if(o>0&&i instanceof Array){for(var h=[0,0,0,0],f=0,p=4;f<p;f++)h[f]=i[f]>o?o:i[f];d="M".concat(t,",").concat(r+l*h[0]),h[0]>0&&(d+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(u,",").concat(t+c*h[0],",").concat(r)),d+="L ".concat(t+n-c*h[1],",").concat(r),h[1]>0&&(d+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(u,`,
        `).concat(t+n,",").concat(r+l*h[1])),d+="L ".concat(t+n,",").concat(r+a-l*h[2]),h[2]>0&&(d+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(u,`,
        `).concat(t+n-c*h[2],",").concat(r+a)),d+="L ".concat(t+c*h[3],",").concat(r+a),h[3]>0&&(d+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(u,`,
        `).concat(t,",").concat(r+a-l*h[3])),d+="Z"}else if(o>0&&i===+i&&i>0){var m=Math.min(o,i);d="M ".concat(t,",").concat(r+l*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(t+c*m,",").concat(r,`
            L `).concat(t+n-c*m,",").concat(r,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(t+n,",").concat(r+l*m,`
            L `).concat(t+n,",").concat(r+a-l*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(t+n-c*m,",").concat(r+a,`
            L `).concat(t+c*m,",").concat(r+a,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(t,",").concat(r+a-l*m," Z")}else d="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return d},ELe=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,o=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var u=Math.min(i,i+l),d=Math.max(i,i+l),h=Math.min(o,o+c),f=Math.max(o,o+c);return n>=u&&n<=d&&a>=h&&a<=f}return!1},kLe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},dI=function(t){var r=eL(eL({},kLe),t),n=w.useRef(),a=w.useState(-1),i=yLe(a,2),o=i[0],l=i[1];w.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var N=n.current.getTotalLength();N&&l(N)}catch{}},[]);var c=r.x,u=r.y,d=r.width,h=r.height,f=r.radius,p=r.className,m=r.animationEasing,v=r.animationDuration,g=r.animationBegin,x=r.isAnimationActive,y=r.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||h!==+h||d===0||h===0)return null;var b=Ut("recharts-rectangle",p);return y?F.createElement($o,{canBegin:o>0,from:{width:d,height:h,x:c,y:u},to:{width:d,height:h,x:c,y:u},duration:v,animationEasing:m,isActive:y},function(N){var j=N.width,_=N.height,S=N.x,C=N.y;return F.createElement($o,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:v,isActive:x,easing:m},F.createElement("path",t1({},Ct(r,!0),{className:b,d:tL(S,C,j,_,f),ref:n})))}):F.createElement("path",t1({},Ct(r,!0),{className:b,d:tL(c,u,d,h,f)}))};function qk(){return qk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qk.apply(this,arguments)}var BN=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,o=Ut("recharts-dot",i);return r===+r&&n===+n&&a===+a?w.createElement("circle",qk({},Ct(t,!1),yw(t),{className:o,cx:r,cy:n,r:a})):null};function Zg(e){"@babel/helpers - typeof";return Zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zg(e)}var ALe=["x","y","top","left","width","height","className"];function Gk(){return Gk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gk.apply(this,arguments)}function rL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function PLe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rL(Object(r),!0).forEach(function(n){TLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TLe(e,t,r){return t=RLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RLe(e){var t=OLe(e,"string");return Zg(t)=="symbol"?t:t+""}function OLe(e,t){if(Zg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ILe(e,t){if(e==null)return{};var r=DLe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function DLe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var MLe=function(t,r,n,a,i,o){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(o,",").concat(r,"h").concat(n)},$Le=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.top,l=o===void 0?0:o,c=t.left,u=c===void 0?0:c,d=t.width,h=d===void 0?0:d,f=t.height,p=f===void 0?0:f,m=t.className,v=ILe(t,ALe),g=PLe({x:n,y:i,top:l,left:u,width:h,height:p},v);return!Te(n)||!Te(i)||!Te(h)||!Te(p)||!Te(l)||!Te(u)?null:F.createElement("path",Gk({},Ct(g,!0),{className:Ut("recharts-cross",m),d:MLe(n,i,h,p,l,u)}))},FLe=pK,LLe=FLe(Object.getPrototypeOf,Object),BLe=LLe,ULe=Vl,VLe=BLe,zLe=zl,WLe="[object Object]",qLe=Function.prototype,GLe=Object.prototype,tX=qLe.toString,HLe=GLe.hasOwnProperty,KLe=tX.call(Object);function YLe(e){if(!zLe(e)||ULe(e)!=WLe)return!1;var t=VLe(e);if(t===null)return!0;var r=HLe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&tX.call(r)==KLe}var XLe=YLe;const QLe=lr(XLe);var ZLe=Vl,JLe=zl,eBe="[object Boolean]";function tBe(e){return e===!0||e===!1||JLe(e)&&ZLe(e)==eBe}var rBe=tBe;const nBe=lr(rBe);function Jg(e){"@babel/helpers - typeof";return Jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jg(e)}function r1(){return r1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r1.apply(this,arguments)}function aBe(e,t){return lBe(e)||oBe(e,t)||iBe(e,t)||sBe()}function sBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iBe(e,t){if(e){if(typeof e=="string")return nL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nL(e,t)}}function nL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oBe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function lBe(e){if(Array.isArray(e))return e}function aL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aL(Object(r),!0).forEach(function(n){cBe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cBe(e,t,r){return t=uBe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uBe(e){var t=dBe(e,"string");return Jg(t)=="symbol"?t:t+""}function dBe(e,t){if(Jg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iL=function(t,r,n,a,i){var o=n-a,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+n,",").concat(r),l+="L ".concat(t+n-o/2,",").concat(r+i),l+="L ".concat(t+n-o/2-a,",").concat(r+i),l+="L ".concat(t,",").concat(r," Z"),l},hBe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},fBe=function(t){var r=sL(sL({},hBe),t),n=w.useRef(),a=w.useState(-1),i=aBe(a,2),o=i[0],l=i[1];w.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var b=n.current.getTotalLength();b&&l(b)}catch{}},[]);var c=r.x,u=r.y,d=r.upperWidth,h=r.lowerWidth,f=r.height,p=r.className,m=r.animationEasing,v=r.animationDuration,g=r.animationBegin,x=r.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||h!==+h||f!==+f||d===0&&h===0||f===0)return null;var y=Ut("recharts-trapezoid",p);return x?F.createElement($o,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:f,x:c,y:u},to:{upperWidth:d,lowerWidth:h,height:f,x:c,y:u},duration:v,animationEasing:m,isActive:x},function(b){var N=b.upperWidth,j=b.lowerWidth,_=b.height,S=b.x,C=b.y;return F.createElement($o,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:v,easing:m},F.createElement("path",r1({},Ct(r,!0),{className:y,d:iL(S,C,N,j,_),ref:n})))}):F.createElement("g",null,F.createElement("path",r1({},Ct(r,!0),{className:y,d:iL(c,u,d,h,f)})))},pBe=["option","shapeType","propTransformer","activeClassName","isActive"];function ex(e){"@babel/helpers - typeof";return ex=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ex(e)}function mBe(e,t){if(e==null)return{};var r=vBe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function vBe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function oL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function n1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oL(Object(r),!0).forEach(function(n){gBe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gBe(e,t,r){return t=xBe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xBe(e){var t=yBe(e,"string");return ex(t)=="symbol"?t:t+""}function yBe(e,t){if(ex(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ex(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bBe(e,t){return n1(n1({},t),e)}function wBe(e,t){return e==="symbols"}function lL(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return F.createElement(dI,r);case"trapezoid":return F.createElement(fBe,r);case"sector":return F.createElement(WY,r);case"symbols":if(wBe(t))return F.createElement(PO,r);break;default:return null}}function jBe(e){return w.isValidElement(e)?e.props:e}function NBe(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?bBe:n,i=e.activeClassName,o=i===void 0?"recharts-active-shape":i,l=e.isActive,c=mBe(e,pBe),u;if(w.isValidElement(t))u=w.cloneElement(t,n1(n1({},c),jBe(t)));else if(bt(t))u=t(c);else if(QLe(t)&&!nBe(t)){var d=a(t,c);u=F.createElement(lL,{shapeType:r,elementProps:d})}else{var h=c;u=F.createElement(lL,{shapeType:r,elementProps:h})}return l?F.createElement(yr,{className:o},u):u}function UN(e,t){return t!=null&&"trapezoids"in e.props}function VN(e,t){return t!=null&&"sectors"in e.props}function tx(e,t){return t!=null&&"points"in e.props}function _Be(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&i}function SBe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function CBe(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function EBe(e,t){var r;return UN(e,t)?r=_Be:VN(e,t)?r=SBe:tx(e,t)&&(r=CBe),r}function kBe(e,t){var r;return UN(e,t)?r="trapezoids":VN(e,t)?r="sectors":tx(e,t)&&(r="points"),r}function ABe(e,t){if(UN(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(VN(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return tx(e,t)?t.payload:{}}function PBe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=kBe(r,t),i=ABe(r,t),o=n.filter(function(c,u){var d=dp(i,c),h=r.props[a].filter(function(m){var v=EBe(r,t);return v(m,t)}),f=r.props[a].indexOf(h[h.length-1]),p=u===f;return d&&p}),l=n.indexOf(o[o.length-1]);return l}var TBe=Math.ceil,RBe=Math.max;function OBe(e,t,r,n){for(var a=-1,i=RBe(TBe((t-e)/(r||1)),0),o=Array(i);i--;)o[n?i:++a]=e,e+=r;return o}var IBe=OBe,DBe=OK,cL=1/0,MBe=17976931348623157e292;function $Be(e){if(!e)return e===0?e:0;if(e=DBe(e),e===cL||e===-cL){var t=e<0?-1:1;return t*MBe}return e===e?e:0}var rX=$Be,FBe=IBe,LBe=PN,fS=rX;function BBe(e){return function(t,r,n){return n&&typeof n!="number"&&LBe(t,r,n)&&(r=n=void 0),t=fS(t),r===void 0?(r=t,t=0):r=fS(r),n=n===void 0?t<r?1:-1:fS(n),FBe(t,r,n,e)}}var UBe=BBe,VBe=UBe,zBe=VBe(),WBe=zBe;const a1=lr(WBe);function rx(e){"@babel/helpers - typeof";return rx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rx(e)}function uL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uL(Object(r),!0).forEach(function(n){nX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nX(e,t,r){return t=qBe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qBe(e){var t=GBe(e,"string");return rx(t)=="symbol"?t:t+""}function GBe(e,t){if(rx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HBe=["Webkit","Moz","O","ms"],KBe=function(t,r){var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=HBe.reduce(function(i,o){return dL(dL({},i),{},nX({},o+n,r))},{});return a[t]=r,a};function pp(e){"@babel/helpers - typeof";return pp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pp(e)}function s1(){return s1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s1.apply(this,arguments)}function hL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hL(Object(r),!0).forEach(function(n){vs(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sX(n.key),n)}}function XBe(e,t,r){return t&&fL(e.prototype,t),r&&fL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QBe(e,t,r){return t=i1(t),ZBe(e,aX()?Reflect.construct(t,r||[],i1(e).constructor):t.apply(e,r))}function ZBe(e,t){if(t&&(pp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JBe(e)}function JBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aX=function(){return!!e})()}function i1(e){return i1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},i1(e)}function e6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hk(e,t)}function Hk(e,t){return Hk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Hk(e,t)}function vs(e,t,r){return t=sX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sX(e){var t=t6e(e,"string");return pp(t)=="symbol"?t:t+""}function t6e(e,t){if(pp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var r6e=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,o=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,u=Ov().domain(a1(0,c)).range([i,i+o-l]),d=u.domain().map(function(h){return u(h)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(n),endX:u(a),scale:u,scaleValues:d}},pL=function(t){return t.changedTouches&&!!t.changedTouches.length},mp=function(e){function t(r){var n;return YBe(this,t),n=QBe(this,t,[r]),vs(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),vs(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),vs(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,o=a.onDragEnd,l=a.startIndex;o==null||o({endIndex:i,startIndex:l})}),n.detachDragEndListener()}),vs(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),vs(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),vs(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),vs(n,"handleSlideDragStart",function(a){var i=pL(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return e6e(t,e),XBe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,o=this.state.scaleValues,l=this.props,c=l.gap,u=l.data,d=u.length-1,h=Math.min(a,i),f=Math.max(a,i),p=t.getIndexInRange(o,h),m=t.getIndexInRange(o,f);return{startIndex:p-p%c,endIndex:m===d?d:m-m%c}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,o=a.tickFormatter,l=a.dataKey,c=Ua(i[n],l,n);return bt(o)?o(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,o=a.startX,l=a.endX,c=this.props,u=c.x,d=c.width,h=c.travellerWidth,f=c.startIndex,p=c.endIndex,m=c.onChange,v=n.pageX-i;v>0?v=Math.min(v,u+d-h-l,u+d-h-o):v<0&&(v=Math.max(v,u-o,u-l));var g=this.getIndex({startX:o+v,endX:l+v});(g.startIndex!==f||g.endIndex!==p)&&m&&m(g),this.setState({startX:o+v,endX:l+v,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=pL(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,o=a.movingTravellerId,l=a.endX,c=a.startX,u=this.state[o],d=this.props,h=d.x,f=d.width,p=d.travellerWidth,m=d.onChange,v=d.gap,g=d.data,x={startX:this.state.startX,endX:this.state.endX},y=n.pageX-i;y>0?y=Math.min(y,h+f-p-u):y<0&&(y=Math.max(y,h-u)),x[o]=u+y;var b=this.getIndex(x),N=b.startIndex,j=b.endIndex,_=function(){var C=g.length-1;return o==="startX"&&(l>c?N%v===0:j%v===0)||l<c&&j===C||o==="endX"&&(l>c?j%v===0:N%v===0)||l>c&&j===C};this.setState(vs(vs({},o,u+y),"brushMoveStartX",n.pageX),function(){m&&_()&&m(b)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,o=this.state,l=o.scaleValues,c=o.startX,u=o.endX,d=this.state[a],h=l.indexOf(d);if(h!==-1){var f=h+n;if(!(f===-1||f>=l.length)){var p=l[f];a==="startX"&&p>=u||a==="endX"&&p<=c||this.setState(vs({},a,p),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,l=n.height,c=n.fill,u=n.stroke;return F.createElement("rect",{stroke:u,fill:c,x:a,y:i,width:o,height:l})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,l=n.height,c=n.data,u=n.children,d=n.padding,h=w.Children.only(u);return h?F.cloneElement(h,{x:a,y:i,width:o,height:l,margin:d,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,o,l=this,c=this.props,u=c.y,d=c.travellerWidth,h=c.height,f=c.traveller,p=c.ariaLabel,m=c.data,v=c.startIndex,g=c.endIndex,x=Math.max(n,this.props.x),y=pS(pS({},Ct(this.props,!1)),{},{x,y:u,width:d,height:h}),b=p||"Min value: ".concat((i=m[v])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=m[g])===null||o===void 0?void 0:o.name);return F.createElement(yr,{tabIndex:0,role:"slider","aria-label":b,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(j){["ArrowLeft","ArrowRight"].includes(j.key)&&(j.preventDefault(),j.stopPropagation(),l.handleTravellerMoveKeyboard(j.key==="ArrowRight"?1:-1,a))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(f,y))}},{key:"renderSlide",value:function(n,a){var i=this.props,o=i.y,l=i.height,c=i.stroke,u=i.travellerWidth,d=Math.min(n,a)+u,h=Math.max(Math.abs(a-n)-u,0);return F.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:d,y:o,width:h,height:l})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,o=n.y,l=n.height,c=n.travellerWidth,u=n.stroke,d=this.state,h=d.startX,f=d.endX,p=5,m={pointerEvents:"none",fill:u};return F.createElement(yr,{className:"recharts-brush-texts"},F.createElement(Iw,s1({textAnchor:"end",verticalAnchor:"middle",x:Math.min(h,f)-p,y:o+l/2},m),this.getTextOfTick(a)),F.createElement(Iw,s1({textAnchor:"start",verticalAnchor:"middle",x:Math.max(h,f)+c+p,y:o+l/2},m),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,o=n.children,l=n.x,c=n.y,u=n.width,d=n.height,h=n.alwaysShowText,f=this.state,p=f.startX,m=f.endX,v=f.isTextActive,g=f.isSlideMoving,x=f.isTravellerMoving,y=f.isTravellerFocused;if(!a||!a.length||!Te(l)||!Te(c)||!Te(u)||!Te(d)||u<=0||d<=0)return null;var b=Ut("recharts-brush",i),N=F.Children.count(o)===1,j=KBe("userSelect","none");return F.createElement(yr,{className:b,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:j},this.renderBackground(),N&&this.renderPanorama(),this.renderSlide(p,m),this.renderTravellerLayer(p,"startX"),this.renderTravellerLayer(m,"endX"),(v||g||x||y||h)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,o=n.width,l=n.height,c=n.stroke,u=Math.floor(i+l/2)-1;return F.createElement(F.Fragment,null,F.createElement("rect",{x:a,y:i,width:o,height:l,fill:c,stroke:"none"}),F.createElement("line",{x1:a+1,y1:u,x2:a+o-1,y2:u,fill:"none",stroke:"#fff"}),F.createElement("line",{x1:a+1,y1:u+2,x2:a+o-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return F.isValidElement(n)?i=F.cloneElement(n,a):bt(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,o=n.width,l=n.x,c=n.travellerWidth,u=n.updateId,d=n.startIndex,h=n.endIndex;if(i!==a.prevData||u!==a.prevUpdateId)return pS({prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:o},i&&i.length?r6e({data:i,width:o,x:l,travellerWidth:c,startIndex:d,endIndex:h}):{scale:null,scaleValues:null});if(a.scale&&(o!==a.prevWidth||l!==a.prevX||c!==a.prevTravellerWidth)){a.scale.range([l,l+o-c]);var f=a.scale.domain().map(function(p){return a.scale(p)});return{prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:o,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:f}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,o=0,l=i-1;l-o>1;){var c=Math.floor((o+l)/2);n[c]>a?l=c:o=c}return a>=n[l]?l:o}}])}(w.PureComponent);vs(mp,"displayName","Brush");vs(mp,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var n6e=$O;function a6e(e,t){var r;return n6e(e,function(n,a,i){return r=t(n,a,i),!r}),!!r}var s6e=a6e,i6e=iK,o6e=vu,l6e=s6e,c6e=ds,u6e=PN;function d6e(e,t,r){var n=c6e(e)?i6e:l6e;return r&&u6e(e,t,r)&&(t=void 0),n(e,o6e(t))}var h6e=d6e;const f6e=lr(h6e);var Ro=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},mL=kK;function p6e(e,t,r){t=="__proto__"&&mL?mL(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var m6e=p6e,v6e=m6e,g6e=CK,x6e=vu;function y6e(e,t){var r={};return t=x6e(t),g6e(e,function(n,a,i){v6e(r,a,t(n,a,i))}),r}var b6e=y6e;const w6e=lr(b6e);function j6e(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var N6e=j6e,_6e=$O;function S6e(e,t){var r=!0;return _6e(e,function(n,a,i){return r=!!t(n,a,i),r}),r}var C6e=S6e,E6e=N6e,k6e=C6e,A6e=vu,P6e=ds,T6e=PN;function R6e(e,t,r){var n=P6e(e)?E6e:k6e;return r&&T6e(e,t,r)&&(t=void 0),n(e,A6e(t))}var O6e=R6e;const iX=lr(O6e);var I6e=["x","y"];function nx(e){"@babel/helpers - typeof";return nx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nx(e)}function Kk(){return Kk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kk.apply(this,arguments)}function vL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Xm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vL(Object(r),!0).forEach(function(n){D6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function D6e(e,t,r){return t=M6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M6e(e){var t=$6e(e,"string");return nx(t)=="symbol"?t:t+""}function $6e(e,t){if(nx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function F6e(e,t){if(e==null)return{};var r=L6e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function L6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function B6e(e,t){var r=e.x,n=e.y,a=F6e(e,I6e),i="".concat(r),o=parseInt(i,10),l="".concat(n),c=parseInt(l,10),u="".concat(t.height||a.height),d=parseInt(u,10),h="".concat(t.width||a.width),f=parseInt(h,10);return Xm(Xm(Xm(Xm(Xm({},t),a),o?{x:o}:{}),c?{y:c}:{}),{},{height:d,width:f,name:t.name,radius:t.radius})}function gL(e){return F.createElement(NBe,Kk({shapeType:"rectangle",propTransformer:B6e,activeClassName:"recharts-active-bar"},e))}var U6e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var i=Te(n)||a2e(n);return i?t(n,a):(i||Ld(),r)}},V6e=["value","background"],oX;function vp(e){"@babel/helpers - typeof";return vp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vp(e)}function z6e(e,t){if(e==null)return{};var r=W6e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function W6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function o1(){return o1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o1.apply(this,arguments)}function xL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ln(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xL(Object(r),!0).forEach(function(n){Ec(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function q6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cX(n.key),n)}}function G6e(e,t,r){return t&&yL(e.prototype,t),r&&yL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function H6e(e,t,r){return t=l1(t),K6e(e,lX()?Reflect.construct(t,r||[],l1(e).constructor):t.apply(e,r))}function K6e(e,t){if(t&&(vp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y6e(e)}function Y6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lX=function(){return!!e})()}function l1(e){return l1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},l1(e)}function X6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yk(e,t)}function Yk(e,t){return Yk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Yk(e,t)}function Ec(e,t,r){return t=cX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cX(e){var t=Q6e(e,"string");return vp(t)=="symbol"?t:t+""}function Q6e(e,t){if(vp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xl=function(e){function t(){var r;q6e(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=H6e(this,t,[].concat(a)),Ec(r,"state",{isAnimationFinished:!1}),Ec(r,"id",um("recharts-bar-")),Ec(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),Ec(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return X6e(t,e),G6e(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,o=i.shape,l=i.dataKey,c=i.activeIndex,u=i.activeBar,d=Ct(this.props,!1);return n&&n.map(function(h,f){var p=f===c,m=p?u:o,v=ln(ln(ln({},d),h),{},{isActive:p,option:m,index:f,dataKey:l,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return F.createElement(yr,o1({className:"recharts-bar-rectangle"},bw(a.props,h,f),{key:"rectangle-".concat(h==null?void 0:h.x,"-").concat(h==null?void 0:h.y,"-").concat(h==null?void 0:h.value,"-").concat(f)}),F.createElement(gL,v))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,o=a.layout,l=a.isAnimationActive,c=a.animationBegin,u=a.animationDuration,d=a.animationEasing,h=a.animationId,f=this.state.prevData;return F.createElement($o,{begin:c,duration:u,isActive:l,easing:d,from:{t:0},to:{t:1},key:"bar-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var m=p.t,v=i.map(function(g,x){var y=f&&f[x];if(y){var b=na(y.x,g.x),N=na(y.y,g.y),j=na(y.width,g.width),_=na(y.height,g.height);return ln(ln({},g),{},{x:b(m),y:N(m),width:j(m),height:_(m)})}if(o==="horizontal"){var S=na(0,g.height),C=S(m);return ln(ln({},g),{},{y:g.y+g.height-C,height:C})}var E=na(0,g.width),k=E(m);return ln(ln({},g),{},{width:k})});return F.createElement(yr,null,n.renderRectanglesStatically(v))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,o=this.state.prevData;return i&&a&&a.length&&(!o||!dp(o,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,o=a.dataKey,l=a.activeIndex,c=Ct(this.props.background,!1);return i.map(function(u,d){u.value;var h=u.background,f=z6e(u,V6e);if(!h)return null;var p=ln(ln(ln(ln(ln({},f),{},{fill:"#eee"},h),c),bw(n.props,u,d)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:d,className:"recharts-bar-background-rectangle"});return F.createElement(gL,o1({key:"background-bar-".concat(d),option:n.props.background,isActive:d===l},p))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,l=i.xAxis,c=i.yAxis,u=i.layout,d=i.children,h=oi(d,ey);if(!h)return null;var f=u==="vertical"?o[0].height/2:o[0].width/2,p=function(g,x){var y=Array.isArray(g.value)?g.value[1]:g.value;return{x:g.x,y:g.y,value:y,errorVal:Ua(g,x)}},m={clipPath:n?"url(#clipPath-".concat(a,")"):null};return F.createElement(yr,m,h.map(function(v){return F.cloneElement(v,{key:"error-bar-".concat(a,"-").concat(v.props.dataKey),data:o,xAxis:l,yAxis:c,layout:u,offset:f,dataPointFormatter:p})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,o=n.className,l=n.xAxis,c=n.yAxis,u=n.left,d=n.top,h=n.width,f=n.height,p=n.isAnimationActive,m=n.background,v=n.id;if(a||!i||!i.length)return null;var g=this.state.isAnimationFinished,x=Ut("recharts-bar",o),y=l&&l.allowDataOverflow,b=c&&c.allowDataOverflow,N=y||b,j=Ot(v)?this.id:v;return F.createElement(yr,{className:x},y||b?F.createElement("defs",null,F.createElement("clipPath",{id:"clipPath-".concat(j)},F.createElement("rect",{x:y?u:u-h/2,y:b?d:d-f/2,width:y?h:h*2,height:b?f:f*2}))):null,F.createElement(yr,{className:"recharts-bar-rectangles",clipPath:N?"url(#clipPath-".concat(j,")"):null},m?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(N,j),(!p||g)&&gl.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(w.PureComponent);oX=xl;Ec(xl,"displayName","Bar");Ec(xl,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Po.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Ec(xl,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,i=e.xAxis,o=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,u=e.stackedData,d=e.dataStartIndex,h=e.displayedData,f=e.offset,p=E$e(n,r);if(!p)return null;var m=t.layout,v=r.type.defaultProps,g=v!==void 0?ln(ln({},v),r.props):r.props,x=g.dataKey,y=g.children,b=g.minPointSize,N=m==="horizontal"?o:i,j=u?N.scale.domain():null,_=D$e({numericAxis:N}),S=oi(y,DK),C=h.map(function(E,k){var P,A,O,I,R,M;u?P=k$e(u[d+k],j):(P=Ua(E,x),Array.isArray(P)||(P=[_,P]));var B=U6e(b,oX.defaultProps.minPointSize)(P[1],k);if(m==="horizontal"){var $,D=[o.scale(P[0]),o.scale(P[1])],W=D[0],Z=D[1];A=x5({axis:i,ticks:l,bandSize:a,offset:p.offset,entry:E,index:k}),O=($=Z??W)!==null&&$!==void 0?$:void 0,I=p.size;var U=W-Z;if(R=Number.isNaN(U)?0:U,M={x:A,y:o.y,width:I,height:o.height},Math.abs(B)>0&&Math.abs(R)<Math.abs(B)){var Y=$i(R||B)*(Math.abs(B)-Math.abs(R));O-=Y,R+=Y}}else{var ae=[i.scale(P[0]),i.scale(P[1])],ie=ae[0],he=ae[1];if(A=ie,O=x5({axis:o,ticks:c,bandSize:a,offset:p.offset,entry:E,index:k}),I=he-ie,R=p.size,M={x:i.x,y:O,width:i.width,height:R},Math.abs(B)>0&&Math.abs(I)<Math.abs(B)){var se=$i(I||B)*(Math.abs(B)-Math.abs(I));I+=se}}return ln(ln(ln({},E),{},{x:A,y:O,width:I,height:R,value:u?P:P[1],payload:E,background:M},S&&S[k]&&S[k].props),{},{tooltipPayload:[UY(r,E)],tooltipPosition:{x:A+I/2,y:O+R/2}})});return ln({data:C,layout:m},f)});function ax(e){"@babel/helpers - typeof";return ax=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ax(e)}function Z6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uX(n.key),n)}}function J6e(e,t,r){return t&&bL(e.prototype,t),r&&bL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ki(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wL(Object(r),!0).forEach(function(n){zN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zN(e,t,r){return t=uX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uX(e){var t=eUe(e,"string");return ax(t)=="symbol"?t:t+""}function eUe(e,t){if(ax(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ax(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hI=function(t,r,n,a,i){var o=t.width,l=t.height,c=t.layout,u=t.children,d=Object.keys(r),h={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:l-n.bottom,bottomMirror:l-n.bottom},f=!!ys(u,xl);return d.reduce(function(p,m){var v=r[m],g=v.orientation,x=v.domain,y=v.padding,b=y===void 0?{}:y,N=v.mirror,j=v.reversed,_="".concat(g).concat(N?"Mirror":""),S,C,E,k,P;if(v.type==="number"&&(v.padding==="gap"||v.padding==="no-gap")){var A=x[1]-x[0],O=1/0,I=v.categoricalDomain.sort(o2e);if(I.forEach(function(ae,ie){ie>0&&(O=Math.min((ae||0)-(I[ie-1]||0),O))}),Number.isFinite(O)){var R=O/A,M=v.layout==="vertical"?n.height:n.width;if(v.padding==="gap"&&(S=R*M/2),v.padding==="no-gap"){var B=$d(t.barCategoryGap,R*M),$=R*M/2;S=$-B-($-B)/M*B}}}a==="xAxis"?C=[n.left+(b.left||0)+(S||0),n.left+n.width-(b.right||0)-(S||0)]:a==="yAxis"?C=c==="horizontal"?[n.top+n.height-(b.bottom||0),n.top+(b.top||0)]:[n.top+(b.top||0)+(S||0),n.top+n.height-(b.bottom||0)-(S||0)]:C=v.range,j&&(C=[C[1],C[0]]);var D=S$e(v,i,f),W=D.scale,Z=D.realScaleType;W.domain(x).range(C),C$e(W);var U=I$e(W,ki(ki({},v),{},{realScaleType:Z}));a==="xAxis"?(P=g==="top"&&!N||g==="bottom"&&N,E=n.left,k=h[_]-P*v.height):a==="yAxis"&&(P=g==="left"&&!N||g==="right"&&N,E=h[_]-P*v.width,k=n.top);var Y=ki(ki(ki({},v),U),{},{realScaleType:Z,x:E,y:k,scale:W,width:a==="xAxis"?n.width:v.width,height:a==="yAxis"?n.height:v.height});return Y.bandSize=Yw(Y,U),!v.hide&&a==="xAxis"?h[_]+=(P?-1:1)*Y.height:v.hide||(h[_]+=(P?-1:1)*Y.width),ki(ki({},p),{},zN({},m,Y))},{})},dX=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return{x:Math.min(n,i),y:Math.min(a,o),width:Math.abs(i-n),height:Math.abs(o-a)}},tUe=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return dX({x:r,y:n},{x:a,y:i})},hX=function(){function e(t){Z6e(this,e),this.scale=t}return J6e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(a){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();zN(hX,"EPS",1e-4);var fI=function(t){var r=Object.keys(t).reduce(function(n,a){return ki(ki({},n),{},zN({},a,hX.create(t[a])))},{});return ki(ki({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,l=i.position;return w6e(a,function(c,u){return r[u].apply(c,{bandAware:o,position:l})})},isInRange:function(a){return iX(a,function(i,o){return r[o].isInRange(i)})}})};function rUe(e){return(e%180+180)%180}var nUe=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=rUe(a),o=i*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},aUe=vu,sUe=Yx,iUe=kN;function oUe(e){return function(t,r,n){var a=Object(t);if(!sUe(t)){var i=aUe(r);t=iUe(t),r=function(l){return i(a[l],l,a)}}var o=e(t,r,n);return o>-1?a[i?t[o]:o]:void 0}}var lUe=oUe,cUe=rX;function uUe(e){var t=cUe(e),r=t%1;return t===t?r?t-r:t:0}var dUe=uUe,hUe=bK,fUe=vu,pUe=dUe,mUe=Math.max;function vUe(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:pUe(r);return a<0&&(a=mUe(n+a,0)),hUe(e,fUe(t),a)}var gUe=vUe,xUe=lUe,yUe=gUe,bUe=xUe(yUe),wUe=bUe;const jUe=lr(wUe);var NUe=l_e(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),pI=w.createContext(void 0),mI=w.createContext(void 0),fX=w.createContext(void 0),pX=w.createContext({}),mX=w.createContext(void 0),vX=w.createContext(0),gX=w.createContext(0),jL=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,o=t.clipPathId,l=t.children,c=t.width,u=t.height,d=NUe(i);return F.createElement(pI.Provider,{value:n},F.createElement(mI.Provider,{value:a},F.createElement(pX.Provider,{value:i},F.createElement(fX.Provider,{value:d},F.createElement(mX.Provider,{value:o},F.createElement(vX.Provider,{value:u},F.createElement(gX.Provider,{value:c},l)))))))},_Ue=function(){return w.useContext(mX)},xX=function(t){var r=w.useContext(pI);r==null&&Ld();var n=r[t];return n==null&&Ld(),n},SUe=function(){var t=w.useContext(pI);return uc(t)},CUe=function(){var t=w.useContext(mI),r=jUe(t,function(n){return iX(n.domain,Number.isFinite)});return r||uc(t)},yX=function(t){var r=w.useContext(mI);r==null&&Ld();var n=r[t];return n==null&&Ld(),n},EUe=function(){var t=w.useContext(fX);return t},kUe=function(){return w.useContext(pX)},vI=function(){return w.useContext(gX)},gI=function(){return w.useContext(vX)};function gp(e){"@babel/helpers - typeof";return gp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gp(e)}function AUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PUe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wX(n.key),n)}}function TUe(e,t,r){return t&&PUe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function RUe(e,t,r){return t=c1(t),OUe(e,bX()?Reflect.construct(t,r||[],c1(e).constructor):t.apply(e,r))}function OUe(e,t){if(t&&(gp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IUe(e)}function IUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bX=function(){return!!e})()}function c1(e){return c1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},c1(e)}function DUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xk(e,t)}function Xk(e,t){return Xk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Xk(e,t)}function NL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _L(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NL(Object(r),!0).forEach(function(n){xI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xI(e,t,r){return t=wX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wX(e){var t=MUe(e,"string");return gp(t)=="symbol"?t:t+""}function MUe(e,t){if(gp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Ue(e,t){return UUe(e)||BUe(e,t)||LUe(e,t)||FUe()}function FUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LUe(e,t){if(e){if(typeof e=="string")return SL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SL(e,t)}}function SL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BUe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function UUe(e){if(Array.isArray(e))return e}function Qk(){return Qk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qk.apply(this,arguments)}var VUe=function(t,r){var n;return F.isValidElement(t)?n=F.cloneElement(t,r):bt(t)?n=t(r):n=F.createElement("line",Qk({},r,{className:"recharts-reference-line-line"})),n},zUe=function(t,r,n,a,i,o,l,c,u){var d=i.x,h=i.y,f=i.width,p=i.height;if(n){var m=u.y,v=t.y.apply(m,{position:o});if(Ro(u,"discard")&&!t.y.isInRange(v))return null;var g=[{x:d+f,y:v},{x:d,y:v}];return c==="left"?g.reverse():g}if(r){var x=u.x,y=t.x.apply(x,{position:o});if(Ro(u,"discard")&&!t.x.isInRange(y))return null;var b=[{x:y,y:h+p},{x:y,y:h}];return l==="top"?b.reverse():b}if(a){var N=u.segment,j=N.map(function(_){return t.apply(_,{position:o})});return Ro(u,"discard")&&f6e(j,function(_){return!t.isInRange(_)})?null:j}return null};function WUe(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,o=e.shape,l=e.className,c=e.alwaysShow,u=_Ue(),d=xX(a),h=yX(i),f=EUe();if(!u||!f)return null;ml(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var p=fI({x:d.scale,y:h.scale}),m=kn(t),v=kn(r),g=n&&n.length===2,x=zUe(p,m,v,g,f,e.position,d.orientation,h.orientation,e);if(!x)return null;var y=$Ue(x,2),b=y[0],N=b.x,j=b.y,_=y[1],S=_.x,C=_.y,E=Ro(e,"hidden")?"url(#".concat(u,")"):void 0,k=_L(_L({clipPath:E},Ct(e,!0)),{},{x1:N,y1:j,x2:S,y2:C});return F.createElement(yr,{className:Ut("recharts-reference-line",l)},VUe(o,k),xa.renderCallByParent(e,tUe({x1:N,y1:j,x2:S,y2:C})))}var yI=function(e){function t(){return AUe(this,t),RUe(this,t,arguments)}return DUe(t,e),TUe(t,[{key:"render",value:function(){return F.createElement(WUe,this.props)}}])}(F.Component);xI(yI,"displayName","ReferenceLine");xI(yI,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function Zk(){return Zk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zk.apply(this,arguments)}function xp(e){"@babel/helpers - typeof";return xp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xp(e)}function CL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function EL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CL(Object(r),!0).forEach(function(n){WN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GUe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NX(n.key),n)}}function HUe(e,t,r){return t&&GUe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function KUe(e,t,r){return t=u1(t),YUe(e,jX()?Reflect.construct(t,r||[],u1(e).constructor):t.apply(e,r))}function YUe(e,t){if(t&&(xp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XUe(e)}function XUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jX=function(){return!!e})()}function u1(e){return u1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},u1(e)}function QUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jk(e,t)}function Jk(e,t){return Jk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Jk(e,t)}function WN(e,t,r){return t=NX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NX(e){var t=ZUe(e,"string");return xp(t)=="symbol"?t:t+""}function ZUe(e,t){if(xp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JUe=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,o=fI({x:a.scale,y:i.scale}),l=o.apply({x:r,y:n},{bandAware:!0});return Ro(t,"discard")&&!o.isInRange(l)?null:l},qN=function(e){function t(){return qUe(this,t),KUe(this,t,arguments)}return QUe(t,e),HUe(t,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,o=n.r,l=n.alwaysShow,c=n.clipPathId,u=kn(a),d=kn(i);if(ml(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!d)return null;var h=JUe(this.props);if(!h)return null;var f=h.x,p=h.y,m=this.props,v=m.shape,g=m.className,x=Ro(this.props,"hidden")?"url(#".concat(c,")"):void 0,y=EL(EL({clipPath:x},Ct(this.props,!0)),{},{cx:f,cy:p});return F.createElement(yr,{className:Ut("recharts-reference-dot",g)},t.renderDot(v,y),xa.renderCallByParent(this.props,{x:f-o,y:p-o,width:2*o,height:2*o}))}}])}(F.Component);WN(qN,"displayName","ReferenceDot");WN(qN,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});WN(qN,"renderDot",function(e,t){var r;return F.isValidElement(e)?r=F.cloneElement(e,t):bt(e)?r=e(t):r=F.createElement(BN,Zk({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function eA(){return eA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eA.apply(this,arguments)}function yp(e){"@babel/helpers - typeof";return yp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yp(e)}function kL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function AL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kL(Object(r),!0).forEach(function(n){GN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tVe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SX(n.key),n)}}function rVe(e,t,r){return t&&tVe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function nVe(e,t,r){return t=d1(t),aVe(e,_X()?Reflect.construct(t,r||[],d1(e).constructor):t.apply(e,r))}function aVe(e,t){if(t&&(yp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sVe(e)}function sVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _X(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_X=function(){return!!e})()}function d1(e){return d1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},d1(e)}function iVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tA(e,t)}function tA(e,t){return tA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},tA(e,t)}function GN(e,t,r){return t=SX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SX(e){var t=oVe(e,"string");return yp(t)=="symbol"?t:t+""}function oVe(e,t){if(yp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lVe=function(t,r,n,a,i){var o=i.x1,l=i.x2,c=i.y1,u=i.y2,d=i.xAxis,h=i.yAxis;if(!d||!h)return null;var f=fI({x:d.scale,y:h.scale}),p={x:t?f.x.apply(o,{position:"start"}):f.x.rangeMin,y:n?f.y.apply(c,{position:"start"}):f.y.rangeMin},m={x:r?f.x.apply(l,{position:"end"}):f.x.rangeMax,y:a?f.y.apply(u,{position:"end"}):f.y.rangeMax};return Ro(i,"discard")&&(!f.isInRange(p)||!f.isInRange(m))?null:dX(p,m)},HN=function(e){function t(){return eVe(this,t),nVe(this,t,arguments)}return iVe(t,e),rVe(t,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,o=n.y1,l=n.y2,c=n.className,u=n.alwaysShow,d=n.clipPathId;ml(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var h=kn(a),f=kn(i),p=kn(o),m=kn(l),v=this.props.shape;if(!h&&!f&&!p&&!m&&!v)return null;var g=lVe(h,f,p,m,this.props);if(!g&&!v)return null;var x=Ro(this.props,"hidden")?"url(#".concat(d,")"):void 0;return F.createElement(yr,{className:Ut("recharts-reference-area",c)},t.renderRect(v,AL(AL({clipPath:x},Ct(this.props,!0)),g)),xa.renderCallByParent(this.props,g))}}])}(F.Component);GN(HN,"displayName","ReferenceArea");GN(HN,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});GN(HN,"renderRect",function(e,t){var r;return F.isValidElement(e)?r=F.cloneElement(e,t):bt(e)?r=e(t):r=F.createElement(dI,eA({},t,{className:"recharts-reference-area-rect"})),r});function CX(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function cVe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return nUe(n,r)}function uVe(e,t,r){var n=r==="width",a=e.x,i=e.y,o=e.width,l=e.height;return t===1?{start:n?a:i,end:n?a+o:i+l}:{start:n?a+o:i+l,end:n?a:i}}function h1(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function dVe(e,t){return CX(e,t+1)}function hVe(e,t,r,n,a){for(var i=(n||[]).slice(),o=t.start,l=t.end,c=0,u=1,d=o,h=function(){var m=n==null?void 0:n[c];if(m===void 0)return{v:CX(n,u)};var v=c,g,x=function(){return g===void 0&&(g=r(m,v)),g},y=m.coordinate,b=c===0||h1(e,y,x,d,l);b||(c=0,d=o,u+=1),b&&(d=y+e*(x()/2+a),c+=u)},f;u<=i.length;)if(f=h(),f)return f.v;return[]}function sx(e){"@babel/helpers - typeof";return sx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sx(e)}function PL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PL(Object(r),!0).forEach(function(n){fVe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fVe(e,t,r){return t=pVe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pVe(e){var t=mVe(e,"string");return sx(t)=="symbol"?t:t+""}function mVe(e,t){if(sx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vVe(e,t,r,n,a){for(var i=(n||[]).slice(),o=i.length,l=t.start,c=t.end,u=function(f){var p=i[f],m,v=function(){return m===void 0&&(m=r(p,f)),m};if(f===o-1){var g=e*(p.coordinate+e*v()/2-c);i[f]=p=pa(pa({},p),{},{tickCoord:g>0?p.coordinate-g*e:p.coordinate})}else i[f]=p=pa(pa({},p),{},{tickCoord:p.coordinate});var x=h1(e,p.tickCoord,v,l,c);x&&(c=p.tickCoord-e*(v()/2+a),i[f]=pa(pa({},p),{},{isShow:!0}))},d=o-1;d>=0;d--)u(d);return i}function gVe(e,t,r,n,a,i){var o=(n||[]).slice(),l=o.length,c=t.start,u=t.end;if(i){var d=n[l-1],h=r(d,l-1),f=e*(d.coordinate+e*h/2-u);o[l-1]=d=pa(pa({},d),{},{tickCoord:f>0?d.coordinate-f*e:d.coordinate});var p=h1(e,d.tickCoord,function(){return h},c,u);p&&(u=d.tickCoord-e*(h/2+a),o[l-1]=pa(pa({},d),{},{isShow:!0}))}for(var m=i?l-1:l,v=function(y){var b=o[y],N,j=function(){return N===void 0&&(N=r(b,y)),N};if(y===0){var _=e*(b.coordinate-e*j()/2-c);o[y]=b=pa(pa({},b),{},{tickCoord:_<0?b.coordinate-_*e:b.coordinate})}else o[y]=b=pa(pa({},b),{},{tickCoord:b.coordinate});var S=h1(e,b.tickCoord,j,c,u);S&&(c=b.tickCoord+e*(j()/2+a),o[y]=pa(pa({},b),{},{isShow:!0}))},g=0;g<m;g++)v(g);return o}function bI(e,t,r){var n=e.tick,a=e.ticks,i=e.viewBox,o=e.minTickGap,l=e.orientation,c=e.interval,u=e.tickFormatter,d=e.unit,h=e.angle;if(!a||!a.length||!n)return[];if(Te(c)||Po.isSsr)return dVe(a,typeof c=="number"&&Te(c)?c:0);var f=[],p=l==="top"||l==="bottom"?"width":"height",m=d&&p==="width"?Rv(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},v=function(b,N){var j=bt(u)?u(b.value,N):b.value;return p==="width"?cVe(Rv(j,{fontSize:t,letterSpacing:r}),m,h):Rv(j,{fontSize:t,letterSpacing:r})[p]},g=a.length>=2?$i(a[1].coordinate-a[0].coordinate):1,x=uVe(i,g,p);return c==="equidistantPreserveStart"?hVe(g,x,v,a,o):(c==="preserveStart"||c==="preserveStartEnd"?f=gVe(g,x,v,a,o,c==="preserveStartEnd"):f=vVe(g,x,v,a,o),f.filter(function(y){return y.isShow}))}var xVe=["viewBox"],yVe=["viewBox"],bVe=["ticks"];function bp(e){"@babel/helpers - typeof";return bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bp(e)}function rf(){return rf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rf.apply(this,arguments)}function TL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TL(Object(r),!0).forEach(function(n){wI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mS(e,t){if(e==null)return{};var r=wVe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function wVe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function jVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kX(n.key),n)}}function NVe(e,t,r){return t&&RL(e.prototype,t),r&&RL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ve(e,t,r){return t=f1(t),SVe(e,EX()?Reflect.construct(t,r||[],f1(e).constructor):t.apply(e,r))}function SVe(e,t){if(t&&(bp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CVe(e)}function CVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(EX=function(){return!!e})()}function f1(e){return f1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},f1(e)}function EVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rA(e,t)}function rA(e,t){return rA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},rA(e,t)}function wI(e,t,r){return t=kX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kX(e){var t=kVe(e,"string");return bp(t)=="symbol"?t:t+""}function kVe(e,t){if(bp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gm=function(e){function t(r){var n;return jVe(this,t),n=_Ve(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return EVe(t,e),NVe(t,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,o=mS(n,xVe),l=this.props,c=l.viewBox,u=mS(l,yVe);return!Sf(i,c)||!Sf(o,u)||!Sf(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,o=a.y,l=a.width,c=a.height,u=a.orientation,d=a.tickSize,h=a.mirror,f=a.tickMargin,p,m,v,g,x,y,b=h?-1:1,N=n.tickSize||d,j=Te(n.tickCoord)?n.tickCoord:n.coordinate;switch(u){case"top":p=m=n.coordinate,g=o+ +!h*c,v=g-b*N,y=v-b*f,x=j;break;case"left":v=g=n.coordinate,m=i+ +!h*l,p=m-b*N,x=p-b*f,y=j;break;case"right":v=g=n.coordinate,m=i+ +h*l,p=m+b*N,x=p+b*f,y=j;break;default:p=m=n.coordinate,g=o+ +h*c,v=g+b*N,y=v+b*f,x=j;break}return{line:{x1:p,y1:v,x2:m,y2:g},tick:{x,y}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o;switch(a){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o="end";switch(a){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,l=n.height,c=n.orientation,u=n.mirror,d=n.axisLine,h=xn(xn(xn({},Ct(this.props,!1)),Ct(d,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var f=+(c==="top"&&!u||c==="bottom"&&u);h=xn(xn({},h),{},{x1:a,y1:i+f*l,x2:a+o,y2:i+f*l})}else{var p=+(c==="left"&&!u||c==="right"&&u);h=xn(xn({},h),{},{x1:a+p*o,y1:i,x2:a+p*o,y2:i+l})}return F.createElement("line",rf({},h,{className:Ut("recharts-cartesian-axis-line",ii(d,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var o=this,l=this.props,c=l.tickLine,u=l.stroke,d=l.tick,h=l.tickFormatter,f=l.unit,p=bI(xn(xn({},this.props),{},{ticks:n}),a,i),m=this.getTickTextAnchor(),v=this.getTickVerticalAnchor(),g=Ct(this.props,!1),x=Ct(d,!1),y=xn(xn({},g),{},{fill:"none"},Ct(c,!1)),b=p.map(function(N,j){var _=o.getTickLineCoord(N),S=_.line,C=_.tick,E=xn(xn(xn(xn({textAnchor:m,verticalAnchor:v},g),{},{stroke:"none",fill:u},x),C),{},{index:j,payload:N,visibleTicksCount:p.length,tickFormatter:h});return F.createElement(yr,rf({className:"recharts-cartesian-axis-tick",key:"tick-".concat(N.value,"-").concat(N.coordinate,"-").concat(N.tickCoord)},bw(o.props,N,j)),c&&F.createElement("line",rf({},y,S,{className:Ut("recharts-cartesian-axis-tick-line",ii(c,"className"))})),d&&t.renderTickItem(d,E,"".concat(bt(h)?h(N.value,j):N.value).concat(f||"")))});return F.createElement("g",{className:"recharts-cartesian-axis-ticks"},b)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,o=a.width,l=a.height,c=a.ticksGenerator,u=a.className,d=a.hide;if(d)return null;var h=this.props,f=h.ticks,p=mS(h,bVe),m=f;return bt(c)&&(m=f&&f.length>0?c(this.props):c(p)),o<=0||l<=0||!m||!m.length?null:F.createElement(yr,{className:Ut("recharts-cartesian-axis",u),ref:function(g){n.layerReference=g}},i&&this.renderAxisLine(),this.renderTicks(m,this.state.fontSize,this.state.letterSpacing),xa.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var o,l=Ut(a.className,"recharts-cartesian-axis-tick-value");return F.isValidElement(n)?o=F.cloneElement(n,xn(xn({},a),{},{className:l})):bt(n)?o=n(xn(xn({},a),{},{className:l})):o=F.createElement(Iw,rf({},a,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])}(w.Component);wI(gm,"displayName","CartesianAxis");wI(gm,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var AVe=["x1","y1","x2","y2","key"],PVe=["offset"];function Bd(e){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bd(e)}function OL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ya(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OL(Object(r),!0).forEach(function(n){TVe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TVe(e,t,r){return t=RVe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RVe(e){var t=OVe(e,"string");return Bd(t)=="symbol"?t:t+""}function OVe(e,t){if(Bd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ed(){return ed=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ed.apply(this,arguments)}function IL(e,t){if(e==null)return{};var r=IVe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function IVe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var DVe=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,i=t.y,o=t.width,l=t.height,c=t.ry;return F.createElement("rect",{x:a,y:i,ry:c,width:o,height:l,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function AX(e,t){var r;if(F.isValidElement(e))r=F.cloneElement(e,t);else if(bt(e))r=e(t);else{var n=t.x1,a=t.y1,i=t.x2,o=t.y2,l=t.key,c=IL(t,AVe),u=Ct(c,!1);u.offset;var d=IL(u,PVe);r=F.createElement("line",ed({},d,{x1:n,y1:a,x2:i,y2:o,fill:"none",key:l}))}return r}function MVe(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(l,c){var u=ya(ya({},e),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(c),index:c});return AX(a,u)});return F.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function $Ve(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,i=e.verticalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(l,c){var u=ya(ya({},e),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(c),index:c});return AX(a,u)});return F.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function FVe(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,i=e.width,o=e.height,l=e.horizontalPoints,c=e.horizontal,u=c===void 0?!0:c;if(!u||!t||!t.length)return null;var d=l.map(function(f){return Math.round(f+a-a)}).sort(function(f,p){return f-p});a!==d[0]&&d.unshift(0);var h=d.map(function(f,p){var m=!d[p+1],v=m?a+o-f:d[p+1]-f;if(v<=0)return null;var g=p%t.length;return F.createElement("rect",{key:"react-".concat(p),y:f,x:n,height:v,width:i,stroke:"none",fill:t[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return F.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function LVe(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,i=e.x,o=e.y,l=e.width,c=e.height,u=e.verticalPoints;if(!r||!n||!n.length)return null;var d=u.map(function(f){return Math.round(f+i-i)}).sort(function(f,p){return f-p});i!==d[0]&&d.unshift(0);var h=d.map(function(f,p){var m=!d[p+1],v=m?i+l-f:d[p+1]-f;if(v<=0)return null;var g=p%n.length;return F.createElement("rect",{key:"react-".concat(p),x:f,y:o,width:v,height:c,stroke:"none",fill:n[g],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return F.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var BVe=function(t,r){var n=t.xAxis,a=t.width,i=t.height,o=t.offset;return LY(bI(ya(ya(ya({},gm.defaultProps),n),{},{ticks:dl(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.left,o.left+o.width,r)},UVe=function(t,r){var n=t.yAxis,a=t.width,i=t.height,o=t.offset;return LY(bI(ya(ya(ya({},gm.defaultProps),n),{},{ticks:dl(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.top,o.top+o.height,r)},Eh={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function KN(e){var t,r,n,a,i,o,l=vI(),c=gI(),u=kUe(),d=ya(ya({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Eh.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Eh.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Eh.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Eh.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:Eh.vertical,verticalFill:(o=e.verticalFill)!==null&&o!==void 0?o:Eh.verticalFill,x:Te(e.x)?e.x:u.left,y:Te(e.y)?e.y:u.top,width:Te(e.width)?e.width:u.width,height:Te(e.height)?e.height:u.height}),h=d.x,f=d.y,p=d.width,m=d.height,v=d.syncWithTicks,g=d.horizontalValues,x=d.verticalValues,y=SUe(),b=CUe();if(!Te(p)||p<=0||!Te(m)||m<=0||!Te(h)||h!==+h||!Te(f)||f!==+f)return null;var N=d.verticalCoordinatesGenerator||BVe,j=d.horizontalCoordinatesGenerator||UVe,_=d.horizontalPoints,S=d.verticalPoints;if((!_||!_.length)&&bt(j)){var C=g&&g.length,E=j({yAxis:b?ya(ya({},b),{},{ticks:C?g:b.ticks}):void 0,width:l,height:c,offset:u},C?!0:v);ml(Array.isArray(E),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Bd(E),"]")),Array.isArray(E)&&(_=E)}if((!S||!S.length)&&bt(N)){var k=x&&x.length,P=N({xAxis:y?ya(ya({},y),{},{ticks:k?x:y.ticks}):void 0,width:l,height:c,offset:u},k?!0:v);ml(Array.isArray(P),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Bd(P),"]")),Array.isArray(P)&&(S=P)}return F.createElement("g",{className:"recharts-cartesian-grid"},F.createElement(DVe,{fill:d.fill,fillOpacity:d.fillOpacity,x:d.x,y:d.y,width:d.width,height:d.height,ry:d.ry}),F.createElement(MVe,ed({},d,{offset:u,horizontalPoints:_,xAxis:y,yAxis:b})),F.createElement($Ve,ed({},d,{offset:u,verticalPoints:S,xAxis:y,yAxis:b})),F.createElement(FVe,ed({},d,{horizontalPoints:_})),F.createElement(LVe,ed({},d,{verticalPoints:S})))}KN.displayName="CartesianGrid";var VVe=["type","layout","connectNulls","ref"],zVe=["key"];function wp(e){"@babel/helpers - typeof";return wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wp(e)}function DL(e,t){if(e==null)return{};var r=WVe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function WVe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Mv(){return Mv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mv.apply(this,arguments)}function ML(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ms(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ML(Object(r),!0).forEach(function(n){Ai(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ML(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kh(e){return KVe(e)||HVe(e)||GVe(e)||qVe()}function qVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GVe(e,t){if(e){if(typeof e=="string")return nA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nA(e,t)}}function HVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function KVe(e){if(Array.isArray(e))return nA(e)}function nA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TX(n.key),n)}}function XVe(e,t,r){return t&&$L(e.prototype,t),r&&$L(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QVe(e,t,r){return t=p1(t),ZVe(e,PX()?Reflect.construct(t,r||[],p1(e).constructor):t.apply(e,r))}function ZVe(e,t){if(t&&(wp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JVe(e)}function JVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(PX=function(){return!!e})()}function p1(e){return p1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},p1(e)}function eze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aA(e,t)}function aA(e,t){return aA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},aA(e,t)}function Ai(e,t,r){return t=TX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TX(e){var t=tze(e,"string");return wp(t)=="symbol"?t:t+""}function tze(e,t){if(wp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bd=function(e){function t(){var r;YVe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=QVe(this,t,[].concat(a)),Ai(r,"state",{isAnimationFinished:!0,totalLength:0}),Ai(r,"generateSimpleStrokeDasharray",function(o,l){return"".concat(l,"px ").concat(o-l,"px")}),Ai(r,"getStrokeDasharray",function(o,l,c){var u=c.reduce(function(x,y){return x+y});if(!u)return r.generateSimpleStrokeDasharray(l,o);for(var d=Math.floor(o/u),h=o%u,f=l-o,p=[],m=0,v=0;m<c.length;v+=c[m],++m)if(v+c[m]>h){p=[].concat(kh(c.slice(0,m)),[h-v]);break}var g=p.length%2===0?[0,f]:[f];return[].concat(kh(t.repeat(c,d)),kh(p),g).map(function(x){return"".concat(x,"px")}).join(", ")}),Ai(r,"id",um("recharts-line-")),Ai(r,"pathRef",function(o){r.mainCurve=o}),Ai(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Ai(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return eze(t,e),XVe(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.points,l=i.xAxis,c=i.yAxis,u=i.layout,d=i.children,h=oi(d,ey);if(!h)return null;var f=function(v,g){return{x:v.x,y:v.y,value:v.value,errorVal:Ua(v.payload,g)}},p={clipPath:n?"url(#clipPath-".concat(a,")"):null};return F.createElement(yr,p,h.map(function(m){return F.cloneElement(m,{key:"bar-".concat(m.props.dataKey),data:o,xAxis:l,yAxis:c,layout:u,dataPointFormatter:f})}))}},{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var l=this.props,c=l.dot,u=l.points,d=l.dataKey,h=Ct(this.props,!1),f=Ct(c,!0),p=u.map(function(v,g){var x=ms(ms(ms({key:"dot-".concat(g),r:3},h),f),{},{index:g,cx:v.x,cy:v.y,value:v.value,dataKey:d,payload:v.payload,points:u});return t.renderDotItem(c,x)}),m={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return F.createElement(yr,Mv({className:"recharts-line-dots",key:"dots"},m),p)}},{key:"renderCurveStatically",value:function(n,a,i,o){var l=this.props,c=l.type,u=l.layout,d=l.connectNulls;l.ref;var h=DL(l,VVe),f=ms(ms(ms({},Ct(h,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},o),{},{type:c,layout:u,connectNulls:d});return F.createElement(Af,Mv({},f,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,o=this.props,l=o.points,c=o.strokeDasharray,u=o.isAnimationActive,d=o.animationBegin,h=o.animationDuration,f=o.animationEasing,p=o.animationId,m=o.animateNewValues,v=o.width,g=o.height,x=this.state,y=x.prevPoints,b=x.totalLength;return F.createElement($o,{begin:d,duration:h,isActive:u,easing:f,from:{t:0},to:{t:1},key:"line-".concat(p),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(N){var j=N.t;if(y){var _=y.length/l.length,S=l.map(function(A,O){var I=Math.floor(O*_);if(y[I]){var R=y[I],M=na(R.x,A.x),B=na(R.y,A.y);return ms(ms({},A),{},{x:M(j),y:B(j)})}if(m){var $=na(v*2,A.x),D=na(g/2,A.y);return ms(ms({},A),{},{x:$(j),y:D(j)})}return ms(ms({},A),{},{x:A.x,y:A.y})});return i.renderCurveStatically(S,n,a)}var C=na(0,b),E=C(j),k;if(c){var P="".concat(c).split(/[,\s]+/gim).map(function(A){return parseFloat(A)});k=i.getStrokeDasharray(E,b,P)}else k=i.generateSimpleStrokeDasharray(b,E);return i.renderCurveStatically(l,n,a,{strokeDasharray:k})})}},{key:"renderCurve",value:function(n,a){var i=this.props,o=i.points,l=i.isAnimationActive,c=this.state,u=c.prevPoints,d=c.totalLength;return l&&o&&o.length&&(!u&&d>0||!dp(u,o))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(o,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,l=a.points,c=a.className,u=a.xAxis,d=a.yAxis,h=a.top,f=a.left,p=a.width,m=a.height,v=a.isAnimationActive,g=a.id;if(i||!l||!l.length)return null;var x=this.state.isAnimationFinished,y=l.length===1,b=Ut("recharts-line",c),N=u&&u.allowDataOverflow,j=d&&d.allowDataOverflow,_=N||j,S=Ot(g)?this.id:g,C=(n=Ct(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},E=C.r,k=E===void 0?3:E,P=C.strokeWidth,A=P===void 0?2:P,O=T7(o)?o:{},I=O.clipDot,R=I===void 0?!0:I,M=k*2+A;return F.createElement(yr,{className:b},N||j?F.createElement("defs",null,F.createElement("clipPath",{id:"clipPath-".concat(S)},F.createElement("rect",{x:N?f:f-p/2,y:j?h:h-m/2,width:N?p:p*2,height:j?m:m*2})),!R&&F.createElement("clipPath",{id:"clipPath-dots-".concat(S)},F.createElement("rect",{x:f-M/2,y:h-M/2,width:p+M,height:m+M}))):null,!y&&this.renderCurve(_,S),this.renderErrorBar(_,S),(y||o)&&this.renderDots(_,R,S),(!v||x)&&gl.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat(kh(n),[0]):n,o=[],l=0;l<a;++l)o=[].concat(kh(o),kh(i));return o}},{key:"renderDotItem",value:function(n,a){var i;if(F.isValidElement(n))i=F.cloneElement(n,a);else if(bt(n))i=n(a);else{var o=a.key,l=DL(a,zVe),c=Ut("recharts-line-dot",typeof n!="boolean"?n.className:"");i=F.createElement(BN,Mv({key:o},l,{className:c}))}return i}}])}(w.PureComponent);Ai(bd,"displayName","Line");Ai(bd,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Po.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Ai(bd,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,i=e.yAxisTicks,o=e.dataKey,l=e.bandSize,c=e.displayedData,u=e.offset,d=t.layout,h=c.map(function(f,p){var m=Ua(f,o);return d==="horizontal"?{x:Kw({axis:r,ticks:a,bandSize:l,entry:f,index:p}),y:Ot(m)?null:n.scale(m),value:m,payload:f}:{x:Ot(m)?null:r.scale(m),y:Kw({axis:n,ticks:i,bandSize:l,entry:f,index:p}),value:m,payload:f}});return ms({points:h,layout:d},u)});var rze=["layout","type","stroke","connectNulls","isRange","ref"],nze=["key"],RX;function jp(e){"@babel/helpers - typeof";return jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jp(e)}function OX(e,t){if(e==null)return{};var r=aze(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function aze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function td(){return td=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},td.apply(this,arguments)}function FL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FL(Object(r),!0).forEach(function(n){bo(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DX(n.key),n)}}function ize(e,t,r){return t&&LL(e.prototype,t),r&&LL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oze(e,t,r){return t=m1(t),lze(e,IX()?Reflect.construct(t,r||[],m1(e).constructor):t.apply(e,r))}function lze(e,t){if(t&&(jp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cze(e)}function cze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(IX=function(){return!!e})()}function m1(e){return m1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},m1(e)}function uze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sA(e,t)}function sA(e,t){return sA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},sA(e,t)}function bo(e,t,r){return t=DX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DX(e){var t=dze(e,"string");return jp(t)=="symbol"?t:t+""}function dze(e,t){if(jp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bu=function(e){function t(){var r;sze(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=oze(this,t,[].concat(a)),bo(r,"state",{isAnimationFinished:!0}),bo(r,"id",um("recharts-area-")),bo(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),bt(o)&&o()}),bo(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),bt(o)&&o()}),r}return uze(t,e),ize(t,[{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive,l=this.state.isAnimationFinished;if(o&&!l)return null;var c=this.props,u=c.dot,d=c.points,h=c.dataKey,f=Ct(this.props,!1),p=Ct(u,!0),m=d.map(function(g,x){var y=tc(tc(tc({key:"dot-".concat(x),r:3},f),p),{},{index:x,cx:g.x,cy:g.y,dataKey:h,value:g.value,payload:g.payload,points:d});return t.renderDotItem(u,y)}),v={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return F.createElement(yr,td({className:"recharts-area-dots"},v),m)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,l=a.strokeWidth,c=o[0].x,u=o[o.length-1].x,d=n*Math.abs(c-u),h=Cc(o.map(function(f){return f.y||0}));return Te(i)&&typeof i=="number"?h=Math.max(i,h):i&&Array.isArray(i)&&i.length&&(h=Math.max(Cc(i.map(function(f){return f.y||0})),h)),Te(h)?F.createElement("rect",{x:c<u?c:c-d,y:0,width:d,height:Math.floor(h+(l?parseInt("".concat(l),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,l=a.strokeWidth,c=o[0].y,u=o[o.length-1].y,d=n*Math.abs(c-u),h=Cc(o.map(function(f){return f.x||0}));return Te(i)&&typeof i=="number"?h=Math.max(i,h):i&&Array.isArray(i)&&i.length&&(h=Math.max(Cc(i.map(function(f){return f.x||0})),h)),Te(h)?F.createElement("rect",{x:0,y:c<u?c:c-d,width:h+(l?parseInt("".concat(l),10):1),height:Math.floor(d)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,i,o){var l=this.props,c=l.layout,u=l.type,d=l.stroke,h=l.connectNulls,f=l.isRange;l.ref;var p=OX(l,rze);return F.createElement(yr,{clipPath:i?"url(#clipPath-".concat(o,")"):null},F.createElement(Af,td({},Ct(p,!0),{points:n,connectNulls:h,type:u,baseLine:a,layout:c,stroke:"none",className:"recharts-area-area"})),d!=="none"&&F.createElement(Af,td({},Ct(this.props,!1),{className:"recharts-area-curve",layout:c,type:u,connectNulls:h,fill:"none",points:n})),d!=="none"&&f&&F.createElement(Af,td({},Ct(this.props,!1),{className:"recharts-area-curve",layout:c,type:u,connectNulls:h,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var i=this,o=this.props,l=o.points,c=o.baseLine,u=o.isAnimationActive,d=o.animationBegin,h=o.animationDuration,f=o.animationEasing,p=o.animationId,m=this.state,v=m.prevPoints,g=m.prevBaseLine;return F.createElement($o,{begin:d,duration:h,isActive:u,easing:f,from:{t:0},to:{t:1},key:"area-".concat(p),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(x){var y=x.t;if(v){var b=v.length/l.length,N=l.map(function(C,E){var k=Math.floor(E*b);if(v[k]){var P=v[k],A=na(P.x,C.x),O=na(P.y,C.y);return tc(tc({},C),{},{x:A(y),y:O(y)})}return C}),j;if(Te(c)&&typeof c=="number"){var _=na(g,c);j=_(y)}else if(Ot(c)||cm(c)){var S=na(g,0);j=S(y)}else j=c.map(function(C,E){var k=Math.floor(E*b);if(g[k]){var P=g[k],A=na(P.x,C.x),O=na(P.y,C.y);return tc(tc({},C),{},{x:A(y),y:O(y)})}return C});return i.renderAreaStatically(N,j,n,a)}return F.createElement(yr,null,F.createElement("defs",null,F.createElement("clipPath",{id:"animationClipPath-".concat(a)},i.renderClipRect(y))),F.createElement(yr,{clipPath:"url(#animationClipPath-".concat(a,")")},i.renderAreaStatically(l,c,n,a)))})}},{key:"renderArea",value:function(n,a){var i=this.props,o=i.points,l=i.baseLine,c=i.isAnimationActive,u=this.state,d=u.prevPoints,h=u.prevBaseLine,f=u.totalLength;return c&&o&&o.length&&(!d&&f>0||!dp(d,o)||!dp(h,l))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(o,l,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,l=a.points,c=a.className,u=a.top,d=a.left,h=a.xAxis,f=a.yAxis,p=a.width,m=a.height,v=a.isAnimationActive,g=a.id;if(i||!l||!l.length)return null;var x=this.state.isAnimationFinished,y=l.length===1,b=Ut("recharts-area",c),N=h&&h.allowDataOverflow,j=f&&f.allowDataOverflow,_=N||j,S=Ot(g)?this.id:g,C=(n=Ct(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},E=C.r,k=E===void 0?3:E,P=C.strokeWidth,A=P===void 0?2:P,O=T7(o)?o:{},I=O.clipDot,R=I===void 0?!0:I,M=k*2+A;return F.createElement(yr,{className:b},N||j?F.createElement("defs",null,F.createElement("clipPath",{id:"clipPath-".concat(S)},F.createElement("rect",{x:N?d:d-p/2,y:j?u:u-m/2,width:N?p:p*2,height:j?m:m*2})),!R&&F.createElement("clipPath",{id:"clipPath-dots-".concat(S)},F.createElement("rect",{x:d-M/2,y:u-M/2,width:p+M,height:m+M}))):null,y?null:this.renderArea(_,S),(o||y)&&this.renderDots(_,R,S),(!v||x)&&gl.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(w.PureComponent);RX=bu;bo(bu,"displayName","Area");bo(bu,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Po.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});bo(bu,"getBaseValue",function(e,t,r,n){var a=e.layout,i=e.baseValue,o=t.props.baseValue,l=o??i;if(Te(l)&&typeof l=="number")return l;var c=a==="horizontal"?n:r,u=c.scale.domain();if(c.type==="number"){var d=Math.max(u[0],u[1]),h=Math.min(u[0],u[1]);return l==="dataMin"?h:l==="dataMax"||d<0?d:Math.max(Math.min(u[0],u[1]),0)}return l==="dataMin"?u[0]:l==="dataMax"?u[1]:u[0]});bo(bu,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,a=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,l=e.bandSize,c=e.dataKey,u=e.stackedData,d=e.dataStartIndex,h=e.displayedData,f=e.offset,p=t.layout,m=u&&u.length,v=RX.getBaseValue(t,r,n,a),g=p==="horizontal",x=!1,y=h.map(function(N,j){var _;m?_=u[d+j]:(_=Ua(N,c),Array.isArray(_)?x=!0:_=[v,_]);var S=_[1]==null||m&&Ua(N,c)==null;return g?{x:Kw({axis:n,ticks:i,bandSize:l,entry:N,index:j}),y:S?null:a.scale(_[1]),value:_,payload:N}:{x:S?null:n.scale(_[1]),y:Kw({axis:a,ticks:o,bandSize:l,entry:N,index:j}),value:_,payload:N}}),b;return m||x?b=y.map(function(N){var j=Array.isArray(N.value)?N.value[0]:null;return g?{x:N.x,y:j!=null&&N.y!=null?a.scale(j):null}:{x:j!=null?n.scale(j):null,y:N.y}}):b=g?a.scale(v):n.scale(v),tc({points:y,baseLine:b,layout:p,isRange:x},f)});bo(bu,"renderDotItem",function(e,t){var r;if(F.isValidElement(e))r=F.cloneElement(e,t);else if(bt(e))r=e(t);else{var n=Ut("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,i=OX(t,nze);r=F.createElement(BN,td({},i,{key:a,className:n}))}return r});function Np(e){"@babel/helpers - typeof";return Np=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Np(e)}function hze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FX(n.key),n)}}function pze(e,t,r){return t&&fze(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function mze(e,t,r){return t=v1(t),vze(e,MX()?Reflect.construct(t,r||[],v1(e).constructor):t.apply(e,r))}function vze(e,t){if(t&&(Np(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gze(e)}function gze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MX=function(){return!!e})()}function v1(e){return v1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},v1(e)}function xze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iA(e,t)}function iA(e,t){return iA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},iA(e,t)}function $X(e,t,r){return t=FX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FX(e){var t=yze(e,"string");return Np(t)=="symbol"?t:t+""}function yze(e,t){if(Np(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Np(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oA(){return oA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oA.apply(this,arguments)}function bze(e){var t=e.xAxisId,r=vI(),n=gI(),a=xX(t);return a==null?null:w.createElement(gm,oA({},a,{className:Ut("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(o){return dl(o,!0)}}))}var wu=function(e){function t(){return hze(this,t),mze(this,t,arguments)}return xze(t,e),pze(t,[{key:"render",value:function(){return w.createElement(bze,this.props)}}])}(w.Component);$X(wu,"displayName","XAxis");$X(wu,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function _p(e){"@babel/helpers - typeof";return _p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_p(e)}function wze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UX(n.key),n)}}function Nze(e,t,r){return t&&jze(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ze(e,t,r){return t=g1(t),Sze(e,LX()?Reflect.construct(t,r||[],g1(e).constructor):t.apply(e,r))}function Sze(e,t){if(t&&(_p(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cze(e)}function Cze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(LX=function(){return!!e})()}function g1(e){return g1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},g1(e)}function Eze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lA(e,t)}function lA(e,t){return lA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},lA(e,t)}function BX(e,t,r){return t=UX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UX(e){var t=kze(e,"string");return _p(t)=="symbol"?t:t+""}function kze(e,t){if(_p(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_p(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cA(){return cA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cA.apply(this,arguments)}var Aze=function(t){var r=t.yAxisId,n=vI(),a=gI(),i=yX(r);return i==null?null:w.createElement(gm,cA({},i,{className:Ut("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(l){return dl(l,!0)}}))},ju=function(e){function t(){return wze(this,t),_ze(this,t,arguments)}return Eze(t,e),Nze(t,[{key:"render",value:function(){return w.createElement(Aze,this.props)}}])}(w.Component);BX(ju,"displayName","YAxis");BX(ju,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function BL(e){return Oze(e)||Rze(e)||Tze(e)||Pze()}function Pze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tze(e,t){if(e){if(typeof e=="string")return uA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uA(e,t)}}function Rze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Oze(e){if(Array.isArray(e))return uA(e)}function uA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var dA=function(t,r,n,a,i){var o=oi(t,yI),l=oi(t,qN),c=[].concat(BL(o),BL(l)),u=oi(t,HN),d="".concat(a,"Id"),h=a[0],f=r;if(c.length&&(f=c.reduce(function(v,g){if(g.props[d]===n&&Ro(g.props,"extendDomain")&&Te(g.props[h])){var x=g.props[h];return[Math.min(v[0],x),Math.max(v[1],x)]}return v},f)),u.length){var p="".concat(h,"1"),m="".concat(h,"2");f=u.reduce(function(v,g){if(g.props[d]===n&&Ro(g.props,"extendDomain")&&Te(g.props[p])&&Te(g.props[m])){var x=g.props[p],y=g.props[m];return[Math.min(v[0],x,y),Math.max(v[1],x,y)]}return v},f)}return i&&i.length&&(f=i.reduce(function(v,g){return Te(g)?[Math.min(v[0],g),Math.max(v[1],g)]:v},f)),f},VX={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,h,f){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new a(d,h||c,f),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],p]:c._events[m].push(p):(c._events[m]=p,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,h;if(this._eventsCount===0)return u;for(h in d=this._events)t.call(d,h)&&u.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,p=h.length,m=new Array(p);f<p;f++)m[f]=h[f].fn;return m},l.prototype.listenerCount=function(u){var d=r?r+u:u,h=this._events[d];return h?h.fn?1:h.length:0},l.prototype.emit=function(u,d,h,f,p,m){var v=r?r+u:u;if(!this._events[v])return!1;var g=this._events[v],x=arguments.length,y,b;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),x){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,d),!0;case 3:return g.fn.call(g.context,d,h),!0;case 4:return g.fn.call(g.context,d,h,f),!0;case 5:return g.fn.call(g.context,d,h,f,p),!0;case 6:return g.fn.call(g.context,d,h,f,p,m),!0}for(b=1,y=new Array(x-1);b<x;b++)y[b-1]=arguments[b];g.fn.apply(g.context,y)}else{var N=g.length,j;for(b=0;b<N;b++)switch(g[b].once&&this.removeListener(u,g[b].fn,void 0,!0),x){case 1:g[b].fn.call(g[b].context);break;case 2:g[b].fn.call(g[b].context,d);break;case 3:g[b].fn.call(g[b].context,d,h);break;case 4:g[b].fn.call(g[b].context,d,h,f);break;default:if(!y)for(j=1,y=new Array(x-1);j<x;j++)y[j-1]=arguments[j];g[b].fn.apply(g[b].context,y)}}return!0},l.prototype.on=function(u,d,h){return i(this,u,d,h,!1)},l.prototype.once=function(u,d,h){return i(this,u,d,h,!0)},l.prototype.removeListener=function(u,d,h,f){var p=r?r+u:u;if(!this._events[p])return this;if(!d)return o(this,p),this;var m=this._events[p];if(m.fn)m.fn===d&&(!f||m.once)&&(!h||m.context===h)&&o(this,p);else{for(var v=0,g=[],x=m.length;v<x;v++)(m[v].fn!==d||f&&!m[v].once||h&&m[v].context!==h)&&g.push(m[v]);g.length?this._events[p]=g.length===1?g[0]:g:o(this,p)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(VX);var Ize=VX.exports;const Dze=lr(Ize);var vS=new Dze,gS="recharts.syncMouseEvents";function ix(e){"@babel/helpers - typeof";return ix=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ix(e)}function Mze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $ze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zX(n.key),n)}}function Fze(e,t,r){return t&&$ze(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function xS(e,t,r){return t=zX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zX(e){var t=Lze(e,"string");return ix(t)=="symbol"?t:t+""}function Lze(e,t){if(ix(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ix(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Bze=function(){function e(){Mze(this,e),xS(this,"activeIndex",0),xS(this,"coordinateList",[]),xS(this,"layout","horizontal")}return Fze(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,o=r.container,l=o===void 0?null:o,c=r.layout,u=c===void 0?null:c,d=r.offset,h=d===void 0?null:d,f=r.mouseHandlerCallback,p=f===void 0?null:f;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=l??this.container,this.layout=u??this.layout,this.offset=h??this.offset,this.mouseHandlerCallback=p??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,o=a.y,l=a.height,c=this.coordinateList[this.activeIndex].coordinate,u=((r=window)===null||r===void 0?void 0:r.scrollX)||0,d=((n=window)===null||n===void 0?void 0:n.scrollY)||0,h=i+c+u,f=o+this.offset.top+l/2+d;this.mouseHandlerCallback({pageX:h,pageY:f})}}}])}();function Uze(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&Te(n)&&Te(a))return!0}return!1}function Vze(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function WX(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,i=e.endAngle,o=aa(t,r,n,a),l=aa(t,r,n,i);return{points:[o,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function zze(e,t,r){var n,a,i,o;if(e==="horizontal")n=t.x,i=n,a=r.top,o=r.top+r.height;else if(e==="vertical")a=t.y,o=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,u=t.innerRadius,d=t.outerRadius,h=t.angle,f=aa(l,c,u,h),p=aa(l,c,d,h);n=f.x,a=f.y,i=p.x,o=p.y}else return WX(t);return[{x:n,y:a},{x:i,y:o}]}function ox(e){"@babel/helpers - typeof";return ox=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ox(e)}function UL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Nb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UL(Object(r),!0).forEach(function(n){Wze(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wze(e,t,r){return t=qze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qze(e){var t=Gze(e,"string");return ox(t)=="symbol"?t:t+""}function Gze(e,t){if(ox(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ox(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hze(e){var t,r,n=e.element,a=e.tooltipEventType,i=e.isActive,o=e.activeCoordinate,l=e.activePayload,c=e.offset,u=e.activeTooltipIndex,d=e.tooltipAxisBandSize,h=e.layout,f=e.chartName,p=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!p||!i||!o||f!=="ScatterChart"&&a!=="axis")return null;var m,v=Af;if(f==="ScatterChart")m=o,v=$Le;else if(f==="BarChart")m=Vze(h,o,c,d),v=dI;else if(h==="radial"){var g=WX(o),x=g.cx,y=g.cy,b=g.radius,N=g.startAngle,j=g.endAngle;m={cx:x,cy:y,startAngle:N,endAngle:j,innerRadius:b,outerRadius:b},v=WY}else m={points:zze(h,o,c)},v=Af;var _=Nb(Nb(Nb(Nb({stroke:"#ccc",pointerEvents:"none"},c),m),Ct(p,!1)),{},{payload:l,payloadIndex:u,className:Ut("recharts-tooltip-cursor",p.className)});return w.isValidElement(p)?w.cloneElement(p,_):w.createElement(v,_)}var Kze=["item"],Yze=["children","className","width","height","style","compact","title","desc"];function Sp(e){"@babel/helpers - typeof";return Sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sp(e)}function nf(){return nf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nf.apply(this,arguments)}function VL(e,t){return Zze(e)||Qze(e,t)||GX(e,t)||Xze()}function Xze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qze(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function Zze(e){if(Array.isArray(e))return e}function zL(e,t){if(e==null)return{};var r=Jze(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Jze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function e8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t8e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HX(n.key),n)}}function r8e(e,t,r){return t&&t8e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function n8e(e,t,r){return t=x1(t),a8e(e,qX()?Reflect.construct(t,r||[],x1(e).constructor):t.apply(e,r))}function a8e(e,t){if(t&&(Sp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return s8e(e)}function s8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qX=function(){return!!e})()}function x1(e){return x1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},x1(e)}function i8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hA(e,t)}function hA(e,t){return hA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},hA(e,t)}function Cp(e){return c8e(e)||l8e(e)||GX(e)||o8e()}function o8e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GX(e,t){if(e){if(typeof e=="string")return fA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fA(e,t)}}function l8e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function c8e(e){if(Array.isArray(e))return fA(e)}function fA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WL(Object(r),!0).forEach(function(n){ot(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ot(e,t,r){return t=HX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HX(e){var t=u8e(e,"string");return Sp(t)=="symbol"?t:t+""}function u8e(e,t){if(Sp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var d8e={xAxis:["bottom","top"],yAxis:["left","right"]},h8e={width:"100%",height:"100%"},KX={x:0,y:0};function _b(e){return e}var f8e=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},p8e=function(t,r,n,a){var i=r.find(function(d){return d&&d.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var o=i.coordinate,l=a.radius;return pe(pe(pe({},a),aa(a.cx,a.cy,l,o)),{},{angle:o,radius:l})}var c=i.coordinate,u=a.angle;return pe(pe(pe({},a),aa(a.cx,a.cy,c,u)),{},{angle:u,radius:c})}return KX},YN=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,o=(n??[]).reduce(function(l,c){var u=c.props.data;return u&&u.length?[].concat(Cp(l),Cp(u)):l},[]);return o.length>0?o:t&&t.length&&Te(a)&&Te(i)?t.slice(a,i+1):[]};function YX(e){return e==="number"?[0,"auto"]:void 0}var pA=function(t,r,n,a){var i=t.graphicalItems,o=t.tooltipAxis,l=YN(r,t);return n<0||!i||!i.length||n>=l.length?null:i.reduce(function(c,u){var d,h=(d=u.props.data)!==null&&d!==void 0?d:r;h&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(h=h.slice(t.dataStartIndex,t.dataEndIndex+1));var f;if(o.dataKey&&!o.allowDuplicatedCategory){var p=h===void 0?l:h;f=xw(p,o.dataKey,a)}else f=h&&h[n]||l[n];return f?[].concat(Cp(c),[UY(u,f)]):c},[])},qL=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},o=f8e(i,n),l=t.orderedTooltipTicks,c=t.tooltipAxis,u=t.tooltipTicks,d=y$e(o,l,u,c);if(d>=0&&u){var h=u[d]&&u[d].value,f=pA(t,r,d,h),p=p8e(n,l,d,i);return{activeTooltipIndex:d,activeLabel:h,activePayload:f,activeCoordinate:p}}return null},m8e=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,h=t.children,f=t.stackOffset,p=FY(d,i);return n.reduce(function(m,v){var g,x=v.type.defaultProps!==void 0?pe(pe({},v.type.defaultProps),v.props):v.props,y=x.type,b=x.dataKey,N=x.allowDataOverflow,j=x.allowDuplicatedCategory,_=x.scale,S=x.ticks,C=x.includeHidden,E=x[o];if(m[E])return m;var k=YN(t.data,{graphicalItems:a.filter(function(U){var Y,ae=o in U.props?U.props[o]:(Y=U.type.defaultProps)===null||Y===void 0?void 0:Y[o];return ae===E}),dataStartIndex:c,dataEndIndex:u}),P=k.length,A,O,I;Uze(x.domain,N,y)&&(A=Tk(x.domain,null,N),p&&(y==="number"||_!=="auto")&&(I=Iv(k,b,"category")));var R=YX(y);if(!A||A.length===0){var M,B=(M=x.domain)!==null&&M!==void 0?M:R;if(b){if(A=Iv(k,b,y),y==="category"&&p){var $=i2e(A);j&&$?(O=A,A=a1(0,P)):j||(A=w5(B,A,v).reduce(function(U,Y){return U.indexOf(Y)>=0?U:[].concat(Cp(U),[Y])},[]))}else if(y==="category")j?A=A.filter(function(U){return U!==""&&!Ot(U)}):A=w5(B,A,v).reduce(function(U,Y){return U.indexOf(Y)>=0||Y===""||Ot(Y)?U:[].concat(Cp(U),[Y])},[]);else if(y==="number"){var D=_$e(k,a.filter(function(U){var Y,ae,ie=o in U.props?U.props[o]:(Y=U.type.defaultProps)===null||Y===void 0?void 0:Y[o],he="hide"in U.props?U.props.hide:(ae=U.type.defaultProps)===null||ae===void 0?void 0:ae.hide;return ie===E&&(C||!he)}),b,i,d);D&&(A=D)}p&&(y==="number"||_!=="auto")&&(I=Iv(k,b,"category"))}else p?A=a1(0,P):l&&l[E]&&l[E].hasStack&&y==="number"?A=f==="expand"?[0,1]:BY(l[E].stackGroups,c,u):A=$Y(k,a.filter(function(U){var Y=o in U.props?U.props[o]:U.type.defaultProps[o],ae="hide"in U.props?U.props.hide:U.type.defaultProps.hide;return Y===E&&(C||!ae)}),y,d,!0);if(y==="number")A=dA(h,A,E,i,S),B&&(A=Tk(B,A,N));else if(y==="category"&&B){var W=B,Z=A.every(function(U){return W.indexOf(U)>=0});Z&&(A=W)}}return pe(pe({},m),{},ot({},E,pe(pe({},x),{},{axisType:i,domain:A,categoricalDomain:I,duplicateDomain:O,originalDomain:(g=x.domain)!==null&&g!==void 0?g:R,isCategorical:p,layout:d})))},{})},v8e=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,h=t.children,f=YN(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:u}),p=f.length,m=FY(d,i),v=-1;return n.reduce(function(g,x){var y=x.type.defaultProps!==void 0?pe(pe({},x.type.defaultProps),x.props):x.props,b=y[o],N=YX("number");if(!g[b]){v++;var j;return m?j=a1(0,p):l&&l[b]&&l[b].hasStack?(j=BY(l[b].stackGroups,c,u),j=dA(h,j,b,i)):(j=Tk(N,$Y(f,n.filter(function(_){var S,C,E=o in _.props?_.props[o]:(S=_.type.defaultProps)===null||S===void 0?void 0:S[o],k="hide"in _.props?_.props.hide:(C=_.type.defaultProps)===null||C===void 0?void 0:C.hide;return E===b&&!k}),"number",d),a.defaultProps.allowDataOverflow),j=dA(h,j,b,i)),pe(pe({},g),{},ot({},b,pe(pe({axisType:i},a.defaultProps),{},{hide:!0,orientation:ii(d8e,"".concat(i,".").concat(v%2),null),domain:j,originalDomain:N,isCategorical:m,layout:d})))}return g},{})},g8e=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,o=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.children,h="".concat(a,"Id"),f=oi(d,i),p={};return f&&f.length?p=m8e(t,{axes:f,graphicalItems:o,axisType:a,axisIdKey:h,stackGroups:l,dataStartIndex:c,dataEndIndex:u}):o&&o.length&&(p=v8e(t,{Axis:i,graphicalItems:o,axisType:a,axisIdKey:h,stackGroups:l,dataStartIndex:c,dataEndIndex:u})),p},x8e=function(t){var r=uc(t),n=dl(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:FO(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Yw(r,n)}},GL=function(t){var r=t.children,n=t.defaultShowTooltip,a=ys(r,mp),i=0,o=0;return t.data&&t.data.length!==0&&(o=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(o=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},y8e=function(t){return!t||!t.length?!1:t.some(function(r){var n=pl(r&&r.type);return n&&n.indexOf("Bar")>=0})},HL=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},b8e=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,o=i===void 0?{}:i,l=t.yAxisMap,c=l===void 0?{}:l,u=n.width,d=n.height,h=n.children,f=n.margin||{},p=ys(h,mp),m=ys(h,Cf),v=Object.keys(c).reduce(function(j,_){var S=c[_],C=S.orientation;return!S.mirror&&!S.hide?pe(pe({},j),{},ot({},C,j[C]+S.width)):j},{left:f.left||0,right:f.right||0}),g=Object.keys(o).reduce(function(j,_){var S=o[_],C=S.orientation;return!S.mirror&&!S.hide?pe(pe({},j),{},ot({},C,ii(j,"".concat(C))+S.height)):j},{top:f.top||0,bottom:f.bottom||0}),x=pe(pe({},g),v),y=x.bottom;p&&(x.bottom+=p.props.height||mp.defaultProps.height),m&&r&&(x=j$e(x,a,n,r));var b=u-x.left-x.right,N=d-x.top-x.bottom;return pe(pe({brushBottom:y},x),{},{width:Math.max(b,0),height:Math.max(N,0)})},w8e=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},jI=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,o=t.validateTooltipEventTypes,l=o===void 0?["axis"]:o,c=t.axisComponents,u=t.legendContent,d=t.formatAxisMap,h=t.defaultProps,f=function(x,y){var b=y.graphicalItems,N=y.stackGroups,j=y.offset,_=y.updateId,S=y.dataStartIndex,C=y.dataEndIndex,E=x.barSize,k=x.layout,P=x.barGap,A=x.barCategoryGap,O=x.maxBarSize,I=HL(k),R=I.numericAxisName,M=I.cateAxisName,B=y8e(b),$=[];return b.forEach(function(D,W){var Z=YN(x.data,{graphicalItems:[D],dataStartIndex:S,dataEndIndex:C}),U=D.type.defaultProps!==void 0?pe(pe({},D.type.defaultProps),D.props):D.props,Y=U.dataKey,ae=U.maxBarSize,ie=U["".concat(R,"Id")],he=U["".concat(M,"Id")],se={},ye=c.reduce(function(te,ce){var _e=y["".concat(ce.axisType,"Map")],Ae=U["".concat(ce.axisType,"Id")];_e&&_e[Ae]||ce.axisType==="zAxis"||Ld();var je=_e[Ae];return pe(pe({},te),{},ot(ot({},ce.axisType,je),"".concat(ce.axisType,"Ticks"),dl(je)))},se),ne=ye[M],le=ye["".concat(M,"Ticks")],ve=N&&N[ie]&&N[ie].hasStack&&M$e(D,N[ie].stackGroups),K=pl(D.type).indexOf("Bar")>=0,ke=Yw(ne,le),Ce=[],Ge=B&&b$e({barSize:E,stackGroups:N,totalSize:w8e(ye,M)});if(K){var He,It,ar=Ot(ae)?O:ae,Kt=(He=(It=Yw(ne,le,!0))!==null&&It!==void 0?It:ar)!==null&&He!==void 0?He:0;Ce=w$e({barGap:P,barCategoryGap:A,bandSize:Kt!==ke?Kt:ke,sizeList:Ge[he],maxBarSize:ar}),Kt!==ke&&(Ce=Ce.map(function(te){return pe(pe({},te),{},{position:pe(pe({},te.position),{},{offset:te.position.offset-Kt/2})})}))}var G=D&&D.type&&D.type.getComposedData;G&&$.push({props:pe(pe({},G(pe(pe({},ye),{},{displayedData:Z,props:x,dataKey:Y,item:D,bandSize:ke,barPosition:Ce,offset:j,stackedData:ve,layout:k,dataStartIndex:S,dataEndIndex:C}))),{},ot(ot(ot({key:D.key||"item-".concat(W)},R,ye[R]),M,ye[M]),"animationId",_)),childIndex:x2e(D,x.children),item:D})}),$},p=function(x,y){var b=x.props,N=x.dataStartIndex,j=x.dataEndIndex,_=x.updateId;if(!m$({props:b}))return null;var S=b.children,C=b.layout,E=b.stackOffset,k=b.data,P=b.reverseStackOrder,A=HL(C),O=A.numericAxisName,I=A.cateAxisName,R=oi(S,n),M=O$e(k,R,"".concat(O,"Id"),"".concat(I,"Id"),E,P),B=c.reduce(function(U,Y){var ae="".concat(Y.axisType,"Map");return pe(pe({},U),{},ot({},ae,g8e(b,pe(pe({},Y),{},{graphicalItems:R,stackGroups:Y.axisType===O&&M,dataStartIndex:N,dataEndIndex:j}))))},{}),$=b8e(pe(pe({},B),{},{props:b,graphicalItems:R}),y==null?void 0:y.legendBBox);Object.keys(B).forEach(function(U){B[U]=d(b,B[U],$,U.replace("Map",""),r)});var D=B["".concat(I,"Map")],W=x8e(D),Z=f(b,pe(pe({},B),{},{dataStartIndex:N,dataEndIndex:j,updateId:_,graphicalItems:R,stackGroups:M,offset:$}));return pe(pe({formattedGraphicalItems:Z,graphicalItems:R,offset:$,stackGroups:M},W),B)},m=function(g){function x(y){var b,N,j;return e8e(this,x),j=n8e(this,x,[y]),ot(j,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),ot(j,"accessibilityManager",new Bze),ot(j,"handleLegendBBoxUpdate",function(_){if(_){var S=j.state,C=S.dataStartIndex,E=S.dataEndIndex,k=S.updateId;j.setState(pe({legendBBox:_},p({props:j.props,dataStartIndex:C,dataEndIndex:E,updateId:k},pe(pe({},j.state),{},{legendBBox:_}))))}}),ot(j,"handleReceiveSyncEvent",function(_,S,C){if(j.props.syncId===_){if(C===j.eventEmitterSymbol&&typeof j.props.syncMethod!="function")return;j.applySyncEvent(S)}}),ot(j,"handleBrushChange",function(_){var S=_.startIndex,C=_.endIndex;if(S!==j.state.dataStartIndex||C!==j.state.dataEndIndex){var E=j.state.updateId;j.setState(function(){return pe({dataStartIndex:S,dataEndIndex:C},p({props:j.props,dataStartIndex:S,dataEndIndex:C,updateId:E},j.state))}),j.triggerSyncEvent({dataStartIndex:S,dataEndIndex:C})}}),ot(j,"handleMouseEnter",function(_){var S=j.getMouseInfo(_);if(S){var C=pe(pe({},S),{},{isTooltipActive:!0});j.setState(C),j.triggerSyncEvent(C);var E=j.props.onMouseEnter;bt(E)&&E(C,_)}}),ot(j,"triggeredAfterMouseMove",function(_){var S=j.getMouseInfo(_),C=S?pe(pe({},S),{},{isTooltipActive:!0}):{isTooltipActive:!1};j.setState(C),j.triggerSyncEvent(C);var E=j.props.onMouseMove;bt(E)&&E(C,_)}),ot(j,"handleItemMouseEnter",function(_){j.setState(function(){return{isTooltipActive:!0,activeItem:_,activePayload:_.tooltipPayload,activeCoordinate:_.tooltipPosition||{x:_.cx,y:_.cy}}})}),ot(j,"handleItemMouseLeave",function(){j.setState(function(){return{isTooltipActive:!1}})}),ot(j,"handleMouseMove",function(_){_.persist(),j.throttleTriggeredAfterMouseMove(_)}),ot(j,"handleMouseLeave",function(_){j.throttleTriggeredAfterMouseMove.cancel();var S={isTooltipActive:!1};j.setState(S),j.triggerSyncEvent(S);var C=j.props.onMouseLeave;bt(C)&&C(S,_)}),ot(j,"handleOuterEvent",function(_){var S=g2e(_),C=ii(j.props,"".concat(S));if(S&&bt(C)){var E,k;/.*touch.*/i.test(S)?k=j.getMouseInfo(_.changedTouches[0]):k=j.getMouseInfo(_),C((E=k)!==null&&E!==void 0?E:{},_)}}),ot(j,"handleClick",function(_){var S=j.getMouseInfo(_);if(S){var C=pe(pe({},S),{},{isTooltipActive:!0});j.setState(C),j.triggerSyncEvent(C);var E=j.props.onClick;bt(E)&&E(C,_)}}),ot(j,"handleMouseDown",function(_){var S=j.props.onMouseDown;if(bt(S)){var C=j.getMouseInfo(_);S(C,_)}}),ot(j,"handleMouseUp",function(_){var S=j.props.onMouseUp;if(bt(S)){var C=j.getMouseInfo(_);S(C,_)}}),ot(j,"handleTouchMove",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&j.throttleTriggeredAfterMouseMove(_.changedTouches[0])}),ot(j,"handleTouchStart",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&j.handleMouseDown(_.changedTouches[0])}),ot(j,"handleTouchEnd",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&j.handleMouseUp(_.changedTouches[0])}),ot(j,"handleDoubleClick",function(_){var S=j.props.onDoubleClick;if(bt(S)){var C=j.getMouseInfo(_);S(C,_)}}),ot(j,"handleContextMenu",function(_){var S=j.props.onContextMenu;if(bt(S)){var C=j.getMouseInfo(_);S(C,_)}}),ot(j,"triggerSyncEvent",function(_){j.props.syncId!==void 0&&vS.emit(gS,j.props.syncId,_,j.eventEmitterSymbol)}),ot(j,"applySyncEvent",function(_){var S=j.props,C=S.layout,E=S.syncMethod,k=j.state.updateId,P=_.dataStartIndex,A=_.dataEndIndex;if(_.dataStartIndex!==void 0||_.dataEndIndex!==void 0)j.setState(pe({dataStartIndex:P,dataEndIndex:A},p({props:j.props,dataStartIndex:P,dataEndIndex:A,updateId:k},j.state)));else if(_.activeTooltipIndex!==void 0){var O=_.chartX,I=_.chartY,R=_.activeTooltipIndex,M=j.state,B=M.offset,$=M.tooltipTicks;if(!B)return;if(typeof E=="function")R=E($,_);else if(E==="value"){R=-1;for(var D=0;D<$.length;D++)if($[D].value===_.activeLabel){R=D;break}}var W=pe(pe({},B),{},{x:B.left,y:B.top}),Z=Math.min(O,W.x+W.width),U=Math.min(I,W.y+W.height),Y=$[R]&&$[R].value,ae=pA(j.state,j.props.data,R),ie=$[R]?{x:C==="horizontal"?$[R].coordinate:Z,y:C==="horizontal"?U:$[R].coordinate}:KX;j.setState(pe(pe({},_),{},{activeLabel:Y,activeCoordinate:ie,activePayload:ae,activeTooltipIndex:R}))}else j.setState(_)}),ot(j,"renderCursor",function(_){var S,C=j.state,E=C.isTooltipActive,k=C.activeCoordinate,P=C.activePayload,A=C.offset,O=C.activeTooltipIndex,I=C.tooltipAxisBandSize,R=j.getTooltipEventType(),M=(S=_.props.active)!==null&&S!==void 0?S:E,B=j.props.layout,$=_.key||"_recharts-cursor";return F.createElement(Hze,{key:$,activeCoordinate:k,activePayload:P,activeTooltipIndex:O,chartName:r,element:_,isActive:M,layout:B,offset:A,tooltipAxisBandSize:I,tooltipEventType:R})}),ot(j,"renderPolarAxis",function(_,S,C){var E=ii(_,"type.axisType"),k=ii(j.state,"".concat(E,"Map")),P=_.type.defaultProps,A=P!==void 0?pe(pe({},P),_.props):_.props,O=k&&k[A["".concat(E,"Id")]];return w.cloneElement(_,pe(pe({},O),{},{className:Ut(E,O.className),key:_.key||"".concat(S,"-").concat(C),ticks:dl(O,!0)}))}),ot(j,"renderPolarGrid",function(_){var S=_.props,C=S.radialLines,E=S.polarAngles,k=S.polarRadius,P=j.state,A=P.radiusAxisMap,O=P.angleAxisMap,I=uc(A),R=uc(O),M=R.cx,B=R.cy,$=R.innerRadius,D=R.outerRadius;return w.cloneElement(_,{polarAngles:Array.isArray(E)?E:dl(R,!0).map(function(W){return W.coordinate}),polarRadius:Array.isArray(k)?k:dl(I,!0).map(function(W){return W.coordinate}),cx:M,cy:B,innerRadius:$,outerRadius:D,key:_.key||"polar-grid",radialLines:C})}),ot(j,"renderLegend",function(){var _=j.state.formattedGraphicalItems,S=j.props,C=S.children,E=S.width,k=S.height,P=j.props.margin||{},A=E-(P.left||0)-(P.right||0),O=DY({children:C,formattedGraphicalItems:_,legendWidth:A,legendContent:u});if(!O)return null;var I=O.item,R=zL(O,Kze);return w.cloneElement(I,pe(pe({},R),{},{chartWidth:E,chartHeight:k,margin:P,onBBoxUpdate:j.handleLegendBBoxUpdate}))}),ot(j,"renderTooltip",function(){var _,S=j.props,C=S.children,E=S.accessibilityLayer,k=ys(C,lo);if(!k)return null;var P=j.state,A=P.isTooltipActive,O=P.activeCoordinate,I=P.activePayload,R=P.activeLabel,M=P.offset,B=(_=k.props.active)!==null&&_!==void 0?_:A;return w.cloneElement(k,{viewBox:pe(pe({},M),{},{x:M.left,y:M.top}),active:B,label:R,payload:B?I:[],coordinate:O,accessibilityLayer:E})}),ot(j,"renderBrush",function(_){var S=j.props,C=S.margin,E=S.data,k=j.state,P=k.offset,A=k.dataStartIndex,O=k.dataEndIndex,I=k.updateId;return w.cloneElement(_,{key:_.key||"_recharts-brush",onChange:yb(j.handleBrushChange,_.props.onChange),data:E,x:Te(_.props.x)?_.props.x:P.left,y:Te(_.props.y)?_.props.y:P.top+P.height+P.brushBottom-(C.bottom||0),width:Te(_.props.width)?_.props.width:P.width,startIndex:A,endIndex:O,updateId:"brush-".concat(I)})}),ot(j,"renderReferenceElement",function(_,S,C){if(!_)return null;var E=j,k=E.clipPathId,P=j.state,A=P.xAxisMap,O=P.yAxisMap,I=P.offset,R=_.type.defaultProps||{},M=_.props,B=M.xAxisId,$=B===void 0?R.xAxisId:B,D=M.yAxisId,W=D===void 0?R.yAxisId:D;return w.cloneElement(_,{key:_.key||"".concat(S,"-").concat(C),xAxis:A[$],yAxis:O[W],viewBox:{x:I.left,y:I.top,width:I.width,height:I.height},clipPathId:k})}),ot(j,"renderActivePoints",function(_){var S=_.item,C=_.activePoint,E=_.basePoint,k=_.childIndex,P=_.isRange,A=[],O=S.props.key,I=S.item.type.defaultProps!==void 0?pe(pe({},S.item.type.defaultProps),S.item.props):S.item.props,R=I.activeDot,M=I.dataKey,B=pe(pe({index:k,dataKey:M,cx:C.x,cy:C.y,r:4,fill:uI(S.item),strokeWidth:2,stroke:"#fff",payload:C.payload,value:C.value},Ct(R,!1)),yw(R));return A.push(x.renderActiveDot(R,B,"".concat(O,"-activePoint-").concat(k))),E?A.push(x.renderActiveDot(R,pe(pe({},B),{},{cx:E.x,cy:E.y}),"".concat(O,"-basePoint-").concat(k))):P&&A.push(null),A}),ot(j,"renderGraphicChild",function(_,S,C){var E=j.filterFormatItem(_,S,C);if(!E)return null;var k=j.getTooltipEventType(),P=j.state,A=P.isTooltipActive,O=P.tooltipAxis,I=P.activeTooltipIndex,R=P.activeLabel,M=j.props.children,B=ys(M,lo),$=E.props,D=$.points,W=$.isRange,Z=$.baseLine,U=E.item.type.defaultProps!==void 0?pe(pe({},E.item.type.defaultProps),E.item.props):E.item.props,Y=U.activeDot,ae=U.hide,ie=U.activeBar,he=U.activeShape,se=!!(!ae&&A&&B&&(Y||ie||he)),ye={};k!=="axis"&&B&&B.props.trigger==="click"?ye={onClick:yb(j.handleItemMouseEnter,_.props.onClick)}:k!=="axis"&&(ye={onMouseLeave:yb(j.handleItemMouseLeave,_.props.onMouseLeave),onMouseEnter:yb(j.handleItemMouseEnter,_.props.onMouseEnter)});var ne=w.cloneElement(_,pe(pe({},E.props),ye));function le(ce){return typeof O.dataKey=="function"?O.dataKey(ce.payload):null}if(se)if(I>=0){var ve,K;if(O.dataKey&&!O.allowDuplicatedCategory){var ke=typeof O.dataKey=="function"?le:"payload.".concat(O.dataKey.toString());ve=xw(D,ke,R),K=W&&Z&&xw(Z,ke,R)}else ve=D==null?void 0:D[I],K=W&&Z&&Z[I];if(he||ie){var Ce=_.props.activeIndex!==void 0?_.props.activeIndex:I;return[w.cloneElement(_,pe(pe(pe({},E.props),ye),{},{activeIndex:Ce})),null,null]}if(!Ot(ve))return[ne].concat(Cp(j.renderActivePoints({item:E,activePoint:ve,basePoint:K,childIndex:I,isRange:W})))}else{var Ge,He=(Ge=j.getItemByXY(j.state.activeCoordinate))!==null&&Ge!==void 0?Ge:{graphicalItem:ne},It=He.graphicalItem,ar=It.item,Kt=ar===void 0?_:ar,G=It.childIndex,te=pe(pe(pe({},E.props),ye),{},{activeIndex:G});return[w.cloneElement(Kt,te),null,null]}return W?[ne,null,null]:[ne,null]}),ot(j,"renderCustomized",function(_,S,C){return w.cloneElement(_,pe(pe({key:"recharts-customized-".concat(C)},j.props),j.state))}),ot(j,"renderMap",{CartesianGrid:{handler:_b,once:!0},ReferenceArea:{handler:j.renderReferenceElement},ReferenceLine:{handler:_b},ReferenceDot:{handler:j.renderReferenceElement},XAxis:{handler:_b},YAxis:{handler:_b},Brush:{handler:j.renderBrush,once:!0},Bar:{handler:j.renderGraphicChild},Line:{handler:j.renderGraphicChild},Area:{handler:j.renderGraphicChild},Radar:{handler:j.renderGraphicChild},RadialBar:{handler:j.renderGraphicChild},Scatter:{handler:j.renderGraphicChild},Pie:{handler:j.renderGraphicChild},Funnel:{handler:j.renderGraphicChild},Tooltip:{handler:j.renderCursor,once:!0},PolarGrid:{handler:j.renderPolarGrid,once:!0},PolarAngleAxis:{handler:j.renderPolarAxis},PolarRadiusAxis:{handler:j.renderPolarAxis},Customized:{handler:j.renderCustomized}}),j.clipPathId="".concat((b=y.id)!==null&&b!==void 0?b:um("recharts"),"-clip"),j.throttleTriggeredAfterMouseMove=IK(j.triggeredAfterMouseMove,(N=y.throttleDelay)!==null&&N!==void 0?N:1e3/60),j.state={},j}return i8e(x,g),r8e(x,[{key:"componentDidMount",value:function(){var b,N;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(N=this.props.margin.top)!==null&&N!==void 0?N:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,N=b.children,j=b.data,_=b.height,S=b.layout,C=ys(N,lo);if(C){var E=C.props.defaultIndex;if(!(typeof E!="number"||E<0||E>this.state.tooltipTicks.length-1)){var k=this.state.tooltipTicks[E]&&this.state.tooltipTicks[E].value,P=pA(this.state,j,E,k),A=this.state.tooltipTicks[E].coordinate,O=(this.state.offset.top+_)/2,I=S==="horizontal",R=I?{x:A,y:O}:{y:A,x:O},M=this.state.formattedGraphicalItems.find(function($){var D=$.item;return D.type.name==="Scatter"});M&&(R=pe(pe({},R),M.props.points[E].tooltipPosition),P=M.props.points[E].tooltipPayload);var B={activeTooltipIndex:E,isTooltipActive:!0,activeLabel:k,activePayload:P,activeCoordinate:R};this.setState(B),this.renderCursor(C),this.accessibilityManager.setIndex(E)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,N){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==N.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var j,_;this.accessibilityManager.setDetails({offset:{left:(j=this.props.margin.left)!==null&&j!==void 0?j:0,top:(_=this.props.margin.top)!==null&&_!==void 0?_:0}})}return null}},{key:"componentDidUpdate",value:function(b){GE([ys(b.children,lo)],[ys(this.props.children,lo)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=ys(this.props.children,lo);if(b&&typeof b.props.shared=="boolean"){var N=b.props.shared?"axis":"item";return l.indexOf(N)>=0?N:i}return i}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var N=this.container,j=N.getBoundingClientRect(),_=qIe(j),S={chartX:Math.round(b.pageX-_.left),chartY:Math.round(b.pageY-_.top)},C=j.width/N.offsetWidth||1,E=this.inRange(S.chartX,S.chartY,C);if(!E)return null;var k=this.state,P=k.xAxisMap,A=k.yAxisMap,O=this.getTooltipEventType(),I=qL(this.state,this.props.data,this.props.layout,E);if(O!=="axis"&&P&&A){var R=uc(P).scale,M=uc(A).scale,B=R&&R.invert?R.invert(S.chartX):null,$=M&&M.invert?M.invert(S.chartY):null;return pe(pe({},S),{},{xValue:B,yValue:$},I)}return I?pe(pe({},S),I):null}},{key:"inRange",value:function(b,N){var j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,_=this.props.layout,S=b/j,C=N/j;if(_==="horizontal"||_==="vertical"){var E=this.state.offset,k=S>=E.left&&S<=E.left+E.width&&C>=E.top&&C<=E.top+E.height;return k?{x:S,y:C}:null}var P=this.state,A=P.angleAxisMap,O=P.radiusAxisMap;if(A&&O){var I=uc(A);return _5({x:S,y:C},I)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,N=this.getTooltipEventType(),j=ys(b,lo),_={};j&&N==="axis"&&(j.props.trigger==="click"?_={onClick:this.handleClick}:_={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var S=yw(this.props,this.handleOuterEvent);return pe(pe({},S),_)}},{key:"addListener",value:function(){vS.on(gS,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){vS.removeListener(gS,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,N,j){for(var _=this.state.formattedGraphicalItems,S=0,C=_.length;S<C;S++){var E=_[S];if(E.item===b||E.props.key===b.key||N===pl(E.item.type)&&j===E.childIndex)return E}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,N=this.state.offset,j=N.left,_=N.top,S=N.height,C=N.width;return F.createElement("defs",null,F.createElement("clipPath",{id:b},F.createElement("rect",{x:j,y:_,height:S,width:C})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(N,j){var _=VL(j,2),S=_[0],C=_[1];return pe(pe({},N),{},ot({},S,C.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(N,j){var _=VL(j,2),S=_[0],C=_[1];return pe(pe({},N),{},ot({},S,C.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var N;return(N=this.state.xAxisMap)===null||N===void 0||(N=N[b])===null||N===void 0?void 0:N.scale}},{key:"getYScaleByAxisId",value:function(b){var N;return(N=this.state.yAxisMap)===null||N===void 0||(N=N[b])===null||N===void 0?void 0:N.scale}},{key:"getItemByXY",value:function(b){var N=this.state,j=N.formattedGraphicalItems,_=N.activeItem;if(j&&j.length)for(var S=0,C=j.length;S<C;S++){var E=j[S],k=E.props,P=E.item,A=P.type.defaultProps!==void 0?pe(pe({},P.type.defaultProps),P.props):P.props,O=pl(P.type);if(O==="Bar"){var I=(k.data||[]).find(function($){return ELe(b,$)});if(I)return{graphicalItem:E,payload:I}}else if(O==="RadialBar"){var R=(k.data||[]).find(function($){return _5(b,$)});if(R)return{graphicalItem:E,payload:R}}else if(UN(E,_)||VN(E,_)||tx(E,_)){var M=PBe({graphicalItem:E,activeTooltipItem:_,itemData:A.data}),B=A.activeIndex===void 0?M:A.activeIndex;return{graphicalItem:pe(pe({},E),{},{childIndex:B}),payload:tx(E,_)?A.data[M]:E.props.data[M]}}}return null}},{key:"render",value:function(){var b=this;if(!m$(this))return null;var N=this.props,j=N.children,_=N.className,S=N.width,C=N.height,E=N.style,k=N.compact,P=N.title,A=N.desc,O=zL(N,Yze),I=Ct(O,!1);if(k)return F.createElement(jL,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},F.createElement(KE,nf({},I,{width:S,height:C,title:P,desc:A}),this.renderClipPath(),g$(j,this.renderMap)));if(this.props.accessibilityLayer){var R,M;I.tabIndex=(R=this.props.tabIndex)!==null&&R!==void 0?R:0,I.role=(M=this.props.role)!==null&&M!==void 0?M:"application",I.onKeyDown=function($){b.accessibilityManager.keyboardEvent($)},I.onFocus=function(){b.accessibilityManager.focus()}}var B=this.parseEventsOfWrapper();return F.createElement(jL,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},F.createElement("div",nf({className:Ut("recharts-wrapper",_),style:pe({position:"relative",cursor:"default",width:S,height:C},E)},B,{ref:function(D){b.container=D}}),F.createElement(KE,nf({},I,{width:S,height:C,title:P,desc:A,style:h8e}),this.renderClipPath(),g$(j,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(w.Component);ot(m,"displayName",r),ot(m,"defaultProps",pe({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},h)),ot(m,"getDerivedStateFromProps",function(g,x){var y=g.dataKey,b=g.data,N=g.children,j=g.width,_=g.height,S=g.layout,C=g.stackOffset,E=g.margin,k=x.dataStartIndex,P=x.dataEndIndex;if(x.updateId===void 0){var A=GL(g);return pe(pe(pe({},A),{},{updateId:0},p(pe(pe({props:g},A),{},{updateId:0}),x)),{},{prevDataKey:y,prevData:b,prevWidth:j,prevHeight:_,prevLayout:S,prevStackOffset:C,prevMargin:E,prevChildren:N})}if(y!==x.prevDataKey||b!==x.prevData||j!==x.prevWidth||_!==x.prevHeight||S!==x.prevLayout||C!==x.prevStackOffset||!Sf(E,x.prevMargin)){var O=GL(g),I={chartX:x.chartX,chartY:x.chartY,isTooltipActive:x.isTooltipActive},R=pe(pe({},qL(x,b,S)),{},{updateId:x.updateId+1}),M=pe(pe(pe({},O),I),R);return pe(pe(pe({},M),p(pe({props:g},M),x)),{},{prevDataKey:y,prevData:b,prevWidth:j,prevHeight:_,prevLayout:S,prevStackOffset:C,prevMargin:E,prevChildren:N})}if(!GE(N,x.prevChildren)){var B,$,D,W,Z=ys(N,mp),U=Z&&(B=($=Z.props)===null||$===void 0?void 0:$.startIndex)!==null&&B!==void 0?B:k,Y=Z&&(D=(W=Z.props)===null||W===void 0?void 0:W.endIndex)!==null&&D!==void 0?D:P,ae=U!==k||Y!==P,ie=!Ot(b),he=ie&&!ae?x.updateId:x.updateId+1;return pe(pe({updateId:he},p(pe(pe({props:g},x),{},{updateId:he,dataStartIndex:U,dataEndIndex:Y}),x)),{},{prevChildren:N,dataStartIndex:U,dataEndIndex:Y})}return null}),ot(m,"renderActiveDot",function(g,x,y){var b;return w.isValidElement(g)?b=w.cloneElement(g,x):bt(g)?b=g(x):b=F.createElement(BN,x),F.createElement(yr,{className:"recharts-active-dot",key:y},b)});var v=w.forwardRef(function(x,y){return F.createElement(m,nf({},x,{ref:y}))});return v.displayName=m.displayName,v},j8e=jI({chartName:"LineChart",GraphicalChild:bd,axisComponents:[{axisType:"xAxis",AxisComp:wu},{axisType:"yAxis",AxisComp:ju}],formatAxisMap:hI}),N8e=jI({chartName:"BarChart",GraphicalChild:xl,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:wu},{axisType:"yAxis",AxisComp:ju}],formatAxisMap:hI}),_8e=jI({chartName:"AreaChart",GraphicalChild:bu,axisComponents:[{axisType:"xAxis",AxisComp:wu},{axisType:"yAxis",AxisComp:ju}],formatAxisMap:hI});const S8e={light:"",dark:".dark"},XX=w.createContext(null);function QX(){const e=w.useContext(XX);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const XN=w.forwardRef(({id:e,className:t,children:r,config:n,...a},i)=>{const o=w.useId(),l=`chart-${e||o.replace(/:/g,"")}`;return s.jsx(XX.Provider,{value:{config:n},children:s.jsxs("div",{"data-chart":l,ref:i,className:me("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",t),...a,children:[s.jsx(C8e,{id:l,config:n}),s.jsx(FIe,{children:r})]})})});XN.displayName="Chart";const C8e=({id:e,config:t})=>{const r=Object.entries(t).filter(([n,a])=>a.theme||a.color);return r.length?s.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(S8e).map(([n,a])=>`
${a} [data-chart=${e}] {
${r.map(([i,o])=>{var c;const l=((c=o.theme)==null?void 0:c[n])||o.color;return l?`  --color-${i}: ${l};`:null}).join(`
`)}
}
`).join(`
`)}}):null},NI=lo,QN=w.forwardRef(({active:e,payload:t,className:r,indicator:n="dot",hideLabel:a=!1,hideIndicator:i=!1,label:o,labelFormatter:l,labelClassName:c,formatter:u,color:d,nameKey:h,labelKey:f},p)=>{const{config:m}=QX(),v=w.useMemo(()=>{var j;if(a||!(t!=null&&t.length))return null;const[x]=t,y=`${f||x.dataKey||x.name||"value"}`,b=mA(m,x,y),N=!f&&typeof o=="string"?((j=m[o])==null?void 0:j.label)||o:b==null?void 0:b.label;return l?s.jsx("div",{className:me("font-medium",c),children:l(N,t)}):N?s.jsx("div",{className:me("font-medium",c),children:N}):null},[o,l,t,a,c,m,f]);if(!e||!(t!=null&&t.length))return null;const g=t.length===1&&n!=="dot";return s.jsxs("div",{ref:p,className:me("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",r),children:[g?null:v,s.jsx("div",{className:"grid gap-1.5",children:t.map((x,y)=>{const b=`${h||x.name||x.dataKey||"value"}`,N=mA(m,x,b),j=d||x.payload.fill||x.color;return s.jsx("div",{className:me("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",n==="dot"&&"items-center"),children:u&&(x==null?void 0:x.value)!==void 0&&x.name?u(x.value,x.name,x,y,x.payload):s.jsxs(s.Fragment,{children:[N!=null&&N.icon?s.jsx(N.icon,{}):!i&&s.jsx("div",{className:me("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":n==="dot","w-1":n==="line","w-0 border-[1.5px] border-dashed bg-transparent":n==="dashed","my-0.5":g&&n==="dashed"}),style:{"--color-bg":j,"--color-border":j}}),s.jsxs("div",{className:me("flex flex-1 justify-between leading-none",g?"items-end":"items-center"),children:[s.jsxs("div",{className:"grid gap-1.5",children:[g?v:null,s.jsx("span",{className:"text-muted-foreground",children:(N==null?void 0:N.label)||x.name})]}),x.value&&s.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:x.value.toLocaleString()})]})]})},x.dataKey)})})]})});QN.displayName="ChartTooltip";const E8e=w.forwardRef(({className:e,hideIcon:t=!1,payload:r,verticalAlign:n="bottom",nameKey:a},i)=>{const{config:o}=QX();return r!=null&&r.length?s.jsx("div",{ref:i,className:me("flex items-center justify-center gap-4",n==="top"?"pb-3":"pt-3",e),children:r.map(l=>{const c=`${a||l.dataKey||"value"}`,u=mA(o,l,c);return s.jsxs("div",{className:me("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[u!=null&&u.icon&&!t?s.jsx(u.icon,{}):s.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:l.color}}),u==null?void 0:u.label]},l.value)})}):null});E8e.displayName="ChartLegend";function mA(e,t,r){if(typeof t!="object"||t===null)return;const n="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let a=r;return r in t&&typeof t[r]=="string"?a=t[r]:n&&r in n&&typeof n[r]=="string"&&(a=n[r]),a in e?e[a]:e[r]}function k8e({businessId:e}){const{toast:t}=Et(),[r,n]=w.useState([]),[a,i]=w.useState(!0);w.useEffect(()=>{o()},[e]);const o=async()=>{try{const{data:c,error:u}=await T.from("business_employees").select("*").eq("business_id",e);if(u)throw u;const d=new Date,h=[];for(let f=5;f>=0;f--){const p=new Date(d.getFullYear(),d.getMonth()-f,1),m=p.toLocaleDateString("en-US",{month:"short"}),v=new Date(p.getFullYear(),p.getMonth(),1),g=new Date(p.getFullYear(),p.getMonth()+1,0,23,59,59),x=(c==null?void 0:c.filter(N=>N.status==="active"&&new Date(N.hired_at)<=g).length)||0,y=(c==null?void 0:c.filter(N=>N.status==="inactive"&&new Date(N.hired_at)<=g&&(!N.fired_at||new Date(N.fired_at)>g)).length)||0,b=(c==null?void 0:c.filter(N=>N.fired_at&&new Date(N.fired_at)>=v&&new Date(N.fired_at)<=g).length)||0;h.push({name:m,active:x,inactive:y,fired:b})}n(h)}catch(c){t({title:"Error",description:c.message,variant:"destructive"})}finally{i(!1)}};if(a)return s.jsx(q,{children:s.jsxs(ge,{children:[s.jsx(be,{children:"Employee Activity"}),s.jsx(Re,{children:"Loading activity data..."})]})});const l={active:{label:"Active",color:"hsl(var(--primary))"},inactive:{label:"Inactive",color:"hsl(var(--muted))"},fired:{label:"Fired",color:"hsl(var(--destructive))"}};return s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Employee Activity Over Time"}),s.jsx(Re,{children:"Monthly breakdown of employee status changes"})]}),s.jsx(ee,{children:s.jsx(XN,{config:l,className:"h-[400px]",children:s.jsxs(N8e,{data:r,children:[s.jsx(KN,{strokeDasharray:"3 3"}),s.jsx(wu,{dataKey:"name"}),s.jsx(ju,{}),s.jsx(NI,{content:s.jsx(QN,{})}),s.jsx(xl,{dataKey:"active",fill:"var(--color-active)",radius:[4,4,0,0]}),s.jsx(xl,{dataKey:"inactive",fill:"var(--color-inactive)",radius:[4,4,0,0]}),s.jsx(xl,{dataKey:"fired",fill:"var(--color-fired)",radius:[4,4,0,0]})]})})})]})}function A8e({businessId:e}){const{toast:t}=Et(),[r,n]=w.useState([]),[a,i]=w.useState(!0);w.useEffect(()=>{o()},[e]);const o=async()=>{try{const{data:c,error:u}=await T.from("business_vai_coupons").select("*").eq("business_id",e).order("created_at",{ascending:!0});if(u)throw u;const d=new Date,h=[];for(let f=5;f>=0;f--){const p=new Date(d.getFullYear(),d.getMonth()-f,1),m=p.toLocaleDateString("en-US",{month:"short"}),v=new Date(p.getFullYear(),p.getMonth(),1),g=new Date(p.getFullYear(),p.getMonth()+1,0,23,59,59),x=(c==null?void 0:c.filter(N=>{const j=new Date(N.created_at);return j>=v&&j<=g}).length)||0,y=(c==null?void 0:c.filter(N=>{const j=N.redeemed_at?new Date(N.redeemed_at):null;return j&&j>=v&&j<=g}).length)||0,b=(c==null?void 0:c.filter(N=>new Date(N.created_at)<=g&&N.status==="unused").length)||0;h.push({name:m,generated:x,redeemed:y,available:b})}n(h)}catch(c){t({title:"Error",description:c.message,variant:"destructive"})}finally{i(!1)}};if(a)return s.jsx(q,{children:s.jsxs(ge,{children:[s.jsx(be,{children:"Coupon Usage Statistics"}),s.jsx(Re,{children:"Loading coupon data..."})]})});const l={generated:{label:"Generated",color:"hsl(var(--primary))"},redeemed:{label:"Redeemed",color:"hsl(var(--chart-2))"},available:{label:"Available",color:"hsl(var(--chart-3))"}};return s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"V.A.I. Coupon Usage Over Time"}),s.jsx(Re,{children:"Track coupon generation, redemption, and availability"})]}),s.jsx(ee,{children:s.jsx(XN,{config:l,className:"h-[400px]",children:s.jsxs(j8e,{data:r,children:[s.jsx(KN,{strokeDasharray:"3 3"}),s.jsx(wu,{dataKey:"name"}),s.jsx(ju,{}),s.jsx(NI,{content:s.jsx(QN,{})}),s.jsx(bd,{type:"monotone",dataKey:"generated",stroke:"var(--color-generated)",strokeWidth:2,dot:{r:4}}),s.jsx(bd,{type:"monotone",dataKey:"redeemed",stroke:"var(--color-redeemed)",strokeWidth:2,dot:{r:4}}),s.jsx(bd,{type:"monotone",dataKey:"available",stroke:"var(--color-available)",strokeWidth:2,dot:{r:4}})]})})})]})}function P8e({businessId:e}){const{toast:t}=Et(),[r,n]=w.useState([]),[a,i]=w.useState(!0);w.useEffect(()=>{o();const u=T.channel("transactions-changes").on("postgres_changes",{event:"*",schema:"public",table:"transactions",filter:`business_id=eq.${e}`},()=>{o()}).subscribe();return()=>{T.removeChannel(u)}},[e]);const o=async()=>{try{const{data:u,error:d}=await T.from("transactions").select("amount, created_at, status").eq("business_id",e).eq("status","completed").gte("created_at",new Date(new Date().setMonth(new Date().getMonth()-6)).toISOString());if(d)throw d;const h={},f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],p=new Date;for(let v=5;v>=0;v--){const g=new Date(p.getFullYear(),p.getMonth()-v,1),x=f[g.getMonth()];h[x]=0}u==null||u.forEach(v=>{const g=new Date(v.created_at),x=f[g.getMonth()];h.hasOwnProperty(x)&&(h[x]+=Number(v.amount))});const m=Object.entries(h).map(([v,g])=>({name:v,revenue:Number(g.toFixed(2))}));n(m)}catch(u){t({title:"Error loading revenue data",description:u.message,variant:"destructive"})}finally{i(!1)}},l={revenue:{label:"Revenue",color:"hsl(var(--chart-1))"}};if(a)return s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Revenue Tracking"}),s.jsx(Re,{children:"Loading revenue data..."})]}),s.jsx(ee,{children:s.jsx("div",{className:"h-[400px] flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]});const c=r.reduce((u,d)=>u+d.revenue,0);return s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Revenue Tracking"}),s.jsxs(Re,{children:["Last 6 months  Total: $",c.toFixed(2)]})]}),s.jsx(ee,{children:s.jsx(XN,{config:l,className:"h-[400px]",children:s.jsxs(_8e,{data:r,children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"colorRevenue",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"var(--color-revenue)",stopOpacity:.3}),s.jsx("stop",{offset:"95%",stopColor:"var(--color-revenue)",stopOpacity:0})]})}),s.jsx(KN,{strokeDasharray:"3 3"}),s.jsx(wu,{dataKey:"name"}),s.jsx(ju,{}),s.jsx(NI,{content:s.jsx(QN,{})}),s.jsx(bu,{type:"monotone",dataKey:"revenue",stroke:"var(--color-revenue)",fillOpacity:1,fill:"url(#colorRevenue)"})]})})})]})}function T8e(){const{businessId:e}=us(),t=Oe(),{toast:r}=Et(),[n,a]=w.useState(null),[i,o]=w.useState({totalEmployees:0,activeEmployees:0,totalCoupons:0,usedCoupons:0,availableCoupons:0,totalRevenue:0,monthlyRevenue:0}),[l,c]=w.useState(!0);w.useEffect(()=>{u()},[e]);const u=async()=>{try{const{data:d,error:h}=await T.from("businesses").select("*").eq("id",e).single();if(h)throw h;a(d);const{data:f,error:p}=await T.from("business_employees").select("*").eq("business_id",e);if(p)throw p;const m=(f==null?void 0:f.filter(C=>C.status==="active").length)||0,{data:v,error:g}=await T.from("business_vai_coupons").select("*").eq("business_id",e);if(g)throw g;const x=(v==null?void 0:v.filter(C=>C.status==="used").length)||0,y=(v==null?void 0:v.filter(C=>C.status==="unused").length)||0,{data:b,error:N}=await T.from("transactions").select("amount, created_at, status").eq("business_id",e).eq("status","completed");if(N)throw N;const j=(b==null?void 0:b.reduce((C,E)=>C+Number(E.amount),0))||0,_=new Date;_.setDate(1),_.setHours(0,0,0,0);const S=(b==null?void 0:b.filter(C=>new Date(C.created_at)>=_).reduce((C,E)=>C+Number(E.amount),0))||0;o({totalEmployees:(f==null?void 0:f.length)||0,activeEmployees:m,totalCoupons:(v==null?void 0:v.length)||0,usedCoupons:x,availableCoupons:y,totalRevenue:j,monthlyRevenue:S})}catch(d){r({title:"Error",description:d.message,variant:"destructive"}),t("/")}finally{c(!1)}};return l?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading dashboard..."})]})}):n?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"sticky top-0 z-10 border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:s.jsxs("div",{className:"container flex h-16 items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>t(-1),children:s.jsx(ze,{className:"h-5 w-5"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(_o,{className:"h-5 w-5 text-primary"}),s.jsxs("h1",{className:"text-lg font-semibold",children:[n.business_name," Dashboard"]})]})]})}),s.jsxs("main",{className:"container py-8 space-y-8",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[s.jsxs(q,{children:[s.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(be,{className:"text-sm font-medium",children:"Total Employees"}),s.jsx(An,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(ee,{children:[s.jsx("div",{className:"text-2xl font-bold",children:i.totalEmployees}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.activeEmployees," active"]})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(be,{className:"text-sm font-medium",children:"Available Coupons"}),s.jsx(hT,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(ee,{children:[s.jsx("div",{className:"text-2xl font-bold",children:i.availableCoupons}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.usedCoupons," used"]})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(be,{className:"text-sm font-medium",children:"Coupon Usage Rate"}),s.jsx(en,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(ee,{children:[s.jsxs("div",{className:"text-2xl font-bold",children:[i.totalCoupons>0?Math.round(i.usedCoupons/i.totalCoupons*100):0,"%"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"of total coupons"})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(be,{className:"text-sm font-medium",children:"Total Revenue"}),s.jsx(en,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(ee,{children:[s.jsxs("div",{className:"text-2xl font-bold",children:["$",i.totalRevenue.toFixed(2)]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",i.monthlyRevenue.toFixed(2)," this month"]})]})]})]}),s.jsxs(Ga,{defaultValue:"activity",className:"space-y-6",children:[s.jsxs(Aa,{children:[s.jsx(mt,{value:"activity",children:"Employee Activity"}),s.jsx(mt,{value:"coupons",children:"Coupon Usage"}),s.jsx(mt,{value:"revenue",children:"Revenue"})]}),s.jsx(Rt,{value:"activity",className:"space-y-4",children:s.jsx(k8e,{businessId:e})}),s.jsx(Rt,{value:"coupons",className:"space-y-4",children:s.jsx(A8e,{businessId:e})}),s.jsx(Rt,{value:"revenue",className:"space-y-4",children:s.jsx(P8e,{businessId:e})})]})]})]}):null}function R8e({businessId:e}){const{toast:t}=Et(),[r,n]=w.useState([]),[a,i]=w.useState(!0),[o,l]=w.useState(null),[c,u]=w.useState(!1),[d,h]=w.useState(1),[f,p]=w.useState(!1);w.useEffect(()=>{m()},[e]);const m=async()=>{try{const{data:b,error:N}=await T.from("business_vai_coupons").select("*").eq("business_id",e).order("created_at",{ascending:!1});if(N)throw N;n(b||[])}catch(b){t({title:"Error",description:b.message,variant:"destructive"})}finally{i(!1)}},v=b=>{navigator.clipboard.writeText(b),l(b),setTimeout(()=>l(null),2e3),t({title:"Copied!",description:"Coupon code copied to clipboard"})},g=async()=>{p(!0);try{const b=Array.from({length:d},async()=>{const{data:N}=await T.rpc("generate_vai_coupon_code");return T.from("business_vai_coupons").insert({business_id:e,coupon_code:N})});await Promise.all(b),t({title:"Success!",description:`Generated ${d} new V.A.I. coupon${d>1?"s":""}`}),u(!1),h(1),m()}catch(b){t({title:"Error",description:b.message,variant:"destructive"})}finally{p(!1)}},x=r.filter(b=>b.status==="unused").length,y=r.filter(b=>b.status==="used").length;return a?s.jsx("div",{className:"text-center py-8",children:"Loading coupons..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"V.A.I. Coupon Overview"}),s.jsx(Re,{children:"Manage employee V.A.I. coupons for your business"})]}),s.jsx(ee,{children:s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-primary",children:x}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Available"})]}),s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:y}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Used"})]})]})})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Coupon Codes"}),s.jsxs(Ca,{open:c,onOpenChange:u,children:[s.jsx(Xj,{asChild:!0,children:s.jsxs(L,{children:[s.jsx(Ms,{className:"h-4 w-4 mr-2"}),"Get More V.A.I.s"]})}),s.jsxs(oa,{children:[s.jsxs(Ea,{children:[s.jsx(ka,{children:"Purchase V.A.I. Coupons"}),s.jsx(pu,{children:"Generate additional V.A.I. coupons for your employees"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"quantity",children:"Quantity"}),s.jsx(De,{id:"quantity",type:"number",min:"1",max:"50",value:d,onChange:b=>h(parseInt(b.target.value)||1)})]}),s.jsx(L,{onClick:g,disabled:f,className:"w-full",children:f?"Generating...":`Generate ${d} Coupon${d>1?"s":""}`})]})]})]})]}),s.jsx("div",{className:"grid gap-4",children:r.map(b=>s.jsx(q,{children:s.jsxs(ee,{className:"flex items-center justify-between p-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-mono font-semibold text-lg",children:b.coupon_code}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:["Created ",new Date(b.created_at).toLocaleDateString()]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(xe,{variant:b.status==="unused"?"default":"secondary",children:b.status}),s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>v(b.coupon_code),children:o===b.coupon_code?s.jsx($t,{className:"h-4 w-4 text-green-600"}):s.jsx(sg,{className:"h-4 w-4"})})]})]})},b.id))})]})}const O8e=e=>({emerald:{bg:"bg-emerald-100",darkBg:"dark:bg-emerald-900/30",text:"text-emerald-800",darkText:"dark:text-emerald-200",border:"border-emerald-300",darkBorder:"dark:border-emerald-700"},blue:{bg:"bg-blue-100",darkBg:"dark:bg-blue-900/30",text:"text-blue-800",darkText:"dark:text-blue-200",border:"border-blue-300",darkBorder:"dark:border-blue-700"},purple:{bg:"bg-purple-100",darkBg:"dark:bg-purple-900/30",text:"text-purple-800",darkText:"dark:text-purple-200",border:"border-purple-300",darkBorder:"dark:border-purple-700"},pink:{bg:"bg-pink-100",darkBg:"dark:bg-pink-900/30",text:"text-pink-800",darkText:"dark:text-pink-200",border:"border-pink-300",darkBorder:"dark:border-pink-700"},orange:{bg:"bg-orange-100",darkBg:"dark:bg-orange-900/30",text:"text-orange-800",darkText:"dark:text-orange-200",border:"border-orange-300",darkBorder:"dark:border-orange-700"},red:{bg:"bg-red-100",darkBg:"dark:bg-red-900/30",text:"text-red-800",darkText:"dark:text-red-200",border:"border-red-300",darkBorder:"dark:border-red-700"},cyan:{bg:"bg-cyan-100",darkBg:"dark:bg-cyan-900/30",text:"text-cyan-800",darkText:"dark:text-cyan-200",border:"border-cyan-300",darkBorder:"dark:border-cyan-700"},amber:{bg:"bg-amber-100",darkBg:"dark:bg-amber-900/30",text:"text-amber-800",darkText:"dark:text-amber-200",border:"border-amber-300",darkBorder:"dark:border-amber-700"},indigo:{bg:"bg-indigo-100",darkBg:"dark:bg-indigo-900/30",text:"text-indigo-800",darkText:"dark:text-indigo-200",border:"border-indigo-300",darkBorder:"dark:border-indigo-700"},rose:{bg:"bg-rose-100",darkBg:"dark:bg-rose-900/30",text:"text-rose-800",darkText:"dark:text-rose-200",border:"border-rose-300",darkBorder:"dark:border-rose-700"},teal:{bg:"bg-teal-100",darkBg:"dark:bg-teal-900/30",text:"text-teal-800",darkText:"dark:text-teal-200",border:"border-teal-300",darkBorder:"dark:border-teal-700"},lime:{bg:"bg-lime-100",darkBg:"dark:bg-lime-900/30",text:"text-lime-800",darkText:"dark:text-lime-200",border:"border-lime-300",darkBorder:"dark:border-lime-700"}})[e],I8e=e=>{const t=["emerald","blue","purple","pink","orange","red","cyan","amber","indigo","rose","teal","lime"];let r=0;for(let n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r=r&r;return t[Math.abs(r)%t.length]},_I=({vaiNumber:e,colorScheme:t,size:r="md",className:n,showPrefix:a=!0})=>{const i=t||I8e(e),o=O8e(i),l={sm:"px-2.5 py-1 text-xs",md:"px-3 py-1.5 text-sm",lg:"px-4 py-2 text-base"};return s.jsxs(xe,{variant:"outline",className:me(o.bg,o.darkBg,o.text,o.darkText,o.border,o.darkBorder,"font-mono font-bold",l[r],n),children:[a&&s.jsx("span",{className:"mr-1",children:"V.A.I."}),e]})},D8e=({open:e,onOpenChange:t,employee:r,onUpdate:n})=>{var h;const a=r.feature_permissions,[i,o]=w.useState(!1),[l,c]=w.useState({calendar:(a==null?void 0:a.calendar)||"business_managed",vairipay:(a==null?void 0:a.vairipay)||"business_managed",dateguard:(a==null?void 0:a.dateguard)||"employee_managed",chats:(a==null?void 0:a.chats)!==!1}),u=async()=>{o(!0);try{const{error:f}=await T.from("business_employees").update({feature_permissions:l,updated_at:new Date().toISOString()}).eq("id",r.id);if(f)throw f;H.success("Permissions updated successfully"),n(),t(!1)}catch(f){console.error("Error updating permissions:",f),H.error("Failed to update permissions")}finally{o(!1)}},d=({icon:f,title:p,description:m,value:v,onChange:g})=>s.jsx(q,{children:s.jsxs(ee,{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0",children:s.jsx(f,{className:"h-5 w-5 text-primary"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold",children:p}),s.jsx("p",{className:"text-sm text-muted-foreground",children:m})]})]}),s.jsxs(nm,{value:v,onValueChange:x=>g(x),children:[s.jsxs("div",{className:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-accent/50 transition-colors",children:[s.jsx(Ts,{value:"business_managed",id:`${p}-business`,className:"mt-0.5"}),s.jsxs(de,{htmlFor:`${p}-business`,className:"flex-1 cursor-pointer",children:[s.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[s.jsx(_o,{className:"h-4 w-4"}),"Business Managed"]}),s.jsx("p",{className:"text-sm text-muted-foreground font-normal mt-1",children:"You control this feature centrally for the employee"})]})]}),s.jsxs("div",{className:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-accent/50 transition-colors",children:[s.jsx(Ts,{value:"employee_managed",id:`${p}-employee`,className:"mt-0.5"}),s.jsxs(de,{htmlFor:`${p}-employee`,className:"flex-1 cursor-pointer",children:[s.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[s.jsx(fn,{className:"h-4 w-4"}),"Employee Managed"]}),s.jsx("p",{className:"text-sm text-muted-foreground font-normal mt-1",children:"Employee has full control over their own settings"})]})]})]})]})});return s.jsx(Ca,{open:e,onOpenChange:t,children:s.jsxs(oa,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(Ea,{children:[s.jsx(ka,{children:"Manage Employee Permissions"}),s.jsxs(pu,{children:["Configure who manages each feature for ",(h=r.profiles)==null?void 0:h.full_name]})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsx(d,{icon:Yn,title:"Calendar & Availability",description:"Control who manages appointment scheduling and availability settings",value:l.calendar,onChange:f=>c({...l,calendar:f})}),s.jsx(d,{icon:Wi,title:"Vairipay (Payment Management)",description:"Control who handles payment methods and transaction settings",value:l.vairipay,onChange:f=>c({...l,vairipay:f})}),s.jsx(d,{icon:lt,title:"DateGuard (Safety & Guardians)",description:"Control who manages guardian groups and safety protocols",value:l.dateguard,onChange:f=>c({...l,dateguard:f})})]}),s.jsxs(Hx,{children:[s.jsx(L,{variant:"outline",onClick:()=>t(!1),disabled:i,children:"Cancel"}),s.jsx(L,{onClick:u,disabled:i,children:i?"Saving...":"Save Changes"})]})]})})};function M8e({businessId:e}){const{toast:t}=Et(),[r,n]=w.useState([]),[a,i]=w.useState(!0),[o,l]=w.useState(null),[c,u]=w.useState(!1);w.useEffect(()=>{d()},[e]);const d=async()=>{try{const{data:v,error:g}=await T.from("business_employees").select(`
          *,
          profiles:employee_user_id(full_name),
          businesses!inner(business_name)
        `).eq("business_id",e).order("hired_at",{ascending:!1});if(g)throw g;n(v||[])}catch(v){t({title:"Error",description:v.message,variant:"destructive"})}finally{i(!1)}},h=async v=>{try{const{error:g}=await T.from("business_employees").update({is_visible_in_directory:!v.is_visible_in_directory}).eq("id",v.id);if(g)throw g;t({title:"Updated",description:`Employee ${v.is_visible_in_directory?"hidden from":"shown in"} directory`}),d()}catch(g){t({title:"Error",description:g.message,variant:"destructive"})}},f=async v=>{if(confirm("Are you sure you want to fire this employee?"))try{const{error:g}=await T.from("business_employees").update({status:"fired",fired_at:new Date().toISOString()}).eq("id",v.id);if(g)throw g;t({title:"Employee Fired",description:"Employee status updated"}),d()}catch(g){t({title:"Error",description:g.message,variant:"destructive"})}},p=r.filter(v=>v.status==="active").length,m=r.filter(v=>v.status==="fired").length;return a?s.jsx("div",{className:"text-center py-8",children:"Loading employees..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(q,{children:s.jsx(ee,{className:"pt-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-primary",children:p}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Active"})]})})}),s.jsx(q,{children:s.jsx(ee,{className:"pt-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold",children:m}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Fired"})]})})})]}),s.jsx("div",{className:"grid gap-4",children:r.map(v=>{var g;return s.jsx(q,{children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(_I,{vaiNumber:v.business_vai_number,size:"sm",showPrefix:!1}),s.jsx("span",{className:"text-sm font-medium",children:(g=v.profiles)==null?void 0:g.full_name}),s.jsx(xe,{variant:v.status==="active"?"default":"secondary",children:v.status}),v.status==="active"&&s.jsx(xe,{variant:v.availability_status==="available"?"default":"outline",children:v.availability_status})]}),v.businesses&&s.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:["Linked to: ",s.jsx("span",{className:"font-medium",children:v.businesses.business_name})]}),s.jsx("div",{className:"text-sm text-muted-foreground mt-2",children:s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs(xe,{variant:"outline",className:"text-xs",children:[s.jsx(Yn,{className:"h-3 w-3 mr-1"}),"Calendar: ",v.feature_permissions.calendar==="business_managed"?s.jsxs(s.Fragment,{children:[s.jsx(_o,{className:"h-3 w-3 ml-1 inline"})," Business"]}):s.jsxs(s.Fragment,{children:[s.jsx(fn,{className:"h-3 w-3 ml-1 inline"})," Employee"]})]}),s.jsxs(xe,{variant:"outline",className:"text-xs",children:[s.jsx(Wi,{className:"h-3 w-3 mr-1"}),"Vairipay: ",v.feature_permissions.vairipay==="business_managed"?s.jsxs(s.Fragment,{children:[s.jsx(_o,{className:"h-3 w-3 ml-1 inline"})," Business"]}):s.jsxs(s.Fragment,{children:[s.jsx(fn,{className:"h-3 w-3 ml-1 inline"})," Employee"]})]}),s.jsxs(xe,{variant:"outline",className:"text-xs",children:[s.jsx(lt,{className:"h-3 w-3 mr-1"}),"DateGuard: ",v.feature_permissions.dateguard==="business_managed"?s.jsxs(s.Fragment,{children:[s.jsx(_o,{className:"h-3 w-3 ml-1 inline"})," Business"]}):s.jsxs(s.Fragment,{children:[s.jsx(fn,{className:"h-3 w-3 ml-1 inline"})," Employee"]})]})]})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[v.status==="active"&&s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>h(v),children:v.is_visible_in_directory?s.jsx(Ri,{className:"h-4 w-4"}):s.jsx(P0,{className:"h-4 w-4"})}),s.jsxs(VH,{children:[s.jsx(zH,{asChild:!0,children:s.jsx(L,{variant:"ghost",size:"icon",children:s.jsx(sae,{className:"h-4 w-4"})})}),s.jsxs(JR,{align:"end",children:[s.jsx(Xu,{onClick:()=>{l(v),u(!0)},children:"Manage Permissions"}),v.status==="active"&&s.jsxs(s.Fragment,{children:[s.jsx(mw,{}),s.jsx(Xu,{className:"text-destructive",onClick:()=>f(v),children:"Fire Employee"})]})]})]})]})]})})},v.id)})}),o&&s.jsx(D8e,{open:c,onOpenChange:u,employee:o,onUpdate:d})]})}function $8e(){const{businessId:e}=us(),t=Oe(),{toast:r}=Et(),[n,a]=w.useState(null),[i,o]=w.useState(!0);w.useEffect(()=>{l()},[e]);const l=async()=>{try{const{data:c,error:u}=await T.from("businesses").select("*").eq("id",e).single();if(u)throw u;a(c)}catch(c){r({title:"Error",description:c.message,variant:"destructive"}),t("/")}finally{o(!1)}};return i?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})}):n?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"sticky top-0 z-10 border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:s.jsxs("div",{className:"container flex h-16 items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>t(-1),children:s.jsx(ze,{className:"h-5 w-5"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(_o,{className:"h-5 w-5 text-primary"}),s.jsx("h1",{className:"text-lg font-semibold",children:n.business_name})]}),s.jsx("div",{className:"ml-auto",children:s.jsx(L,{variant:"outline",onClick:()=>t(`/business/${e}/dashboard`),children:"View Dashboard"})})]})}),s.jsx("main",{className:"container py-8",children:s.jsxs(Ga,{defaultValue:"employees",className:"space-y-6",children:[s.jsxs(Aa,{className:"grid w-full grid-cols-2 max-w-md",children:[s.jsxs(mt,{value:"employees",children:[s.jsx(An,{className:"h-4 w-4 mr-2"}),"Employees"]}),s.jsxs(mt,{value:"coupons",children:[s.jsx(hT,{className:"h-4 w-4 mr-2"}),"V.A.I. Coupons"]})]}),s.jsx(Rt,{value:"employees",children:s.jsx(M8e,{businessId:e})}),s.jsx(Rt,{value:"coupons",children:s.jsx(R8e,{businessId:e})})]})})]}):null}function F8e(){const{businessId:e}=us(),t=Oe(),{toast:r}=Et(),[n,a]=w.useState(null),[i,o]=w.useState([]),[l,c]=w.useState(!0);w.useEffect(()=>{u()},[e]);const u=async()=>{try{const{data:h,error:f}=await T.from("businesses").select("*").eq("id",e).single();if(f)throw f;a(h);const{data:p,error:m}=await T.from("business_employees").select("id, business_vai_number, availability_status").eq("business_id",e).eq("status","active").eq("is_visible_in_directory",!0);if(m)throw m;o(p||[])}catch(h){r({title:"Error",description:h.message,variant:"destructive"})}finally{c(!1)}};if(l)return s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})});if(!n)return null;const d=i.filter(h=>h.availability_status==="available").length;return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"sticky top-0 z-10 border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:s.jsxs("div",{className:"container flex h-16 items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>t(-1),children:s.jsx(ze,{className:"h-5 w-5"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(_o,{className:"h-5 w-5 text-primary"}),s.jsx("h1",{className:"text-lg font-semibold",children:"Directory"})]})]})}),s.jsxs("main",{className:"container py-8 space-y-6",children:[s.jsxs(q,{children:[s.jsx(ge,{children:s.jsx("div",{className:"flex items-start justify-between",children:s.jsxs("div",{children:[s.jsx(be,{className:"text-2xl",children:n.business_name}),s.jsx(Re,{className:"mt-2",children:s.jsx(xe,{children:n.business_type==="service"?"Service Business":"Non-Service Business"})})]})})}),s.jsxs(ee,{className:"space-y-4",children:[n.description&&s.jsx("p",{className:"text-muted-foreground",children:n.description}),s.jsxs("div",{className:"grid gap-2",children:[n.address&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(hn,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{children:n.address})]}),n.phone&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Bc,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{children:n.phone})]}),n.email&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(ai,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{children:n.email})]}),n.website&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(So,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("a",{href:n.website,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:n.website})]})]})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Available Providers"}),s.jsxs(Re,{children:[d," of ",i.length," currently available"]})]}),s.jsx(ee,{children:s.jsxs("div",{className:"grid gap-3",children:[i.map(h=>s.jsx(q,{children:s.jsxs(ee,{className:"flex items-center justify-between p-4",children:[s.jsx("div",{className:"flex items-center gap-3",children:s.jsx(_I,{vaiNumber:h.business_vai_number,size:"md",showPrefix:!0})}),s.jsx(xe,{variant:h.availability_status==="available"?"default":"outline",children:h.availability_status})]})},h.id)),i.length===0&&s.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No providers currently listed"})]})})]})]})]})}function L8e(){const e=Oe(),{toast:t}=Et(),[r,n]=w.useState(null),[a,i]=w.useState(""),[o,l]=w.useState(""),[c,u]=w.useState(!1),d=async()=>{if(!a){t({title:"V.A.I. Required",description:"Please enter your V.A.I. number",variant:"destructive"});return}u(!0);try{const{data:p,error:m}=await T.from("vai_verifications").select("*").eq("vai_number",a.toUpperCase()).maybeSingle();if(m)throw m;if(!p){t({title:"V.A.I. Not Found",description:"This V.A.I. number doesn't exist in our system",variant:"destructive"});return}o?await f(p.user_id):(t({title:"V.A.I. Verified",description:"Your V.A.I. has been verified"}),e("/feed"))}catch(p){t({title:"Error",description:p.message,variant:"destructive"})}finally{u(!1)}},h=()=>{t({title:"Redirecting...",description:"You'll be redirected to complete identity verification"}),setTimeout(()=>{e("/vai-check/intro")},1500)},f=async p=>{var m;try{const{data:v,error:g}=await T.from("business_vai_coupons").select("*, businesses(id, business_name)").eq("coupon_code",o.toUpperCase()).eq("status","unused").maybeSingle();if(g)throw g;if(!v){t({title:"Invalid Coupon",description:"This coupon code is invalid or already used",variant:"destructive"});return}const{data:x}=await T.rpc("generate_business_vai_number"),{error:y}=await T.from("business_employees").insert({business_id:v.business_id,employee_user_id:p,business_vai_number:x,status:"active"});if(y)throw y;const{error:b}=await T.from("business_vai_coupons").update({status:"used",redeemed_by_user_id:p,redeemed_at:new Date().toISOString()}).eq("id",v.id);if(b)throw b;t({title:"Coupon Redeemed!",description:`You've been added to ${(m=v.businesses)==null?void 0:m.business_name}`}),e("/feed")}catch(v){t({title:"Error",description:v.message,variant:"destructive"})}};return s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:s.jsxs(q,{className:"w-full max-w-md",children:[s.jsxs(ge,{children:[s.jsx(be,{children:"V.A.I. Verification"}),s.jsx(Re,{children:"Verify your identity to continue"})]}),s.jsxs(ee,{className:"space-y-6",children:[r===null&&s.jsxs("div",{className:"space-y-4",children:[s.jsx(de,{children:"Do you have a V.A.I.?"}),s.jsxs(nm,{onValueChange:p=>n(p==="yes"),children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ts,{value:"yes",id:"yes"}),s.jsx(de,{htmlFor:"yes",children:"Yes, I have a V.A.I."})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ts,{value:"no",id:"no"}),s.jsx(de,{htmlFor:"no",children:"No, I need to get verified"})]})]})]}),r===!0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"vaiNumber",children:"Your V.A.I. Number"}),s.jsx(De,{id:"vaiNumber",placeholder:"e.g., 9I7T35L",value:a,onChange:p=>i(p.target.value.toUpperCase()),maxLength:8})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"couponCode",children:"Coupon Code (Optional)"}),s.jsx(De,{id:"couponCode",placeholder:"VAI-XXXXXXXXXX",value:o,onChange:p=>l(p.target.value.toUpperCase())}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter a business coupon code if you're joining as an employee"})]}),s.jsx(L,{onClick:d,disabled:c||!a,className:"w-full",children:c?"Verifying...":"Continue"})]}),r===!1&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"You'll be redirected to complete identity verification through our secure verification partner."}),s.jsx(L,{onClick:h,className:"w-full",children:"Start Verification"})]})]})]})})}function ZX(){const e=Oe(),[t,r]=w.useState([]),[n,a]=w.useState(!0);w.useEffect(()=>{i();const o=T.channel("pending-meetings").on("postgres_changes",{event:"*",schema:"public",table:"encounters"},()=>{i()}).subscribe();return()=>{T.removeChannel(o)}},[]);const i=async()=>{try{const{data:{user:o}}=await T.auth.getUser();if(!o)return;const{data:l,error:c}=await T.from("encounters").select(`
          *,
          vai_check_sessions (
            metadata
          )
        `).or(`provider_id.eq.${o.id},client_id.eq.${o.id}`).eq("status","vairidate_pending").order("accepted_at",{ascending:!1});if(c)throw c;const u=await Promise.all((l||[]).map(async d=>{var m,v;const h=d.provider_id===o.id,f=h?d.client_id:d.provider_id,{data:p}=await T.from("profiles").select("full_name").eq("id",f).single();return{...d,metadata:(v=(m=d.vai_check_sessions)==null?void 0:m[0])==null?void 0:v.metadata,other_party_name:(p==null?void 0:p.full_name)||"Unknown",role:h?"provider":"client"}}));r(u)}catch(o){console.error("Error fetching pending meetings:",o)}finally{a(!1)}};return n?s.jsx(q,{children:s.jsx(ee,{className:"p-6",children:s.jsx("div",{className:"text-center text-muted-foreground",children:"Loading..."})})}):t.length===0?s.jsx(q,{children:s.jsx(ee,{className:"p-6",children:s.jsx("div",{className:"text-center text-muted-foreground",children:"No pending meetings"})})}):s.jsx("div",{className:"space-y-3",children:t.map(o=>s.jsx(q,{className:"hover:bg-accent/50 transition-colors",children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(fn,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{className:"font-medium",children:o.other_party_name}),s.jsx(xe,{variant:"secondary",className:"text-xs",children:o.role==="provider"?"Client Request":"Your Request"})]}),o.metadata&&s.jsxs("div",{className:"flex flex-col gap-1 text-sm text-muted-foreground",children:[o.metadata.requested_date&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Yn,{className:"w-3 h-3"}),s.jsx("span",{children:new Date(o.metadata.requested_date).toLocaleDateString()})]}),o.metadata.requested_time&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(On,{className:"w-3 h-3"}),s.jsx("span",{children:o.metadata.requested_time}),o.metadata.duration_hours&&s.jsxs("span",{children:["(",o.metadata.duration_hours,"h)"]})]})]})]}),s.jsx(L,{size:"sm",onClick:()=>e(`/vai-check/session/${o.session_id}`),children:"View"})]})})},o.id))})}function B8e(){const e=Oe(),[t,r]=w.useState(!1),[n,a]=w.useState({active:0,pending:0,setupComplete:!1});w.useEffect(()=>{i()},[]);const i=async()=>{const{data:{user:o}}=await T.auth.getUser();if(!o)return;const{data:l}=await T.from("dateguard_codes").select("id").eq("user_id",o.id).maybeSingle();r(!!l);const{data:c}=await T.from("guardians").select("status").eq("user_id",o.id),u=(c==null?void 0:c.filter(h=>h.status==="active").length)||0,d=(c==null?void 0:c.filter(h=>h.status==="pending").length)||0;a({active:u,pending:d,setupComplete:u>0})};return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[hsl(265,70%,20%)] to-[hsl(270,60%,30%)] text-white",children:[s.jsx("header",{className:"p-4 flex items-center",children:s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/feed"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})})}),s.jsxs("main",{className:"px-4 py-8 space-y-8 max-w-md mx-auto",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsxs("div",{className:"relative inline-block",children:[s.jsx("div",{className:"absolute inset-0 bg-white/20 rounded-full blur-2xl animate-pulse"}),s.jsx("div",{className:"relative w-32 h-32 mx-auto bg-gradient-to-br from-white/10 to-white/5 rounded-full flex items-center justify-center border-2 border-white/30",children:s.jsx(lt,{className:"w-16 h-16 text-white"})})]}),s.jsx("h1",{className:"text-3xl font-bold",children:"Date Guard"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h2",{className:"text-xl font-bold text-white",children:"Active Pending Meetings"}),s.jsx(ZX,{})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(q,{className:`border-white/20 hover:bg-white/15 transition-all cursor-pointer backdrop-blur-sm ${n.setupComplete?"bg-white/10":"bg-gradient-to-r from-orange-500/20 to-amber-500/20 border-amber-500/30"}`,onClick:()=>e("/dateguard/guardians"),children:s.jsx(ee,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${n.setupComplete?"bg-white/20":"bg-amber-500/30"}`,children:s.jsx(An,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("h3",{className:"font-bold text-lg text-white flex items-center gap-2",children:["My Guardians",n.setupComplete&&s.jsx(ut,{className:"w-4 h-4 text-green-400"})]}),s.jsx("p",{className:"text-sm text-white/70",children:n.active===0&&n.pending===0?"No guardians added":`${n.active} active${n.pending>0?`  ${n.pending} pending`:""}`})]}),n.setupComplete?s.jsx("div",{className:"text-xs text-green-400 font-medium",children:"Setup Complete"}):s.jsxs("div",{className:"text-xs text-amber-400 font-medium flex items-center gap-1",children:[s.jsx(tn,{className:"w-3 h-3"}),"Setup Required"]})]})})}),s.jsx(q,{className:"bg-gradient-to-r from-[hsl(188,95%,43%)] to-[hsl(188,95%,53%)] border-0 hover:shadow-lg hover:shadow-cyan-500/50 transition-all cursor-pointer",onClick:()=>e("/dateguard/activate"),children:s.jsxs(ee,{className:"p-6 flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center",children:s.jsx(vae,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-bold text-lg text-white",children:"Activate"}),s.jsx("p",{className:"text-sm text-white/90",children:"Start protection now"})]})]})}),s.jsx(q,{className:"bg-amber-500/20 border-amber-500/30 backdrop-blur-sm hover:bg-amber-500/30 transition-all cursor-pointer",onClick:()=>e("/dateguard/test-emergency"),children:s.jsxs(ee,{className:"p-4 flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-amber-500/30 rounded-full flex items-center justify-center",children:s.jsx(tn,{className:"w-5 h-5 text-amber-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-bold text-white text-sm",children:" Test Emergency"}),s.jsx("p",{className:"text-xs text-white/70",children:"Quick test session"})]})]})}),s.jsx(q,{className:`border-white/20 hover:bg-white/15 transition-all cursor-pointer backdrop-blur-sm ${t?"bg-white/10":"bg-gradient-to-r from-amber-500/20 to-orange-500/20 border-amber-500/30"}`,onClick:()=>e("/dateguard/setup/codes"),children:s.jsxs(ee,{className:"p-6 flex items-center gap-4",children:[s.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${t?"bg-white/20":"bg-amber-500/30"}`,children:s.jsx(oae,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-bold text-lg text-white",children:t?"Edit Codes":"Set Up Codes"}),s.jsx("p",{className:"text-sm text-white/70",children:t?"Deactivation & decoy codes":"Create your safety codes"})]})]})})]})]})]})}function U8e({onInvite:e}){return s.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[s.jsxs("div",{className:"relative mb-8",children:[s.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-2xl animate-pulse"}),s.jsx("div",{className:"relative w-24 h-24 bg-white/5 border-2 border-dashed border-white/30 rounded-full flex items-center justify-center",children:s.jsx(lt,{className:"w-12 h-12 text-white/50"})})]}),s.jsxs("div",{className:"bg-white/5 border border-white/20 rounded-xl p-8 max-w-md space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"No Guardians Added Yet"}),s.jsx("p",{className:"text-sm text-white/70 mb-6",children:"Add guardians who will monitor your safety during appointments."})]}),s.jsxs("div",{className:"space-y-3 text-sm text-white/80",children:[s.jsx("p",{className:"font-medium",children:"They'll receive:"}),s.jsxs("ul",{className:"space-y-2",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-primary",children:""}),s.jsx("span",{children:"Your exact location"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-primary",children:""}),s.jsx("span",{children:"Photo documentation"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-primary",children:""}),s.jsx("span",{children:"Nearest police info"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-primary",children:""}),s.jsx("span",{children:"Emergency alerts"})]})]})]}),s.jsx("div",{className:"bg-primary/10 border border-primary/30 rounded-lg p-3",children:s.jsx("p",{className:"text-xs text-white/90",children:" We recommend at least 3 guardians for maximum protection"})})]}),s.jsx(L,{onClick:e,className:"mt-8 w-full max-w-md h-14 text-lg bg-gradient-to-r from-cyan-500 to-cyan-600 hover:from-cyan-600 hover:to-cyan-700 text-white font-semibold shadow-lg shadow-cyan-500/50",children:"+ Invite Your First Guardian"})]})}function V8e({open:e,onOpenChange:t,onSuccess:r}){const[n,a]=w.useState(""),[i,o]=w.useState(""),[l,c]=w.useState(!1),{toast:u}=Et(),d=async h=>{if(h.preventDefault(),!(!n.trim()||!i.trim())){c(!0);try{const{data:{user:f}}=await T.auth.getUser();if(!f){u({title:"Authentication required",description:"Please log in to invite a guardian",variant:"destructive"});return}const{error:p}=await T.from("guardians").insert({user_id:f.id,name:n.trim(),phone:i.trim(),status:"pending"});if(p)throw p;u({title:"Invitation Sent",description:`Invited ${n} successfully`}),a(""),o(""),t(!1),r()}catch(f){console.error("Error inviting guardian:",f),u({title:"Error",description:"Failed to send invitation. Please try again.",variant:"destructive"})}finally{c(!1)}}};return s.jsx(Ca,{open:e,onOpenChange:t,children:s.jsxs(oa,{className:"bg-card border-border max-w-md",children:[s.jsx(Ea,{children:s.jsx(ka,{className:"text-foreground",children:"Invite Guardian"})}),s.jsxs("form",{onSubmit:d,className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"name",className:"text-foreground",children:"Name"}),s.jsxs("div",{className:"relative",children:[s.jsx(fn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),s.jsx(De,{id:"name",value:n,onChange:h=>a(h.target.value),placeholder:"Guardian's full name",className:"pl-10",required:!0})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"phone",className:"text-foreground",children:"Phone Number"}),s.jsxs("div",{className:"relative",children:[s.jsx(Bc,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),s.jsx(De,{id:"phone",type:"tel",value:i,onChange:h=>o(h.target.value),placeholder:"+1 (555) 123-4567",className:"pl-10",required:!0})]})]})]}),s.jsx("div",{className:"bg-muted rounded-lg p-3",children:s.jsx("p",{className:"text-xs text-muted-foreground",children:" SMS invitations will be sent. They'll need to accept to become active guardians."})}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(L,{type:"button",variant:"outline",onClick:()=>t(!1),className:"flex-1",disabled:l,children:"Cancel"}),s.jsx(L,{type:"submit",className:"flex-1 bg-gradient-primary hover:brightness-110",disabled:l||!n.trim()||!i.trim(),children:l?"Sending...":"Send Invitation"})]})]})]})})}function KL({guardian:e,onRemove:t,onResend:r,groups:n=[]}){const a=e.status==="pending",i=a?"text-yellow-400":"text-green-400",o=a?"":"",l=u=>{const d=new Date(u),f=Math.abs(new Date().getTime()-d.getTime()),p=Math.floor(f/(1e3*60*60*24));return p===0?"Today":p===1?"Yesterday":p<7?`${p} days ago`:d.toLocaleDateString()},c=()=>{window.location.href=`sms:${e.phone}`};return s.jsx(q,{className:"bg-white/5 border-white/20 hover:bg-white/10 transition-all",children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-full flex items-center justify-center",children:s.jsx(fn,{className:"w-6 h-6 text-white"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"flex items-start justify-between mb-1",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"text-white font-semibold",children:e.name}),s.jsx("span",{className:i,children:o})]})}),s.jsx("p",{className:"text-sm text-white/60 mb-1",children:e.phone}),s.jsx("p",{className:"text-xs text-white/50",children:a?`Invited: ${l(e.invited_at||e.created_at)}`:`Added: ${l(e.created_at)}`}),n.length>0&&s.jsxs("p",{className:"text-xs text-white/60 mt-1",children:["Groups: ",n.join(", ")]}),s.jsxs("div",{className:"flex gap-2 mt-3",children:[!a&&s.jsxs(L,{variant:"outline",size:"sm",onClick:c,className:"h-8 text-xs border-white/20 text-white hover:bg-white/10",children:[s.jsx(sj,{className:"w-3 h-3 mr-1"}),"Message"]}),a&&r&&s.jsxs(L,{variant:"outline",size:"sm",onClick:()=>r(e.id),className:"h-8 text-xs border-white/20 text-white hover:bg-white/10",children:[s.jsx(ij,{className:"w-3 h-3 mr-1"}),"Resend"]}),s.jsxs(sO,{children:[s.jsx(E9,{asChild:!0,children:s.jsxs(L,{variant:"outline",size:"sm",className:"h-8 text-xs border-destructive/50 text-destructive hover:bg-destructive/10",children:[a?s.jsx(vn,{className:"w-3 h-3 mr-1"}):s.jsx(Qc,{className:"w-3 h-3 mr-1"}),a?"Cancel":"Remove"]})}),s.jsxs(Qj,{className:"bg-card border-border",children:[s.jsxs(Zj,{children:[s.jsx(eN,{className:"text-foreground",children:a?"Cancel Invitation?":"Remove Guardian?"}),s.jsx(tN,{className:"text-muted-foreground",children:a?`Are you sure you want to cancel the invitation to ${e.name}?`:`Are you sure you want to remove ${e.name} as a guardian? They will no longer be able to monitor your DateGuard sessions or receive emergency alerts.`})]}),s.jsxs(Jj,{children:[s.jsx(nN,{children:"Cancel"}),s.jsx(rN,{onClick:()=>t(e.id),className:"bg-destructive hover:bg-destructive/90",children:a?"Cancel Invitation":"Remove Guardian"})]})]})]})]})]})]})})})}function z8e({group:e,onEdit:t,onDelete:r}){return s.jsx(q,{className:"bg-gradient-to-br from-purple-900/40 to-purple-800/40 border-purple-500/30 hover:border-purple-500/50 transition-all",children:s.jsxs(ee,{className:"p-4",children:[s.jsx("div",{className:"flex items-start justify-between mb-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(hn,{className:"w-5 h-5 text-purple-400"}),s.jsx("h3",{className:"text-white font-semibold uppercase",children:e.group_name})]})}),s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(An,{className:"w-4 h-4 text-white/60"}),s.jsxs("p",{className:"text-sm text-white/70",children:[e.active_count," guardian",e.active_count!==1?"s":"",e.total_count>e.active_count&&s.jsxs("span",{className:"text-yellow-400",children:["  ",e.total_count-e.active_count," pending"]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(L,{variant:"outline",size:"sm",onClick:()=>t(e.id),className:"flex-1 h-8 text-xs border-white/20 text-white hover:bg-white/10",children:[s.jsx(jae,{className:"w-3 h-3 mr-1"}),"Edit"]}),s.jsxs(L,{variant:"outline",size:"sm",onClick:()=>r(e.id),className:"flex-1 h-8 text-xs border-destructive/50 text-destructive hover:bg-destructive/10",children:[s.jsx(Qc,{className:"w-3 h-3 mr-1"}),"Delete"]})]})]})})}function W8e({open:e,onOpenChange:t,onSuccess:r,availableGuardians:n}){const[a,i]=w.useState(""),[o,l]=w.useState([]),[c,u]=w.useState(!1),{toast:d}=Et(),h=n.filter(m=>m.status==="active"),f=m=>{l(v=>v.includes(m)?v.filter(g=>g!==m):[...v,m])},p=async m=>{if(m.preventDefault(),!(!a.trim()||o.length===0)){u(!0);try{const{data:{user:v}}=await T.auth.getUser();if(!v){d({title:"Authentication required",description:"Please log in to create a guardian group",variant:"destructive"});return}const{data:g,error:x}=await T.from("guardian_groups").insert({user_id:v.id,group_name:a.trim(),is_default:!1}).select().single();if(x)throw x;const y=o.map(N=>({group_id:g.id,guardian_id:N})),{error:b}=await T.from("guardian_group_members").insert(y);if(b)throw b;d({title:"Group Created",description:`${a} group created with ${o.length} guardian${o.length!==1?"s":""}`}),i(""),l([]),t(!1),r()}catch(v){console.error("Error creating group:",v),d({title:"Error",description:"Failed to create group. Please try again.",variant:"destructive"})}finally{u(!1)}}};return s.jsx(Ca,{open:e,onOpenChange:t,children:s.jsxs(oa,{className:"bg-card border-border max-w-md max-h-[80vh] flex flex-col",children:[s.jsx(Ea,{children:s.jsxs(ka,{className:"text-foreground flex items-center gap-2",children:[s.jsx(hn,{className:"w-5 h-5 text-primary"}),"Create Regional Group"]})}),s.jsxs("form",{onSubmit:p,className:"flex flex-col flex-1 min-h-0",children:[s.jsxs("div",{className:"flex-1 overflow-y-auto space-y-6 pr-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"groupName",className:"text-foreground",children:"Group Name"}),s.jsx(De,{id:"groupName",value:a,onChange:m=>i(m.target.value),placeholder:'e.g., "Atlanta", "Dubai", "New York"',required:!0,minLength:2}),s.jsx("p",{className:"text-xs text-muted-foreground",children:" Use city or region names"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(de,{className:"text-foreground",children:"Select Guardians"}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[o.length," selected"]})]}),h.length===0?s.jsx("div",{className:"bg-muted rounded-lg p-4 text-center",children:s.jsx("p",{className:"text-sm text-muted-foreground",children:"No active guardians available. Invite guardians first."})}):s.jsx("div",{className:"space-y-2",children:h.map(m=>s.jsxs("div",{onClick:()=>f(m.id),className:"flex items-center gap-3 p-3 rounded-lg border border-border hover:bg-accent cursor-pointer transition-colors",children:[s.jsx(Al,{checked:o.includes(m.id),onCheckedChange:()=>f(m.id),onClick:v=>v.stopPropagation()}),s.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:s.jsx(fn,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"text-sm font-medium text-foreground",children:m.name}),s.jsx("p",{className:"text-xs text-muted-foreground truncate",children:m.phone})]})]},m.id))})]}),s.jsx("div",{className:"bg-muted rounded-lg p-3",children:s.jsx("p",{className:"text-xs text-muted-foreground",children:" Guardians can be in multiple regional groups"})})]}),s.jsxs("div",{className:"flex gap-3 pt-4 border-t border-border mt-4",children:[s.jsx(L,{type:"button",variant:"outline",onClick:()=>t(!1),className:"flex-1",disabled:c,children:"Cancel"}),s.jsx(L,{type:"submit",className:"flex-1 bg-gradient-primary hover:brightness-110",disabled:c||!a.trim()||o.length===0,children:c?"Creating...":"Create Group"})]})]})]})})}function q8e(){const e=Oe(),{toast:t}=Et(),[r,n]=w.useState([]),[a,i]=w.useState([]),[o,l]=w.useState(!1),[c,u]=w.useState(!1),[d,h]=w.useState(!1),[f,p]=w.useState(!0);w.useEffect(()=>{m()},[]);const m=async()=>{try{const{data:{user:j}}=await T.auth.getUser();if(!j)return;const{data:_,error:S}=await T.from("guardians").select("*").eq("user_id",j.id).order("created_at",{ascending:!1});if(S)throw S;n(_||[]);const{data:C,error:E}=await T.from("guardian_groups").select(`
          id,
          group_name,
          is_default,
          guardian_group_members (
            guardian_id,
            guardians (
              status
            )
          )
        `).eq("user_id",j.id).order("is_default",{ascending:!1});if(E)throw E;const k=(C||[]).map(P=>{var A,O,I;return{id:P.id,group_name:P.group_name,is_default:P.is_default,active_count:((A=P.guardian_group_members)==null?void 0:A.filter(R=>{var M;return((M=R.guardians)==null?void 0:M.status)==="active"}).length)||0,pending_count:((O=P.guardian_group_members)==null?void 0:O.filter(R=>{var M;return((M=R.guardians)==null?void 0:M.status)==="pending"}).length)||0,total_count:((I=P.guardian_group_members)==null?void 0:I.length)||0}});i(k)}catch(j){console.error("Error loading guardians:",j),t({title:"Error",description:"Failed to load guardians",variant:"destructive"})}finally{p(!1)}},v=async j=>{try{const{error:_}=await T.from("guardians").delete().eq("id",j);if(_)throw _;t({title:"Guardian Removed",description:"Guardian has been removed successfully"}),m()}catch(_){console.error("Error removing guardian:",_),t({title:"Error",description:"Failed to remove guardian",variant:"destructive"})}},g=async j=>{try{const{error:_}=await T.from("guardians").update({last_resent_at:new Date().toISOString()}).eq("id",j);if(_)throw _;t({title:"Invitation Resent",description:"Invitation SMS has been sent again"})}catch(_){console.error("Error resending invite:",_),t({title:"Error",description:"Failed to resend invitation",variant:"destructive"})}},x=r.filter(j=>j.status==="active"),y=r.filter(j=>j.status==="pending"),b=a.filter(j=>!j.is_default),N=r.length>0;return f?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[hsl(265,70%,20%)] to-[hsl(270,60%,30%)] flex items-center justify-center",children:s.jsx("div",{className:"text-white",children:"Loading..."})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[hsl(265,70%,20%)] to-[hsl(270,60%,30%)] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between border-b border-white/10",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/dateguard"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(An,{className:"w-5 h-5"}),s.jsx("h1",{className:"text-lg font-semibold",children:"MY GUARDIANS"})]})]}),N&&s.jsxs(L,{onClick:()=>l(!0),className:"bg-gradient-to-r from-cyan-500 to-cyan-600 hover:from-cyan-600 hover:to-cyan-700 text-white",children:[s.jsx(Ms,{className:"w-4 h-4 mr-1"}),"Invite"]})]}),s.jsx("main",{className:"px-4 py-6 space-y-6 max-w-2xl mx-auto",children:N?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-sm font-semibold text-white/60 uppercase tracking-wide",children:"Main Group"}),s.jsx("span",{className:"text-sm text-white/50",children:"All Guardians"})]}),s.jsx(q,{className:"bg-white/10 border-white/20",children:s.jsxs(ee,{className:"p-4",children:[s.jsxs("button",{onClick:()=>h(!d),className:"w-full flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(An,{className:"w-5 h-5 text-white"}),s.jsxs("div",{className:"text-left",children:[s.jsx("h3",{className:"text-white font-semibold",children:"All Guardians"}),s.jsxs("p",{className:"text-sm text-white/60",children:[x.length," active",y.length>0&&`  ${y.length} pending`]})]})]}),d?s.jsx(Sv,{className:"w-5 h-5 text-white/60"}):s.jsx(Lc,{className:"w-5 h-5 text-white/60"})]}),d&&s.jsxs("div",{className:"mt-4 space-y-3",children:[x.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("h4",{className:"text-xs font-semibold text-white/50 uppercase",children:["Active (",x.length,")"]}),x.map(j=>s.jsx(KL,{guardian:j,onRemove:v},j.id))]}),y.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("h4",{className:"text-xs font-semibold text-yellow-400/70 uppercase",children:["Pending Invites (",y.length,")"]}),y.map(j=>s.jsx(KL,{guardian:j,onRemove:v,onResend:g},j.id))]})]})]})})]}),b.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h2",{className:"text-sm font-semibold text-white/60 uppercase tracking-wide",children:"Regional Groups"}),s.jsx("div",{className:"space-y-3",children:b.map(j=>s.jsx(z8e,{group:j,onEdit:_=>console.log("Edit group:",_),onDelete:_=>console.log("Delete group:",_)},j.id))})]}),s.jsxs(L,{onClick:()=>u(!0),variant:"outline",className:"w-full h-12 border-2 border-white/30 bg-white/5 text-white hover:bg-white/10 hover:border-white/50",children:[s.jsx(Ms,{className:"w-4 h-4 mr-2"}),"Create Regional Group"]})]}):s.jsx(U8e,{onInvite:()=>l(!0)})}),s.jsx(V8e,{open:o,onOpenChange:l,onSuccess:m}),s.jsx(W8e,{open:c,onOpenChange:u,onSuccess:m,availableGuardians:r})]})}const G8e=({hours:e,minutes:t,seconds:r,onHoursChange:n,onMinutesChange:a,onSecondsChange:i})=>{const o=(c,u,d)=>{d(c>=u?0:c+1)},l=(c,u,d)=>{d(c<=0?u:c-1)};return s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>o(e,23,n),className:"text-white hover:bg-white/10 h-12 w-12",children:s.jsx(Sv,{className:"w-6 h-6"})}),s.jsx("div",{className:"text-6xl font-bold text-white min-w-[80px] text-center",children:e.toString().padStart(2,"0")}),s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>l(e,23,n),className:"text-white hover:bg-white/10 h-12 w-12",children:s.jsx(Lc,{className:"w-6 h-6"})}),s.jsx("div",{className:"text-sm text-white/60 mt-2",children:"Hours"})]}),s.jsx("div",{className:"text-6xl font-bold text-white/60",children:":"}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>o(t,59,a),className:"text-white hover:bg-white/10 h-12 w-12",children:s.jsx(Sv,{className:"w-6 h-6"})}),s.jsx("div",{className:"text-6xl font-bold text-white min-w-[80px] text-center",children:t.toString().padStart(2,"0")}),s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>l(t,59,a),className:"text-white hover:bg-white/10 h-12 w-12",children:s.jsx(Lc,{className:"w-6 h-6"})}),s.jsx("div",{className:"text-sm text-white/60 mt-2",children:"Minutes"})]}),s.jsx("div",{className:"text-6xl font-bold text-white/60",children:":"}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>o(r,59,i),className:"text-white hover:bg-white/10 h-12 w-12",children:s.jsx(Sv,{className:"w-6 h-6"})}),s.jsx("div",{className:"text-6xl font-bold text-white min-w-[80px] text-center",children:r.toString().padStart(2,"0")}),s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>l(r,59,i),className:"text-white hover:bg-white/10 h-12 w-12",children:s.jsx(Lc,{className:"w-6 h-6"})}),s.jsx("div",{className:"text-sm text-white/60 mt-2",children:"Seconds"})]})]})},JX=({group:e,selected:t,onSelect:r,onEdit:n})=>{var i;const a=((i=e.members)==null?void 0:i.length)||0;return s.jsx(q,{className:`bg-white/10 border-2 backdrop-blur-sm cursor-pointer transition-all ${t?"border-white bg-white/20":"border-white/20 hover:border-white/40"}`,onClick:()=>r(!t),children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Al,{checked:t,onCheckedChange:r,className:"border-white data-[state=checked]:bg-white data-[state=checked]:text-[#1B2B5E]"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(An,{className:"w-5 h-5 text-white/80"}),s.jsx("p",{className:"font-semibold text-white",children:e.name})]}),s.jsxs("p",{className:"text-sm text-white/60 mt-1",children:[a," ",a===1?"guardian":"guardians"]})]}),n&&s.jsx(L,{variant:"ghost",size:"icon",onClick:o=>{o.stopPropagation(),n()},className:"text-white hover:bg-white/10",children:s.jsx(TC,{className:"w-4 h-4"})})]})})})};function YL(){const e=Oe(),[t,r]=w.useState("groups"),[n,a]=w.useState(null),[i,o]=w.useState([]),[l,c]=w.useState([]),[u,d]=w.useState(""),[h,f]=w.useState(new Set),[p,m]=w.useState(1),[v,g]=w.useState(30),[x,y]=w.useState(0),[b,N]=w.useState(5),[j,_]=w.useState([]),[S,C]=w.useState(!1);w.useEffect(()=>{E(),k();const R=sessionStorage.getItem("dateguard_selected_groups");R&&f(new Set(JSON.parse(R)))},[]);const E=async()=>{const{data:{user:R}}=await T.auth.getUser();if(!R){e("/login");return}const{data:M}=await T.from("guardian_groups").select("*").eq("user_id",R.id);_(M||[])},k=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(R=>{a({lat:R.coords.latitude,lng:R.coords.longitude,address:"Marriott Hotel, 123 Main St, Atlanta, GA",gps:`${R.coords.latitude.toFixed(4)}N, ${R.coords.longitude.toFixed(4)}W`})},R=>{console.error("Error getting location:",R),a({lat:33.749,lng:-84.388,address:"Marriott Hotel, 123 Main St, Atlanta, GA",gps:"33.7490N, 84.3880W"})})},P=R=>{if(R.target.files){const M=Array.from(R.target.files);o([...i,...M])}},A=R=>{o(i.filter((M,B)=>B!==R)),c(l.filter((M,B)=>B!==R))},O=R=>{const M=new Set(h);M.has(R)?M.delete(R):M.add(R),f(M)},I=async()=>{var R;if(h.size===0){H.error("Please select at least one guardian group");return}C(!0);try{const{data:{user:M}}=await T.auth.getUser();if(!M){e("/login");return}const{data:B}=await T.from("profiles").select("vai_number").eq("id",M.id).single(),$=p*60+v+x/60,D=new Date(Date.now()+$*60*1e3),W=new Date(D.getTime()+b*60*1e3),Z=[];for(const he of i){const se=`${M.id}/${Date.now()}_${he.name}`,{data:ye,error:ne}=await T.storage.from("dateguard-pre-activation").upload(se,he);if(!ne&&ye){const{data:le}=T.storage.from("dateguard-pre-activation").getPublicUrl(se);le!=null&&le.publicUrl&&Z.push(le.publicUrl)}}let U={lat:0,lng:0};n&&n.lat&&n.lng?U={lat:n.lat,lng:n.lng}:navigator.geolocation&&await new Promise(he=>{navigator.geolocation.getCurrentPosition(se=>{U={lat:se.coords.latitude,lng:se.coords.longitude},he()},()=>{he()})});const{data:Y,error:ae}=await T.from("dateguard_sessions").insert({user_id:M.id,user_vai:(B==null?void 0:B.vai_number)||null,guardian_group_id:Array.from(h)[0]||null,location_name:((R=n==null?void 0:n.address)==null?void 0:R.split(",")[0])||"Location",location_address:(n==null?void 0:n.address)||"",location_gps:(n==null?void 0:n.gps)||`${U.lat.toFixed(4)}N, ${Math.abs(U.lng).toFixed(4)}W`,location_photo_url:Z[0]||null,location_notes:u,memo:u,duration_minutes:Math.round($),scheduled_duration_minutes:Math.round($),buffer_minutes:b,selected_groups:Array.from(h),pre_activation_photos:Z,pre_activation_notes:u,gps_coordinates:U,scheduled_end_at:D.toISOString(),buffer_end_at:W.toISOString(),ends_at:W.toISOString(),status:"active",gps_tracking_enabled:!0}).select().single();if(ae)throw ae;try{await T.functions.invoke("query-nearest-police",{body:{lat:U.lat,lng:U.lng,session_id:Y.id}})}catch(he){console.warn("Could not query police station:",he)}const{data:ie}=await T.from("guardian_groups").select("members").in("id",Array.from(h));await T.from("dateguard_messages").insert({session_id:Y.id,sender_type:"bot",sender_name:"VAIRIFY BOT",message_type:"session_start",message:"DateGuard session started",metadata:{location:n==null?void 0:n.address,gps:U,notes:u,duration:$,scheduled_end_at:D.toISOString()}}),H.success(" DateGuard activated! Guardians notified."),setTimeout(()=>{e(`/dateguard/session/${Y.id}`)},2e3)}catch(M){console.error("Error creating session:",M),H.error(M.message||"Failed to activate DateGuard")}finally{C(!1)}};return S?s.jsx("div",{className:"min-h-screen bg-[#1B2B5E] text-white flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-6 p-8",children:[s.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-xl font-bold",children:"Activating DateGuard..."}),s.jsxs("div",{className:"space-y-1 text-sm text-white/80",children:[s.jsx("p",{children:" Photos uploaded"}),s.jsx("p",{children:" Location captured"}),s.jsx("p",{children:" Notes saved"}),s.jsx("p",{children:" Querying nearest police..."}),s.jsx("p",{children:" Notifying guardians..."})]})]})]})}):t==="groups"?s.jsxs("div",{className:"min-h-screen bg-[#1B2B5E] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/dateguard"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-xl font-bold",children:"SELECT GROUPS"}),s.jsx("p",{className:"text-xs text-white/60",children:"Step 1 of 5"})]}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-6 space-y-6 max-w-md mx-auto",children:[s.jsx("div",{className:"flex items-center justify-center gap-2 mb-4",children:[1,2,3,4,5].map(R=>s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all ${R===1?"bg-white text-[#1B2B5E]":R<1?"bg-white/20 text-white/60":"bg-white/10 text-white/40"}`,children:R},R))}),s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(lt,{className:"w-12 h-12 mx-auto text-white/80"}),s.jsx("p",{className:"text-white/90",children:"Choose which groups to notify"})]}),s.jsx("div",{className:"space-y-3",children:j.map(R=>s.jsx(JX,{group:{id:R.id,name:R.group_name||R.name,members:R.members||[]},selected:h.has(R.id),onSelect:()=>O(R.id)},R.id))}),s.jsxs(L,{onClick:()=>r("time"),disabled:h.size===0,className:"w-full h-14 text-lg font-semibold bg-white text-[#1B2B5E] hover:bg-white/90",children:["Continue (",h.size," ",h.size===1?"group":"groups",")"]})]})]}):t==="time"?s.jsxs("div",{className:"min-h-screen bg-[#1B2B5E] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>r("groups"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-xl font-bold",children:"SET YOUR TIME"}),s.jsx("p",{className:"text-xs text-white/60",children:"Step 2 of 5"})]}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-8 space-y-8 max-w-md mx-auto",children:[s.jsx("div",{className:"flex items-center justify-center gap-2 mb-4",children:[1,2,3,4,5].map(R=>s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all ${R===2?"bg-white text-[#1B2B5E]":R<2?"bg-white/20 text-white/60":"bg-white/10 text-white/40"}`,children:R},R))}),s.jsx(G8e,{hours:p,minutes:v,seconds:x,onHoursChange:m,onMinutesChange:g,onSecondsChange:y}),s.jsx(L,{onClick:()=>r("buffer"),className:"w-full h-14 text-lg font-semibold bg-white text-[#1B2B5E] hover:bg-white/90",children:"Continue"})]})]}):t==="buffer"?s.jsxs("div",{className:"min-h-screen bg-[#1B2B5E] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>r("time"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-xl font-bold",children:"SET ALARM DELAY"}),s.jsx("p",{className:"text-xs text-white/60",children:"Step 3 of 5"})]}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-6 space-y-6 max-w-md mx-auto",children:[s.jsx("div",{className:"flex items-center justify-center gap-2 mb-4",children:[1,2,3,4,5].map(R=>s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all ${R===3?"bg-white text-[#1B2B5E]":R<3?"bg-white/20 text-white/60":"bg-white/10 text-white/40"}`,children:R},R))}),s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(On,{className:"w-12 h-12 mx-auto text-white/80"}),s.jsx("p",{className:"text-white/90",children:"Grace period before alerting guardians"})]}),s.jsx("div",{className:"grid grid-cols-5 gap-2",children:[5,10,15,30,60].map(R=>s.jsxs(L,{variant:b===R?"default":"outline",className:b===R?"bg-white text-[#1B2B5E]":"text-white border-white/30 hover:bg-white/10",onClick:()=>N(R),children:[R,"m"]},R))}),s.jsx(q,{className:"bg-white/10 border-white/20",children:s.jsxs(ee,{className:"p-6 text-center",children:[s.jsxs("p",{className:"text-2xl font-bold text-white",children:[b," minutes"]}),s.jsx("p",{className:"text-sm text-white/60 mt-2",children:"Buffer period"})]})}),s.jsx(L,{onClick:()=>r("intel"),className:"w-full h-14 text-lg font-semibold bg-white text-[#1B2B5E] hover:bg-white/90",children:"Continue"})]})]}):t==="intel"?s.jsxs("div",{className:"min-h-screen bg-[#1B2B5E] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>r("buffer"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-xl font-bold",children:"UPLOAD INTEL"}),s.jsx("p",{className:"text-xs text-white/60",children:"Step 4 of 5"})]}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-6 space-y-6 max-w-md mx-auto",children:[s.jsx("div",{className:"flex items-center justify-center gap-2 mb-4",children:[1,2,3,4,5].map(R=>s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all ${R===4?"bg-white text-[#1B2B5E]":R<4?"bg-white/20 text-white/60":"bg-white/10 text-white/40"}`,children:R},R))}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 text-white/90",children:[s.jsx(hn,{className:"w-5 h-5"}),s.jsx("h2",{className:"font-bold",children:"LOCATION"})]}),s.jsx(q,{className:"bg-white/10 border-white/20",children:s.jsxs(ee,{className:"p-4 space-y-2",children:[s.jsx("p",{className:"text-sm text-white/70",children:"Current location:"}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"font-semibold text-white",children:(n==null?void 0:n.address)||"Loading..."}),s.jsxs("p",{className:"text-xs text-white/60",children:["GPS: ",(n==null?void 0:n.gps)||"..."]}),s.jsx("p",{className:"text-xs text-green-400",children:" Auto-detected"})]})]})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 text-white/90",children:[s.jsx(Na,{className:"w-5 h-5"}),s.jsx("h2",{className:"font-bold",children:"PHOTOS (Optional)"})]}),i.length>0&&s.jsx("div",{className:"grid grid-cols-2 gap-2",children:i.map((R,M)=>s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:URL.createObjectURL(R),alt:`Photo ${M+1}`,className:"w-full h-24 object-cover rounded-lg"}),s.jsx("button",{onClick:()=>A(M),className:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs",children:""})]},M))}),s.jsxs("div",{className:"bg-white/10 border-2 border-dashed border-white/30 rounded-lg p-8 text-center",children:[s.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:P,multiple:!0,className:"hidden",id:"photo-upload"}),s.jsx(de,{htmlFor:"photo-upload",children:s.jsx(L,{variant:"outline",className:"text-white border-white/30 hover:bg-white/10",asChild:!0,children:s.jsx("span",{children:" Take Photo"})})})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 text-white/90",children:[s.jsx(T0,{className:"w-5 h-5"}),s.jsx("h2",{className:"font-bold",children:"NOTES (Optional)"})]}),s.jsx(Mn,{placeholder:"Room 1658, 16th floor...",value:u,onChange:R=>d(R.target.value),className:"bg-white/10 border-white/30 text-white placeholder:text-white/40 min-h-[100px]"}),s.jsx("p",{className:"text-xs text-white/60",children:"Include room #, floor, landmarks"})]}),s.jsx("div",{className:"bg-yellow-500/20 border border-yellow-500/50 rounded-lg p-4",children:s.jsx("p",{className:"text-sm text-yellow-200",children:" This data is sent to guardians for emergency response"})}),s.jsx(L,{onClick:()=>r("confirm"),className:"w-full h-14 text-lg font-semibold bg-white text-[#1B2B5E] hover:bg-white/90",children:"Continue"})]})]}):s.jsxs("div",{className:"min-h-screen bg-[#1B2B5E] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>r("intel"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-xl font-bold",children:"CONFIRM"}),s.jsx("p",{className:"text-xs text-white/60",children:"Step 5 of 5"})]}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-6 space-y-6 max-w-md mx-auto",children:[s.jsx("div",{className:"flex items-center justify-center gap-2 mb-4",children:[1,2,3,4,5].map(R=>s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all ${R===5?"bg-white text-[#1B2B5E]":R<5?"bg-white/20 text-white/60":"bg-white/10 text-white/40"}`,children:R},R))}),s.jsx(q,{className:"bg-white/10 border-white/20",children:s.jsxs(ee,{className:"p-6 space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-white/60",children:"Duration"}),s.jsxs("p",{className:"text-lg font-bold text-white",children:[p,"h ",v,"m ",x,"s"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-white/60",children:"Buffer"}),s.jsxs("p",{className:"text-lg font-bold text-white",children:[b," minutes"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-white/60",children:"Groups"}),s.jsxs("p",{className:"text-lg font-bold text-white",children:[h.size," ",h.size===1?"group":"groups"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-white/60",children:"Location"}),s.jsx("p",{className:"text-lg font-bold text-white",children:(n==null?void 0:n.address)||"Not set"})]})]})}),s.jsx(L,{onClick:I,disabled:S,className:"w-full h-16 text-xl font-bold bg-gradient-to-r from-green-500 to-green-600 text-white hover:from-green-600 hover:to-green-700",children:S?"Starting...":"START DATEGUARD"})]})]})}const hv=({value:e,onChange:t,maxLength:r=6,disabled:n=!1})=>{const a=l=>{e.length<r&&t(e+l)},i=()=>{t(e.slice(0,-1))},o=()=>{t("")};return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center justify-center gap-2 min-h-[60px]",children:Array.from({length:r}).map((l,c)=>s.jsx("div",{className:`w-12 h-12 rounded-lg border-2 flex items-center justify-center text-2xl font-bold transition-all ${c<e.length?"bg-white text-[#1B2B5E] border-white":"bg-white/10 border-white/30 text-white/50"}`,children:e[c]||""},c))}),s.jsxs("div",{className:"grid grid-cols-3 gap-3 max-w-xs mx-auto",children:[[1,2,3,4,5,6,7,8,9].map(l=>s.jsx(L,{onClick:()=>a(l.toString()),disabled:n||e.length>=r,className:"h-16 text-2xl font-bold bg-white/20 hover:bg-white/30 text-white border border-white/30",children:l},l)),s.jsx(L,{onClick:o,disabled:n||e.length===0,variant:"ghost",className:"h-16 text-white/70 hover:bg-white/10",children:s.jsx(vn,{className:"w-6 h-6"})}),s.jsx(L,{onClick:()=>a("0"),disabled:n||e.length>=r,className:"h-16 text-2xl font-bold bg-white/20 hover:bg-white/30 text-white border border-white/30",children:"0"}),s.jsx(L,{onClick:i,disabled:n||e.length===0,variant:"ghost",className:"h-16 text-white/70 hover:bg-white/10",children:s.jsx(az,{className:"w-6 h-6"})})]})]})},H8e=({sessionId:e,isOpen:t,onClose:r,onEmergencyTriggered:n})=>{const[a,i]=w.useState(""),[o,l]=w.useState(!1),c=async d=>{const f=new TextEncoder().encode(d),p=await crypto.subtle.digest("SHA-256",f);return Array.from(new Uint8Array(p)).map(v=>v.toString(16).padStart(2,"0")).join("")},u=async()=>{if(a.length<4){H.error("Code must be at least 4 digits");return}l(!0);try{const{data:{user:d}}=await T.auth.getUser();if(!d){H.error("You must be logged in");return}const{data:h}=await T.from("dateguard_codes").select("decoy_code_hash").eq("user_id",d.id).single();if(!h){H.error("Decoy code not set up"),i("");return}if(await c(a)!==h.decoy_code_hash){H.error("Incorrect code"),i("");return}const{error:p}=await T.functions.invoke("send-emergency-command-center-sms",{body:{session_id:e,trigger_type:"decoy_code"}});if(p){console.error("Error triggering decoy emergency:",p),H.error("Failed to trigger emergency");return}await T.from("dateguard_sessions").update({status:"emergency",ended_via:"decoy",emergency_command_center_activated:!0}).eq("id",e),r(),n()}catch(d){console.error("Error verifying decoy code:",d),H.error(d.message||"Failed to verify code")}finally{l(!1),i("")}};return s.jsx(Ca,{open:t,onOpenChange:r,children:s.jsxs(oa,{className:"bg-[#1B2B5E] border-white/20 text-white max-w-md",children:[s.jsx(Ea,{children:s.jsx(ka,{className:"text-white",children:"Enter Code to End Session"})}),s.jsxs("div",{className:"space-y-6 py-4",children:[s.jsx("p",{className:"text-white/70 text-center",children:"Enter your code to safely end DateGuard"}),s.jsx(hv,{value:a,onChange:i,maxLength:6,disabled:o}),s.jsx("button",{onClick:u,disabled:a.length<4||o,className:"w-full h-12 bg-white text-[#1B2B5E] rounded-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Verifying...":"End Session"})]})]})})};function K8e(){const{sessionId:e}=us(),t=Oe(),[r,n]=w.useState(null),[a,i]=w.useState(0),[o,l]=w.useState(0),[c,u]=w.useState(0),[d,h]=w.useState(!1),[f,p]=w.useState(0),[m,v]=w.useState(!1),g=w.useRef(null),[x,y]=w.useState(!1),[b,N]=w.useState(!1),j=w.useRef(null);w.useEffect(()=>{if(e){_();const D=setInterval(S,1e3);return()=>{clearInterval(D),g.current&&clearInterval(g.current),j.current&&clearInterval(j.current)}}},[e]),w.useEffect(()=>{if(r!=null&&r.gps_tracking_enabled&&(r==null?void 0:r.status)==="active")return C(),j.current=setInterval(C,2*60*1e3),()=>{j.current&&clearInterval(j.current)}},[r]);const _=async()=>{const{data:D}=await T.from("dateguard_sessions").select("*").eq("id",e).single();n(D),(D==null?void 0:D.status)==="emergency"&&N(!0)},S=()=>{if(!r)return;const D=new Date().getTime(),Z=new Date(r.scheduled_end_at||r.ends_at).getTime()-D;if(Z<=0){i(0),l(0),u(0),r.status==="active"&&!d&&(h(!0),E());return}const U=Math.floor(Z/(1e3*60)),Y=Math.floor(U/60),ae=U%60;i(Y),l(ae),u(U)},C=async()=>{if(e)try{navigator.geolocation&&navigator.geolocation.getCurrentPosition(async D=>{await T.functions.invoke("update-gps-tracking",{body:{session_id:e,lat:D.coords.latitude,lng:D.coords.longitude}})},D=>{console.warn("GPS update failed:",D)})}catch(D){console.error("Error updating GPS:",D)}},E=async()=>{try{const{data:{user:D}}=await T.auth.getUser();if(!D)return;const W=(r.buffer_minutes||0)*60*1e3;await new Promise(U=>setTimeout(U,Math.min(W,3e4))),await T.from("dateguard_sessions").update({status:"emergency",ended_via:"timer_expiration"}).eq("id",e);const{error:Z}=await T.functions.invoke("send-emergency-command-center-sms",{body:{session_id:e,trigger_type:"timer_expired"}});Z?(console.error("Error triggering ECC:",Z),H.error("Emergency alert triggered but notification failed")):H.error(" Timer expired - Emergency Command Center activated"),N(!0),t(`/dateguard/emergency/${e}`)}catch(D){console.error("Error handling timer expiration:",D)}},k=async()=>{await T.from("dateguard_sessions").update({last_checkin_at:new Date().toISOString()}).eq("id",e);const D=new Date(Date.now()+30*60*1e3);await T.from("dateguard_sessions").update({scheduled_end_at:D.toISOString(),ends_at:D.toISOString()}).eq("id",e),await T.from("dateguard_messages").insert({session_id:e,sender_type:"bot",sender_name:"VAIRIFY BOT",message_type:"checkin",message:" Check-in confirmed - Timer reset"}),H.success(" Check-in confirmed! Timer reset."),_()},P=async()=>{const D=new Date(Date.now()+18e5);await T.from("dateguard_sessions").update({scheduled_end_at:D.toISOString(),ends_at:D.toISOString()}).eq("id",e),H.success("Time extended by 30 minutes"),_()},A=async()=>{window.confirm("Are you sure you want to end DateGuard early?")&&(await T.from("dateguard_sessions").update({status:"completed",ended_via:"normal"}).eq("id",e),H.success("DateGuard ended safely"),t("/dateguard"))},O=()=>{v(!0),p(0),g.current=setInterval(()=>{p(D=>D>=100?(g.current&&clearInterval(g.current),R(),100):D+100/30)},100)},I=()=>{v(!1),g.current&&(clearInterval(g.current),g.current=null),p(0)},R=async()=>{try{const{data:{user:D}}=await T.auth.getUser();if(!D)return;"vibrate"in navigator&&navigator.vibrate(200),await T.from("dateguard_sessions").update({status:"emergency",ended_via:"panic"}).eq("id",e);const{error:W}=await T.functions.invoke("send-emergency-command-center-sms",{body:{session_id:e,trigger_type:"panic_button"}});W?(console.error("Error triggering ECC:",W),H.error("Emergency triggered but notification failed")):H.error(" PANIC BUTTON - Emergency Command Center activated"),N(!0),t(`/dateguard/emergency/${e}`)}catch(D){console.error("Error handling panic:",D),H.error("Failed to trigger emergency")}},M=()=>{N(!0),t("/dateguard")},B=()=>c>30?"text-green-400":c>10?"text-yellow-400":"text-red-400",$=()=>b||(r==null?void 0:r.status)==="emergency"?"bg-[#FF5722]":"bg-[#1B2B5E]";return r?b&&r.ended_via==="decoy"?s.jsx("div",{className:"min-h-screen bg-[#1B2B5E] text-white flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-6 p-8",children:[s.jsx(ut,{className:"w-20 h-20 mx-auto text-green-400"}),s.jsx("h1",{className:"text-3xl font-bold",children:"DateGuard Ended"}),s.jsx("p",{className:"text-white/70",children:"Your session has been safely concluded."}),s.jsx(L,{onClick:()=>t("/dateguard"),className:"bg-white text-[#1B2B5E] hover:bg-white/90",children:"Return to DateGuard"})]})}):s.jsxs("div",{className:`min-h-screen ${$()} text-white pb-24 transition-colors duration-500`,children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>t("/dateguard"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("h1",{className:"text-xl font-bold",children:" DATEGUARD ACTIVE"}),s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>y(!0),className:"text-white hover:bg-white/10",children:s.jsx(oj,{className:"w-5 h-5"})})]}),s.jsxs("main",{className:"px-4 py-8 space-y-8 max-w-md mx-auto",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsxs("div",{className:`text-8xl font-bold ${B()} transition-colors duration-500`,children:[a.toString().padStart(2,"0"),":",o.toString().padStart(2,"0")]}),s.jsx("p",{className:"text-white/70 text-lg",children:"Time remaining"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs(L,{onClick:k,className:"w-full h-20 text-xl font-bold bg-green-500 hover:bg-green-600 text-white",children:[s.jsx(ut,{className:"w-6 h-6 mr-2"}),"I'm OK"]}),s.jsxs(L,{onClick:P,className:"w-full h-20 text-xl font-bold bg-blue-500 hover:bg-blue-600 text-white",children:[s.jsx(On,{className:"w-6 h-6 mr-2"}),"Extend"]}),s.jsxs(L,{onClick:A,className:"w-full h-20 text-xl font-bold bg-gray-500 hover:bg-gray-600 text-white",children:[s.jsx(vn,{className:"w-6 h-6 mr-2"}),"End Early"]})]}),s.jsx("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 w-full max-w-md px-4",children:s.jsx("button",{onMouseDown:O,onMouseUp:I,onMouseLeave:I,onTouchStart:O,onTouchEnd:I,className:`w-full h-20 rounded-full font-bold text-xl text-white transition-all ${m?"bg-red-700 scale-95":"bg-red-600 hover:bg-red-700"}`,children:m?s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"w-full bg-red-800 rounded-full h-2",children:s.jsx("div",{className:"bg-white h-2 rounded-full transition-all duration-100",style:{width:`${f}%`}})}),s.jsxs("span",{children:["HOLD (",Math.round(f/3.33),"s)"]})]}):s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx(mae,{className:"w-6 h-6"}),s.jsx("span",{children:"PANIC (Hold 3s)"})]})})})]}),s.jsx(H8e,{sessionId:e,isOpen:x,onClose:()=>y(!1),onEmergencyTriggered:M})]}):s.jsx("div",{className:`min-h-screen ${$()} flex items-center justify-center`,children:s.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin"})})}function Y8e(){const{sessionId:e}=us(),t=Oe();Et();const[r,n]=w.useState([]),[a,i]=w.useState(""),[o,l]=w.useState(null),c=w.useRef(null),[u,d]=w.useState(null);w.useEffect(()=>{h(),f(),p(),m()},[e]),w.useEffect(()=>{v()},[r]);const h=async()=>{const{data:{user:y}}=await T.auth.getUser();d(y)},f=async()=>{const{data:y}=await T.from("dateguard_sessions").select("*").eq("id",e).single();l(y)},p=async()=>{const{data:y}=await T.from("dateguard_messages").select("*").eq("session_id",e).order("created_at",{ascending:!0});n(y||[])},m=()=>{const y=T.channel(`messages:${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"dateguard_messages",filter:`session_id=eq.${e}`},b=>{n(N=>[...N,b.new])}).subscribe();return()=>{T.removeChannel(y)}},v=()=>{var y;(y=c.current)==null||y.scrollIntoView({behavior:"smooth"})},g=async()=>{var y;!a.trim()||!u||(await T.from("dateguard_messages").insert({session_id:e,sender_id:u.id,sender_type:"user",sender_name:((y=u.email)==null?void 0:y.split("@")[0])||"User",message_type:"text",message:a}),i(""))},x=y=>y.message_type==="session_start"?s.jsx(q,{className:"bg-gradient-to-r from-[hsl(16,100%,60%)] to-[hsl(32,98%,55%)] border-0 shadow-lg",children:s.jsxs(ee,{className:"p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:""}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-white",children:"VAIRIFY BOT"}),s.jsx("p",{className:"text-xs text-white/80",children:"Just now"})]})]}),s.jsxs("div",{className:"bg-white/10 rounded-lg p-4 space-y-3 text-white",children:[s.jsx("p",{className:"font-bold text-lg",children:" DateGuard Session Started"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Provider:"})," ",u==null?void 0:u.email," "]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Duration:"})," ",o==null?void 0:o.duration_minutes," minutes"]}),s.jsxs("div",{className:"border-t border-white/20 pt-2 mt-2",children:[s.jsx("p",{className:"font-bold",children:" LOCATION:"}),s.jsx("p",{children:o==null?void 0:o.location_name}),s.jsx("p",{className:"text-xs text-white/80",children:o==null?void 0:o.location_address}),s.jsxs("p",{className:"text-xs text-white/80",children:["GPS: ",o==null?void 0:o.location_gps]})]}),s.jsxs(L,{variant:"outline",size:"sm",className:"w-full text-white border-white/30 hover:bg-white/20 mt-2",children:[s.jsx(hn,{className:"w-4 h-4 mr-1"}),"VIEW LIVE MAP"]}),s.jsxs("div",{className:"border-t border-white/20 pt-2 mt-2",children:[s.jsx("p",{className:"font-bold",children:" MEMO:"}),s.jsx("p",{className:"text-white/90",children:o==null?void 0:o.memo})]}),s.jsxs("div",{className:"border-t border-white/20 pt-2 mt-2",children:[s.jsx("p",{className:"font-bold",children:" NEAREST POLICE:"}),s.jsx("p",{children:"Atlanta Police Zone 5"}),s.jsxs("p",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Bc,{className:"w-3 h-3"}),"(404) 624-0674"]}),s.jsx("p",{className:"text-xs text-white/80",children:" 0.8 miles (3-5 min)"}),s.jsx("p",{className:"text-xs text-white/80",children:"2645 Campbellton Rd SW"}),s.jsxs("div",{className:"flex gap-2 mt-2",children:[s.jsx(L,{size:"sm",className:"flex-1 bg-red-600 hover:bg-red-700 text-white",children:" CALL POLICE"}),s.jsx(L,{size:"sm",variant:"outline",className:"flex-1 text-white border-white/30 hover:bg-white/20",children:" DIRECTIONS"})]})]})]})]})]})}):y.message_type==="emergency"?s.jsx(q,{className:"bg-red-600 border-0 shadow-lg animate-pulse",children:s.jsxs(ee,{className:"p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(tn,{className:"w-6 h-6 text-white"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-white",children:"VAIRIFY BOT"}),s.jsx("p",{className:"text-xs text-white/80",children:"Just now"})]})]}),s.jsxs("div",{className:"bg-white/20 rounded-lg p-4 text-white",children:[s.jsx("p",{className:"font-bold text-lg",children:" EMERGENCY ACTIVATED"}),s.jsx("p",{className:"text-sm mt-2",children:"Immediate action required!"})]})]})}):y.sender_type==="bot"?s.jsxs("div",{className:"bg-white/10 rounded-lg p-3 backdrop-blur-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"text-sm",children:""}),s.jsx("p",{className:"text-xs text-white/70",children:"VAIRIFY BOT"})]}),s.jsx("p",{className:"text-sm text-white",children:y.message})]}):s.jsxs("div",{className:"bg-white/10 rounded-lg p-3 backdrop-blur-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:""}),s.jsx("p",{className:"text-xs text-white/70",children:y.sender_name}),s.jsx("p",{className:"text-xs text-white/50 ml-auto",children:new Date(y.created_at).toLocaleTimeString()})]}),s.jsx("p",{className:"text-sm text-white",children:y.message})]});return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[hsl(16,100%,60%)] to-[hsl(32,98%,55%)] flex flex-col",children:[s.jsxs("header",{className:"p-4 flex items-center gap-3 bg-[hsl(16,100%,55%)]/80 backdrop-blur-md sticky top-0 z-10",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>t(`/dateguard/session/${e}`),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h1",{className:"text-lg font-bold text-white",children:" DATEGUARD ACTIVE"}),s.jsx("p",{className:"text-xs text-white/80",children:"Sarah K. - Atlanta Group"})]})]}),s.jsxs("main",{className:"flex-1 overflow-y-auto p-4 space-y-4 pb-24",children:[r.map(y=>s.jsx("div",{children:x(y)},y.id)),s.jsx("div",{ref:c})]}),s.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-[hsl(16,100%,55%)]/95 backdrop-blur-md border-t border-white/20",children:s.jsxs("div",{className:"max-w-2xl mx-auto flex gap-2",children:[s.jsx(De,{value:a,onChange:y=>i(y.target.value),onKeyPress:y=>y.key==="Enter"&&g(),placeholder:"Type message...",className:"bg-white/20 border-white/30 text-white placeholder:text-white/60"}),s.jsx(L,{onClick:g,className:"bg-white text-[hsl(16,100%,60%)] hover:bg-white/90",children:s.jsx(Nx,{className:"w-4 h-4"})})]})})]})}const XL=({value:e,onChange:t,maxLength:r=3})=>{const n=o=>{e.length<r&&t(e+o)},a=()=>{t(e.slice(0,-1))},i=()=>{t("")};return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex justify-center gap-4 mb-8",children:Array.from({length:r}).map((o,l)=>s.jsx("div",{className:"w-16 h-16 rounded-xl border-2 border-primary/30 bg-muted flex items-center justify-center",children:e[l]?s.jsx("div",{className:"w-4 h-4 rounded-full bg-primary"}):s.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-muted-foreground/30"})},l))}),s.jsxs("div",{className:"grid grid-cols-3 gap-3 max-w-xs mx-auto",children:[[1,2,3,4,5,6,7,8,9].map(o=>s.jsx(L,{onClick:()=>n(o.toString()),variant:"outline",className:"h-16 text-2xl font-semibold hover:bg-primary/10 hover:border-primary transition-all",children:o},o)),s.jsx(L,{onClick:a,variant:"outline",className:"h-16 hover:bg-destructive/10 hover:border-destructive transition-all",children:s.jsx(az,{className:"w-5 h-5"})}),s.jsx(L,{onClick:()=>n("0"),variant:"outline",className:"h-16 text-2xl font-semibold hover:bg-primary/10 hover:border-primary transition-all",children:"0"}),s.jsx(L,{onClick:i,variant:"outline",className:"h-16 hover:bg-primary/10 hover:border-primary transition-all",disabled:e.length===0,children:s.jsx($t,{className:"w-5 h-5"})})]})]})},ty=({isActive:e,onStreamReady:t})=>{const r=w.useRef(null),n=w.useRef(null);w.useEffect(()=>(e&&!n.current&&a(),()=>{i()}),[e]);const a=async()=>{try{const o=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!1});r.current&&(r.current.srcObject=o,n.current=o,t==null||t(o))}catch(o){console.error("Camera access error:",o)}},i=()=>{n.current&&(n.current.getTracks().forEach(o=>o.stop()),n.current=null)};return s.jsxs("div",{className:"relative aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[s.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),s.jsxs("div",{className:"absolute inset-0 flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/60"}),s.jsxs("div",{className:"relative z-10",children:[s.jsxs("div",{className:"relative w-64 h-64",children:[s.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 100 100",children:[s.jsx("circle",{cx:"50",cy:"50",r:"48",fill:"none",stroke:"hsl(var(--primary))",strokeWidth:"2",className:"opacity-80"}),s.jsx("circle",{cx:"50",cy:"50",r:"48",fill:"none",stroke:"hsl(var(--primary))",strokeWidth:"3",strokeDasharray:"75 225",strokeLinecap:"round",className:"animate-spin opacity-100",style:{transformOrigin:"center",animationDuration:"2s"}})]}),s.jsx("div",{className:"absolute top-4 left-4 w-6 h-6 border-l-3 border-t-3 border-primary rounded-tl-lg"}),s.jsx("div",{className:"absolute top-4 right-4 w-6 h-6 border-r-3 border-t-3 border-primary rounded-tr-lg"}),s.jsx("div",{className:"absolute bottom-4 left-4 w-6 h-6 border-l-3 border-b-3 border-primary rounded-bl-lg"}),s.jsx("div",{className:"absolute bottom-4 right-4 w-6 h-6 border-r-3 border-b-3 border-primary rounded-br-lg"})]}),s.jsx("div",{className:"absolute -bottom-12 left-1/2 transform -translate-x-1/2 whitespace-nowrap",children:s.jsx("span",{className:"text-white text-sm font-medium bg-black/70 px-4 py-2 rounded-full border border-primary/30",children:"Position face in circle"})})]})]})]})};function X8e(){const e=Oe(),{toast:t}=Et(),[r,n]=w.useState("face-verify"),[a,i]=w.useState(""),[o,l]=w.useState(""),[c,u]=w.useState(null),[d,h]=w.useState(null);w.useEffect(()=>{f()},[]);const f=async()=>{const{data:{user:b}}=await T.auth.getUser();if(!b)return;const{data:N,error:j}=await T.from("safety_codes").select("*").eq("user_id",b.id).maybeSingle();N&&!j&&u({deactivation:N.deactivation_code,decoy:N.decoy_code})},p=()=>{n(c?"final":"intro")},m=()=>{r==="face-verify"?e("/dateguard"):r==="intro"?n("face-verify"):r==="deactivation"?n("intro"):r==="decoy"?n("deactivation"):r==="final"&&e("/dateguard")},v=async()=>{r==="intro"?n("deactivation"):r==="deactivation"&&a.length===3?n("decoy"):r==="decoy"&&o.length===3&&o!==a?await g():r==="final"&&d&&await x()},g=async()=>{const{data:{user:b}}=await T.auth.getUser();if(!b)return;const{error:N}=await T.from("safety_codes").insert({user_id:b.id,deactivation_code:a,decoy_code:o});if(N){t({title:"Error",description:"Failed to save codes. Please try again.",variant:"destructive"});return}u({deactivation:a,decoy:o}),n("final"),t({title:"Success",description:"Safety codes saved successfully"})},x=async()=>{const{data:{user:b}}=await T.auth.getUser();if(!b||!d)return;const N=d==="deactivation"?{deactivation_code:a}:{decoy_code:o},{error:j}=await T.from("safety_codes").update(N).eq("user_id",b.id);if(j){t({title:"Error",description:"Failed to update code. Please try again.",variant:"destructive"});return}await f(),h(null),i(""),l(""),t({title:"Success",description:"Code updated successfully"})},y=b=>{h(b),n("face-verify")};return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[hsl(265,70%,20%)] to-[hsl(270,60%,30%)] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center border-b border-white/10",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:m,className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("h1",{className:"ml-3 text-lg font-semibold",children:r==="face-verify"?"Face Verification":"SAFETY CODES"})]}),r==="face-verify"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-4 py-8 space-y-6",children:[s.jsx("div",{className:"w-20 h-20 bg-white/10 rounded-full flex items-center justify-center",children:s.jsx(Na,{className:"w-10 h-10 text-white"})}),s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Verify It's You"}),s.jsx("p",{className:"text-white/80 max-w-sm",children:d?"Facial verification required to edit codes":c?"Facial verification required to view codes":"Facial verification required to set codes"})]}),s.jsx(ty,{isActive:!0,onStreamReady:()=>{}})]}),s.jsx("div",{className:"p-4",children:s.jsx("div",{className:"space-y-3",children:s.jsx(L,{onClick:p,className:"w-full h-14 text-lg",children:"Verify & Continue"})})})]}),r==="intro"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-4 py-8 space-y-8",children:[s.jsx("div",{className:"w-24 h-24 bg-white/10 rounded-full flex items-center justify-center",children:s.jsx(Or,{className:"w-12 h-12 text-white"})}),s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Setup Safety Codes"}),s.jsx("p",{className:"text-white/80 max-w-sm",children:"Safety codes let your guardians verify you're safe during emergencies."})]}),s.jsxs("div",{className:"bg-white/5 border border-white/20 rounded-lg p-6 max-w-sm space-y-4",children:[s.jsx("p",{className:"text-sm text-white/90",children:"You'll create:"}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-primary",children:""}),s.jsx("span",{children:"Deactivation Code (real)"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-destructive",children:""}),s.jsx("span",{children:"Decoy Code (alert)"})]})]})]}),s.jsxs("div",{className:"bg-white/5 border border-white/20 rounded-lg p-6 max-w-sm space-y-3",children:[s.jsx("h3",{className:"font-semibold text-sm",children:"HOW IT WORKS:"}),s.jsx("p",{className:"text-sm text-white/80",children:"If guardian asks for your code:"}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(EC,{className:"w-4 h-4 text-primary mt-0.5"}),s.jsx("span",{children:"Give DEACTIVATION code = You're safe"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(tn,{className:"w-4 h-4 text-destructive mt-0.5"}),s.jsx("span",{children:"Give DECOY code = Silent alert"})]})]})]})]}),s.jsx("div",{className:"p-4",children:s.jsx(L,{onClick:v,className:"w-full h-14 text-lg",children:"Start Setup"})})]}),r==="deactivation"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-4 py-8 space-y-6",children:[s.jsx("div",{className:"w-20 h-20 bg-white/10 rounded-full flex items-center justify-center",children:s.jsx(Or,{className:"w-10 h-10 text-primary"})}),s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Set Deactivation Code"}),s.jsx("p",{className:"text-white/80",children:"Enter a 3-digit code"})]}),s.jsx(XL,{value:a,onChange:i,maxLength:3}),s.jsx(q,{className:"bg-white/5 border-white/20 max-w-sm",children:s.jsxs(ee,{className:"p-4 space-y-2",children:[s.jsx("h3",{className:"font-semibold text-sm text-white",children:"What is the Deactivation Code?"}),s.jsxs("p",{className:"text-sm text-white/80",children:["This is your ",s.jsx("strong",{children:"real safety code"}),". When guardians ask for your code and you give them this one, it confirms you're safe and everything is okay."]})]})}),s.jsx("div",{className:"bg-white/5 border border-white/20 rounded-lg p-4 max-w-sm",children:s.jsx("p",{className:"text-sm text-white/80",children:" Choose something memorable but not obvious"})})]}),s.jsx("div",{className:"p-4",children:s.jsx(L,{onClick:v,disabled:a.length!==3,className:"w-full h-14 text-lg",children:"Continue"})})]}),r==="decoy"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-4 py-8 space-y-6",children:[s.jsx("div",{className:"w-20 h-20 bg-white/10 rounded-full flex items-center justify-center",children:s.jsx(tn,{className:"w-10 h-10 text-destructive"})}),s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Set Decoy Code"}),s.jsx("p",{className:"text-white/80",children:"Enter a DIFFERENT 3-digit code"})]}),s.jsx(XL,{value:o,onChange:l,maxLength:3}),s.jsx(q,{className:"bg-white/5 border-white/20 max-w-sm",children:s.jsxs(ee,{className:"p-4 space-y-2",children:[s.jsx("h3",{className:"font-semibold text-sm text-white",children:"What is the Decoy Code?"}),s.jsxs("p",{className:"text-sm text-white/80",children:["This is your ",s.jsx("strong",{children:"emergency alert code"}),". If you're in danger and give this code to guardians, it will silently alert them that you need help without the other person knowing."]})]})}),s.jsxs("div",{className:"bg-destructive/20 border border-destructive/50 rounded-lg p-4 max-w-sm space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(tn,{className:"w-5 h-5 text-destructive"}),s.jsx("h3",{className:"font-semibold text-sm",children:"WARNING"})]}),s.jsx("p",{className:"text-sm text-white/90",children:"Giving this code triggers a SILENT ALERT to all guardians without the other person knowing."})]})]}),s.jsx("div",{className:"p-4",children:s.jsx(L,{onClick:v,disabled:o.length!==3||o===a,className:"w-full h-14 text-lg",children:"Continue"})})]}),r==="final"&&c&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-4 py-8 space-y-8",children:[s.jsx("div",{className:"w-32 h-32 bg-primary/20 rounded-full flex items-center justify-center",children:s.jsx(EC,{className:"w-16 h-16 text-primary"})}),s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-3xl font-bold text-primary",children:"Codes Active"}),s.jsx("p",{className:"text-white/80 max-w-sm",children:"Your safety codes are set and ready"})]}),s.jsxs("div",{className:"space-y-4 w-full max-w-sm",children:[s.jsx(q,{className:"bg-white/5 border-white/20",children:s.jsxs(ee,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("p",{className:"text-sm text-white/60",children:"Deactivation Code"}),s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>y("deactivation"),className:"h-8 w-8",children:s.jsx(TC,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-2xl font-mono text-white",children:""}),s.jsx("p",{className:"text-xs text-white/50 mt-2",children:"Real safety code - confirms you're safe"})]})}),s.jsx(q,{className:"bg-white/5 border-white/20",children:s.jsxs(ee,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("p",{className:"text-sm text-white/60",children:"Decoy Code"}),s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>y("decoy"),className:"h-8 w-8",children:s.jsx(TC,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-2xl font-mono text-white",children:""}),s.jsx("p",{className:"text-xs text-destructive/70 mt-2",children:"Emergency code - silent alert"})]})})]}),s.jsx("div",{className:"bg-white/5 border border-white/20 rounded-lg p-4 max-w-sm",children:s.jsxs("p",{className:"text-sm text-white/80",children:[" ",s.jsx("strong",{children:"TIP:"})," Tap the edit icon to update either code with facial verification."]})})]}),s.jsx("div",{className:"p-4",children:s.jsx(L,{onClick:()=>e("/dateguard"),className:"w-full h-14 text-lg",children:"Done"})})]})]})}function Q8e(){const e=Oe();Et();const[t,r]=w.useState("disarm"),[n,a]=w.useState(""),[i,o]=w.useState(""),[l,c]=w.useState(""),[u,d]=w.useState(""),[h,f]=w.useState(!1),p=async y=>{const N=new TextEncoder().encode(y),j=await crypto.subtle.digest("SHA-256",N);return Array.from(new Uint8Array(j)).map(S=>S.toString(16).padStart(2,"0")).join("")},m=()=>{if(n.length<4){H.error("Code must be at least 4 digits");return}r("confirm-disarm"),o("")},v=()=>{if(n!==i){H.error("Codes don't match. Please try again."),o("");return}r("decoy"),c("")},g=()=>{if(l.length<4){H.error("Code must be at least 4 digits");return}if(l===n){H.error("Decoy code must be different from disarm code"),c("");return}r("confirm-decoy"),d("")},x=async()=>{if(l!==u){H.error("Codes don't match. Please try again."),d("");return}f(!0);try{const{data:{user:y}}=await T.auth.getUser();if(!y){e("/login");return}const{data:b}=await T.from("profiles").select("vai_number").eq("id",y.id).single(),N=await p(n),j=await p(l),{error:_}=await T.from("dateguard_codes").upsert({user_id:y.id,user_vai:(b==null?void 0:b.vai_number)||null,disarm_code_hash:N,decoy_code_hash:j,updated_at:new Date().toISOString()},{onConflict:"user_id"});if(_)throw _;H.success("Codes saved successfully!"),e("/dateguard/setup/groups")}catch(y){console.error("Error saving codes:",y),H.error(y.message||"Failed to save codes")}finally{f(!1)}};return t==="disarm"?s.jsxs("div",{className:"min-h-screen bg-[#1B2B5E] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/dateguard"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("h1",{className:"text-xl font-bold",children:"Set Disarm Code"}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-8 max-w-md mx-auto space-y-8",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(lt,{className:"w-16 h-16 mx-auto text-white/80"}),s.jsx("p",{className:"text-white/90 text-lg",children:"Enter 4-6 digit code"}),s.jsx("p",{className:"text-white/60 text-sm",children:"This code turns off DateGuard safely"})]}),s.jsx(hv,{value:n,onChange:a,maxLength:6}),s.jsx(L,{onClick:m,disabled:n.length<4,className:"w-full h-14 text-lg font-semibold bg-white text-[#1B2B5E] hover:bg-white/90",children:"Continue"})]})]}):t==="confirm-disarm"?s.jsxs("div",{className:"min-h-screen bg-[#1B2B5E] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>r("disarm"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("h1",{className:"text-xl font-bold",children:"Confirm Disarm Code"}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-8 max-w-md mx-auto space-y-8",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(lt,{className:"w-16 h-16 mx-auto text-white/80"}),s.jsx("p",{className:"text-white/90 text-lg",children:"Re-enter your code"})]}),s.jsx(hv,{value:i,onChange:o,maxLength:6}),s.jsx(L,{onClick:v,disabled:i.length!==n.length,className:"w-full h-14 text-lg font-semibold bg-white text-[#1B2B5E] hover:bg-white/90",children:"Confirm"})]})]}):t==="decoy"?s.jsxs("div",{className:"min-h-screen bg-[#1B2B5E] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>r("confirm-disarm"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("h1",{className:"text-xl font-bold",children:"Set Decoy Code"}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-8 max-w-md mx-auto space-y-8",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(tn,{className:"w-16 h-16 mx-auto text-white/80"}),s.jsx("p",{className:"text-white/90 text-lg",children:"Enter different 4-6 digit code"}),s.jsx("p",{className:"text-white/60 text-sm",children:"This code silently alerts guardians while appearing normal"})]}),s.jsx(hv,{value:l,onChange:c,maxLength:6}),s.jsx(L,{onClick:g,disabled:l.length<4,className:"w-full h-14 text-lg font-semibold bg-white text-[#1B2B5E] hover:bg-white/90",children:"Continue"})]})]}):s.jsxs("div",{className:"min-h-screen bg-[#1B2B5E] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>r("decoy"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("h1",{className:"text-xl font-bold",children:"Confirm Decoy Code"}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-8 max-w-md mx-auto space-y-8",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(tn,{className:"w-16 h-16 mx-auto text-white/80"}),s.jsx("p",{className:"text-white/90 text-lg",children:"Re-enter your decoy code"})]}),s.jsx(hv,{value:u,onChange:d,maxLength:6}),s.jsx(L,{onClick:x,disabled:u.length!==l.length||h,className:"w-full h-14 text-lg font-semibold bg-white text-[#1B2B5E] hover:bg-white/90",children:h?"Saving...":"Save Codes"})]})]})}const Z8e=[{name:"Family",members:[]},{name:"Best Friends",members:[]},{name:"Security",members:[]},{name:"Work",members:[]}];function J8e(){const e=Oe(),[t,r]=w.useState([]),[n,a]=w.useState(new Set),[i,o]=w.useState(!0);w.useEffect(()=>{l()},[]);const l=async()=>{try{const{data:{user:d}}=await T.auth.getUser();if(!d){e("/login");return}const{data:h}=await T.from("profiles").select("vai_number").eq("id",d.id).single(),{data:f,error:p}=await T.from("guardian_groups").select("*").eq("user_id",d.id);if(p)throw p;if(!f||f.length===0){const m=Z8e.map(x=>({user_id:d.id,user_vai:(h==null?void 0:h.vai_number)||null,group_name:x.name,members:x.members})),{data:v,error:g}=await T.from("guardian_groups").insert(m).select();if(g)throw g;r(v||[])}else r(f)}catch(d){console.error("Error fetching groups:",d),H.error("Failed to load groups")}finally{o(!1)}},c=d=>{const h=new Set(n);h.has(d)?h.delete(d):h.add(d),a(h)},u=()=>{if(n.size===0){H.error("Please select at least one group");return}sessionStorage.setItem("dateguard_selected_groups",JSON.stringify(Array.from(n))),e("/dateguard/activate")};return i?s.jsx("div",{className:"min-h-screen bg-[#1B2B5E] text-white flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),s.jsx("p",{children:"Loading groups..."})]})}):s.jsxs("div",{className:"min-h-screen bg-[#1B2B5E] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/dateguard"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("h1",{className:"text-xl font-bold",children:"Select Groups"}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-6 max-w-md mx-auto space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(An,{className:"w-12 h-12 mx-auto text-white/80"}),s.jsx("p",{className:"text-white/90",children:"Choose which groups to notify for this session"})]}),s.jsx("div",{className:"space-y-3",children:t.map(d=>s.jsx(JX,{group:{id:d.id,name:d.group_name||d.name,members:d.members||[]},selected:n.has(d.id),onSelect:()=>c(d.id)},d.id))}),s.jsxs(L,{onClick:u,disabled:n.size===0,className:"w-full h-14 text-lg font-semibold bg-white text-[#1B2B5E] hover:bg-white/90",children:["Continue (",n.size," ",n.size===1?"group":"groups"," selected)"]})]})]})}function eWe(){var v,g;const{sessionId:e}=us(),t=Oe(),[r,n]=w.useState(null),[a,i]=w.useState([]),[o,l]=w.useState(!0);w.useEffect(()=>{if(e){c();const x=setInterval(c,5e3);return()=>clearInterval(x)}},[e]);const c=async()=>{try{const{data:x}=await T.from("dateguard_sessions").select(`
          *,
          user:profiles!dateguard_sessions_user_id_fkey(full_name, vai_number)
        `).eq("id",e).single();n(x);const{data:y}=await T.from("emergency_command_center_messages").select("*").eq("session_id",e).order("created_at",{ascending:!1});i(y||[])}catch(x){console.error("Error fetching data:",x)}finally{l(!1)}},u=async()=>{window.confirm("Mark this emergency as resolved?")&&(await T.from("dateguard_sessions").update({status:"completed"}).eq("id",e),H.success("Emergency marked as resolved"),t("/dateguard"))},d=()=>{window.location.href="tel:911"},h=()=>{const x=r==null?void 0:r.nearest_police;x!=null&&x.phone?window.location.href=`tel:${x.phone.replace(/\D/g,"")}`:H.error("Police phone number not available")};if(o)return s.jsx("div",{className:"min-h-screen bg-[#FF5722] text-white flex items-center justify-center",children:s.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin"})});if(!r)return s.jsx("div",{className:"min-h-screen bg-[#FF5722] text-white flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Session Not Found"}),s.jsx(L,{onClick:()=>t("/dateguard"),children:"Return to DateGuard"})]})});const f=r.nearest_police||{},p=r.gps_coordinates||{},m=`https://www.google.com/maps/search/?api=1&query=${p.lat||0},${p.lng||0}`;return s.jsxs("div",{className:"min-h-screen bg-[#FF5722] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between bg-[#FF5722]/90 backdrop-blur-sm",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>t("/dateguard"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("h1",{className:"text-xl font-bold",children:" EMERGENCY COMMAND CENTER"}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-6 space-y-6 max-w-2xl mx-auto pb-24",children:[s.jsxs(q,{className:"bg-white/10 border-white/20",children:[s.jsx(ge,{children:s.jsxs(be,{className:"text-white flex items-center gap-2",children:[s.jsx(An,{className:"w-5 h-5"}),"User Information"]})}),s.jsxs(ee,{className:"space-y-2",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-semibold",children:"Name:"})," ",((v=r.user)==null?void 0:v.full_name)||"Unknown"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-semibold",children:"VAI:"})," ",((g=r.user)==null?void 0:g.vai_number)||"Not available"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-semibold",children:"Meeting Time:"})," ",new Date(r.started_at).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})," - ",new Date(r.scheduled_end_at||r.ends_at).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-semibold",children:"Triggered:"})," ",r.ended_via==="panic"?"Panic Button":r.ended_via==="decoy"?"Decoy Code":r.ended_via==="timer_expiration"?"Timer Expired":"Unknown"]})]})]}),s.jsxs(q,{className:"bg-white/10 border-white/20",children:[s.jsx(ge,{children:s.jsxs(be,{className:"text-white flex items-center gap-2",children:[s.jsx(hn,{className:"w-5 h-5"}),"Current Location"]})}),s.jsxs(ee,{className:"space-y-2",children:[s.jsx("p",{className:"font-semibold",children:r.location_address||"Not available"}),s.jsxs("p",{className:"text-sm text-white/80",children:["GPS: ",p.lat?`${p.lat.toFixed(4)}N, ${Math.abs(p.lng||0).toFixed(4)}W`:"Not available"]}),s.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"text-blue-300 underline text-sm",children:"Open in Google Maps"}),r.last_gps_update&&s.jsxs("p",{className:"text-xs text-white/60",children:["Last update: ",new Date(r.last_gps_update).toLocaleTimeString()]})]})]}),s.jsxs(q,{className:"bg-white/10 border-white/20",children:[s.jsx(ge,{children:s.jsx(be,{className:"text-white",children:"Pre-Meeting Intel"})}),s.jsxs(ee,{className:"space-y-3",children:[r.pre_activation_notes&&s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold mb-1",children:"Notes:"}),s.jsx("p",{className:"text-white/90",children:r.pre_activation_notes})]}),r.pre_activation_photos&&r.pre_activation_photos.length>0&&s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold mb-2",children:"Photos:"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:r.pre_activation_photos.map((x,y)=>s.jsx("img",{src:x,alt:`Intel photo ${y+1}`,className:"w-full h-32 object-cover rounded-lg"},y))})]})]})]}),f.name&&s.jsxs(q,{className:"bg-white/10 border-white/20",children:[s.jsx(ge,{children:s.jsxs(be,{className:"text-white flex items-center gap-2",children:[s.jsx(lt,{className:"w-5 h-5"}),"Nearest Police Station"]})}),s.jsxs(ee,{className:"space-y-3",children:[s.jsx("p",{className:"font-semibold",children:f.name}),s.jsx("p",{className:"text-white/90",children:f.address}),s.jsx("p",{className:"text-white/90",children:f.phone}),s.jsxs("p",{className:"text-sm text-white/80",children:[f.distance," miles away"]}),s.jsxs(L,{onClick:h,className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:[s.jsx(Bc,{className:"w-4 h-4 mr-2"}),"Call Police Station"]})]})]}),r.encounter_id&&s.jsxs(q,{className:"bg-white/10 border-white/20",children:[s.jsx(ge,{children:s.jsx(be,{className:"text-white",children:"Partner Information"})}),s.jsxs(ee,{children:[s.jsxs("p",{className:"text-white/90",children:["VAI: ",r.partner_vai||"Not available"]}),s.jsx("p",{className:"text-sm text-white/60 mt-1",children:"View full profile in app"})]})]}),a.filter(x=>x.message_type==="gps_update").length>0&&s.jsxs(q,{className:"bg-white/10 border-white/20",children:[s.jsx(ge,{children:s.jsxs(be,{className:"text-white flex items-center gap-2",children:[s.jsx(hn,{className:"w-5 h-5"}),"GPS Updates"]})}),s.jsx(ee,{className:"space-y-2 max-h-48 overflow-y-auto",children:a.filter(x=>x.message_type==="gps_update").map((x,y)=>s.jsxs("div",{className:"text-sm text-white/80 border-b border-white/10 pb-2",children:[s.jsx("p",{children:x.content}),s.jsx("p",{className:"text-xs text-white/60",children:new Date(x.created_at).toLocaleTimeString()})]},y))})]}),s.jsx("div",{className:"space-y-3 fixed bottom-6 left-1/2 -translate-x-1/2 w-full max-w-2xl px-4",children:s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs(L,{onClick:u,className:"h-16 bg-green-600 hover:bg-green-700 text-white text-lg font-bold",children:[s.jsx(ut,{className:"w-5 h-5 mr-2"}),"Mark Safe"]}),s.jsxs(L,{onClick:d,className:"h-16 bg-red-600 hover:bg-red-700 text-white text-lg font-bold",children:[s.jsx(Bc,{className:"w-5 h-5 mr-2"}),"Call 911"]})]})})]})]})}function tWe(){const e=Oe(),{toast:t}=Et(),[r,n]=w.useState(!1),[a,i]=w.useState("60"),o=async()=>{n(!0);try{const{data:{user:l}}=await T.auth.getUser();if(!l){t({title:"Error",description:"You must be logged in",variant:"destructive"});return}const c=new Date,u=new Date(c.getTime()+parseInt(a)*6e4),{data:d,error:h}=await T.from("dateguard_sessions").insert({user_id:l.id,location_name:"Test Location - Starbucks Downtown",location_address:"123 Main St, Atlanta, GA 30303",location_gps:"33.7490,-84.3880",memo:"Testing emergency mode",duration_minutes:parseInt(a),started_at:c.toISOString(),ends_at:u.toISOString(),status:"active"}).select().single();if(h)throw h;await T.from("dateguard_messages").insert({session_id:d.id,sender_type:"bot",sender_name:"VAIRIFY BOT",message_type:"session_start",message:` DateGuard session started
 ${d.location_name}
 ${a} minutes`,metadata:{location:d.location_address,duration:a}}),t({title:" Test Session Created",description:"Navigating to active session..."}),setTimeout(()=>{e(`/dateguard/session/${d.id}`)},500)}catch(l){t({title:"Error",description:l.message,variant:"destructive"})}finally{n(!1)}};return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[hsl(265,70%,20%)] to-[hsl(270,60%,30%)] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/dateguard"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("h1",{className:"text-xl font-bold",children:" Test Emergency Mode"}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-6 space-y-6 max-w-md mx-auto",children:[s.jsx(q,{className:"bg-amber-500/20 border-amber-500/30 backdrop-blur-sm",children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(tn,{className:"w-5 h-5 text-amber-400 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-sm text-white/90",children:[s.jsx("p",{className:"font-semibold text-white mb-1",children:"Testing Mode"}),s.jsx("p",{children:"This creates a test DateGuard session so you can test emergency features without affecting real data."})]})]})})}),s.jsxs(q,{className:"bg-white/10 border-white/20 backdrop-blur-sm",children:[s.jsx(ge,{children:s.jsx(be,{className:"text-white",children:"Create Test Session"})}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"duration",className:"text-white",children:"Session Duration (minutes)"}),s.jsx(De,{id:"duration",type:"number",value:a,onChange:l=>i(l.target.value),min:"1",max:"480",className:"bg-white/10 border-white/20 text-white placeholder:text-white/50"}),s.jsx("p",{className:"text-xs text-white/60",children:"Tip: Use 1-5 minutes for quick testing"})]}),s.jsx(L,{onClick:o,disabled:r,className:"w-full bg-gradient-to-r from-[hsl(188,95%,43%)] to-[hsl(188,95%,53%)] hover:shadow-lg hover:shadow-cyan-500/50",children:r?"Creating Session...":"START TEST SESSION"})]})]}),s.jsxs(q,{className:"bg-white/10 border-white/20 backdrop-blur-sm",children:[s.jsx(ge,{children:s.jsx(be,{className:"text-white text-sm",children:"How to Test Emergency"})}),s.jsxs(ee,{className:"space-y-3 text-sm text-white/80",children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("span",{className:"flex-shrink-0 font-bold",children:"1."}),s.jsx("p",{children:"Create a test session above"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("span",{className:"flex-shrink-0 font-bold",children:"2."}),s.jsx("p",{children:"You'll be taken to the Active Session page"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("span",{className:"flex-shrink-0 font-bold",children:"3."}),s.jsx("p",{children:'Click the red "PANIC " button to trigger emergency mode'})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("span",{className:"flex-shrink-0 font-bold",children:"4."}),s.jsx("p",{children:"Check the Guardian Chat to see emergency messages"})]})]})]})]})]})}function rWe(){const e=Oe();return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/feed"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/vai-check/help"),className:"text-white hover:bg-white/10",children:s.jsx(A0,{className:"w-5 h-5"})})]}),s.jsxs("main",{className:"px-4 py-8 max-w-md mx-auto space-y-8",children:[s.jsx("div",{className:"text-center space-y-2",children:s.jsx("h1",{className:"text-3xl font-bold",children:" V.A.I.-CHECK"})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-lg font-semibold text-white/90",children:"Pending Meetings"}),s.jsx(ZX,{})]}),s.jsx("div",{className:"flex justify-center",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 bg-cyan-400/20 rounded-full blur-2xl animate-pulse"}),s.jsx("div",{className:"relative w-24 h-24 bg-gradient-to-br from-cyan-400/20 to-blue-500/20 rounded-full flex items-center justify-center border-2 border-cyan-400/50",children:s.jsx(lt,{className:"w-12 h-12 text-cyan-400"})})]})}),s.jsx("div",{className:"text-center space-y-2",children:s.jsx("h2",{className:"text-2xl font-bold",children:"Verify Identity Before Meeting"})}),s.jsx(q,{className:"bg-white/5 border-cyan-400/30",children:s.jsxs(ee,{className:"p-6 space-y-4",children:[s.jsx("h3",{className:"font-semibold text-lg",children:"How it works:"}),s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-cyan-400 font-bold",children:"1"}),s.jsx("span",{children:"You scan your face"})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-cyan-400 font-bold",children:"2"}),s.jsx("span",{children:"Show QR code to other person"})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-cyan-400 font-bold",children:"3"}),s.jsx("span",{children:"They scan your QR code"})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-cyan-400 font-bold",children:"4"}),s.jsx("span",{children:"You BOTH see each other's profiles & reviews"})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-cyan-400 font-bold",children:"5"}),s.jsx("span",{children:"You BOTH decide: Accept or Decline"})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-cyan-400 font-bold",children:"6"}),s.jsx("span",{children:"Sign contract together"})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-cyan-400 font-bold",children:"7"}),s.jsx("span",{children:"Final face verification"})]})]}),s.jsxs("div",{className:"bg-cyan-400/10 border border-cyan-400/30 rounded-lg p-3 space-y-1",children:[s.jsxs("p",{className:"text-sm font-medium flex items-center gap-2",children:[s.jsx(ut,{className:"w-4 h-4 text-green-400"}),"Takes 2-3 minutes"]}),s.jsxs("p",{className:"text-sm font-medium flex items-center gap-2",children:[s.jsx(ut,{className:"w-4 h-4 text-green-400"}),"Prevents all catfishing"]})]})]})}),s.jsx(L,{onClick:()=>e("/vai-check/face-scan"),className:"w-full h-14 text-lg bg-gradient-to-r from-cyan-500 to-cyan-600 hover:from-cyan-600 hover:to-cyan-700 text-white font-semibold shadow-lg shadow-cyan-500/50",children:"START V.A.I.-CHECK"}),s.jsx("div",{className:"text-center",children:s.jsx("button",{onClick:()=>e("/vai-check/scan-qr"),className:"text-sm text-white/60 hover:text-white/80 transition-colors",children:"I'm the Client - Scan QR Code"})})]})]})}const nWe=zp("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Hn=w.forwardRef(({className:e,variant:t,...r},n)=>s.jsx("div",{ref:n,role:"alert",className:me(nWe({variant:t}),e),...r}));Hn.displayName="Alert";const aWe=w.forwardRef(({className:e,...t},r)=>s.jsx("h5",{ref:r,className:me("mb-1 font-medium leading-none tracking-tight",e),...t}));aWe.displayName="AlertTitle";const Kn=w.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:me("text-sm [&_p]:leading-relaxed",e),...t}));Kn.displayName="AlertDescription";const QL={system_failure:"System Failure",individual_issue:"Individual Issue",failed_verification:"Failed Verification"},sWe={system_failure:"A technical glitch prevented automatic verification from working properly. This is not a security concern - your identity is still valid.",individual_issue:"The user was unable to complete automatic verification. This may be due to camera issues, lighting conditions, or temporary technical problems.",failed_verification:"The automatic face verification did not pass. The photos may not match, or there may be other verification issues."},eQ=({open:e,onClose:t,onConfirm:r,failureReason:n,role:a,loading:i=!1})=>{const[o,l]=w.useState(!1),[c,u]=w.useState(!1),d=()=>{o&&c&&r()},h=a==="owner",f=a==="reviewer";return s.jsx(Ca,{open:e,onOpenChange:t,children:s.jsxs(oa,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(Ea,{children:[s.jsxs(ka,{className:"flex items-center gap-2 text-xl",children:[s.jsx(lt,{className:"w-6 h-6 text-primary"}),"Manual Verification Warning"]}),s.jsx(pu,{className:"text-base",children:"Important information about manual verification and liability."})]}),s.jsxs("div",{className:"space-y-6 py-4",children:[s.jsxs(Hn,{variant:"destructive",className:"border-2",children:[s.jsx(tn,{className:"h-5 w-5"}),s.jsxs(Kn,{className:"space-y-2",children:[s.jsx("div",{className:"font-semibold",children:"Verification Failure Reason:"}),s.jsx(xe,{variant:"destructive",className:"text-sm",children:QL[n]}),s.jsx("p",{className:"text-sm mt-2",children:sWe[n]})]})]}),s.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-3",children:[s.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[s.jsx(ut,{className:"w-5 h-5 text-primary"}),"What This Means"]}),h&&s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsx("p",{children:" You are requesting manual verification by another VAI-verified user"}),s.jsx("p",{children:" Your VAI photo and live selfie will be sent to the other party for review"}),s.jsx("p",{children:" The reviewer will compare your photos and make a decision"}),s.jsx("p",{children:" This process may take several minutes"})]}),f&&s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsx("p",{children:" You have been requested to manually verify another user"}),s.jsx("p",{children:" You will review their VAI photo and live selfie"}),s.jsx("p",{children:" Compare the photos and decide if they match"}),s.jsx("p",{children:" Your decision will determine if verification proceeds"})]})]}),s.jsxs("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4 space-y-3",children:[s.jsxs("h3",{className:"font-semibold flex items-center gap-2 text-warning-foreground",children:[s.jsx(tn,{className:"w-5 h-5"}),"Liability Waiver & Terms"]}),s.jsxs("div",{className:"text-sm space-y-2 text-muted-foreground",children:[s.jsx("p",{children:s.jsx("strong",{children:"By proceeding with manual verification, you acknowledge:"})}),s.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[s.jsx("li",{children:"Manual verification is a fallback process when automatic verification fails"}),s.jsx("li",{children:"Verification decisions are based on human review, which may have limitations"}),s.jsx("li",{children:"You understand the reasons for manual verification as stated above"}),s.jsx("li",{children:"You consent to sharing verification photos with the reviewing party"}),s.jsx("li",{children:"All verification data is stored securely and used only for verification purposes"}),f&&s.jsx("li",{children:"You will review photos honestly and make a fair assessment"})]}),s.jsxs("p",{className:"mt-2",children:[s.jsx("strong",{children:"Liability:"})," Vairify is not liable for decisions made during manual verification. The reviewing party acts as an independent verifier, and their decision is final."]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-start gap-3 p-4 bg-muted/30 rounded-lg",children:[s.jsx(Al,{id:"understood",checked:c,onCheckedChange:p=>u(p),className:"mt-1"}),s.jsxs(de,{htmlFor:"understood",className:"text-sm cursor-pointer leading-relaxed",children:["I understand why manual verification is needed and what the process entails. I have read and understood the failure reason: ",s.jsx("strong",{children:QL[n]})]})]}),s.jsxs("div",{className:"flex items-start gap-3 p-4 bg-muted/30 rounded-lg",children:[s.jsx(Al,{id:"liability",checked:o,onCheckedChange:p=>l(p),className:"mt-1"}),s.jsx(de,{htmlFor:"liability",className:"text-sm cursor-pointer leading-relaxed",children:"I accept the liability waiver and terms of manual verification. I understand that Vairify is not liable for manual verification decisions."})]})]}),s.jsxs(Hn,{className:"border-primary/50 bg-primary/5",children:[s.jsx(tn,{className:"h-4 w-4 text-primary"}),s.jsx(Kn,{className:"text-sm",children:"Manual verification is a security-sensitive process. Only proceed if you understand and accept the terms above."})]})]}),s.jsxs(Hx,{className:"gap-2",children:[s.jsx(L,{variant:"outline",onClick:t,disabled:i,children:"Cancel"}),s.jsx(L,{onClick:d,disabled:!o||!c||i,className:"min-w-[150px]",children:i?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Processing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),h?"Request Manual Verification":"Proceed to Review"]})})]})]})})},iWe=({sessionId:e,capturedSelfie:t,vaiPhotoUrl:r,failureReason:n,onComplete:a,onCancel:i})=>{Oe();const[o,l]=w.useState(""),[c,u]=w.useState(!1),[d,h]=w.useState(!1),[f,p]=w.useState(null),[m,v]=w.useState(null);w.useEffect(()=>{g()},[e]);const g=async()=>{try{const{data:{user:N}}=await T.auth.getUser();if(!N)return;const{data:j,error:_}=await T.from("vai_check_sessions").select("provider_id, client_id").eq("id",e).single();if(_)throw _;p(j);const S=j.provider_id===N.id?j.client_id:j.provider_id;if(!S){H.error("Other party not found in session");return}const{data:C}=await T.from("vai_verifications").select("vai_number").eq("user_id",S).single();if(!C){H.error("The other party must be VAI-verified to review manual verifications");return}v(C.vai_number)}catch(N){console.error("Error loading session data:",N),H.error(N.message||"Failed to load session data")}},x=()=>{if(!m){H.error("Reviewer VAI number not found");return}u(!0)},y=async()=>{u(!1),h(!0);try{const{data:{user:N}}=await T.auth.getUser();if(!N){H.error("You must be logged in");return}const{data:j}=await T.from("vai_verifications").select("vai_number").eq("user_id",N.id).single(),{error:_}=await T.from("vai_check_sessions").update({verification_method:"manual_fallback",manual_review_reason:n,manual_reviewer_vai_number:m,manual_review_vai_photo_url:r,manual_review_live_selfie_url:t,manual_review_notes:o||null,owner_consent_timestamp:new Date().toISOString(),liability_waiver_accepted:!0,status:"manual_review_pending",manual_review_decision:"pending"}).eq("id",e);if(_)throw _;await T.from("manual_verification_audit_log").insert({session_id:e,action:"manual_review_requested",user_id:N.id,user_vai_number:(j==null?void 0:j.vai_number)||null,metadata:{failure_reason:n,failure_details:o,reviewer_vai:m}}),await T.from("manual_verification_audit_log").insert({session_id:e,action:"owner_consent_given",user_id:N.id,user_vai_number:(j==null?void 0:j.vai_number)||null,metadata:{liability_waiver_accepted:!0}}),H.success("Manual verification request sent! The other party will be notified."),a()}catch(N){console.error("Error requesting manual verification:",N),H.error(N.message||"Failed to request manual verification")}finally{h(!1)}},b={system_failure:"System Failure",individual_issue:"Individual Issue",failed_verification:"Failed Verification"};return s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs(Hn,{className:"border-2 border-primary/50 bg-primary/5",children:[s.jsx(tn,{className:"h-5 w-5 text-primary"}),s.jsxs(Kn,{children:[s.jsx("div",{className:"font-semibold mb-2",children:"Automatic Verification Failed"}),s.jsx("p",{className:"text-sm",children:"Your face scan could not be automatically verified. You can request manual verification by another VAI-verified user, or try again."})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center gap-2",children:[s.jsx(tn,{className:"w-5 h-5 text-primary"}),"Request Manual Verification"]}),s.jsxs(Re,{children:["Provide details about why automatic verification failed. The other party (",m||"VAI-verified user",") will review your photos and make a verification decision."]})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[s.jsx(de,{className:"text-sm font-semibold mb-2 block",children:"Failure Reason:"}),s.jsx(xe,{variant:"outline",className:"text-sm",children:b[n]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"failure-details",children:"Additional Details (Optional)"}),s.jsx(Mn,{id:"failure-details",value:o,onChange:N=>l(N.target.value),placeholder:"E.g., 'Poor lighting conditions' or 'Camera not focusing properly'",rows:3,maxLength:500}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[o.length," / 500 characters"]})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{className:"text-sm font-semibold",children:"VAI Photo"}),s.jsx("div",{className:"aspect-video bg-muted rounded-lg overflow-hidden border-2 border-border",children:s.jsx("img",{src:r,alt:"VAI Photo",className:"w-full h-full object-cover"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{className:"text-sm font-semibold",children:"Live Selfie"}),s.jsx("div",{className:"aspect-video bg-muted rounded-lg overflow-hidden border-2 border-border",children:s.jsx("img",{src:t,alt:"Live Selfie",className:"w-full h-full object-cover"})})]})]}),s.jsx(Hn,{children:s.jsxs(Kn,{className:"text-sm",children:[s.jsx("strong",{children:"What happens next:"}),s.jsxs("ol",{className:"list-decimal list-inside space-y-1 mt-2 ml-2",children:[s.jsxs("li",{children:["Your photos will be sent to the other party (VAI: ",m||"Loading...",")"]}),s.jsx("li",{children:"They will review and compare your photos"}),s.jsx("li",{children:"They will approve or reject your verification"}),s.jsx("li",{children:"You'll be notified of their decision"})]})]})}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx(L,{variant:"outline",onClick:i,disabled:d,className:"flex-1",children:"Try Again"}),s.jsx(L,{onClick:x,disabled:d||!m,className:"flex-1",children:d?s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"w-4 h-4 mr-2 animate-spin"}),"Requesting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Nx,{className:"w-4 h-4 mr-2"}),"Request Manual Verification"]})})]})]})]}),s.jsx(eQ,{open:c,onClose:()=>u(!1),onConfirm:y,failureReason:n,role:"owner",loading:d})]})};function oWe(){const e=Oe(),{toast:t}=Et(),[r,n]=w.useState(!0),[a,i]=w.useState(!1),[o,l]=w.useState(null),[c,u]=w.useState(!1),[d,h]=w.useState("failed_verification"),[f,p]=w.useState(null),[m,v]=w.useState(null),g=async()=>{const b=document.querySelector("video");if(!b)return;const N=document.createElement("canvas");N.width=b.videoWidth,N.height=b.videoHeight;const j=N.getContext("2d");j==null||j.drawImage(b,0,0);const _=N.toDataURL("image/jpeg");l(_),n(!1),i(!0);try{const{data:{user:S}}=await T.auth.getUser();if(!S){t({title:"Authentication required",description:"Please log in to verify your identity",variant:"destructive"}),e("/login");return}const{data:C}=await T.from("vai_verifications").select("biometric_photo_url, vai_number").eq("user_id",S.id).single();if(!C){t({title:"V.A.I. not found",description:"Please complete V.A.I. verification first",variant:"destructive"}),e("/onboarding/success");return}const{data:E,error:k}=await T.from("vai_check_sessions").insert({provider_id:S.id,provider_face_url:_,status:"initiated"}).select().single();if(k||!E)throw k||new Error("Failed to create session");if(p(E.id),v(C.biometric_photo_url),!!1){i(!1),h("failed_verification"),u(!0);return}const{error:A}=await T.from("vai_check_sessions").update({provider_face_verified:!0,status:"qr_shown",verification_method:"automated"}).eq("id",E.id);if(A)throw A;t({title:" Verified",description:"Identity confirmed"}),setTimeout(()=>{e(`/vai-check/show-qr/${E.id}`)},1500)}catch(S){console.error("Face verification error:",S),t({title:"Verification failed",description:S.message||"Could not verify identity",variant:"destructive"}),i(!1),n(!0)}},x=()=>{e(f?`/vai-check/show-qr/${f}`:"/vai-check")},y=()=>{u(!1),n(!0),l(null)};return a?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-cyan-400 mx-auto"}),s.jsx("h2",{className:"text-xl font-bold",children:"Verifying your identity..."}),s.jsx("p",{className:"text-white/60",children:"Comparing to your verified photo"})]})}):c&&f&&o&&m?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background to-background/95 pb-32 md:pb-16",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"max-w-3xl mx-auto",children:s.jsx(iWe,{sessionId:f,capturedSelfie:o,vaiPhotoUrl:m,failureReason:d,onComplete:x,onCancel:y})})})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/vai-check"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("span",{className:"text-sm",children:"V.A.I.-CHECK"}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-8 max-w-md mx-auto space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h1",{className:"text-2xl font-bold",children:" Verify Your Identity"}),s.jsx("p",{className:"text-white/80",children:"Position your face in the box"})]}),s.jsx("div",{className:"relative aspect-[3/4] bg-black/20 rounded-lg overflow-hidden",children:s.jsx(ty,{isActive:r,onStreamReady:()=>{}})}),s.jsxs("div",{className:"space-y-3 text-sm text-white/80",children:[s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-2 h-2 bg-cyan-400 rounded-full"}),"Face centered"]}),s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-2 h-2 bg-cyan-400 rounded-full"}),"Good lighting"]}),s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-2 h-2 bg-cyan-400 rounded-full"}),"Remove glasses if possible"]})]}),s.jsx("div",{className:"space-y-3",children:s.jsx(L,{onClick:g,className:"w-full h-14 text-lg bg-gradient-to-r from-cyan-500 to-cyan-600 hover:from-cyan-600 hover:to-cyan-700 text-white font-semibold",children:"CAPTURE"})})]})]})}function lWe(){const e=Oe(),[t]=Ex(),{toast:r}=Et(),[n,a]=w.useState(!0),[i,o]=w.useState(!1),l=t.get("vai");w.useEffect(()=>{l||(r({title:"Missing V.A.I. Number",description:"Please enter your V.A.I. number first",variant:"destructive"}),e("/login"))},[l,e,r]);const c=async()=>{const u=document.querySelector("video");if(!u)return;const d=document.createElement("canvas");d.width=u.videoWidth,d.height=u.videoHeight;const h=d.getContext("2d");h==null||h.drawImage(u,0,0);const f=d.toDataURL("image/jpeg");a(!1),o(!0);try{const{data:p,error:m}=await T.functions.invoke("verify-vai-login",{body:{vaiNumber:l,faceImageBase64:f.split(",")[1]}});if(m)throw new Error(m.message||"Verification failed");if(!(p!=null&&p.success))throw new Error((p==null?void 0:p.error)||"Face verification failed");if(r({title:" Verified",description:"Identity confirmed! Signing you in..."}),p.sessionUrl)window.location.href=p.sessionUrl;else throw new Error("No session URL received from verification")}catch(p){console.error("Face verification error:",p),r({title:"Verification Failed",description:p.message||"Face verification failed. Please try again.",variant:"destructive"}),a(!0),o(!1)}};return i?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-cyan-400 mx-auto"}),s.jsx("h2",{className:"text-xl font-bold",children:"Verifying your identity..."}),s.jsx("p",{className:"text-white/60",children:"Comparing with your verified photo"})]})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/login?vai="+l),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("span",{className:"text-sm",children:"V.A.I. LOGIN"}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-8 max-w-md mx-auto space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h1",{className:"text-2xl font-bold",children:" Verify Your Identity"}),s.jsxs("p",{className:"text-white/80",children:["V.A.I. ",l]}),s.jsx("p",{className:"text-white/60 text-sm",children:"Position your face in the box"})]}),s.jsx("div",{className:"relative aspect-[3/4] bg-black/20 rounded-lg overflow-hidden",children:s.jsx(ty,{isActive:n,onStreamReady:()=>{}})}),s.jsxs("div",{className:"space-y-3 text-sm text-white/80",children:[s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-2 h-2 bg-cyan-400 rounded-full"}),"Face centered"]}),s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-2 h-2 bg-cyan-400 rounded-full"}),"Good lighting"]}),s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-2 h-2 bg-cyan-400 rounded-full"}),"Remove glasses if possible"]})]}),s.jsx("div",{className:"space-y-3",children:s.jsx(L,{onClick:c,className:"w-full h-14 text-lg bg-gradient-to-r from-cyan-500 to-cyan-600 hover:from-cyan-600 hover:to-cyan-700 text-white font-semibold",children:"CAPTURE & VERIFY"})})]})]})}var cWe=Object.defineProperty,y1=Object.getOwnPropertySymbols,tQ=Object.prototype.hasOwnProperty,rQ=Object.prototype.propertyIsEnumerable,ZL=(e,t,r)=>t in e?cWe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,vA=(e,t)=>{for(var r in t||(t={}))tQ.call(t,r)&&ZL(e,r,t[r]);if(y1)for(var r of y1(t))rQ.call(t,r)&&ZL(e,r,t[r]);return e},gA=(e,t)=>{var r={};for(var n in e)tQ.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&y1)for(var n of y1(e))t.indexOf(n)<0&&rQ.call(e,n)&&(r[n]=e[n]);return r};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Ud;(e=>{const t=class Lt{constructor(c,u,d,h){if(this.version=c,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],c<Lt.MIN_VERSION||c>Lt.MAX_VERSION)throw new RangeError("Version value out of range");if(h<-1||h>7)throw new RangeError("Mask value out of range");this.size=c*4+17;let f=[];for(let m=0;m<this.size;m++)f.push(!1);for(let m=0;m<this.size;m++)this.modules.push(f.slice()),this.isFunction.push(f.slice());this.drawFunctionPatterns();const p=this.addEccAndInterleave(d);if(this.drawCodewords(p),h==-1){let m=1e9;for(let v=0;v<8;v++){this.applyMask(v),this.drawFormatBits(v);const g=this.getPenaltyScore();g<m&&(h=v,m=g),this.applyMask(v)}}a(0<=h&&h<=7),this.mask=h,this.applyMask(h),this.drawFormatBits(h),this.isFunction=[]}static encodeText(c,u){const d=e.QrSegment.makeSegments(c);return Lt.encodeSegments(d,u)}static encodeBinary(c,u){const d=e.QrSegment.makeBytes(c);return Lt.encodeSegments([d],u)}static encodeSegments(c,u,d=1,h=40,f=-1,p=!0){if(!(Lt.MIN_VERSION<=d&&d<=h&&h<=Lt.MAX_VERSION)||f<-1||f>7)throw new RangeError("Invalid value");let m,v;for(m=d;;m++){const b=Lt.getNumDataCodewords(m,u)*8,N=o.getTotalBits(c,m);if(N<=b){v=N;break}if(m>=h)throw new RangeError("Data too long")}for(const b of[Lt.Ecc.MEDIUM,Lt.Ecc.QUARTILE,Lt.Ecc.HIGH])p&&v<=Lt.getNumDataCodewords(m,b)*8&&(u=b);let g=[];for(const b of c){r(b.mode.modeBits,4,g),r(b.numChars,b.mode.numCharCountBits(m),g);for(const N of b.getData())g.push(N)}a(g.length==v);const x=Lt.getNumDataCodewords(m,u)*8;a(g.length<=x),r(0,Math.min(4,x-g.length),g),r(0,(8-g.length%8)%8,g),a(g.length%8==0);for(let b=236;g.length<x;b^=253)r(b,8,g);let y=[];for(;y.length*8<g.length;)y.push(0);return g.forEach((b,N)=>y[N>>>3]|=b<<7-(N&7)),new Lt(m,u,y,f)}getModule(c,u){return 0<=c&&c<this.size&&0<=u&&u<this.size&&this.modules[u][c]}getModules(){return this.modules}drawFunctionPatterns(){for(let d=0;d<this.size;d++)this.setFunctionModule(6,d,d%2==0),this.setFunctionModule(d,6,d%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const c=this.getAlignmentPatternPositions(),u=c.length;for(let d=0;d<u;d++)for(let h=0;h<u;h++)d==0&&h==0||d==0&&h==u-1||d==u-1&&h==0||this.drawAlignmentPattern(c[d],c[h]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(c){const u=this.errorCorrectionLevel.formatBits<<3|c;let d=u;for(let f=0;f<10;f++)d=d<<1^(d>>>9)*1335;const h=(u<<10|d)^21522;a(h>>>15==0);for(let f=0;f<=5;f++)this.setFunctionModule(8,f,n(h,f));this.setFunctionModule(8,7,n(h,6)),this.setFunctionModule(8,8,n(h,7)),this.setFunctionModule(7,8,n(h,8));for(let f=9;f<15;f++)this.setFunctionModule(14-f,8,n(h,f));for(let f=0;f<8;f++)this.setFunctionModule(this.size-1-f,8,n(h,f));for(let f=8;f<15;f++)this.setFunctionModule(8,this.size-15+f,n(h,f));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let c=this.version;for(let d=0;d<12;d++)c=c<<1^(c>>>11)*7973;const u=this.version<<12|c;a(u>>>18==0);for(let d=0;d<18;d++){const h=n(u,d),f=this.size-11+d%3,p=Math.floor(d/3);this.setFunctionModule(f,p,h),this.setFunctionModule(p,f,h)}}drawFinderPattern(c,u){for(let d=-4;d<=4;d++)for(let h=-4;h<=4;h++){const f=Math.max(Math.abs(h),Math.abs(d)),p=c+h,m=u+d;0<=p&&p<this.size&&0<=m&&m<this.size&&this.setFunctionModule(p,m,f!=2&&f!=4)}}drawAlignmentPattern(c,u){for(let d=-2;d<=2;d++)for(let h=-2;h<=2;h++)this.setFunctionModule(c+h,u+d,Math.max(Math.abs(h),Math.abs(d))!=1)}setFunctionModule(c,u,d){this.modules[u][c]=d,this.isFunction[u][c]=!0}addEccAndInterleave(c){const u=this.version,d=this.errorCorrectionLevel;if(c.length!=Lt.getNumDataCodewords(u,d))throw new RangeError("Invalid argument");const h=Lt.NUM_ERROR_CORRECTION_BLOCKS[d.ordinal][u],f=Lt.ECC_CODEWORDS_PER_BLOCK[d.ordinal][u],p=Math.floor(Lt.getNumRawDataModules(u)/8),m=h-p%h,v=Math.floor(p/h);let g=[];const x=Lt.reedSolomonComputeDivisor(f);for(let b=0,N=0;b<h;b++){let j=c.slice(N,N+v-f+(b<m?0:1));N+=j.length;const _=Lt.reedSolomonComputeRemainder(j,x);b<m&&j.push(0),g.push(j.concat(_))}let y=[];for(let b=0;b<g[0].length;b++)g.forEach((N,j)=>{(b!=v-f||j>=m)&&y.push(N[b])});return a(y.length==p),y}drawCodewords(c){if(c.length!=Math.floor(Lt.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let d=this.size-1;d>=1;d-=2){d==6&&(d=5);for(let h=0;h<this.size;h++)for(let f=0;f<2;f++){const p=d-f,v=(d+1&2)==0?this.size-1-h:h;!this.isFunction[v][p]&&u<c.length*8&&(this.modules[v][p]=n(c[u>>>3],7-(u&7)),u++)}}a(u==c.length*8)}applyMask(c){if(c<0||c>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let d=0;d<this.size;d++){let h;switch(c){case 0:h=(d+u)%2==0;break;case 1:h=u%2==0;break;case 2:h=d%3==0;break;case 3:h=(d+u)%3==0;break;case 4:h=(Math.floor(d/3)+Math.floor(u/2))%2==0;break;case 5:h=d*u%2+d*u%3==0;break;case 6:h=(d*u%2+d*u%3)%2==0;break;case 7:h=((d+u)%2+d*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][d]&&h&&(this.modules[u][d]=!this.modules[u][d])}}getPenaltyScore(){let c=0;for(let f=0;f<this.size;f++){let p=!1,m=0,v=[0,0,0,0,0,0,0];for(let g=0;g<this.size;g++)this.modules[f][g]==p?(m++,m==5?c+=Lt.PENALTY_N1:m>5&&c++):(this.finderPenaltyAddHistory(m,v),p||(c+=this.finderPenaltyCountPatterns(v)*Lt.PENALTY_N3),p=this.modules[f][g],m=1);c+=this.finderPenaltyTerminateAndCount(p,m,v)*Lt.PENALTY_N3}for(let f=0;f<this.size;f++){let p=!1,m=0,v=[0,0,0,0,0,0,0];for(let g=0;g<this.size;g++)this.modules[g][f]==p?(m++,m==5?c+=Lt.PENALTY_N1:m>5&&c++):(this.finderPenaltyAddHistory(m,v),p||(c+=this.finderPenaltyCountPatterns(v)*Lt.PENALTY_N3),p=this.modules[g][f],m=1);c+=this.finderPenaltyTerminateAndCount(p,m,v)*Lt.PENALTY_N3}for(let f=0;f<this.size-1;f++)for(let p=0;p<this.size-1;p++){const m=this.modules[f][p];m==this.modules[f][p+1]&&m==this.modules[f+1][p]&&m==this.modules[f+1][p+1]&&(c+=Lt.PENALTY_N2)}let u=0;for(const f of this.modules)u=f.reduce((p,m)=>p+(m?1:0),u);const d=this.size*this.size,h=Math.ceil(Math.abs(u*20-d*10)/d)-1;return a(0<=h&&h<=9),c+=h*Lt.PENALTY_N4,a(0<=c&&c<=2568888),c}getAlignmentPatternPositions(){if(this.version==1)return[];{const c=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(c*2-2))*2;let d=[6];for(let h=this.size-7;d.length<c;h-=u)d.splice(1,0,h);return d}}static getNumRawDataModules(c){if(c<Lt.MIN_VERSION||c>Lt.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*c+128)*c+64;if(c>=2){const d=Math.floor(c/7)+2;u-=(25*d-10)*d-55,c>=7&&(u-=36)}return a(208<=u&&u<=29648),u}static getNumDataCodewords(c,u){return Math.floor(Lt.getNumRawDataModules(c)/8)-Lt.ECC_CODEWORDS_PER_BLOCK[u.ordinal][c]*Lt.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][c]}static reedSolomonComputeDivisor(c){if(c<1||c>255)throw new RangeError("Degree out of range");let u=[];for(let h=0;h<c-1;h++)u.push(0);u.push(1);let d=1;for(let h=0;h<c;h++){for(let f=0;f<u.length;f++)u[f]=Lt.reedSolomonMultiply(u[f],d),f+1<u.length&&(u[f]^=u[f+1]);d=Lt.reedSolomonMultiply(d,2)}return u}static reedSolomonComputeRemainder(c,u){let d=u.map(h=>0);for(const h of c){const f=h^d.shift();d.push(0),u.forEach((p,m)=>d[m]^=Lt.reedSolomonMultiply(p,f))}return d}static reedSolomonMultiply(c,u){if(c>>>8||u>>>8)throw new RangeError("Byte out of range");let d=0;for(let h=7;h>=0;h--)d=d<<1^(d>>>7)*285,d^=(u>>>h&1)*c;return a(d>>>8==0),d}finderPenaltyCountPatterns(c){const u=c[1];a(u<=this.size*3);const d=u>0&&c[2]==u&&c[3]==u*3&&c[4]==u&&c[5]==u;return(d&&c[0]>=u*4&&c[6]>=u?1:0)+(d&&c[6]>=u*4&&c[0]>=u?1:0)}finderPenaltyTerminateAndCount(c,u,d){return c&&(this.finderPenaltyAddHistory(u,d),u=0),u+=this.size,this.finderPenaltyAddHistory(u,d),this.finderPenaltyCountPatterns(d)}finderPenaltyAddHistory(c,u){u[0]==0&&(c+=this.size),u.pop(),u.unshift(c)}};t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=t;function r(l,c,u){if(c<0||c>31||l>>>c)throw new RangeError("Value out of range");for(let d=c-1;d>=0;d--)u.push(l>>>d&1)}function n(l,c){return(l>>>c&1)!=0}function a(l){if(!l)throw new Error("Assertion error")}const i=class Wr{constructor(c,u,d){if(this.mode=c,this.numChars=u,this.bitData=d,u<0)throw new RangeError("Invalid argument");this.bitData=d.slice()}static makeBytes(c){let u=[];for(const d of c)r(d,8,u);return new Wr(Wr.Mode.BYTE,c.length,u)}static makeNumeric(c){if(!Wr.isNumeric(c))throw new RangeError("String contains non-numeric characters");let u=[];for(let d=0;d<c.length;){const h=Math.min(c.length-d,3);r(parseInt(c.substring(d,d+h),10),h*3+1,u),d+=h}return new Wr(Wr.Mode.NUMERIC,c.length,u)}static makeAlphanumeric(c){if(!Wr.isAlphanumeric(c))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],d;for(d=0;d+2<=c.length;d+=2){let h=Wr.ALPHANUMERIC_CHARSET.indexOf(c.charAt(d))*45;h+=Wr.ALPHANUMERIC_CHARSET.indexOf(c.charAt(d+1)),r(h,11,u)}return d<c.length&&r(Wr.ALPHANUMERIC_CHARSET.indexOf(c.charAt(d)),6,u),new Wr(Wr.Mode.ALPHANUMERIC,c.length,u)}static makeSegments(c){return c==""?[]:Wr.isNumeric(c)?[Wr.makeNumeric(c)]:Wr.isAlphanumeric(c)?[Wr.makeAlphanumeric(c)]:[Wr.makeBytes(Wr.toUtf8ByteArray(c))]}static makeEci(c){let u=[];if(c<0)throw new RangeError("ECI assignment value out of range");if(c<128)r(c,8,u);else if(c<16384)r(2,2,u),r(c,14,u);else if(c<1e6)r(6,3,u),r(c,21,u);else throw new RangeError("ECI assignment value out of range");return new Wr(Wr.Mode.ECI,0,u)}static isNumeric(c){return Wr.NUMERIC_REGEX.test(c)}static isAlphanumeric(c){return Wr.ALPHANUMERIC_REGEX.test(c)}getData(){return this.bitData.slice()}static getTotalBits(c,u){let d=0;for(const h of c){const f=h.mode.numCharCountBits(u);if(h.numChars>=1<<f)return 1/0;d+=4+f+h.bitData.length}return d}static toUtf8ByteArray(c){c=encodeURI(c);let u=[];for(let d=0;d<c.length;d++)c.charAt(d)!="%"?u.push(c.charCodeAt(d)):(u.push(parseInt(c.substring(d+1,d+3),16)),d+=2);return u}};i.NUMERIC_REGEX=/^[0-9]*$/,i.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,i.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let o=i;e.QrSegment=i})(Ud||(Ud={}));(e=>{(t=>{const r=class{constructor(a,i){this.ordinal=a,this.formatBits=i}};r.LOW=new r(0,1),r.MEDIUM=new r(1,0),r.QUARTILE=new r(2,3),r.HIGH=new r(3,2),t.Ecc=r})(e.QrCode||(e.QrCode={}))})(Ud||(Ud={}));(e=>{(t=>{const r=class{constructor(a,i){this.modeBits=a,this.numBitsCharCount=i}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};r.NUMERIC=new r(1,[10,12,14]),r.ALPHANUMERIC=new r(2,[9,11,13]),r.BYTE=new r(4,[8,16,16]),r.KANJI=new r(8,[8,10,12]),r.ECI=new r(7,[0,0,0]),t.Mode=r})(e.QrSegment||(e.QrSegment={}))})(Ud||(Ud={}));var af=Ud;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var uWe={L:af.QrCode.Ecc.LOW,M:af.QrCode.Ecc.MEDIUM,Q:af.QrCode.Ecc.QUARTILE,H:af.QrCode.Ecc.HIGH},nQ=128,aQ="L",sQ="#FFFFFF",iQ="#000000",oQ=!1,lQ=1,dWe=4,hWe=0,fWe=.1;function cQ(e,t=0){const r=[];return e.forEach(function(n,a){let i=null;n.forEach(function(o,l){if(!o&&i!==null){r.push(`M${i+t} ${a+t}h${l-i}v1H${i+t}z`),i=null;return}if(l===n.length-1){if(!o)return;i===null?r.push(`M${l+t},${a+t} h1v1H${l+t}z`):r.push(`M${i+t},${a+t} h${l+1-i}v1H${i+t}z`);return}o&&i===null&&(i=l)})}),r.join("")}function uQ(e,t){return e.slice().map((r,n)=>n<t.y||n>=t.y+t.h?r:r.map((a,i)=>i<t.x||i>=t.x+t.w?a:!1))}function pWe(e,t,r,n){if(n==null)return null;const a=e.length+r*2,i=Math.floor(t*fWe),o=a/t,l=(n.width||i)*o,c=(n.height||i)*o,u=n.x==null?e.length/2-l/2:n.x*o,d=n.y==null?e.length/2-c/2:n.y*o,h=n.opacity==null?1:n.opacity;let f=null;if(n.excavate){let m=Math.floor(u),v=Math.floor(d),g=Math.ceil(l+u-m),x=Math.ceil(c+d-v);f={x:m,y:v,w:g,h:x}}const p=n.crossOrigin;return{x:u,y:d,h:c,w:l,excavation:f,opacity:h,crossOrigin:p}}function mWe(e,t){return t!=null?Math.max(Math.floor(t),0):e?dWe:hWe}function dQ({value:e,level:t,minVersion:r,includeMargin:n,marginSize:a,imageSettings:i,size:o,boostLevel:l}){let c=F.useMemo(()=>{const m=(Array.isArray(e)?e:[e]).reduce((v,g)=>(v.push(...af.QrSegment.makeSegments(g)),v),[]);return af.QrCode.encodeSegments(m,uWe[t],r,void 0,void 0,l)},[e,t,r,l]);const{cells:u,margin:d,numCells:h,calculatedImageSettings:f}=F.useMemo(()=>{let p=c.getModules();const m=mWe(n,a),v=p.length+m*2,g=pWe(p,o,m,i);return{cells:p,margin:m,numCells:v,calculatedImageSettings:g}},[c,o,i,n,a]);return{qrcode:c,margin:d,cells:u,numCells:h,calculatedImageSettings:f}}var vWe=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),gWe=F.forwardRef(function(t,r){const n=t,{value:a,size:i=nQ,level:o=aQ,bgColor:l=sQ,fgColor:c=iQ,includeMargin:u=oQ,minVersion:d=lQ,boostLevel:h,marginSize:f,imageSettings:p}=n,v=gA(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:g}=v,x=gA(v,["style"]),y=p==null?void 0:p.src,b=F.useRef(null),N=F.useRef(null),j=F.useCallback(I=>{b.current=I,typeof r=="function"?r(I):r&&(r.current=I)},[r]),[_,S]=F.useState(!1),{margin:C,cells:E,numCells:k,calculatedImageSettings:P}=dQ({value:a,level:o,minVersion:d,boostLevel:h,includeMargin:u,marginSize:f,imageSettings:p,size:i});F.useEffect(()=>{if(b.current!=null){const I=b.current,R=I.getContext("2d");if(!R)return;let M=E;const B=N.current,$=P!=null&&B!==null&&B.complete&&B.naturalHeight!==0&&B.naturalWidth!==0;$&&P.excavation!=null&&(M=uQ(E,P.excavation));const D=window.devicePixelRatio||1;I.height=I.width=i*D;const W=i/k*D;R.scale(W,W),R.fillStyle=l,R.fillRect(0,0,k,k),R.fillStyle=c,vWe?R.fill(new Path2D(cQ(M,C))):E.forEach(function(Z,U){Z.forEach(function(Y,ae){Y&&R.fillRect(ae+C,U+C,1,1)})}),P&&(R.globalAlpha=P.opacity),$&&R.drawImage(B,P.x+C,P.y+C,P.w,P.h)}}),F.useEffect(()=>{S(!1)},[y]);const A=vA({height:i,width:i},g);let O=null;return y!=null&&(O=F.createElement("img",{src:y,key:y,style:{display:"none"},onLoad:()=>{S(!0)},ref:N,crossOrigin:P==null?void 0:P.crossOrigin})),F.createElement(F.Fragment,null,F.createElement("canvas",vA({style:A,height:i,width:i,ref:j,role:"img"},x)),O)});gWe.displayName="QRCodeCanvas";var hQ=F.forwardRef(function(t,r){const n=t,{value:a,size:i=nQ,level:o=aQ,bgColor:l=sQ,fgColor:c=iQ,includeMargin:u=oQ,minVersion:d=lQ,boostLevel:h,title:f,marginSize:p,imageSettings:m}=n,v=gA(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:g,cells:x,numCells:y,calculatedImageSettings:b}=dQ({value:a,level:o,minVersion:d,boostLevel:h,includeMargin:u,marginSize:p,imageSettings:m,size:i});let N=x,j=null;m!=null&&b!=null&&(b.excavation!=null&&(N=uQ(x,b.excavation)),j=F.createElement("image",{href:m.src,height:b.h,width:b.w,x:b.x+g,y:b.y+g,preserveAspectRatio:"none",opacity:b.opacity,crossOrigin:b.crossOrigin}));const _=cQ(N,g);return F.createElement("svg",vA({height:i,width:i,viewBox:`0 0 ${y} ${y}`,ref:r,role:"img"},v),!!f&&F.createElement("title",null,f),F.createElement("path",{fill:l,d:`M0,0 h${y}v${y}H0z`,shapeRendering:"crispEdges"}),F.createElement("path",{fill:c,d:_,shapeRendering:"crispEdges"}),j)});hQ.displayName="QRCodeSVG";function xWe(){const e=Oe(),[t]=Ex(),r=t.get("member")==="true",[n,a]=w.useState({username:"SampleProvider",vaiNumber:"9I7T35L",avatarUrl:void 0,publicGallery:[],membersGallery:[]});w.useEffect(()=>{i()},[]);const i=async()=>{try{const{data:{user:p}}=await T.auth.getUser();if(!p)return}catch(p){console.error("Error loading profile:",p)}},o=`https://app.vairify.com/profile/${n.vaiNumber}`,l=()=>{const p=encodeURIComponent("My Vairify Profile"),m=encodeURIComponent(`Check out my Vairify profile: ${o}`);window.location.href=`mailto:?subject=${p}&body=${m}`},c=()=>{const p=encodeURIComponent(`Check out my Vairify profile: ${o}`);window.location.href=`sms:?body=${p}`},u=()=>{const p=document.querySelector("canvas");if(!p)return;const m=p.toDataURL("image/png"),v=document.createElement("a");v.download=`vairify-qr-${n.vaiNumber}.png`,v.href=m,v.click(),H.success("QR Code downloaded!")},d=()=>{window.print(),H.success("Print dialog opened")},h=()=>{navigator.clipboard.writeText(o),H.success("Link copied to clipboard!")},f=r?[...n.publicGallery,...n.membersGallery]:n.publicGallery;return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background to-background/95",children:[s.jsx("header",{className:"sticky top-0 z-40 bg-card/95 backdrop-blur-sm border-b border-border p-4",children:s.jsxs("div",{className:"container mx-auto max-w-4xl flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/feed"),children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("h1",{className:"text-lg font-semibold",children:"My QR Code"}),s.jsx("div",{className:"w-10"})]})}),s.jsxs("main",{className:"container mx-auto max-w-4xl px-4 py-8 space-y-6",children:[s.jsx(q,{children:s.jsx(ge,{children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-20 h-20 rounded-full bg-muted border-2 border-border overflow-hidden flex items-center justify-center",children:n.avatarUrl?s.jsx("img",{src:n.avatarUrl,alt:"Profile",className:"w-full h-full object-cover"}):s.jsx(fn,{className:"w-10 h-10 text-muted-foreground"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx(be,{className:"text-2xl",children:n.username}),s.jsx("div",{className:"flex items-center gap-2 mt-1",children:s.jsx(_I,{vaiNumber:n.vaiNumber,size:"md"})})]})]})})}),s.jsxs(Ga,{defaultValue:"qr",className:"w-full",children:[s.jsxs(Aa,{className:"grid w-full grid-cols-2",children:[s.jsx(mt,{value:"qr",children:"QR Code"}),s.jsx(mt,{value:"gallery",children:"Gallery"})]}),s.jsxs(Rt,{value:"qr",className:"space-y-6",children:[s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Your Personal QR Code"}),s.jsx(Re,{children:"Share this code with clients to give them instant access to your profile"})]}),s.jsx(ee,{children:s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:s.jsx(hQ,{value:o,size:256,level:"H",includeMargin:!0,imageSettings:{src:Zi,x:void 0,y:void 0,height:60,width:60,excavate:!0}})}),s.jsxs("p",{className:"text-sm text-muted-foreground text-center",children:["Scan to view: ",o]})]})})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Share Your QR Code"}),s.jsx(Re,{children:"Choose how you want to share your profile"})]}),s.jsx(ee,{children:s.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[s.jsxs(L,{variant:"outline",onClick:l,className:"justify-start",children:[s.jsx(ai,{className:"w-4 h-4 mr-2"}),"Email QR Code"]}),s.jsxs(L,{variant:"outline",onClick:c,className:"justify-start",children:[s.jsx(Ed,{className:"w-4 h-4 mr-2"}),"Text QR Code"]}),s.jsxs(L,{variant:"outline",onClick:u,className:"justify-start",children:[s.jsx(uT,{className:"w-4 h-4 mr-2"}),"Download QR Code"]}),s.jsxs(L,{variant:"outline",onClick:d,className:"justify-start",children:[s.jsx(gae,{className:"w-4 h-4 mr-2"}),"Print QR Code"]}),s.jsxs(L,{variant:"outline",onClick:h,className:"justify-start md:col-span-2",children:[s.jsx(RC,{className:"w-4 h-4 mr-2"}),"Copy Profile Link"]})]})})]}),s.jsx(q,{className:"bg-primary/5 border-primary/20",children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:r?s.jsx(Or,{className:"w-5 h-5 text-primary"}):s.jsx(So,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold text-foreground mb-1",children:r?"Members-Only Access":"Public Access"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:r?`Viewing as verified member. You can see ${n.publicGallery.length} public photos and ${n.membersGallery.length} members-only photos.`:`Public view. Showing ${n.publicGallery.length} public photos. Members-only photos are hidden.`})]})]})})})]}),s.jsxs(Rt,{value:"gallery",className:"space-y-6",children:[n.publicGallery.length>0&&s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(So,{className:"w-5 h-5 text-primary"}),s.jsx(be,{children:"Public Gallery"})]}),s.jsxs(xe,{variant:"secondary",children:[n.publicGallery.length," photos"]})]}),s.jsx(Re,{children:"Visible to anyone who scans your QR code"})]}),s.jsx(ee,{children:s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:n.publicGallery.sort((p,m)=>p.order-m.order).map(p=>s.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-muted border border-border group",children:[s.jsx("img",{src:p.url,alt:`Gallery ${p.order+1}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"})]},p.id))})})]}),r&&n.membersGallery.length>0&&s.jsxs(q,{className:"border-primary/50",children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Or,{className:"w-5 h-5 text-primary"}),s.jsx(be,{children:"Members-Only Gallery"})]}),s.jsxs(xe,{variant:"secondary",className:"bg-primary/20",children:[n.membersGallery.length," photos"]})]}),s.jsx(Re,{children:"Exclusive content for verified Vairify members"})]}),s.jsx(ee,{children:s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:n.membersGallery.sort((p,m)=>p.order-m.order).map(p=>s.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-muted border-2 border-primary/50 group",children:[s.jsx("img",{src:p.url,alt:`Members ${p.order+1}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),s.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsxs(xe,{variant:"secondary",className:"bg-primary/80 text-primary-foreground",children:[s.jsx(Or,{className:"w-3 h-3 mr-1"}),"Members"]})})]},p.id))})})]}),!r&&n.membersGallery.length>0&&s.jsx(q,{className:"border-primary/50 bg-primary/5",children:s.jsxs(ee,{className:"p-8 text-center",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary/10 mb-4",children:s.jsx(Or,{className:"w-8 h-8 text-primary"})}),s.jsx("h3",{className:"text-xl font-semibold text-foreground mb-2",children:"Members-Only Gallery"}),s.jsxs("p",{className:"text-muted-foreground mb-4",children:["This provider has ",n.membersGallery.length," exclusive photos available to verified Vairify members only."]}),s.jsx(L,{variant:"default",children:"Verify to View Members Gallery"})]})}),f.length===0&&s.jsx(q,{children:s.jsxs(ee,{className:"p-8 text-center",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-muted mb-4",children:s.jsx(So,{className:"w-8 h-8 text-muted-foreground"})}),s.jsx("h3",{className:"text-xl font-semibold text-foreground mb-2",children:"No Photos Yet"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"Upload photos in your profile settings to showcase your work."}),s.jsx(L,{variant:"outline",onClick:()=>e("/profile/create"),children:"Add Photos"})]})})]})]})]})]})}function yWe(){const e=Oe(),{toast:t}=Et(),[r,n]=w.useState(!1),[a,i]=w.useState(""),[o,l]=w.useState(!1),c=async d=>{try{l(!0);const h=JSON.parse(d),{data:{user:f}}=await T.auth.getUser();if(!f){t({title:"Not authenticated",description:"Please log in to continue",variant:"destructive"}),e("/login");return}const{error:p}=await T.from("vai_check_sessions").update({client_id:f.id,status:"mutual_review"}).eq("id",h.sessionId);if(p){t({title:"Error",description:"Failed to join session",variant:"destructive"});return}t({title:"QR Scanned!",description:"Loading profiles..."}),setTimeout(()=>{e(`/vai-check/mutual-view/${h.sessionId}/client`)},1500)}catch{t({title:"Invalid QR Code",variant:"destructive"})}finally{l(!1)}},u=async()=>{if(!a)return;l(!0);const{data:d}=await T.from("vai_check_sessions").select("*").eq("session_code",a.toUpperCase()).eq("status","qr_generated").single();if(!d){t({title:"Invalid V.A.I. Number",variant:"destructive"}),l(!1);return}await c(JSON.stringify({sessionId:d.id}))};return o?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] flex items-center justify-center",children:s.jsxs("div",{className:"text-center text-white space-y-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-cyan-400 mx-auto"}),s.jsx("p",{children:"Loading profile..."})]})}):r?s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>n(!1),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("span",{className:"text-sm",children:"Enter V.A.I."}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-8 max-w-md mx-auto space-y-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-center",children:"Enter Provider's V.A.I. Number"}),s.jsx(De,{placeholder:"e.g., 9I7T35L",value:a,onChange:d=>i(d.target.value.toUpperCase()),className:"h-14 text-lg text-center font-mono bg-white/10 border-white/20 text-white placeholder:text-white/40",maxLength:8}),s.jsx(L,{onClick:u,disabled:a.length!==8,className:"w-full h-14 text-lg bg-gradient-to-r from-cyan-500 to-cyan-600 hover:from-cyan-600 hover:to-cyan-700",children:"Continue"})]})]}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/vai-check"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("span",{className:"text-sm",children:"V.A.I.-CHECK"}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 py-8 max-w-md mx-auto space-y-6",children:[s.jsx("div",{className:"text-center space-y-2",children:s.jsx("h1",{className:"text-2xl font-bold",children:" Scan Provider's QR Code"})}),s.jsxs("div",{className:"relative aspect-square bg-black/20 rounded-lg overflow-hidden",children:[s.jsx(ty,{isActive:!0,onStreamReady:()=>{}}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"w-64 h-64 border-4 border-cyan-400 rounded-lg"})})]}),s.jsx("p",{className:"text-center text-white/80",children:"Point camera at provider's QR code"}),s.jsx(L,{variant:"ghost",onClick:()=>n(!0),className:"w-full text-cyan-400 hover:text-cyan-300 hover:bg-white/10",children:"Or enter V.A.I. manually "})]})]})}function bWe(){const e=Oe(),{sessionId:t,role:r}=us(),{toast:n}=Et(),[a,i]=w.useState(null),[o,l]=w.useState(null),[c,u]=w.useState(!1);w.useEffect(()=>{(async()=>{var j;if(!t){n({title:"Invalid session",description:"Session ID is required",variant:"destructive"}),e("/vai-check");return}const{data:{user:f}}=await T.auth.getUser();if(!f){n({title:"Authentication required",description:"Please log in to continue",variant:"destructive"}),e("/login");return}const{data:p,error:m}=await T.from("vai_check_sessions").select("*, provider_id, client_id").eq("id",t).single();if(m||!p){n({title:"Session not found",description:"This session may have expired",variant:"destructive"}),e("/vai-check");return}i(p);const v=r==="provider"?p.client_id:p.provider_id;if(!v){n({title:"Waiting for other user",description:"The other participant hasn't joined yet"}),u(!0);return}const{data:g,error:x}=await T.from("profiles").select("*, provider_profiles(*)").eq("id",v).single();if(x||!g){n({title:"Profile not found",variant:"destructive"});return}const{data:y}=await T.from("vai_verifications").select("vai_number").eq("user_id",v).single(),{data:b}=await T.from("reviews").select("rating").eq("reviewed_user_id",v),N=b&&b.length>0?b.reduce((_,S)=>_+(S.rating||0),0)/b.length:0;l({name:((j=g.provider_profiles)==null?void 0:j.username)||g.full_name||"Unknown",vaiNumber:(y==null?void 0:y.vai_number)||"N/A",rating:N,reviews:(b==null?void 0:b.length)||0,location:g.location||"Location not set",memberSince:new Date(g.created_at).toLocaleDateString("en-US",{month:"short",year:"numeric"}),bio:g.bio||"No bio available",verified:!!y})})()},[t,r,e,n]);const d=async h=>{if(!t)return;const{data:{user:f}}=await T.auth.getUser();if(!f){n({title:"Authentication required",variant:"destructive"}),e("/login");return}const p=r==="provider"?"provider_decision":"client_decision",{error:m}=await T.from("vai_check_sessions").update({[p]:h==="accept"?"accept":"decline",status:h==="accept"?"profiles_viewed":"declined"}).eq("id",t);if(m){n({title:"Error",description:"Failed to save decision",variant:"destructive"});return}if(h==="decline")e(`/vai-check/declined/${t}`);else{u(!0);const g=setInterval(async()=>{const{data:x}=await T.from("vai_check_sessions").select("provider_decision, client_decision").eq("id",t).single();if(x){const y=r==="provider"?x.client_decision:x.provider_decision;y==="accept"?e(`/vai-check/contract/${t}/${r}`):y==="decline"&&e(`/vai-check/declined/${t}`)}},2e3);setTimeout(()=>clearInterval(g),6e4)}};return o?c?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] flex items-center justify-center",children:s.jsxs("div",{className:"text-center text-white space-y-4 p-4",children:[s.jsx("div",{className:"text-4xl mb-4",children:""}),s.jsx("h2",{className:"text-2xl font-bold",children:"You accepted"}),s.jsx("div",{className:"animate-pulse",children:""}),s.jsxs("p",{children:["Waiting for ",o.name," to decide..."]}),s.jsx("p",{className:"text-sm text-white/60",children:"They're reviewing your profile and reviews right now"})]})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white pb-24",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between sticky top-0 bg-gradient-to-b from-[#0A1628] to-transparent z-10",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>d("decline"),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("span",{className:"text-sm",children:"V.A.I.-CHECK"}),s.jsx("div",{className:"w-10"})]}),s.jsxs("main",{className:"px-4 max-w-md mx-auto space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm text-white/60 mb-4",children:"YOU'RE VIEWING:"}),s.jsx("div",{className:"w-32 h-32 mx-auto rounded-full bg-white/10 flex items-center justify-center mb-4",children:s.jsx("span",{className:"text-5xl",children:""})}),s.jsxs("h1",{className:"text-2xl font-bold mb-2",children:[o.name," ",o.verified&&""]}),s.jsxs("p",{className:"text-sm text-white/60",children:["V.A.I. #: ",o.vaiNumber]}),s.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4",children:[s.jsx("div",{className:"flex",children:[...Array(5)].map((h,f)=>s.jsx(hr,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"},f))}),s.jsxs("span",{children:[o.rating," (",o.reviews," reviews)"]})]}),s.jsxs("p",{className:"text-sm text-white/60 mt-2",children:[" ",o.location,"   Member since ",o.memberSince]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold mb-2",children:"ABOUT"}),s.jsx("p",{className:"text-white/80 text-sm",children:o.bio})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"font-bold mb-3",children:[" TRUEREVU REVIEWS (",o.reviews,")"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(q,{className:"bg-white/5 border-white/10",children:s.jsxs(ee,{className:"p-4 space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex gap-1",children:[[...Array(5)].map((h,f)=>s.jsx(hr,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"},f)),s.jsx("span",{className:"text-sm ml-2",children:"5.0"})]}),s.jsx("span",{className:"text-xs text-white/60",children:"3 days ago"})]}),s.jsx("p",{className:"text-sm font-semibold",children:"Jordan K. "}),s.jsx("p",{className:"text-sm text-white/80",children:'"Great experience! Very respectful and professional"'}),s.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-green-400",children:[s.jsx("span",{children:" V.A.I.-CHECK completed"}),s.jsx("span",{children:" DateGuard active"})]})]})}),s.jsx(q,{className:"bg-white/5 border-white/10",children:s.jsxs(ee,{className:"p-4 space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex gap-1",children:[[...Array(5)].map((h,f)=>s.jsx(hr,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"},f)),s.jsx("span",{className:"text-sm ml-2",children:"5.0"})]}),s.jsx("span",{className:"text-xs text-white/60",children:"1 week ago"})]}),s.jsx("p",{className:"text-sm font-semibold",children:"Taylor P. "}),s.jsx("p",{className:"text-sm text-white/80",children:'"Excellent! Highly recommend..."'}),s.jsx("div",{className:"flex flex-wrap gap-2 text-xs text-green-400",children:s.jsx("span",{children:" V.A.I.-CHECK completed"})})]})})]})]})]}),s.jsxs("div",{className:"border-t border-white/10 pt-6 space-y-4",children:[s.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/30 rounded-lg p-4",children:[s.jsx("p",{className:"font-bold mb-2",children:" MAKE YOUR DECISION"}),s.jsx("p",{className:"text-sm text-white/80",children:"Review their profile & reviews carefully. The other person is reviewing yours right now."})]}),s.jsx(L,{onClick:()=>d("accept"),className:"w-full h-14 text-lg bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold",children:"ACCEPT MEETING"}),s.jsx("button",{onClick:()=>d("decline"),className:"w-full text-red-400 hover:text-red-300 text-sm",children:"Decline"})]})]})]}):s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] flex items-center justify-center",children:s.jsx("div",{className:"text-white",children:"Loading..."})})}function Ft(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Hi(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function wWe(e,t){const r=Ft(e);return isNaN(t)?Hi(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function fQ(e,t){const r=Ft(e);if(isNaN(t))return Hi(e,NaN);if(!t)return r;const n=r.getDate(),a=Hi(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const i=a.getDate();return n>=i?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}const pQ=6048e5,jWe=864e5,Sb=43200,JL=1440;let NWe={};function xm(){return NWe}function Ep(e,t){var l,c,u,d;const r=xm(),n=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,a=Ft(e),i=a.getDay(),o=(i<n?7:0)+i-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function b1(e){return Ep(e,{weekStartsOn:1})}function mQ(e){const t=Ft(e),r=t.getFullYear(),n=Hi(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=b1(n),i=Hi(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=b1(i);return t.getTime()>=a.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function w1(e){const t=Ft(e);return t.setHours(0,0,0,0),t}function j1(e){const t=Ft(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function _We(e,t){const r=w1(e),n=w1(t),a=+r-j1(r),i=+n-j1(n);return Math.round((a-i)/jWe)}function SWe(e){const t=mQ(e),r=Hi(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),b1(r)}function Zb(e,t){const r=Ft(e),n=Ft(t),a=r.getTime()-n.getTime();return a<0?-1:a>0?1:a}function CWe(e){return Hi(e,Date.now())}function yS(e,t){const r=w1(e),n=w1(t);return+r==+n}function EWe(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function kWe(e){if(!EWe(e)&&typeof e!="number")return!1;const t=Ft(e);return!isNaN(Number(t))}function AWe(e,t){const r=Ft(e),n=Ft(t),a=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return a*12+i}function PWe(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function TWe(e,t){return+Ft(e)-+Ft(t)}function RWe(e){const t=Ft(e);return t.setHours(23,59,59,999),t}function xA(e){const t=Ft(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function OWe(e){const t=Ft(e);return+RWe(t)==+xA(t)}function IWe(e,t){const r=Ft(e),n=Ft(t),a=Zb(r,n),i=Math.abs(AWe(r,n));let o;if(i<1)o=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*i);let l=Zb(r,n)===-a;OWe(Ft(e))&&i===1&&Zb(e,n)===1&&(l=!1),o=a*(i-Number(l))}return o===0?0:o}function DWe(e,t,r){const n=TWe(e,t)/1e3;return PWe(r==null?void 0:r.roundingMethod)(n)}function MWe(e,t){const r=Ft(e.start),n=Ft(e.end);let a=+r>+n;const i=a?+r:+n,o=a?n:r;o.setHours(0,0,0,0);let l=1;const c=[];for(;+o<=i;)c.push(Ft(o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return a?c.reverse():c}function eB(e){const t=Ft(e);return t.setDate(1),t.setHours(0,0,0,0),t}function $We(e){const t=Ft(e),r=Hi(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function FWe(e,t){var l,c;const r=xm(),n=r.weekStartsOn??((c=(l=r.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??0,a=Ft(e),i=a.getDay(),o=(i<n?-7:0)+6-(i-n);return a.setDate(a.getDate()+o),a.setHours(23,59,59,999),a}const LWe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},BWe=(e,t,r)=>{let n;const a=LWe[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function bS(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const UWe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},VWe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},zWe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},WWe={date:bS({formats:UWe,defaultWidth:"full"}),time:bS({formats:VWe,defaultWidth:"full"}),dateTime:bS({formats:zWe,defaultWidth:"full"})},qWe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},GWe=(e,t,r,n)=>qWe[e];function Qm(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[l]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const HWe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},KWe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},YWe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},XWe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},QWe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ZWe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},JWe=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},eqe={ordinalNumber:JWe,era:Qm({values:HWe,defaultWidth:"wide"}),quarter:Qm({values:KWe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Qm({values:YWe,defaultWidth:"wide"}),day:Qm({values:XWe,defaultWidth:"wide"}),dayPeriod:Qm({values:QWe,defaultWidth:"wide",formattingValues:ZWe,defaultFormattingWidth:"wide"})};function Zm(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const o=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?rqe(l,h=>h.test(o)):tqe(l,h=>h.test(o));let u;u=e.valueCallback?e.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=t.slice(o.length);return{value:u,rest:d}}}function tqe(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function rqe(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function nqe(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(a.length);return{value:o,rest:l}}}const aqe=/^(\d+)(th|st|nd|rd)?/i,sqe=/\d+/i,iqe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},oqe={any:[/^b/i,/^(a|c)/i]},lqe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},cqe={any:[/1/i,/2/i,/3/i,/4/i]},uqe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},dqe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},hqe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},fqe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},pqe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},mqe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},vqe={ordinalNumber:nqe({matchPattern:aqe,parsePattern:sqe,valueCallback:e=>parseInt(e,10)}),era:Zm({matchPatterns:iqe,defaultMatchWidth:"wide",parsePatterns:oqe,defaultParseWidth:"any"}),quarter:Zm({matchPatterns:lqe,defaultMatchWidth:"wide",parsePatterns:cqe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Zm({matchPatterns:uqe,defaultMatchWidth:"wide",parsePatterns:dqe,defaultParseWidth:"any"}),day:Zm({matchPatterns:hqe,defaultMatchWidth:"wide",parsePatterns:fqe,defaultParseWidth:"any"}),dayPeriod:Zm({matchPatterns:pqe,defaultMatchWidth:"any",parsePatterns:mqe,defaultParseWidth:"any"})},vQ={code:"en-US",formatDistance:BWe,formatLong:WWe,formatRelative:GWe,localize:eqe,match:vqe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function gqe(e){const t=Ft(e);return _We(t,$We(t))+1}function xqe(e){const t=Ft(e),r=+b1(t)-+SWe(t);return Math.round(r/pQ)+1}function gQ(e,t){var d,h,f,p;const r=Ft(e),n=r.getFullYear(),a=xm(),i=(t==null?void 0:t.firstWeekContainsDate)??((h=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((p=(f=a.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)??1,o=Hi(e,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const l=Ep(o,t),c=Hi(e,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const u=Ep(c,t);return r.getTime()>=l.getTime()?n+1:r.getTime()>=u.getTime()?n:n-1}function yqe(e,t){var l,c,u,d;const r=xm(),n=(t==null?void 0:t.firstWeekContainsDate)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,a=gQ(e,t),i=Hi(e,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),Ep(i,t)}function bqe(e,t){const r=Ft(e),n=+Ep(r,t)-+yqe(r,t);return Math.round(n/pQ)+1}function ir(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Zl={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return ir(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):ir(r+1,2)},d(e,t){return ir(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return ir(e.getHours()%12||12,t.length)},H(e,t){return ir(e.getHours(),t.length)},m(e,t){return ir(e.getMinutes(),t.length)},s(e,t){return ir(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return ir(a,t.length)}},Ah={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},tB={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return Zl.y(e,t)},Y:function(e,t,r,n){const a=gQ(e,n),i=a>0?a:1-a;if(t==="YY"){const o=i%100;return ir(o,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):ir(i,t.length)},R:function(e,t){const r=mQ(e);return ir(r,t.length)},u:function(e,t){const r=e.getFullYear();return ir(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return ir(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return ir(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Zl.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return ir(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=bqe(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):ir(a,t.length)},I:function(e,t,r){const n=xqe(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):ir(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Zl.d(e,t)},D:function(e,t,r){const n=gqe(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):ir(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return ir(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return ir(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return ir(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=Ah.noon:n===0?a=Ah.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=Ah.evening:n>=12?a=Ah.afternoon:n>=4?a=Ah.morning:a=Ah.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Zl.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Zl.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):ir(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):ir(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Zl.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Zl.s(e,t)},S:function(e,t){return Zl.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return nB(n);case"XXXX":case"XX":return Lu(n);case"XXXXX":case"XXX":default:return Lu(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return nB(n);case"xxxx":case"xx":return Lu(n);case"xxxxx":case"xxx":default:return Lu(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+rB(n,":");case"OOOO":default:return"GMT"+Lu(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+rB(n,":");case"zzzz":default:return"GMT"+Lu(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return ir(n,t.length)},T:function(e,t,r){const n=e.getTime();return ir(n,t.length)}};function rB(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+t+ir(i,2)}function nB(e,t){return e%60===0?(e>0?"-":"+")+ir(Math.abs(e)/60,2):Lu(e,t)}function Lu(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=ir(Math.trunc(n/60),2),i=ir(n%60,2);return r+a+t+i}const aB=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},xQ=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},wqe=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return aB(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",aB(n,t)).replace("{{time}}",xQ(a,t))},jqe={p:xQ,P:wqe},Nqe=/^D+$/,_qe=/^Y+$/,Sqe=["D","DD","YY","YYYY"];function Cqe(e){return Nqe.test(e)}function Eqe(e){return _qe.test(e)}function kqe(e,t,r){const n=Aqe(e,t,r);if(console.warn(n),Sqe.includes(e))throw new RangeError(n)}function Aqe(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Pqe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Tqe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Rqe=/^'([^]*?)'?$/,Oqe=/''/g,Iqe=/[a-zA-Z]/;function Mr(e,t,r){var d,h,f,p;const n=xm(),a=n.locale??vQ,i=n.firstWeekContainsDate??((h=(d=n.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??1,o=n.weekStartsOn??((p=(f=n.locale)==null?void 0:f.options)==null?void 0:p.weekStartsOn)??0,l=Ft(e);if(!kWe(l))throw new RangeError("Invalid time value");let c=t.match(Tqe).map(m=>{const v=m[0];if(v==="p"||v==="P"){const g=jqe[v];return g(m,a.formatLong)}return m}).join("").match(Pqe).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const v=m[0];if(v==="'")return{isToken:!1,value:Dqe(m)};if(tB[v])return{isToken:!0,value:m};if(v.match(Iqe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");return{isToken:!1,value:m}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const u={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return c.map(m=>{if(!m.isToken)return m.value;const v=m.value;(Eqe(v)||Cqe(v))&&kqe(v,t,String(e));const g=tB[v[0]];return g(l,v,a.localize,u)}).join("")}function Dqe(e){const t=e.match(Rqe);return t?t[1].replace(Oqe,"'"):e}function Mqe(e,t,r){const n=xm(),a=(r==null?void 0:r.locale)??n.locale??vQ,i=2520,o=Zb(e,t);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:o});let c,u;o>0?(c=Ft(t),u=Ft(e)):(c=Ft(e),u=Ft(t));const d=DWe(u,c),h=(j1(u)-j1(c))/1e3,f=Math.round((d-h)/60);let p;if(f<2)return r!=null&&r.includeSeconds?d<5?a.formatDistance("lessThanXSeconds",5,l):d<10?a.formatDistance("lessThanXSeconds",10,l):d<20?a.formatDistance("lessThanXSeconds",20,l):d<40?a.formatDistance("halfAMinute",0,l):d<60?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",1,l):f===0?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",f,l);if(f<45)return a.formatDistance("xMinutes",f,l);if(f<90)return a.formatDistance("aboutXHours",1,l);if(f<JL){const m=Math.round(f/60);return a.formatDistance("aboutXHours",m,l)}else{if(f<i)return a.formatDistance("xDays",1,l);if(f<Sb){const m=Math.round(f/JL);return a.formatDistance("xDays",m,l)}else if(f<Sb*2)return p=Math.round(f/Sb),a.formatDistance("aboutXMonths",p,l)}if(p=IWe(u,c),p<12){const m=Math.round(f/Sb);return a.formatDistance("xMonths",m,l)}else{const m=p%12,v=Math.trunc(p/12);return m<3?a.formatDistance("aboutXYears",v,l):m<9?a.formatDistance("overXYears",v,l):a.formatDistance("almostXYears",v+1,l)}}function SI(e,t){return Mqe(e,CWe(e),t)}function $qe(e,t){const r=Ft(e),n=Ft(t);return r.getTime()>n.getTime()}function Fqe(e,t){const r=Ft(e),n=Ft(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function Lqe(e,t){return wWe(e,-t)}function Bqe(e,t){return fQ(e,-t)}function Uqe(){const e=Oe(),[t,r]=w.useState("activate"),[n,a]=w.useState([]),[i,o]=w.useState(!0);w.useEffect(()=>{l()},[]);const l=async()=>{try{const{data:{user:h}}=await T.auth.getUser();if(!h){H.error("You must be logged in"),e("/login");return}const{data:f,error:p}=await T.from("encounters").select("*").or(`provider_id.eq.${h.id},client_id.eq.${h.id}`).order("accepted_at",{ascending:!1});if(p)throw p;if(f){const m=await Promise.all(f.map(async(v,g)=>{const{data:x}=await T.rpc("can_activate_dateguard",{p_encounter_id:v.id});return{...v,windowStatus:x==null?void 0:x[0],encounterNumber:`ENC-${String(g+12340).padStart(5,"0")}`}}));a(m)}}catch(h){console.error("Error fetching encounters:",h),H.error("Failed to load encounters")}finally{o(!1)}},c=async h=>{try{const{data:{user:f}}=await T.auth.getUser();if(!f){H.error("You must be logged in");return}const{data:p}=await T.rpc("can_activate_dateguard",{p_encounter_id:h}),m=p==null?void 0:p[0];if(!(m!=null&&m.can_activate)){H.error((m==null?void 0:m.reason)||"Cannot activate DateGuard");return}e(`/dateguard/activate/${h}`)}catch(f){console.error("Error activating DateGuard:",f),H.error("Failed to activate DateGuard")}},u=n.filter(h=>{var f;return(f=h.windowStatus)==null?void 0:f.can_activate}),d=n.filter(h=>{var f;return!((f=h.windowStatus)!=null&&f.can_activate)});return i?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(lt,{className:"w-16 h-16 mx-auto mb-4 animate-pulse"}),s.jsx("p",{children:"Loading encounters..."})]})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white",children:[s.jsx("header",{className:"sticky top-0 bg-[#0A1628]/95 backdrop-blur-sm border-b border-white/10 px-4 py-4 z-10",children:s.jsxs("div",{className:"max-w-4xl mx-auto flex items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e(-1),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-6 h-6"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(lt,{className:"w-6 h-6 text-purple-400"}),s.jsx("h1",{className:"text-xl font-bold",children:"DATEGUARD"})]})]})}),s.jsx("div",{className:"max-w-4xl mx-auto px-4 pt-6",children:s.jsxs("div",{className:"flex gap-2 bg-white/5 rounded-lg p-1",children:[s.jsx("button",{onClick:()=>r("activate"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-all ${t==="activate"?"bg-purple-600 text-white":"text-white/60 hover:text-white"}`,children:"Activate"}),s.jsx("button",{onClick:()=>r("active"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-all ${t==="active"?"bg-purple-600 text-white":"text-white/60 hover:text-white"}`,children:"Active"}),s.jsx("button",{onClick:()=>r("history"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-all ${t==="history"?"bg-purple-600 text-white":"text-white/60 hover:text-white"}`,children:"History"})]})}),s.jsxs("main",{className:"max-w-4xl mx-auto px-4 py-6 space-y-6 pb-24",children:[t==="activate"&&s.jsxs(s.Fragment,{children:[u.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[s.jsx(ut,{className:"w-5 h-5 text-green-400"}),"READY TO ACTIVATE (",u.length,")"]}),u.map(h=>s.jsxs("div",{className:"bg-white/5 rounded-xl p-6 space-y-4 border border-white/10",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-600/20 flex items-center justify-center",children:s.jsx(lt,{className:"w-6 h-6 text-purple-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("h3",{className:"font-bold",children:["Encounter ",h.encounterNumber]}),s.jsx("p",{className:"text-sm text-white/60",children:"V.A.I.-CHECK Completed"})]})]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ut,{className:"w-4 h-4 text-green-400"}),s.jsx("span",{children:"V.A.I.-CHECK completed"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ut,{className:"w-4 h-4 text-green-400"}),s.jsx("span",{children:"Contract signed"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Yn,{className:"w-4 h-4 text-white/60"}),s.jsxs("span",{children:["Started: ",Mr(new Date(h.accepted_at),"MMM d, yyyy 'at' h:mm a")]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-white/60",children:"Status:"}),s.jsx("span",{className:"capitalize",children:h.status})]})]}),h.windowStatus&&s.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-3 flex items-center gap-2",children:[s.jsx(On,{className:"w-5 h-5 text-green-400"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-green-400",children:"Activation available"}),s.jsxs("p",{className:"text-xs text-white/60",children:[h.windowStatus.days_remaining," days remaining"]})]})]}),s.jsxs(L,{onClick:()=>c(h.id),className:"w-full h-12 bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-semibold",children:[s.jsx(lt,{className:"w-5 h-5 mr-2"}),"ACTIVATE NOW"]})]},h.id))]}),d.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[s.jsx(Or,{className:"w-5 h-5 text-orange-400"}),"ACTIVATION WINDOW CLOSED (",d.length,")"]}),d.map(h=>s.jsxs("div",{className:"bg-white/5 rounded-xl p-6 space-y-4 border border-orange-400/30 opacity-75",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-600/20 flex items-center justify-center",children:s.jsx(Or,{className:"w-6 h-6 text-gray-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("h3",{className:"font-bold",children:["Encounter ",h.encounterNumber]}),s.jsx("p",{className:"text-sm text-orange-400",children:" Cannot activate"})]})]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[h.reviews_window_closed_reason==="reviews_posted"?s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-white/80",children:"Reviews already posted"}),h.reviews_published_at&&s.jsxs("p",{className:"text-white/60",children:["Published: ",Mr(new Date(h.reviews_published_at),"MMM d, yyyy")]})]}):s.jsx("p",{className:"text-white/80",children:"7-day deadline passed"}),h.dateguard_window_closed_at&&s.jsxs("p",{className:"text-white/60",children:["Window closed: ",Mr(new Date(h.dateguard_window_closed_at),"MMM d, yyyy")]})]}),s.jsxs(L,{disabled:!0,className:"w-full h-12 bg-gray-600 text-white font-semibold opacity-50 cursor-not-allowed",children:[s.jsx(Or,{className:"w-5 h-5 mr-2"}),"ACTIVATE NOW"]}),s.jsxs("div",{className:"bg-background/10 rounded-lg p-3 text-xs text-white/70",children:[s.jsx("p",{className:"font-medium text-white/90 mb-1",children:" DateGuard must be activated before reviews"}),s.jsx("p",{children:"Activation is only available while the review window is open (up to 7 days)."})]})]},h.id))]}),n.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(lt,{className:"w-16 h-16 mx-auto mb-4 text-white/20"}),s.jsx("h3",{className:"text-xl font-bold mb-2",children:"No Encounters Yet"}),s.jsx("p",{className:"text-white/60 mb-6",children:"Complete a V.A.I.-CHECK to activate DateGuard protection"}),s.jsx(L,{onClick:()=>e("/vai-check"),className:"bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700",children:"Start V.A.I.-CHECK"})]})]}),t==="active"&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(lt,{className:"w-16 h-16 mx-auto mb-4 text-white/20"}),s.jsx("h3",{className:"text-xl font-bold mb-2",children:"No Active Sessions"}),s.jsx("p",{className:"text-white/60",children:"Your active DateGuard sessions will appear here"})]}),t==="history"&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(lt,{className:"w-16 h-16 mx-auto mb-4 text-white/20"}),s.jsx("h3",{className:"text-xl font-bold mb-2",children:"No Session History"}),s.jsx("p",{className:"text-white/60",children:"Your completed DateGuard sessions will appear here"})]})]})]})}function Vqe(){const e=Oe(),{sessionId:t,role:r}=us(),{toast:n}=Et(),[a,i]=w.useState(!0),[o,l]=w.useState(!1),c=async()=>{const u=document.querySelector("video");if(!u)return;const d=document.createElement("canvas");d.width=u.videoWidth,d.height=u.videoHeight;const h=d.getContext("2d");h==null||h.drawImage(u,0,0);const f=d.toDataURL("image/jpeg");i(!1),l(!0);const p=r==="provider"?"provider_final_verified":"client_final_verified",m=r==="provider"?"provider_final_face_url":"client_final_face_url",{error:v}=await T.from("vai_check_sessions").update({[p]:!0,[m]:f}).eq("id",t);if(v){n({title:"Error",variant:"destructive"});return}const{data:g}=await T.from("vai_check_sessions").select("*").eq("id",t).single();g&&g.provider_final_verified&&g.client_final_verified&&(await T.from("vai_check_sessions").update({status:"completed",completed_at:new Date().toISOString()}).eq("id",t),setTimeout(()=>{e(`/vai-check/complete/${t}`)},2e3))};return o?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4 p-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-cyan-400 mx-auto"}),s.jsx("h2",{className:"text-xl font-bold",children:"Verifying both identities..."}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("p",{className:"text-green-400",children:[" ",r==="provider"?"Sarah K.":"Alex M."," verified"]}),s.jsxs("p",{className:"text-white/60",children:[" Verifying ",r==="provider"?"Alex M.":"Sarah K.","..."]})]})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white",children:s.jsxs("main",{className:"px-4 py-8 max-w-md mx-auto space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h1",{className:"text-2xl font-bold",children:" Final Verification"}),s.jsx("p",{className:"text-white/80",children:"One more quick face scan to confirm it's really you"})]}),s.jsx("div",{className:"relative aspect-[3/4] bg-black/20 rounded-lg overflow-hidden",children:s.jsx(ty,{isActive:a,onStreamReady:()=>{}})}),s.jsx("div",{className:"space-y-3",children:s.jsx(L,{onClick:c,className:"w-full h-14 text-lg bg-gradient-to-r from-cyan-500 to-cyan-600 hover:from-cyan-600 hover:to-cyan-700",children:"CAPTURE"})})]})})}function zqe(){const e=Oe(),{sessionId:t}=us(),[r,n]=w.useState(null),[a,i]=w.useState(!0),[o,l]=w.useState(!1),[c,u]=w.useState(null),[d,h]=w.useState(null);w.useEffect(()=>{f()},[t]);const f=async()=>{if(t)try{const{data:v,error:g}=await T.from("vai_check_sessions").select("encounter_id, status").eq("id",t).single();if(g)throw g;if(v.encounter_id){h(v.encounter_id),m(v.encounter_id);return}v.status==="completed"?await p():i(!1)}catch(v){console.error("Error initializing encounter:",v),H.error(v.message||"Failed to load session"),i(!1)}},p=async()=>{if(t){l(!0);try{const{data:v,error:g}=await T.functions.invoke("create-encounter",{body:{session_id:t}});if(g)throw g;if(v!=null&&v.success&&(v!=null&&v.encounter_id))h(v.encounter_id),await m(v.encounter_id),H.success("Encounter created successfully!");else throw new Error((v==null?void 0:v.error)||"Failed to create encounter")}catch(v){console.error("Error creating encounter:",v),H.error(v.message||"Failed to create encounter")}finally{l(!1),i(!1)}}},m=async v=>{try{const{data:g,error:x}=await T.from("encounters").select("*").eq("id",v).single();if(x)throw x;u(g);const{data:y}=await T.rpc("can_activate_dateguard",{p_encounter_id:v});y&&y.length>0&&n(y[0])}catch(g){console.error("Error loading encounter details:",g)}finally{i(!1)}};return a||o?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx(Er,{className:"w-16 h-16 animate-spin text-cyan-400 mx-auto"}),s.jsx("p",{children:o?"Creating encounter...":"Loading..."})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white",children:s.jsxs("main",{className:"px-4 py-8 max-w-md mx-auto space-y-6",children:[s.jsxs("div",{className:"text-center space-y-6 py-8",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 bg-green-400/20 rounded-full blur-2xl animate-pulse"}),s.jsx(ut,{className:"w-32 h-32 text-green-400 mx-auto relative"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h1",{className:"text-3xl font-bold",children:" V.A.I.-CHECK COMPLETE"}),s.jsx("p",{className:"text-xl text-white/80",children:"Both Identities Verified"})]}),s.jsxs("div",{className:"bg-white/5 rounded-lg p-6 space-y-3 text-left",children:[s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-green-400",children:""}),"Identities verified"]}),s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-green-400",children:""}),"Contract signed by both"]}),c&&s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-green-400",children:""}),"Encounter created"]})]}),s.jsx("p",{className:"text-white/80",children:"You can now proceed with your meeting safely"}),c&&s.jsxs("div",{className:"bg-white/5 rounded-lg p-4 space-y-2 text-sm border border-white/10",children:[s.jsxs("p",{children:[s.jsx("span",{className:"text-white/60",children:" Encounter ID:"})," ",c.id.substring(0,8),"..."]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-white/60",children:" Created:"})," ",new Date(c.created_at).toLocaleString()]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-white/60",children:" DateGuard:"})," ",r!=null&&r.can_activate?"Ready to activate":"Window closed"]}),r&&r.can_activate&&s.jsxs("p",{className:"flex items-center gap-2 text-green-400",children:[s.jsx(On,{className:"w-4 h-4"}),s.jsxs("span",{children:["Activation window: ",r.days_remaining," days remaining"]})]}),r&&!r.can_activate&&s.jsxs("p",{className:"flex items-center gap-2 text-orange-400",children:[s.jsx(Or,{className:"w-4 h-4"}),s.jsxs("span",{children:["Window closed: ",r.reason]})]})]}),!c&&s.jsx(Hn,{className:"border-yellow-500/50 bg-yellow-500/10",children:s.jsxs(Kn,{className:"text-white",children:[s.jsx("div",{className:"font-semibold mb-2",children:"Encounter Not Created"}),s.jsx("p",{className:"text-sm text-white/80",children:"There was an issue creating your encounter. Please try again or contact support."})]})}),s.jsxs("div",{className:"bg-background/10 rounded-lg p-4 space-y-2 text-sm border border-cyan-400/30",children:[s.jsx("p",{className:"font-semibold text-cyan-400",children:" IMPORTANT:"}),s.jsx("p",{className:"text-white/80",children:"DateGuard can be activated until reviews are posted (up to 7 days)."}),s.jsx("p",{className:"text-white/80",children:"After reviews post, this encounter will be closed and DateGuard can no longer be activated."}),s.jsx("p",{className:"text-white/90 font-medium mt-2",children:"Activate now for maximum safety!"})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(L,{onClick:()=>e("/dateguard"),disabled:!(r!=null&&r.can_activate),className:"w-full h-14 text-lg bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:r&&!r.can_activate?s.jsxs(s.Fragment,{children:[s.jsx(Or,{className:"w-5 h-5 mr-2"}),"ACTIVATION WINDOW CLOSED"]}):s.jsxs(s.Fragment,{children:["ACTIVATE DATEGUARD",s.jsx("span",{className:"text-xs ml-2",children:"(Optional, recommended)"})]})}),c&&s.jsx(L,{onClick:()=>e(`/vai-check/review/${t}`),className:"w-full h-14 text-lg bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 text-white font-semibold",children:"LEAVE A REVIEW"}),s.jsx("button",{onClick:()=>e("/feed"),className:"w-full text-white/60 hover:text-white text-sm",children:"Continue Without DateGuard"})]})]})})}function Wqe({providerId:e,providerName:t,onClose:r}){const n=Oe(),{toast:a}=Et(),[i,o]=w.useState(!1),[l,c]=w.useState({date:"",time:"",duration:"1",services:"",notes:""}),u=async d=>{d.preventDefault(),o(!0);try{const{data:{user:h}}=await T.auth.getUser();if(!h)throw new Error("Not authenticated");const f=Math.random().toString(36).substring(2,10).toUpperCase(),{data:p,error:m}=await T.from("vai_check_sessions").insert({provider_id:e,client_id:h.id,session_code:f,status:"pending_provider_response",metadata:{requested_date:l.date,requested_time:l.time,duration_hours:l.duration,services:l.services,notes:l.notes}}).select().single();if(m)throw m;const{error:v}=await T.from("encounters").insert({session_id:p.id,provider_id:e,client_id:h.id,status:"vairidate_pending"});if(v)throw v;a({title:"Request Sent",description:`Your Vairidate request has been sent to ${t}`}),n("/feed"),r==null||r()}catch(h){console.error("Error creating Vairidate request:",h),a({title:"Error",description:"Failed to send request. Please try again.",variant:"destructive"})}finally{o(!1)}};return s.jsx("div",{className:"min-h-screen bg-background p-4",children:s.jsxs(q,{className:"max-w-md mx-auto",children:[s.jsx(ge,{children:s.jsxs(be,{className:"flex items-center gap-2",children:[s.jsx(Yn,{className:"w-5 h-5"}),"Schedule with ",t]})}),s.jsx(ee,{children:s.jsxs("form",{onSubmit:u,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"date",children:"Preferred Date"}),s.jsx(De,{id:"date",type:"date",required:!0,value:l.date,onChange:d=>c({...l,date:d.target.value}),min:new Date().toISOString().split("T")[0]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"time",children:"Preferred Time"}),s.jsx(De,{id:"time",type:"time",required:!0,value:l.time,onChange:d=>c({...l,time:d.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"duration",children:"Duration (hours)"}),s.jsx(De,{id:"duration",type:"number",min:"0.5",step:"0.5",required:!0,value:l.duration,onChange:d=>c({...l,duration:d.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"services",children:"Requested Services"}),s.jsx(Mn,{id:"services",placeholder:"Describe the services you're interested in...",required:!0,value:l.services,onChange:d=>c({...l,services:d.target.value}),rows:3})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"notes",children:"Additional Notes (Optional)"}),s.jsx(Mn,{id:"notes",placeholder:"Any special requests or information...",value:l.notes,onChange:d=>c({...l,notes:d.target.value}),rows:2})]}),s.jsxs("div",{className:"bg-muted p-4 rounded-lg space-y-2",children:[s.jsx("p",{className:"text-sm font-medium",children:"Next Steps:"}),s.jsxs("ol",{className:"text-sm text-muted-foreground space-y-1 list-decimal list-inside",children:[s.jsx("li",{children:"You'll complete a facial scan for VAI verification"}),s.jsx("li",{children:"Provider receives your request with profile"}),s.jsx("li",{children:"Provider can accept, decline, or suggest changes"}),s.jsx("li",{children:"If accepted, both parties sign mutual consent"}),s.jsx("li",{children:"Final facial verification before meeting"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(L,{type:"button",variant:"outline",onClick:r,className:"flex-1",children:"Cancel"}),s.jsx(L,{type:"submit",disabled:i,className:"flex-1",children:i?"Sending...":"Send Request"})]})]})})]})})}function qqe(){const{providerId:e,providerName:t}=us();return!e||!t?s.jsx("div",{children:"Invalid request"}):s.jsx(Wqe,{providerId:e,providerName:decodeURIComponent(t)})}function Gqe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w.useMemo(()=>n=>{t.forEach(a=>a(n))},t)}const ZN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function ym(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function CI(e){return"nodeType"in e}function hs(e){var t,r;return e?ym(e)?e:CI(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function EI(e){const{Document:t}=hs(e);return e instanceof t}function ry(e){return ym(e)?!1:e instanceof hs(e).HTMLElement}function yQ(e){return e instanceof hs(e).SVGElement}function bm(e){return e?ym(e)?e.document:CI(e)?EI(e)?e:ry(e)||yQ(e)?e.ownerDocument:document:document:document}const Fo=ZN?w.useLayoutEffect:w.useEffect;function kI(e){const t=w.useRef(e);return Fo(()=>{t.current=e}),w.useCallback(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t.current==null?void 0:t.current(...n)},[])}function Hqe(){const e=w.useRef(null),t=w.useCallback((n,a)=>{e.current=setInterval(n,a)},[]),r=w.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function lx(e,t){t===void 0&&(t=[e]);const r=w.useRef(e);return Fo(()=>{r.current!==e&&(r.current=e)},t),r}function ny(e,t){const r=w.useRef();return w.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function N1(e){const t=kI(e),r=w.useRef(null),n=w.useCallback(a=>{a!==r.current&&(t==null||t(a,r.current)),r.current=a},[]);return[r,n]}function yA(e){const t=w.useRef();return w.useEffect(()=>{t.current=e},[e]),t.current}let wS={};function ay(e,t){return w.useMemo(()=>{if(t)return t;const r=wS[e]==null?0:wS[e]+1;return wS[e]=r,e+"-"+r},[e,t])}function bQ(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return n.reduce((i,o)=>{const l=Object.entries(o);for(const[c,u]of l){const d=i[c];d!=null&&(i[c]=d+e*u)}return i},{...t})}}const Pf=bQ(1),cx=bQ(-1);function Kqe(e){return"clientX"in e&&"clientY"in e}function AI(e){if(!e)return!1;const{KeyboardEvent:t}=hs(e.target);return t&&e instanceof t}function Yqe(e){if(!e)return!1;const{TouchEvent:t}=hs(e.target);return t&&e instanceof t}function bA(e){if(Yqe(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return Kqe(e)?{x:e.clientX,y:e.clientY}:null}const Vd=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Vd.Translate.toString(e),Vd.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),sB="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Xqe(e){return e.matches(sB)?e:e.querySelector(sB)}const Qqe={display:"none"};function Zqe(e){let{id:t,value:r}=e;return F.createElement("div",{id:t,style:Qqe},r)}function Jqe(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return F.createElement("div",{id:t,style:a,role:"status","aria-live":n,"aria-atomic":!0},r)}function eGe(){const[e,t]=w.useState("");return{announce:w.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const wQ=w.createContext(null);function tGe(e){const t=w.useContext(wQ);w.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function rGe(){const[e]=w.useState(()=>new Set),t=w.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[w.useCallback(n=>{let{type:a,event:i}=n;e.forEach(o=>{var l;return(l=o[a])==null?void 0:l.call(o,i)})},[e]),t]}const nGe={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},aGe={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function sGe(e){let{announcements:t=aGe,container:r,hiddenTextDescribedById:n,screenReaderInstructions:a=nGe}=e;const{announce:i,announcement:o}=eGe(),l=ay("DndLiveRegion"),[c,u]=w.useState(!1);if(w.useEffect(()=>{u(!0)},[]),tGe(w.useMemo(()=>({onDragStart(h){let{active:f}=h;i(t.onDragStart({active:f}))},onDragMove(h){let{active:f,over:p}=h;t.onDragMove&&i(t.onDragMove({active:f,over:p}))},onDragOver(h){let{active:f,over:p}=h;i(t.onDragOver({active:f,over:p}))},onDragEnd(h){let{active:f,over:p}=h;i(t.onDragEnd({active:f,over:p}))},onDragCancel(h){let{active:f,over:p}=h;i(t.onDragCancel({active:f,over:p}))}}),[i,t])),!c)return null;const d=F.createElement(F.Fragment,null,F.createElement(Zqe,{id:n,value:a.draggable}),F.createElement(Jqe,{id:l,announcement:o}));return r?ei.createPortal(d,r):d}var Sn;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Sn||(Sn={}));function _1(){}function kp(e,t){return w.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function PI(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const Ki=Object.freeze({x:0,y:0});function jQ(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function NQ(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function iGe(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function iB(e){let{left:t,top:r,height:n,width:a}=e;return[{x:t,y:r},{x:t+a,y:r},{x:t,y:r+n},{x:t+a,y:r+n}]}function _Q(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function oB(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const TI=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=oB(t,t.left,t.top),i=[];for(const o of n){const{id:l}=o,c=r.get(l);if(c){const u=jQ(oB(c),a);i.push({id:l,data:{droppableContainer:o,value:u}})}}return i.sort(NQ)},oGe=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=iB(t),i=[];for(const o of n){const{id:l}=o,c=r.get(l);if(c){const u=iB(c),d=a.reduce((f,p,m)=>f+jQ(u[m],p),0),h=Number((d/4).toFixed(4));i.push({id:l,data:{droppableContainer:o,value:h}})}}return i.sort(NQ)};function lGe(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),o=a-n,l=i-r;if(n<a&&r<i){const c=t.width*t.height,u=e.width*e.height,d=o*l,h=d/(c+u-d);return Number(h.toFixed(4))}return 0}const cGe=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=[];for(const i of n){const{id:o}=i,l=r.get(o);if(l){const c=lGe(l,t);c>0&&a.push({id:o,data:{droppableContainer:i,value:c}})}}return a.sort(iGe)};function uGe(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function SQ(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Ki}function dGe(e){return function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return a.reduce((o,l)=>({...o,top:o.top+e*l.y,bottom:o.bottom+e*l.y,left:o.left+e*l.x,right:o.right+e*l.x}),{...r})}}const hGe=dGe(1);function fGe(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function pGe(e,t,r){const n=fGe(t);if(!n)return e;const{scaleX:a,scaleY:i,x:o,y:l}=n,c=e.left-o-(1-a)*parseFloat(r),u=e.top-l-(1-i)*parseFloat(r.slice(r.indexOf(" ")+1)),d=a?e.width/a:e.width,h=i?e.height/i:e.height;return{width:d,height:h,top:u,right:c+d,bottom:u+h,left:c}}const mGe={ignoreTransform:!1};function wm(e,t){t===void 0&&(t=mGe);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:d}=hs(e).getComputedStyle(e);u&&(r=pGe(r,u,d))}const{top:n,left:a,width:i,height:o,bottom:l,right:c}=r;return{top:n,left:a,width:i,height:o,bottom:l,right:c}}function lB(e){return wm(e,{ignoreTransform:!0})}function vGe(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function gGe(e,t){return t===void 0&&(t=hs(e).getComputedStyle(e)),t.position==="fixed"}function xGe(e,t){t===void 0&&(t=hs(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const i=t[a];return typeof i=="string"?r.test(i):!1})}function JN(e,t){const r=[];function n(a){if(t!=null&&r.length>=t||!a)return r;if(EI(a)&&a.scrollingElement!=null&&!r.includes(a.scrollingElement))return r.push(a.scrollingElement),r;if(!ry(a)||yQ(a)||r.includes(a))return r;const i=hs(e).getComputedStyle(a);return a!==e&&xGe(a,i)&&r.push(a),gGe(a,i)?r:n(a.parentNode)}return e?n(e):r}function CQ(e){const[t]=JN(e,1);return t??null}function jS(e){return!ZN||!e?null:ym(e)?e:CI(e)?EI(e)||e===bm(e).scrollingElement?window:ry(e)?e:null:null}function EQ(e){return ym(e)?e.scrollX:e.scrollLeft}function kQ(e){return ym(e)?e.scrollY:e.scrollTop}function wA(e){return{x:EQ(e),y:kQ(e)}}var Wn;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Wn||(Wn={}));function AQ(e){return!ZN||!e?!1:e===document.scrollingElement}function PQ(e){const t={x:0,y:0},r=AQ(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},a=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,o=e.scrollTop>=n.y,l=e.scrollLeft>=n.x;return{isTop:a,isLeft:i,isBottom:o,isRight:l,maxScroll:n,minScroll:t}}const yGe={x:.2,y:.2};function bGe(e,t,r,n,a){let{top:i,left:o,right:l,bottom:c}=r;n===void 0&&(n=10),a===void 0&&(a=yGe);const{isTop:u,isBottom:d,isLeft:h,isRight:f}=PQ(e),p={x:0,y:0},m={x:0,y:0},v={height:t.height*a.y,width:t.width*a.x};return!u&&i<=t.top+v.height?(p.y=Wn.Backward,m.y=n*Math.abs((t.top+v.height-i)/v.height)):!d&&c>=t.bottom-v.height&&(p.y=Wn.Forward,m.y=n*Math.abs((t.bottom-v.height-c)/v.height)),!f&&l>=t.right-v.width?(p.x=Wn.Forward,m.x=n*Math.abs((t.right-v.width-l)/v.width)):!h&&o<=t.left+v.width&&(p.x=Wn.Backward,m.x=n*Math.abs((t.left+v.width-o)/v.width)),{direction:p,speed:m}}function wGe(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:o}=window;return{top:0,left:0,right:i,bottom:o,width:i,height:o}}const{top:t,left:r,right:n,bottom:a}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:a,width:e.clientWidth,height:e.clientHeight}}function TQ(e){return e.reduce((t,r)=>Pf(t,wA(r)),Ki)}function jGe(e){return e.reduce((t,r)=>t+EQ(r),0)}function NGe(e){return e.reduce((t,r)=>t+kQ(r),0)}function _Ge(e,t){if(t===void 0&&(t=wm),!e)return;const{top:r,left:n,bottom:a,right:i}=t(e);CQ(e)&&(a<=0||i<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const SGe=[["x",["left","right"],jGe],["y",["top","bottom"],NGe]];class RI{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=JN(r),a=TQ(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,o,l]of SGe)for(const c of o)Object.defineProperty(this,c,{get:()=>{const u=l(n),d=a[i]-u;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class $v{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var a;(a=this.target)==null||a.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function CGe(e){const{EventTarget:t}=hs(e);return e instanceof t?e:bm(e)}function NS(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var Gs;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Gs||(Gs={}));function cB(e){e.preventDefault()}function EGe(e){e.stopPropagation()}var Gt;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Gt||(Gt={}));const RQ={start:[Gt.Space,Gt.Enter],cancel:[Gt.Esc],end:[Gt.Space,Gt.Enter,Gt.Tab]},kGe=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Gt.Right:return{...r,x:r.x+25};case Gt.Left:return{...r,x:r.x-25};case Gt.Down:return{...r,y:r.y+25};case Gt.Up:return{...r,y:r.y-25}}};class sy{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new $v(bm(r)),this.windowListeners=new $v(hs(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Gs.Resize,this.handleCancel),this.windowListeners.add(Gs.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Gs.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&_Ge(n),r(Ki)}handleKeyDown(t){if(AI(t)){const{active:r,context:n,options:a}=this.props,{keyboardCodes:i=RQ,coordinateGetter:o=kGe,scrollBehavior:l="smooth"}=a,{code:c}=t;if(i.end.includes(c)){this.handleEnd(t);return}if(i.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:u}=n.current,d=u?{x:u.left,y:u.top}:Ki;this.referenceCoordinates||(this.referenceCoordinates=d);const h=o(t,{active:r,context:n.current,currentCoordinates:d});if(h){const f=cx(h,d),p={x:0,y:0},{scrollableAncestors:m}=n.current;for(const v of m){const g=t.code,{isTop:x,isRight:y,isLeft:b,isBottom:N,maxScroll:j,minScroll:_}=PQ(v),S=wGe(v),C={x:Math.min(g===Gt.Right?S.right-S.width/2:S.right,Math.max(g===Gt.Right?S.left:S.left+S.width/2,h.x)),y:Math.min(g===Gt.Down?S.bottom-S.height/2:S.bottom,Math.max(g===Gt.Down?S.top:S.top+S.height/2,h.y))},E=g===Gt.Right&&!y||g===Gt.Left&&!b,k=g===Gt.Down&&!N||g===Gt.Up&&!x;if(E&&C.x!==h.x){const P=v.scrollLeft+f.x,A=g===Gt.Right&&P<=j.x||g===Gt.Left&&P>=_.x;if(A&&!f.y){v.scrollTo({left:P,behavior:l});return}A?p.x=v.scrollLeft-P:p.x=g===Gt.Right?v.scrollLeft-j.x:v.scrollLeft-_.x,p.x&&v.scrollBy({left:-p.x,behavior:l});break}else if(k&&C.y!==h.y){const P=v.scrollTop+f.y,A=g===Gt.Down&&P<=j.y||g===Gt.Up&&P>=_.y;if(A&&!f.x){v.scrollTo({top:P,behavior:l});return}A?p.y=v.scrollTop-P:p.y=g===Gt.Down?v.scrollTop-j.y:v.scrollTop-_.y,p.y&&v.scrollBy({top:-p.y,behavior:l});break}}this.handleMove(t,Pf(cx(h,this.referenceCoordinates),p))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}sy.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=RQ,onActivation:a}=t,{active:i}=r;const{code:o}=e.nativeEvent;if(n.start.includes(o)){const l=i.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function uB(e){return!!(e&&"distance"in e)}function dB(e){return!!(e&&"delay"in e)}class OI{constructor(t,r,n){var a;n===void 0&&(n=CGe(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:i}=t,{target:o}=i;this.props=t,this.events=r,this.document=bm(o),this.documentListeners=new $v(this.document),this.listeners=new $v(n),this.windowListeners=new $v(hs(o)),this.initialCoordinates=(a=bA(i))!=null?a:Ki,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Gs.Resize,this.handleCancel),this.windowListeners.add(Gs.DragStart,cB),this.windowListeners.add(Gs.VisibilityChange,this.handleCancel),this.windowListeners.add(Gs.ContextMenu,cB),this.documentListeners.add(Gs.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(dB(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(uB(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:a}=this.props;a(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(Gs.Click,EGe,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Gs.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:a,props:i}=this,{onMove:o,options:{activationConstraint:l}}=i;if(!a)return;const c=(r=bA(t))!=null?r:Ki,u=cx(a,c);if(!n&&l){if(uB(l)){if(l.tolerance!=null&&NS(u,l.tolerance))return this.handleCancel();if(NS(u,l.distance))return this.handleStart()}if(dB(l)&&NS(u,l.tolerance))return this.handleCancel();this.handlePending(l,u);return}t.cancelable&&t.preventDefault(),o(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Gt.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const AGe={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class iy extends OI{constructor(t){const{event:r}=t,n=bm(r.target);super(t,AGe,n)}}iy.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];const PGe={move:{name:"mousemove"},end:{name:"mouseup"}};var jA;(function(e){e[e.RightClick=2]="RightClick"})(jA||(jA={}));class TGe extends OI{constructor(t){super(t,PGe,bm(t.event.target))}}TGe.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===jA.RightClick?!1:(n==null||n({event:r}),!0)}}];const _S={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class RGe extends OI{constructor(t){super(t,_S)}static setup(){return window.addEventListener(_S.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(_S.move.name,t)};function t(){}}}RGe.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:a}=r;return a.length>1?!1:(n==null||n({event:r}),!0)}}];var Fv;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Fv||(Fv={}));var S1;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(S1||(S1={}));function OGe(e){let{acceleration:t,activator:r=Fv.Pointer,canScroll:n,draggingRect:a,enabled:i,interval:o=5,order:l=S1.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:h,threshold:f}=e;const p=DGe({delta:h,disabled:!i}),[m,v]=Hqe(),g=w.useRef({x:0,y:0}),x=w.useRef({x:0,y:0}),y=w.useMemo(()=>{switch(r){case Fv.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Fv.DraggableRect:return a}},[r,a,c]),b=w.useRef(null),N=w.useCallback(()=>{const _=b.current;if(!_)return;const S=g.current.x*x.current.x,C=g.current.y*x.current.y;_.scrollBy(S,C)},[]),j=w.useMemo(()=>l===S1.TreeOrder?[...u].reverse():u,[l,u]);w.useEffect(()=>{if(!i||!u.length||!y){v();return}for(const _ of j){if((n==null?void 0:n(_))===!1)continue;const S=u.indexOf(_),C=d[S];if(!C)continue;const{direction:E,speed:k}=bGe(_,C,y,t,f);for(const P of["x","y"])p[P][E[P]]||(k[P]=0,E[P]=0);if(k.x>0||k.y>0){v(),b.current=_,m(N,o),g.current=k,x.current=E;return}}g.current={x:0,y:0},x.current={x:0,y:0},v()},[t,N,n,v,i,o,JSON.stringify(y),JSON.stringify(p),m,u,j,d,JSON.stringify(f)])}const IGe={x:{[Wn.Backward]:!1,[Wn.Forward]:!1},y:{[Wn.Backward]:!1,[Wn.Forward]:!1}};function DGe(e){let{delta:t,disabled:r}=e;const n=yA(t);return ny(a=>{if(r||!n||!a)return IGe;const i={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[Wn.Backward]:a.x[Wn.Backward]||i.x===-1,[Wn.Forward]:a.x[Wn.Forward]||i.x===1},y:{[Wn.Backward]:a.y[Wn.Backward]||i.y===-1,[Wn.Forward]:a.y[Wn.Forward]||i.y===1}}},[r,t,n])}function MGe(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return ny(a=>{var i;return t==null?null:(i=n??a)!=null?i:null},[n,t])}function $Ge(e,t){return w.useMemo(()=>e.reduce((r,n)=>{const{sensor:a}=n,i=a.activators.map(o=>({eventName:o.eventName,handler:t(o.handler,n)}));return[...r,...i]},[]),[e,t])}var ux;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(ux||(ux={}));var NA;(function(e){e.Optimized="optimized"})(NA||(NA={}));const hB=new Map;function FGe(e,t){let{dragging:r,dependencies:n,config:a}=t;const[i,o]=w.useState(null),{frequency:l,measure:c,strategy:u}=a,d=w.useRef(e),h=g(),f=lx(h),p=w.useCallback(function(x){x===void 0&&(x=[]),!f.current&&o(y=>y===null?x:y.concat(x.filter(b=>!y.includes(b))))},[f]),m=w.useRef(null),v=ny(x=>{if(h&&!r)return hB;if(!x||x===hB||d.current!==e||i!=null){const y=new Map;for(let b of e){if(!b)continue;if(i&&i.length>0&&!i.includes(b.id)&&b.rect.current){y.set(b.id,b.rect.current);continue}const N=b.node.current,j=N?new RI(c(N),N):null;b.rect.current=j,j&&y.set(b.id,j)}return y}return x},[e,i,r,h,c]);return w.useEffect(()=>{d.current=e},[e]),w.useEffect(()=>{h||p()},[r,h]),w.useEffect(()=>{i&&i.length>0&&o(null)},[JSON.stringify(i)]),w.useEffect(()=>{h||typeof l!="number"||m.current!==null||(m.current=setTimeout(()=>{p(),m.current=null},l))},[l,h,p,...n]),{droppableRects:v,measureDroppableContainers:p,measuringScheduled:i!=null};function g(){switch(u){case ux.Always:return!1;case ux.BeforeDragging:return r;default:return!r}}}function OQ(e,t){return ny(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function LGe(e,t){return OQ(e,t)}function BGe(e){let{callback:t,disabled:r}=e;const n=kI(t),a=w.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(n)},[n,r]);return w.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function e_(e){let{callback:t,disabled:r}=e;const n=kI(t),a=w.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(n)},[r]);return w.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function UGe(e){return new RI(wm(e),e)}function fB(e,t,r){t===void 0&&(t=UGe);const[n,a]=w.useState(null);function i(){a(c=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=c??r)!=null?u:null}const d=t(e);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const o=BGe({callback(c){if(e)for(const u of c){const{type:d,target:h}=u;if(d==="childList"&&h instanceof HTMLElement&&h.contains(e)){i();break}}}}),l=e_({callback:i});return Fo(()=>{i(),e?(l==null||l.observe(e),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),o==null||o.disconnect())},[e]),n}function VGe(e){const t=OQ(e);return SQ(e,t)}const pB=[];function zGe(e){const t=w.useRef(e),r=ny(n=>e?n&&n!==pB&&e&&t.current&&e.parentNode===t.current.parentNode?n:JN(e):pB,[e]);return w.useEffect(()=>{t.current=e},[e]),r}function WGe(e){const[t,r]=w.useState(null),n=w.useRef(e),a=w.useCallback(i=>{const o=jS(i.target);o&&r(l=>l?(l.set(o,wA(o)),new Map(l)):null)},[]);return w.useEffect(()=>{const i=n.current;if(e!==i){o(i);const l=e.map(c=>{const u=jS(c);return u?(u.addEventListener("scroll",a,{passive:!0}),[u,wA(u)]):null}).filter(c=>c!=null);r(l.length?new Map(l):null),n.current=e}return()=>{o(e),o(i)};function o(l){l.forEach(c=>{const u=jS(c);u==null||u.removeEventListener("scroll",a)})}},[a,e]),w.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,o)=>Pf(i,o),Ki):TQ(e):Ki,[e,t])}function mB(e,t){t===void 0&&(t=[]);const r=w.useRef(null);return w.useEffect(()=>{r.current=null},t),w.useEffect(()=>{const n=e!==Ki;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?cx(e,r.current):Ki}function qGe(e){w.useEffect(()=>{if(!ZN)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function GGe(e,t){return w.useMemo(()=>e.reduce((r,n)=>{let{eventName:a,handler:i}=n;return r[a]=o=>{i(o,t)},r},{}),[e,t])}function IQ(e){return w.useMemo(()=>e?vGe(e):null,[e])}const vB=[];function HGe(e,t){t===void 0&&(t=wm);const[r]=e,n=IQ(r?hs(r):null),[a,i]=w.useState(vB);function o(){i(()=>e.length?e.map(c=>AQ(c)?n:new RI(t(c),c)):vB)}const l=e_({callback:o});return Fo(()=>{l==null||l.disconnect(),o(),e.forEach(c=>l==null?void 0:l.observe(c))},[e]),a}function KGe(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return ry(t)?t:e}function YGe(e){let{measure:t}=e;const[r,n]=w.useState(null),a=w.useCallback(u=>{for(const{target:d}of u)if(ry(d)){n(h=>{const f=t(d);return h?{...h,width:f.width,height:f.height}:f});break}},[t]),i=e_({callback:a}),o=w.useCallback(u=>{const d=KGe(u);i==null||i.disconnect(),d&&(i==null||i.observe(d)),n(d?t(d):null)},[t,i]),[l,c]=N1(o);return w.useMemo(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}const XGe=[{sensor:iy,options:{}},{sensor:sy,options:{}}],QGe={current:{}},Jb={draggable:{measure:lB},droppable:{measure:lB,strategy:ux.WhileDragging,frequency:NA.Optimized},dragOverlay:{measure:wm}};class Lv extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const ZGe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Lv,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:_1},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Jb,measureDroppableContainers:_1,windowRect:null,measuringScheduled:!1},JGe={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:_1,draggableNodes:new Map,over:null,measureDroppableContainers:_1},t_=w.createContext(JGe),DQ=w.createContext(ZGe);function eHe(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Lv}}}function tHe(e,t){switch(t.type){case Sn.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Sn.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Sn.DragEnd:case Sn.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Sn.RegisterDroppable:{const{element:r}=t,{id:n}=r,a=new Lv(e.droppable.containers);return a.set(n,r),{...e,droppable:{...e.droppable,containers:a}}}case Sn.SetDroppableDisabled:{const{id:r,key:n,disabled:a}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;const o=new Lv(e.droppable.containers);return o.set(r,{...i,disabled:a}),{...e,droppable:{...e.droppable,containers:o}}}case Sn.UnregisterDroppable:{const{id:r,key:n}=t,a=e.droppable.containers.get(r);if(!a||n!==a.key)return e;const i=new Lv(e.droppable.containers);return i.delete(r),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function rHe(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:a}=w.useContext(t_),i=yA(n),o=yA(r==null?void 0:r.id);return w.useEffect(()=>{if(!t&&!n&&i&&o!=null){if(!AI(i)||document.activeElement===i.target)return;const l=a.get(o);if(!l)return;const{activatorNode:c,node:u}=l;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[c.current,u.current]){if(!d)continue;const h=Xqe(d);if(h){h.focus();break}}})}},[n,t,a,o,i]),null}function nHe(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((a,i)=>i({transform:a,...n}),r):r}function aHe(e){return w.useMemo(()=>({draggable:{...Jb.draggable,...e==null?void 0:e.draggable},droppable:{...Jb.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Jb.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function sHe(e){let{activeNode:t,measure:r,initialRect:n,config:a=!0}=e;const i=w.useRef(!1),{x:o,y:l}=typeof a=="boolean"?{x:a,y:a}:a;Fo(()=>{if(!o&&!l||!t){i.current=!1;return}if(i.current||!n)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const d=r(u),h=SQ(d,n);if(o||(h.x=0),l||(h.y=0),i.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const f=CQ(u);f&&f.scrollBy({top:h.y,left:h.x})}},[t,o,l,n,r])}const MQ=w.createContext({...Ki,scaleX:1,scaleY:1});var sc;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(sc||(sc={}));const II=w.memo(function(t){var r,n,a,i;let{id:o,accessibility:l,autoScroll:c=!0,children:u,sensors:d=XGe,collisionDetection:h=cGe,measuring:f,modifiers:p,...m}=t;const v=w.useReducer(tHe,void 0,eHe),[g,x]=v,[y,b]=rGe(),[N,j]=w.useState(sc.Uninitialized),_=N===sc.Initialized,{draggable:{active:S,nodes:C,translate:E},droppable:{containers:k}}=g,P=S!=null?C.get(S):null,A=w.useRef({initial:null,translated:null}),O=w.useMemo(()=>{var sn;return S!=null?{id:S,data:(sn=P==null?void 0:P.data)!=null?sn:QGe,rect:A}:null},[S,P]),I=w.useRef(null),[R,M]=w.useState(null),[B,$]=w.useState(null),D=lx(m,Object.values(m)),W=ay("DndDescribedBy",o),Z=w.useMemo(()=>k.getEnabled(),[k]),U=aHe(f),{droppableRects:Y,measureDroppableContainers:ae,measuringScheduled:ie}=FGe(Z,{dragging:_,dependencies:[E.x,E.y],config:U.droppable}),he=MGe(C,S),se=w.useMemo(()=>B?bA(B):null,[B]),ye=g_(),ne=LGe(he,U.draggable.measure);sHe({activeNode:S!=null?C.get(S):null,config:ye.layoutShiftCompensation,initialRect:ne,measure:U.draggable.measure});const le=fB(he,U.draggable.measure,ne),ve=fB(he?he.parentElement:null),K=w.useRef({activatorEvent:null,active:null,activeNode:he,collisionRect:null,collisions:null,droppableRects:Y,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:k,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ke=k.getNodeFor((r=K.current.over)==null?void 0:r.id),Ce=YGe({measure:U.dragOverlay.measure}),Ge=(n=Ce.nodeRef.current)!=null?n:he,He=_?(a=Ce.rect)!=null?a:le:null,It=!!(Ce.nodeRef.current&&Ce.rect),ar=VGe(It?null:le),Kt=IQ(Ge?hs(Ge):null),G=zGe(_?ke??he:null),te=HGe(G),ce=nHe(p,{transform:{x:E.x-ar.x,y:E.y-ar.y,scaleX:1,scaleY:1},activatorEvent:B,active:O,activeNodeRect:le,containerNodeRect:ve,draggingNodeRect:He,over:K.current.over,overlayNodeRect:Ce.rect,scrollableAncestors:G,scrollableAncestorRects:te,windowRect:Kt}),_e=se?Pf(se,E):null,Ae=WGe(G),je=mB(Ae),Le=mB(Ae,[le]),it=Pf(ce,je),ft=He?hGe(He,ce):null,kr=O&&ft?h({active:O,collisionRect:ft,droppableRects:Y,droppableContainers:Z,pointerCoordinates:_e}):null,Ha=_Q(kr,"id"),[Qr,Ho]=w.useState(null),ps=It?ce:Pf(ce,Le),la=uGe(ps,(i=Qr==null?void 0:Qr.rect)!=null?i:null,le),Ls=w.useRef(null),Bs=w.useCallback((sn,Br)=>{let{sensor:Pa,options:st}=Br;if(I.current==null)return;const wt=C.get(I.current);if(!wt)return;const Dt=sn.nativeEvent,Ur=new Pa({active:I.current,activeNode:wt,event:Dt,options:st,context:K,onAbort(pr){if(!C.get(pr))return;const{onDragAbort:Vr}=D.current,Bn={id:pr};Vr==null||Vr(Bn),y({type:"onDragAbort",event:Bn})},onPending(pr,ca,Vr,Bn){if(!C.get(pr))return;const{onDragPending:Sm}=D.current,ql={id:pr,constraint:ca,initialCoordinates:Vr,offset:Bn};Sm==null||Sm(ql),y({type:"onDragPending",event:ql})},onStart(pr){const ca=I.current;if(ca==null)return;const Vr=C.get(ca);if(!Vr)return;const{onDragStart:Bn}=D.current,_m={activatorEvent:Dt,active:{id:ca,data:Vr.data,rect:A}};ei.unstable_batchedUpdates(()=>{Bn==null||Bn(_m),j(sc.Initializing),x({type:Sn.DragStart,initialCoordinates:pr,active:ca}),y({type:"onDragStart",event:_m}),M(Ls.current),$(Dt)})},onMove(pr){x({type:Sn.DragMove,coordinates:pr})},onEnd:Ln(Sn.DragEnd),onCancel:Ln(Sn.DragCancel)});Ls.current=Ur;function Ln(pr){return async function(){const{active:Vr,collisions:Bn,over:_m,scrollAdjustedTranslate:Sm}=K.current;let ql=null;if(Vr&&Sm){const{cancelDrop:Cm}=D.current;ql={activatorEvent:Dt,active:Vr,collisions:Bn,delta:Sm,over:_m},pr===Sn.DragEnd&&typeof Cm=="function"&&await Promise.resolve(Cm(ql))&&(pr=Sn.DragCancel)}I.current=null,ei.unstable_batchedUpdates(()=>{x({type:pr}),j(sc.Uninitialized),Ho(null),M(null),$(null),Ls.current=null;const Cm=pr===Sn.DragEnd?"onDragEnd":"onDragCancel";if(ql){const x_=D.current[Cm];x_==null||x_(ql),y({type:Cm,event:ql})}})}}},[C]),Nm=w.useCallback((sn,Br)=>(Pa,st)=>{const wt=Pa.nativeEvent,Dt=C.get(st);if(I.current!==null||!Dt||wt.dndKit||wt.defaultPrevented)return;const Ur={active:Dt};sn(Pa,Br.options,Ur)===!0&&(wt.dndKit={capturedBy:Br.sensor},I.current=st,Bs(Pa,Br))},[C,Bs]),Cu=$Ge(d,Nm);qGe(d),Fo(()=>{le&&N===sc.Initializing&&j(sc.Initialized)},[le,N]),w.useEffect(()=>{const{onDragMove:sn}=D.current,{active:Br,activatorEvent:Pa,collisions:st,over:wt}=K.current;if(!Br||!Pa)return;const Dt={active:Br,activatorEvent:Pa,collisions:st,delta:{x:it.x,y:it.y},over:wt};ei.unstable_batchedUpdates(()=>{sn==null||sn(Dt),y({type:"onDragMove",event:Dt})})},[it.x,it.y]),w.useEffect(()=>{const{active:sn,activatorEvent:Br,collisions:Pa,droppableContainers:st,scrollAdjustedTranslate:wt}=K.current;if(!sn||I.current==null||!Br||!wt)return;const{onDragOver:Dt}=D.current,Ur=st.get(Ha),Ln=Ur&&Ur.rect.current?{id:Ur.id,rect:Ur.rect.current,data:Ur.data,disabled:Ur.disabled}:null,pr={active:sn,activatorEvent:Br,collisions:Pa,delta:{x:wt.x,y:wt.y},over:Ln};ei.unstable_batchedUpdates(()=>{Ho(Ln),Dt==null||Dt(pr),y({type:"onDragOver",event:pr})})},[Ha]),Fo(()=>{K.current={activatorEvent:B,active:O,activeNode:he,collisionRect:ft,collisions:kr,droppableRects:Y,draggableNodes:C,draggingNode:Ge,draggingNodeRect:He,droppableContainers:k,over:Qr,scrollableAncestors:G,scrollAdjustedTranslate:it},A.current={initial:He,translated:ft}},[O,he,kr,ft,C,Ge,He,Y,k,Qr,G,it]),OGe({...ye,delta:E,draggingRect:ft,pointerCoordinates:_e,scrollableAncestors:G,scrollableAncestorRects:te});const hy=w.useMemo(()=>({active:O,activeNode:he,activeNodeRect:le,activatorEvent:B,collisions:kr,containerNodeRect:ve,dragOverlay:Ce,draggableNodes:C,droppableContainers:k,droppableRects:Y,over:Qr,measureDroppableContainers:ae,scrollableAncestors:G,scrollableAncestorRects:te,measuringConfiguration:U,measuringScheduled:ie,windowRect:Kt}),[O,he,le,B,kr,ve,Ce,C,k,Y,Qr,ae,G,te,U,ie,Kt]),fy=w.useMemo(()=>({activatorEvent:B,activators:Cu,active:O,activeNodeRect:le,ariaDescribedById:{draggable:W},dispatch:x,draggableNodes:C,over:Qr,measureDroppableContainers:ae}),[B,Cu,O,le,x,W,C,Qr,ae]);return F.createElement(wQ.Provider,{value:b},F.createElement(t_.Provider,{value:fy},F.createElement(DQ.Provider,{value:hy},F.createElement(MQ.Provider,{value:la},u)),F.createElement(rHe,{disabled:(l==null?void 0:l.restoreFocus)===!1})),F.createElement(sGe,{...l,hiddenTextDescribedById:W}));function g_(){const sn=(R==null?void 0:R.autoScrollEnabled)===!1,Br=typeof c=="object"?c.enabled===!1:c===!1,Pa=_&&!sn&&!Br;return typeof c=="object"?{...c,enabled:Pa}:{enabled:Pa}}}),iHe=w.createContext(null),gB="button",oHe="Draggable";function lHe(e){let{id:t,data:r,disabled:n=!1,attributes:a}=e;const i=ay(oHe),{activators:o,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:h,over:f}=w.useContext(t_),{role:p=gB,roleDescription:m="draggable",tabIndex:v=0}=a??{},g=(c==null?void 0:c.id)===t,x=w.useContext(g?MQ:iHe),[y,b]=N1(),[N,j]=N1(),_=GGe(o,t),S=lx(r);Fo(()=>(h.set(t,{id:t,key:i,node:y,activatorNode:N,data:S}),()=>{const E=h.get(t);E&&E.key===i&&h.delete(t)}),[h,t]);const C=w.useMemo(()=>({role:p,tabIndex:v,"aria-disabled":n,"aria-pressed":g&&p===gB?!0:void 0,"aria-roledescription":m,"aria-describedby":d.draggable}),[n,p,v,g,m,d.draggable]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:C,isDragging:g,listeners:n?void 0:_,node:y,over:f,setNodeRef:b,setActivatorNodeRef:j,transform:x}}function cHe(){return w.useContext(DQ)}const uHe="Droppable",dHe={timeout:25};function hHe(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:a}=e;const i=ay(uHe),{active:o,dispatch:l,over:c,measureDroppableContainers:u}=w.useContext(t_),d=w.useRef({disabled:r}),h=w.useRef(!1),f=w.useRef(null),p=w.useRef(null),{disabled:m,updateMeasurementsFor:v,timeout:g}={...dHe,...a},x=lx(v??n),y=w.useCallback(()=>{if(!h.current){h.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{u(Array.isArray(x.current)?x.current:[x.current]),p.current=null},g)},[g]),b=e_({callback:y,disabled:m||!o}),N=w.useCallback((C,E)=>{b&&(E&&(b.unobserve(E),h.current=!1),C&&b.observe(C))},[b]),[j,_]=N1(N),S=lx(t);return w.useEffect(()=>{!b||!j.current||(b.disconnect(),h.current=!1,b.observe(j.current))},[j,b]),w.useEffect(()=>(l({type:Sn.RegisterDroppable,element:{id:n,key:i,disabled:r,node:j,rect:f,data:S}}),()=>l({type:Sn.UnregisterDroppable,key:i,id:n})),[n]),w.useEffect(()=>{r!==d.current.disabled&&(l({type:Sn.SetDroppableDisabled,id:n,key:i,disabled:r}),d.current.disabled=r)},[n,i,r,l]),{active:o,rect:f,isOver:(c==null?void 0:c.id)===n,node:j,over:c,setNodeRef:_}}function oy(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function fHe(e,t){return e.reduce((r,n,a)=>{const i=t.get(n);return i&&(r[a]=i),r},Array(e.length))}function Cb(e){return e!==null&&e>=0}function pHe(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function mHe(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const DI=e=>{let{rects:t,activeIndex:r,overIndex:n,index:a}=e;const i=oy(t,n,r),o=t[a],l=i[a];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},Eb={scaleX:1,scaleY:1},$Q=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:a,rects:i,overIndex:o}=e;const l=(t=i[r])!=null?t:n;if(!l)return null;if(a===r){const u=i[o];return u?{x:0,y:r<o?u.top+u.height-(l.top+l.height):u.top-l.top,...Eb}:null}const c=vHe(i,a,r);return a>r&&a<=o?{x:0,y:-l.height-c,...Eb}:a<r&&a>=o?{x:0,y:l.height+c,...Eb}:{x:0,y:0,...Eb}};function vHe(e,t,r){const n=e[t],a=e[t-1],i=e[t+1];return n?r<t?a?n.top-(a.top+a.height):i?i.top-(n.top+n.height):0:i?i.top-(n.top+n.height):a?n.top-(a.top+a.height):0:0}const FQ="Sortable",LQ=F.createContext({activeIndex:-1,containerId:FQ,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:DI,disabled:{draggable:!1,droppable:!1}});function MI(e){let{children:t,id:r,items:n,strategy:a=DI,disabled:i=!1}=e;const{active:o,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:d}=cHe(),h=ay(FQ,r),f=l.rect!==null,p=w.useMemo(()=>n.map(_=>typeof _=="object"&&"id"in _?_.id:_),[n]),m=o!=null,v=o?p.indexOf(o.id):-1,g=u?p.indexOf(u.id):-1,x=w.useRef(p),y=!pHe(p,x.current),b=g!==-1&&v===-1||y,N=mHe(i);Fo(()=>{y&&m&&d(p)},[y,p,m,d]),w.useEffect(()=>{x.current=p},[p]);const j=w.useMemo(()=>({activeIndex:v,containerId:h,disabled:N,disableTransforms:b,items:p,overIndex:g,useDragOverlay:f,sortedRects:fHe(p,c),strategy:a}),[v,h,N.draggable,N.droppable,b,p,g,c,f,a]);return F.createElement(LQ.Provider,{value:j},t)}const gHe=e=>{let{id:t,items:r,activeIndex:n,overIndex:a}=e;return oy(r,n,a).indexOf(t)},xHe=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:a,items:i,newIndex:o,previousItems:l,previousContainerId:c,transition:u}=e;return!u||!n||l!==i&&a===o?!1:r?!0:o!==a&&t===c},yHe={duration:200,easing:"ease"},BQ="transform",bHe=Vd.Transition.toString({property:BQ,duration:0,easing:"linear"}),wHe={roleDescription:"sortable"};function jHe(e){let{disabled:t,index:r,node:n,rect:a}=e;const[i,o]=w.useState(null),l=w.useRef(r);return Fo(()=>{if(!t&&r!==l.current&&n.current){const c=a.current;if(c){const u=wm(n.current,{ignoreTransform:!0}),d={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(d.x||d.y)&&o(d)}}r!==l.current&&(l.current=r)},[t,r,n,a]),w.useEffect(()=>{i&&o(null)},[i]),i}function $I(e){let{animateLayoutChanges:t=xHe,attributes:r,disabled:n,data:a,getNewIndex:i=gHe,id:o,strategy:l,resizeObserverConfig:c,transition:u=yHe}=e;const{items:d,containerId:h,activeIndex:f,disabled:p,disableTransforms:m,sortedRects:v,overIndex:g,useDragOverlay:x,strategy:y}=w.useContext(LQ),b=NHe(n,p),N=d.indexOf(o),j=w.useMemo(()=>({sortable:{containerId:h,index:N,items:d},...a}),[h,a,N,d]),_=w.useMemo(()=>d.slice(d.indexOf(o)),[d,o]),{rect:S,node:C,isOver:E,setNodeRef:k}=hHe({id:o,data:j,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:_,...c}}),{active:P,activatorEvent:A,activeNodeRect:O,attributes:I,setNodeRef:R,listeners:M,isDragging:B,over:$,setActivatorNodeRef:D,transform:W}=lHe({id:o,data:j,attributes:{...wHe,...r},disabled:b.draggable}),Z=Gqe(k,R),U=!!P,Y=U&&!m&&Cb(f)&&Cb(g),ae=!x&&B,ie=ae&&Y?W:null,se=Y?ie??(l??y)({rects:v,activeNodeRect:O,activeIndex:f,overIndex:g,index:N}):null,ye=Cb(f)&&Cb(g)?i({id:o,items:d,activeIndex:f,overIndex:g}):N,ne=P==null?void 0:P.id,le=w.useRef({activeId:ne,items:d,newIndex:ye,containerId:h}),ve=d!==le.current.items,K=t({active:P,containerId:h,isDragging:B,isSorting:U,id:o,index:N,items:d,newIndex:le.current.newIndex,previousItems:le.current.items,previousContainerId:le.current.containerId,transition:u,wasDragging:le.current.activeId!=null}),ke=jHe({disabled:!K,index:N,node:C,rect:S});return w.useEffect(()=>{U&&le.current.newIndex!==ye&&(le.current.newIndex=ye),h!==le.current.containerId&&(le.current.containerId=h),d!==le.current.items&&(le.current.items=d)},[U,ye,h,d]),w.useEffect(()=>{if(ne===le.current.activeId)return;if(ne!=null&&le.current.activeId==null){le.current.activeId=ne;return}const Ge=setTimeout(()=>{le.current.activeId=ne},50);return()=>clearTimeout(Ge)},[ne]),{active:P,activeIndex:f,attributes:I,data:j,rect:S,index:N,newIndex:ye,items:d,isOver:E,isSorting:U,isDragging:B,listeners:M,node:C,overIndex:g,over:$,setNodeRef:Z,setActivatorNodeRef:D,setDroppableNodeRef:k,setDraggableNodeRef:R,transform:ke??se,transition:Ce()};function Ce(){if(ke||ve&&le.current.newIndex===N)return bHe;if(!(ae&&!AI(A)||!u)&&(U||K))return Vd.Transition.toString({...u,property:BQ})}}function NHe(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}function C1(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const _He=[Gt.Down,Gt.Right,Gt.Up,Gt.Left],FI=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:a,droppableContainers:i,over:o,scrollableAncestors:l}}=t;if(_He.includes(e.code)){if(e.preventDefault(),!r||!n)return;const c=[];i.getEnabled().forEach(h=>{if(!h||h!=null&&h.disabled)return;const f=a.get(h.id);if(f)switch(e.code){case Gt.Down:n.top<f.top&&c.push(h);break;case Gt.Up:n.top>f.top&&c.push(h);break;case Gt.Left:n.left>f.left&&c.push(h);break;case Gt.Right:n.left<f.left&&c.push(h);break}});const u=oGe({active:r,collisionRect:n,droppableRects:a,droppableContainers:c,pointerCoordinates:null});let d=_Q(u,"id");if(d===(o==null?void 0:o.id)&&u.length>1&&(d=u[1].id),d!=null){const h=i.get(r.id),f=i.get(d),p=f?a.get(f.id):null,m=f==null?void 0:f.node.current;if(m&&p&&h&&f){const g=JN(m).some((_,S)=>l[S]!==_),x=UQ(h,f),y=SHe(h,f),b=g||!x?{x:0,y:0}:{x:y?n.width-p.width:0,y:y?n.height-p.height:0},N={x:p.left,y:p.top};return b.x&&b.y?N:cx(N,b)}}}};function UQ(e,t){return!C1(e)||!C1(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function SHe(e,t){return!C1(e)||!C1(t)||!UQ(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}function CHe({method:e,onRemove:t}){const{attributes:r,listeners:n,setNodeRef:a,transform:i,transition:o}=$I({id:e.id}),l={transform:Vd.Transform.toString(i),transition:o};return s.jsx(q,{ref:a,style:l,className:"mb-2",children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{...r,...n,className:"cursor-grab active:cursor-grabbing",children:s.jsx(dT,{className:"w-5 h-5 text-muted-foreground"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium",children:e.payment_app.app_name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["#",e.preference_order]})]}),s.jsx(L,{variant:"ghost",size:"sm",onClick:t,children:"Remove"})]})})})}function EHe(){const e=Oe(),{toast:t}=Et(),[r,n]=w.useState([]),[a,i]=w.useState([]),[o,l]=w.useState(""),[c,u]=w.useState(null),[d,h]=w.useState(""),[f,p]=w.useState(""),[m,v]=w.useState(!1),g=PI(kp(iy),kp(sy,{coordinateGetter:FI}));w.useEffect(()=>{x(),y()},[]);const x=async()=>{const{data:S}=await T.from("payment_apps").select("*").eq("is_active",!0).order("app_name");S&&n(S)},y=async()=>{const{data:{user:S}}=await T.auth.getUser();if(!S)return;const{data:C}=await T.from("user_payment_methods").select(`
        *,
        payment_app:payment_apps(*)
      `).eq("user_id",S.id).eq("is_active",!0).order("preference_order");C&&i(C)},b=async()=>{if(!o){t({title:"Please select a payment app",variant:"destructive"});return}v(!0);try{const{data:{user:S}}=await T.auth.getUser();if(!S)throw new Error("Not authenticated");let C=null;if(c){const P=c.name.split(".").pop(),A=`${S.id}/${o}_${Date.now()}.${P}`,{error:O}=await T.storage.from("payment_qr_codes").upload(A,c);if(O)throw O;const{data:{publicUrl:I}}=T.storage.from("payment_qr_codes").getPublicUrl(A);C=I}const E=Math.max(...a.map(P=>P.preference_order),0),{error:k}=await T.from("user_payment_methods").insert({user_id:S.id,payment_app_id:o,preference_order:E+1,qr_code_image_url:C,username_handle:d||null,wallet_address:f||null});if(k)throw k;t({title:"Payment method added successfully"}),y(),l(""),u(null),h(""),p("")}catch(S){console.error("Error adding payment method:",S),t({title:"Error adding method",variant:"destructive"})}finally{v(!1)}},N=async S=>{const{active:C,over:E}=S;if(!E||C.id===E.id)return;const k=a.findIndex(I=>I.id===C.id),P=a.findIndex(I=>I.id===E.id),A=oy(a,k,P).map((I,R)=>({...I,preference_order:R+1}));i(A);const{data:{user:O}}=await T.auth.getUser();O&&(await Promise.all(A.map(I=>T.from("user_payment_methods").update({preference_order:I.preference_order}).eq("id",I.id))),t({title:"Preference order updated"}))},j=async S=>{await T.from("user_payment_methods").delete().eq("id",S),t({title:"Payment method removed"}),y()},_=r.find(S=>S.id===o);return s.jsxs("div",{className:"min-h-screen bg-background p-4",children:[s.jsxs("header",{className:"flex items-center gap-4 mb-6",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e(-1),children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("h1",{className:"text-2xl font-bold",children:"Vairipay Setup"})]}),s.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[s.jsx(q,{children:s.jsxs(ee,{className:"p-6 space-y-4",children:[s.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(Ms,{className:"w-5 h-5"}),"Add Payment Method"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{children:"Select App/Wallet"}),s.jsxs("select",{className:"w-full p-2 border rounded-md",value:o,onChange:S=>l(S.target.value),children:[s.jsx("option",{value:"",children:"Choose..."}),s.jsx("optgroup",{label:"P2P Apps",children:r.filter(S=>S.app_category==="p2p").map(S=>s.jsx("option",{value:S.id,children:S.app_name},S.id))}),s.jsx("optgroup",{label:"Crypto Wallets",children:r.filter(S=>S.app_category==="crypto_wallet").map(S=>s.jsx("option",{value:S.id,children:S.app_name},S.id))}),s.jsx("optgroup",{label:"Banks",children:r.filter(S=>S.app_category==="bank").map(S=>s.jsx("option",{value:S.id,children:S.app_name},S.id))})]})]}),_&&_.app_category==="crypto_wallet"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{children:"Wallet Address"}),s.jsx(De,{placeholder:"0x...",value:f,onChange:S=>p(S.target.value)})]}),_&&_.app_category!=="crypto_wallet"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{children:"Username/Handle (optional)"}),s.jsx(De,{placeholder:"@username",value:d,onChange:S=>h(S.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{children:"Upload QR Code (optional)"}),s.jsx(De,{type:"file",accept:"image/*",onChange:S=>{var C;return u(((C=S.target.files)==null?void 0:C[0])||null)}})]})]}),s.jsx(L,{onClick:b,disabled:m,className:"w-full",children:m?"Adding...":"Add Method"})]})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Your Payment Methods (Drag to reorder preference)"}),a.length===0?s.jsx(q,{children:s.jsx(ee,{className:"p-6 text-center text-muted-foreground",children:"No payment methods added yet"})}):s.jsx(II,{sensors:g,collisionDetection:TI,onDragEnd:N,children:s.jsx(MI,{items:a.map(S=>S.id),strategy:$Q,children:a.map(S=>s.jsx(CHe,{method:S,onRemove:()=>j(S.id)},S.id))})})]}),s.jsx(q,{children:s.jsxs(ee,{className:"p-6",children:[s.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Don't have an app? Download it:"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.slice(0,10).map(S=>s.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[s.jsx("span",{className:"text-sm",children:S.app_name}),s.jsxs("div",{className:"flex gap-2",children:[S.download_url_ios&&s.jsx("a",{href:S.download_url_ios,target:"_blank",rel:"noopener noreferrer",children:s.jsxs(L,{size:"sm",variant:"outline",children:[s.jsx(ig,{className:"w-3 h-3 mr-1"}),"iOS"]})}),S.download_url_android&&s.jsx("a",{href:S.download_url_android,target:"_blank",rel:"noopener noreferrer",children:s.jsxs(L,{size:"sm",variant:"outline",children:[s.jsx(ig,{className:"w-3 h-3 mr-1"}),"Android"]})})]})]},S.id))})]})})]})]})}function kHe(){const e=Oe();return s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-6 p-4 max-w-md",children:[s.jsx(Qd,{className:"w-24 h-24 text-red-400 mx-auto"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h1",{className:"text-2xl font-bold",children:" MEETING DECLINED"}),s.jsx("p",{className:"text-white/80",children:"The meeting has been declined"})]}),s.jsxs("div",{className:"bg-white/5 rounded-lg p-6 space-y-2 text-sm text-left",children:[s.jsx("p",{children:" No encounter will be created"}),s.jsx("p",{children:" Neither party is notified of who declined"}),s.jsx("p",{children:" Your privacy is protected"})]}),s.jsx(L,{onClick:()=>e("/feed"),className:"w-full h-14 text-lg bg-white/10 hover:bg-white/20 text-white",children:"Done"})]})})}function _A(e,[t,r]){return Math.min(r,Math.max(t,e))}function AHe(e,t){return w.useReducer((r,n)=>t[r][n]??r,e)}var LI="ScrollArea",[VQ,bQe]=an(LI),[PHe,pi]=VQ(LI),zQ=w.forwardRef((e,t)=>{const{__scopeScrollArea:r,type:n="hover",dir:a,scrollHideDelay:i=600,...o}=e,[l,c]=w.useState(null),[u,d]=w.useState(null),[h,f]=w.useState(null),[p,m]=w.useState(null),[v,g]=w.useState(null),[x,y]=w.useState(0),[b,N]=w.useState(0),[j,_]=w.useState(!1),[S,C]=w.useState(!1),E=ct(t,P=>c(P)),k=ah(a);return s.jsx(PHe,{scope:r,type:n,dir:k,scrollHideDelay:i,scrollArea:l,viewport:u,onViewportChange:d,content:h,onContentChange:f,scrollbarX:p,onScrollbarXChange:m,scrollbarXEnabled:j,onScrollbarXEnabledChange:_,scrollbarY:v,onScrollbarYChange:g,scrollbarYEnabled:S,onScrollbarYEnabledChange:C,onCornerWidthChange:y,onCornerHeightChange:N,children:s.jsx(Me.div,{dir:k,...o,ref:E,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":b+"px",...e.style}})})});zQ.displayName=LI;var WQ="ScrollAreaViewport",qQ=w.forwardRef((e,t)=>{const{__scopeScrollArea:r,children:n,nonce:a,...i}=e,o=pi(WQ,r),l=w.useRef(null),c=ct(t,l,o.onViewportChange);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),s.jsx(Me.div,{"data-radix-scroll-area-viewport":"",...i,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...e.style},children:s.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});qQ.displayName=WQ;var Go="ScrollAreaScrollbar",BI=w.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=pi(Go,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=a,l=e.orientation==="horizontal";return w.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),a.type==="hover"?s.jsx(THe,{...n,ref:t,forceMount:r}):a.type==="scroll"?s.jsx(RHe,{...n,ref:t,forceMount:r}):a.type==="auto"?s.jsx(GQ,{...n,ref:t,forceMount:r}):a.type==="always"?s.jsx(UI,{...n,ref:t}):null});BI.displayName=Go;var THe=w.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=pi(Go,e.__scopeScrollArea),[i,o]=w.useState(!1);return w.useEffect(()=>{const l=a.scrollArea;let c=0;if(l){const u=()=>{window.clearTimeout(c),o(!0)},d=()=>{c=window.setTimeout(()=>o(!1),a.scrollHideDelay)};return l.addEventListener("pointerenter",u),l.addEventListener("pointerleave",d),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",u),l.removeEventListener("pointerleave",d)}}},[a.scrollArea,a.scrollHideDelay]),s.jsx(gn,{present:r||i,children:s.jsx(GQ,{"data-state":i?"visible":"hidden",...n,ref:t})})}),RHe=w.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=pi(Go,e.__scopeScrollArea),i=e.orientation==="horizontal",o=n_(()=>c("SCROLL_END"),100),[l,c]=AHe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return w.useEffect(()=>{if(l==="idle"){const u=window.setTimeout(()=>c("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(u)}},[l,a.scrollHideDelay,c]),w.useEffect(()=>{const u=a.viewport,d=i?"scrollLeft":"scrollTop";if(u){let h=u[d];const f=()=>{const p=u[d];h!==p&&(c("SCROLL"),o()),h=p};return u.addEventListener("scroll",f),()=>u.removeEventListener("scroll",f)}},[a.viewport,i,c,o]),s.jsx(gn,{present:r||l!=="hidden",children:s.jsx(UI,{"data-state":l==="hidden"?"hidden":"visible",...n,ref:t,onPointerEnter:Ne(e.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:Ne(e.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),GQ=w.forwardRef((e,t)=>{const r=pi(Go,e.__scopeScrollArea),{forceMount:n,...a}=e,[i,o]=w.useState(!1),l=e.orientation==="horizontal",c=n_(()=>{if(r.viewport){const u=r.viewport.offsetWidth<r.viewport.scrollWidth,d=r.viewport.offsetHeight<r.viewport.scrollHeight;o(l?u:d)}},10);return Ap(r.viewport,c),Ap(r.content,c),s.jsx(gn,{present:n||i,children:s.jsx(UI,{"data-state":i?"visible":"hidden",...a,ref:t})})}),UI=w.forwardRef((e,t)=>{const{orientation:r="vertical",...n}=e,a=pi(Go,e.__scopeScrollArea),i=w.useRef(null),o=w.useRef(0),[l,c]=w.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=QQ(l.viewport,l.content),d={...n,sizes:l,onSizesChange:c,hasThumb:u>0&&u<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:f=>o.current=f};function h(f,p){return FHe(f,o.current,l,p)}return r==="horizontal"?s.jsx(OHe,{...d,ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const f=a.viewport.scrollLeft,p=xB(f,l,a.dir);i.current.style.transform=`translate3d(${p}px, 0, 0)`}},onWheelScroll:f=>{a.viewport&&(a.viewport.scrollLeft=f)},onDragScroll:f=>{a.viewport&&(a.viewport.scrollLeft=h(f,a.dir))}}):r==="vertical"?s.jsx(IHe,{...d,ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const f=a.viewport.scrollTop,p=xB(f,l);i.current.style.transform=`translate3d(0, ${p}px, 0)`}},onWheelScroll:f=>{a.viewport&&(a.viewport.scrollTop=f)},onDragScroll:f=>{a.viewport&&(a.viewport.scrollTop=h(f))}}):null}),OHe=w.forwardRef((e,t)=>{const{sizes:r,onSizesChange:n,...a}=e,i=pi(Go,e.__scopeScrollArea),[o,l]=w.useState(),c=w.useRef(null),u=ct(t,c,i.onScrollbarXChange);return w.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),s.jsx(KQ,{"data-orientation":"horizontal",...a,ref:u,sizes:r,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":r_(r)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.x),onDragScroll:d=>e.onDragScroll(d.x),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollLeft+d.deltaX;e.onWheelScroll(f),JQ(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&n({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:k1(o.paddingLeft),paddingEnd:k1(o.paddingRight)}})}})}),IHe=w.forwardRef((e,t)=>{const{sizes:r,onSizesChange:n,...a}=e,i=pi(Go,e.__scopeScrollArea),[o,l]=w.useState(),c=w.useRef(null),u=ct(t,c,i.onScrollbarYChange);return w.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),s.jsx(KQ,{"data-orientation":"vertical",...a,ref:u,sizes:r,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":r_(r)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.y),onDragScroll:d=>e.onDragScroll(d.y),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollTop+d.deltaY;e.onWheelScroll(f),JQ(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&n({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:k1(o.paddingTop),paddingEnd:k1(o.paddingBottom)}})}})}),[DHe,HQ]=VQ(Go),KQ=w.forwardRef((e,t)=>{const{__scopeScrollArea:r,sizes:n,hasThumb:a,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:u,onWheelScroll:d,onResize:h,...f}=e,p=pi(Go,r),[m,v]=w.useState(null),g=ct(t,E=>v(E)),x=w.useRef(null),y=w.useRef(""),b=p.viewport,N=n.content-n.viewport,j=Yr(d),_=Yr(c),S=n_(h,10);function C(E){if(x.current){const k=E.clientX-x.current.left,P=E.clientY-x.current.top;u({x:k,y:P})}}return w.useEffect(()=>{const E=k=>{const P=k.target;(m==null?void 0:m.contains(P))&&j(k,N)};return document.addEventListener("wheel",E,{passive:!1}),()=>document.removeEventListener("wheel",E,{passive:!1})},[b,m,N,j]),w.useEffect(_,[n,_]),Ap(m,S),Ap(p.content,S),s.jsx(DHe,{scope:r,scrollbar:m,hasThumb:a,onThumbChange:Yr(i),onThumbPointerUp:Yr(o),onThumbPositionChange:_,onThumbPointerDown:Yr(l),children:s.jsx(Me.div,{...f,ref:g,style:{position:"absolute",...f.style},onPointerDown:Ne(e.onPointerDown,E=>{E.button===0&&(E.target.setPointerCapture(E.pointerId),x.current=m.getBoundingClientRect(),y.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),C(E))}),onPointerMove:Ne(e.onPointerMove,C),onPointerUp:Ne(e.onPointerUp,E=>{const k=E.target;k.hasPointerCapture(E.pointerId)&&k.releasePointerCapture(E.pointerId),document.body.style.webkitUserSelect=y.current,p.viewport&&(p.viewport.style.scrollBehavior=""),x.current=null})})})}),E1="ScrollAreaThumb",YQ=w.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=HQ(E1,e.__scopeScrollArea);return s.jsx(gn,{present:r||a.hasThumb,children:s.jsx(MHe,{ref:t,...n})})}),MHe=w.forwardRef((e,t)=>{const{__scopeScrollArea:r,style:n,...a}=e,i=pi(E1,r),o=HQ(E1,r),{onThumbPositionChange:l}=o,c=ct(t,h=>o.onThumbChange(h)),u=w.useRef(void 0),d=n_(()=>{u.current&&(u.current(),u.current=void 0)},100);return w.useEffect(()=>{const h=i.viewport;if(h){const f=()=>{if(d(),!u.current){const p=LHe(h,l);u.current=p,l()}};return l(),h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[i.viewport,d,l]),s.jsx(Me.div,{"data-state":o.hasThumb?"visible":"hidden",...a,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:Ne(e.onPointerDownCapture,h=>{const p=h.target.getBoundingClientRect(),m=h.clientX-p.left,v=h.clientY-p.top;o.onThumbPointerDown({x:m,y:v})}),onPointerUp:Ne(e.onPointerUp,o.onThumbPointerUp)})});YQ.displayName=E1;var VI="ScrollAreaCorner",XQ=w.forwardRef((e,t)=>{const r=pi(VI,e.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?s.jsx($He,{...e,ref:t}):null});XQ.displayName=VI;var $He=w.forwardRef((e,t)=>{const{__scopeScrollArea:r,...n}=e,a=pi(VI,r),[i,o]=w.useState(0),[l,c]=w.useState(0),u=!!(i&&l);return Ap(a.scrollbarX,()=>{var h;const d=((h=a.scrollbarX)==null?void 0:h.offsetHeight)||0;a.onCornerHeightChange(d),c(d)}),Ap(a.scrollbarY,()=>{var h;const d=((h=a.scrollbarY)==null?void 0:h.offsetWidth)||0;a.onCornerWidthChange(d),o(d)}),u?s.jsx(Me.div,{...n,ref:t,style:{width:i,height:l,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function k1(e){return e?parseInt(e,10):0}function QQ(e,t){const r=e/t;return isNaN(r)?0:r}function r_(e){const t=QQ(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,n=(e.scrollbar.size-r)*t;return Math.max(n,18)}function FHe(e,t,r,n="ltr"){const a=r_(r),i=a/2,o=t||i,l=a-o,c=r.scrollbar.paddingStart+o,u=r.scrollbar.size-r.scrollbar.paddingEnd-l,d=r.content-r.viewport,h=n==="ltr"?[0,d]:[d*-1,0];return ZQ([c,u],h)(e)}function xB(e,t,r="ltr"){const n=r_(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-a,o=t.content-t.viewport,l=i-n,c=r==="ltr"?[0,o]:[o*-1,0],u=_A(e,c);return ZQ([0,o],[0,l])(u)}function ZQ(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function JQ(e,t){return e>0&&e<t}var LHe=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},n=0;return function a(){const i={left:e.scrollLeft,top:e.scrollTop},o=r.left!==i.left,l=r.top!==i.top;(o||l)&&t(),r=i,n=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(n)};function n_(e,t){const r=Yr(e),n=w.useRef(0);return w.useEffect(()=>()=>window.clearTimeout(n.current),[]),w.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,t)},[r,t])}function Ap(e,t){const r=Yr(t);Xr(()=>{let n=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return a.observe(e),()=>{window.cancelAnimationFrame(n),a.unobserve(e)}}},[e,r])}var eZ=zQ,BHe=qQ,UHe=XQ;const yl=w.forwardRef(({className:e,children:t,...r},n)=>s.jsxs(eZ,{ref:n,className:me("relative overflow-hidden",e),...r,children:[s.jsx(BHe,{className:"h-full w-full rounded-[inherit]",children:t}),s.jsx(tZ,{}),s.jsx(UHe,{})]}));yl.displayName=eZ.displayName;const tZ=w.forwardRef(({className:e,orientation:t="vertical",...r},n)=>s.jsx(BI,{ref:n,orientation:t,className:me("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:s.jsx(YQ,{className:"relative flex-1 rounded-full bg-border"})}));tZ.displayName=BI.displayName;function VHe(){const e=Oe(),{sessionId:t,role:r}=us(),{toast:n}=Et(),[a,i]=w.useState(!1),o="9I7T35L",l="2K8F91P",c=r==="provider"?o:l,u=r,d=async()=>{i(!0);const h=u==="provider"?"contract_signed_provider":"contract_signed_client",{error:f}=await T.from("vai_check_sessions").update({[h]:!0}).eq("id",t);if(f){n({title:"Error",description:"Failed to sign contract",variant:"destructive"}),i(!1);return}n({title:" Contract Signed",description:"Proceeding to facial verification..."}),setTimeout(()=>{e(`/vai-check/final-verification/${t}/${u}`)},1e3)};return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white p-4",children:[s.jsxs("header",{className:"mb-4 flex items-center justify-between",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e(-1),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("span",{className:"text-sm font-semibold",children:"MUTUAL CONSENT CONTRACT"}),s.jsx("div",{className:"w-10"})]}),s.jsxs("div",{className:"max-w-4xl mx-auto bg-white/5 backdrop-blur-sm rounded-2xl border border-white/10 overflow-hidden flex flex-col relative",style:{height:"calc(100vh - 200px)"},children:[s.jsx(yl,{className:"flex-1",children:s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"bg-white/5 rounded-xl p-6 border border-white/10 space-y-4",children:[s.jsxs("h2",{className:"text-xl font-bold text-center flex items-center justify-center gap-2",children:[" VAIRIFY MUTUAL CONSENT CONTRACT",s.jsx(bae,{className:"w-6 h-6 text-cyan-400"})]}),s.jsx("h3",{className:"text-lg font-semibold text-center text-cyan-400",children:"MUTUAL CONSENT ENCOUNTER AGREEMENT"}),s.jsx("p",{className:"text-white/90 leading-relaxed text-center max-w-3xl mx-auto",children:"This meeting/encounter is between two consenting adults. Any gifts, donations, or compensation exchanged are for time and companionship only, and are not payments for any specific acts. Both parties enter this agreement freely, voluntarily, and without coercion."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"font-bold text-lg text-cyan-400 flex items-center gap-2",children:[s.jsx("div",{className:"w-1 h-6 bg-cyan-400 rounded"}),"PARTIES TO THIS AGREEMENT"]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-white/5 rounded-xl p-5 border border-white/10 space-y-2",children:[s.jsx("p",{className:"font-bold text-lg text-cyan-400",children:"PROVIDER"}),s.jsxs("div",{className:"space-y-1.5 text-sm",children:[s.jsxs("p",{children:[s.jsx("span",{className:"text-white/60",children:"V.A.I. Number:"})," ",s.jsx("span",{className:"font-mono font-semibold",children:o})]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-white/60",children:"Verified Status:"}),"  Verified on Nov 6, 2025"]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-white/60",children:"V.A.I.-CHECK Enabled:"})," Yes"]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-white/60",children:"DateGuard Active:"})," Yes"]})]})]}),s.jsxs("div",{className:"bg-white/5 rounded-xl p-5 border border-white/10 space-y-2",children:[s.jsx("p",{className:"font-bold text-lg text-cyan-400",children:"CLIENT"}),s.jsxs("div",{className:"space-y-1.5 text-sm",children:[s.jsxs("p",{children:[s.jsx("span",{className:"text-white/60",children:"V.A.I. Number:"})," ",s.jsx("span",{className:"font-mono font-semibold",children:l})]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-white/60",children:"Verified Status:"}),"  Verified on Nov 6, 2025"]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-white/60",children:"V.A.I.-CHECK Enabled:"})," Yes"]})]})]})]})]}),s.jsxs("div",{className:"space-y-3 bg-white/5 rounded-xl p-6 border border-white/10",children:[s.jsx("h3",{className:"font-bold text-lg text-cyan-400",children:"1. MUTUAL CONSENT"}),s.jsx("p",{className:"text-white/80",children:"Both parties acknowledge and agree:"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," We are both 18 years of age or older"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," We are entering this agreement voluntarily and of our own free will"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," We have the legal capacity to consent to this encounter"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," No coercion, force, fraud, or deception is involved"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," Either party may withdraw consent at any time"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," We will respect each other's boundaries and stated limits"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," This is a private arrangement between two adults"]})]})]}),s.jsxs("div",{className:"space-y-3 bg-white/5 rounded-xl p-6 border border-white/10",children:[s.jsx("h3",{className:"font-bold text-lg text-cyan-400",children:"2. ENCOUNTER DETAILS"}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-x-6 gap-y-2 text-sm",children:[s.jsxs("p",{children:[s.jsx("span",{className:"text-white/60",children:"Date:"})," ",s.jsx("span",{className:"font-semibold",children:"November 6, 2025"})]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-white/60",children:"Time:"})," ",s.jsx("span",{className:"font-semibold",children:"8:00 PM"})]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-white/60",children:"Duration:"})," ",s.jsx("span",{className:"font-semibold",children:"2 hours"})]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-white/60",children:"Location:"})," ",s.jsx("span",{className:"font-semibold",children:"Miami, FL"})]})]}),s.jsxs("div",{className:"pt-3 space-y-2 text-sm",children:[s.jsx("p",{className:"text-white/80 font-semibold",children:"Meeting Type:"}),s.jsx("p",{children:" Social companionship"}),s.jsx("p",{children:" Dinner/event attendance"}),s.jsx("p",{children:" Private time"}),s.jsx("p",{children:" Other: _______________"})]})]}),s.jsxs("div",{className:"space-y-3 bg-white/5 rounded-xl p-6 border border-white/10",children:[s.jsx("h3",{className:"font-bold text-lg text-cyan-400",children:"3. COMPENSATION & GIFTS"}),s.jsx("p",{className:"text-white/80 text-sm",children:"Any monetary exchange is voluntary and represents:"}),s.jsxs("ul",{className:"space-y-1.5 text-sm list-disc list-inside marker:text-cyan-400",children:[s.jsx("li",{children:"Compensation for time and companionship only"}),s.jsx("li",{children:"A gift freely given between adults"}),s.jsx("li",{children:"NOT payment for any illegal activity"}),s.jsx("li",{children:"NOT contingent on any specific acts"})]}),s.jsxs("p",{className:"text-sm pt-2",children:[s.jsx("span",{className:"text-white/60",children:"Agreed Amount (if applicable):"})," $_______  ",s.jsx("span",{className:"text-white/40 text-xs",children:"[Optional field]"})]}),s.jsx("p",{className:"text-sm text-white/70 pt-2 leading-relaxed",children:"Both parties acknowledge this is a time-based arrangement, and any gifts or compensation are for the Provider's time, regardless of activities that may or may not occur during the encounter."})]}),s.jsxs("div",{className:"space-y-3 bg-white/5 rounded-xl p-6 border border-white/10",children:[s.jsx("h3",{className:"font-bold text-lg text-cyan-400",children:"4. HEALTH & SAFETY"}),s.jsx("p",{className:"text-white/80 text-sm",children:"Both parties represent:"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," We are not aware of any communicable diseases we are required to disclose"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," We will practice appropriate health and safety measures"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," We are responsible for our own health decisions"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," We release the other party from health-related liability (except intentional harm)"]})]}),s.jsxs("div",{className:"pt-3 space-y-2 text-sm bg-cyan-400/10 rounded-lg p-4 border border-cyan-400/20",children:[s.jsx("p",{className:"font-semibold text-cyan-400",children:"If DateGuard is active:"}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," Provider has designated a Guardian who will monitor this encounter"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," Client acknowledges Guardian has Provider's location and check-in times"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," Client consents to Guardian contact if Provider does not check in"]})]})]}),s.jsxs("div",{className:"space-y-3 bg-white/5 rounded-xl p-6 border border-white/10",children:[s.jsx("h3",{className:"font-bold text-lg text-cyan-400",children:"5. BOUNDARIES & CONSENT"}),s.jsxs("p",{className:"text-sm",children:[s.jsx("span",{className:"text-white/60",children:"Provider's Stated Boundaries:"})," ",s.jsx("span",{className:"italic",children:"[Respectful interaction required]"})]}),s.jsx("p",{className:"text-white/80 text-sm pt-2",children:"Client acknowledges:"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," I have read and will respect Provider's stated boundaries"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," Consent can be withdrawn at any time by either party"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""}),' "No" means no - immediately and without negotiation']}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," I will not pressure, coerce, or manipulate the Provider"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," Violation of consent may result in criminal charges and platform ban"]})]})]}),s.jsxs("div",{className:"space-y-3 bg-white/5 rounded-xl p-6 border border-white/10",children:[s.jsx("h3",{className:"font-bold text-lg text-cyan-400",children:"6. PRIVACY & CONFIDENTIALITY"}),s.jsx("p",{className:"text-white/80 text-sm",children:"Both parties agree:"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," We will not photograph, record, or stream this encounter without explicit consent"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," We will not disclose the other party's identity to third parties"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," We will not share private communications outside this platform"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," V.A.I. numbers and photos may not be shared externally"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," Violation of privacy may result in legal action and platform ban"]})]}),s.jsx("p",{className:"text-sm text-white/60 pt-3 italic bg-white/5 rounded p-3",children:"Exception: Either party may disclose information if required by law or in cases of genuine safety concerns."})]}),s.jsxs("div",{className:"space-y-3 bg-white/5 rounded-xl p-6 border border-white/10",children:[s.jsx("h3",{className:"font-bold text-lg text-cyan-400",children:"7. PLATFORM TERMS"}),s.jsx("p",{className:"text-white/80 text-sm",children:"This encounter is subject to:"}),s.jsxs("div",{className:"space-y-1.5 text-sm",children:[s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," Vairify Terms of Service"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," Vairify Community Guidelines"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," All applicable local, state, and federal laws"]})]}),s.jsx("p",{className:"text-white/80 text-sm pt-3",children:"Both parties acknowledge:"}),s.jsxs("ul",{className:"space-y-1.5 text-sm list-disc list-inside marker:text-cyan-400/60",children:[s.jsx("li",{children:"Vairify is a platform for connecting adults only"}),s.jsx("li",{children:"Vairify does not provide, endorse, or facilitate illegal activities"}),s.jsx("li",{children:"Users are responsible for ensuring their activities comply with local laws"}),s.jsx("li",{children:"Vairify is not liable for user conduct or outcomes of encounters"})]})]}),s.jsxs("div",{className:"space-y-3 bg-white/5 rounded-xl p-6 border border-white/10",children:[s.jsx("h3",{className:"font-bold text-lg text-cyan-400",children:"8. LIABILITY WAIVER"}),s.jsx("p",{className:"text-white/80 text-sm",children:"Both parties acknowledge and agree:"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," We assume all risks associated with this encounter"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," We release Vairify from any liability related to this encounter"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," We release each other from liability except in cases of:"]}),s.jsxs("div",{className:"pl-8 space-y-1 text-white/70",children:[s.jsx("p",{children:"- Intentional harm or assault"}),s.jsx("p",{children:"- Fraud or material misrepresentation"}),s.jsx("p",{children:"- Violation of consent"}),s.jsx("p",{children:"- Theft or property damage"})]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," We will resolve disputes directly or through legal channels (not via platform)"]})]})]}),s.jsxs("div",{className:"space-y-3 bg-white/5 rounded-xl p-6 border border-white/10",children:[s.jsx("h3",{className:"font-bold text-lg text-cyan-400",children:"9. CANCELLATION POLICY"}),s.jsxs("p",{className:"text-sm",children:[s.jsx("span",{className:"text-white/60",children:"Provider's Policy:"})," ",s.jsx("span",{className:"font-semibold",children:"Standard"})]}),s.jsx("p",{className:"text-white/80 text-sm pt-2",children:"Standard Terms:"}),s.jsxs("ul",{className:"space-y-1.5 text-sm list-disc list-inside marker:text-cyan-400/60",children:[s.jsxs("li",{children:["Cancellations with 24+ hours notice: ",s.jsx("span",{className:"font-semibold text-green-400",children:"No penalty"})]}),s.jsxs("li",{children:["Cancellations with 4-24 hours notice: ",s.jsx("span",{className:"font-semibold text-yellow-400",children:"50% of agreed amount"})]}),s.jsxs("li",{children:["Cancellations with <4 hours notice: ",s.jsx("span",{className:"font-semibold text-orange-400",children:"100% of agreed amount"})]}),s.jsxs("li",{children:["No-shows: ",s.jsx("span",{className:"font-semibold text-red-400",children:"100% of agreed amount + potential platform penalties"})]})]}),s.jsx("p",{className:"text-sm text-white/60 pt-2 italic bg-white/5 rounded p-3",children:"Emergency exceptions apply (illness, family emergency, safety concerns)"})]}),s.jsxs("div",{className:"space-y-3 bg-white/5 rounded-xl p-6 border border-white/10",children:[s.jsx("h3",{className:"font-bold text-lg text-cyan-400",children:"10. TRUEREVU REVIEW AGREEMENT"}),s.jsx("p",{className:"text-white/80 text-sm",children:"Both parties acknowledge:"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," After this encounter, we may leave verified reviews on Vairify"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," Reviews are permanent and immutable (cannot be edited or deleted)"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," Reviews must be honest, respectful, and based on actual experience"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," Reviews may not contain real names or identifying information"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," False or defamatory reviews may result in legal action"]})]})]}),s.jsxs("div",{className:"space-y-3 bg-white/5 rounded-xl p-6 border border-white/10",children:[s.jsx("h3",{className:"font-bold text-lg text-cyan-400",children:"11. DISPUTE RESOLUTION"}),s.jsx("p",{className:"text-white/80 text-sm",children:"If a dispute arises:"}),s.jsxs("ol",{className:"space-y-1.5 text-sm list-decimal list-inside marker:text-cyan-400 marker:font-semibold",children:[s.jsx("li",{children:"Parties agree to attempt good-faith resolution directly"}),s.jsx("li",{children:"Either party may request Vairify mediation (non-binding)"}),s.jsx("li",{children:"If unresolved, parties may pursue legal remedies"}),s.jsxs("li",{children:["This agreement is governed by ",s.jsx("span",{className:"font-semibold",children:"State of Florida"})]})]})]}),s.jsxs("div",{className:"space-y-3 bg-white/5 rounded-xl p-6 border border-white/10",children:[s.jsx("h3",{className:"font-bold text-lg text-cyan-400",children:"12. LEGAL ACKNOWLEDGMENTS"}),s.jsx("p",{className:"text-white/80 text-sm",children:"Both parties certify under penalty of perjury:"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," I am not a law enforcement officer or agent investigating the other party"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," I am not using this platform to facilitate human trafficking or exploitation"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," I understand this contract does not legalize prostitution where prohibited"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," I am responsible for complying with all applicable laws in my jurisdiction"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," I have read this entire agreement and understand its terms"]})]})]}),s.jsxs("div",{className:"space-y-3 bg-cyan-400/10 rounded-xl p-6 border border-cyan-400/20",children:[s.jsx("h3",{className:"font-bold text-lg text-cyan-400",children:"AUTOMATIC EMAIL CONFIRMATION"}),s.jsx("p",{className:"text-white/80 text-sm",children:"Both parties will receive a copy of this signed contract via email:"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," Sent to verified email addresses on file"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," Cannot be forwarded or shared (watermarked PDF)"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," Serves as proof of mutual agreement"]}),s.jsxs("p",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400 flex-shrink-0",children:""})," May be used as evidence in disputes"]})]})]}),s.jsx("div",{className:"pb-6"})]})}),s.jsx("div",{className:"flex-shrink-0 py-3 bg-gradient-to-t from-[#0A1628] via-[#0A1628]/80 to-transparent border-t border-white/5 flex items-center justify-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-1 animate-bounce",children:[s.jsx(Lc,{className:"w-6 h-6 text-cyan-400"}),s.jsx("span",{className:"text-xs text-cyan-400 font-semibold",children:"Scroll to read full contract"})]})}),s.jsx("div",{className:"flex-shrink-0 p-4 bg-gradient-to-t from-[#0A1628] to-transparent",children:s.jsx("div",{className:"max-w-md mx-auto",children:s.jsx(L,{onClick:d,disabled:a,className:"w-full h-14 text-lg font-bold bg-gradient-to-r from-cyan-400 via-cyan-500 to-blue-500 hover:from-cyan-500 hover:via-cyan-600 hover:to-blue-600 shadow-lg shadow-cyan-500/30 transition-all duration-300",children:a?"Signing...":`Sign Contract with V.A.I. ${c}`})})})]})]})}function zHe(){const e=Oe(),{sessionId:t}=us(),[r,n]=w.useState({punctuality:0,communication:0,respectfulness:0,attitude:0,accuracy:0,safety:0}),[a,i]=w.useState(""),[o,l]=w.useState(!1),[c,u]=w.useState(!0),[d,h]=w.useState(!1),[f,p]=w.useState(null),[m,v]=w.useState(null),[g,x]=w.useState(!1),[y,b]=w.useState(null),[N,j]=w.useState(null);w.useEffect(()=>{_()},[t]);const _=async()=>{try{const{data:{user:O}}=await T.auth.getUser();if(!O){H.error("You must be logged in to submit a review"),e("/login");return}const{data:I,error:R}=await T.from("vai_check_sessions").select("provider_id, client_id, status, encounter_id").eq("id",t).single();if(R||!I){H.error("Session not found"),e("/feed");return}if(p(I),I.encounter_id){const{data:M,error:B}=await T.from("encounters").select("*").eq("id",I.encounter_id).single();if(!B&&M){v(M);const D=O.id===I.provider_id?I.client_id:I.provider_id,W=await T.from("vai_verifications").select("vai_number").eq("user_id",O.id).single(),Z=await T.from("vai_verifications").select("vai_number").eq("user_id",D).single();W.data&&b(W.data.vai_number),Z.data&&j(Z.data.vai_number);const{data:U}=await T.rpc("can_submit_review",{p_encounter_id:M.id,p_reviewer_id:O.id});x(U||!1)}}else{H.error("Encounter not found. Please complete VAI Check first."),e("/vai-check");return}}catch(O){console.error("Error loading session data:",O),H.error(O.message||"Failed to load session data")}finally{u(!1)}},S=[{key:"punctuality",label:" Punctuality",icon:""},{key:"communication",label:" Communication",icon:""},{key:"respectfulness",label:" Respectfulness",icon:""},{key:"attitude",label:" Attitude",icon:""},{key:"accuracy",label:" Accuracy",icon:""},{key:"safety",label:" Safety",icon:""}],C=()=>{const O=Object.values(r).filter(R=>R>0);return O.length===0?null:(O.reduce((R,M)=>R+M,0)/O.length).toFixed(1)},E=(O,I)=>{n(R=>({...R,[O]:R[O]===I?0:I}))},k=(O,I)=>s.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(R=>s.jsx("button",{type:"button",onClick:()=>E(O,R),className:"focus:outline-none transition-transform hover:scale-110",children:s.jsx(hr,{className:`w-6 h-6 ${R<=I?"fill-yellow-400 text-yellow-400":"fill-none text-white/30"}`})},R))}),P=async()=>{if(!o){H.error("Please confirm your review is honest");return}const O=C();if(!O){H.error("Please rate at least one category");return}if(!g){H.error("You cannot submit a review yet. Both parties must complete the encounter first.");return}if(!m||!f||!y||!N){H.error("Missing required data. Please try again.");return}h(!0);try{const{data:{user:I}}=await T.auth.getUser();if(!I){H.error("You must be logged in to submit a review");return}const M=I.id===f.provider_id?f.client_id:f.provider_id;if(!M){H.error("Cannot determine reviewed user");return}const{data:B,error:$}=await T.functions.invoke("submit-review",{body:{encounter_id:m.id,reviewer_id:I.id,reviewed_user_id:M,reviewer_vai_number:y,reviewee_vai_number:N,punctuality_rating:r.punctuality||null,communication_rating:r.communication||null,respectfulness_rating:r.respectfulness||null,attitude_rating:r.attitude||null,accuracy_rating:r.accuracy||null,safety_rating:r.safety||null,overall_rating:parseFloat(O),review_text:a}});if($)throw $;if(B!=null&&B.success)H.success("Review submitted successfully!"),e("/feed");else throw new Error((B==null?void 0:B.error)||"Failed to submit review")}catch(I){console.error("Error submitting review:",I),H.error(I.message||"Failed to submit review. Please try again.")}finally{h(!1)}},A=C();return c?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-cyan-400 mx-auto"}),s.jsx("p",{children:"Loading review form..."})]})}):g?s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white",children:[s.jsx("header",{className:"sticky top-0 bg-[#0A1628]/95 backdrop-blur-sm border-b border-white/10 px-4 py-4 z-10",children:s.jsxs("div",{className:"max-w-md mx-auto flex items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e(-1),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold",children:"TrueRevu Review"}),s.jsx("p",{className:"text-xs text-white/60",children:"Share your verified experience"})]})]})}),s.jsxs("main",{className:"px-4 py-6 max-w-md mx-auto space-y-6 pb-24",children:[s.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4 flex items-center gap-3",children:[s.jsx(ut,{className:"w-6 h-6 text-green-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"Verified Encounter"}),s.jsxs("p",{className:"text-xs text-white/60",children:["Reviewing: VAI ",N==null?void 0:N.substring(0,8),"..."]})]})]}),s.jsxs("div",{className:"bg-white/5 rounded-xl p-6 space-y-4 border border-white/10",children:[s.jsx("h2",{className:"font-bold text-lg mb-4",children:"Rate Your Experience"}),S.map(O=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(de,{className:"text-white flex items-center gap-2 cursor-pointer",children:[s.jsx("span",{children:O.icon}),O.label]}),k(O.key,r[O.key])]},O.key)),A&&s.jsx("div",{className:"pt-4 border-t border-white/10 mt-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-semibold",children:"Overall Rating"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl font-bold",children:A}),s.jsx(hr,{className:"w-6 h-6 fill-yellow-400 text-yellow-400"})]})]})})]}),s.jsxs("div",{className:"bg-white/5 rounded-xl p-6 border border-white/10",children:[s.jsx(de,{htmlFor:"notes",className:"text-white font-semibold mb-2 block",children:"Additional Comments (Optional)"}),s.jsx(Mn,{id:"notes",value:a,onChange:O=>i(O.target.value),placeholder:"Share details about your experience...",className:"bg-white/5 border-white/20 text-white placeholder:text-white/40 min-h-[120px]",maxLength:1e3}),s.jsxs("p",{className:"text-xs text-white/40 mt-2",children:[a.length," / 1000 characters"]})]}),s.jsx("div",{className:"bg-white/5 rounded-xl p-6 border border-white/10",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Al,{id:"confirmed",checked:o,onCheckedChange:O=>l(O),className:"mt-1"}),s.jsx(de,{htmlFor:"confirmed",className:"text-white cursor-pointer",children:"I confirm this review is honest and based on my actual verified encounter. I understand this review cannot be edited or deleted after submission."})]})}),s.jsx(L,{onClick:P,disabled:!o||!A||d,className:"w-full h-14 text-lg bg-gradient-to-r from-cyan-500 to-cyan-600 hover:from-cyan-600 hover:to-cyan-700 text-white font-semibold",children:d?"Submitting Review...":"Submit Review"}),s.jsx("p",{className:"text-xs text-center text-white/40",children:"Reviews are immutable once submitted to ensure authenticity"})]})]}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#0A1628] to-[#1E40AF] text-white",children:[s.jsx("header",{className:"sticky top-0 bg-[#0A1628]/95 backdrop-blur-sm border-b border-white/10 px-4 py-4 z-10",children:s.jsxs("div",{className:"max-w-md mx-auto flex items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e(-1),className:"text-white hover:bg-white/10",children:s.jsx(ze,{className:"w-6 h-6"})}),s.jsx("div",{children:s.jsx("h1",{className:"text-xl font-bold",children:"TrueRevu Review"})})]})}),s.jsxs("main",{className:"px-4 py-8 max-w-md mx-auto",children:[s.jsxs(Hn,{className:"border-yellow-500/50 bg-yellow-500/10",children:[s.jsx(Xs,{className:"h-5 w-5 text-yellow-400"}),s.jsxs(Kn,{className:"text-white",children:[s.jsx("div",{className:"font-semibold mb-2",children:"Review Not Available Yet"}),s.jsx("p",{className:"text-sm text-white/80",children:"Both parties must complete the encounter before reviews can be submitted. This ensures authentic, mutual reviews."})]})]}),s.jsx(L,{onClick:()=>e("/feed"),className:"w-full mt-4 bg-gradient-to-r from-cyan-500 to-cyan-600",children:"Return to Feed"})]})]})}function WHe(){var m,v,g,x;const e=Oe(),[t,r]=w.useState(null),[n,a]=w.useState(!0),[i,o]=w.useState("earning");w.useEffect(()=>{l()},[]);const l=async()=>{try{const{data:{user:y}}=await T.auth.getUser();if(!y)return;const{data:b}=await T.from("referral_codes").select("*").eq("user_id",y.id).single(),{data:N}=await T.from("referrals").select("*").eq("referrer_id",y.id),{data:j}=await T.from("referral_invitations").select("*").eq("referrer_id",y.id),{data:_}=await T.from("referral_earnings").select("*").eq("referrer_id",y.id),S=(N==null?void 0:N.filter(O=>O.subscription_status==="premium"))||[],C=(N==null?void 0:N.filter(O=>O.subscription_status==="free"))||[],E=(j==null?void 0:j.filter(O=>O.status==="pending"))||[],k=new Date().toISOString().slice(0,7),P=(_==null?void 0:_.filter(O=>O.month_year===k).reduce((O,I)=>O+parseFloat(I.amount.toString()),0))||0,A=(_==null?void 0:_.reduce((O,I)=>O+parseFloat(I.amount.toString()),0))||0;r({code:b,referrals:{earning:S,free:C,pending:E},stats:{totalInvites:((N==null?void 0:N.length)||0)+((E==null?void 0:E.length)||0),signedUp:(N==null?void 0:N.length)||0,premium:S.length,active:S.length},earnings:{thisMonth:P,lifetime:A}})}catch(y){console.error("Error loading referral data:",y)}finally{a(!1)}},c=()=>{var b;const y=`https://vairify.com/join/${(b=t==null?void 0:t.code)==null?void 0:b.referral_code}`;navigator.clipboard.writeText(y),H.success("Referral link copied!")},u=async()=>{var b;const y=`https://vairify.com/join/${(b=t==null?void 0:t.code)==null?void 0:b.referral_code}`;if(navigator.share)try{await navigator.share({title:"Join Vairify",text:"Join the safest platform for adult services",url:y})}catch{c()}else c()};if(n)return s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading referrals..."})]})});const d=((m=t==null?void 0:t.code)==null?void 0:m.tier)||"standard",h=d==="founding_council"?"Founding Council":d==="first_movers"?"First Movers":"Member",f=((v=t==null?void 0:t.code)==null?void 0:v.commission_rate)||.05,p=20*f;return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4 flex items-center justify-between",children:[s.jsx("button",{onClick:()=>e(-1),className:"p-2 hover:bg-accent rounded-full",children:s.jsx(ze,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold",children:"REFERRALS & EARNINGS"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(L,{onClick:()=>e("/referral-leaderboard"),variant:"ghost",size:"icon",children:s.jsx(en,{className:"w-5 h-5"})}),s.jsx("button",{onClick:()=>e("/referrals/help"),className:"p-2 hover:bg-accent rounded-full",children:s.jsx(A0,{className:"w-6 h-6"})})]})]})}),s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6 space-y-6 pb-24",children:[s.jsx(q,{className:"p-4 bg-gradient-to-r from-primary/10 to-primary/5",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(aj,{className:"w-5 h-5 text-primary"}),s.jsxs("span",{className:"font-semibold",children:["YOUR STATUS: ",h]}),d==="founding_council"&&s.jsx("span",{className:"text-xl",children:""})]}),s.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Commission Rate: ",(f*100).toFixed(0),"% for life"]})]})})}),s.jsxs(q,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Wi,{className:"w-5 h-5 text-success"}),s.jsx("h2",{className:"text-lg font-bold",children:"EARNINGS OVERVIEW"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-success/10 to-success/5 rounded-lg p-4 mb-4",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"THIS MONTH"}),s.jsxs("p",{className:"text-3xl font-bold text-success",children:["$",t==null?void 0:t.earnings.thisMonth.toFixed(2)]}),s.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["From ",t==null?void 0:t.stats.active," active referrals"]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"LIFETIME"}),s.jsxs("p",{className:"text-xl font-bold",children:["$",t==null?void 0:t.earnings.lifetime.toFixed(2)]})]}),s.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"NEXT PAYOUT"}),s.jsxs("p",{className:"text-xl font-bold",children:["$",t==null?void 0:t.earnings.thisMonth.toFixed(2)]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Nov 15, 2025"})]})]}),s.jsx(L,{variant:"ghost",className:"w-full mt-4",onClick:()=>e("/referrals/payouts"),children:"View Payout History "})]}),s.jsxs(q,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(en,{className:"w-5 h-5 text-primary"}),s.jsx("h2",{className:"text-lg font-bold",children:"YOUR STATS"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold",children:t==null?void 0:t.stats.totalInvites}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Invites"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold",children:t==null?void 0:t.stats.signedUp}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Signed Up (",(t==null?void 0:t.stats.totalInvites)>0?Math.round(t.stats.signedUp/t.stats.totalInvites*100):0,"% conv)"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold",children:t==null?void 0:t.stats.premium}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Went Premium (",(t==null?void 0:t.stats.signedUp)>0?Math.round(t.stats.premium/t.stats.signedUp*100):0,"%)"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold",children:t==null?void 0:t.stats.active}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Currently Active"})]})]})]}),s.jsxs(q,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(RC,{className:"w-5 h-5 text-primary"}),s.jsx("h2",{className:"text-lg font-bold",children:"YOUR REFERRAL CODE"})]}),s.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 mb-4",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"V.A.I.:"}),s.jsx("p",{className:"text-2xl font-bold mb-2",children:(g=t==null?void 0:t.code)==null?void 0:g.referral_code}),s.jsxs("p",{className:"text-sm text-primary break-all",children:["vairify.com/join/",(x=t==null?void 0:t.code)==null?void 0:x.referral_code]})]}),s.jsxs("div",{className:"flex gap-2 mb-4",children:[s.jsxs(L,{variant:"outline",className:"flex-1",onClick:c,children:[s.jsx(sg,{className:"w-4 h-4 mr-2"}),"Copy Link"]}),s.jsxs(L,{variant:"outline",className:"flex-1",onClick:u,children:[s.jsx(RC,{className:"w-4 h-4 mr-2"}),"Share"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(L,{className:"w-full h-14 text-lg font-bold bg-gradient-to-r from-primary to-primary/80",onClick:()=>e("/referrals/invite/email"),children:[s.jsx(ai,{className:"w-5 h-5 mr-2"}),"INVITE VIA EMAIL"]}),s.jsxs(L,{className:"w-full h-14 text-lg font-bold bg-gradient-to-r from-cyan-500 to-blue-500",onClick:()=>e("/referrals/invite/sms"),children:[s.jsx(Ed,{className:"w-5 h-5 mr-2"}),"INVITE VIA SMS"]})]})]}),s.jsxs(q,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(An,{className:"w-5 h-5 text-primary"}),s.jsxs("h2",{className:"text-lg font-bold",children:["YOUR REFERRALS (",t==null?void 0:t.stats.active," Active)"]})]}),s.jsxs(Ga,{value:i,onValueChange:o,children:[s.jsxs(Aa,{className:"grid w-full grid-cols-3 mb-4",children:[s.jsxs(mt,{value:"earning",children:["Earning (",t==null?void 0:t.referrals.earning.length,")"]}),s.jsxs(mt,{value:"free",children:["Free (",t==null?void 0:t.referrals.free.length,")"]}),s.jsxs(mt,{value:"pending",children:["Pending (",t==null?void 0:t.referrals.pending.length,")"]})]}),s.jsxs(Rt,{value:"earning",className:"space-y-4",children:[s.jsxs("div",{className:"text-sm text-success font-semibold mb-2",children:[" EARNING (",t==null?void 0:t.referrals.earning.length," Premium users)"]}),t==null?void 0:t.referrals.earning.map(y=>s.jsxs(q,{className:"p-4 border-l-4 border-l-success",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:s.jsx(An,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"Referral User "}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Joined: ",new Date(y.created_at).toLocaleDateString()]})]})]}),s.jsx(xe,{variant:"outline",className:"bg-success/10 text-success border-success",children:"Premium Active"})]}),s.jsxs("div",{className:"bg-success/5 rounded-lg p-3 mt-3",children:[s.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"YOUR EARNINGS:"}),s.jsxs("div",{className:"space-y-1 text-sm",children:[s.jsxs("p",{children:[" Per month: ",s.jsxs("span",{className:"font-bold text-success",children:["$",p.toFixed(2)]})]}),s.jsxs("p",{children:[" Total earned: ",s.jsxs("span",{className:"font-bold",children:["$",(p*2).toFixed(2)]})]}),s.jsxs("p",{children:[" Active for: ",s.jsx("span",{className:"font-bold",children:"2 months"})]})]})]})]},y.id)),(t==null?void 0:t.referrals.earning.length)===0&&s.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No earning referrals yet"})]}),s.jsxs(Rt,{value:"free",className:"space-y-4",children:[s.jsxs("div",{className:"text-sm font-semibold mb-2 text-muted-foreground",children:[" ACTIVE - FREE (",t==null?void 0:t.referrals.free.length," users)"]}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Not earning yet - encourage them to upgrade!"}),t==null?void 0:t.referrals.free.map(y=>s.jsxs(q,{className:"p-4",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-muted flex items-center justify-center",children:s.jsx(An,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"Free User "}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Joined: ",new Date(y.created_at).toLocaleDateString()]})]})]}),s.jsx(xe,{variant:"outline",children:"Free"})]}),s.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 mt-3",children:[s.jsxs("p",{className:"text-sm",children:["Potential: ",s.jsxs("span",{className:"font-bold text-primary",children:["$",p.toFixed(2),"/month"]})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"if they upgrade"})]})]},y.id)),(t==null?void 0:t.referrals.free.length)===0&&s.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No free referrals"})]}),s.jsxs(Rt,{value:"pending",className:"space-y-4",children:[s.jsxs("div",{className:"text-sm font-semibold mb-2 text-muted-foreground",children:[" PENDING INVITES (",t==null?void 0:t.referrals.pending.length,")"]}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Haven't signed up yet"}),t==null?void 0:t.referrals.pending.map(y=>s.jsxs(q,{className:"p-4",children:[s.jsx("div",{className:"flex items-start justify-between mb-2",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[y.invite_method==="email"?s.jsx(ai,{className:"w-4 h-4"}):s.jsx(Ed,{className:"w-4 h-4"}),s.jsx("p",{className:"font-medium",children:y.invite_target})]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Invited: ",new Date(y.invited_at).toLocaleDateString()]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[Math.floor((Date.now()-new Date(y.invited_at).getTime())/(1e3*60*60*24))," days ago"]})]})}),s.jsxs("div",{className:"flex gap-2 mt-3",children:[s.jsx(L,{variant:"outline",size:"sm",className:"flex-1",children:y.invite_method==="email"?" Resend Email":" Resend SMS"}),s.jsx(L,{variant:"ghost",size:"sm",className:"text-destructive",children:" Cancel"})]})]},y.id)),(t==null?void 0:t.referrals.pending.length)===0&&s.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No pending invitations"})]})]})]}),s.jsxs(q,{className:"p-6 bg-gradient-to-r from-primary/5 to-cyan-500/5",children:[s.jsx("h3",{className:"font-bold mb-3",children:" TIPS TO INCREASE EARNINGS"}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsx("li",{children:" SMS invites convert 3x better!"}),s.jsx("li",{children:" Personal messages get 35% more upgrades"}),s.jsx("li",{children:" Follow up after 48 hours"})]})]})]})]})}function qHe(){const e=Oe();return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4 flex items-center justify-between",children:[s.jsx("button",{onClick:()=>e(-1),className:"p-2 hover:bg-accent rounded-full",children:s.jsx(ze,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold",children:"HOW IT WORKS"}),s.jsx("div",{className:"w-10"})]})}),s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6 space-y-6 pb-24",children:[s.jsxs(q,{className:"p-6 bg-gradient-to-br from-primary/10 to-primary/5",children:[s.jsx(Wi,{className:"w-12 h-12 text-primary mb-4"}),s.jsx("h2",{className:"text-2xl font-bold mb-2",children:"REFERRAL PROGRAM"}),s.jsx("p",{className:"text-muted-foreground",children:"Earn lifetime commission when people you invite upgrade to Premium ($20/month)"})]}),s.jsxs(q,{className:"p-6",children:[s.jsx("h3",{className:"font-bold text-lg mb-4",children:"HOW IT WORKS:"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center font-bold text-primary",children:"1"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"SHARE YOUR CODE"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Share your V.A.I. code or referral link via email/SMS"})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center font-bold text-primary",children:"2"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"THEY SIGN UP"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"When they create account with your code, they're linked to you"})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center font-bold text-primary",children:"3"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"THEY UPGRADE TO PREMIUM"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"If they upgrade to Premium ($20/month), you start earning"})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center font-bold text-primary",children:"4"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"YOU EARN FOREVER"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Get paid every month they stay Premium - for life!"})]})]})]})]}),s.jsxs(q,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(aj,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"font-bold text-lg",children:"COMMISSION RATES:"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-primary/5 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"text-2xl",children:""}),s.jsx("p",{className:"font-bold",children:"Founding Council (First 100)"})]}),s.jsxs("ul",{className:"space-y-1 text-sm ml-8",children:[s.jsx("li",{children:" 10% lifetime commission"}),s.jsx("li",{children:" $2 per Premium referral/month"}),s.jsx("li",{children:" Premium FREE forever"})]})]}),s.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"text-2xl",children:""}),s.jsx("p",{className:"font-bold",children:"First Movers (Next 900)"})]}),s.jsxs("ul",{className:"space-y-1 text-sm ml-8",children:[s.jsx("li",{children:" 5% lifetime commission"}),s.jsx("li",{children:" $1 per Premium referral/month"}),s.jsx("li",{children:" 50% off Premium forever"})]})]})]})]}),s.jsxs(q,{className:"p-6 bg-gradient-to-br from-success/10 to-success/5",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(en,{className:"w-5 h-5 text-success"}),s.jsx("h3",{className:"font-bold text-lg",children:"EXAMPLE EARNINGS:"})]}),s.jsx("p",{className:"text-sm mb-3",children:"If you refer 10 people who all upgrade to Premium:"}),s.jsxs("div",{className:"bg-background/50 rounded-lg p-4 mb-3",children:[s.jsx("p",{className:"font-semibold mb-2",children:"Founding Council: $20/month"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"(10  $2 = $20)"})]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("p",{children:["After 1 year: ",s.jsx("span",{className:"font-bold text-success",children:"$240"})]}),s.jsxs("p",{children:["After 2 years: ",s.jsx("span",{className:"font-bold text-success",children:"$480"})]}),s.jsxs("p",{children:["Lifetime: ",s.jsx("span",{className:"font-bold text-success",children:"Unlimited!"})]})]})]}),s.jsxs(q,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Yn,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"font-bold text-lg",children:"PAYOUT SCHEDULE:"})]}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"Calculated:"})," Last day of month"]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"Paid:"})," 15th of following month"]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"Minimum:"})," $20 (rolls over if less)"]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"Methods:"})," Bank, PayPal, VairiPay"]})]})]}),s.jsxs(q,{className:"p-6 bg-gradient-to-r from-cyan-500/10 to-blue-500/10",children:[s.jsx("h3",{className:"font-bold text-lg mb-4",children:"TIPS FOR SUCCESS:"}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsx("li",{children:" SMS invites convert 3x better"}),s.jsx("li",{children:" Personal message = 35% boost"}),s.jsx("li",{children:" Follow up after 48 hours"}),s.jsx("li",{children:" Share success stories"}),s.jsx("li",{children:" Explain safety benefits"})]})]}),s.jsx(L,{className:"w-full h-14 text-lg font-bold",onClick:()=>e("/referrals"),children:"Start Referring Now"})]})]})}function GHe(){const e=Oe(),[t,r]=w.useState([]),[n,a]=w.useState(!0);w.useEffect(()=>{i()},[]);const i=async()=>{try{const{data:{user:o}}=await T.auth.getUser();if(!o)return;const{data:l}=await T.from("referral_payouts").select("*").eq("user_id",o.id).order("payout_date",{ascending:!1});r(l||[])}catch(o){console.error("Error loading payouts:",o)}finally{a(!1)}};return n?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4 flex items-center justify-between",children:[s.jsx("button",{onClick:()=>e(-1),className:"p-2 hover:bg-accent rounded-full",children:s.jsx(ze,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold",children:"PAYOUT HISTORY"}),s.jsx("div",{className:"w-10"})]})}),s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6 space-y-6 pb-24",children:[s.jsxs(q,{className:"p-6 bg-gradient-to-br from-success/10 to-success/5",children:[s.jsx("h2",{className:"font-bold text-lg mb-4",children:"NEXT PAYOUT"}),s.jsxs("div",{className:"bg-background/50 rounded-lg p-4 mb-4",children:[s.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[s.jsx(Wi,{className:"w-6 h-6 text-success"}),s.jsx("span",{className:"text-3xl font-bold text-success",children:"$56.00"})]}),s.jsx("p",{className:"text-sm font-semibold",children:"November 15, 2025"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"(8 days away)"})]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsx("p",{children:"From 28 active referrals"}),s.jsx("p",{children:"(12 Premium subscribers)"})]}),s.jsxs("div",{className:"mt-4 pt-4 border-t border-border",children:[s.jsx("p",{className:"text-sm font-semibold mb-1",children:"Payment Method:"}),s.jsx("p",{className:"text-sm",children:"Bank  1234"}),s.jsx(L,{variant:"link",className:"p-0 h-auto text-primary",size:"sm",children:"Update Method "})]})]}),s.jsxs("div",{className:"bg-warning/10 border border-warning/20 rounded-lg p-4",children:[s.jsxs("p",{className:"text-sm",children:[" ",s.jsx("span",{className:"font-semibold",children:"Minimum payout: $20"})]}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Payouts process on the 15th of each month"})]}),s.jsxs(q,{className:"p-6",children:[s.jsx("h3",{className:"font-bold mb-4",children:"PAYMENT METHOD"}),s.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 mb-4",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Current:"}),s.jsx("p",{className:"font-semibold",children:"Bank Transfer"}),s.jsx("p",{className:"text-sm",children:" 1234"}),s.jsx(L,{variant:"outline",className:"mt-3",children:"Change Method"})]}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.jsx("p",{className:"mb-1",children:"Available methods:"}),s.jsxs("ul",{className:"space-y-1 ml-4",children:[s.jsx("li",{children:" Bank Transfer (ACH)"}),s.jsx("li",{children:" PayPal"}),s.jsx("li",{children:" VairiPay Wallet"})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg mb-4",children:"PAST PAYOUTS"}),t.length===0?s.jsxs(q,{className:"p-8 text-center",children:[s.jsx(Yn,{className:"w-12 h-12 text-muted-foreground mx-auto mb-3"}),s.jsx("p",{className:"text-muted-foreground",children:"No payout history yet"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your first payout will appear here"})]}):s.jsx("div",{className:"space-y-4",children:t.map(o=>s.jsxs(q,{className:"p-4",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:new Date(o.payout_date).toLocaleDateString("en-US",{month:"long",year:"numeric"})}),s.jsxs("p",{className:"text-2xl font-bold text-success",children:["$",parseFloat(o.amount).toFixed(2)]})]}),s.jsx(xe,{variant:o.status==="completed"?"default":"secondary",className:o.status==="completed"?"bg-success":"",children:o.status})]}),s.jsxs("div",{className:"text-sm space-y-1",children:[s.jsxs("p",{className:"flex items-center gap-1",children:[o.status==="completed"&&s.jsx(ut,{className:"w-4 h-4 text-success"}),"Paid: ",new Date(o.payout_date).toLocaleDateString()]}),o.payment_reference&&s.jsxs("p",{className:"text-muted-foreground",children:["Reference: ",o.payment_reference]})]}),s.jsxs("div",{className:"flex gap-2 mt-3",children:[s.jsx(L,{variant:"outline",size:"sm",children:"View Details"}),s.jsx(L,{variant:"outline",size:"sm",children:"Receipt"})]})]},o.id))})]}),s.jsxs(q,{className:"p-6 bg-gradient-to-r from-primary/5 to-cyan-500/5",children:[s.jsx("h3",{className:"font-bold mb-4",children:"LIFETIME SUMMARY"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Total Earned:"}),s.jsx("p",{className:"text-xl font-bold",children:"$672.00"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Total Paid Out:"}),s.jsx("p",{className:"text-xl font-bold",children:"$616.00"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Pending:"}),s.jsx("p",{className:"text-xl font-bold text-success",children:"$56.00"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Average Monthly:"}),s.jsx("p",{className:"text-xl font-bold",children:"$61.09"})]})]}),s.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"Member since: Dec 2024 (11 months)"})]})]})]})}function HHe(){const e=Oe(),[t,r]=w.useState(""),[n,a]=w.useState([]),[i,o]=w.useState("Hey! I'm using Vairify for verified safety in my work. You should check it out!"),[l,c]=w.useState(""),[u,d]=w.useState(!1),h=x=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(x),f=()=>{const x=t.trim();if(x){if(!h(x)){H.error("Invalid email address");return}if(n.includes(x)){H.error("Email already added");return}a([...n,x]),r("")}},p=x=>{a(n.filter(y=>y!==x))},m=()=>{const x=l.split(/[,;\s\n]+/).map(j=>j.trim()).filter(j=>j.length>0),y=x.filter(h),b=x.filter(j=>!h(j));b.length>0&&H.error(`${b.length} invalid email(s) skipped`);const N=y.filter(j=>!n.includes(j));a([...n,...N]),c(""),N.length>0&&H.success(`Added ${N.length} email(s)`)},v=async()=>{if(n.length!==0){d(!0);try{const{data:{user:x}}=await T.auth.getUser();if(!x){H.error("Please log in to send invitations");return}const y=n.map(N=>({referrer_id:x.id,invite_method:"email",invite_target:N,message:i||null,status:"pending"})),{error:b}=await T.from("referral_invitations").insert(y);if(b)throw b;H.success(`${n.length} invitation(s) sent!`),e("/referrals")}catch(x){console.error("Error sending invitations:",x),H.error("Failed to send invitations")}finally{d(!1)}}},g=x=>{x.key==="Enter"&&f()};return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4 flex items-center justify-between",children:[s.jsx("button",{onClick:()=>e(-1),className:"p-2 hover:bg-accent rounded-full",children:s.jsx(ze,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold",children:"INVITE VIA EMAIL"}),s.jsx("div",{className:"w-10"})]})}),s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6 space-y-6 pb-24",children:[s.jsx(q,{className:"p-6",children:s.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[s.jsx(ai,{className:"w-6 h-6 text-primary mt-1"}),s.jsxs("div",{children:[s.jsx("h2",{className:"font-bold text-lg",children:"Send Email Invitations"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your friends will receive a personalized email with your referral link"})]})]})}),s.jsxs(q,{className:"p-6",children:[s.jsx("h3",{className:"font-bold mb-4",children:"ENTER EMAIL ADDRESSES"}),s.jsxs("div",{className:"flex gap-2 mb-4",children:[s.jsx(De,{placeholder:"email@example.com",value:t,onChange:x=>r(x.target.value),onKeyPress:g,className:"flex-1"}),s.jsx(L,{onClick:f,variant:"outline",children:"Add"})]}),n.length>0&&s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsxs("p",{className:"text-sm font-semibold",children:["Added (",n.length,"):"]}),n.map(x=>s.jsxs("div",{className:"flex items-center justify-between bg-muted/50 rounded-lg p-3",children:[s.jsx("span",{className:"text-sm",children:x}),s.jsx("button",{onClick:()=>p(x),className:"p-1 hover:bg-background rounded",children:s.jsx(vn,{className:"w-4 h-4"})})]},x))]}),s.jsxs("div",{className:"border-t border-border pt-4 mt-4",children:[s.jsx("p",{className:"text-sm font-semibold mb-2",children:"OR paste multiple (comma separated):"}),s.jsx(Mn,{placeholder:"sarah@example.com, jordan@test.com, alex@email.com",value:l,onChange:x=>c(x.target.value),rows:3,className:"mb-2"}),s.jsx(L,{onClick:m,variant:"outline",disabled:!l.trim(),children:"Paste & Add"})]})]}),s.jsxs(q,{className:"p-6",children:[s.jsx("h3",{className:"font-bold mb-4",children:"PERSONALIZE MESSAGE (Optional)"}),s.jsx(Mn,{value:i,onChange:x=>o(x.target.value),rows:4,maxLength:280,className:"mb-2"}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[280-i.length," characters remaining"]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Your referral link will be automatically included"})]}),s.jsxs(q,{className:"p-6 bg-gradient-to-br from-primary/10 to-cyan-500/10",children:[s.jsx("h3",{className:"font-bold mb-4",children:"WHAT THEY'LL GET:"}),s.jsxs("ul",{className:"space-y-2 mb-4",children:[s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-success",children:""}),"20% off first year"]}),s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-success",children:""}),"Access to safety features"]}),s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-success",children:""}),"Priority support"]})]}),s.jsx("h3",{className:"font-bold mb-2",children:"WHAT YOU'LL EARN:"}),s.jsxs("ul",{className:"space-y-2",children:[s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{children:""}),"10% of their subscription"]}),s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{children:""}),"Every month they stay Premium"]}),s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{children:""}),"Forever (lifetime commission)"]})]}),s.jsx("p",{className:"text-sm text-muted-foreground mt-3",children:"Example: $2/month if they pay $20/month for Premium"})]}),s.jsx(L,{onClick:v,disabled:n.length===0||u,className:"w-full",size:"lg",children:u?"SENDING...":`SEND INVITATIONS (${n.length})`})]})]})}function KHe(){const e=Oe(),[t,r]=w.useState(""),[n,a]=w.useState([]),[i,o]=w.useState(""),[l,c]=w.useState(!1),u=y=>{const b=y.replace(/\D/g,"");return b.length===10||b.length===11},d=y=>{const b=y.replace(/\D/g,"");return b.length===10?`+1 (${b.slice(0,3)}) ${b.slice(3,6)}-${b.slice(6)}`:b.length===11&&b[0]==="1"?`+${b[0]} (${b.slice(1,4)}) ${b.slice(4,7)}-${b.slice(7)}`:y},h=()=>{const y=t.trim();if(!y)return;if(!u(y)){H.error("Invalid phone number");return}const b=d(y);if(n.includes(b)){H.error("Phone number already added");return}a([...n,b]),r("")},f=y=>{a(n.filter(b=>b!==y))},p=()=>`Hey! I'm on Vairify - the verified safety platform. Join with my code & get 20% off: vairify.com/join/9I7T35L

Reply STOP to unsubscribe`,m=()=>i.trim()?i:p(),v=async()=>{if(n.length!==0){c(!0);try{const{data:{user:y}}=await T.auth.getUser();if(!y){H.error("Please log in to send invitations");return}const b=n.map(j=>({referrer_id:y.id,invite_method:"sms",invite_target:j,message:m(),status:"pending"})),{error:N}=await T.from("referral_invitations").insert(b);if(N)throw N;H.success(`${n.length} SMS invitation(s) sent!`),e("/referrals")}catch(y){console.error("Error sending invitations:",y),H.error("Failed to send invitations")}finally{c(!1)}}},g=y=>{y.key==="Enter"&&h()},x=()=>(n.length*.05).toFixed(2);return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4 flex items-center justify-between",children:[s.jsx("button",{onClick:()=>e(-1),className:"p-2 hover:bg-accent rounded-full",children:s.jsx(ze,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold",children:"INVITE VIA SMS"}),s.jsx("div",{className:"w-10"})]})}),s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6 space-y-6 pb-24",children:[s.jsx(q,{className:"p-6",children:s.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[s.jsx(Ed,{className:"w-6 h-6 text-primary mt-1"}),s.jsxs("div",{children:[s.jsx("h2",{className:"font-bold text-lg",children:"Send Text Message Invitations"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Friends receive SMS with your referral link (standard rates apply)"})]})]})}),s.jsxs(q,{className:"p-6",children:[s.jsx("h3",{className:"font-bold mb-4",children:"ENTER PHONE NUMBERS"}),s.jsxs("div",{className:"flex gap-2 mb-4",children:[s.jsx(De,{placeholder:"+1 (555) 123-4567",value:t,onChange:y=>r(y.target.value),onKeyPress:g,className:"flex-1"}),s.jsx(L,{onClick:h,variant:"outline",children:"Add"})]}),s.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:"US/Canada format"}),n.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{className:"text-sm font-semibold",children:["Added (",n.length,"):"]}),n.map(y=>s.jsxs("div",{className:"flex items-center justify-between bg-muted/50 rounded-lg p-3",children:[s.jsx("span",{className:"text-sm",children:y}),s.jsx("button",{onClick:()=>f(y),className:"p-1 hover:bg-background rounded",children:s.jsx(vn,{className:"w-4 h-4"})})]},y))]})]}),s.jsxs(q,{className:"p-6",children:[s.jsx("h3",{className:"font-bold mb-4",children:"MESSAGE PREVIEW"}),s.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 mb-4",children:[s.jsx("p",{className:"text-sm whitespace-pre-wrap font-mono",children:m()}),s.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[m().length,"/160 characters"]})]}),s.jsx(L,{onClick:()=>o(p()),variant:"outline",className:"mb-3",children:"Personalize Message"}),i!==""&&s.jsxs("div",{children:[s.jsx(Mn,{value:i,onChange:y=>o(y.target.value),rows:5,maxLength:160,className:"mb-2 font-mono text-sm"}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.length,"/160 characters"]}),s.jsx(L,{onClick:()=>o(""),variant:"ghost",size:"sm",children:"Reset to Default"})]})]})]}),s.jsxs(q,{className:"p-6 bg-gradient-to-br from-primary/10 to-cyan-500/10",children:[s.jsx("h3",{className:"font-bold mb-4",children:"WHAT THEY'LL GET:"}),s.jsxs("ul",{className:"space-y-2 mb-4",children:[s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-success",children:""}),"20% off first year"]}),s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-success",children:""}),"V.A.I. verification"]}),s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-success",children:""}),"DateGuard protection"]})]}),s.jsx("h3",{className:"font-bold mb-2",children:"WHAT YOU'LL EARN:"}),s.jsxs("ul",{className:"space-y-2",children:[s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{children:""}),"$2/month per Premium referral"]}),s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{children:""}),"Forever (10% lifetime)"]})]}),s.jsx("div",{className:"mt-4 p-3 bg-primary/10 rounded-lg",children:s.jsx("p",{className:"text-sm font-semibold",children:" SMS invites convert 3x better!"})})]}),n.length>0&&s.jsxs(q,{className:"p-4 bg-warning/10 border-warning/20",children:[s.jsxs("p",{className:"text-sm",children:[s.jsx("span",{className:"font-semibold",children:"Cost:"})," $",x()," (",n.length," SMS  $0.05)"]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Deducted from earnings or charged to payment method"})]}),s.jsx(L,{onClick:v,disabled:n.length===0||l,className:"w-full",size:"lg",children:l?"SENDING...":`SEND TEXT MESSAGES (${n.length})`})]})]})}const dh=()=>{const[e,t]=w.useState(!1),[r,n]=w.useState(!0);w.useEffect(()=>{a()},[]);const a=async()=>{try{const{data:{user:i}}=await T.auth.getUser();if(!i){t(!1),n(!1);return}const{data:o}=await T.from("user_roles").select("role").eq("user_id",i.id).eq("role","admin").single();t(!!o)}catch(i){console.error("Error checking admin status:",i),t(!1)}finally{n(!1)}};return{isAdmin:e,loading:r}};function YHe(){const e=Oe(),{isAdmin:t,loading:r}=dh();if(w.useEffect(()=>{!r&&!t&&e("/feed")},[t,r,e]),r)return s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})});if(!t)return null;const n=[{title:"User Management",description:"Search, view, and manage all users",icon:An,path:"/admin/users",color:"from-blue-500/10 to-cyan-500/10"},{title:"Influencer & Affiliates",description:"Manage applications and Founding Council",icon:An,path:"/admin/influencers",color:"from-purple-500/10 to-violet-500/10"},{title:"Coupon Generator",description:"Create promotional and founding member codes",icon:Wi,path:"/admin/coupons",color:"from-yellow-500/10 to-amber-500/10"},{title:"Referral System",description:"Monitor referrals, earnings, and payouts",icon:Wi,path:"/admin/referrals",color:"from-green-500/10 to-emerald-500/10"},{title:"Country Representatives",description:"Manage country rep competitions and leaderboard",icon:og,path:"/admin/country-reps",color:"from-yellow-500/10 to-orange-500/10"},{title:"V.A.I. Check Sessions",description:"View all verification sessions",icon:lt,path:"/admin/vai-sessions",color:"from-purple-500/10 to-pink-500/10"},{title:"DateGuard Sessions",description:"Monitor active and past safety sessions",icon:JV,path:"/admin/dateguard-sessions",color:"from-orange-500/10 to-red-500/10"},{title:"Pricing Controls",description:"Manage subscription tiers and rates",icon:oj,path:"/admin/pricing",color:"from-indigo-500/10 to-blue-500/10"},{title:"System Monitor",description:"Real-time errors, network, and database tracking",icon:fae,path:"/admin/system-monitor",color:"from-red-500/10 to-rose-500/10"},{title:"Email Notifications Test",description:"Test email notification system and RESEND integration",icon:ai,path:"/admin/email-test",color:"from-pink-500/10 to-fuchsia-500/10"},{title:"Email Logs Viewer",description:"View email sending logs, successes, and failures",icon:T0,path:"/admin/email-logs",color:"from-violet-500/10 to-purple-500/10"},{title:"Platform Analytics",description:"View platform stats and metrics",icon:kC,path:"/admin/analytics",color:"from-cyan-500/10 to-teal-500/10"}];return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Admin Dashboard"}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage your platform"})]})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 py-8",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(a=>{const i=a.icon;return s.jsx(q,{className:`p-6 cursor-pointer hover:shadow-lg transition-all bg-gradient-to-br ${a.color}`,onClick:()=>e(a.path),children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"p-3 bg-primary/10 rounded-lg",children:s.jsx(i,{className:"w-6 h-6 text-primary"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-bold text-lg mb-1",children:a.title}),s.jsx("p",{className:"text-sm text-muted-foreground",children:a.description})]})]})},a.path)})})})]})}var XHe=[" ","Enter","ArrowUp","ArrowDown"],QHe=[" ","Enter"],zd="Select",[a_,s_,ZHe]=wx(zd),[jm,wQe]=an(zd,[ZHe,lu]),i_=lu(),[JHe,Nu]=jm(zd),[e9e,t9e]=jm(zd),rZ=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:u,name:d,autoComplete:h,disabled:f,required:p,form:m}=e,v=i_(t),[g,x]=w.useState(null),[y,b]=w.useState(null),[N,j]=w.useState(!1),_=ah(u),[S,C]=Ba({prop:n,defaultProp:a??!1,onChange:i,caller:zd}),[E,k]=Ba({prop:o,defaultProp:l,onChange:c,caller:zd}),P=w.useRef(null),A=g?m||!!g.closest("form"):!0,[O,I]=w.useState(new Set),R=Array.from(O).map(M=>M.props.value).join(";");return s.jsx(fj,{...v,children:s.jsxs(JHe,{required:p,scope:t,trigger:g,onTriggerChange:x,valueNode:y,onValueNodeChange:b,valueNodeHasChildren:N,onValueNodeHasChildrenChange:j,contentId:pn(),value:E,onValueChange:k,open:S,onOpenChange:C,dir:_,triggerPointerDownPosRef:P,disabled:f,children:[s.jsx(a_.Provider,{scope:t,children:s.jsx(e9e,{scope:e.__scopeSelect,onNativeOptionAdd:w.useCallback(M=>{I(B=>new Set(B).add(M))},[]),onNativeOptionRemove:w.useCallback(M=>{I(B=>{const $=new Set(B);return $.delete(M),$})},[]),children:r})}),A?s.jsxs(CZ,{"aria-hidden":!0,required:p,tabIndex:-1,name:d,autoComplete:h,value:E,onChange:M=>k(M.target.value),disabled:f,form:m,children:[E===void 0?s.jsx("option",{value:""}):null,Array.from(O)]},R):null]})})};rZ.displayName=zd;var nZ="SelectTrigger",aZ=w.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=e,i=i_(r),o=Nu(nZ,r),l=o.disabled||n,c=ct(t,o.onTriggerChange),u=s_(r),d=w.useRef("touch"),[h,f,p]=kZ(v=>{const g=u().filter(b=>!b.disabled),x=g.find(b=>b.value===o.value),y=AZ(g,v,x);y!==void 0&&o.onValueChange(y.value)}),m=v=>{l||(o.onOpenChange(!0),p()),v&&(o.triggerPointerDownPosRef.current={x:Math.round(v.pageX),y:Math.round(v.pageY)})};return s.jsx(Sx,{asChild:!0,...i,children:s.jsx(Me.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":EZ(o.value)?"":void 0,...a,ref:c,onClick:Ne(a.onClick,v=>{v.currentTarget.focus(),d.current!=="mouse"&&m(v)}),onPointerDown:Ne(a.onPointerDown,v=>{d.current=v.pointerType;const g=v.target;g.hasPointerCapture(v.pointerId)&&g.releasePointerCapture(v.pointerId),v.button===0&&v.ctrlKey===!1&&v.pointerType==="mouse"&&(m(v),v.preventDefault())}),onKeyDown:Ne(a.onKeyDown,v=>{const g=h.current!=="";!(v.ctrlKey||v.altKey||v.metaKey)&&v.key.length===1&&f(v.key),!(g&&v.key===" ")&&XHe.includes(v.key)&&(m(),v.preventDefault())})})})});aZ.displayName=nZ;var sZ="SelectValue",iZ=w.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,children:i,placeholder:o="",...l}=e,c=Nu(sZ,r),{onValueNodeHasChildrenChange:u}=c,d=i!==void 0,h=ct(t,c.onValueNodeChange);return Xr(()=>{u(d)},[u,d]),s.jsx(Me.span,{...l,ref:h,style:{pointerEvents:"none"},children:EZ(c.value)?s.jsx(s.Fragment,{children:o}):i})});iZ.displayName=sZ;var r9e="SelectIcon",oZ=w.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...a}=e;return s.jsx(Me.span,{"aria-hidden":!0,...a,ref:t,children:n||""})});oZ.displayName=r9e;var n9e="SelectPortal",lZ=e=>s.jsx(Vp,{asChild:!0,...e});lZ.displayName=n9e;var Wd="SelectContent",cZ=w.forwardRef((e,t)=>{const r=Nu(Wd,e.__scopeSelect),[n,a]=w.useState();if(Xr(()=>{a(new DocumentFragment)},[]),!r.open){const i=n;return i?ei.createPortal(s.jsx(uZ,{scope:e.__scopeSelect,children:s.jsx(a_.Slot,{scope:e.__scopeSelect,children:s.jsx("div",{children:e.children})})}),i):null}return s.jsx(dZ,{...e,ref:t})});cZ.displayName=Wd;var wi=10,[uZ,_u]=jm(Wd),a9e="SelectContentImpl",s9e=Xc("SelectContent.RemoveScroll"),dZ=w.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:p,sticky:m,hideWhenDetached:v,avoidCollisions:g,...x}=e,y=Nu(Wd,r),[b,N]=w.useState(null),[j,_]=w.useState(null),S=ct(t,se=>N(se)),[C,E]=w.useState(null),[k,P]=w.useState(null),A=s_(r),[O,I]=w.useState(!1),R=w.useRef(!1);w.useEffect(()=>{if(b)return Uj(b)},[b]),Bj();const M=w.useCallback(se=>{const[ye,...ne]=A().map(K=>K.ref.current),[le]=ne.slice(-1),ve=document.activeElement;for(const K of se)if(K===ve||(K==null||K.scrollIntoView({block:"nearest"}),K===ye&&j&&(j.scrollTop=0),K===le&&j&&(j.scrollTop=j.scrollHeight),K==null||K.focus(),document.activeElement!==ve))return},[A,j]),B=w.useCallback(()=>M([C,b]),[M,C,b]);w.useEffect(()=>{O&&B()},[O,B]);const{onOpenChange:$,triggerPointerDownPosRef:D}=y;w.useEffect(()=>{if(b){let se={x:0,y:0};const ye=le=>{var ve,K;se={x:Math.abs(Math.round(le.pageX)-(((ve=D.current)==null?void 0:ve.x)??0)),y:Math.abs(Math.round(le.pageY)-(((K=D.current)==null?void 0:K.y)??0))}},ne=le=>{se.x<=10&&se.y<=10?le.preventDefault():b.contains(le.target)||$(!1),document.removeEventListener("pointermove",ye),D.current=null};return D.current!==null&&(document.addEventListener("pointermove",ye),document.addEventListener("pointerup",ne,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ye),document.removeEventListener("pointerup",ne,{capture:!0})}}},[b,$,D]),w.useEffect(()=>{const se=()=>$(!1);return window.addEventListener("blur",se),window.addEventListener("resize",se),()=>{window.removeEventListener("blur",se),window.removeEventListener("resize",se)}},[$]);const[W,Z]=kZ(se=>{const ye=A().filter(ve=>!ve.disabled),ne=ye.find(ve=>ve.ref.current===document.activeElement),le=AZ(ye,se,ne);le&&setTimeout(()=>le.ref.current.focus())}),U=w.useCallback((se,ye,ne)=>{const le=!R.current&&!ne;(y.value!==void 0&&y.value===ye||le)&&(E(se),le&&(R.current=!0))},[y.value]),Y=w.useCallback(()=>b==null?void 0:b.focus(),[b]),ae=w.useCallback((se,ye,ne)=>{const le=!R.current&&!ne;(y.value!==void 0&&y.value===ye||le)&&P(se)},[y.value]),ie=n==="popper"?SA:hZ,he=ie===SA?{side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:p,sticky:m,hideWhenDetached:v,avoidCollisions:g}:{};return s.jsx(uZ,{scope:r,content:b,viewport:j,onViewportChange:_,itemRefCallback:U,selectedItem:C,onItemLeave:Y,itemTextRefCallback:ae,focusSelectedItem:B,selectedItemText:k,position:n,isPositioned:O,searchRef:W,children:s.jsx(Vx,{as:s9e,allowPinchZoom:!0,children:s.jsx(Bx,{asChild:!0,trapped:y.open,onMountAutoFocus:se=>{se.preventDefault()},onUnmountAutoFocus:Ne(a,se=>{var ye;(ye=y.trigger)==null||ye.focus({preventScroll:!0}),se.preventDefault()}),children:s.jsx(Yd,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:se=>se.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:s.jsx(ie,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:se=>se.preventDefault(),...x,...he,onPlaced:()=>I(!0),ref:S,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:Ne(x.onKeyDown,se=>{const ye=se.ctrlKey||se.altKey||se.metaKey;if(se.key==="Tab"&&se.preventDefault(),!ye&&se.key.length===1&&Z(se.key),["ArrowUp","ArrowDown","Home","End"].includes(se.key)){let le=A().filter(ve=>!ve.disabled).map(ve=>ve.ref.current);if(["ArrowUp","End"].includes(se.key)&&(le=le.slice().reverse()),["ArrowUp","ArrowDown"].includes(se.key)){const ve=se.target,K=le.indexOf(ve);le=le.slice(K+1)}setTimeout(()=>M(le)),se.preventDefault()}})})})})})})});dZ.displayName=a9e;var i9e="SelectItemAlignedPosition",hZ=w.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=e,i=Nu(Wd,r),o=_u(Wd,r),[l,c]=w.useState(null),[u,d]=w.useState(null),h=ct(t,S=>d(S)),f=s_(r),p=w.useRef(!1),m=w.useRef(!0),{viewport:v,selectedItem:g,selectedItemText:x,focusSelectedItem:y}=o,b=w.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&u&&v&&g&&x){const S=i.trigger.getBoundingClientRect(),C=u.getBoundingClientRect(),E=i.valueNode.getBoundingClientRect(),k=x.getBoundingClientRect();if(i.dir!=="rtl"){const ve=k.left-C.left,K=E.left-ve,ke=S.left-K,Ce=S.width+ke,Ge=Math.max(Ce,C.width),He=window.innerWidth-wi,It=_A(K,[wi,Math.max(wi,He-Ge)]);l.style.minWidth=Ce+"px",l.style.left=It+"px"}else{const ve=C.right-k.right,K=window.innerWidth-E.right-ve,ke=window.innerWidth-S.right-K,Ce=S.width+ke,Ge=Math.max(Ce,C.width),He=window.innerWidth-wi,It=_A(K,[wi,Math.max(wi,He-Ge)]);l.style.minWidth=Ce+"px",l.style.right=It+"px"}const P=f(),A=window.innerHeight-wi*2,O=v.scrollHeight,I=window.getComputedStyle(u),R=parseInt(I.borderTopWidth,10),M=parseInt(I.paddingTop,10),B=parseInt(I.borderBottomWidth,10),$=parseInt(I.paddingBottom,10),D=R+M+O+$+B,W=Math.min(g.offsetHeight*5,D),Z=window.getComputedStyle(v),U=parseInt(Z.paddingTop,10),Y=parseInt(Z.paddingBottom,10),ae=S.top+S.height/2-wi,ie=A-ae,he=g.offsetHeight/2,se=g.offsetTop+he,ye=R+M+se,ne=D-ye;if(ye<=ae){const ve=P.length>0&&g===P[P.length-1].ref.current;l.style.bottom="0px";const K=u.clientHeight-v.offsetTop-v.offsetHeight,ke=Math.max(ie,he+(ve?Y:0)+K+B),Ce=ye+ke;l.style.height=Ce+"px"}else{const ve=P.length>0&&g===P[0].ref.current;l.style.top="0px";const ke=Math.max(ae,R+v.offsetTop+(ve?U:0)+he)+ne;l.style.height=ke+"px",v.scrollTop=ye-ae+v.offsetTop}l.style.margin=`${wi}px 0`,l.style.minHeight=W+"px",l.style.maxHeight=A+"px",n==null||n(),requestAnimationFrame(()=>p.current=!0)}},[f,i.trigger,i.valueNode,l,u,v,g,x,i.dir,n]);Xr(()=>b(),[b]);const[N,j]=w.useState();Xr(()=>{u&&j(window.getComputedStyle(u).zIndex)},[u]);const _=w.useCallback(S=>{S&&m.current===!0&&(b(),y==null||y(),m.current=!1)},[b,y]);return s.jsx(l9e,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:p,onScrollButtonChange:_,children:s.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:N},children:s.jsx(Me.div,{...a,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});hZ.displayName=i9e;var o9e="SelectPopperPosition",SA=w.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=wi,...i}=e,o=i_(r);return s.jsx(pj,{...o,...i,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});SA.displayName=o9e;var[l9e,zI]=jm(Wd,{}),CA="SelectViewport",fZ=w.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...a}=e,i=_u(CA,r),o=zI(CA,r),l=ct(t,i.onViewportChange),c=w.useRef(0);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),s.jsx(a_.Slot,{scope:r,children:s.jsx(Me.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Ne(a.onScroll,u=>{const d=u.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:f}=o;if(f!=null&&f.current&&h){const p=Math.abs(c.current-d.scrollTop);if(p>0){const m=window.innerHeight-wi*2,v=parseFloat(h.style.minHeight),g=parseFloat(h.style.height),x=Math.max(v,g);if(x<m){const y=x+p,b=Math.min(m,y),N=y-b;h.style.height=b+"px",h.style.bottom==="0px"&&(d.scrollTop=N>0?N:0,h.style.justifyContent="flex-end")}}}c.current=d.scrollTop})})})]})});fZ.displayName=CA;var pZ="SelectGroup",[c9e,u9e]=jm(pZ),d9e=w.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=pn();return s.jsx(c9e,{scope:r,id:a,children:s.jsx(Me.div,{role:"group","aria-labelledby":a,...n,ref:t})})});d9e.displayName=pZ;var mZ="SelectLabel",vZ=w.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=u9e(mZ,r);return s.jsx(Me.div,{id:a.id,...n,ref:t})});vZ.displayName=mZ;var A1="SelectItem",[h9e,gZ]=jm(A1),xZ=w.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:i,...o}=e,l=Nu(A1,r),c=_u(A1,r),u=l.value===n,[d,h]=w.useState(i??""),[f,p]=w.useState(!1),m=ct(t,y=>{var b;return(b=c.itemRefCallback)==null?void 0:b.call(c,y,n,a)}),v=pn(),g=w.useRef("touch"),x=()=>{a||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return s.jsx(h9e,{scope:r,value:n,disabled:a,textId:v,isSelected:u,onItemTextChange:w.useCallback(y=>{h(b=>b||((y==null?void 0:y.textContent)??"").trim())},[]),children:s.jsx(a_.ItemSlot,{scope:r,value:n,disabled:a,textValue:d,children:s.jsx(Me.div,{role:"option","aria-labelledby":v,"data-highlighted":f?"":void 0,"aria-selected":u&&f,"data-state":u?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...o,ref:m,onFocus:Ne(o.onFocus,()=>p(!0)),onBlur:Ne(o.onBlur,()=>p(!1)),onClick:Ne(o.onClick,()=>{g.current!=="mouse"&&x()}),onPointerUp:Ne(o.onPointerUp,()=>{g.current==="mouse"&&x()}),onPointerDown:Ne(o.onPointerDown,y=>{g.current=y.pointerType}),onPointerMove:Ne(o.onPointerMove,y=>{var b;g.current=y.pointerType,a?(b=c.onItemLeave)==null||b.call(c):g.current==="mouse"&&y.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ne(o.onPointerLeave,y=>{var b;y.currentTarget===document.activeElement&&((b=c.onItemLeave)==null||b.call(c))}),onKeyDown:Ne(o.onKeyDown,y=>{var N;((N=c.searchRef)==null?void 0:N.current)!==""&&y.key===" "||(QHe.includes(y.key)&&x(),y.key===" "&&y.preventDefault())})})})})});xZ.displayName=A1;var fv="SelectItemText",yZ=w.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,...i}=e,o=Nu(fv,r),l=_u(fv,r),c=gZ(fv,r),u=t9e(fv,r),[d,h]=w.useState(null),f=ct(t,x=>h(x),c.onItemTextChange,x=>{var y;return(y=l.itemTextRefCallback)==null?void 0:y.call(l,x,c.value,c.disabled)}),p=d==null?void 0:d.textContent,m=w.useMemo(()=>s.jsx("option",{value:c.value,disabled:c.disabled,children:p},c.value),[c.disabled,c.value,p]),{onNativeOptionAdd:v,onNativeOptionRemove:g}=u;return Xr(()=>(v(m),()=>g(m)),[v,g,m]),s.jsxs(s.Fragment,{children:[s.jsx(Me.span,{id:c.textId,...i,ref:f}),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?ei.createPortal(i.children,o.valueNode):null]})});yZ.displayName=fv;var bZ="SelectItemIndicator",wZ=w.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return gZ(bZ,r).isSelected?s.jsx(Me.span,{"aria-hidden":!0,...n,ref:t}):null});wZ.displayName=bZ;var EA="SelectScrollUpButton",jZ=w.forwardRef((e,t)=>{const r=_u(EA,e.__scopeSelect),n=zI(EA,e.__scopeSelect),[a,i]=w.useState(!1),o=ct(t,n.onScrollButtonChange);return Xr(()=>{if(r.viewport&&r.isPositioned){let l=function(){const u=c.scrollTop>0;i(u)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?s.jsx(_Z,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});jZ.displayName=EA;var kA="SelectScrollDownButton",NZ=w.forwardRef((e,t)=>{const r=_u(kA,e.__scopeSelect),n=zI(kA,e.__scopeSelect),[a,i]=w.useState(!1),o=ct(t,n.onScrollButtonChange);return Xr(()=>{if(r.viewport&&r.isPositioned){let l=function(){const u=c.scrollHeight-c.clientHeight,d=Math.ceil(c.scrollTop)<u;i(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?s.jsx(_Z,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});NZ.displayName=kA;var _Z=w.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=e,i=_u("SelectScrollButton",r),o=w.useRef(null),l=s_(r),c=w.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return w.useEffect(()=>()=>c(),[c]),Xr(()=>{var d;const u=l().find(h=>h.ref.current===document.activeElement);(d=u==null?void 0:u.ref.current)==null||d.scrollIntoView({block:"nearest"})},[l]),s.jsx(Me.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:Ne(a.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(n,50))}),onPointerMove:Ne(a.onPointerMove,()=>{var u;(u=i.onItemLeave)==null||u.call(i),o.current===null&&(o.current=window.setInterval(n,50))}),onPointerLeave:Ne(a.onPointerLeave,()=>{c()})})}),f9e="SelectSeparator",SZ=w.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return s.jsx(Me.div,{"aria-hidden":!0,...n,ref:t})});SZ.displayName=f9e;var AA="SelectArrow",p9e=w.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=i_(r),i=Nu(AA,r),o=_u(AA,r);return i.open&&o.position==="popper"?s.jsx(mj,{...a,...n,ref:t}):null});p9e.displayName=AA;var m9e="SelectBubbleInput",CZ=w.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const a=w.useRef(null),i=ct(n,a),o=sN(t);return w.useEffect(()=>{const l=a.current;if(!l)return;const c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==t&&d){const h=new Event("change",{bubbles:!0});d.call(l,t),l.dispatchEvent(h)}},[o,t]),s.jsx(Me.select,{...r,style:{...TV,...r.style},ref:i,defaultValue:t})});CZ.displayName=m9e;function EZ(e){return e===""||e===void 0}function kZ(e){const t=Yr(e),r=w.useRef(""),n=w.useRef(0),a=w.useCallback(o=>{const l=r.current+o;t(l),function c(u){r.current=u,window.clearTimeout(n.current),u!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),i=w.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return w.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,i]}function AZ(e,t,r){const a=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=v9e(e,Math.max(i,0));a.length===1&&(o=o.filter(u=>u!==r));const c=o.find(u=>u.textValue.toLowerCase().startsWith(a.toLowerCase()));return c!==r?c:void 0}function v9e(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var g9e=rZ,PZ=aZ,x9e=iZ,y9e=oZ,b9e=lZ,TZ=cZ,w9e=fZ,RZ=vZ,OZ=xZ,j9e=yZ,N9e=wZ,IZ=jZ,DZ=NZ,MZ=SZ;const At=g9e,Pt=x9e,_t=w.forwardRef(({className:e,children:t,...r},n)=>s.jsxs(PZ,{ref:n,className:me("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,s.jsx(y9e,{asChild:!0,children:s.jsx(Lc,{className:"h-4 w-4 opacity-50"})})]}));_t.displayName=PZ.displayName;const $Z=w.forwardRef(({className:e,...t},r)=>s.jsx(IZ,{ref:r,className:me("flex cursor-default items-center justify-center py-1",e),...t,children:s.jsx(Sv,{className:"h-4 w-4"})}));$Z.displayName=IZ.displayName;const FZ=w.forwardRef(({className:e,...t},r)=>s.jsx(DZ,{ref:r,className:me("flex cursor-default items-center justify-center py-1",e),...t,children:s.jsx(Lc,{className:"h-4 w-4"})}));FZ.displayName=DZ.displayName;const St=w.forwardRef(({className:e,children:t,position:r="popper",...n},a)=>s.jsx(b9e,{children:s.jsxs(TZ,{ref:a,className:me("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[s.jsx($Z,{}),s.jsx(w9e,{className:me("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),s.jsx(FZ,{})]})}));St.displayName=TZ.displayName;const _9e=w.forwardRef(({className:e,...t},r)=>s.jsx(RZ,{ref:r,className:me("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));_9e.displayName=RZ.displayName;const re=w.forwardRef(({className:e,children:t,...r},n)=>s.jsxs(OZ,{ref:n,className:me("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(N9e,{children:s.jsx($t,{className:"h-4 w-4"})})}),s.jsx(j9e,{children:t})]}));re.displayName=OZ.displayName;const S9e=w.forwardRef(({className:e,...t},r)=>s.jsx(MZ,{ref:r,className:me("-mx-1 my-1 h-px bg-muted",e),...t}));S9e.displayName=MZ.displayName;function C9e(){const e=Oe(),[t,r]=w.useState("promotional"),[n,a]=w.useState("1"),[i,o]=w.useState("10"),[l,c]=w.useState([]),u={founding_council:"FC",first_movers:"FM",early_access:"EA",promotional:"PR"},d={founding_council:"Founding Council (FC)",first_movers:"First Movers (FM)",early_access:"Early Access (EA)",promotional:"Promotional (PR)"},h=()=>{const v=u[t],g=parseInt(n),x=parseInt(i);if(isNaN(g)||isNaN(x)||g<1||x<1||x>1e3){H.error("Invalid input. Start number must be 1 and count between 1-1000");return}const y=[];for(let b=0;b<x;b++){const N=g+b,j=`${v}${N.toString().padStart(4,"0")}`;y.push({code:j,tier:t,prefix:v,number:N})}c(y),H.success(`Generated ${x} coupon codes`)},f=v=>{navigator.clipboard.writeText(v),H.success("Copied to clipboard")},p=()=>{const v=l.map(g=>g.code).join(`
`);navigator.clipboard.writeText(v),H.success(`Copied ${l.length} codes to clipboard`)},m=()=>{const v=["Code,Tier,Prefix,Number",...l.map(b=>`${b.code},${b.tier},${b.prefix},${b.number}`)].join(`
`),g=new Blob([v],{type:"text/csv"}),x=window.URL.createObjectURL(g),y=document.createElement("a");y.href=x,y.download=`vairify-coupons-${u[t]}-${Date.now()}.csv`,y.click(),window.URL.revokeObjectURL(x),H.success("Downloaded CSV file")};return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 flex items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/admin"),children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Coupon Code Generator"}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"Create promotional and founding member codes"})]})]})}),s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8 space-y-8",children:[s.jsxs(q,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx(hT,{className:"w-6 h-6 text-primary"}),s.jsx("h2",{className:"text-2xl font-bold",children:"Generate Codes"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"tier",children:"Tier Type"}),s.jsxs(At,{value:t,onValueChange:v=>r(v),children:[s.jsx(_t,{id:"tier",children:s.jsx(Pt,{})}),s.jsxs(St,{children:[s.jsx(re,{value:"founding_council",children:d.founding_council}),s.jsx(re,{value:"first_movers",children:d.first_movers}),s.jsx(re,{value:"early_access",children:d.early_access}),s.jsx(re,{value:"promotional",children:d.promotional})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"startNumber",children:"Start Number"}),s.jsx(De,{id:"startNumber",type:"number",min:"1",value:n,onChange:v=>a(v.target.value),placeholder:"1"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"count",children:"Count (max 1000)"}),s.jsx(De,{id:"count",type:"number",min:"1",max:"1000",value:i,onChange:v=>o(v.target.value),placeholder:"10"})]})]}),s.jsx(L,{onClick:h,className:"w-full",children:"Generate Codes"})]})]}),l.length>0&&s.jsxs(q,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-xl font-bold",children:["Generated Codes (",l.length,")"]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(L,{variant:"outline",size:"sm",onClick:p,children:[s.jsx(sg,{className:"w-4 h-4 mr-2"}),"Copy All"]}),s.jsxs(L,{variant:"outline",size:"sm",onClick:m,children:[s.jsx(uT,{className:"w-4 h-4 mr-2"}),"Download CSV"]})]})]}),s.jsx("div",{className:"max-h-[400px] overflow-y-auto space-y-2",children:l.map((v,g)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg hover:bg-muted transition-colors",children:[s.jsx("code",{className:"font-mono font-bold text-lg",children:v.code}),s.jsx(L,{variant:"ghost",size:"sm",onClick:()=>f(v.code),children:s.jsx(sg,{className:"w-4 h-4"})})]},g))})]}),s.jsxs(q,{className:"p-6 bg-muted/30",children:[s.jsx("h3",{className:"font-bold mb-3",children:"Coupon Code Formats"}),s.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"FC####"})," - Founding Council (Free lifetime premium)"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"FM####"})," - First Movers (Free 2 years)"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"EA####"})," - Early Access (Free 1 year)"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"PR####"})," - Promotional codes (custom discounts)"]})]})]})]})]})}function E9e(){const e=Oe(),{isAdmin:t,loading:r}=dh(),[n,a]=w.useState([]),[i,o]=w.useState(!0),[l,c]=w.useState("");w.useEffect(()=>{!r&&!t&&e("/feed")},[t,r,e]),w.useEffect(()=>{t&&u()},[t]);const u=async()=>{try{const{data:f}=await T.from("profiles").select("*").order("created_at",{ascending:!1});if(f){const p=await Promise.all(f.map(async m=>{const{data:v}=await T.from("user_roles").select("role").eq("user_id",m.id);return{...m,roles:(v==null?void 0:v.map(g=>g.role))||[]}}));a(p)}}catch(f){console.error("Error loading users:",f),H.error("Failed to load users")}finally{o(!1)}},d=async(f,p)=>{var m;try{const v=n.find(x=>x.id===f),g=(m=v==null?void 0:v.roles)==null?void 0:m.includes(p);g?await T.from("user_roles").delete().eq("user_id",f).eq("role",p):await T.from("user_roles").insert({user_id:f,role:p}),H.success(g?`Removed ${p} role`:`Granted ${p} role`),u()}catch(v){console.error("Error toggling role:",v),H.error("Failed to update role")}},h=n.filter(f=>{var p,m;return((p=f.email)==null?void 0:p.toLowerCase().includes(l.toLowerCase()))||((m=f.full_name)==null?void 0:m.toLowerCase().includes(l.toLowerCase()))});return r||i?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):t?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center gap-4",children:[s.jsx("button",{onClick:()=>e("/admin"),className:"p-2 hover:bg-accent rounded-full",children:s.jsx(ze,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"User Management"}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[n.length," total users"]})]})]})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6",children:[s.jsx(q,{className:"p-4",children:s.jsxs("div",{className:"relative",children:[s.jsx(Cl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-muted-foreground"}),s.jsx(De,{placeholder:"Search by email or name...",value:l,onChange:f=>c(f.target.value),className:"pl-10"})]})}),s.jsxs("div",{className:"space-y-4",children:[h.map(f=>{var p,m,v,g,x;return s.jsx(q,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:s.jsx(fn,{className:"w-6 h-6 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:f.full_name||"No name"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:f.email})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[s.jsx(xe,{variant:"outline",children:f.subscription_status||"free"}),(p=f.roles)==null?void 0:p.map(y=>s.jsxs(xe,{className:y==="admin"?"bg-destructive text-destructive-foreground":"bg-warning text-warning-foreground",children:[y==="admin"?s.jsx(zi,{className:"w-3 h-3 mr-1"}):s.jsx(lt,{className:"w-3 h-3 mr-1"}),y]},y))]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Joined: ",new Date(f.created_at).toLocaleDateString()]})]}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx(L,{variant:(m=f.roles)!=null&&m.includes("admin")?"destructive":"outline",size:"sm",onClick:()=>d(f.id,"admin"),children:(v=f.roles)!=null&&v.includes("admin")?"Remove Admin":"Make Admin"}),s.jsx(L,{variant:(g=f.roles)!=null&&g.includes("moderator")?"default":"outline",size:"sm",onClick:()=>d(f.id,"moderator"),children:(x=f.roles)!=null&&x.includes("moderator")?"Remove Mod":"Make Mod"})]})]})},f.id)}),h.length===0&&s.jsx(q,{className:"p-12 text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"No users found"})})]})]})]}):null}function k9e(){const e=Oe(),{isAdmin:t,loading:r}=dh(),[n,a]=w.useState(null),[i,o]=w.useState([]),[l,c]=w.useState([]),[u,d]=w.useState([]),[h,f]=w.useState(!0);w.useEffect(()=>{!r&&!t&&e("/feed")},[t,r,e]),w.useEffect(()=>{t&&p()},[t]);const p=async()=>{var m,v,g,x;try{const[y,b,N]=await Promise.all([T.from("referrals").select("*").order("created_at",{ascending:!1}),T.from("referral_earnings").select("*").order("created_at",{ascending:!1}),T.from("referral_payouts").select("*").order("payout_date",{ascending:!1})]);o(y.data||[]),c(b.data||[]),d(N.data||[]);const j=((m=y.data)==null?void 0:m.length)||0,_=((v=y.data)==null?void 0:v.filter(E=>E.subscription_status==="premium").length)||0,S=((g=b.data)==null?void 0:g.reduce((E,k)=>E+parseFloat(k.amount.toString()),0))||0,C=((x=N.data)==null?void 0:x.reduce((E,k)=>E+parseFloat(k.amount.toString()),0))||0;a({totalReferrals:j,premiumReferrals:_,totalEarnings:S,totalPayouts:C})}catch(y){console.error("Error loading referral data:",y)}finally{f(!1)}};return r||h?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):t?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center gap-4",children:[s.jsx("button",{onClick:()=>e("/admin"),className:"p-2 hover:bg-accent rounded-full",children:s.jsx(ze,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-2xl font-bold",children:"Referral System Management"})]})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(q,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(An,{className:"w-8 h-8 text-primary"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Referrals"}),s.jsx("p",{className:"text-2xl font-bold",children:n==null?void 0:n.totalReferrals})]})]})}),s.jsx(q,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(en,{className:"w-8 h-8 text-success"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Premium Referrals"}),s.jsx("p",{className:"text-2xl font-bold",children:n==null?void 0:n.premiumReferrals})]})]})}),s.jsx(q,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Wi,{className:"w-8 h-8 text-success"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Earnings"}),s.jsxs("p",{className:"text-2xl font-bold",children:["$",n==null?void 0:n.totalEarnings.toFixed(2)]})]})]})}),s.jsx(q,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Wi,{className:"w-8 h-8 text-warning"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Payouts"}),s.jsxs("p",{className:"text-2xl font-bold",children:["$",n==null?void 0:n.totalPayouts.toFixed(2)]})]})]})})]}),s.jsx(q,{className:"p-6",children:s.jsxs(Ga,{defaultValue:"referrals",children:[s.jsxs(Aa,{className:"grid w-full grid-cols-3",children:[s.jsxs(mt,{value:"referrals",children:["Referrals (",i.length,")"]}),s.jsxs(mt,{value:"earnings",children:["Earnings (",l.length,")"]}),s.jsxs(mt,{value:"payouts",children:["Payouts (",u.length,")"]})]}),s.jsx(Rt,{value:"referrals",className:"space-y-4 mt-4",children:i.map(m=>s.jsx(q,{className:"p-4",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"font-semibold",children:["Referral ID: ",m.id.slice(0,8),"..."]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Status: ",m.subscription_status]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Created: ",new Date(m.created_at).toLocaleDateString()]})]}),m.upgraded_to_premium_at&&s.jsxs("p",{className:"text-xs text-success",children:["Upgraded: ",new Date(m.upgraded_to_premium_at).toLocaleDateString()]})]})},m.id))}),s.jsx(Rt,{value:"earnings",className:"space-y-4 mt-4",children:l.map(m=>s.jsx(q,{className:"p-4",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"font-semibold text-success",children:["$",parseFloat(m.amount.toString()).toFixed(2)]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Month: ",m.month_year]})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(m.created_at).toLocaleDateString()})]})},m.id))}),s.jsx(Rt,{value:"payouts",className:"space-y-4 mt-4",children:u.map(m=>s.jsx(q,{className:"p-4",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"font-semibold text-success",children:["$",parseFloat(m.amount.toString()).toFixed(2)]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Status: ",m.status]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Method: ",m.payment_method]})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(m.payout_date).toLocaleDateString()})]})},m.id))})]})})]})]}):null}function A9e(){const[e,t]=w.useState([]),[r,n]=w.useState([]),[a,i]=w.useState([]),[o,l]=w.useState(!0),{toast:c}=Et(),u=async()=>{try{l(!0);const{data:p}=await T.from("emergency_events").select("*").order("triggered_at",{ascending:!1}).limit(20),{data:m}=await T.from("dateguard_sessions").select("*").eq("status","emergency").order("created_at",{ascending:!1}).limit(10),v=[...(p||[]).map(y=>({id:y.id,timestamp:new Date(y.triggered_at).getTime(),severity:"ERROR",message:`Emergency triggered: ${y.trigger_type} - ${y.location_address||"Unknown location"}`,source:"Emergency System"})),...(m||[]).map(y=>({id:y.id,timestamp:new Date(y.created_at).getTime(),severity:"WARNING",message:`Emergency DateGuard session at ${y.location_name}`,source:"DateGuard"}))].sort((y,b)=>b.timestamp-y.timestamp);t(v);const g=[{endpoint:"/api/users",method:"GET",status:200,duration:45,timestamp:Date.now()},{endpoint:"/api/profiles",method:"POST",status:201,duration:120,timestamp:Date.now()-5e3},{endpoint:"/api/vai-verification",method:"POST",status:200,duration:340,timestamp:Date.now()-1e4},{endpoint:"/api/emergency-alert",method:"POST",status:200,duration:78,timestamp:Date.now()-15e3}];n(g);const x=[{query_type:"SELECT",table_name:"vai_verifications",duration:12,timestamp:Date.now()},{query_type:"INSERT",table_name:"emergency_events",duration:8,timestamp:Date.now()-3e3},{query_type:"UPDATE",table_name:"dateguard_sessions",duration:15,timestamp:Date.now()-7e3},{query_type:"SELECT",table_name:"provider_profiles",duration:23,timestamp:Date.now()-12e3}];i(x)}catch(p){console.error("Error fetching system data:",p),c({title:"Error Loading Data",description:"Failed to fetch system monitoring data",variant:"destructive"})}finally{l(!1)}};w.useEffect(()=>{u();const p=setInterval(u,1e4);return()=>clearInterval(p)},[]);const d=p=>{switch(p.toUpperCase()){case"ERROR":case"FATAL":return"destructive";case"WARNING":case"WARN":return"default";default:return"secondary"}},h=p=>p>=200&&p<300?"default":p>=400&&p<500?"secondary":p>=500?"destructive":"outline",f=p=>new Date(p).toLocaleTimeString();return s.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold mb-2",children:"System Monitor"}),s.jsx("p",{className:"text-muted-foreground",children:"Real-time tracking of errors, network, and database activity"})]}),s.jsxs(L,{onClick:u,disabled:o,children:[s.jsx(ij,{className:`mr-2 h-4 w-4 ${o?"animate-spin":""}`}),"Refresh"]})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[s.jsxs(q,{children:[s.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(be,{className:"text-sm font-medium",children:"Total Errors"}),s.jsx(tn,{className:"h-4 w-4 text-destructive"})]}),s.jsxs(ee,{children:[s.jsx("div",{className:"text-2xl font-bold",children:e.filter(p=>p.severity==="ERROR").length}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Last hour"})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(be,{className:"text-sm font-medium",children:"Network Requests"}),s.jsx(RD,{className:"h-4 w-4 text-primary"})]}),s.jsxs(ee,{children:[s.jsx("div",{className:"text-2xl font-bold",children:r.length}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Active connections"})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(be,{className:"text-sm font-medium",children:"DB Queries"}),s.jsx(kC,{className:"h-4 w-4 text-accent"})]}),s.jsxs(ee,{children:[s.jsx("div",{className:"text-2xl font-bold",children:a.length}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Last 10 minutes"})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(be,{className:"text-sm font-medium",children:"Avg Response Time"}),s.jsx(JV,{className:"h-4 w-4 text-secondary"})]}),s.jsxs(ee,{children:[s.jsxs("div",{className:"text-2xl font-bold",children:[r.length>0?Math.round(r.reduce((p,m)=>p+m.duration,0)/r.length):0,"ms"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Network latency"})]})]})]}),s.jsxs(Ga,{defaultValue:"errors",className:"space-y-4",children:[s.jsxs(Aa,{children:[s.jsxs(mt,{value:"errors",children:[s.jsx(tn,{className:"mr-2 h-4 w-4"}),"Error Logs"]}),s.jsxs(mt,{value:"network",children:[s.jsx(RD,{className:"mr-2 h-4 w-4"}),"Network Activity"]}),s.jsxs(mt,{value:"database",children:[s.jsx(kC,{className:"mr-2 h-4 w-4"}),"Database Activity"]})]}),s.jsx(Rt,{value:"errors",className:"space-y-4",children:s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Recent Error Logs"}),s.jsx(Re,{children:"System errors and warnings from all sources"})]}),s.jsx(ee,{children:s.jsx(yl,{className:"h-[500px] w-full",children:s.jsx("div",{className:"space-y-2",children:e.length===0?s.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No errors logged"}):e.map(p=>s.jsx("div",{className:"flex items-start justify-between border-b pb-2",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(xe,{variant:d(p.severity),children:p.severity}),s.jsx("span",{className:"text-xs text-muted-foreground",children:f(p.timestamp)}),s.jsx(xe,{variant:"outline",children:p.source})]}),s.jsx("p",{className:"text-sm font-mono",children:p.message})]})},p.id))})})})]})}),s.jsx(Rt,{value:"network",className:"space-y-4",children:s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Network Request Monitor"}),s.jsx(Re,{children:"Recent API calls and response times"})]}),s.jsx(ee,{children:s.jsx(yl,{className:"h-[500px] w-full",children:s.jsx("div",{className:"space-y-2",children:r.map((p,m)=>s.jsx("div",{className:"flex items-center justify-between border-b pb-2",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(xe,{variant:"outline",children:p.method}),s.jsx("span",{className:"font-mono text-sm",children:p.endpoint})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(xe,{variant:h(p.status),children:p.status}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[p.duration,"ms  ",f(p.timestamp)]})]})]})},m))})})})]})}),s.jsx(Rt,{value:"database",className:"space-y-4",children:s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Database Query Monitor"}),s.jsx(Re,{children:"Recent database operations and performance"})]}),s.jsx(ee,{children:s.jsx(yl,{className:"h-[500px] w-full",children:s.jsx("div",{className:"space-y-2",children:a.map((p,m)=>s.jsx("div",{className:"flex items-center justify-between border-b pb-2",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(xe,{variant:"outline",children:p.query_type}),s.jsx("span",{className:"font-mono text-sm",children:p.table_name})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("span",{className:"text-xs text-muted-foreground",children:[p.duration,"ms  ",f(p.timestamp)]})})]})},m))})})})]})})]})]})}function P9e(){const e=Oe(),{isAdmin:t,loading:r}=dh(),[n,a]=w.useState([]),[i,o]=w.useState([]),[l,c]=w.useState(!0),[u,d]=w.useState({});w.useEffect(()=>{!r&&!t&&e("/feed")},[t,r,e]),w.useEffect(()=>{t&&(h(),f())},[t]);const h=async()=>{const{data:y,error:b}=await T.from("influencer_applications").select(`
        *,
        profiles(full_name, email)
      `).order("applied_at",{ascending:!1});!b&&y&&a(y),c(!1)},f=async()=>{const{data:y}=await T.from("profiles").select("id, full_name, email, subscription_status, created_at"),{data:b}=await T.from("user_roles").select("user_id, role"),{data:N}=await T.from("founding_council_members").select("user_id");if(y&&b){const j=new Set((N==null?void 0:N.map(C=>C.user_id))||[]),_=new Set(b.filter(C=>C.role==="influencer"||C.role==="affiliate").map(C=>C.user_id)),S=y.filter(C=>_.has(C.id)).map(C=>({...C,is_founding_council:j.has(C.id),user_roles:b.filter(E=>E.user_id===C.id)}));o(S)}},p=async(y,b,N)=>{var S;const{error:j}=await T.from("user_roles").insert([{user_id:b,role:N}]);if(j){H.error("Failed to assign role");return}const{error:_}=await T.from("influencer_applications").update({status:"approved",reviewed_at:new Date().toISOString(),reviewed_by:(S=(await T.auth.getUser()).data.user)==null?void 0:S.id,admin_notes:u[y]||null}).eq("id",y);if(_){H.error("Failed to update application");return}T.functions.invoke("notify-application-status",{body:{user_id:b,application_type:N,status:"approved",admin_notes:u[y]||null}}).then(({error:C})=>{C&&console.error("Failed to send notification email:",C)}),H.success("Application approved and user notified"),h(),f()},m=async(y,b,N)=>{var _;const{error:j}=await T.from("influencer_applications").update({status:"rejected",reviewed_at:new Date().toISOString(),reviewed_by:(_=(await T.auth.getUser()).data.user)==null?void 0:_.id,admin_notes:u[y]||null}).eq("id",y);if(j){H.error("Failed to reject application");return}T.functions.invoke("notify-application-status",{body:{user_id:b,application_type:N,status:"rejected",admin_notes:u[y]||null}}).then(({error:S})=>{S&&console.error("Failed to send notification email:",S)}),H.success("Application rejected and user notified"),h()},v=async(y,b)=>{if(b){const{error:N}=await T.from("founding_council_members").delete().eq("user_id",y);N?H.error("Failed to remove from Founding Council"):(H.success("Removed from Founding Council"),f())}else{const N=(await T.auth.getUser()).data.user,{error:j}=await T.from("founding_council_members").insert({user_id:y,assigned_by:N==null?void 0:N.id});j?H.error("Failed to add to Founding Council"):(H.success("Added to Founding Council"),f())}};if(r||l)return s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const g=n.filter(y=>y.status==="pending"),x=n.filter(y=>y.status!=="pending");return s.jsx("div",{className:"min-h-screen bg-background p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/admin"),children:s.jsx(ze,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Influencer & Affiliate Management"}),s.jsx("p",{className:"text-muted-foreground",children:"Manage applications and Founding Council"})]})]}),s.jsxs(Ga,{defaultValue:"pending",className:"space-y-6",children:[s.jsxs(Aa,{children:[s.jsxs(mt,{value:"pending",children:["Pending Applications (",g.length,")"]}),s.jsxs(mt,{value:"reviewed",children:["Reviewed (",x.length,")"]}),s.jsxs(mt,{value:"members",children:["Active Members (",i.length,")"]})]}),s.jsx(Rt,{value:"pending",className:"space-y-4",children:g.length===0?s.jsx(q,{className:"p-8 text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"No pending applications"})}):g.map(y=>s.jsxs(q,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg",children:y.profiles.full_name}),s.jsx("p",{className:"text-sm text-muted-foreground",children:y.profiles.email}),s.jsx(xe,{variant:"outline",className:"mt-2",children:y.application_type})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(L,{size:"sm",onClick:()=>p(y.id,y.user_id,y.application_type),children:[s.jsx($t,{className:"h-4 w-4 mr-1"}),"Approve"]}),s.jsxs(L,{size:"sm",variant:"destructive",onClick:()=>m(y.id,y.user_id,y.application_type),children:[s.jsx(vn,{className:"h-4 w-4 mr-1"}),"Reject"]})]})]}),y.audience_size&&s.jsxs("p",{className:"text-sm mb-2",children:[s.jsx("strong",{children:"Audience Size:"})," ",y.audience_size]}),y.application_notes&&s.jsxs("p",{className:"text-sm mb-2",children:[s.jsx("strong",{children:"Notes:"})," ",y.application_notes]}),s.jsx(Mn,{placeholder:"Admin notes (optional)",value:u[y.id]||"",onChange:b=>d({...u,[y.id]:b.target.value}),className:"mt-4"})]},y.id))}),s.jsx(Rt,{value:"reviewed",className:"space-y-4",children:x.map(y=>s.jsx(q,{className:"p-6",children:s.jsx("div",{className:"flex items-start justify-between",children:s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg",children:y.profiles.full_name}),s.jsx("p",{className:"text-sm text-muted-foreground",children:y.profiles.email}),s.jsxs("div",{className:"flex gap-2 mt-2",children:[s.jsx(xe,{variant:"outline",children:y.application_type}),s.jsx(xe,{variant:y.status==="approved"?"default":"destructive",children:y.status})]}),y.admin_notes&&s.jsxs("p",{className:"text-sm mt-2 text-muted-foreground",children:[s.jsx("strong",{children:"Admin Notes:"})," ",y.admin_notes]})]})})},y.id))}),s.jsx(Rt,{value:"members",className:"space-y-4",children:i.map(y=>s.jsx(q,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"font-semibold text-lg",children:y.full_name}),y.is_founding_council&&s.jsx(zi,{className:"h-5 w-5 text-yellow-500"})]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:y.email}),s.jsxs("div",{className:"flex gap-2 mt-2",children:[y.user_roles.map((b,N)=>s.jsx(xe,{variant:"outline",children:b.role},N)),s.jsx(xe,{children:y.subscription_status})]})]}),s.jsx(L,{size:"sm",variant:y.is_founding_council?"destructive":"default",onClick:()=>v(y.id,y.is_founding_council),children:y.is_founding_council?s.jsxs(s.Fragment,{children:[s.jsx(vn,{className:"h-4 w-4 mr-1"}),"Remove from Council"]}):s.jsxs(s.Fragment,{children:[s.jsx(zi,{className:"h-4 w-4 mr-1"}),"Add to Council"]})})]})},y.id))})]})]})})}function T9e(){const[e,t]=w.useState(!1),[r,n]=w.useState({email:"",fullName:"",applicationType:"influencer",status:"approved",adminNotes:""}),a=async()=>{t(!0);try{const{data:{user:o}}=await T.auth.getUser();if(!o){H.error("You must be logged in to test");return}await T.from("profiles").update({email:r.email,full_name:r.fullName}).eq("id",o.id);const{data:l,error:c}=await T.functions.invoke("notify-application-status",{body:{user_id:o.id,application_type:r.applicationType,status:r.status,admin_notes:r.adminNotes||void 0}});if(c)throw c;H.success(`Test email sent to ${r.email}!`),console.log("Email response:",l)}catch(o){console.error("Error sending test email:",o),H.error(o.message||"Failed to send test email")}finally{t(!1)}},i=()=>{const o=r.fullName||"Member",l=r.applicationType==="influencer"?"Influencer":"Affiliate";return r.status==="approved"?`
        <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto;">
          <div style="background: linear-gradient(135deg, #8B5CF6 0%, #EC4899 100%); color: white; padding: 30px; text-align: center; border-radius: 8px 8px 0 0;">
            <h1 style="margin: 0;"> Congratulations!</h1>
          </div>
          <div style="background: white; padding: 30px; border: 1px solid #e5e7eb; border-top: none;">
            <h2>Hi ${o},</h2>
            <p><span style="display: inline-block; background: #10b981; color: white; padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: bold;">APPROVED</span></p>
            <p>Great news! Your application to become a Vairify <strong>${l}</strong> has been approved!</p>
            <p><strong>What's Next?</strong></p>
            <ul>
              <li>Access your referral dashboard to get your unique referral code</li>
              <li>Start sharing Vairify with your audience</li>
              <li>Track your earnings and commissions in real-time</li>
              <li>Enjoy exclusive perks and benefits</li>
            </ul>
            ${r.adminNotes?`<div style="background: #f3f4f6; padding: 15px; border-radius: 6px; margin: 20px 0;"><strong>Note from our team:</strong><br/>${r.adminNotes}</div>`:""}
            <a href="#" style="display: inline-block; background: linear-gradient(135deg, #8B5CF6 0%, #EC4899 100%); color: white; padding: 12px 30px; text-decoration: none; border-radius: 6px; margin: 20px 0;">Go to Dashboard </a>
            <p>Thank you for joining our network. We're excited to work with you!</p>
            <p>Best regards,<br/>The Vairify Team</p>
          </div>
          <div style="text-align: center; padding: 20px; color: #6b7280; font-size: 14px;">
            <p>This is an automated message from Vairify</p>
          </div>
        </div>
      `:`
        <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto;">
          <div style="background: #f3f4f6; color: #374151; padding: 30px; text-align: center; border-radius: 8px 8px 0 0;">
            <h1 style="margin: 0;">Application Update</h1>
          </div>
          <div style="background: white; padding: 30px; border: 1px solid #e5e7eb; border-top: none;">
            <h2>Hi ${o},</h2>
            <p>Thank you for your interest in becoming a Vairify ${l}.</p>
            <p>After careful review, we're unable to approve your application at this time.</p>
            ${r.adminNotes?`<div style="background: #fef3c7; padding: 15px; border-radius: 6px; margin: 20px 0; border-left: 4px solid #f59e0b;"><strong>Feedback:</strong><br/>${r.adminNotes}</div>`:""}
            <p><strong>You can reapply in the future</strong> as your audience grows or your content strategy evolves. We encourage you to:</p>
            <ul>
              <li>Continue growing your audience and engagement</li>
              <li>Build your presence on relevant platforms</li>
              <li>Consider reapplying after 30 days</li>
            </ul>
            <p>In the meantime, you can still use Vairify's standard referral program and earn commissions by inviting friends.</p>
            <a href="#" style="display: inline-block; background: #6366f1; color: white; padding: 12px 30px; text-decoration: none; border-radius: 6px; margin: 20px 0;">View Referral Dashboard</a>
            <p>Thank you for your interest in Vairify.</p>
            <p>Best regards,<br/>The Vairify Team</p>
          </div>
          <div style="text-align: center; padding: 20px; color: #6b7280; font-size: 14px;">
            <p>This is an automated message from Vairify</p>
          </div>
        </div>
      `};return s.jsx("div",{className:"container mx-auto p-6 max-w-5xl",children:s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Email Notification Test"}),s.jsx(Re,{children:"Test the email notification system by sending a sample application status email"})]}),s.jsx(ee,{children:s.jsxs(Ga,{defaultValue:"form",className:"w-full",children:[s.jsxs(Aa,{className:"grid w-full grid-cols-2",children:[s.jsxs(mt,{value:"form",children:[s.jsx(Nx,{className:"w-4 h-4 mr-2"}),"Send Test Email"]}),s.jsxs(mt,{value:"preview",children:[s.jsx(Ri,{className:"w-4 h-4 mr-2"}),"Preview Template"]})]}),s.jsxs(Rt,{value:"form",className:"space-y-4 mt-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"email",children:"Test Email Address"}),s.jsx(De,{id:"email",type:"email",placeholder:"test@example.com",value:r.email,onChange:o=>n({...r,email:o.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"fullName",children:"Full Name"}),s.jsx(De,{id:"fullName",placeholder:"John Doe",value:r.fullName,onChange:o=>n({...r,fullName:o.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"applicationType",children:"Application Type"}),s.jsxs(At,{value:r.applicationType,onValueChange:o=>n({...r,applicationType:o}),children:[s.jsx(_t,{children:s.jsx(Pt,{})}),s.jsxs(St,{children:[s.jsx(re,{value:"influencer",children:"Influencer"}),s.jsx(re,{value:"affiliate",children:"Affiliate"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"status",children:"Status"}),s.jsxs(At,{value:r.status,onValueChange:o=>n({...r,status:o}),children:[s.jsx(_t,{children:s.jsx(Pt,{})}),s.jsxs(St,{children:[s.jsx(re,{value:"approved",children:"Approved"}),s.jsx(re,{value:"rejected",children:"Rejected"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"adminNotes",children:"Admin Notes (Optional)"}),s.jsx(Mn,{id:"adminNotes",placeholder:"Additional notes for the applicant...",value:r.adminNotes,onChange:o=>n({...r,adminNotes:o.target.value}),rows:3})]}),s.jsx(L,{onClick:a,disabled:e||!r.email||!r.fullName,className:"w-full",children:e?"Sending...":"Send Test Email"})]}),s.jsx(Rt,{value:"preview",className:"mt-4",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg border border-border",children:[s.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[s.jsx("strong",{children:"Preview:"})," This is how the email will appear to recipients"]}),s.jsxs("div",{className:"flex gap-2 mb-4",children:[s.jsx(L,{variant:r.status==="approved"?"default":"outline",size:"sm",onClick:()=>n({...r,status:"approved"}),children:"Approved Template"}),s.jsx(L,{variant:r.status==="rejected"?"default":"outline",size:"sm",onClick:()=>n({...r,status:"rejected"}),children:"Rejected Template"})]})]}),s.jsx("div",{className:"bg-white rounded-lg border border-border p-6 overflow-auto",children:s.jsx("div",{dangerouslySetInnerHTML:{__html:i()},className:"email-preview"})}),s.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"To:"})," ",r.email||"test@example.com"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Recipient:"})," ",r.fullName||"Test User"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Application Type:"})," ",r.applicationType==="influencer"?"Influencer":"Affiliate"]}),r.adminNotes&&s.jsxs("p",{children:[s.jsx("strong",{children:"Admin Notes:"})," ",r.adminNotes]})]})]})})]})})]})})}function R9e(){const[e,t]=w.useState([]),[r,n]=w.useState(!1),[a,i]=w.useState(""),[o,l]=w.useState("all"),c=async()=>{n(!0);try{const{data:f,error:p}=await T.functions.invoke("notify-application-status",{method:"GET"}).catch(()=>({data:null,error:null}));H.info("View detailed logs in Lovable Cloud dashboard"),t([])}catch(f){console.error("Error fetching logs:",f),H.error("Failed to fetch logs")}finally{n(!1)}};w.useEffect(()=>{c()},[]);const u=f=>{switch(f==null?void 0:f.toUpperCase()){case"SUCCESS":return"bg-green-500/10 text-green-500 border-green-500/20";case"ERROR":return"bg-red-500/10 text-red-500 border-red-500/20";case"INFO":return"bg-blue-500/10 text-blue-500 border-blue-500/20";default:return"bg-muted text-muted-foreground"}},d=f=>f?f<1e3?`${f}ms`:`${(f/1e3).toFixed(2)}s`:"N/A",h=e.filter(f=>{var v,g;const p=!a||JSON.stringify(f).toLowerCase().includes(a.toLowerCase()),m=o==="all"||((g=(v=f.metadata)==null?void 0:v.level)==null?void 0:g.toLowerCase())===o.toLowerCase();return p&&m});return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Email Notification Logs"}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"Track email sending attempts, successes, and failures"})]}),s.jsxs(L,{onClick:c,disabled:r,children:[s.jsx(ij,{className:`w-4 h-4 mr-2 ${r?"animate-spin":""}`}),"Refresh"]})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[s.jsx(q,{className:"mb-6",children:s.jsx(ee,{className:"pt-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(Cl,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),s.jsx(De,{placeholder:"Search logs...",value:a,onChange:f=>i(f.target.value),className:"pl-10"})]}),s.jsxs(At,{value:o,onValueChange:l,children:[s.jsxs(_t,{className:"w-full md:w-48",children:[s.jsx(AC,{className:"w-4 h-4 mr-2"}),s.jsx(Pt,{placeholder:"Filter by level"})]}),s.jsxs(St,{children:[s.jsx(re,{value:"all",children:"All Levels"}),s.jsx(re,{value:"success",children:"Success"}),s.jsx(re,{value:"error",children:"Error"}),s.jsx(re,{value:"info",children:"Info"})]})]})]})})}),s.jsxs(q,{className:"mb-6 border-blue-500/20 bg-blue-500/5",children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"text-lg flex items-center gap-2",children:[s.jsx(AC,{className:"w-5 h-5 text-blue-500"}),"View Logs in Lovable Cloud"]}),s.jsx(Re,{children:"To view detailed edge function logs with timestamps and structured data:"})]}),s.jsxs(ee,{children:[s.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm",children:[s.jsxs("li",{children:["Navigate to ",s.jsx("strong",{children:"Desktop"}),": Click the Cloud icon in the top navigation bar"]}),s.jsxs("li",{children:["Navigate to ",s.jsx("strong",{children:"Mobile"}),": Tap the Widgets icon in bottom-right (Chat mode)"]}),s.jsxs("li",{children:["Select ",s.jsx("strong",{children:"Edge Functions"})," from the Cloud menu"]}),s.jsxs("li",{children:["Click on ",s.jsx("strong",{children:"notify-application-status"})," function"]}),s.jsx("li",{children:"View logs with filtering by search term"})]}),s.jsxs("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[s.jsx("p",{className:"text-sm font-medium mb-2",children:"Log Structure:"}),s.jsxs("ul",{className:"text-xs space-y-1 text-muted-foreground font-mono",children:[s.jsxs("li",{children:[" ",s.jsx("strong",{children:"SUCCESS"}),": Email sent successfully with duration"]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"ERROR"}),": Failed operations with error details"]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"INFO"}),": Process steps and user notifications skipped"]})]})]})]})]}),s.jsx("div",{className:"space-y-3",children:h.length===0?s.jsx(q,{children:s.jsx(ee,{className:"py-12 text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"No logs to display. Use the Lovable Cloud dashboard to view real-time edge function logs."})})}):h.map(f=>{var p,m,v,g;return s.jsx(q,{className:"hover:shadow-md transition-shadow",children:s.jsx(ee,{className:"pt-6",children:s.jsx("div",{className:"flex items-start justify-between gap-4",children:s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx(xe,{className:u((p=f.metadata)==null?void 0:p.level),children:((m=f.metadata)==null?void 0:m.level)||"UNKNOWN"}),s.jsx(xe,{variant:"outline",children:((v=f.metadata)==null?void 0:v.action)||"N/A"}),((g=f.metadata)==null?void 0:g.duration_ms)&&s.jsx(xe,{variant:"secondary",children:d(f.metadata.duration_ms)}),s.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(f.timestamp).toLocaleString()})]}),s.jsx("p",{className:"text-sm",children:f.event_message}),f.metadata&&s.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[f.metadata.user_id&&s.jsxs("div",{children:["User ID: ",f.metadata.user_id]}),f.metadata.email&&s.jsxs("div",{children:["Email: ",f.metadata.email]}),f.metadata.status&&s.jsxs("div",{children:["Status: ",f.metadata.status]}),f.metadata.error_message&&s.jsxs("div",{className:"text-red-500 font-mono mt-2 p-2 bg-red-500/5 rounded",children:["Error: ",f.metadata.error_message]})]})]})})})},f.id)})})]})]})}const yB=[{code:"US",name:"United States"},{code:"GB",name:"United Kingdom"},{code:"CA",name:"Canada"},{code:"AU",name:"Australia"},{code:"DE",name:"Germany"},{code:"FR",name:"France"},{code:"ES",name:"Spain"},{code:"IT",name:"Italy"},{code:"BR",name:"Brazil"},{code:"MX",name:"Mexico"}];function O9e(){const{toast:e}=Et(),t=Oe(),r=Cx(),[n,a]=w.useState(!1),[i,o]=w.useState(""),[l,c]=w.useState(""),{data:u,isLoading:d}=Rd({queryKey:["country-competitions"],queryFn:async()=>{const{data:p,error:m}=await T.from("country_representative_competitions").select("*").order("competition_end_date",{ascending:!1});if(m)throw m;return p||[]}}),h=hg({mutationFn:async()=>{if(!i||!l)throw new Error("Please select a country and end date");const p=yB.find(v=>v.code===i);if(!p)throw new Error("Invalid country");const{error:m}=await T.from("country_representative_competitions").insert({country_code:i,country_name:p.name,competition_start_date:new Date().toISOString(),competition_end_date:new Date(l).toISOString(),status:"active"});if(m)throw m},onSuccess:()=>{r.invalidateQueries({queryKey:["country-competitions"]}),a(!1),o(""),c(""),e({title:"Competition created",description:"Country representative competition has been started."})},onError:p=>{e({title:"Error",description:p.message,variant:"destructive"})}}),f=hg({mutationFn:async p=>{const{error:m}=await T.from("country_representative_competitions").update({status:"ended",competition_end_date:new Date().toISOString()}).eq("id",p);if(m)throw m},onSuccess:()=>{r.invalidateQueries({queryKey:["country-competitions"]}),e({title:"Competition ended",description:"The competition has been marked as ended."})}});return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("div",{className:"sticky top-0 z-10 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-border",children:s.jsx("div",{className:"container mx-auto px-4 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>t("/admin"),children:s.jsx(Xd,{className:"h-5 w-5"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(og,{className:"h-6 w-6 text-primary"}),s.jsx("h1",{className:"text-2xl font-bold",children:"Country Representatives"})]})]}),s.jsxs(Ca,{open:n,onOpenChange:a,children:[s.jsx(Xj,{asChild:!0,children:s.jsxs(L,{children:[s.jsx(Ms,{className:"h-4 w-4 mr-2"}),"New Competition"]})}),s.jsxs(oa,{children:[s.jsx(Ea,{children:s.jsx(ka,{children:"Start Country Competition"})}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{children:[s.jsx(de,{children:"Country"}),s.jsxs(At,{value:i,onValueChange:o,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select a country"})}),s.jsx(St,{children:yB.map(p=>s.jsx(re,{value:p.code,children:p.name},p.code))})]})]}),s.jsxs("div",{children:[s.jsx(de,{htmlFor:"end-date",children:"Competition End Date"}),s.jsx(De,{id:"end-date",type:"date",value:l,onChange:p=>c(p.target.value),min:Mr(new Date,"yyyy-MM-dd")}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Typically set for 1 year from today"})]}),s.jsx(L,{onClick:()=>h.mutate(),disabled:!i||!l||h.isPending,className:"w-full",children:"Start Competition"})]})]})]})]})})}),s.jsx("div",{className:"container mx-auto px-4 py-6",children:s.jsxs("div",{className:"space-y-4",children:[u==null?void 0:u.map(p=>s.jsxs(q,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h3",{className:"text-xl font-semibold",children:p.country_name}),s.jsx(xe,{variant:p.status==="active"?"default":"secondary",children:p.status})]}),s.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[s.jsxs("p",{children:["Started: ",Mr(new Date(p.competition_start_date),"MMM d, yyyy")]}),s.jsxs("p",{children:["Ends: ",Mr(new Date(p.competition_end_date),"MMM d, yyyy")]}),p.winner_announced_at&&s.jsxs("p",{children:["Winner announced: ",Mr(new Date(p.winner_announced_at),"MMM d, yyyy")]})]})]}),p.status==="active"&&s.jsx(L,{variant:"outline",onClick:()=>f.mutate(p.id),disabled:f.isPending,children:"End Competition"})]}),p.winner_user_id&&s.jsx("div",{className:"mt-4 p-4 bg-primary/5 rounded-lg border border-primary/20",children:s.jsxs("p",{className:"text-sm font-medium text-primary",children:["Winner: User ID ",p.winner_user_id]})})]},p.id)),(u==null?void 0:u.length)===0&&!d&&s.jsxs(q,{className:"p-12 text-center",children:[s.jsx(og,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Competitions Yet"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"Start a country representative competition to begin tracking referrals."})]})]})})]})}var LZ={exports:{}},BZ={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pp=w;function I9e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var D9e=typeof Object.is=="function"?Object.is:I9e,M9e=Pp.useState,$9e=Pp.useEffect,F9e=Pp.useLayoutEffect,L9e=Pp.useDebugValue;function B9e(e,t){var r=t(),n=M9e({inst:{value:r,getSnapshot:t}}),a=n[0].inst,i=n[1];return F9e(function(){a.value=r,a.getSnapshot=t,SS(a)&&i({inst:a})},[e,r,t]),$9e(function(){return SS(a)&&i({inst:a}),e(function(){SS(a)&&i({inst:a})})},[e]),L9e(r),r}function SS(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!D9e(e,r)}catch{return!0}}function U9e(e,t){return t()}var V9e=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?U9e:B9e;BZ.useSyncExternalStore=Pp.useSyncExternalStore!==void 0?Pp.useSyncExternalStore:V9e;LZ.exports=BZ;var z9e=LZ.exports;function W9e(){return z9e.useSyncExternalStore(q9e,()=>!0,()=>!1)}function q9e(){return()=>{}}var WI="Avatar",[G9e,jQe]=an(WI),[H9e,UZ]=G9e(WI),VZ=w.forwardRef((e,t)=>{const{__scopeAvatar:r,...n}=e,[a,i]=w.useState("idle");return s.jsx(H9e,{scope:r,imageLoadingStatus:a,onImageLoadingStatusChange:i,children:s.jsx(Me.span,{...n,ref:t})})});VZ.displayName=WI;var zZ="AvatarImage",WZ=w.forwardRef((e,t)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:a=()=>{},...i}=e,o=UZ(zZ,r),l=K9e(n,i),c=Yr(u=>{a(u),o.onImageLoadingStatusChange(u)});return Xr(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?s.jsx(Me.img,{...i,ref:t,src:n}):null});WZ.displayName=zZ;var qZ="AvatarFallback",GZ=w.forwardRef((e,t)=>{const{__scopeAvatar:r,delayMs:n,...a}=e,i=UZ(qZ,r),[o,l]=w.useState(n===void 0);return w.useEffect(()=>{if(n!==void 0){const c=window.setTimeout(()=>l(!0),n);return()=>window.clearTimeout(c)}},[n]),o&&i.imageLoadingStatus!=="loaded"?s.jsx(Me.span,{...a,ref:t}):null});GZ.displayName=qZ;function bB(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function K9e(e,{referrerPolicy:t,crossOrigin:r}){const n=W9e(),a=w.useRef(null),i=n?(a.current||(a.current=new window.Image),a.current):null,[o,l]=w.useState(()=>bB(i,e));return Xr(()=>{l(bB(i,e))},[i,e]),Xr(()=>{const c=h=>()=>{l(h)};if(!i)return;const u=c("loaded"),d=c("error");return i.addEventListener("load",u),i.addEventListener("error",d),t&&(i.referrerPolicy=t),typeof r=="string"&&(i.crossOrigin=r),()=>{i.removeEventListener("load",u),i.removeEventListener("error",d)}},[i,r,t]),o}var HZ=VZ,KZ=WZ,YZ=GZ;const Yi=w.forwardRef(({className:e,...t},r)=>s.jsx(HZ,{ref:r,className:me("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));Yi.displayName=HZ.displayName;const Xi=w.forwardRef(({className:e,...t},r)=>s.jsx(KZ,{ref:r,className:me("aspect-square h-full w-full",e),...t}));Xi.displayName=KZ.displayName;const Qi=w.forwardRef(({className:e,...t},r)=>s.jsx(YZ,{ref:r,className:me("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));Qi.displayName=YZ.displayName;var o_="Switch",[Y9e,NQe]=an(o_),[X9e,Q9e]=Y9e(o_),XZ=w.forwardRef((e,t)=>{const{__scopeSwitch:r,name:n,checked:a,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:u,form:d,...h}=e,[f,p]=w.useState(null),m=ct(t,b=>p(b)),v=w.useRef(!1),g=f?d||!!f.closest("form"):!0,[x,y]=Ba({prop:a,defaultProp:i??!1,onChange:u,caller:o_});return s.jsxs(X9e,{scope:r,checked:x,disabled:l,children:[s.jsx(Me.button,{type:"button",role:"switch","aria-checked":x,"aria-required":o,"data-state":eJ(x),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:m,onClick:Ne(e.onClick,b=>{y(N=>!N),g&&(v.current=b.isPropagationStopped(),v.current||b.stopPropagation())})}),g&&s.jsx(JZ,{control:f,bubbles:!v.current,name:n,value:c,checked:x,required:o,disabled:l,form:d,style:{transform:"translateX(-100%)"}})]})});XZ.displayName=o_;var QZ="SwitchThumb",ZZ=w.forwardRef((e,t)=>{const{__scopeSwitch:r,...n}=e,a=Q9e(QZ,r);return s.jsx(Me.span,{"data-state":eJ(a.checked),"data-disabled":a.disabled?"":void 0,...n,ref:t})});ZZ.displayName=QZ;var Z9e="SwitchBubbleInput",JZ=w.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:n=!0,...a},i)=>{const o=w.useRef(null),l=ct(o,i),c=sN(r),u=hj(t);return w.useEffect(()=>{const d=o.current;if(!d)return;const h=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(h,"checked").set;if(c!==r&&p){const m=new Event("click",{bubbles:n});p.call(d,r),d.dispatchEvent(m)}},[c,r,n]),s.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:l,style:{...a.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});JZ.displayName=Z9e;function eJ(e){return e?"checked":"unchecked"}var tJ=XZ,J9e=ZZ;const Yt=w.forwardRef(({className:e,...t},r)=>s.jsx(tJ,{className:me("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",e),...t,ref:r,children:s.jsx(J9e,{className:me("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Yt.displayName=tJ.displayName;const e7e=()=>{const[e,t]=w.useState(!1),[r,n]=w.useState(!1),[a,i]=w.useState(null),[o,l]=w.useState(null),[c,u]=w.useState("");w.useEffect(()=>{d()},[]),w.useEffect(()=>{if(!r||!o){u("");return}const p=()=>{const v=new Date(o),y=36e5-(new Date().getTime()-v.getTime());if(y<=0)u("Expiring soon..."),d();else{const b=Math.floor(y/6e4);u(`${b}m remaining`)}};p();const m=setInterval(p,6e4);return()=>clearInterval(m)},[r,o]);const d=async()=>{try{const{data:{user:p}}=await T.auth.getUser();if(!p)return;const{data:m,error:v}=await T.from("provider_profiles").select("available_now, available_now_location, available_now_started_at").eq("user_id",p.id).single();if(v)throw v;n((m==null?void 0:m.available_now)||!1),i(m==null?void 0:m.available_now_location),l(m==null?void 0:m.available_now_started_at)}catch(p){console.error("Error loading availability:",p)}},h=()=>new Promise((p,m)=>{if(!navigator.geolocation){m(new Error("Geolocation not supported"));return}navigator.geolocation.getCurrentPosition(async v=>{const g=v.coords.latitude,x=v.coords.longitude;try{const N=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${g}&lon=${x}`)).json()).display_name||"Unknown location";p({lat:g,lng:x,address:N})}catch{p({lat:g,lng:x,address:"Unknown location"})}},v=>m(v))}),f=async p=>{t(!0);try{const{data:{user:m}}=await T.auth.getUser();if(!m)throw new Error("Not authenticated");if(p){const v=await h(),{error:g}=await T.from("provider_profiles").update({available_now:!0,available_now_started_at:new Date().toISOString(),available_now_location:v}).eq("user_id",m.id);if(g)throw g;n(!0),i(v),l(new Date().toISOString()),H.success("You're now Available! Expires in 1 hour.")}else{const{error:v}=await T.from("provider_profiles").update({available_now:!1,available_now_started_at:null,available_now_location:null}).eq("user_id",m.id);if(v)throw v;n(!1),i(null),l(null),H.success("Available Now status disabled")}}catch(m){console.error("Error toggling availability:",m),H.error(m.message||"Failed to update availability")}finally{t(!1)}};return s.jsxs(q,{className:r?"border-green-500/50 bg-green-500/5":"",children:[s.jsx(ge,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs(be,{className:"flex items-center gap-2",children:["Available Now",r&&s.jsxs("span",{className:"relative flex h-3 w-3",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),s.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-green-500"})]})]}),s.jsx(Re,{children:r?"You're visible to clients looking for providers nearby":"Turn on to appear in Available Now searches"})]}),s.jsx(Yt,{checked:r,onCheckedChange:f,disabled:e})]})}),r&&s.jsxs(ee,{className:"space-y-3",children:[a&&s.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[s.jsx(hn,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),s.jsx("span",{className:"text-muted-foreground",children:a.address})]}),c&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(On,{className:"h-4 w-4 text-green-600"}),s.jsx("span",{className:"font-medium text-green-700 dark:text-green-400",children:c})]}),s.jsx(Hn,{className:"bg-green-500/10 border-green-500/20",children:s.jsx(Kn,{className:"text-xs text-muted-foreground",children:"Your Available Now status will automatically expire after 1 hour or when you accept a VAI Check encounter."})})]}),e&&s.jsx(ee,{className:"pt-0",children:s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Er,{className:"h-4 w-4 animate-spin"}),s.jsx("span",{children:"Updating availability..."})]})})]})},t7e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wB=e=>{const[t,r]=e.split(":"),n=parseInt(t),a=n>=12?"PM":"AM";return`${n===0?12:n>12?n-12:n}:${r} ${a}`},r7e=({schedules:e})=>{const t=e.filter(n=>n.is_enabled),r=n=>t.filter(a=>a.day_of_week===n);return s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center gap-2",children:[s.jsx(Yn,{className:"h-5 w-5"}),"Schedule Preview"]}),s.jsx(Re,{children:"Visual overview of your weekly availability schedule"})]}),s.jsx(ee,{children:s.jsx("div",{className:"grid grid-cols-7 gap-2",children:t7e.map((n,a)=>{const i=r(a),o=i.length>0;return s.jsxs("div",{className:`rounded-lg border p-3 min-h-[120px] transition-colors ${o?"bg-primary/5 border-primary/20":"bg-muted/30 border-border"}`,children:[s.jsx("div",{className:"font-semibold text-sm mb-2 text-center",children:n}),s.jsx("div",{className:"space-y-1",children:i.map((l,c)=>s.jsxs("div",{className:"text-xs bg-primary/10 rounded px-2 py-1 text-center",children:[s.jsx("div",{className:"font-medium",children:wB(l.start_time)}),s.jsx("div",{className:"text-muted-foreground",children:wB(l.end_time)})]},c))}),!o&&s.jsx("div",{className:"text-xs text-muted-foreground text-center mt-2",children:"No schedule"})]},a)})})})]})},n7e=[{name:"Weekdays 9-5",description:"Monday through Friday, standard business hours",schedules:[{day_of_week:1,start_time:"09:00:00",end_time:"17:00:00"},{day_of_week:2,start_time:"09:00:00",end_time:"17:00:00"},{day_of_week:3,start_time:"09:00:00",end_time:"17:00:00"},{day_of_week:4,start_time:"09:00:00",end_time:"17:00:00"},{day_of_week:5,start_time:"09:00:00",end_time:"17:00:00"}]},{name:"Evenings",description:"Monday through Friday, 6 PM - 11 PM",schedules:[{day_of_week:1,start_time:"18:00:00",end_time:"23:00:00"},{day_of_week:2,start_time:"18:00:00",end_time:"23:00:00"},{day_of_week:3,start_time:"18:00:00",end_time:"23:00:00"},{day_of_week:4,start_time:"18:00:00",end_time:"23:00:00"},{day_of_week:5,start_time:"18:00:00",end_time:"23:00:00"}]},{name:"Weekends",description:"Saturday and Sunday, 10 AM - 8 PM",schedules:[{day_of_week:0,start_time:"10:00:00",end_time:"20:00:00"},{day_of_week:6,start_time:"10:00:00",end_time:"20:00:00"}]},{name:"All Week",description:"Every day, 9 AM - 9 PM",schedules:[{day_of_week:0,start_time:"09:00:00",end_time:"21:00:00"},{day_of_week:1,start_time:"09:00:00",end_time:"21:00:00"},{day_of_week:2,start_time:"09:00:00",end_time:"21:00:00"},{day_of_week:3,start_time:"09:00:00",end_time:"21:00:00"},{day_of_week:4,start_time:"09:00:00",end_time:"21:00:00"},{day_of_week:5,start_time:"09:00:00",end_time:"21:00:00"},{day_of_week:6,start_time:"09:00:00",end_time:"21:00:00"}]},{name:"Flexible Schedule",description:"Varied hours throughout the week",schedules:[{day_of_week:1,start_time:"10:00:00",end_time:"14:00:00"},{day_of_week:2,start_time:"14:00:00",end_time:"20:00:00"},{day_of_week:3,start_time:"10:00:00",end_time:"14:00:00"},{day_of_week:4,start_time:"14:00:00",end_time:"20:00:00"},{day_of_week:5,start_time:"18:00:00",end_time:"23:00:00"},{day_of_week:6,start_time:"10:00:00",end_time:"18:00:00"}]}],a7e=({onApplyTemplate:e,disabled:t})=>s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center gap-2",children:[s.jsx(kd,{className:"h-5 w-5"}),"Quick Templates"]}),s.jsx(Re,{children:"Apply pre-configured schedule patterns to get started quickly"})]}),s.jsx(ee,{children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:n7e.map(r=>s.jsxs("div",{className:"border rounded-lg p-4 space-y-2 hover:border-primary transition-colors",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-sm",children:r.name}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:r.description})]}),s.jsx(On,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"})]}),s.jsx(L,{size:"sm",variant:"outline",className:"w-full",onClick:()=>e(r),disabled:t,children:"Apply Template"})]},r.name))})})]}),Ph=[{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Phoenix",label:"Arizona Time (MST)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HST)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET)"},{value:"Europe/Berlin",label:"Berlin (CET)"},{value:"Asia/Dubai",label:"Dubai (GST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Asia/Singapore",label:"Singapore (SGT)"},{value:"Asia/Hong_Kong",label:"Hong Kong (HKT)"},{value:"Australia/Sydney",label:"Sydney (AEDT)"}],jB=[{value:0,label:"Sunday"},{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"}],s7e=()=>{const e=[];for(let t=0;t<24;t++)for(let r=0;r<60;r+=30){const n=t.toString().padStart(2,"0"),a=r.toString().padStart(2,"0");e.push(`${n}:${a}:00`)}return e},kb=e=>{const[t,r]=e.split(":"),n=parseInt(t),a=n>=12?"PM":"AM";return`${n===0?12:n>12?n-12:n}:${r} ${a}`},rJ=()=>{var N,j;const[e,t]=w.useState(!0),[r,n]=w.useState(!1),[a,i]=w.useState(!1),[o,l]=w.useState([]),[c,u]=w.useState("America/New_York"),[d,h]=w.useState({day_of_week:1,start_time:"09:00:00",end_time:"17:00:00",is_enabled:!0,timezone:"America/New_York"}),f=s7e();w.useEffect(()=>{p()},[]);const p=async()=>{try{const{data:{user:_}}=await T.auth.getUser();if(!_)return;const{data:S}=await T.from("provider_profiles").select("auto_availability_enabled").eq("user_id",_.id).single();i((S==null?void 0:S.auto_availability_enabled)||!1);const{data:C,error:E}=await T.from("provider_availability_schedules").select("*").eq("user_id",_.id).order("day_of_week").order("start_time");if(E)throw E;const k=C||[];if(l(k),k.length>0)u(k[0].timezone),h(P=>({...P,timezone:k[0].timezone}));else{const P=Intl.DateTimeFormat().resolvedOptions().timeZone,A=Ph.find(O=>O.value===P);A&&(u(A.value),h(O=>({...O,timezone:A.value})))}}catch(_){console.error("Error loading schedules:",_),H.error(_.message||"Failed to load schedules")}finally{t(!1)}},m=async _=>{try{n(!0);const{data:{user:S}}=await T.auth.getUser();if(!S)return;const{error:C}=await T.from("provider_profiles").update({auto_availability_enabled:_}).eq("user_id",S.id);if(C)throw C;i(_),H.success(_?"Auto-availability enabled":"Auto-availability disabled")}catch(S){console.error("Error toggling auto-availability:",S),H.error(S.message||"Failed to update setting")}finally{n(!1)}},v=async()=>{if(!d.day_of_week||!d.start_time||!d.end_time){H.error("Please fill in all fields");return}try{n(!0);const{data:{user:_}}=await T.auth.getUser();if(!_)return;const{error:S}=await T.from("provider_availability_schedules").insert({user_id:_.id,day_of_week:d.day_of_week,start_time:d.start_time,end_time:d.end_time,timezone:d.timezone,is_enabled:!0});if(S)throw S;H.success("Schedule added"),p(),h({day_of_week:1,start_time:"09:00:00",end_time:"17:00:00",is_enabled:!0,timezone:d.timezone})}catch(_){console.error("Error adding schedule:",_),H.error(_.message||"Failed to add schedule")}finally{n(!1)}},g=async _=>{try{n(!0);const{error:S}=await T.from("provider_availability_schedules").delete().eq("id",_);if(S)throw S;H.success("Schedule deleted successfully"),p()}catch(S){console.error("Error deleting schedule:",S),H.error("Failed to delete schedule")}finally{n(!1)}},x=async _=>{var S;try{n(!0);const{data:{user:C}}=await T.auth.getUser();if(!C)return;const{error:E}=await T.from("provider_availability_schedules").update({timezone:_}).eq("user_id",C.id);if(E)throw E;u(_),H.success(`All schedules updated to ${(S=Ph.find(k=>k.value===_))==null?void 0:S.label}`),p()}catch(C){console.error("Error updating timezones:",C),H.error("Failed to update timezones")}finally{n(!1)}},y=async _=>{try{n(!0);const{data:{user:S}}=await T.auth.getUser();if(!S)return;await T.from("provider_availability_schedules").delete().eq("user_id",S.id);const C=_.schedules.map(k=>({user_id:S.id,day_of_week:k.day_of_week,start_time:k.start_time,end_time:k.end_time,is_enabled:!0,timezone:c})),{error:E}=await T.from("provider_availability_schedules").insert(C);if(E)throw E;H.success(`Applied "${_.name}" template`),p()}catch(S){console.error("Error applying template:",S),H.error("Failed to apply template")}finally{n(!1)}},b=async(_,S)=>{try{const{error:C}=await T.from("provider_availability_schedules").update({is_enabled:S}).eq("id",_);if(C)throw C;l(o.map(E=>E.id===_?{...E,is_enabled:S}:E)),H.success(S?"Schedule enabled":"Schedule disabled")}catch(C){console.error("Error toggling schedule:",C),H.error(C.message||"Failed to update schedule")}};return e?s.jsx(q,{children:s.jsx(ee,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[s.jsx(Er,{className:"h-4 w-4 animate-spin"}),s.jsx("span",{children:"Loading schedules..."})]})})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx(r7e,{schedules:o}),s.jsx(a7e,{onApplyTemplate:y,disabled:r}),s.jsxs(q,{children:[s.jsx(ge,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs(be,{className:"flex items-center gap-2",children:[s.jsx(On,{className:"h-5 w-5"}),"Recurring Availability Schedule"]}),s.jsx(Re,{children:"Set your recurring weekly availability. Your status will automatically activate when these times arrive."})]}),s.jsx(Yt,{checked:a,onCheckedChange:m,disabled:r})]})}),s.jsxs(ee,{className:"space-y-6",children:[a&&s.jsxs(s.Fragment,{children:[s.jsx(Hn,{children:s.jsx(Kn,{className:"text-sm",children:"When enabled, your Available Now status will automatically activate during your scheduled times. You can still manually control it at any time. All times are in your selected timezone."})}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{className:"text-sm font-semibold",children:"Your Timezone"}),s.jsxs(At,{value:c,onValueChange:_=>{u(_),h({...d,timezone:_})},children:[s.jsx(_t,{className:"bg-background",children:s.jsx(Pt,{})}),s.jsx(St,{children:Ph.map(_=>s.jsx(re,{value:_.value,children:_.label},_.value))})]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Current time in ",(N=Ph.find(_=>_.value===c))==null?void 0:N.label,":"," ",new Date().toLocaleTimeString("en-US",{timeZone:c,hour:"numeric",minute:"2-digit",hour12:!0})]})]}),s.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/30",children:[s.jsx("h3",{className:"font-semibold text-sm",children:"Add New Schedule"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{className:"text-sm",children:"Day"}),s.jsxs(At,{value:(j=d.day_of_week)==null?void 0:j.toString(),onValueChange:_=>h({...d,day_of_week:parseInt(_)}),children:[s.jsx(_t,{children:s.jsx(Pt,{})}),s.jsx(St,{children:jB.map(_=>s.jsx(re,{value:_.value.toString(),children:_.label},_.value))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{className:"text-sm",children:"Start Time"}),s.jsxs(At,{value:d.start_time,onValueChange:_=>h({...d,start_time:_}),children:[s.jsx(_t,{children:s.jsx(Pt,{})}),s.jsx(St,{children:f.map(_=>s.jsx(re,{value:_,children:kb(_)},_))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{className:"text-sm",children:"End Time"}),s.jsxs(At,{value:d.end_time,onValueChange:_=>h({...d,end_time:_}),children:[s.jsx(_t,{children:s.jsx(Pt,{})}),s.jsx(St,{children:f.map(_=>s.jsx(re,{value:_,children:kb(_)},_))})]})]}),s.jsx("div",{className:"flex items-end",children:s.jsx(L,{onClick:v,disabled:r,className:"w-full",children:r?s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"h-4 w-4 mr-2 animate-spin"}),"Adding..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ms,{className:"h-4 w-4 mr-2"}),"Add"]})})})]})]}),o.length>0&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"font-semibold text-sm",children:"Your Schedules"}),s.jsxs(Ca,{children:[s.jsx(Xj,{asChild:!0,children:s.jsxs(L,{variant:"outline",size:"sm",disabled:r,children:[s.jsx(So,{className:"h-4 w-4 mr-2"}),"Bulk Update Timezone"]})}),s.jsxs(oa,{children:[s.jsxs(Ea,{children:[s.jsx(ka,{children:"Update All Schedules Timezone"}),s.jsx(pu,{children:"This will change the timezone for all your existing schedules."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{children:"New Timezone"}),s.jsxs(At,{value:c,onValueChange:_=>u(_),children:[s.jsx(_t,{children:s.jsx(Pt,{})}),s.jsx(St,{children:Ph.map(_=>s.jsx(re,{value:_.value,children:_.label},_.value))})]})]}),s.jsx(L,{onClick:()=>x(c),disabled:r,className:"w-full",children:r?s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"h-4 w-4 mr-2 animate-spin"}),"Updating..."]}):"Update All Schedules"})]})]})]})]}),s.jsx("div",{className:"space-y-2",children:o.map(_=>{var S,C;return s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-background",children:[s.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[s.jsx(Yt,{checked:_.is_enabled,onCheckedChange:E=>_.id&&b(_.id,E)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium text-sm",children:(S=jB.find(E=>E.value===_.day_of_week))==null?void 0:S.label}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:[kb(_.start_time)," - ",kb(_.end_time),"  ",((C=Ph.find(E=>E.value===_.timezone))==null?void 0:C.label)||_.timezone]})]})]}),s.jsx(L,{variant:"ghost",size:"sm",onClick:()=>_.id&&g(_.id),disabled:r,children:s.jsx(Qc,{className:"h-4 w-4 text-destructive"})})]},_.id)})})]}),o.length===0&&s.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No schedules yet. Add your first schedule above or use a template!"})]}),!a&&s.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"Enable automatic availability to set your recurring schedule"})]})]})]})};function i7e(){const[e,t]=w.useState(!1),[r,n]=w.useState(!1),[a,i]=w.useState({full_name:"",email:"",avatar_url:""});w.useEffect(()=>{o()},[]);const o=async()=>{try{const{data:{user:d}}=await T.auth.getUser();if(!d)return;const{data:h}=await T.from("profiles").select("*").eq("id",d.id).single();h&&i({full_name:h.full_name||"",email:h.email||d.email||"",avatar_url:h.avatar_url||""})}catch(d){console.error("Error loading profile:",d)}},l=async()=>{t(!0);try{const{data:{user:d}}=await T.auth.getUser();if(!d)throw new Error("Not authenticated");const{error:h}=await T.from("profiles").update({full_name:a.full_name}).eq("id",d.id);if(h)throw h;H.success("Profile updated successfully!")}catch(d){console.error("Error updating profile:",d),H.error("Failed to update profile")}finally{t(!1)}},c=async d=>{var f;const h=(f=d.target.files)==null?void 0:f[0];if(h){n(!0);try{const{data:{user:p}}=await T.auth.getUser();if(!p)throw new Error("Not authenticated");const m=URL.createObjectURL(h);i(v=>({...v,avatar_url:m})),H.success("Avatar uploaded! Click Save to update.")}catch(p){console.error("Error uploading avatar:",p),H.error("Failed to upload avatar")}finally{n(!1)}}},u=()=>{var d;return((d=a.full_name)==null?void 0:d.split(" ").map(h=>h[0]).join("").toUpperCase())||"?"};return s.jsxs("div",{className:"space-y-6",children:[s.jsx(e7e,{}),s.jsx(rJ,{}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Profile Information"}),s.jsx(Re,{children:"Update your profile details and photo"})]}),s.jsxs(ee,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsxs(Yi,{className:"w-24 h-24",children:[s.jsx(Xi,{src:a.avatar_url}),s.jsx(Qi,{className:"text-2xl",children:u()})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx(de,{htmlFor:"avatar-upload",className:"cursor-pointer",children:s.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors",children:[r?s.jsx(Er,{className:"w-4 h-4 animate-spin"}):s.jsx(Na,{className:"w-4 h-4"}),"Change Photo"]})}),s.jsx(De,{id:"avatar-upload",type:"file",accept:"image/*",className:"hidden",onChange:c,disabled:r}),s.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"JPG, PNG or GIF. Max 5MB."})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"full_name",children:"Full Name"}),s.jsx(De,{id:"full_name",value:a.full_name,onChange:d=>i(h=>({...h,full_name:d.target.value})),placeholder:"Enter your full name"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"email",children:"Email Address"}),s.jsx(De,{id:"email",type:"email",value:a.email,disabled:!0,className:"bg-muted"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Email cannot be changed. Contact support if needed."})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(L,{onClick:l,disabled:e,children:e?s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):"Save Changes"})})]})]})]})}function o7e(){const e=Oe(),[t,r]=w.useState({status:"free",tier:"earlyaccess"});w.useEffect(()=>{n()},[]);const n=async()=>{try{const{data:{user:c}}=await T.auth.getUser();if(!c)return;const{data:u}=await T.from("profiles").select("subscription_status").eq("id",c.id).single(),{data:d}=await T.from("referral_codes").select("tier").eq("user_id",c.id).single();r({status:(u==null?void 0:u.subscription_status)||"free",tier:(d==null?void 0:d.tier)||"earlyaccess"})}catch(c){console.error("Error loading subscription:",c)}},i=(()=>{switch(t.tier){case"founding":return{name:"Founding Council",icon:zi,color:"text-yellow-500",badgeColor:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",benefits:["10% lifetime referral commission","Founding member badge","Priority support","Early access to all features","Exclusive community access"]};case"firstmover":return{name:"First Mover",icon:lz,color:"text-blue-500",badgeColor:"bg-blue-500/10 text-blue-500 border-blue-500/20",benefits:["5% lifetime referral commission","First mover badge","Early access to features","Priority support"]};default:return{name:"Early Access",icon:hr,color:"text-gray-500",badgeColor:"bg-gray-500/10 text-gray-500 border-gray-500/20",benefits:["Free platform access","V.A.I. verification","DateGuard features","TrueRevu reviews"]}}})(),o=i.icon,l=t.status==="premium";return s.jsxs("div",{className:"space-y-6",children:[s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Current Membership"}),s.jsx(Re,{children:"Your current plan and benefits"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-primary/10 to-accent/10 flex items-center justify-center",children:s.jsx(o,{className:`w-6 h-6 ${i.color}`})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg",children:i.name}),s.jsx(xe,{className:i.badgeColor,variant:"outline",children:l?"Premium":"Free"})]})]})}),s.jsxs("div",{className:"space-y-2 pt-4 border-t",children:[s.jsx("p",{className:"text-sm font-medium text-foreground",children:"Benefits:"}),i.benefits.map((c,u)=>s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx($t,{className:"w-4 h-4 text-success"}),c]},u))]})]})]}),!l&&s.jsxs(q,{className:"bg-gradient-to-br from-primary/5 to-accent/5 border-primary/20",children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center gap-2",children:[s.jsx(zi,{className:"w-5 h-5 text-primary"}),"Upgrade to Premium"]}),s.jsx(Re,{children:"Unlock all features and support the platform"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-semibold",children:"Premium Monthly"}),s.jsx("span",{className:"text-2xl font-bold",children:"$20/mo"})]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Cancel anytime. No hidden fees."})]}),s.jsxs("div",{className:"space-y-2 pt-4 border-t",children:[s.jsx("p",{className:"text-sm font-medium",children:"Premium includes:"}),s.jsx("div",{className:"space-y-2",children:["Unlimited VAI-CHECK sessions","Priority DateGuard alerts","Advanced profile visibility","Featured in search results","24/7 priority support","Custom profile badge"].map((c,u)=>s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx($t,{className:"w-4 h-4 text-primary"}),c]},u))})]}),s.jsx(L,{className:"w-full",size:"lg",children:"Upgrade to Premium - $20/mo"})]})]}),l&&s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Billing & Payments"}),s.jsx(Re,{children:"Manage your subscription and view payment history"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Next billing date"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"December 15, 2025"})]}),s.jsx("p",{className:"text-xl font-bold",children:"$20.00"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(L,{variant:"outline",className:"w-full",children:"Update Payment Method"}),s.jsx(L,{variant:"outline",className:"w-full text-destructive hover:text-destructive",children:"Cancel Subscription"})]})]})]}),s.jsxs(q,{className:"bg-gradient-to-br from-purple-600/10 to-pink-600/10 border-purple-500/20",children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center gap-2",children:[s.jsx(en,{className:"w-5 h-5 text-purple-500"}),"Become an Influencer or Affiliate"]}),s.jsx(Re,{children:"Earn higher commissions and exclusive benefits"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Join our network of influencers and affiliates to unlock enhanced earning potential, special perks, and recognition in the Vairify community."}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(L,{onClick:()=>e("/apply/influencer"),className:"flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:["Apply Now",s.jsx(ez,{className:"w-4 h-4 ml-2"})]}),s.jsx(L,{onClick:()=>e("/application/status"),variant:"outline",className:"flex-1",children:"Check Status"})]})]})]}),s.jsxs(q,{className:"bg-gradient-to-br from-cyan-600/10 to-blue-600/10 border-cyan-500/20",children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Referral Program"}),s.jsx(Re,{children:"Earn commissions by inviting friends"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("p",{className:"text-sm text-muted-foreground",children:["As a ",i.name," member, you earn ",t.tier==="founding"?"10%":t.tier==="firstmover"?"5%":"0%"," commission on all referrals."]}),s.jsx(L,{onClick:()=>e("/referrals"),className:"w-full",variant:"outline",children:"View Referral Dashboard "})]})]})]})}function l7e(){const[e,t]=w.useState(!0),[r,n]=w.useState(!1),[a,i]=w.useState({email_notifications:!0,push_notifications:!0,sms_notifications:!1,emergency_alerts:!0,referral_updates:!0,marketing_emails:!1,application_status_emails:!0});w.useEffect(()=>{o()},[]);const o=async()=>{const{data:{user:u}}=await T.auth.getUser();if(!u)return;const{data:d,error:h}=await T.from("user_settings").select("*").eq("user_id",u.id).maybeSingle();if(h&&h.code!=="PGRST116"){H.error("Failed to load notification settings"),t(!1);return}d&&i({email_notifications:d.email_notifications,push_notifications:d.push_notifications,sms_notifications:d.sms_notifications,emergency_alerts:d.emergency_alerts,referral_updates:d.referral_updates,marketing_emails:d.marketing_emails,application_status_emails:d.application_status_emails??!0}),t(!1)},l=async()=>{n(!0);const{data:{user:u}}=await T.auth.getUser();if(!u)return;const{error:d}=await T.from("user_settings").upsert({user_id:u.id,...a});d?H.error("Failed to save notification preferences"):H.success("Notification preferences saved!"),n(!1)},c=u=>{i(d=>({...d,[u]:!d[u]}))};return e?s.jsx("div",{className:"text-center py-8",children:"Loading..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Email Notifications"}),s.jsx(Re,{children:"Manage what emails you receive"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx(de,{htmlFor:"email_notifications",children:"Email Notifications"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive general email notifications"})]}),s.jsx(Yt,{id:"email_notifications",checked:a.email_notifications,onCheckedChange:()=>c("email_notifications")})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx(de,{htmlFor:"marketing_emails",children:"Marketing Emails"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive updates about new features and promotions"})]}),s.jsx(Yt,{id:"marketing_emails",checked:a.marketing_emails,onCheckedChange:()=>c("marketing_emails")})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx(de,{htmlFor:"referral_updates",children:"Referral Updates"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"When your referrals sign up or upgrade"})]}),s.jsx(Yt,{id:"referral_updates",checked:a.referral_updates,onCheckedChange:()=>c("referral_updates")})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx(de,{htmlFor:"application_status_emails",children:"Application Status Updates"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"When your influencer/affiliate application status changes"})]}),s.jsx(Yt,{id:"application_status_emails",checked:a.application_status_emails,onCheckedChange:()=>c("application_status_emails")})]})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Push Notifications"}),s.jsx(Re,{children:"Manage mobile and browser notifications"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx(de,{htmlFor:"push_notifications",children:"Push Notifications"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive push notifications on your devices"})]}),s.jsx(Yt,{id:"push_notifications",checked:a.push_notifications,onCheckedChange:()=>c("push_notifications")})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx(de,{htmlFor:"emergency_alerts",className:"text-destructive",children:"Emergency Alerts"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Critical safety alerts (always recommended)"})]}),s.jsx(Yt,{id:"emergency_alerts",checked:a.emergency_alerts,onCheckedChange:()=>c("emergency_alerts")})]})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"SMS Notifications"}),s.jsx(Re,{children:"Text message alerts (standard rates apply)"})]}),s.jsx(ee,{className:"space-y-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx(de,{htmlFor:"sms_notifications",children:"SMS Notifications"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive important alerts via SMS"})]}),s.jsx(Yt,{id:"sms_notifications",checked:a.sms_notifications,onCheckedChange:()=>c("sms_notifications")})]})})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(L,{onClick:l,disabled:r,size:"lg",children:r?s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):"Save Preferences"})})]})}var NB=1,c7e=.9,u7e=.8,d7e=.17,CS=.1,ES=.999,h7e=.9999,f7e=.99,p7e=/[\\\/_+.#"@\[\(\{&]/,m7e=/[\\\/_+.#"@\[\(\{&]/g,v7e=/[\s-]/,nJ=/[\s-]/g;function PA(e,t,r,n,a,i,o){if(i===t.length)return a===e.length?NB:f7e;var l=`${a},${i}`;if(o[l]!==void 0)return o[l];for(var c=n.charAt(i),u=r.indexOf(c,a),d=0,h,f,p,m;u>=0;)h=PA(e,t,r,n,u+1,i+1,o),h>d&&(u===a?h*=NB:p7e.test(e.charAt(u-1))?(h*=u7e,p=e.slice(a,u-1).match(m7e),p&&a>0&&(h*=Math.pow(ES,p.length))):v7e.test(e.charAt(u-1))?(h*=c7e,m=e.slice(a,u-1).match(nJ),m&&a>0&&(h*=Math.pow(ES,m.length))):(h*=d7e,a>0&&(h*=Math.pow(ES,u-a))),e.charAt(u)!==t.charAt(i)&&(h*=h7e)),(h<CS&&r.charAt(u-1)===n.charAt(i+1)||n.charAt(i+1)===n.charAt(i)&&r.charAt(u-1)!==n.charAt(i))&&(f=PA(e,t,r,n,u+1,i+2,o),f*CS>h&&(h=f*CS)),h>d&&(d=h),u=r.indexOf(c,u+1);return o[l]=d,d}function _B(e){return e.toLowerCase().replace(nJ," ")}function g7e(e,t,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,PA(e,t,_B(e),_B(t),0,0,{})}var Jm='[cmdk-group=""]',kS='[cmdk-group-items=""]',x7e='[cmdk-group-heading=""]',aJ='[cmdk-item=""]',SB=`${aJ}:not([aria-disabled="true"])`,TA="cmdk-item-select",Fh="data-value",y7e=(e,t,r)=>g7e(e,t,r),sJ=w.createContext(void 0),ly=()=>w.useContext(sJ),iJ=w.createContext(void 0),qI=()=>w.useContext(iJ),oJ=w.createContext(void 0),lJ=w.forwardRef((e,t)=>{let r=Lh(()=>{var U,Y;return{search:"",value:(Y=(U=e.value)!=null?U:e.defaultValue)!=null?Y:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),n=Lh(()=>new Set),a=Lh(()=>new Map),i=Lh(()=>new Map),o=Lh(()=>new Set),l=cJ(e),{label:c,children:u,value:d,onValueChange:h,filter:f,shouldFilter:p,loop:m,disablePointerSelection:v=!1,vimBindings:g=!0,...x}=e,y=pn(),b=pn(),N=pn(),j=w.useRef(null),_=P7e();qd(()=>{if(d!==void 0){let U=d.trim();r.current.value=U,S.emit()}},[d]),qd(()=>{_(6,O)},[]);let S=w.useMemo(()=>({subscribe:U=>(o.current.add(U),()=>o.current.delete(U)),snapshot:()=>r.current,setState:(U,Y,ae)=>{var ie,he,se,ye;if(!Object.is(r.current[U],Y)){if(r.current[U]=Y,U==="search")A(),k(),_(1,P);else if(U==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let ne=document.getElementById(N);ne?ne.focus():(ie=document.getElementById(y))==null||ie.focus()}if(_(7,()=>{var ne;r.current.selectedItemId=(ne=I())==null?void 0:ne.id,S.emit()}),ae||_(5,O),((he=l.current)==null?void 0:he.value)!==void 0){let ne=Y??"";(ye=(se=l.current).onValueChange)==null||ye.call(se,ne);return}}S.emit()}},emit:()=>{o.current.forEach(U=>U())}}),[]),C=w.useMemo(()=>({value:(U,Y,ae)=>{var ie;Y!==((ie=i.current.get(U))==null?void 0:ie.value)&&(i.current.set(U,{value:Y,keywords:ae}),r.current.filtered.items.set(U,E(Y,ae)),_(2,()=>{k(),S.emit()}))},item:(U,Y)=>(n.current.add(U),Y&&(a.current.has(Y)?a.current.get(Y).add(U):a.current.set(Y,new Set([U]))),_(3,()=>{A(),k(),r.current.value||P(),S.emit()}),()=>{i.current.delete(U),n.current.delete(U),r.current.filtered.items.delete(U);let ae=I();_(4,()=>{A(),(ae==null?void 0:ae.getAttribute("id"))===U&&P(),S.emit()})}),group:U=>(a.current.has(U)||a.current.set(U,new Set),()=>{i.current.delete(U),a.current.delete(U)}),filter:()=>l.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>l.current.disablePointerSelection,listId:y,inputId:N,labelId:b,listInnerRef:j}),[]);function E(U,Y){var ae,ie;let he=(ie=(ae=l.current)==null?void 0:ae.filter)!=null?ie:y7e;return U?he(U,r.current.search,Y):0}function k(){if(!r.current.search||l.current.shouldFilter===!1)return;let U=r.current.filtered.items,Y=[];r.current.filtered.groups.forEach(ie=>{let he=a.current.get(ie),se=0;he.forEach(ye=>{let ne=U.get(ye);se=Math.max(ne,se)}),Y.push([ie,se])});let ae=j.current;R().sort((ie,he)=>{var se,ye;let ne=ie.getAttribute("id"),le=he.getAttribute("id");return((se=U.get(le))!=null?se:0)-((ye=U.get(ne))!=null?ye:0)}).forEach(ie=>{let he=ie.closest(kS);he?he.appendChild(ie.parentElement===he?ie:ie.closest(`${kS} > *`)):ae.appendChild(ie.parentElement===ae?ie:ie.closest(`${kS} > *`))}),Y.sort((ie,he)=>he[1]-ie[1]).forEach(ie=>{var he;let se=(he=j.current)==null?void 0:he.querySelector(`${Jm}[${Fh}="${encodeURIComponent(ie[0])}"]`);se==null||se.parentElement.appendChild(se)})}function P(){let U=R().find(ae=>ae.getAttribute("aria-disabled")!=="true"),Y=U==null?void 0:U.getAttribute(Fh);S.setState("value",Y||void 0)}function A(){var U,Y,ae,ie;if(!r.current.search||l.current.shouldFilter===!1){r.current.filtered.count=n.current.size;return}r.current.filtered.groups=new Set;let he=0;for(let se of n.current){let ye=(Y=(U=i.current.get(se))==null?void 0:U.value)!=null?Y:"",ne=(ie=(ae=i.current.get(se))==null?void 0:ae.keywords)!=null?ie:[],le=E(ye,ne);r.current.filtered.items.set(se,le),le>0&&he++}for(let[se,ye]of a.current)for(let ne of ye)if(r.current.filtered.items.get(ne)>0){r.current.filtered.groups.add(se);break}r.current.filtered.count=he}function O(){var U,Y,ae;let ie=I();ie&&(((U=ie.parentElement)==null?void 0:U.firstChild)===ie&&((ae=(Y=ie.closest(Jm))==null?void 0:Y.querySelector(x7e))==null||ae.scrollIntoView({block:"nearest"})),ie.scrollIntoView({block:"nearest"}))}function I(){var U;return(U=j.current)==null?void 0:U.querySelector(`${aJ}[aria-selected="true"]`)}function R(){var U;return Array.from(((U=j.current)==null?void 0:U.querySelectorAll(SB))||[])}function M(U){let Y=R()[U];Y&&S.setState("value",Y.getAttribute(Fh))}function B(U){var Y;let ae=I(),ie=R(),he=ie.findIndex(ye=>ye===ae),se=ie[he+U];(Y=l.current)!=null&&Y.loop&&(se=he+U<0?ie[ie.length-1]:he+U===ie.length?ie[0]:ie[he+U]),se&&S.setState("value",se.getAttribute(Fh))}function $(U){let Y=I(),ae=Y==null?void 0:Y.closest(Jm),ie;for(;ae&&!ie;)ae=U>0?k7e(ae,Jm):A7e(ae,Jm),ie=ae==null?void 0:ae.querySelector(SB);ie?S.setState("value",ie.getAttribute(Fh)):B(U)}let D=()=>M(R().length-1),W=U=>{U.preventDefault(),U.metaKey?D():U.altKey?$(1):B(1)},Z=U=>{U.preventDefault(),U.metaKey?M(0):U.altKey?$(-1):B(-1)};return w.createElement(Me.div,{ref:t,tabIndex:-1,...x,"cmdk-root":"",onKeyDown:U=>{var Y;(Y=x.onKeyDown)==null||Y.call(x,U);let ae=U.nativeEvent.isComposing||U.keyCode===229;if(!(U.defaultPrevented||ae))switch(U.key){case"n":case"j":{g&&U.ctrlKey&&W(U);break}case"ArrowDown":{W(U);break}case"p":case"k":{g&&U.ctrlKey&&Z(U);break}case"ArrowUp":{Z(U);break}case"Home":{U.preventDefault(),M(0);break}case"End":{U.preventDefault(),D();break}case"Enter":{U.preventDefault();let ie=I();if(ie){let he=new Event(TA);ie.dispatchEvent(he)}}}}},w.createElement("label",{"cmdk-label":"",htmlFor:C.inputId,id:C.labelId,style:R7e},c),l_(e,U=>w.createElement(iJ.Provider,{value:S},w.createElement(sJ.Provider,{value:C},U))))}),b7e=w.forwardRef((e,t)=>{var r,n;let a=pn(),i=w.useRef(null),o=w.useContext(oJ),l=ly(),c=cJ(e),u=(n=(r=c.current)==null?void 0:r.forceMount)!=null?n:o==null?void 0:o.forceMount;qd(()=>{if(!u)return l.item(a,o==null?void 0:o.id)},[u]);let d=uJ(a,i,[e.value,e.children,i],e.keywords),h=qI(),f=ru(_=>_.value&&_.value===d.current),p=ru(_=>u||l.filter()===!1?!0:_.search?_.filtered.items.get(a)>0:!0);w.useEffect(()=>{let _=i.current;if(!(!_||e.disabled))return _.addEventListener(TA,m),()=>_.removeEventListener(TA,m)},[p,e.onSelect,e.disabled]);function m(){var _,S;v(),(S=(_=c.current).onSelect)==null||S.call(_,d.current)}function v(){h.setState("value",d.current,!0)}if(!p)return null;let{disabled:g,value:x,onSelect:y,forceMount:b,keywords:N,...j}=e;return w.createElement(Me.div,{ref:Sl(i,t),...j,id:a,"cmdk-item":"",role:"option","aria-disabled":!!g,"aria-selected":!!f,"data-disabled":!!g,"data-selected":!!f,onPointerMove:g||l.getDisablePointerSelection()?void 0:v,onClick:g?void 0:m},e.children)}),w7e=w.forwardRef((e,t)=>{let{heading:r,children:n,forceMount:a,...i}=e,o=pn(),l=w.useRef(null),c=w.useRef(null),u=pn(),d=ly(),h=ru(p=>a||d.filter()===!1?!0:p.search?p.filtered.groups.has(o):!0);qd(()=>d.group(o),[]),uJ(o,l,[e.value,e.heading,c]);let f=w.useMemo(()=>({id:o,forceMount:a}),[a]);return w.createElement(Me.div,{ref:Sl(l,t),...i,"cmdk-group":"",role:"presentation",hidden:h?void 0:!0},r&&w.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:u},r),l_(e,p=>w.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?u:void 0},w.createElement(oJ.Provider,{value:f},p))))}),j7e=w.forwardRef((e,t)=>{let{alwaysRender:r,...n}=e,a=w.useRef(null),i=ru(o=>!o.search);return!r&&!i?null:w.createElement(Me.div,{ref:Sl(a,t),...n,"cmdk-separator":"",role:"separator"})}),N7e=w.forwardRef((e,t)=>{let{onValueChange:r,...n}=e,a=e.value!=null,i=qI(),o=ru(u=>u.search),l=ru(u=>u.selectedItemId),c=ly();return w.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),w.createElement(Me.input,{ref:t,...n,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":l,id:c.inputId,type:"text",value:a?e.value:o,onChange:u=>{a||i.setState("search",u.target.value),r==null||r(u.target.value)}})}),_7e=w.forwardRef((e,t)=>{let{children:r,label:n="Suggestions",...a}=e,i=w.useRef(null),o=w.useRef(null),l=ru(u=>u.selectedItemId),c=ly();return w.useEffect(()=>{if(o.current&&i.current){let u=o.current,d=i.current,h,f=new ResizeObserver(()=>{h=requestAnimationFrame(()=>{let p=u.offsetHeight;d.style.setProperty("--cmdk-list-height",p.toFixed(1)+"px")})});return f.observe(u),()=>{cancelAnimationFrame(h),f.unobserve(u)}}},[]),w.createElement(Me.div,{ref:Sl(i,t),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":l,"aria-label":n,id:c.listId},l_(e,u=>w.createElement("div",{ref:Sl(o,c.listInnerRef),"cmdk-list-sizer":""},u)))}),S7e=w.forwardRef((e,t)=>{let{open:r,onOpenChange:n,overlayClassName:a,contentClassName:i,container:o,...l}=e;return w.createElement(Hj,{open:r,onOpenChange:n},w.createElement(Kj,{container:o},w.createElement(tm,{"cmdk-overlay":"",className:a}),w.createElement(rm,{"aria-label":e.label,"cmdk-dialog":"",className:i},w.createElement(lJ,{ref:t,...l}))))}),C7e=w.forwardRef((e,t)=>ru(r=>r.filtered.count===0)?w.createElement(Me.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),E7e=w.forwardRef((e,t)=>{let{progress:r,children:n,label:a="Loading...",...i}=e;return w.createElement(Me.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},l_(e,o=>w.createElement("div",{"aria-hidden":!0},o)))}),fs=Object.assign(lJ,{List:_7e,Item:b7e,Input:N7e,Group:w7e,Separator:j7e,Dialog:S7e,Empty:C7e,Loading:E7e});function k7e(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function A7e(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function cJ(e){let t=w.useRef(e);return qd(()=>{t.current=e}),t}var qd=typeof window>"u"?w.useEffect:w.useLayoutEffect;function Lh(e){let t=w.useRef();return t.current===void 0&&(t.current=e()),t}function ru(e){let t=qI(),r=()=>e(t.snapshot());return w.useSyncExternalStore(t.subscribe,r,r)}function uJ(e,t,r,n=[]){let a=w.useRef(),i=ly();return qd(()=>{var o;let l=(()=>{var u;for(let d of r){if(typeof d=="string")return d.trim();if(typeof d=="object"&&"current"in d)return d.current?(u=d.current.textContent)==null?void 0:u.trim():a.current}})(),c=n.map(u=>u.trim());i.value(e,l,c),(o=t.current)==null||o.setAttribute(Fh,l),a.current=l}),a}var P7e=()=>{let[e,t]=w.useState(),r=Lh(()=>new Map);return qd(()=>{r.current.forEach(n=>n()),r.current=new Map},[e]),(n,a)=>{r.current.set(n,a),t({})}};function T7e(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function l_({asChild:e,children:t},r){return e&&w.isValidElement(t)?w.cloneElement(T7e(t),{ref:t.ref},r(t.props.children)):r(t)}var R7e={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const dJ=w.forwardRef(({className:e,...t},r)=>s.jsx(fs,{ref:r,className:me("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));dJ.displayName=fs.displayName;const hJ=w.forwardRef(({className:e,...t},r)=>s.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[s.jsx(Cl,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),s.jsx(fs.Input,{ref:r,className:me("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));hJ.displayName=fs.Input.displayName;const O7e=w.forwardRef(({className:e,...t},r)=>s.jsx(fs.List,{ref:r,className:me("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));O7e.displayName=fs.List.displayName;const fJ=w.forwardRef((e,t)=>s.jsx(fs.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));fJ.displayName=fs.Empty.displayName;const pJ=w.forwardRef(({className:e,...t},r)=>s.jsx(fs.Group,{ref:r,className:me("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));pJ.displayName=fs.Group.displayName;const I7e=w.forwardRef(({className:e,...t},r)=>s.jsx(fs.Separator,{ref:r,className:me("-mx-1 h-px bg-border",e),...t}));I7e.displayName=fs.Separator.displayName;const mJ=w.forwardRef(({className:e,...t},r)=>s.jsx(fs.Item,{ref:r,className:me("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e),...t}));mJ.displayName=fs.Item.displayName;var c_="Popover",[vJ,_Qe]=an(c_,[lu]),cy=lu(),[D7e,Su]=vJ(c_),gJ=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:i,modal:o=!1}=e,l=cy(t),c=w.useRef(null),[u,d]=w.useState(!1),[h,f]=Ba({prop:n,defaultProp:a??!1,onChange:i,caller:c_});return s.jsx(fj,{...l,children:s.jsx(D7e,{scope:t,contentId:pn(),triggerRef:c,open:h,onOpenChange:f,onOpenToggle:w.useCallback(()=>f(p=>!p),[f]),hasCustomAnchor:u,onCustomAnchorAdd:w.useCallback(()=>d(!0),[]),onCustomAnchorRemove:w.useCallback(()=>d(!1),[]),modal:o,children:r})})};gJ.displayName=c_;var xJ="PopoverAnchor",M7e=w.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=Su(xJ,r),i=cy(r),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=a;return w.useEffect(()=>(o(),()=>l()),[o,l]),s.jsx(Sx,{...i,...n,ref:t})});M7e.displayName=xJ;var yJ="PopoverTrigger",bJ=w.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=Su(yJ,r),i=cy(r),o=ct(t,a.triggerRef),l=s.jsx(Me.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":SJ(a.open),...n,ref:o,onClick:Ne(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?l:s.jsx(Sx,{asChild:!0,...i,children:l})});bJ.displayName=yJ;var GI="PopoverPortal",[$7e,F7e]=vJ(GI,{forceMount:void 0}),wJ=e=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=e,i=Su(GI,t);return s.jsx($7e,{scope:t,forceMount:r,children:s.jsx(gn,{present:r||i.open,children:s.jsx(Vp,{asChild:!0,container:a,children:n})})})};wJ.displayName=GI;var Tp="PopoverContent",jJ=w.forwardRef((e,t)=>{const r=F7e(Tp,e.__scopePopover),{forceMount:n=r.forceMount,...a}=e,i=Su(Tp,e.__scopePopover);return s.jsx(gn,{present:n||i.open,children:i.modal?s.jsx(B7e,{...a,ref:t}):s.jsx(U7e,{...a,ref:t})})});jJ.displayName=Tp;var L7e=Xc("PopoverContent.RemoveScroll"),B7e=w.forwardRef((e,t)=>{const r=Su(Tp,e.__scopePopover),n=w.useRef(null),a=ct(t,n),i=w.useRef(!1);return w.useEffect(()=>{const o=n.current;if(o)return Uj(o)},[]),s.jsx(Vx,{as:L7e,allowPinchZoom:!0,children:s.jsx(NJ,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ne(e.onCloseAutoFocus,o=>{var l;o.preventDefault(),i.current||(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:Ne(e.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;i.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:Ne(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),U7e=w.forwardRef((e,t)=>{const r=Su(Tp,e.__scopePopover),n=w.useRef(!1),a=w.useRef(!1);return s.jsx(NJ,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{var c,u;(c=e.onInteractOutside)==null||c.call(e,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((u=r.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),NJ=w.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:d,...h}=e,f=Su(Tp,r),p=cy(r);return Bj(),s.jsx(Bx,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:s.jsx(Yd,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:d,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>f.onOpenChange(!1),children:s.jsx(pj,{"data-state":SJ(f.open),role:"dialog",id:f.contentId,...p,...h,ref:t,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),_J="PopoverClose",V7e=w.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=Su(_J,r);return s.jsx(Me.button,{type:"button",...n,ref:t,onClick:Ne(e.onClick,()=>a.onOpenChange(!1))})});V7e.displayName=_J;var z7e="PopoverArrow",W7e=w.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=cy(r);return s.jsx(mj,{...a,...n,ref:t})});W7e.displayName=z7e;function SJ(e){return e?"open":"closed"}var q7e=gJ,G7e=bJ,H7e=wJ,CJ=jJ;const K7e=q7e,Y7e=G7e,EJ=w.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},a)=>s.jsx(H7e,{children:s.jsx(CJ,{ref:a,align:t,sideOffset:r,className:me("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));EJ.displayName=CJ.displayName;function X7e(){const{toast:e}=Et(),[t,r]=w.useState(!1),[n,a]=w.useState([]),[i,o]=w.useState(null),[l,c]=w.useState(!0);w.useEffect(()=>{u()},[]);const u=async()=>{try{const{data:{user:f}}=await T.auth.getUser();if(!f)return;const{data:p}=await T.from("vai_verifications").select("vai_number").eq("user_id",f.id).eq("is_business_vai",!1).maybeSingle(),{data:m}=await T.from("business_employees").select("business_vai_number, business_id, businesses(business_name)").eq("employee_user_id",f.id).eq("status","active"),v=[];p&&v.push({value:"personal",label:"Personal V.A.I.",type:"personal",vaiNumber:p.vai_number}),m&&m.forEach(x=>{var y;v.push({value:`business-${x.business_id}`,label:((y=x.businesses)==null?void 0:y.business_name)||"Business",type:"business",businessId:x.business_id,vaiNumber:x.business_vai_number})}),a(v);const{data:g}=await T.from("active_vai_context").select("*").eq("user_id",f.id).maybeSingle();if(g){const x=v.find(y=>y.vaiNumber===g.active_vai_number);o(x||v[0])}else if(v.length>0){const x=v.find(y=>y.type==="personal")||v[0];o(x),await d(x)}}catch(f){e({title:"Error",description:f.message,variant:"destructive"})}finally{c(!1)}},d=async f=>{try{const{data:{user:p}}=await T.auth.getUser();if(!p)return;const{error:m}=await T.from("active_vai_context").upsert({user_id:p.id,active_vai_type:f.type,active_business_id:f.businessId||null,active_vai_number:f.vaiNumber});if(m)throw m}catch(p){e({title:"Error",description:p.message,variant:"destructive"})}},h=async f=>{o(f),r(!1),await d(f),e({title:"V.A.I. Switched",description:`Now operating under: ${f.label}`})};return l||n.length===0?null:s.jsxs(K7e,{open:t,onOpenChange:r,children:[s.jsx(Y7e,{asChild:!0,children:s.jsxs(L,{variant:"outline",role:"combobox","aria-expanded":t,className:"w-full justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[(i==null?void 0:i.type)==="personal"?s.jsx(fn,{className:"h-4 w-4"}):s.jsx(_o,{className:"h-4 w-4"}),s.jsx("span",{children:(i==null?void 0:i.label)||"Select V.A.I."})]}),s.jsx(nae,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),s.jsx(EJ,{className:"w-full p-0",children:s.jsxs(dJ,{children:[s.jsx(hJ,{placeholder:"Search V.A.I..."}),s.jsx(fJ,{children:"No V.A.I. found."}),s.jsx(pJ,{children:n.map(f=>s.jsxs(mJ,{value:f.value,onSelect:()=>h(f),children:[s.jsx($t,{className:me("mr-2 h-4 w-4",(i==null?void 0:i.value)===f.value?"opacity-100":"opacity-0")}),s.jsxs("div",{className:"flex items-center gap-2",children:[f.type==="personal"?s.jsx(fn,{className:"h-4 w-4"}):s.jsx(_o,{className:"h-4 w-4"}),s.jsxs("div",{children:[s.jsx("div",{children:f.label}),s.jsx("div",{className:"text-xs text-muted-foreground font-mono",children:f.vaiNumber})]})]})]},f.value))})]})})]})}function Q7e(){const e=Oe(),[t,r]=w.useState(!1),[n,a]=w.useState(!1),[i,o]=w.useState(""),[l,c]=w.useState(""),u=async()=>{if(i!==l){H.error("Passwords don't match");return}if(i.length<8){H.error("Password must be at least 8 characters");return}r(!0);try{const{error:f}=await T.auth.updateUser({password:i});if(f)throw f;H.success("Password updated successfully!"),o(""),c("")}catch(f){console.error("Error changing password:",f),H.error("Failed to update password")}finally{r(!1)}},d=async()=>{a(!0);try{H.success("Account deletion initiated. You'll receive a confirmation email."),await T.auth.signOut(),e("/")}catch(f){console.error("Error deleting account:",f),H.error("Failed to delete account")}finally{a(!1)}},h=async()=>{try{H.info("Preparing your data for download..."),await new Promise(f=>setTimeout(f,2e3)),H.success("Your data has been sent to your email")}catch(f){console.error("Error downloading data:",f),H.error("Failed to download data")}};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center gap-2",children:[s.jsx(lt,{className:"w-5 h-5"}),"Active V.A.I."]}),s.jsx(Re,{children:"Switch between your personal and business V.A.I. identities"})]}),s.jsx(ee,{children:s.jsx(X7e,{})})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center gap-2",children:[s.jsx(Or,{className:"w-5 h-5"}),"Security"]}),s.jsx(Re,{children:"Manage your password and security settings"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"new_password",children:"New Password"}),s.jsx(De,{id:"new_password",type:"password",value:i,onChange:f=>o(f.target.value),placeholder:"Enter new password"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"confirm_password",children:"Confirm Password"}),s.jsx(De,{id:"confirm_password",type:"password",value:l,onChange:f=>c(f.target.value),placeholder:"Confirm new password"})]}),s.jsx(L,{onClick:u,disabled:t||!i||!l,children:t?s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"w-4 h-4 mr-2 animate-spin"}),"Updating..."]}):"Change Password"})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center gap-2",children:[s.jsx(lt,{className:"w-5 h-5"}),"Privacy & Data"]}),s.jsx(Re,{children:"Control your data and privacy settings"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border border-border rounded-lg hover:bg-accent/50 cursor-pointer transition-colors",onClick:()=>e("/activity"),children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Activity Timeline"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"View your complete activity history"})]}),s.jsxs(L,{variant:"outline",onClick:f=>{f.stopPropagation(),e("/activity")},children:[s.jsx(sz,{className:"w-4 h-4 mr-2"}),"View Timeline"]})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 border border-border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Download Your Data"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Export all your account data and activity"})]}),s.jsxs(L,{variant:"outline",onClick:h,children:[s.jsx(uT,{className:"w-4 h-4 mr-2"}),"Download"]})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 border border-border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Two-Factor Authentication"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Add an extra layer of security to your account"})]}),s.jsx(L,{variant:"outline",disabled:!0,children:"Coming Soon"})]})]})]}),s.jsxs(q,{className:"border-destructive/50",children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center gap-2 text-destructive",children:[s.jsx(Qc,{className:"w-5 h-5"}),"Danger Zone"]}),s.jsx(Re,{children:"Irreversible and destructive actions"})]}),s.jsx(ee,{children:s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"p-4 border border-destructive/50 rounded-lg bg-destructive/5",children:[s.jsx("h3",{className:"font-medium text-destructive mb-2",children:"Delete Account"}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Once you delete your account, there is no going back. This will permanently delete:"}),s.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 mb-4 pl-4",children:[s.jsx("li",{children:" Your profile and all personal information"}),s.jsx("li",{children:" All VAI-CHECK verifications and history"}),s.jsx("li",{children:" DateGuard sessions and guardian connections"}),s.jsx("li",{children:" Reviews and ratings you've received"}),s.jsx("li",{children:" Referral earnings and pending payouts"})]}),s.jsxs(sO,{children:[s.jsx(E9,{asChild:!0,children:s.jsxs(L,{variant:"destructive",children:[s.jsx(Qc,{className:"w-4 h-4 mr-2"}),"Delete My Account"]})}),s.jsxs(Qj,{children:[s.jsxs(Zj,{children:[s.jsx(eN,{children:"Are you absolutely sure?"}),s.jsx(tN,{children:"This action cannot be undone. This will permanently delete your account and remove all your data from our servers."})]}),s.jsxs(Jj,{children:[s.jsx(nN,{children:"Cancel"}),s.jsx(rN,{onClick:d,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"w-4 h-4 mr-2 animate-spin"}),"Deleting..."]}):"Yes, delete my account"})]})]})]})]})})})]})]})}const uy=({isVerified:e,vaiNumber:t,size:r="md",showNumber:n=!0})=>{const a={sm:"text-xs px-2 py-1",md:"text-sm px-3 py-1.5",lg:"text-base px-4 py-2"},i={sm:12,md:16,lg:20};return e?s.jsx(BC,{children:s.jsxs(HD,{children:[s.jsx(KD,{children:s.jsxs(xe,{variant:"default",className:`${a[r]} flex items-center gap-2 bg-gradient-to-r from-primary to-primary-glow`,children:[s.jsx(lt,{size:i[r],className:"fill-current"}),s.jsx("span",{className:"font-semibold",children:"V.A.I. VERIFIED"}),n&&t&&s.jsxs("span",{className:"ml-1 opacity-90",children:["#",t]}),s.jsx(ut,{size:i[r]})]})}),s.jsx(UC,{children:s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"font-semibold",children:"Verified Anonymous Identity"}),t&&s.jsxs("p",{className:"text-xs",children:["V.A.I. Number: ",t]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"This user has completed identity verification"})]})})]})}):s.jsx(BC,{children:s.jsxs(HD,{children:[s.jsx(KD,{children:s.jsxs(xe,{variant:"secondary",className:`${a[r]} flex items-center gap-2`,children:[s.jsx(Xs,{size:i[r]}),s.jsx("span",{children:"Not Verified"})]})}),s.jsx(UC,{children:s.jsx("p",{children:"This user has not completed V.A.I. verification"})})]})})};function Z7e(){const e=Oe(),{toast:t}=Et(),[r,n]=w.useState(null),[a,i]=w.useState(!0);w.useEffect(()=>{o()},[]);const o=async()=>{try{const{data:{user:c}}=await T.auth.getUser();if(!c)return;const{data:u,error:d}=await T.from("vai_verifications").select("*").eq("user_id",c.id).maybeSingle();if(d&&d.code!=="PGRST116")throw d;n(u)}catch{t({title:"Error",description:"Failed to load V.A.I. status",variant:"destructive"})}finally{i(!1)}},l=()=>{const c=`${window.location.origin}/vai-callback`,u=`https://platform.chainpass.com/verify?redirect=${encodeURIComponent(c)}`;window.location.href=u};return a?s.jsx("div",{className:"space-y-4",children:s.jsx(q,{children:s.jsx(ee,{className:"pt-6",children:s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs(q,{children:[s.jsx(ge,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(lt,{className:"w-6 h-6 text-primary"}),s.jsxs("div",{children:[s.jsx(be,{children:"V.A.I. Verification"}),s.jsx(Re,{children:"Verified Anonymous Identity"})]})]}),s.jsx(uy,{isVerified:!!r,vaiNumber:r==null?void 0:r.vai_number,size:"md",showNumber:!1})]})}),s.jsx(ee,{className:"space-y-4",children:r?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid gap-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(ut,{className:"w-5 h-5 text-green-500"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"V.A.I. Number"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Your verified anonymous identity"})]})]}),s.jsx(xe,{variant:"secondary",className:"text-lg font-mono",children:r.vai_number})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Verified Since"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(r.created_at).toLocaleDateString()})]}),s.jsx(xe,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/20",children:"Active"})]})]}),s.jsxs(L,{onClick:()=>e("/vai-management"),className:"w-full",variant:"outline",children:["Manage V.A.I. Details",s.jsx(ez,{className:"w-4 h-4 ml-2"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs(Hn,{children:[s.jsx(Xs,{className:"h-4 w-4"}),s.jsx(Kn,{children:"You haven't completed V.A.I. verification yet. Verify your identity to unlock enhanced security features and build trust with the community."})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(ut,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Enhanced Security"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Protect your identity while building trust"})]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(ut,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Community Trust"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Verified members get priority visibility"})]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(ut,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Access Premium Features"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Unlock DateGuard, VAI-CHECK, and more"})]})]})]}),s.jsxs(L,{onClick:l,className:"w-full",children:[s.jsx(lt,{className:"w-4 h-4 mr-2"}),"Start V.A.I. Verification"]})]})})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"V.A.I. Benefits"}),s.jsx(Re,{children:"Why verify your identity?"})]}),s.jsxs(ee,{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted rounded-lg",children:[s.jsx(lt,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Priority Access"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"V.A.I. verified users appear first in search results"})]})]}),s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted rounded-lg",children:[s.jsx(lt,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Premium Features"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Access DateGuard safety features and VAI-CHECK encounters"})]})]}),s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted rounded-lg",children:[s.jsx(lt,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Community Trust"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Build credibility and attract more clients"})]})]})]})]})]})}const J7e=()=>{const[e,t]=w.useState(!0),[r,n]=w.useState(!1),{toast:a}=Et(),[i,o]=w.useState({profile_visibility:"public",location_visibility:"city",online_status_visible:!0,show_last_active:!0,allow_screenshots:!0,show_in_search:!0,allow_messages_from:"everyone"});w.useEffect(()=>{l()},[]);const l=async()=>{try{const{data:{user:d}}=await T.auth.getUser();if(!d)return;const{data:h,error:f}=await T.from("privacy_settings").select("*").eq("user_id",d.id).single();if(f&&f.code!=="PGRST116")throw f;h&&o({profile_visibility:h.profile_visibility,location_visibility:h.location_visibility,online_status_visible:h.online_status_visible,show_last_active:h.show_last_active,allow_screenshots:h.allow_screenshots,show_in_search:h.show_in_search,allow_messages_from:h.allow_messages_from})}catch(d){console.error("Error loading privacy settings:",d)}finally{t(!1)}},c=async()=>{n(!0);try{const{data:{user:d}}=await T.auth.getUser();if(!d)return;const{error:h}=await T.from("privacy_settings").upsert({user_id:d.id,...i,updated_at:new Date().toISOString()});if(h)throw h;a({title:"Privacy settings updated",description:"Your privacy preferences have been saved."})}catch(d){console.error("Error saving privacy settings:",d),a({title:"Error",description:"Failed to save privacy settings. Please try again.",variant:"destructive"})}finally{n(!1)}},u=(d,h)=>{o(f=>({...f,[d]:h}))};return e?s.jsx(q,{children:s.jsx(ee,{className:"flex items-center justify-center py-8",children:s.jsx(Er,{className:"w-6 h-6 animate-spin text-muted-foreground"})})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ri,{className:"w-5 h-5 text-primary"}),s.jsx(be,{children:"Profile Visibility"})]}),s.jsx(Re,{children:"Control who can view your profile and posts"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"profile-visibility",children:"Profile Visibility"}),s.jsxs(At,{value:i.profile_visibility,onValueChange:d=>u("profile_visibility",d),children:[s.jsx(_t,{id:"profile-visibility",children:s.jsx(Pt,{})}),s.jsxs(St,{children:[s.jsx(re,{value:"public",children:"Public - Everyone can see"}),s.jsx(re,{value:"members_only",children:"Members Only"}),s.jsx(re,{value:"private",children:"Private - Only approved users"})]})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx(de,{children:"Show in search results"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow your profile to appear in directory searches"})]}),s.jsx(Yt,{checked:i.show_in_search,onCheckedChange:d=>u("show_in_search",d)})]})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(hn,{className:"w-5 h-5 text-primary"}),s.jsx(be,{children:"Location Privacy"})]}),s.jsx(Re,{children:"Choose how much location information to share"})]}),s.jsx(ee,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"location-visibility",children:"Location Display"}),s.jsxs(At,{value:i.location_visibility,onValueChange:d=>u("location_visibility",d),children:[s.jsx(_t,{id:"location-visibility",children:s.jsx(Pt,{})}),s.jsxs(St,{children:[s.jsx(re,{value:"exact",children:"Exact Location"}),s.jsx(re,{value:"city",children:"City Only"}),s.jsx(re,{value:"state",children:"State Only"}),s.jsx(re,{value:"hidden",children:"Hidden"})]})]})]})})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(An,{className:"w-5 h-5 text-primary"}),s.jsx(be,{children:"Activity & Status"})]}),s.jsx(Re,{children:"Manage your online presence visibility"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx(de,{children:"Show online status"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Let others see when you're online"})]}),s.jsx(Yt,{checked:i.online_status_visible,onCheckedChange:d=>u("online_status_visible",d)})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx(de,{children:"Show last active"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Display when you were last active"})]}),s.jsx(Yt,{checked:i.show_last_active,onCheckedChange:d=>u("show_last_active",d)})]})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(lt,{className:"w-5 h-5 text-primary"}),s.jsx(be,{children:"Content Protection"})]}),s.jsx(Re,{children:"Protect your content from unauthorized use"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx(de,{children:"Screenshot detection"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Warn when screenshots might be taken (when supported)"})]}),s.jsx(Yt,{checked:!i.allow_screenshots,onCheckedChange:d=>u("allow_screenshots",!d)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"messages-from",children:"Accept messages from"}),s.jsxs(At,{value:i.allow_messages_from,onValueChange:d=>u("allow_messages_from",d),children:[s.jsx(_t,{id:"messages-from",children:s.jsx(Pt,{})}),s.jsxs(St,{children:[s.jsx(re,{value:"everyone",children:"Everyone"}),s.jsx(re,{value:"verified_only",children:"V.A.I. Verified Only"}),s.jsx(re,{value:"favorites_only",children:"Favorites Only"})]})]})]})]})]}),s.jsxs(L,{onClick:c,disabled:r,className:"w-full",children:[r&&s.jsx(Er,{className:"w-4 h-4 mr-2 animate-spin"}),"Save Privacy Settings"]})]})};function eKe(){const e=Oe(),[t,r]=w.useState("profile");return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"sticky top-0 z-10 bg-background border-b border-border px-4 py-3",children:s.jsxs("div",{className:"max-w-4xl mx-auto flex items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/feed"),children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsx("h1",{className:"text-xl font-bold text-foreground",children:"Settings"})]})}),s.jsx("main",{className:"max-w-4xl mx-auto px-4 py-6",children:s.jsxs(Ga,{value:t,onValueChange:r,className:"w-full",children:[s.jsxs(Aa,{className:"grid w-full grid-cols-6 mb-6",children:[s.jsx(mt,{value:"profile",children:"Profile"}),s.jsx(mt,{value:"vai",children:"V.A.I."}),s.jsx(mt,{value:"privacy",children:"Privacy"}),s.jsx(mt,{value:"membership",children:"Membership"}),s.jsx(mt,{value:"notifications",children:"Notifications"}),s.jsx(mt,{value:"account",children:"Account"})]}),s.jsx(Rt,{value:"profile",className:"space-y-4",children:s.jsx(i7e,{})}),s.jsx(Rt,{value:"vai",className:"space-y-4",children:s.jsx(Z7e,{})}),s.jsx(Rt,{value:"privacy",className:"space-y-4",children:s.jsx(J7e,{})}),s.jsx(Rt,{value:"membership",className:"space-y-4",children:s.jsx(o7e,{})}),s.jsx(Rt,{value:"notifications",className:"space-y-4",children:s.jsx(l7e,{})}),s.jsx(Rt,{value:"account",className:"space-y-4",children:s.jsx(Q7e,{})})]})})]})}function rd({className:e,...t}){return s.jsx("div",{className:me("animate-pulse rounded-md bg-muted",e),...t})}function tKe(){const e=Oe(),{data:t,isLoading:r}=Rd({queryKey:["referral-leaderboard"],queryFn:async()=>{const{data:i,error:o}=await T.from("referral_leaderboard").select("*");if(o)throw o;return i||[]}}),{data:n}=Rd({queryKey:["active-competitions"],queryFn:async()=>{const{data:i,error:o}=await T.from("country_representative_competitions").select("*").eq("status","active").order("competition_end_date",{ascending:!0});if(o)throw o;return i||[]}}),a=i=>{switch(i){case 0:return s.jsx(og,{className:"h-6 w-6 text-yellow-500"});case 1:return s.jsx(dae,{className:"h-6 w-6 text-gray-400"});case 2:return s.jsx(aj,{className:"h-6 w-6 text-amber-600"});default:return null}};return r?s.jsx("div",{className:"min-h-screen bg-background",children:s.jsx("div",{className:"container mx-auto px-4 py-6",children:s.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(i=>s.jsx(q,{className:"p-6",children:s.jsx(rd,{className:"h-20 w-full"})},i))})})}):s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("div",{className:"sticky top-0 z-10 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-border",children:s.jsx("div",{className:"container mx-auto px-4 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/referrals"),children:s.jsx(Xd,{className:"h-5 w-5"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(en,{className:"h-6 w-6 text-primary"}),s.jsx("h1",{className:"text-2xl font-bold",children:"Referral Leaderboard"})]})]})})}),s.jsxs("div",{className:"container mx-auto px-4 py-6 space-y-6",children:[n&&n.length>0&&s.jsxs(q,{className:"p-6 bg-gradient-to-r from-primary/10 to-primary/5 border-primary/20",children:[s.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(og,{className:"h-5 w-5 text-primary"}),"Active Country Competitions"]}),s.jsx("div",{className:"space-y-3",children:n.map(i=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:i.country_name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Ends: ",Mr(new Date(i.competition_end_date),"MMM d, yyyy")]})]}),s.jsx(xe,{children:"Active"})]},i.id))})]}),t&&t.length>0&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.slice(0,3).map((i,o)=>{var l;return s.jsxs(q,{className:"p-6 text-center relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-4 right-4",children:a(o)}),s.jsxs(Yi,{className:"h-20 w-20 mx-auto mb-4",children:[s.jsx(Xi,{src:i.avatar_url||void 0}),s.jsx(Qi,{children:(l=i.display_name)==null?void 0:l.charAt(0).toUpperCase()})]}),s.jsx("h3",{className:"font-semibold text-lg mb-1",children:i.display_name}),s.jsx("p",{className:"text-3xl font-bold text-primary mb-2",children:i.total_referrals}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Referrals"}),s.jsx("div",{className:"mt-4 pt-4 border-t border-border",children:s.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.provider_referrals," provider referrals"]})})]},i.user_id)})}),s.jsxs(q,{children:[s.jsx("div",{className:"p-6 border-b border-border",children:s.jsx("h3",{className:"text-lg font-semibold",children:"All Referrers"})}),s.jsx("div",{className:"divide-y divide-border",children:t==null?void 0:t.map((i,o)=>{var l;return s.jsxs("div",{className:"p-6 flex items-center justify-between hover:bg-accent/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[s.jsxs("div",{className:"w-8 text-center font-semibold text-muted-foreground",children:["#",o+1]}),o<3&&s.jsx("div",{className:"w-6",children:a(o)}),s.jsxs(Yi,{children:[s.jsx(Xi,{src:i.avatar_url||void 0}),s.jsx(Qi,{children:(l=i.display_name)==null?void 0:l.charAt(0).toUpperCase()})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-semibold",children:i.display_name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Last referral: ",Mr(new Date(i.last_referral_date),"MMM d, yyyy")]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-2xl font-bold text-primary",children:i.total_referrals}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.provider_referrals," providers"]})]})]},i.user_id)})})]}),(t==null?void 0:t.length)===0&&s.jsxs(q,{className:"p-12 text-center",children:[s.jsx(en,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Referrals Yet"}),s.jsx("p",{className:"text-muted-foreground",children:"Start referring members to see your ranking here."})]})]})]})}function rKe(){var S;const e=Oe(),{toast:t}=Et(),[r,n]=w.useState([]),[a,i]=w.useState(null),[o,l]=w.useState([]),[c,u]=w.useState(""),[d,h]=w.useState(""),[f,p]=w.useState("");w.useState(new Set),w.useState(!1);const m=w.useRef(null);w.useRef();const v=()=>{var C;(C=m.current)==null||C.scrollIntoView({behavior:"smooth"})};w.useEffect(()=>{g(),x()},[]),w.useEffect(()=>{a&&(y(a),b(a))},[a]),w.useEffect(()=>{v()},[o]);const g=async()=>{const{data:{user:C}}=await T.auth.getUser();C&&h(C.id)},x=async()=>{const{data:{user:C}}=await T.auth.getUser();if(!C)return;const{data:E,error:k}=await T.from("conversations").select("*").or(`participant_1_id.eq.${C.id},participant_2_id.eq.${C.id}`).order("last_message_at",{ascending:!1});if(k){t({title:"Error",description:"Failed to load conversations",variant:"destructive"});return}const P=await Promise.all((E||[]).map(async A=>{const O=A.participant_1_id===C.id?A.participant_2_id:A.participant_1_id,{data:I}=await T.from("profiles").select("id, full_name, avatar_url").eq("id",O).single();return{...A,otherUser:I||{id:O,full_name:"Unknown User",avatar_url:null}}}));n(P)},y=async C=>{const{data:E,error:k}=await T.from("messages").select("*").eq("conversation_id",C).order("created_at",{ascending:!0});if(k){t({title:"Error",description:"Failed to load messages",variant:"destructive"});return}l(E||[]);const P=(E||[]).filter(A=>A.recipient_id===d&&!A.read_at);P.length>0&&await T.from("messages").update({read_at:new Date().toISOString()}).in("id",P.map(A=>A.id))},b=C=>{const E=T.channel(`messages-${C}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`conversation_id=eq.${C}`},k=>{l(P=>[...P,k.new])}).subscribe();return()=>{T.removeChannel(E)}},N=async()=>{if(!c.trim()||!a)return;const C=r.find(P=>P.id===a);if(!C)return;const E=C.participant_1_id===d?C.participant_2_id:C.participant_1_id,{error:k}=await T.from("messages").insert({conversation_id:a,sender_id:d,recipient_id:E,content:c});if(k){t({title:"Error",description:"Failed to send message",variant:"destructive"});return}await T.from("conversations").update({last_message_at:new Date().toISOString()}).eq("id",a),u(""),x()},j=r.filter(C=>C.otherUser.full_name.toLowerCase().includes(f.toLowerCase())),_=r.find(C=>C.id===a);return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"sticky top-0 z-50 border-b border-border bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60",children:s.jsxs("div",{className:"container flex h-16 items-center px-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/feed"),children:s.jsx(ze,{className:"h-5 w-5"})}),s.jsx("h1",{className:"ml-2 text-xl font-semibold text-foreground",children:"Messages"})]})}),s.jsx("div",{className:"container mx-auto max-w-7xl p-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 h-[calc(100vh-120px)]",children:[s.jsxs(q,{className:"col-span-1 p-4 flex flex-col",children:[s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx(Cl,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),s.jsx(De,{placeholder:"Search conversations...",className:"pl-10",value:f,onChange:C=>p(C.target.value)})]})}),s.jsx(yl,{className:"flex-1",children:j.length===0?s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No conversations yet"}):j.map(C=>{var E;return s.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg cursor-pointer mb-2 transition-colors ${a===C.id?"bg-primary/10":"hover:bg-accent"}`,onClick:()=>i(C.id),children:[s.jsxs(Yi,{children:[s.jsx(Xi,{src:C.otherUser.avatar_url||void 0}),s.jsx(Qi,{children:((E=C.otherUser.full_name)==null?void 0:E.charAt(0))||"?"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-sm truncate",children:C.otherUser.full_name}),s.jsx("p",{className:"text-xs text-muted-foreground truncate",children:new Date(C.last_message_at).toLocaleDateString()})]})]},C.id)})})]}),s.jsx(q,{className:"col-span-1 md:col-span-2 p-4 flex flex-col",children:a?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center gap-3 pb-4 border-b border-border mb-4",children:[s.jsxs(Yi,{children:[s.jsx(Xi,{src:(_==null?void 0:_.otherUser.avatar_url)||void 0}),s.jsx(Qi,{children:((S=_==null?void 0:_.otherUser.full_name)==null?void 0:S.charAt(0))||"?"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:_==null?void 0:_.otherUser.full_name}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Active now"})]})]}),s.jsxs(yl,{className:"flex-1 pr-4",children:[o.map(C=>s.jsx("div",{className:`flex mb-4 ${C.sender_id===d?"justify-end":"justify-start"}`,children:s.jsxs("div",{className:`max-w-[70%] rounded-lg px-4 py-2 ${C.sender_id===d?"bg-primary text-primary-foreground":"bg-muted"}`,children:[s.jsx("p",{className:"text-sm",children:C.content}),s.jsx("p",{className:"text-xs opacity-70 mt-1",children:new Date(C.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},C.id)),s.jsx("div",{ref:m})]}),s.jsxs("div",{className:"flex gap-2 mt-4 pt-4 border-t border-border",children:[s.jsx(De,{placeholder:"Type a message...",value:c,onChange:C=>u(C.target.value),onKeyPress:C=>C.key==="Enter"&&N()}),s.jsx(L,{onClick:N,children:s.jsx(Nx,{className:"h-4 w-4"})})]})]}):s.jsx("div",{className:"flex-1 flex items-center justify-center text-muted-foreground",children:"Select a conversation to start messaging"})})]})}),s.jsx(aO,{activeTab:"chat"})]})}function kJ({open:e,onOpenChange:t,onPurchaseComplete:r}){const[n,a]=w.useState([]),[i,o]=w.useState(!0),[l,c]=w.useState(null),[u,d]=w.useState(0);w.useEffect(()=>{e&&(h(),f())},[e]);const h=async()=>{try{const{data:m,error:v}=await T.from("golden_roses_bundles").select("*").eq("is_active",!0).order("display_order");if(v)throw v;a(m||[])}catch(m){console.error("Error loading bundles:",m),H.error("Failed to load bundles")}finally{o(!1)}},f=async()=>{try{const{data:{user:m}}=await T.auth.getUser();if(!m)return;const{data:v,error:g}=await T.from("golden_roses_balance").select("balance").eq("user_id",m.id).single();if(g&&g.code!=="PGRST116")throw g;d((v==null?void 0:v.balance)||0)}catch(m){console.error("Error loading balance:",m)}},p=async m=>{try{c(m.id);const{data:{user:v}}=await T.auth.getUser();if(!v)throw new Error("Not authenticated");H.info(`Payment processing for $${m.price_usd}...`),await new Promise(_=>setTimeout(_,1500));const{data:g,error:x}=await T.from("golden_roses_balance").select("balance").eq("user_id",v.id).single(),b=((g==null?void 0:g.balance)||0)+m.roses_amount,{error:N}=await T.from("golden_roses_balance").upsert({user_id:v.id,balance:b,lifetime_earned:b});if(N)throw N;const{error:j}=await T.from("golden_roses_transactions").insert({user_id:v.id,amount:m.roses_amount,transaction_type:"purchase",description:`Purchased ${m.bundle_name}`});if(j)throw j;H.success(`Successfully purchased ${m.roses_amount} Golden Roses! `),d(b),r==null||r()}catch(v){console.error("Error purchasing bundle:",v),H.error("Failed to complete purchase")}finally{c(null)}};return s.jsx(Ca,{open:e,onOpenChange:t,children:s.jsxs(oa,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx(Ea,{children:s.jsxs(ka,{className:"flex items-center gap-2 text-2xl",children:[s.jsx(kd,{className:"h-6 w-6 text-yellow-500"}),"Purchase Golden Roses"]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsx(q,{className:"p-4 bg-gradient-to-r from-yellow-500/10 to-orange-500/10 border-yellow-500/20",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Current Balance"}),s.jsxs("p",{className:"text-3xl font-bold text-yellow-500",children:[u," "]})]})}),i?s.jsx("div",{className:"space-y-4",children:[1,2].map(m=>s.jsx("div",{className:"h-32 bg-muted animate-pulse rounded-lg"},m))}):s.jsx("div",{className:"grid gap-4",children:n.map(m=>s.jsx(q,{className:"p-6 hover:shadow-lg transition-shadow border-2 hover:border-primary/50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h3",{className:"text-xl font-bold",children:m.bundle_name}),m.price_usd===30&&s.jsx(xe,{variant:"secondary",className:"bg-gradient-to-r from-yellow-500 to-orange-500 text-white",children:"Best Value"})]}),s.jsxs("div",{className:"flex items-baseline gap-2 mb-3",children:[s.jsx("span",{className:"text-3xl font-bold text-yellow-500",children:m.roses_amount}),s.jsx("span",{className:"text-lg text-muted-foreground",children:"Golden Roses "})]}),s.jsxs("ul",{className:"space-y-1 text-sm text-muted-foreground",children:[s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx($t,{className:"h-4 w-4 text-green-500"}),"Boost your marketplace posts"]}),s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx($t,{className:"h-4 w-4 text-green-500"}),"Premium directory placement"]}),s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx($t,{className:"h-4 w-4 text-green-500"}),"Increase visibility & engagement"]})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-3 ml-6",children:[s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-3xl font-bold",children:["$",m.price_usd]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",(m.price_usd/m.roses_amount).toFixed(3),"/rose"]})]}),s.jsx(L,{size:"lg",onClick:()=>p(m),disabled:l!==null,className:"min-w-[120px]",children:l===m.id?"Processing...":"Purchase"})]})]})},m.id))}),s.jsx(q,{className:"p-4 bg-muted/50",children:s.jsx("p",{className:"text-sm text-muted-foreground text-center",children:" Golden Roses are used to boost your posts in the marketplace feed and improve your placement in the provider directory. Premium members receive automatic premium placement!"})})]})]})})}const nKe=({filters:e,onFiltersChange:t})=>{var h;const[r,n]=w.useState(!1),a=["Companionship","Dinner Dates","Events","Travel","Entertainment","Virtual"],i=["New York, NY","Los Angeles, CA","Chicago, IL","Miami, FL","Las Vegas, NV","San Francisco, CA"],o=["18-25","26-30","31-35","36-40","41-45","46+"],l=f=>{const p=e.services||[],m=p.includes(f)?p.filter(v=>v!==f):[...p,f];t({...e,services:m})},c=()=>{t({})},u=[e.location,e.ageRange,(h=e.services)==null?void 0:h.length,e.availability==="available_now",e.verified,e.vaiVerified].filter(Boolean).length,d=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{children:"Location"}),s.jsxs(At,{value:e.location||"",onValueChange:f=>t({...e,location:f}),children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select location"})}),s.jsx(St,{children:i.map(f=>s.jsx(re,{value:f,children:f},f))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{children:"Age Range"}),s.jsxs(At,{value:e.ageRange||"",onValueChange:f=>t({...e,ageRange:f}),children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select age range"})}),s.jsx(St,{children:o.map(f=>s.jsx(re,{value:f,children:f},f))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{children:"Services Offered"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(f=>{var p,m;return s.jsxs(xe,{variant:(p=e.services)!=null&&p.includes(f)?"default":"outline",className:"cursor-pointer",onClick:()=>l(f),children:[f,((m=e.services)==null?void 0:m.includes(f))&&s.jsx(vn,{className:"ml-1 h-3 w-3"})]},f)})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{children:"Availability"}),s.jsxs(At,{value:e.availability||"any",onValueChange:f=>t({...e,availability:f}),children:[s.jsx(_t,{children:s.jsx(Pt,{})}),s.jsxs(St,{children:[s.jsx(re,{value:"any",children:"Any"}),s.jsx(re,{value:"available_now",children:"Available Now"})]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",id:"verified",checked:e.verified||!1,onChange:f=>t({...e,verified:f.target.checked}),className:"h-4 w-4 rounded border-border"}),s.jsx(de,{htmlFor:"verified",className:"cursor-pointer",children:"Verified profiles only"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",id:"vaiVerified",checked:e.vaiVerified||!1,onChange:f=>t({...e,vaiVerified:f.target.checked}),className:"h-4 w-4 rounded border-border"}),s.jsx(de,{htmlFor:"vaiVerified",className:"cursor-pointer",children:"V.A.I. Verified only"})]}),u>0&&s.jsxs(L,{variant:"outline",onClick:c,className:"w-full",children:["Clear All Filters (",u,")"]})]});return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"lg:hidden",children:s.jsxs(I9,{open:r,onOpenChange:n,children:[s.jsx(D9,{asChild:!0,children:s.jsxs(L,{variant:"outline",className:"w-full relative",children:[s.jsx(wae,{className:"h-4 w-4 mr-2"}),"Filters",u>0&&s.jsx(xe,{variant:"destructive",className:"ml-2 h-5 w-5 rounded-full p-0 flex items-center justify-center text-xs",children:u})]})}),s.jsxs(lO,{side:"bottom",className:"h-[80vh]",children:[s.jsx(cO,{children:s.jsx(uO,{children:"Search Filters"})}),s.jsx("div",{className:"mt-6 overflow-y-auto h-[calc(100%-4rem)]",children:s.jsx(d,{})})]})]})}),s.jsxs(q,{className:"hidden lg:block p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Filters"}),u>0&&s.jsxs(xe,{variant:"secondary",children:[u," active"]})]}),s.jsx(d,{})]})]})};function aKe(){const e=Oe(),[t,r]=w.useState(""),[n,a]=w.useState([]),[i,o]=w.useState([]),[l,c]=w.useState(!0),[u,d]=w.useState(!1),[h,f]=w.useState({});w.useEffect(()=>{p(),m()},[t,h]);const p=async()=>{try{c(!0);let _=T.from("provider_profiles").select("*").eq("profile_settings->>visibleInDirectory","true");t&&(_=_.ilike("username",`%${t}%`)),h.ageRange&&(_=_.eq("age_range",h.ageRange)),h.availability==="available_now"&&(_=_.eq("available_now",!0)),h.verified&&(_=_.eq("is_verified",!0));const{data:S,error:C}=await _;if(C)throw C;let E=S||[];if(h.vaiVerified&&E.length>0){const k=E.map(O=>O.user_id),{data:P}=await T.from("vai_verifications").select("user_id").in("user_id",k),A=new Set((P==null?void 0:P.map(O=>O.user_id))||[]);E=E.filter(O=>A.has(O.user_id))}if(E.length>0){const k=E.map(R=>R.user_id),{data:P,error:A}=await T.from("profiles").select("id, subscription_status, full_name").in("id",k);if(A)throw A;const{data:O}=await T.from("vai_verifications").select("user_id, vai_number").in("user_id",k),I=E.map(R=>{const M=P==null?void 0:P.find($=>$.id===R.user_id),B=O==null?void 0:O.find($=>$.user_id===R.user_id);return{...R,profiles:M?{subscription_status:M.subscription_status,full_name:M.full_name}:void 0,vai_number:B==null?void 0:B.vai_number}});a(I)}else a([])}catch(_){console.error("Error loading providers:",_),H.error("Failed to load providers")}finally{c(!1)}},m=async()=>{try{const{data:_,error:S}=await T.from("directory_boosts").select("*").gte("boost_expires_at",new Date().toISOString()).order("boost_position",{ascending:!0});if(S)throw S;o(_||[])}catch(_){console.error("Error loading boosts:",_)}},v=()=>n.filter(_=>{var S;return((S=_.profiles)==null?void 0:S.subscription_status)==="premium"}),g=()=>{const _=i.map(S=>S.user_id);return n.filter(S=>_.includes(S.user_id)).sort((S,C)=>{const E=i.find(P=>P.user_id===S.user_id),k=i.find(P=>P.user_id===P.user_id);return((E==null?void 0:E.boost_position)||999)-((k==null?void 0:k.boost_position)||999)})},x=()=>{const _=v().map(C=>C.user_id),S=g().map(C=>C.user_id);return n.filter(C=>!_.includes(C.user_id)&&!S.includes(C.user_id))},y=v(),b=g(),N=x(),j=(_,S=!1,C=!1)=>{var P;const E=i.find(A=>A.user_id===_.user_id),k=((P=_.profiles)==null?void 0:P.full_name)||_.username;return s.jsx(q,{className:`p-5 cursor-pointer transition-all hover:shadow-xl ${C?"border-2 border-yellow-500 shadow-lg":S?"border-primary/50":""}`,onClick:()=>e(`/profile/${_.user_id}`),children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsxs(Yi,{className:"h-20 w-20",children:[s.jsx(Xi,{src:_.avatar_url||""}),s.jsx(Qi,{children:k.slice(0,2).toUpperCase()})]}),S&&s.jsx("div",{className:"absolute -top-1 -right-1 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full p-1",children:s.jsx(zi,{className:"h-4 w-4 text-white"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[s.jsx("h3",{className:"font-bold text-lg truncate",children:k}),_.vai_number&&s.jsx(uy,{isVerified:!0,vaiNumber:_.vai_number,size:"sm",showNumber:!1}),_.is_verified&&s.jsx(xe,{variant:"secondary",className:"text-xs",children:" Verified"}),C&&s.jsxs(xe,{className:"bg-gradient-to-r from-yellow-500 to-orange-500 text-white text-xs",children:[s.jsx(kd,{className:"h-3 w-3 mr-1"}),"Spotlight"]}),E&&E.boost_type==="premium"&&s.jsxs(xe,{variant:"secondary",className:"bg-purple-500/20 text-purple-500 text-xs",children:[s.jsx(en,{className:"h-3 w-3 mr-1"}),"Boosted"]})]}),s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:_.age_range||"Age not specified"}),_.services_offered&&Array.isArray(_.services_offered)&&s.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[_.services_offered.slice(0,3).map((A,O)=>s.jsx(xe,{variant:"outline",className:"text-xs",children:A.name||A},O)),_.services_offered.length>3&&s.jsxs(xe,{variant:"outline",className:"text-xs",children:["+",_.services_offered.length-3," more"]})]}),s.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(hr,{className:"h-4 w-4 text-yellow-500 fill-yellow-500"}),s.jsx("span",{className:"font-medium",children:"4.8"})]}),s.jsxs(xe,{variant:"outline",className:"text-xs",children:[_.profile_completion_percentage,"% Complete"]})]})]})]})},_.id)};return s.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[s.jsx("div",{className:"bg-card border-b sticky top-0 z-10",children:s.jsx("div",{className:"max-w-7xl mx-auto p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Cl,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),s.jsx(De,{placeholder:"Search providers...",value:t,onChange:_=>r(_.target.value),className:"pl-10 h-12"})]}),s.jsx(L,{size:"icon",variant:"outline",onClick:()=>d(!0),className:"h-12 w-12",children:s.jsx(kd,{className:"h-5 w-5"})})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto p-4",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsx(nKe,{filters:h,onFiltersChange:f})}),s.jsx("div",{className:"lg:col-span-3 space-y-6",children:l?s.jsx("div",{className:"space-y-4",children:[1,2,3].map(_=>s.jsx(q,{className:"p-6",children:s.jsxs("div",{className:"animate-pulse flex gap-4",children:[s.jsx("div",{className:"h-20 w-20 bg-muted rounded-full"}),s.jsxs("div",{className:"flex-1 space-y-3",children:[s.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),s.jsx("div",{className:"h-3 bg-muted rounded w-1/2"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"h-6 bg-muted rounded w-20"}),s.jsx("div",{className:"h-6 bg-muted rounded w-20"})]})]})]})},_))}):n.length===0?s.jsxs(q,{className:"p-12 text-center",children:[s.jsx(Cl,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No providers found"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"Try adjusting your search or filters"}),s.jsx(L,{variant:"outline",onClick:()=>{r(""),f({})},children:"Clear Search"})]}):s.jsxs(s.Fragment,{children:[y.length>0&&s.jsxs("section",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[s.jsx(zi,{className:"h-5 w-5 text-yellow-500"}),"Premium Members"]}),s.jsx(xe,{className:"bg-gradient-to-r from-yellow-500 to-orange-500 text-white",children:"Featured"})]}),s.jsx("div",{className:"space-y-3",children:y.map(_=>{const S=i.find(E=>E.user_id===_.user_id),C=(S==null?void 0:S.boost_type)==="spotlight";return j(_,!0,C)})})]}),b.length>0&&s.jsxs("section",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(en,{className:"h-5 w-5 text-primary"}),s.jsx("h2",{className:"text-xl font-bold",children:"Featured"})]}),s.jsx("div",{className:"space-y-3",children:b.map(_=>{const S=i.find(E=>E.user_id===_.user_id),C=(S==null?void 0:S.boost_type)==="spotlight";return j(_,!1,C)})})]}),N.length>0&&s.jsxs("section",{children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:"All Providers"}),s.jsx("div",{className:"space-y-3",children:N.map(_=>j(_))})]})]})})]})}),s.jsx(aO,{activeTab:"search"}),s.jsx(kJ,{open:u,onOpenChange:d,onPurchaseComplete:()=>{p(),m()}})]})}function sKe(){const e=Oe(),{toast:t}=Et(),[r,n]=w.useState([]),[a,i]=w.useState(!0);w.useEffect(()=>{o()},[]);const o=async()=>{const{data:{user:u}}=await T.auth.getUser();if(!u)return;const{data:d,error:h}=await T.from("favorites").select("*").eq("user_id",u.id).order("created_at",{ascending:!1});if(h){t({title:"Error",description:"Failed to load favorites",variant:"destructive"}),i(!1);return}const f=await Promise.all((d||[]).map(async p=>{const{data:m}=await T.from("profiles").select("id, full_name, avatar_url, subscription_status").eq("id",p.favorited_user_id).single();return{...p,user:m||{id:p.favorited_user_id,full_name:"Unknown User",avatar_url:null,subscription_status:"free"}}}));n(f),i(!1)},l=async u=>{const{error:d}=await T.from("favorites").delete().eq("id",u);if(d){t({title:"Error",description:"Failed to remove favorite",variant:"destructive"});return}t({title:"Success",description:"Removed from favorites"}),o()},c=async u=>{const{data:{user:d}}=await T.auth.getUser();if(!d)return;const{data:h}=await T.from("conversations").select("*").or(`and(participant_1_id.eq.${d.id},participant_2_id.eq.${u}),and(participant_1_id.eq.${u},participant_2_id.eq.${d.id})`).single();if(h){e("/chat");return}const{error:f}=await T.from("conversations").insert({participant_1_id:d.id,participant_2_id:u});if(f){t({title:"Error",description:"Failed to start conversation",variant:"destructive"});return}e("/chat")};return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"sticky top-0 z-50 border-b border-border bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60",children:s.jsxs("div",{className:"container flex h-16 items-center px-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/feed"),children:s.jsx(ze,{className:"h-5 w-5"})}),s.jsx("h1",{className:"ml-2 text-xl font-semibold text-foreground",children:"Favorites"})]})}),s.jsx("main",{className:"container mx-auto max-w-4xl p-4",children:a?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-muted-foreground",children:"Loading favorites..."})}):r.length===0?s.jsxs(q,{className:"p-12 text-center",children:[s.jsx(PC,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),s.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"No Favorites Yet"}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"Start adding users to your favorites to keep track of them"}),s.jsx(L,{onClick:()=>e("/feed"),children:"Browse Users"})]}):s.jsx("div",{className:"grid gap-4",children:r.map(u=>{var d;return s.jsx(q,{className:"p-6",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsxs(Yi,{className:"h-16 w-16",children:[s.jsx(Xi,{src:u.user.avatar_url||void 0}),s.jsx(Qi,{className:"text-lg",children:((d=u.user.full_name)==null?void 0:d.charAt(0))||"?"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"font-semibold text-lg truncate",children:u.user.full_name}),u.user.subscription_status==="premium"&&s.jsx(xe,{variant:"secondary",children:"Premium"})]}),s.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Added ",new Date(u.created_at).toLocaleDateString()]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs(L,{size:"sm",onClick:()=>c(u.user.id),children:[s.jsx(sj,{className:"h-4 w-4 mr-2"}),"Message"]}),s.jsxs(L,{size:"sm",variant:"outline",onClick:()=>e(`/profile/${u.user.id}`),children:[s.jsx(_ae,{className:"h-4 w-4 mr-2"}),"View Profile"]}),s.jsxs(L,{size:"sm",variant:"ghost",onClick:()=>l(u.id),children:[s.jsx(PC,{className:"h-4 w-4 mr-2 fill-destructive text-destructive"}),"Remove"]})]})]})]})},u.id)})})})]})}function iKe(){const e=Oe(),[t,r]=w.useState([]),[n,a]=w.useState([]),[i,o]=w.useState(!0),[l,c]=w.useState("all"),[u,d]=w.useState("30");w.useEffect(()=>{h()},[]),w.useEffect(()=>{f()},[t,l,u]);const h=async()=>{try{const{data:{user:m}}=await T.auth.getUser();if(!m)return;const v=[],{data:g}=await T.from("encounters").select("*").or(`provider_id.eq.${m.id},client_id.eq.${m.id}`).order("created_at",{ascending:!1});g&&g.forEach(b=>{v.push({id:b.id,type:"encounter",title:"V.A.I.-CHECK Encounter",description:`Status: ${b.status}`,timestamp:new Date(b.accepted_at||b.created_at),status:b.status,icon:s.jsx(ut,{className:"w-5 h-5 text-green-400"})}),b.completed_at&&v.push({id:`${b.id}-completed`,type:"encounter",title:"Encounter Completed",description:"Meeting successfully completed",timestamp:new Date(b.completed_at),status:"completed",icon:s.jsx(ut,{className:"w-5 h-5 text-cyan-400"})})});const{data:x}=await T.from("reviews").select("*").eq("reviewer_id",m.id).order("created_at",{ascending:!1});x&&x.forEach(b=>{b.submitted&&v.push({id:b.id,type:"review",title:"Review Submitted",description:`Overall rating: ${b.overall_rating||"N/A"} stars`,timestamp:new Date(b.submitted_at||b.created_at),status:b.published?"published":"pending",icon:s.jsx(hr,{className:"w-5 h-5 text-yellow-400"})}),b.published&&v.push({id:`${b.id}-published`,type:"review",title:"Review Published",description:"Your review is now visible",timestamp:new Date(b.published_at),status:"published",icon:s.jsx(hr,{className:"w-5 h-5 text-orange-400"})})});const{data:y}=await T.from("dateguard_sessions").select("*").eq("user_id",m.id).order("created_at",{ascending:!1});y&&y.forEach(b=>{v.push({id:b.id,type:"dateguard",title:"DateGuard Activated",description:`${b.duration_minutes} min session at ${b.location_name}`,timestamp:new Date(b.started_at),status:b.status,icon:s.jsx(lt,{className:"w-5 h-5 text-purple-400"})}),b.status==="completed"&&v.push({id:`${b.id}-completed`,type:"dateguard",title:"DateGuard Session Ended",description:"Session completed safely",timestamp:new Date(b.ends_at),status:"completed",icon:s.jsx(lt,{className:"w-5 h-5 text-green-400"})}),b.status==="emergency"&&v.push({id:`${b.id}-emergency`,type:"dateguard",title:"Emergency Alert Triggered",description:"Emergency response initiated",timestamp:new Date(b.updated_at),status:"emergency",icon:s.jsx(lt,{className:"w-5 h-5 text-red-400"})})}),v.sort((b,N)=>N.timestamp.getTime()-b.timestamp.getTime()),r(v)}catch(m){console.error("Error fetching activities:",m)}finally{o(!1)}},f=()=>{let m=[...t];if(l!=="all"&&(m=m.filter(v=>v.type===l)),u!=="all"){const v=parseInt(u),g=Lqe(new Date,v);m=m.filter(x=>$qe(x.timestamp,g))}a(m)},p=m=>{switch(m){case"completed":return"text-green-400";case"active":case"in_progress":return"text-cyan-400";case"emergency":return"text-red-400";case"published":return"text-orange-400";case"pending":return"text-yellow-400";default:return"text-foreground/60"}};return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"sticky top-0 z-10 bg-card border-b border-border px-4 py-3",children:s.jsxs("div",{className:"flex items-center gap-3 max-w-2xl mx-auto",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e(-1),children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold",children:"Activity Timeline"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Your recent activity history"})]})]})}),s.jsxs("main",{className:"px-4 py-6 max-w-2xl mx-auto space-y-4",children:[s.jsxs(q,{children:[s.jsx(ge,{children:s.jsxs(be,{className:"flex items-center gap-2 text-base",children:[s.jsx(AC,{className:"w-4 h-4"}),"Filters"]})}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Activity Type"}),s.jsx(Ga,{value:l,onValueChange:m=>c(m),children:s.jsxs(Aa,{className:"grid grid-cols-4 w-full",children:[s.jsx(mt,{value:"all",children:"All"}),s.jsx(mt,{value:"encounters",children:"Encounters"}),s.jsx(mt,{value:"reviews",children:"Reviews"}),s.jsx(mt,{value:"dateguard",children:"DateGuard"})]})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Time Period"}),s.jsxs(At,{value:u,onValueChange:m=>d(m),children:[s.jsx(_t,{children:s.jsx(Pt,{})}),s.jsxs(St,{children:[s.jsx(re,{value:"7",children:"Last 7 days"}),s.jsx(re,{value:"30",children:"Last 30 days"}),s.jsx(re,{value:"90",children:"Last 90 days"}),s.jsx(re,{value:"all",children:"All time"})]})]})]})]})]}),i?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"text-muted-foreground mt-4",children:"Loading activities..."})]}):n.length===0?s.jsx(q,{children:s.jsxs(ee,{className:"py-12 text-center",children:[s.jsx(Yn,{className:"w-16 h-16 text-muted-foreground/50 mx-auto mb-4"}),s.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No activities found"}),s.jsx("p",{className:"text-muted-foreground",children:l!=="all"||u!=="all"?"Try adjusting your filters":"Your activity will appear here"})]})}):s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("h2",{className:"text-sm font-semibold text-muted-foreground",children:[n.length," ",n.length===1?"activity":"activities"]})}),s.jsx("div",{className:"relative border-l-2 border-border ml-3 space-y-6",children:n.map((m,v)=>s.jsxs("div",{className:"relative pl-8 pb-6",children:[s.jsx("div",{className:"absolute -left-3 top-0 bg-card border-2 border-border rounded-full p-1",children:m.icon}),s.jsx(q,{children:s.jsx(ee,{className:"pt-4",children:s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold",children:m.title}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:m.description}),m.status&&s.jsx("span",{className:`text-xs font-medium mt-2 inline-block ${p(m.status)}`,children:m.status.replace("_"," ").toUpperCase()})]}),s.jsxs("div",{className:"text-right text-xs text-muted-foreground whitespace-nowrap",children:[s.jsx("div",{children:Mr(m.timestamp,"MMM d, yyyy")}),s.jsx("div",{children:Mr(m.timestamp,"h:mm a")})]})]})})})]},m.id))})]})]})]})}var u_="Collapsible",[oKe,AJ]=an(u_),[lKe,HI]=oKe(u_),PJ=w.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:n,defaultOpen:a,disabled:i,onOpenChange:o,...l}=e,[c,u]=Ba({prop:n,defaultProp:a??!1,onChange:o,caller:u_});return s.jsx(lKe,{scope:r,disabled:i,contentId:pn(),open:c,onOpenToggle:w.useCallback(()=>u(d=>!d),[u]),children:s.jsx(Me.div,{"data-state":YI(c),"data-disabled":i?"":void 0,...l,ref:t})})});PJ.displayName=u_;var TJ="CollapsibleTrigger",RJ=w.forwardRef((e,t)=>{const{__scopeCollapsible:r,...n}=e,a=HI(TJ,r);return s.jsx(Me.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":YI(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...n,ref:t,onClick:Ne(e.onClick,a.onOpenToggle)})});RJ.displayName=TJ;var KI="CollapsibleContent",OJ=w.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=HI(KI,e.__scopeCollapsible);return s.jsx(gn,{present:r||a.open,children:({present:i})=>s.jsx(cKe,{...n,ref:t,present:i})})});OJ.displayName=KI;var cKe=w.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:n,children:a,...i}=e,o=HI(KI,r),[l,c]=w.useState(n),u=w.useRef(null),d=ct(t,u),h=w.useRef(0),f=h.current,p=w.useRef(0),m=p.current,v=o.open||l,g=w.useRef(v),x=w.useRef(void 0);return w.useEffect(()=>{const y=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(y)},[]),Xr(()=>{const y=u.current;if(y){x.current=x.current||{transitionDuration:y.style.transitionDuration,animationName:y.style.animationName},y.style.transitionDuration="0s",y.style.animationName="none";const b=y.getBoundingClientRect();h.current=b.height,p.current=b.width,g.current||(y.style.transitionDuration=x.current.transitionDuration,y.style.animationName=x.current.animationName),c(n)}},[o.open,n]),s.jsx(Me.div,{"data-state":YI(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!v,...i,ref:d,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":m?`${m}px`:void 0,...e.style},children:v&&a})});function YI(e){return e?"open":"closed"}var uKe=PJ,dKe=RJ,hKe=OJ,no="Accordion",fKe=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[XI,pKe,mKe]=wx(no),[d_,SQe]=an(no,[mKe,AJ]),QI=AJ(),IJ=F.forwardRef((e,t)=>{const{type:r,...n}=e,a=n,i=n;return s.jsx(XI.Provider,{scope:e.__scopeAccordion,children:r==="multiple"?s.jsx(yKe,{...i,ref:t}):s.jsx(xKe,{...a,ref:t})})});IJ.displayName=no;var[DJ,vKe]=d_(no),[MJ,gKe]=d_(no,{collapsible:!1}),xKe=F.forwardRef((e,t)=>{const{value:r,defaultValue:n,onValueChange:a=()=>{},collapsible:i=!1,...o}=e,[l,c]=Ba({prop:r,defaultProp:n??"",onChange:a,caller:no});return s.jsx(DJ,{scope:e.__scopeAccordion,value:F.useMemo(()=>l?[l]:[],[l]),onItemOpen:c,onItemClose:F.useCallback(()=>i&&c(""),[i,c]),children:s.jsx(MJ,{scope:e.__scopeAccordion,collapsible:i,children:s.jsx($J,{...o,ref:t})})})}),yKe=F.forwardRef((e,t)=>{const{value:r,defaultValue:n,onValueChange:a=()=>{},...i}=e,[o,l]=Ba({prop:r,defaultProp:n??[],onChange:a,caller:no}),c=F.useCallback(d=>l((h=[])=>[...h,d]),[l]),u=F.useCallback(d=>l((h=[])=>h.filter(f=>f!==d)),[l]);return s.jsx(DJ,{scope:e.__scopeAccordion,value:o,onItemOpen:c,onItemClose:u,children:s.jsx(MJ,{scope:e.__scopeAccordion,collapsible:!0,children:s.jsx($J,{...i,ref:t})})})}),[bKe,h_]=d_(no),$J=F.forwardRef((e,t)=>{const{__scopeAccordion:r,disabled:n,dir:a,orientation:i="vertical",...o}=e,l=F.useRef(null),c=ct(l,t),u=pKe(r),h=ah(a)==="ltr",f=Ne(e.onKeyDown,p=>{var C;if(!fKe.includes(p.key))return;const m=p.target,v=u().filter(E=>{var k;return!((k=E.ref.current)!=null&&k.disabled)}),g=v.findIndex(E=>E.ref.current===m),x=v.length;if(g===-1)return;p.preventDefault();let y=g;const b=0,N=x-1,j=()=>{y=g+1,y>N&&(y=b)},_=()=>{y=g-1,y<b&&(y=N)};switch(p.key){case"Home":y=b;break;case"End":y=N;break;case"ArrowRight":i==="horizontal"&&(h?j():_());break;case"ArrowDown":i==="vertical"&&j();break;case"ArrowLeft":i==="horizontal"&&(h?_():j());break;case"ArrowUp":i==="vertical"&&_();break}const S=y%x;(C=v[S].ref.current)==null||C.focus()});return s.jsx(bKe,{scope:r,disabled:n,direction:a,orientation:i,children:s.jsx(XI.Slot,{scope:r,children:s.jsx(Me.div,{...o,"data-orientation":i,ref:c,onKeyDown:n?void 0:f})})})}),P1="AccordionItem",[wKe,ZI]=d_(P1),FJ=F.forwardRef((e,t)=>{const{__scopeAccordion:r,value:n,...a}=e,i=h_(P1,r),o=vKe(P1,r),l=QI(r),c=pn(),u=n&&o.value.includes(n)||!1,d=i.disabled||e.disabled;return s.jsx(wKe,{scope:r,open:u,disabled:d,triggerId:c,children:s.jsx(uKe,{"data-orientation":i.orientation,"data-state":WJ(u),...l,...a,ref:t,disabled:d,open:u,onOpenChange:h=>{h?o.onItemOpen(n):o.onItemClose(n)}})})});FJ.displayName=P1;var LJ="AccordionHeader",BJ=F.forwardRef((e,t)=>{const{__scopeAccordion:r,...n}=e,a=h_(no,r),i=ZI(LJ,r);return s.jsx(Me.h3,{"data-orientation":a.orientation,"data-state":WJ(i.open),"data-disabled":i.disabled?"":void 0,...n,ref:t})});BJ.displayName=LJ;var RA="AccordionTrigger",UJ=F.forwardRef((e,t)=>{const{__scopeAccordion:r,...n}=e,a=h_(no,r),i=ZI(RA,r),o=gKe(RA,r),l=QI(r);return s.jsx(XI.ItemSlot,{scope:r,children:s.jsx(dKe,{"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":a.orientation,id:i.triggerId,...l,...n,ref:t})})});UJ.displayName=RA;var VJ="AccordionContent",zJ=F.forwardRef((e,t)=>{const{__scopeAccordion:r,...n}=e,a=h_(no,r),i=ZI(VJ,r),o=QI(r);return s.jsx(hKe,{role:"region","aria-labelledby":i.triggerId,"data-orientation":a.orientation,...o,...n,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});zJ.displayName=VJ;function WJ(e){return e?"open":"closed"}var jKe=IJ,NKe=FJ,_Ke=BJ,qJ=UJ,GJ=zJ;const JI=jKe,kc=w.forwardRef(({className:e,...t},r)=>s.jsx(NKe,{ref:r,className:me("border-b",e),...t}));kc.displayName="AccordionItem";const Ac=w.forwardRef(({className:e,children:t,...r},n)=>s.jsx(_Ke,{className:"flex",children:s.jsxs(qJ,{ref:n,className:me("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...r,children:[t,s.jsx(Lc,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Ac.displayName=qJ.displayName;const Pc=w.forwardRef(({className:e,children:t,...r},n)=>s.jsx(GJ,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:s.jsx("div",{className:me("pb-4 pt-0",e),children:t})}));Pc.displayName=GJ.displayName;const SKe=e=>{switch(e){case"founding_council":return{name:"Founding Council",shortName:"FC",emoji:"",gradient:"from-yellow-400 via-yellow-500 to-amber-600",bgColor:"bg-[#FEF3C7]",darkBgColor:"dark:bg-yellow-900/20",textColor:"text-[#B45309]",darkTextColor:"dark:text-yellow-500",borderColor:"border-yellow-500/20",solidBg:"bg-yellow-50",darkSolidBg:"dark:bg-yellow-900/30"};case"first_movers":return{name:"First Movers",shortName:"FM",emoji:"",gradient:"from-purple-400 via-purple-500 to-indigo-600",bgColor:"bg-[#EDE9FE]",darkBgColor:"dark:bg-purple-900/20",textColor:"text-[#7C3AED]",darkTextColor:"dark:text-purple-400",borderColor:"border-purple-500/20",solidBg:"bg-purple-50",darkSolidBg:"dark:bg-purple-900/30"};case"early_access":return{name:"Early Access",shortName:"EA",emoji:"",gradient:"from-pink-400 via-purple-400 to-indigo-400",bgColor:"bg-[#FAE8FF]",darkBgColor:"dark:bg-pink-900/20",textColor:"text-[#C026D3]",darkTextColor:"dark:text-pink-400",borderColor:"border-pink-500/20",solidBg:"bg-pink-50",darkSolidBg:"dark:bg-pink-900/30"};case"standard":return{name:"Public Standard",shortName:"PS",emoji:"",gradient:"from-gray-400 via-gray-500 to-gray-600",bgColor:"bg-[#F3F4F6]",darkBgColor:"dark:bg-gray-800/20",textColor:"text-[#6B7280]",darkTextColor:"dark:text-gray-400",borderColor:"border-gray-500/20",solidBg:"bg-gray-50",darkSolidBg:"dark:bg-gray-800/30"};default:return null}},e4=({tier:e,size:t="md",showIcon:r=!0,iconOnly:n=!1,className:a})=>{const i=SKe(e);if(!i)return null;const o={sm:n?"w-8 h-8 text-base":"px-3 py-1 text-xs",md:n?"w-10 h-10 text-lg":"px-4 py-1.5 text-sm",lg:n?"w-12 h-12 text-xl":"px-5 py-2 text-base"};return n?s.jsx("div",{className:me("rounded-full flex items-center justify-center font-medium",i.solidBg,i.darkSolidBg,o[t],a),title:i.name,children:i.emoji}):s.jsxs(xe,{variant:"outline",className:me(i.bgColor,i.darkBgColor,i.textColor,i.darkTextColor,i.borderColor,"font-semibold",o[t],"gap-1.5",a),children:[r&&s.jsx("span",{children:i.emoji}),i.name]})};function CKe(){const e=Oe(),{toast:t}=Et(),[r,n]=w.useState(!1),[a,i]=w.useState(!1),[o,l]=w.useState(""),[c,u]=w.useState(0),[d,h]=w.useState(null),[f,p]=w.useState(!1),[m,v]=w.useState(null),g=.5;w.useEffect(()=>{(async()=>{const{data:{user:A}}=await T.auth.getUser();if(A){h(A.id);const{data:O}=await T.from("referral_codes").select("tier").eq("user_id",A.id).single();(O==null?void 0:O.tier)==="founding_council"&&p(!0)}})()},[e]);const x=24.99,y=249,b=f?x*(1-g)*(1-c):x*(1-c),N=f?y*(1-g)*(1-c):y*(1-c),j=async()=>{const P=o.toUpperCase();if(P.startsWith("FC"))try{if(!d)return;const{error:A}=await T.from("referral_codes").upsert({user_id:d,referral_code:P,tier:"founding_council",commission_rate:.1,registered_at:new Date().toISOString()},{onConflict:"user_id"});if(A)throw A;await T.from("profiles").update({subscription_status:"premium"}).eq("id",d),p(!0),v("founding_council"),t({title:"Founding Council Activated! ",description:"Lifetime Premium + Free VAI + Governance Rights. Complete VAI in 24h!"}),i(!1)}catch{t({title:"Error",description:"Could not apply coupon code",variant:"destructive"})}else if(P.startsWith("FM"))try{if(!d)return;const{error:A}=await T.from("referral_codes").upsert({user_id:d,referral_code:P,tier:"first_movers",commission_rate:.07,registered_at:new Date().toISOString()},{onConflict:"user_id"});if(A)throw A;await T.from("profiles").update({subscription_status:"premium"}).eq("id",d),v("first_movers"),t({title:"First Mover Activated! ",description:"1 Year Premium + 5% VAI Discount. Complete VAI in 24h!"}),i(!1)}catch{t({title:"Error",description:"Could not apply coupon code",variant:"destructive"})}else if(P.startsWith("EA"))try{if(!d)return;const{error:A}=await T.from("referral_codes").upsert({user_id:d,referral_code:P,tier:"early_access",commission_rate:.05,registered_at:new Date().toISOString()},{onConflict:"user_id"});if(A)throw A;await T.from("profiles").update({subscription_status:"premium"}).eq("id",d),v("early_access"),t({title:"Early Access Activated! ",description:"6 Months Premium + 20% Forever Discount. Complete VAI in 24h!"}),i(!1)}catch{t({title:"Error",description:"Could not apply coupon code",variant:"destructive"})}else if(P==="FOUNDING100"||P==="FIRSTMOVER")try{if(!d)return;const A=P==="FOUNDING100"?"founding_council":"first_movers",{error:O}=await T.from("referral_codes").upsert({user_id:d,referral_code:`${d.substring(0,8).toUpperCase()}`,tier:A,commission_rate:A==="founding_council"?.1:.07},{onConflict:"user_id"});if(O)throw O;p(A==="founding_council"),v(A==="founding_council"?"founding_council":"first_movers"),t({title:"Coupon Applied!",description:`You are now a ${A==="founding_council"?"Founding Council":"First Mover"} member`}),i(!1)}catch{t({title:"Error",description:"Could not apply coupon code",variant:"destructive"})}else P==="SAVE10"?(u(.1),t({title:"Discount Applied!",description:"10% off your subscription"})):t({title:"Invalid Code",description:"This coupon code is not valid",variant:"destructive"})},_=async()=>{if(d){const{error:P}=await T.from("profiles").update({subscription_status:"free"}).eq("id",d);if(P){t({title:"Error",description:"Could not update subscription status",variant:"destructive"});return}}e("/profile-creation")},S=async()=>{if(d){const{error:P}=await T.from("profiles").update({subscription_status:"premium"}).eq("id",d);if(P){t({title:"Error",description:"Could not update subscription status",variant:"destructive"});return}t({title:"Premium Activated!",description:"Welcome to Vairify Premium"})}e("/profile-creation")},C=["V.A.I.-CHECK (Identity verification)","DateGuard (Unlimited sessions)","TrueRevu (Verified reviews)","Emergency Button (Always accessible)","GPS Safety Tracking","Law Enforcement Disclosure","Mutual Consent Contracts"],E=["Validate (Advanced verification)","VairiPay (Integrated payments)","Vairify Now (Instant booking)","Smart Calendar (Scheduling)","Revenue Sharing Tools","Custom QR Codes","Marketplace Access","Priority Feed","Enhanced Directory","Unlimited Invitations","Priority Support","Profile Analytics"],k=[{icon:vn,title:"Cancel Anytime",description:"No contracts"},{icon:lt,title:"Safety Always Free",description:"Our promise"},{icon:Or,title:"Secure Payments",description:"256-bit encryption"}];return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background to-background/95",children:[s.jsx("div",{className:"container mx-auto px-4 pt-12 pb-8",children:s.jsxs("div",{className:"text-center space-y-4 animate-fade-in",children:[s.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-foreground",children:"Choose Your Experience"}),s.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:"All safety features are free forever. Premium adds convenience."}),m&&s.jsx("div",{className:"flex justify-center",children:s.jsx(e4,{tier:m,size:"lg"})})]})}),s.jsxs("div",{className:"container mx-auto px-4 pb-12",children:[s.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 max-w-6xl mx-auto",children:[s.jsxs(q,{className:"border-2 border-success/50 relative overflow-hidden animate-slide-up",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-success/10 rounded-full -mr-16 -mt-16"}),s.jsxs(ge,{className:"relative",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(lt,{className:"w-6 h-6 text-success"}),s.jsx(be,{className:"text-2xl",children:"Core Safety"})]}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("span",{className:"text-4xl font-bold text-foreground",children:"$0"}),s.jsx("span",{className:"text-muted-foreground",children:"Forever"})]}),s.jsxs(xe,{className:"w-fit bg-success text-success-foreground mt-2",children:[s.jsx($t,{className:"w-4 h-4 mr-1"}),"Active"]})]}),s.jsx(ee,{className:"space-y-3",children:C.map((P,A)=>s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx($t,{className:"w-5 h-5 text-success shrink-0 mt-0.5"}),s.jsx("span",{className:"text-foreground",children:P})]},A))}),s.jsx(zE,{className:"flex-col items-start space-y-2",children:s.jsx("p",{className:"text-sm text-success font-medium",children:" Never pay for protection"})})]}),s.jsxs(q,{className:"border-2 border-primary/50 relative overflow-hidden animate-slide-up",style:{animationDelay:"0.1s"},children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-primary/10 rounded-full -mr-16 -mt-16"}),s.jsxs(ge,{className:"relative",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(hr,{className:"w-6 h-6 text-primary"}),s.jsx(be,{className:"text-2xl",children:"Premium Convenience"})]}),s.jsxs("div",{className:"flex items-center justify-center gap-3 my-4 p-3 bg-muted/50 rounded-lg",children:[s.jsx("span",{className:r?"text-muted-foreground":"font-medium text-foreground",children:"Monthly"}),s.jsx(Yt,{checked:r,onCheckedChange:n,className:"data-[state=checked]:bg-primary"}),s.jsx("span",{className:r?"font-medium text-foreground":"text-muted-foreground",children:"Yearly"}),r&&s.jsx(xe,{variant:"secondary",className:"ml-2 bg-success text-success-foreground",children:"Save 17%"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-baseline gap-2",children:[f&&s.jsxs("span",{className:"text-xl text-muted-foreground line-through",children:["$",r?y:x]}),s.jsxs("span",{className:"text-4xl font-bold text-foreground",children:["$",r?N.toFixed(2):b.toFixed(2)]}),s.jsxs("span",{className:"text-muted-foreground",children:["/",r?"year":"month"]})]}),f&&s.jsx("p",{className:"text-sm text-primary font-medium",children:" Founding Council: 50% off forever"})]})]}),s.jsxs(ee,{className:"space-y-3",children:[E.map((P,A)=>s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx($t,{className:"w-5 h-5 text-primary shrink-0 mt-0.5"}),s.jsx("span",{className:"text-foreground",children:P})]},A)),s.jsxs("div",{className:"pt-4",children:[s.jsx("button",{onClick:()=>i(!a),className:"text-base font-semibold text-primary dark:text-white hover:underline",children:"Have a coupon code?"}),a&&s.jsxs("div",{className:"flex gap-2 mt-2 animate-fade-in",children:[s.jsx(De,{placeholder:"Enter code",value:o,onChange:P=>l(P.target.value),className:"flex-1 text-base"}),s.jsx(L,{onClick:j,size:"sm",variant:"secondary",children:"Apply"})]}),c>0&&s.jsxs("p",{className:"text-base font-semibold text-success mt-2",children:[" ",c*100,"% discount applied!"]})]})]}),s.jsx(zE,{children:s.jsx(L,{className:"w-full",size:"lg",onClick:S,children:"Upgrade to Premium"})})]})]}),m&&s.jsx(q,{className:"max-w-4xl mx-auto mt-8 border-2 border-primary bg-gradient-to-r from-primary/10 to-accent/10 animate-fade-in",children:s.jsx(ee,{className:"p-8",children:s.jsxs("div",{className:"text-center space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3",children:[m==="founding_council"&&s.jsx(zi,{className:"w-16 h-16 text-amber-500"}),m==="first_movers"&&s.jsx(hr,{className:"w-16 h-16 text-purple-500"}),m==="early_access"&&s.jsx(xe,{className:"w-16 h-16 text-blue-500"})]}),s.jsxs("div",{children:[s.jsxs("h2",{className:"text-3xl font-bold text-foreground mb-2",children:[m==="founding_council"&&" Founding Council Member",m==="first_movers"&&" First Movers Member",m==="early_access"&&" Early Access Member"]}),s.jsx("p",{className:"text-lg text-muted-foreground",children:"Your exclusive lifetime benefits"})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-6 text-left",children:[s.jsxs("div",{className:"bg-background/50 rounded-lg p-4 border border-border",children:[s.jsx("h3",{className:"font-bold text-lg mb-2 text-foreground",children:"Vairify Premium"}),s.jsxs("p",{className:"text-2xl font-bold text-success mb-1",children:[m==="founding_council"&&"FREE Forever",m==="first_movers"&&"FREE for 1 Year",m==="early_access"&&"FREE for 6 Months"]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[m==="founding_council"&&"Lifetime access to all premium features",m==="first_movers"&&"Full premium access for 12 months",m==="early_access"&&"Full premium access for 6 months"]})]}),s.jsxs("div",{className:"bg-background/50 rounded-lg p-4 border border-border",children:[s.jsx("h3",{className:"font-bold text-lg mb-2 text-foreground",children:"ChainPass V.A.I."}),s.jsxs("p",{className:"text-2xl font-bold text-primary mb-1",children:[m==="founding_council"&&"100% OFF",m==="first_movers"&&"50% OFF",m==="early_access"&&"20% OFF"]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[m==="founding_council"&&"Completely FREE verification",m==="first_movers"&&"Pay only $49.99 instead of $99.99",m==="early_access"&&"Pay only $79.99 instead of $99.99"]})]}),s.jsxs("div",{className:"bg-background/50 rounded-lg p-4 border border-border",children:[s.jsx("h3",{className:"font-bold text-lg mb-2 text-foreground",children:"Permanent Status Badge"}),s.jsxs("div",{className:"flex items-center gap-2",children:[m==="founding_council"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center",children:s.jsx(zi,{className:"w-6 h-6 text-amber-600 dark:text-amber-400"})}),s.jsx("span",{className:"text-foreground",children:"Founding Council"})]}),m==="first_movers"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-500 flex items-center justify-center",children:s.jsx(hr,{className:"w-6 h-6 text-white"})}),s.jsx("span",{className:"text-foreground",children:"First Movers"})]}),m==="early_access"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:s.jsx(xe,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),s.jsx("span",{className:"text-foreground",children:"Early Access"})]})]}),s.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Displayed on your profile forever"})]}),s.jsxs("div",{className:"bg-background/50 rounded-lg p-4 border border-border",children:[s.jsx("h3",{className:"font-bold text-lg mb-2 text-foreground",children:"Additional Perks"}),s.jsxs("ul",{className:"space-y-1 text-sm text-foreground",children:[m==="founding_council"&&s.jsxs(s.Fragment,{children:[s.jsx("li",{children:" Exclusive CEO community calls"}),s.jsx("li",{children:" Direct input on new features"}),s.jsx("li",{children:" Legal Fund Access (after Dec 31)"})]}),m==="first_movers"&&s.jsxs(s.Fragment,{children:[s.jsx("li",{children:" CEO community calls"}),s.jsx("li",{children:" Feature input opportunities"}),s.jsx("li",{children:" Legal Fund Access (after Dec 31)"})]}),m==="early_access"&&s.jsxs(s.Fragment,{children:[s.jsx("li",{children:" CEO community calls"}),s.jsx("li",{children:" Legal Fund Access (after Dec 31)"}),s.jsx("li",{children:" Priority support"})]})]})]})]}),s.jsxs("div",{className:"bg-success/10 border border-success rounded-lg p-4",children:[s.jsx("p",{className:"text-success font-semibold text-lg",children:" These benefits are locked in for life!"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your tier and perks will never change, no matter how our pricing evolves"})]})]})})})]}),s.jsx("div",{className:"bg-muted/30 py-12",children:s.jsx("div",{className:"container mx-auto px-4",children:s.jsx("div",{className:"grid md:grid-cols-3 gap-8 max-w-4xl mx-auto",children:k.map((P,A)=>s.jsxs("div",{className:"text-center space-y-2 animate-fade-in",style:{animationDelay:`${A*.1}s`},children:[s.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary/10 mb-2",children:s.jsx(P.icon,{className:"w-6 h-6 text-primary"})}),s.jsx("h3",{className:"font-semibold text-foreground",children:P.title}),s.jsx("p",{className:"text-sm text-muted-foreground",children:P.description})]},A))})})}),s.jsx("div",{className:"container mx-auto px-4 py-12",children:s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsx("h2",{className:"text-3xl font-bold text-center text-foreground mb-8",children:"Frequently Asked Questions"}),s.jsxs(JI,{type:"single",collapsible:!0,className:"space-y-4",children:[s.jsxs(kc,{value:"item-1",className:"border border-border rounded-lg px-6",children:[s.jsx(Ac,{className:"text-foreground hover:text-primary",children:"What happens if I don't upgrade?"}),s.jsx(Pc,{className:"text-muted-foreground",children:"Absolutely nothing changes! All core safety features remain completely free forever. You'll still have full access to V.A.I.-CHECK, DateGuard (5 sessions/month), TrueRevu, Emergency Button, GPS tracking, and all other safety features. Premium simply adds convenience features like unlimited DateGuard sessions, calendar integration, and marketplace access."})]}),s.jsxs(kc,{value:"item-2",className:"border border-border rounded-lg px-6",children:[s.jsx(Ac,{className:"text-foreground hover:text-primary",children:"Can I upgrade later?"}),s.jsx(Pc,{className:"text-muted-foreground",children:"Yes! You can upgrade to Premium at any time. Your Founding Council discount will always be available to you as one of our first 100 members. Simply visit your account settings whenever you're ready to unlock Premium convenience features."})]}),s.jsxs(kc,{value:"item-3",className:"border border-border rounded-lg px-6",children:[s.jsx(Ac,{className:"text-foreground hover:text-primary",children:"What's the difference between free and premium?"}),s.jsx(Pc,{className:"text-muted-foreground",children:"Free gives you all safety featureseverything you need to stay protected. Premium adds convenience features like VairiPay for integrated payments, Vairify Now for instant booking, Smart Calendar for scheduling, unlimited DateGuard sessions, priority support, and access to our professional marketplace and directory features."})]}),s.jsxs(kc,{value:"item-4",className:"border border-border rounded-lg px-6",children:[s.jsx(Ac,{className:"text-foreground hover:text-primary",children:"Do founding members keep the discount forever?"}),s.jsx(Pc,{className:"text-muted-foreground",children:"Yes! Your 50% Founding Council discount is locked in for life. As long as you maintain your subscription, you'll always pay half of what new members pay. This is our way of saying thank you for being part of our founding community."})]})]})]})}),s.jsx("div",{className:"container mx-auto px-4 pb-16",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[s.jsx(L,{variant:"outline",size:"lg",onClick:_,className:"min-w-[200px]",children:"Continue with Free"}),s.jsxs(L,{size:"lg",onClick:S,className:"min-w-[200px] bg-primary hover:bg-primary/90",children:[s.jsx(aae,{className:"w-4 h-4 mr-2"}),"Upgrade to Premium"]})]})})]})}var dy=e=>e.type==="checkbox",nd=e=>e instanceof Date,Da=e=>e==null;const HJ=e=>typeof e=="object";var nn=e=>!Da(e)&&!Array.isArray(e)&&HJ(e)&&!nd(e),KJ=e=>nn(e)&&e.target?dy(e.target)?e.target.checked:e.target.value:e,EKe=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,YJ=(e,t)=>e.has(EKe(t)),kKe=e=>{const t=e.constructor&&e.constructor.prototype;return nn(t)&&t.hasOwnProperty("isPrototypeOf")},t4=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function wn(e){let t;const r=Array.isArray(e),n=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(!(t4&&(e instanceof Blob||n))&&(r||nn(e)))if(t=r?[]:{},!r&&!kKe(e))t=e;else for(const a in e)e.hasOwnProperty(a)&&(t[a]=wn(e[a]));else return e;return t}var f_=e=>/^\w*$/.test(e),Zr=e=>e===void 0,r4=e=>Array.isArray(e)?e.filter(Boolean):[],n4=e=>r4(e.replace(/["|']|\]/g,"").split(/\.|\[/)),$e=(e,t,r)=>{if(!t||!nn(e))return r;const n=(f_(t)?[t]:n4(t)).reduce((a,i)=>Da(a)?a:a[i],e);return Zr(n)||n===e?Zr(e[t])?r:e[t]:n},ws=e=>typeof e=="boolean",sr=(e,t,r)=>{let n=-1;const a=f_(t)?[t]:n4(t),i=a.length,o=i-1;for(;++n<i;){const l=a[n];let c=r;if(n!==o){const u=e[l];c=nn(u)||Array.isArray(u)?u:isNaN(+a[n+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;e[l]=c,e=e[l]}};const T1={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Ii={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Qo={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},a4=F.createContext(null);a4.displayName="HookFormContext";const p_=()=>F.useContext(a4),AKe=e=>{const{children:t,...r}=e;return F.createElement(a4.Provider,{value:r},t)};var XJ=(e,t,r,n=!0)=>{const a={defaultValues:t._defaultValues};for(const i in e)Object.defineProperty(a,i,{get:()=>{const o=i;return t._proxyFormState[o]!==Ii.all&&(t._proxyFormState[o]=!n||Ii.all),r&&(r[o]=!0),e[o]}});return a};const s4=typeof window<"u"?F.useLayoutEffect:F.useEffect;function PKe(e){const t=p_(),{control:r=t.control,disabled:n,name:a,exact:i}=e||{},[o,l]=F.useState(r._formState),c=F.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return s4(()=>r._subscribe({name:a,formState:c.current,exact:i,callback:u=>{!n&&l({...r._formState,...u})}}),[a,n,i]),F.useEffect(()=>{c.current.isValid&&r._setValid(!0)},[r]),F.useMemo(()=>XJ(o,r,c.current,!1),[o,r])}var wo=e=>typeof e=="string",QJ=(e,t,r,n,a)=>wo(e)?(n&&t.watch.add(e),$e(r,e,a)):Array.isArray(e)?e.map(i=>(n&&t.watch.add(i),$e(r,i))):(n&&(t.watchAll=!0),r),OA=e=>Da(e)||!HJ(e);function il(e,t,r=new WeakSet){if(OA(e)||OA(t))return e===t;if(nd(e)&&nd(t))return e.getTime()===t.getTime();const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;if(r.has(e)||r.has(t))return!0;r.add(e),r.add(t);for(const i of n){const o=e[i];if(!a.includes(i))return!1;if(i!=="ref"){const l=t[i];if(nd(o)&&nd(l)||nn(o)&&nn(l)||Array.isArray(o)&&Array.isArray(l)?!il(o,l,r):o!==l)return!1}}return!0}function TKe(e){const t=p_(),{control:r=t.control,name:n,defaultValue:a,disabled:i,exact:o,compute:l}=e||{},c=F.useRef(a),u=F.useRef(l),d=F.useRef(void 0);u.current=l;const h=F.useMemo(()=>r._getWatch(n,c.current),[r,n]),[f,p]=F.useState(u.current?u.current(h):h);return s4(()=>r._subscribe({name:n,formState:{values:!0},exact:o,callback:m=>{if(!i){const v=QJ(n,r._names,m.values||r._formValues,!1,c.current);if(u.current){const g=u.current(v);il(g,d.current)||(p(g),d.current=g)}else p(v)}}}),[r,i,n,o]),F.useEffect(()=>r._removeUnmounted()),f}function RKe(e){const t=p_(),{name:r,disabled:n,control:a=t.control,shouldUnregister:i,defaultValue:o}=e,l=YJ(a._names.array,r),c=F.useMemo(()=>$e(a._formValues,r,$e(a._defaultValues,r,o)),[a,r,o]),u=TKe({control:a,name:r,defaultValue:c,exact:!0}),d=PKe({control:a,name:r,exact:!0}),h=F.useRef(e),f=F.useRef(a.register(r,{...e.rules,value:u,...ws(e.disabled)?{disabled:e.disabled}:{}}));h.current=e;const p=F.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!$e(d.errors,r)},isDirty:{enumerable:!0,get:()=>!!$e(d.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!$e(d.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!$e(d.validatingFields,r)},error:{enumerable:!0,get:()=>$e(d.errors,r)}}),[d,r]),m=F.useCallback(y=>f.current.onChange({target:{value:KJ(y),name:r},type:T1.CHANGE}),[r]),v=F.useCallback(()=>f.current.onBlur({target:{value:$e(a._formValues,r),name:r},type:T1.BLUR}),[r,a._formValues]),g=F.useCallback(y=>{const b=$e(a._fields,r);b&&y&&(b._f.ref={focus:()=>y.focus&&y.focus(),select:()=>y.select&&y.select(),setCustomValidity:N=>y.setCustomValidity(N),reportValidity:()=>y.reportValidity()})},[a._fields,r]),x=F.useMemo(()=>({name:r,value:u,...ws(n)||d.disabled?{disabled:d.disabled||n}:{},onChange:m,onBlur:v,ref:g}),[r,n,d.disabled,m,v,g,u]);return F.useEffect(()=>{const y=a._options.shouldUnregister||i;a.register(r,{...h.current.rules,...ws(h.current.disabled)?{disabled:h.current.disabled}:{}});const b=(N,j)=>{const _=$e(a._fields,N);_&&_._f&&(_._f.mount=j)};if(b(r,!0),y){const N=wn($e(a._options.defaultValues,r));sr(a._defaultValues,r,N),Zr($e(a._formValues,r))&&sr(a._formValues,r,N)}return!l&&a.register(r),()=>{(l?y&&!a._state.action:y)?a.unregister(r):b(r,!1)}},[r,a,l,i]),F.useEffect(()=>{a._setDisabledField({disabled:n,name:r})},[n,r,a]),F.useMemo(()=>({field:x,formState:d,fieldState:p}),[x,d,p])}const OKe=e=>e.render(RKe(e));var ZJ=(e,t,r,n,a)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[n]:a||!0}}:{},Bv=e=>Array.isArray(e)?e:[e],CB=()=>{let e=[];return{get observers(){return e},next:a=>{for(const i of e)i.next&&i.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(i=>i!==a)}}),unsubscribe:()=>{e=[]}}},Qa=e=>nn(e)&&!Object.keys(e).length,i4=e=>e.type==="file",Di=e=>typeof e=="function",R1=e=>{if(!t4)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},JJ=e=>e.type==="select-multiple",o4=e=>e.type==="radio",IKe=e=>o4(e)||dy(e),AS=e=>R1(e)&&e.isConnected;function DKe(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=Zr(e)?n++:e[t[n++]];return e}function MKe(e){for(const t in e)if(e.hasOwnProperty(t)&&!Zr(e[t]))return!1;return!0}function on(e,t){const r=Array.isArray(t)?t:f_(t)?[t]:n4(t),n=r.length===1?e:DKe(e,r),a=r.length-1,i=r[a];return n&&delete n[i],a!==0&&(nn(n)&&Qa(n)||Array.isArray(n)&&MKe(n))&&on(e,r.slice(0,-1)),e}var eee=e=>{for(const t in e)if(Di(e[t]))return!0;return!1};function O1(e,t={}){const r=Array.isArray(e);if(nn(e)||r)for(const n in e)Array.isArray(e[n])||nn(e[n])&&!eee(e[n])?(t[n]=Array.isArray(e[n])?[]:{},O1(e[n],t[n])):Da(e[n])||(t[n]=!0);return t}function tee(e,t,r){const n=Array.isArray(e);if(nn(e)||n)for(const a in e)Array.isArray(e[a])||nn(e[a])&&!eee(e[a])?Zr(t)||OA(r[a])?r[a]=Array.isArray(e[a])?O1(e[a],[]):{...O1(e[a])}:tee(e[a],Da(t)?{}:t[a],r[a]):r[a]=!il(e[a],t[a]);return r}var ev=(e,t)=>tee(e,t,O1(t));const EB={value:!1,isValid:!1},kB={value:!0,isValid:!0};var ree=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Zr(e[0].attributes.value)?Zr(e[0].value)||e[0].value===""?kB:{value:e[0].value,isValid:!0}:kB:EB}return EB},nee=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>Zr(e)?e:t?e===""?NaN:e&&+e:r&&wo(e)?new Date(e):n?n(e):e;const AB={isValid:!1,value:null};var aee=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,AB):AB;function PB(e){const t=e.ref;return i4(t)?t.files:o4(t)?aee(e.refs).value:JJ(t)?[...t.selectedOptions].map(({value:r})=>r):dy(t)?ree(e.refs).value:nee(Zr(t.value)?e.ref.value:t.value,e)}var $Ke=(e,t,r,n)=>{const a={};for(const i of e){const o=$e(t,i);o&&sr(a,i,o._f)}return{criteriaMode:r,names:[...e],fields:a,shouldUseNativeValidation:n}},I1=e=>e instanceof RegExp,tv=e=>Zr(e)?e:I1(e)?e.source:nn(e)?I1(e.value)?e.value.source:e.value:e,TB=e=>({isOnSubmit:!e||e===Ii.onSubmit,isOnBlur:e===Ii.onBlur,isOnChange:e===Ii.onChange,isOnAll:e===Ii.all,isOnTouch:e===Ii.onTouched});const RB="AsyncFunction";var FKe=e=>!!e&&!!e.validate&&!!(Di(e.validate)&&e.validate.constructor.name===RB||nn(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===RB)),LKe=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),OB=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length))));const Uv=(e,t,r,n)=>{for(const a of r||Object.keys(e)){const i=$e(e,a);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&t(o.refs[0],a)&&!n)return!0;if(o.ref&&t(o.ref,o.name)&&!n)return!0;if(Uv(l,t))break}else if(nn(l)&&Uv(l,t))break}}};function IB(e,t,r){const n=$e(e,r);if(n||f_(r))return{error:n,name:r};const a=r.split(".");for(;a.length;){const i=a.join("."),o=$e(t,i),l=$e(e,i);if(o&&!Array.isArray(o)&&r!==i)return{name:r};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};a.pop()}return{name:r}}var BKe=(e,t,r,n)=>{r(e);const{name:a,...i}=e;return Qa(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find(o=>t[o]===(!n||Ii.all))},UKe=(e,t,r)=>!e||!t||e===t||Bv(e).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n))),VKe=(e,t,r,n,a)=>a.isOnAll?!1:!r&&a.isOnTouch?!(t||e):(r?n.isOnBlur:a.isOnBlur)?!e:(r?n.isOnChange:a.isOnChange)?e:!0,zKe=(e,t)=>!r4($e(e,t)).length&&on(e,t),WKe=(e,t,r)=>{const n=Bv($e(e,r));return sr(n,"root",t[r]),sr(e,r,n),e},e0=e=>wo(e);function DB(e,t,r="validate"){if(e0(e)||Array.isArray(e)&&e.every(e0)||ws(e)&&!e)return{type:r,message:e0(e)?e:"",ref:t}}var Th=e=>nn(e)&&!I1(e)?e:{value:e,message:""},MB=async(e,t,r,n,a,i)=>{const{ref:o,refs:l,required:c,maxLength:u,minLength:d,min:h,max:f,pattern:p,validate:m,name:v,valueAsNumber:g,mount:x}=e._f,y=$e(r,v);if(!x||t.has(v))return{};const b=l?l[0]:o,N=A=>{a&&b.reportValidity&&(b.setCustomValidity(ws(A)?"":A||""),b.reportValidity())},j={},_=o4(o),S=dy(o),C=_||S,E=(g||i4(o))&&Zr(o.value)&&Zr(y)||R1(o)&&o.value===""||y===""||Array.isArray(y)&&!y.length,k=ZJ.bind(null,v,n,j),P=(A,O,I,R=Qo.maxLength,M=Qo.minLength)=>{const B=A?O:I;j[v]={type:A?R:M,message:B,ref:o,...k(A?R:M,B)}};if(i?!Array.isArray(y)||!y.length:c&&(!C&&(E||Da(y))||ws(y)&&!y||S&&!ree(l).isValid||_&&!aee(l).isValid)){const{value:A,message:O}=e0(c)?{value:!!c,message:c}:Th(c);if(A&&(j[v]={type:Qo.required,message:O,ref:b,...k(Qo.required,O)},!n))return N(O),j}if(!E&&(!Da(h)||!Da(f))){let A,O;const I=Th(f),R=Th(h);if(!Da(y)&&!isNaN(y)){const M=o.valueAsNumber||y&&+y;Da(I.value)||(A=M>I.value),Da(R.value)||(O=M<R.value)}else{const M=o.valueAsDate||new Date(y),B=W=>new Date(new Date().toDateString()+" "+W),$=o.type=="time",D=o.type=="week";wo(I.value)&&y&&(A=$?B(y)>B(I.value):D?y>I.value:M>new Date(I.value)),wo(R.value)&&y&&(O=$?B(y)<B(R.value):D?y<R.value:M<new Date(R.value))}if((A||O)&&(P(!!A,I.message,R.message,Qo.max,Qo.min),!n))return N(j[v].message),j}if((u||d)&&!E&&(wo(y)||i&&Array.isArray(y))){const A=Th(u),O=Th(d),I=!Da(A.value)&&y.length>+A.value,R=!Da(O.value)&&y.length<+O.value;if((I||R)&&(P(I,A.message,O.message),!n))return N(j[v].message),j}if(p&&!E&&wo(y)){const{value:A,message:O}=Th(p);if(I1(A)&&!y.match(A)&&(j[v]={type:Qo.pattern,message:O,ref:o,...k(Qo.pattern,O)},!n))return N(O),j}if(m){if(Di(m)){const A=await m(y,r),O=DB(A,b);if(O&&(j[v]={...O,...k(Qo.validate,O.message)},!n))return N(O.message),j}else if(nn(m)){let A={};for(const O in m){if(!Qa(A)&&!n)break;const I=DB(await m[O](y,r),b,O);I&&(A={...I,...k(O,I.message)},N(I.message),n&&(j[v]=A))}if(!Qa(A)&&(j[v]={ref:b,...A},!n))return j}}return N(!0),j};const qKe={mode:Ii.onSubmit,reValidateMode:Ii.onChange,shouldFocusError:!0};function GKe(e={}){let t={...qKe,...e},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:Di(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},n={},a=nn(t.defaultValues)||nn(t.values)?wn(t.defaultValues||t.values)||{}:{},i=t.shouldUnregister?{}:wn(a),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,u=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let h={...d};const f={array:CB(),state:CB()},p=t.criteriaMode===Ii.all,m=G=>te=>{clearTimeout(u),u=setTimeout(G,te)},v=async G=>{if(!t.disabled&&(d.isValid||h.isValid||G)){const te=t.resolver?Qa((await S()).errors):await E(n,!0);te!==r.isValid&&f.state.next({isValid:te})}},g=(G,te)=>{!t.disabled&&(d.isValidating||d.validatingFields||h.isValidating||h.validatingFields)&&((G||Array.from(l.mount)).forEach(ce=>{ce&&(te?sr(r.validatingFields,ce,te):on(r.validatingFields,ce))}),f.state.next({validatingFields:r.validatingFields,isValidating:!Qa(r.validatingFields)}))},x=(G,te=[],ce,_e,Ae=!0,je=!0)=>{if(_e&&ce&&!t.disabled){if(o.action=!0,je&&Array.isArray($e(n,G))){const Le=ce($e(n,G),_e.argA,_e.argB);Ae&&sr(n,G,Le)}if(je&&Array.isArray($e(r.errors,G))){const Le=ce($e(r.errors,G),_e.argA,_e.argB);Ae&&sr(r.errors,G,Le),zKe(r.errors,G)}if((d.touchedFields||h.touchedFields)&&je&&Array.isArray($e(r.touchedFields,G))){const Le=ce($e(r.touchedFields,G),_e.argA,_e.argB);Ae&&sr(r.touchedFields,G,Le)}(d.dirtyFields||h.dirtyFields)&&(r.dirtyFields=ev(a,i)),f.state.next({name:G,isDirty:P(G,te),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else sr(i,G,te)},y=(G,te)=>{sr(r.errors,G,te),f.state.next({errors:r.errors})},b=G=>{r.errors=G,f.state.next({errors:r.errors,isValid:!1})},N=(G,te,ce,_e)=>{const Ae=$e(n,G);if(Ae){const je=$e(i,G,Zr(ce)?$e(a,G):ce);Zr(je)||_e&&_e.defaultChecked||te?sr(i,G,te?je:PB(Ae._f)):I(G,je),o.mount&&v()}},j=(G,te,ce,_e,Ae)=>{let je=!1,Le=!1;const it={name:G};if(!t.disabled){if(!ce||_e){(d.isDirty||h.isDirty)&&(Le=r.isDirty,r.isDirty=it.isDirty=P(),je=Le!==it.isDirty);const ft=il($e(a,G),te);Le=!!$e(r.dirtyFields,G),ft?on(r.dirtyFields,G):sr(r.dirtyFields,G,!0),it.dirtyFields=r.dirtyFields,je=je||(d.dirtyFields||h.dirtyFields)&&Le!==!ft}if(ce){const ft=$e(r.touchedFields,G);ft||(sr(r.touchedFields,G,ce),it.touchedFields=r.touchedFields,je=je||(d.touchedFields||h.touchedFields)&&ft!==ce)}je&&Ae&&f.state.next(it)}return je?it:{}},_=(G,te,ce,_e)=>{const Ae=$e(r.errors,G),je=(d.isValid||h.isValid)&&ws(te)&&r.isValid!==te;if(t.delayError&&ce?(c=m(()=>y(G,ce)),c(t.delayError)):(clearTimeout(u),c=null,ce?sr(r.errors,G,ce):on(r.errors,G)),(ce?!il(Ae,ce):Ae)||!Qa(_e)||je){const Le={..._e,...je&&ws(te)?{isValid:te}:{},errors:r.errors,name:G};r={...r,...Le},f.state.next(Le)}},S=async G=>{g(G,!0);const te=await t.resolver(i,t.context,$Ke(G||l.mount,n,t.criteriaMode,t.shouldUseNativeValidation));return g(G),te},C=async G=>{const{errors:te}=await S(G);if(G)for(const ce of G){const _e=$e(te,ce);_e?sr(r.errors,ce,_e):on(r.errors,ce)}else r.errors=te;return te},E=async(G,te,ce={valid:!0})=>{for(const _e in G){const Ae=G[_e];if(Ae){const{_f:je,...Le}=Ae;if(je){const it=l.array.has(je.name),ft=Ae._f&&FKe(Ae._f);ft&&d.validatingFields&&g([_e],!0);const kr=await MB(Ae,l.disabled,i,p,t.shouldUseNativeValidation&&!te,it);if(ft&&d.validatingFields&&g([_e]),kr[je.name]&&(ce.valid=!1,te))break;!te&&($e(kr,je.name)?it?WKe(r.errors,kr,je.name):sr(r.errors,je.name,kr[je.name]):on(r.errors,je.name))}!Qa(Le)&&await E(Le,te,ce)}}return ce.valid},k=()=>{for(const G of l.unMount){const te=$e(n,G);te&&(te._f.refs?te._f.refs.every(ce=>!AS(ce)):!AS(te._f.ref))&&se(G)}l.unMount=new Set},P=(G,te)=>!t.disabled&&(G&&te&&sr(i,G,te),!il(W(),a)),A=(G,te,ce)=>QJ(G,l,{...o.mount?i:Zr(te)?a:wo(G)?{[G]:te}:te},ce,te),O=G=>r4($e(o.mount?i:a,G,t.shouldUnregister?$e(a,G,[]):[])),I=(G,te,ce={})=>{const _e=$e(n,G);let Ae=te;if(_e){const je=_e._f;je&&(!je.disabled&&sr(i,G,nee(te,je)),Ae=R1(je.ref)&&Da(te)?"":te,JJ(je.ref)?[...je.ref.options].forEach(Le=>Le.selected=Ae.includes(Le.value)):je.refs?dy(je.ref)?je.refs.forEach(Le=>{(!Le.defaultChecked||!Le.disabled)&&(Array.isArray(Ae)?Le.checked=!!Ae.find(it=>it===Le.value):Le.checked=Ae===Le.value||!!Ae)}):je.refs.forEach(Le=>Le.checked=Le.value===Ae):i4(je.ref)?je.ref.value="":(je.ref.value=Ae,je.ref.type||f.state.next({name:G,values:wn(i)})))}(ce.shouldDirty||ce.shouldTouch)&&j(G,Ae,ce.shouldTouch,ce.shouldDirty,!0),ce.shouldValidate&&D(G)},R=(G,te,ce)=>{for(const _e in te){if(!te.hasOwnProperty(_e))return;const Ae=te[_e],je=G+"."+_e,Le=$e(n,je);(l.array.has(G)||nn(Ae)||Le&&!Le._f)&&!nd(Ae)?R(je,Ae,ce):I(je,Ae,ce)}},M=(G,te,ce={})=>{const _e=$e(n,G),Ae=l.array.has(G),je=wn(te);sr(i,G,je),Ae?(f.array.next({name:G,values:wn(i)}),(d.isDirty||d.dirtyFields||h.isDirty||h.dirtyFields)&&ce.shouldDirty&&f.state.next({name:G,dirtyFields:ev(a,i),isDirty:P(G,je)})):_e&&!_e._f&&!Da(je)?R(G,je,ce):I(G,je,ce),OB(G,l)&&f.state.next({...r,name:G}),f.state.next({name:o.mount?G:void 0,values:wn(i)})},B=async G=>{o.mount=!0;const te=G.target;let ce=te.name,_e=!0;const Ae=$e(n,ce),je=ft=>{_e=Number.isNaN(ft)||nd(ft)&&isNaN(ft.getTime())||il(ft,$e(i,ce,ft))},Le=TB(t.mode),it=TB(t.reValidateMode);if(Ae){let ft,kr;const Ha=te.type?PB(Ae._f):KJ(G),Qr=G.type===T1.BLUR||G.type===T1.FOCUS_OUT,Ho=!LKe(Ae._f)&&!t.resolver&&!$e(r.errors,ce)&&!Ae._f.deps||VKe(Qr,$e(r.touchedFields,ce),r.isSubmitted,it,Le),ps=OB(ce,l,Qr);sr(i,ce,Ha),Qr?(Ae._f.onBlur&&Ae._f.onBlur(G),c&&c(0)):Ae._f.onChange&&Ae._f.onChange(G);const la=j(ce,Ha,Qr),Ls=!Qa(la)||ps;if(!Qr&&f.state.next({name:ce,type:G.type,values:wn(i)}),Ho)return(d.isValid||h.isValid)&&(t.mode==="onBlur"?Qr&&v():Qr||v()),Ls&&f.state.next({name:ce,...ps?{}:la});if(!Qr&&ps&&f.state.next({...r}),t.resolver){const{errors:Bs}=await S([ce]);if(je(Ha),_e){const Nm=IB(r.errors,n,ce),Cu=IB(Bs,n,Nm.name||ce);ft=Cu.error,ce=Cu.name,kr=Qa(Bs)}}else g([ce],!0),ft=(await MB(Ae,l.disabled,i,p,t.shouldUseNativeValidation))[ce],g([ce]),je(Ha),_e&&(ft?kr=!1:(d.isValid||h.isValid)&&(kr=await E(n,!0)));_e&&(Ae._f.deps&&D(Ae._f.deps),_(ce,kr,ft,la))}},$=(G,te)=>{if($e(r.errors,te)&&G.focus)return G.focus(),1},D=async(G,te={})=>{let ce,_e;const Ae=Bv(G);if(t.resolver){const je=await C(Zr(G)?G:Ae);ce=Qa(je),_e=G?!Ae.some(Le=>$e(je,Le)):ce}else G?(_e=(await Promise.all(Ae.map(async je=>{const Le=$e(n,je);return await E(Le&&Le._f?{[je]:Le}:Le)}))).every(Boolean),!(!_e&&!r.isValid)&&v()):_e=ce=await E(n);return f.state.next({...!wo(G)||(d.isValid||h.isValid)&&ce!==r.isValid?{}:{name:G},...t.resolver||!G?{isValid:ce}:{},errors:r.errors}),te.shouldFocus&&!_e&&Uv(n,$,G?Ae:l.mount),_e},W=G=>{const te={...o.mount?i:a};return Zr(G)?te:wo(G)?$e(te,G):G.map(ce=>$e(te,ce))},Z=(G,te)=>({invalid:!!$e((te||r).errors,G),isDirty:!!$e((te||r).dirtyFields,G),error:$e((te||r).errors,G),isValidating:!!$e(r.validatingFields,G),isTouched:!!$e((te||r).touchedFields,G)}),U=G=>{G&&Bv(G).forEach(te=>on(r.errors,te)),f.state.next({errors:G?r.errors:{}})},Y=(G,te,ce)=>{const _e=($e(n,G,{_f:{}})._f||{}).ref,Ae=$e(r.errors,G)||{},{ref:je,message:Le,type:it,...ft}=Ae;sr(r.errors,G,{...ft,...te,ref:_e}),f.state.next({name:G,errors:r.errors,isValid:!1}),ce&&ce.shouldFocus&&_e&&_e.focus&&_e.focus()},ae=(G,te)=>Di(G)?f.state.subscribe({next:ce=>"values"in ce&&G(A(void 0,te),ce)}):A(G,te,!0),ie=G=>f.state.subscribe({next:te=>{UKe(G.name,te.name,G.exact)&&BKe(te,G.formState||d,It,G.reRenderRoot)&&G.callback({values:{...i},...r,...te,defaultValues:a})}}).unsubscribe,he=G=>(o.mount=!0,h={...h,...G.formState},ie({...G,formState:h})),se=(G,te={})=>{for(const ce of G?Bv(G):l.mount)l.mount.delete(ce),l.array.delete(ce),te.keepValue||(on(n,ce),on(i,ce)),!te.keepError&&on(r.errors,ce),!te.keepDirty&&on(r.dirtyFields,ce),!te.keepTouched&&on(r.touchedFields,ce),!te.keepIsValidating&&on(r.validatingFields,ce),!t.shouldUnregister&&!te.keepDefaultValue&&on(a,ce);f.state.next({values:wn(i)}),f.state.next({...r,...te.keepDirty?{isDirty:P()}:{}}),!te.keepIsValid&&v()},ye=({disabled:G,name:te})=>{(ws(G)&&o.mount||G||l.disabled.has(te))&&(G?l.disabled.add(te):l.disabled.delete(te))},ne=(G,te={})=>{let ce=$e(n,G);const _e=ws(te.disabled)||ws(t.disabled);return sr(n,G,{...ce||{},_f:{...ce&&ce._f?ce._f:{ref:{name:G}},name:G,mount:!0,...te}}),l.mount.add(G),ce?ye({disabled:ws(te.disabled)?te.disabled:t.disabled,name:G}):N(G,!0,te.value),{..._e?{disabled:te.disabled||t.disabled}:{},...t.progressive?{required:!!te.required,min:tv(te.min),max:tv(te.max),minLength:tv(te.minLength),maxLength:tv(te.maxLength),pattern:tv(te.pattern)}:{},name:G,onChange:B,onBlur:B,ref:Ae=>{if(Ae){ne(G,te),ce=$e(n,G);const je=Zr(Ae.value)&&Ae.querySelectorAll&&Ae.querySelectorAll("input,select,textarea")[0]||Ae,Le=IKe(je),it=ce._f.refs||[];if(Le?it.find(ft=>ft===je):je===ce._f.ref)return;sr(n,G,{_f:{...ce._f,...Le?{refs:[...it.filter(AS),je,...Array.isArray($e(a,G))?[{}]:[]],ref:{type:je.type,name:G}}:{ref:je}}}),N(G,!1,void 0,je)}else ce=$e(n,G,{}),ce._f&&(ce._f.mount=!1),(t.shouldUnregister||te.shouldUnregister)&&!(YJ(l.array,G)&&o.action)&&l.unMount.add(G)}}},le=()=>t.shouldFocusError&&Uv(n,$,l.mount),ve=G=>{ws(G)&&(f.state.next({disabled:G}),Uv(n,(te,ce)=>{const _e=$e(n,ce);_e&&(te.disabled=_e._f.disabled||G,Array.isArray(_e._f.refs)&&_e._f.refs.forEach(Ae=>{Ae.disabled=_e._f.disabled||G}))},0,!1))},K=(G,te)=>async ce=>{let _e;ce&&(ce.preventDefault&&ce.preventDefault(),ce.persist&&ce.persist());let Ae=wn(i);if(f.state.next({isSubmitting:!0}),t.resolver){const{errors:je,values:Le}=await S();r.errors=je,Ae=wn(Le)}else await E(n);if(l.disabled.size)for(const je of l.disabled)on(Ae,je);if(on(r.errors,"root"),Qa(r.errors)){f.state.next({errors:{}});try{await G(Ae,ce)}catch(je){_e=je}}else te&&await te({...r.errors},ce),le(),setTimeout(le);if(f.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Qa(r.errors)&&!_e,submitCount:r.submitCount+1,errors:r.errors}),_e)throw _e},ke=(G,te={})=>{$e(n,G)&&(Zr(te.defaultValue)?M(G,wn($e(a,G))):(M(G,te.defaultValue),sr(a,G,wn(te.defaultValue))),te.keepTouched||on(r.touchedFields,G),te.keepDirty||(on(r.dirtyFields,G),r.isDirty=te.defaultValue?P(G,wn($e(a,G))):P()),te.keepError||(on(r.errors,G),d.isValid&&v()),f.state.next({...r}))},Ce=(G,te={})=>{const ce=G?wn(G):a,_e=wn(ce),Ae=Qa(G),je=Ae?a:_e;if(te.keepDefaultValues||(a=ce),!te.keepValues){if(te.keepDirtyValues){const Le=new Set([...l.mount,...Object.keys(ev(a,i))]);for(const it of Array.from(Le))$e(r.dirtyFields,it)?sr(je,it,$e(i,it)):M(it,$e(je,it))}else{if(t4&&Zr(G))for(const Le of l.mount){const it=$e(n,Le);if(it&&it._f){const ft=Array.isArray(it._f.refs)?it._f.refs[0]:it._f.ref;if(R1(ft)){const kr=ft.closest("form");if(kr){kr.reset();break}}}}if(te.keepFieldsRef)for(const Le of l.mount)M(Le,$e(je,Le));else n={}}i=t.shouldUnregister?te.keepDefaultValues?wn(a):{}:wn(je),f.array.next({values:{...je}}),f.state.next({values:{...je}})}l={mount:te.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!te.keepIsValid||!!te.keepDirtyValues,o.watch=!!t.shouldUnregister,f.state.next({submitCount:te.keepSubmitCount?r.submitCount:0,isDirty:Ae?!1:te.keepDirty?r.isDirty:!!(te.keepDefaultValues&&!il(G,a)),isSubmitted:te.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:Ae?{}:te.keepDirtyValues?te.keepDefaultValues&&i?ev(a,i):r.dirtyFields:te.keepDefaultValues&&G?ev(a,G):te.keepDirty?r.dirtyFields:{},touchedFields:te.keepTouched?r.touchedFields:{},errors:te.keepErrors?r.errors:{},isSubmitSuccessful:te.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},Ge=(G,te)=>Ce(Di(G)?G(i):G,te),He=(G,te={})=>{const ce=$e(n,G),_e=ce&&ce._f;if(_e){const Ae=_e.refs?_e.refs[0]:_e.ref;Ae.focus&&(Ae.focus(),te.shouldSelect&&Di(Ae.select)&&Ae.select())}},It=G=>{r={...r,...G}},Kt={control:{register:ne,unregister:se,getFieldState:Z,handleSubmit:K,setError:Y,_subscribe:ie,_runSchema:S,_focusError:le,_getWatch:A,_getDirty:P,_setValid:v,_setFieldArray:x,_setDisabledField:ye,_setErrors:b,_getFieldArray:O,_reset:Ce,_resetDefaultValues:()=>Di(t.defaultValues)&&t.defaultValues().then(G=>{Ge(G,t.resetOptions),f.state.next({isLoading:!1})}),_removeUnmounted:k,_disableForm:ve,_subjects:f,_proxyFormState:d,get _fields(){return n},get _formValues(){return i},get _state(){return o},set _state(G){o=G},get _defaultValues(){return a},get _names(){return l},set _names(G){l=G},get _formState(){return r},get _options(){return t},set _options(G){t={...t,...G}}},subscribe:he,trigger:D,register:ne,handleSubmit:K,watch:ae,setValue:M,getValues:W,reset:Ge,resetField:ke,clearErrors:U,unregister:se,setError:Y,setFocus:He,getFieldState:Z};return{...Kt,formControl:Kt}}function l4(e={}){const t=F.useRef(void 0),r=F.useRef(void 0),[n,a]=F.useState({isDirty:!1,isValidating:!1,isLoading:Di(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:Di(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:n},e.defaultValues&&!Di(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:o,...l}=GKe(e);t.current={...l,formState:n}}const i=t.current.control;return i._options=e,s4(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>a({...i._formState}),reRenderRoot:!0});return a(l=>({...l,isReady:!0})),i._formState.isReady=!0,o},[i]),F.useEffect(()=>i._disableForm(e.disabled),[i,e.disabled]),F.useEffect(()=>{e.mode&&(i._options.mode=e.mode),e.reValidateMode&&(i._options.reValidateMode=e.reValidateMode)},[i,e.mode,e.reValidateMode]),F.useEffect(()=>{e.errors&&(i._setErrors(e.errors),i._focusError())},[i,e.errors]),F.useEffect(()=>{e.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,e.shouldUnregister]),F.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==n.isDirty&&i._subjects.state.next({isDirty:o})}},[i,n.isDirty]),F.useEffect(()=>{e.values&&!il(e.values,r.current)?(i._reset(e.values,{keepFieldsRef:!0,...i._options.resetOptions}),r.current=e.values,a(o=>({...o}))):i._resetDefaultValues()},[i,e.values]),F.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),t.current.formState=XJ(n,i),t.current}const $B=(e,t,r)=>{if(e&&"reportValidity"in e){const n=$e(r,t);e.setCustomValidity(n&&n.message||""),e.reportValidity()}},see=(e,t)=>{for(const r in t.fields){const n=t.fields[r];n&&n.ref&&"reportValidity"in n.ref?$B(n.ref,r,e):n.refs&&n.refs.forEach(a=>$B(a,r,e))}},HKe=(e,t)=>{t.shouldUseNativeValidation&&see(e,t);const r={};for(const n in e){const a=$e(t.fields,n),i=Object.assign(e[n]||{},{ref:a&&a.ref});if(KKe(t.names||Object.keys(e),n)){const o=Object.assign({},$e(r,n));sr(o,"root",i),sr(r,n,o)}else sr(r,n,i)}return r},KKe=(e,t)=>e.some(r=>r.startsWith(t+"."));var YKe=function(e,t){for(var r={};e.length;){var n=e[0],a=n.code,i=n.message,o=n.path.join(".");if(!r[o])if("unionErrors"in n){var l=n.unionErrors[0].errors[0];r[o]={message:l.message,type:l.code}}else r[o]={message:i,type:a};if("unionErrors"in n&&n.unionErrors.forEach(function(d){return d.errors.forEach(function(h){return e.push(h)})}),t){var c=r[o].types,u=c&&c[n.code];r[o]=ZJ(o,t,r,a,u?[].concat(u,n.message):n.message)}e.shift()}return r},c4=function(e,t,r){return r===void 0&&(r={}),function(n,a,i){try{return Promise.resolve(function(o,l){try{var c=Promise.resolve(e[r.mode==="sync"?"parse":"parseAsync"](n,t)).then(function(u){return i.shouldUseNativeValidation&&see({},i),{errors:{},values:r.raw?n:u}})}catch(u){return l(u)}return c&&c.then?c.then(void 0,l):c}(0,function(o){if(function(l){return Array.isArray(l==null?void 0:l.errors)}(o))return{values:{},errors:HKe(YKe(o.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}}},Zt;(function(e){e.assertEqual=a=>{};function t(a){}e.assertIs=t;function r(a){throw new Error}e.assertNever=r,e.arrayToEnum=a=>{const i={};for(const o of a)i[o]=o;return i},e.getValidEnumValues=a=>{const i=e.objectKeys(a).filter(l=>typeof a[a[l]]!="number"),o={};for(const l of i)o[l]=a[l];return e.objectValues(o)},e.objectValues=a=>e.objectKeys(a).map(function(i){return a[i]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const o in a)Object.prototype.hasOwnProperty.call(a,o)&&i.push(o);return i},e.find=(a,i)=>{for(const o of a)if(i(o))return o},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function n(a,i=" | "){return a.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}e.joinValues=n,e.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(Zt||(Zt={}));var FB;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(FB||(FB={}));const Ke=Zt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ic=e=>{switch(typeof e){case"undefined":return Ke.undefined;case"string":return Ke.string;case"number":return Number.isNaN(e)?Ke.nan:Ke.number;case"boolean":return Ke.boolean;case"function":return Ke.function;case"bigint":return Ke.bigint;case"symbol":return Ke.symbol;case"object":return Array.isArray(e)?Ke.array:e===null?Ke.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?Ke.promise:typeof Map<"u"&&e instanceof Map?Ke.map:typeof Set<"u"&&e instanceof Set?Ke.set:typeof Date<"u"&&e instanceof Date?Ke.date:Ke.object;default:return Ke.unknown}},Pe=Zt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Ol extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(i){return i.message},n={_errors:[]},a=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(a);else if(o.code==="invalid_return_type")a(o.returnTypeError);else if(o.code==="invalid_arguments")a(o.argumentsError);else if(o.path.length===0)n._errors.push(r(o));else{let l=n,c=0;for(;c<o.path.length;){const u=o.path[c];c===o.path.length-1?(l[u]=l[u]||{_errors:[]},l[u]._errors.push(r(o))):l[u]=l[u]||{_errors:[]},l=l[u],c++}}};return a(this),n}static assert(t){if(!(t instanceof Ol))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Zt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const a of this.issues)if(a.path.length>0){const i=a.path[0];r[i]=r[i]||[],r[i].push(t(a))}else n.push(t(a));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Ol.create=e=>new Ol(e);const IA=(e,t)=>{let r;switch(e.code){case Pe.invalid_type:e.received===Ke.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case Pe.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,Zt.jsonStringifyReplacer)}`;break;case Pe.unrecognized_keys:r=`Unrecognized key(s) in object: ${Zt.joinValues(e.keys,", ")}`;break;case Pe.invalid_union:r="Invalid input";break;case Pe.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Zt.joinValues(e.options)}`;break;case Pe.invalid_enum_value:r=`Invalid enum value. Expected ${Zt.joinValues(e.options)}, received '${e.received}'`;break;case Pe.invalid_arguments:r="Invalid function arguments";break;case Pe.invalid_return_type:r="Invalid function return type";break;case Pe.invalid_date:r="Invalid date";break;case Pe.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:Zt.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case Pe.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case Pe.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case Pe.custom:r="Invalid input";break;case Pe.invalid_intersection_types:r="Intersection results could not be merged";break;case Pe.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case Pe.not_finite:r="Number must be finite";break;default:r=t.defaultError,Zt.assertNever(e)}return{message:r}};let XKe=IA;function QKe(){return XKe}const ZKe=e=>{const{data:t,path:r,errorMaps:n,issueData:a}=e,i=[...r,...a.path||[]],o={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let l="";const c=n.filter(u=>!!u).slice().reverse();for(const u of c)l=u(o,{data:t,defaultError:l}).message;return{...a,path:i,message:l}};function Be(e,t){const r=QKe(),n=ZKe({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===IA?void 0:IA].filter(a=>!!a)});e.common.issues.push(n)}class Va{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const a of r){if(a.status==="aborted")return gt;a.status==="dirty"&&t.dirty(),n.push(a.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const a of r){const i=await a.key,o=await a.value;n.push({key:i,value:o})}return Va.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const a of r){const{key:i,value:o}=a;if(i.status==="aborted"||o.status==="aborted")return gt;i.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||a.alwaysSet)&&(n[i.value]=o.value)}return{status:t.value,value:n}}}const gt=Object.freeze({status:"aborted"}),pv=e=>({status:"dirty",value:e}),mi=e=>({status:"valid",value:e}),LB=e=>e.status==="aborted",BB=e=>e.status==="dirty",Rp=e=>e.status==="valid",D1=e=>typeof Promise<"u"&&e instanceof Promise;var Ze;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Ze||(Ze={}));class Lo{constructor(t,r,n,a){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const UB=(e,t)=>{if(Rp(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Ol(e.common.issues);return this._error=r,this._error}}};function Tt(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:a}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(o,l)=>{const{message:c}=e;return o.code==="invalid_enum_value"?{message:c??l.defaultError}:typeof l.data>"u"?{message:c??n??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:c??r??l.defaultError}},description:a}}class Ht{get description(){return this._def.description}_getType(t){return ic(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:ic(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Va,ctx:{common:t.parent.common,data:t.data,parsedType:ic(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(D1(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){const n={common:{issues:[],async:(r==null?void 0:r.async)??!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ic(t)},a=this._parseSync({data:t,path:n.path,parent:n});return UB(n,a)}"~validate"(t){var n,a;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ic(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:r});return Rp(i)?{value:i.value}:{issues:r.common.issues}}catch(i){(a=(n=i==null?void 0:i.message)==null?void 0:n.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:r}).then(i=>Rp(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ic(t)},a=this._parse({data:t,path:n.path,parent:n}),i=await(D1(a)?a:Promise.resolve(a));return UB(n,i)}refine(t,r){const n=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,i)=>{const o=t(a),l=()=>i.addIssue({code:Pe.custom,...n(a)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(t,r){return this._refinement((n,a)=>t(n)?!0:(a.addIssue(typeof r=="function"?r(n,a):r),!1))}_refinement(t){return new au({schema:this,typeName:vt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Hc.create(this,this._def)}nullable(){return $p.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Oo.create(this)}promise(){return L1.create(this,this._def)}or(t){return M1.create([this,t],this._def)}and(t){return $1.create(this,t,this._def)}transform(t){return new au({...Tt(this._def),schema:this,typeName:vt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new HA({...Tt(this._def),innerType:this,defaultValue:r,typeName:vt.ZodDefault})}brand(){return new wYe({typeName:vt.ZodBranded,type:this,...Tt(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new KA({...Tt(this._def),innerType:this,catchValue:r,typeName:vt.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return u4.create(this,t)}readonly(){return XA.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const JKe=/^c[^\s-]{8,}$/i,eYe=/^[0-9a-z]+$/,tYe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,rYe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,nYe=/^[a-z0-9_-]{21}$/i,aYe=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,sYe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,iYe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,oYe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let PS;const lYe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,cYe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,uYe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,dYe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,hYe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,fYe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,iee="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",pYe=new RegExp(`^${iee}$`);function oee(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function mYe(e){return new RegExp(`^${oee(e)}$`)}function vYe(e){let t=`${iee}T${oee(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function gYe(e,t){return!!((t==="v4"||!t)&&lYe.test(e)||(t==="v6"||!t)&&uYe.test(e))}function xYe(e,t){if(!aYe.test(e))return!1;try{const[r]=e.split(".");if(!r)return!1;const n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(n));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||t&&a.alg!==t)}catch{return!1}}function yYe(e,t){return!!((t==="v4"||!t)&&cYe.test(e)||(t==="v6"||!t)&&dYe.test(e))}class hl extends Ht{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Ke.string){const i=this._getOrReturnCtx(t);return Be(i,{code:Pe.invalid_type,expected:Ke.string,received:i.parsedType}),gt}const n=new Va;let a;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(a=this._getOrReturnCtx(t,a),Be(a,{code:Pe.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")t.data.length>i.value&&(a=this._getOrReturnCtx(t,a),Be(a,{code:Pe.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const o=t.data.length>i.value,l=t.data.length<i.value;(o||l)&&(a=this._getOrReturnCtx(t,a),o?Be(a,{code:Pe.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&Be(a,{code:Pe.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")iYe.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"email",code:Pe.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")PS||(PS=new RegExp(oYe,"u")),PS.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"emoji",code:Pe.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")rYe.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"uuid",code:Pe.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")nYe.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"nanoid",code:Pe.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")JKe.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"cuid",code:Pe.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")eYe.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"cuid2",code:Pe.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")tYe.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"ulid",code:Pe.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),Be(a,{validation:"url",code:Pe.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"regex",code:Pe.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(t,a),Be(a,{code:Pe.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(a=this._getOrReturnCtx(t,a),Be(a,{code:Pe.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(a=this._getOrReturnCtx(t,a),Be(a,{code:Pe.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?vYe(i).test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{code:Pe.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?pYe.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{code:Pe.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?mYe(i).test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{code:Pe.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?sYe.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"duration",code:Pe.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?gYe(t.data,i.version)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"ip",code:Pe.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?xYe(t.data,i.alg)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"jwt",code:Pe.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?yYe(t.data,i.version)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"cidr",code:Pe.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?hYe.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"base64",code:Pe.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?fYe.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"base64url",code:Pe.invalid_string,message:i.message}),n.dirty()):Zt.assertNever(i);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(a=>t.test(a),{validation:r,code:Pe.invalid_string,...Ze.errToObj(n)})}_addCheck(t){return new hl({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Ze.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Ze.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Ze.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Ze.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Ze.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Ze.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Ze.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Ze.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Ze.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Ze.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Ze.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Ze.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Ze.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...Ze.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Ze.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Ze.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...Ze.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...Ze.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...Ze.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...Ze.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...Ze.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...Ze.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...Ze.errToObj(r)})}nonempty(t){return this.min(1,Ze.errToObj(t))}trim(){return new hl({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new hl({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new hl({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}hl.create=e=>new hl({checks:[],typeName:vt.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...Tt(e)});function bYe(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=r>n?r:n,i=Number.parseInt(e.toFixed(a).replace(".","")),o=Number.parseInt(t.toFixed(a).replace(".",""));return i%o/10**a}class Op extends Ht{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Ke.number){const i=this._getOrReturnCtx(t);return Be(i,{code:Pe.invalid_type,expected:Ke.number,received:i.parsedType}),gt}let n;const a=new Va;for(const i of this._def.checks)i.kind==="int"?Zt.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),Be(n,{code:Pe.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),Be(n,{code:Pe.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),Be(n,{code:Pe.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?bYe(t.data,i.value)!==0&&(n=this._getOrReturnCtx(t,n),Be(n,{code:Pe.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),Be(n,{code:Pe.not_finite,message:i.message}),a.dirty()):Zt.assertNever(i);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,Ze.toString(r))}gt(t,r){return this.setLimit("min",t,!1,Ze.toString(r))}lte(t,r){return this.setLimit("max",t,!0,Ze.toString(r))}lt(t,r){return this.setLimit("max",t,!1,Ze.toString(r))}setLimit(t,r,n,a){return new Op({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:Ze.toString(a)}]})}_addCheck(t){return new Op({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Ze.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ze.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ze.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ze.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ze.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:Ze.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:Ze.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ze.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ze.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Zt.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}Op.create=e=>new Op({checks:[],typeName:vt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Tt(e)});class Ip extends Ht{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==Ke.bigint)return this._getInvalidInput(t);let n;const a=new Va;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),Be(n,{code:Pe.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),Be(n,{code:Pe.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),Be(n,{code:Pe.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):Zt.assertNever(i);return{status:a.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return Be(r,{code:Pe.invalid_type,expected:Ke.bigint,received:r.parsedType}),gt}gte(t,r){return this.setLimit("min",t,!0,Ze.toString(r))}gt(t,r){return this.setLimit("min",t,!1,Ze.toString(r))}lte(t,r){return this.setLimit("max",t,!0,Ze.toString(r))}lt(t,r){return this.setLimit("max",t,!1,Ze.toString(r))}setLimit(t,r,n,a){return new Ip({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:Ze.toString(a)}]})}_addCheck(t){return new Ip({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ze.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ze.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ze.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ze.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:Ze.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Ip.create=e=>new Ip({checks:[],typeName:vt.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...Tt(e)});class DA extends Ht{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==Ke.boolean){const n=this._getOrReturnCtx(t);return Be(n,{code:Pe.invalid_type,expected:Ke.boolean,received:n.parsedType}),gt}return mi(t.data)}}DA.create=e=>new DA({typeName:vt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Tt(e)});class dx extends Ht{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Ke.date){const i=this._getOrReturnCtx(t);return Be(i,{code:Pe.invalid_type,expected:Ke.date,received:i.parsedType}),gt}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return Be(i,{code:Pe.invalid_date}),gt}const n=new Va;let a;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(a=this._getOrReturnCtx(t,a),Be(a,{code:Pe.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(a=this._getOrReturnCtx(t,a),Be(a,{code:Pe.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):Zt.assertNever(i);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new dx({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:Ze.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:Ze.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}dx.create=e=>new dx({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:vt.ZodDate,...Tt(e)});class MA extends Ht{_parse(t){if(this._getType(t)!==Ke.symbol){const n=this._getOrReturnCtx(t);return Be(n,{code:Pe.invalid_type,expected:Ke.symbol,received:n.parsedType}),gt}return mi(t.data)}}MA.create=e=>new MA({typeName:vt.ZodSymbol,...Tt(e)});class $A extends Ht{_parse(t){if(this._getType(t)!==Ke.undefined){const n=this._getOrReturnCtx(t);return Be(n,{code:Pe.invalid_type,expected:Ke.undefined,received:n.parsedType}),gt}return mi(t.data)}}$A.create=e=>new $A({typeName:vt.ZodUndefined,...Tt(e)});class FA extends Ht{_parse(t){if(this._getType(t)!==Ke.null){const n=this._getOrReturnCtx(t);return Be(n,{code:Pe.invalid_type,expected:Ke.null,received:n.parsedType}),gt}return mi(t.data)}}FA.create=e=>new FA({typeName:vt.ZodNull,...Tt(e)});class LA extends Ht{constructor(){super(...arguments),this._any=!0}_parse(t){return mi(t.data)}}LA.create=e=>new LA({typeName:vt.ZodAny,...Tt(e)});class BA extends Ht{constructor(){super(...arguments),this._unknown=!0}_parse(t){return mi(t.data)}}BA.create=e=>new BA({typeName:vt.ZodUnknown,...Tt(e)});class nu extends Ht{_parse(t){const r=this._getOrReturnCtx(t);return Be(r,{code:Pe.invalid_type,expected:Ke.never,received:r.parsedType}),gt}}nu.create=e=>new nu({typeName:vt.ZodNever,...Tt(e)});class UA extends Ht{_parse(t){if(this._getType(t)!==Ke.undefined){const n=this._getOrReturnCtx(t);return Be(n,{code:Pe.invalid_type,expected:Ke.void,received:n.parsedType}),gt}return mi(t.data)}}UA.create=e=>new UA({typeName:vt.ZodVoid,...Tt(e)});class Oo extends Ht{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),a=this._def;if(r.parsedType!==Ke.array)return Be(r,{code:Pe.invalid_type,expected:Ke.array,received:r.parsedType}),gt;if(a.exactLength!==null){const o=r.data.length>a.exactLength.value,l=r.data.length<a.exactLength.value;(o||l)&&(Be(r,{code:o?Pe.too_big:Pe.too_small,minimum:l?a.exactLength.value:void 0,maximum:o?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(Be(r,{code:Pe.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(Be(r,{code:Pe.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((o,l)=>a.type._parseAsync(new Lo(r,o,r.path,l)))).then(o=>Va.mergeArray(n,o));const i=[...r.data].map((o,l)=>a.type._parseSync(new Lo(r,o,r.path,l)));return Va.mergeArray(n,i)}get element(){return this._def.type}min(t,r){return new Oo({...this._def,minLength:{value:t,message:Ze.toString(r)}})}max(t,r){return new Oo({...this._def,maxLength:{value:t,message:Ze.toString(r)}})}length(t,r){return new Oo({...this._def,exactLength:{value:t,message:Ze.toString(r)}})}nonempty(t){return this.min(1,t)}}Oo.create=(e,t)=>new Oo({type:e,minLength:null,maxLength:null,exactLength:null,typeName:vt.ZodArray,...Tt(t)});function Bh(e){if(e instanceof Gr){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Hc.create(Bh(n))}return new Gr({...e._def,shape:()=>t})}else return e instanceof Oo?new Oo({...e._def,type:Bh(e.element)}):e instanceof Hc?Hc.create(Bh(e.unwrap())):e instanceof $p?$p.create(Bh(e.unwrap())):e instanceof Gd?Gd.create(e.items.map(t=>Bh(t))):e}class Gr extends Ht{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Zt.objectKeys(t);return this._cached={shape:t,keys:r},this._cached}_parse(t){if(this._getType(t)!==Ke.object){const u=this._getOrReturnCtx(t);return Be(u,{code:Pe.invalid_type,expected:Ke.object,received:u.parsedType}),gt}const{status:n,ctx:a}=this._processInputParams(t),{shape:i,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof nu&&this._def.unknownKeys==="strip"))for(const u in a.data)o.includes(u)||l.push(u);const c=[];for(const u of o){const d=i[u],h=a.data[u];c.push({key:{status:"valid",value:u},value:d._parse(new Lo(a,h,a.path,u)),alwaysSet:u in a.data})}if(this._def.catchall instanceof nu){const u=this._def.unknownKeys;if(u==="passthrough")for(const d of l)c.push({key:{status:"valid",value:d},value:{status:"valid",value:a.data[d]}});else if(u==="strict")l.length>0&&(Be(a,{code:Pe.unrecognized_keys,keys:l}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const d of l){const h=a.data[d];c.push({key:{status:"valid",value:d},value:u._parse(new Lo(a,h,a.path,d)),alwaysSet:d in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const u=[];for(const d of c){const h=await d.key,f=await d.value;u.push({key:h,value:f,alwaysSet:d.alwaysSet})}return u}).then(u=>Va.mergeObjectSync(n,u)):Va.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(t){return Ze.errToObj,new Gr({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var i,o;const a=((o=(i=this._def).errorMap)==null?void 0:o.call(i,r,n).message)??n.defaultError;return r.code==="unrecognized_keys"?{message:Ze.errToObj(t).message??a}:{message:a}}}:{}})}strip(){return new Gr({...this._def,unknownKeys:"strip"})}passthrough(){return new Gr({...this._def,unknownKeys:"passthrough"})}extend(t){return new Gr({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Gr({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:vt.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new Gr({...this._def,catchall:t})}pick(t){const r={};for(const n of Zt.objectKeys(t))t[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new Gr({...this._def,shape:()=>r})}omit(t){const r={};for(const n of Zt.objectKeys(this.shape))t[n]||(r[n]=this.shape[n]);return new Gr({...this._def,shape:()=>r})}deepPartial(){return Bh(this)}partial(t){const r={};for(const n of Zt.objectKeys(this.shape)){const a=this.shape[n];t&&!t[n]?r[n]=a:r[n]=a.optional()}return new Gr({...this._def,shape:()=>r})}required(t){const r={};for(const n of Zt.objectKeys(this.shape))if(t&&!t[n])r[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Hc;)i=i._def.innerType;r[n]=i}return new Gr({...this._def,shape:()=>r})}keyof(){return lee(Zt.objectKeys(this.shape))}}Gr.create=(e,t)=>new Gr({shape:()=>e,unknownKeys:"strip",catchall:nu.create(),typeName:vt.ZodObject,...Tt(t)});Gr.strictCreate=(e,t)=>new Gr({shape:()=>e,unknownKeys:"strict",catchall:nu.create(),typeName:vt.ZodObject,...Tt(t)});Gr.lazycreate=(e,t)=>new Gr({shape:e,unknownKeys:"strip",catchall:nu.create(),typeName:vt.ZodObject,...Tt(t)});class M1 extends Ht{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function a(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return r.common.issues.push(...l.ctx.common.issues),l.result;const o=i.map(l=>new Ol(l.ctx.common.issues));return Be(r,{code:Pe.invalid_union,unionErrors:o}),gt}if(r.common.async)return Promise.all(n.map(async i=>{const o={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(a);{let i;const o=[];for(const c of n){const u={...r,common:{...r.common,issues:[]},parent:null},d=c._parseSync({data:r.data,path:r.path,parent:u});if(d.status==="valid")return d;d.status==="dirty"&&!i&&(i={result:d,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const l=o.map(c=>new Ol(c));return Be(r,{code:Pe.invalid_union,unionErrors:l}),gt}}get options(){return this._def.options}}M1.create=(e,t)=>new M1({options:e,typeName:vt.ZodUnion,...Tt(t)});function VA(e,t){const r=ic(e),n=ic(t);if(e===t)return{valid:!0,data:e};if(r===Ke.object&&n===Ke.object){const a=Zt.objectKeys(t),i=Zt.objectKeys(e).filter(l=>a.indexOf(l)!==-1),o={...e,...t};for(const l of i){const c=VA(e[l],t[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(r===Ke.array&&n===Ke.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let i=0;i<e.length;i++){const o=e[i],l=t[i],c=VA(o,l);if(!c.valid)return{valid:!1};a.push(c.data)}return{valid:!0,data:a}}else return r===Ke.date&&n===Ke.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class $1 extends Ht{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=(i,o)=>{if(LB(i)||LB(o))return gt;const l=VA(i.value,o.value);return l.valid?((BB(i)||BB(o))&&r.dirty(),{status:r.value,value:l.data}):(Be(n,{code:Pe.invalid_intersection_types}),gt)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,o])=>a(i,o)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}$1.create=(e,t,r)=>new $1({left:e,right:t,typeName:vt.ZodIntersection,...Tt(r)});class Gd extends Ht{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==Ke.array)return Be(n,{code:Pe.invalid_type,expected:Ke.array,received:n.parsedType}),gt;if(n.data.length<this._def.items.length)return Be(n,{code:Pe.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),gt;!this._def.rest&&n.data.length>this._def.items.length&&(Be(n,{code:Pe.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...n.data].map((o,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new Lo(n,o,n.path,l)):null}).filter(o=>!!o);return n.common.async?Promise.all(i).then(o=>Va.mergeArray(r,o)):Va.mergeArray(r,i)}get items(){return this._def.items}rest(t){return new Gd({...this._def,rest:t})}}Gd.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Gd({items:e,typeName:vt.ZodTuple,rest:null,...Tt(t)})};class F1 extends Ht{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==Ke.object)return Be(n,{code:Pe.invalid_type,expected:Ke.object,received:n.parsedType}),gt;const a=[],i=this._def.keyType,o=this._def.valueType;for(const l in n.data)a.push({key:i._parse(new Lo(n,l,n.path,l)),value:o._parse(new Lo(n,n.data[l],n.path,l)),alwaysSet:l in n.data});return n.common.async?Va.mergeObjectAsync(r,a):Va.mergeObjectSync(r,a)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof Ht?new F1({keyType:t,valueType:r,typeName:vt.ZodRecord,...Tt(n)}):new F1({keyType:hl.create(),valueType:t,typeName:vt.ZodRecord,...Tt(r)})}}class zA extends Ht{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==Ke.map)return Be(n,{code:Pe.invalid_type,expected:Ke.map,received:n.parsedType}),gt;const a=this._def.keyType,i=this._def.valueType,o=[...n.data.entries()].map(([l,c],u)=>({key:a._parse(new Lo(n,l,n.path,[u,"key"])),value:i._parse(new Lo(n,c,n.path,[u,"value"]))}));if(n.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of o){const u=await c.key,d=await c.value;if(u.status==="aborted"||d.status==="aborted")return gt;(u.status==="dirty"||d.status==="dirty")&&r.dirty(),l.set(u.value,d.value)}return{status:r.value,value:l}})}else{const l=new Map;for(const c of o){const u=c.key,d=c.value;if(u.status==="aborted"||d.status==="aborted")return gt;(u.status==="dirty"||d.status==="dirty")&&r.dirty(),l.set(u.value,d.value)}return{status:r.value,value:l}}}}zA.create=(e,t,r)=>new zA({valueType:t,keyType:e,typeName:vt.ZodMap,...Tt(r)});class Dp extends Ht{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==Ke.set)return Be(n,{code:Pe.invalid_type,expected:Ke.set,received:n.parsedType}),gt;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(Be(n,{code:Pe.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(Be(n,{code:Pe.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const i=this._def.valueType;function o(c){const u=new Set;for(const d of c){if(d.status==="aborted")return gt;d.status==="dirty"&&r.dirty(),u.add(d.value)}return{status:r.value,value:u}}const l=[...n.data.values()].map((c,u)=>i._parse(new Lo(n,c,n.path,u)));return n.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(t,r){return new Dp({...this._def,minSize:{value:t,message:Ze.toString(r)}})}max(t,r){return new Dp({...this._def,maxSize:{value:t,message:Ze.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}Dp.create=(e,t)=>new Dp({valueType:e,minSize:null,maxSize:null,typeName:vt.ZodSet,...Tt(t)});class WA extends Ht{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}WA.create=(e,t)=>new WA({getter:e,typeName:vt.ZodLazy,...Tt(t)});class qA extends Ht{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return Be(r,{received:r.data,code:Pe.invalid_literal,expected:this._def.value}),gt}return{status:"valid",value:t.data}}get value(){return this._def.value}}qA.create=(e,t)=>new qA({value:e,typeName:vt.ZodLiteral,...Tt(t)});function lee(e,t){return new Mp({values:e,typeName:vt.ZodEnum,...Tt(t)})}class Mp extends Ht{_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return Be(r,{expected:Zt.joinValues(n),received:r.parsedType,code:Pe.invalid_type}),gt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return Be(r,{received:r.data,code:Pe.invalid_enum_value,options:n}),gt}return mi(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return Mp.create(t,{...this._def,...r})}exclude(t,r=this._def){return Mp.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}Mp.create=lee;class GA extends Ht{_parse(t){const r=Zt.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==Ke.string&&n.parsedType!==Ke.number){const a=Zt.objectValues(r);return Be(n,{expected:Zt.joinValues(a),received:n.parsedType,code:Pe.invalid_type}),gt}if(this._cache||(this._cache=new Set(Zt.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const a=Zt.objectValues(r);return Be(n,{received:n.data,code:Pe.invalid_enum_value,options:a}),gt}return mi(t.data)}get enum(){return this._def.values}}GA.create=(e,t)=>new GA({values:e,typeName:vt.ZodNativeEnum,...Tt(t)});class L1 extends Ht{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==Ke.promise&&r.common.async===!1)return Be(r,{code:Pe.invalid_type,expected:Ke.promise,received:r.parsedType}),gt;const n=r.parsedType===Ke.promise?r.data:Promise.resolve(r.data);return mi(n.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}L1.create=(e,t)=>new L1({type:e,typeName:vt.ZodPromise,...Tt(t)});class au extends Ht{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===vt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=this._def.effect||null,i={addIssue:o=>{Be(n,o),o.fatal?r.abort():r.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const o=a.transform(n.data,i);if(n.common.async)return Promise.resolve(o).then(async l=>{if(r.value==="aborted")return gt;const c=await this._def.schema._parseAsync({data:l,path:n.path,parent:n});return c.status==="aborted"?gt:c.status==="dirty"||r.value==="dirty"?pv(c.value):c});{if(r.value==="aborted")return gt;const l=this._def.schema._parseSync({data:o,path:n.path,parent:n});return l.status==="aborted"?gt:l.status==="dirty"||r.value==="dirty"?pv(l.value):l}}if(a.type==="refinement"){const o=l=>{const c=a.refinement(l,i);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return l.status==="aborted"?gt:(l.status==="dirty"&&r.dirty(),o(l.value),{status:r.value,value:l.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>l.status==="aborted"?gt:(l.status==="dirty"&&r.dirty(),o(l.value).then(()=>({status:r.value,value:l.value}))))}if(a.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Rp(o))return gt;const l=a.transform(o.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:l}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>Rp(o)?Promise.resolve(a.transform(o.value,i)).then(l=>({status:r.value,value:l})):gt);Zt.assertNever(a)}}au.create=(e,t,r)=>new au({schema:e,typeName:vt.ZodEffects,effect:t,...Tt(r)});au.createWithPreprocess=(e,t,r)=>new au({schema:t,effect:{type:"preprocess",transform:e},typeName:vt.ZodEffects,...Tt(r)});class Hc extends Ht{_parse(t){return this._getType(t)===Ke.undefined?mi(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Hc.create=(e,t)=>new Hc({innerType:e,typeName:vt.ZodOptional,...Tt(t)});class $p extends Ht{_parse(t){return this._getType(t)===Ke.null?mi(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}$p.create=(e,t)=>new $p({innerType:e,typeName:vt.ZodNullable,...Tt(t)});class HA extends Ht{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===Ke.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}HA.create=(e,t)=>new HA({innerType:e,typeName:vt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Tt(t)});class KA extends Ht{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return D1(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Ol(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Ol(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}KA.create=(e,t)=>new KA({innerType:e,typeName:vt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Tt(t)});class YA extends Ht{_parse(t){if(this._getType(t)!==Ke.nan){const n=this._getOrReturnCtx(t);return Be(n,{code:Pe.invalid_type,expected:Ke.nan,received:n.parsedType}),gt}return{status:"valid",value:t.data}}}YA.create=e=>new YA({typeName:vt.ZodNaN,...Tt(e)});class wYe extends Ht{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class u4 extends Ht{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?gt:i.status==="dirty"?(r.dirty(),pv(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?gt:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(t,r){return new u4({in:t,out:r,typeName:vt.ZodPipeline})}}class XA extends Ht{_parse(t){const r=this._def.innerType._parse(t),n=a=>(Rp(a)&&(a.value=Object.freeze(a.value)),a);return D1(r)?r.then(a=>n(a)):n(r)}unwrap(){return this._def.innerType}}XA.create=(e,t)=>new XA({innerType:e,typeName:vt.ZodReadonly,...Tt(t)});Gr.lazycreate;var vt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(vt||(vt={}));const qt=hl.create,QA=Op.create;YA.create;Ip.create;const Hs=DA.create;dx.create;MA.create;$A.create;FA.create;LA.create;BA.create;nu.create;UA.create;const ad=Oo.create,wd=Gr.create;Gr.strictCreate;M1.create;$1.create;Gd.create;const jYe=F1.create;zA.create;Dp.create;WA.create;qA.create;const cee=Mp.create;GA.create;L1.create;au.create;Hc.create;$p.create;au.createWithPreprocess;const d4=AKe,uee=w.createContext({}),pt=({...e})=>s.jsx(uee.Provider,{value:{name:e.name},children:s.jsx(OKe,{...e})}),m_=()=>{const e=w.useContext(uee),t=w.useContext(dee),{getFieldState:r,formState:n}=p_(),a=r(e.name,n);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:i}=t;return{id:i,name:e.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...a}},dee=w.createContext({}),Bt=w.forwardRef(({className:e,...t},r)=>{const n=w.useId();return s.jsx(dee.Provider,{value:{id:n},children:s.jsx("div",{ref:r,className:me("space-y-2",e),...t})})});Bt.displayName="FormItem";const gr=w.forwardRef(({className:e,...t},r)=>{const{error:n,formItemId:a}=m_();return s.jsx(de,{ref:r,className:me(n&&"text-destructive",e),htmlFor:a,...t})});gr.displayName="FormLabel";const Nn=w.forwardRef(({...e},t)=>{const{error:r,formItemId:n,formDescriptionId:a,formMessageId:i}=m_();return s.jsx(SV,{ref:t,id:n,"aria-describedby":r?`${a} ${i}`:`${a}`,"aria-invalid":!!r,...e})});Nn.displayName="FormControl";const Fi=w.forwardRef(({className:e,...t},r)=>{const{formDescriptionId:n}=m_();return s.jsx("p",{ref:r,id:n,className:me("text-sm text-muted-foreground",e),...t})});Fi.displayName="FormDescription";const gs=w.forwardRef(({className:e,children:t,...r},n)=>{const{error:a,formMessageId:i}=m_(),o=a?String(a==null?void 0:a.message):t;return o?s.jsx("p",{ref:n,id:i,className:me("text-sm font-medium text-destructive",e),...r,children:o}):null});gs.displayName="FormMessage";var VB=!1,zu,ZA,JA,t0,r0,hee,n0,eP,tP,rP,fee,nP,aP,pee,mee;function Ka(){if(!VB){VB=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),r=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(nP=/\b(iPhone|iP[ao]d)/.exec(e),aP=/\b(iP[ao]d)/.exec(e),rP=/Android/i.exec(e),pee=/FBAN\/\w+;/i.exec(e),mee=/Mobile/i.exec(e),fee=!!/Win64/.exec(e),t){zu=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN,zu&&document&&document.documentMode&&(zu=document.documentMode);var n=/(?:Trident\/(\d+.\d+))/.exec(e);hee=n?parseFloat(n[1])+4:zu,ZA=t[2]?parseFloat(t[2]):NaN,JA=t[3]?parseFloat(t[3]):NaN,t0=t[4]?parseFloat(t[4]):NaN,t0?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),r0=t&&t[1]?parseFloat(t[1]):NaN):r0=NaN}else zu=ZA=JA=r0=t0=NaN;if(r){if(r[1]){var a=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);n0=a?parseFloat(a[1].replace("_",".")):!0}else n0=!1;eP=!!r[2],tP=!!r[3]}else n0=eP=tP=!1}}var sP={ie:function(){return Ka()||zu},ieCompatibilityMode:function(){return Ka()||hee>zu},ie64:function(){return sP.ie()&&fee},firefox:function(){return Ka()||ZA},opera:function(){return Ka()||JA},webkit:function(){return Ka()||t0},safari:function(){return sP.webkit()},chrome:function(){return Ka()||r0},windows:function(){return Ka()||eP},osx:function(){return Ka()||n0},linux:function(){return Ka()||tP},iphone:function(){return Ka()||nP},mobile:function(){return Ka()||nP||aP||rP||mee},nativeApp:function(){return Ka()||pee},android:function(){return Ka()||rP},ipad:function(){return Ka()||aP}},NYe=sP,Ab=!!(typeof window<"u"&&window.document&&window.document.createElement),_Ye={canUseDOM:Ab,canUseWorkers:typeof Worker<"u",canUseEventListeners:Ab&&!!(window.addEventListener||window.attachEvent),canUseViewport:Ab&&!!window.screen,isInWorker:!Ab},SYe=_Ye,vee=SYe,gee;vee.canUseDOM&&(gee=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */function CYe(e,t){if(!vee.canUseDOM||t&&!("addEventListener"in document))return!1;var r="on"+e,n=r in document;if(!n){var a=document.createElement("div");a.setAttribute(r,"return;"),n=typeof a[r]=="function"}return!n&&gee&&e==="wheel"&&(n=document.implementation.hasFeature("Events.wheel","3.0")),n}var EYe=CYe,kYe=NYe,AYe=EYe,zB=10,WB=40,qB=800;function xee(e){var t=0,r=0,n=0,a=0;return"detail"in e&&(r=e.detail),"wheelDelta"in e&&(r=-e.wheelDelta/120),"wheelDeltaY"in e&&(r=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=r,r=0),n=t*zB,a=r*zB,"deltaY"in e&&(a=e.deltaY),"deltaX"in e&&(n=e.deltaX),(n||a)&&e.deltaMode&&(e.deltaMode==1?(n*=WB,a*=WB):(n*=qB,a*=qB)),n&&!t&&(t=n<1?-1:1),a&&!r&&(r=a<1?-1:1),{spinX:t,spinY:r,pixelX:n,pixelY:a}}xee.getEventType=function(){return kYe.firefox()?"DOMMouseScroll":AYe("wheel")?"wheel":"mousewheel"};var PYe=xee,TYe=PYe;const RYe=lr(TYe);function OYe(e,t,r,n,a,i){i===void 0&&(i=0);var o=Fp(e,t,i),l=o.width,c=o.height,u=Math.min(l,r),d=Math.min(c,n);return u>d*a?{width:d*a,height:d}:{width:u,height:u/a}}function IYe(e){return e.width>e.height?e.width/e.naturalWidth:e.height/e.naturalHeight}function rv(e,t,r,n,a){a===void 0&&(a=0);var i=Fp(t.width,t.height,a),o=i.width,l=i.height;return{x:GB(e.x,o,r.width,n),y:GB(e.y,l,r.height,n)}}function GB(e,t,r,n){var a=t*n/2-r/2;return v_(e,-a,a)}function HB(e,t){return Math.sqrt(Math.pow(e.y-t.y,2)+Math.pow(e.x-t.x,2))}function KB(e,t){return Math.atan2(t.y-e.y,t.x-e.x)*180/Math.PI}function DYe(e,t,r,n,a,i,o){i===void 0&&(i=0),o===void 0&&(o=!0);var l=o?MYe:$Ye,c=Fp(t.width,t.height,i),u=Fp(t.naturalWidth,t.naturalHeight,i),d={x:l(100,((c.width-r.width/a)/2-e.x/a)/c.width*100),y:l(100,((c.height-r.height/a)/2-e.y/a)/c.height*100),width:l(100,r.width/c.width*100/a),height:l(100,r.height/c.height*100/a)},h=Math.round(l(u.width,d.width*u.width/100)),f=Math.round(l(u.height,d.height*u.height/100)),p=u.width>=u.height*n,m=p?{width:Math.round(f*n),height:f}:{width:h,height:Math.round(h/n)},v=ur(ur({},m),{x:Math.round(l(u.width-m.width,d.x*u.width/100)),y:Math.round(l(u.height-m.height,d.y*u.height/100))});return{croppedAreaPercentages:d,croppedAreaPixels:v}}function MYe(e,t){return Math.min(e,Math.max(0,t))}function $Ye(e,t){return t}function FYe(e,t,r,n,a,i){var o=Fp(t.width,t.height,r),l=v_(n.width/o.width*(100/e.width),a,i),c={x:l*o.width/2-n.width/2-o.width*l*(e.x/100),y:l*o.height/2-n.height/2-o.height*l*(e.y/100)};return{crop:c,zoom:l}}function LYe(e,t,r){var n=IYe(t);return r.height>r.width?r.height/(e.height*n):r.width/(e.width*n)}function BYe(e,t,r,n,a,i){r===void 0&&(r=0);var o=Fp(t.naturalWidth,t.naturalHeight,r),l=v_(LYe(e,t,n),a,i),c=n.height>n.width?n.height/e.height:n.width/e.width,u={x:((o.width-e.width)/2-e.x)*c,y:((o.height-e.height)/2-e.y)*c};return{crop:u,zoom:l}}function YB(e,t){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}function UYe(e){return e*Math.PI/180}function Fp(e,t,r){var n=UYe(r);return{width:Math.abs(Math.cos(n)*e)+Math.abs(Math.sin(n)*t),height:Math.abs(Math.sin(n)*e)+Math.abs(Math.cos(n)*t)}}function v_(e,t,r){return Math.min(Math.max(e,t),r)}function Pb(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(function(r){return typeof r=="string"&&r.length>0}).join(" ").trim()}var VYe=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,zYe=1,WYe=3,qYe=1,GYe=function(e){PT(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.cropperRef=w.createRef(),r.imageRef=w.createRef(),r.videoRef=w.createRef(),r.containerPosition={x:0,y:0},r.containerRef=null,r.styleRef=null,r.containerRect=null,r.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},r.dragStartPosition={x:0,y:0},r.dragStartCrop={x:0,y:0},r.gestureZoomStart=0,r.gestureRotationStart=0,r.isTouching=!1,r.lastPinchDistance=0,r.lastPinchRotation=0,r.rafDragTimeout=null,r.rafPinchTimeout=null,r.wheelTimer=null,r.currentDoc=typeof document<"u"?document:null,r.currentWindow=typeof window<"u"?window:null,r.resizeObserver=null,r.previousCropSize=null,r.isInitialized=!1,r.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},r.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!r.containerRef)){var n=!0;r.resizeObserver=new window.ResizeObserver(function(a){if(n){n=!1;return}r.computeSizes()}),r.resizeObserver.observe(r.containerRef)}},r.preventZoomSafari=function(n){return n.preventDefault()},r.cleanEvents=function(){r.currentDoc&&(r.currentDoc.removeEventListener("mousemove",r.onMouseMove),r.currentDoc.removeEventListener("mouseup",r.onDragStopped),r.currentDoc.removeEventListener("touchmove",r.onTouchMove),r.currentDoc.removeEventListener("touchend",r.onDragStopped),r.currentDoc.removeEventListener("gesturechange",r.onGestureChange),r.currentDoc.removeEventListener("gestureend",r.onGestureEnd),r.currentDoc.removeEventListener("scroll",r.onScroll))},r.clearScrollEvent=function(){r.containerRef&&r.containerRef.removeEventListener("wheel",r.onWheel),r.wheelTimer&&clearTimeout(r.wheelTimer)},r.onMediaLoad=function(){var n=r.computeSizes();n&&(r.previousCropSize=n,r.emitCropData(),r.setInitialCrop(n),r.isInitialized=!0),r.props.onMediaLoaded&&r.props.onMediaLoaded(r.mediaSize)},r.setInitialCrop=function(n){if(r.props.initialCroppedAreaPercentages){var a=FYe(r.props.initialCroppedAreaPercentages,r.mediaSize,r.props.rotation,n,r.props.minZoom,r.props.maxZoom),i=a.crop,o=a.zoom;r.props.onCropChange(i),r.props.onZoomChange&&r.props.onZoomChange(o)}else if(r.props.initialCroppedAreaPixels){var l=BYe(r.props.initialCroppedAreaPixels,r.mediaSize,r.props.rotation,n,r.props.minZoom,r.props.maxZoom),i=l.crop,o=l.zoom;r.props.onCropChange(i),r.props.onZoomChange&&r.props.onZoomChange(o)}},r.computeSizes=function(){var n,a,i,o,l,c,u=r.imageRef.current||r.videoRef.current;if(u&&r.containerRef){r.containerRect=r.containerRef.getBoundingClientRect(),r.saveContainerPosition();var d=r.containerRect.width/r.containerRect.height,h=((n=r.imageRef.current)===null||n===void 0?void 0:n.naturalWidth)||((a=r.videoRef.current)===null||a===void 0?void 0:a.videoWidth)||0,f=((i=r.imageRef.current)===null||i===void 0?void 0:i.naturalHeight)||((o=r.videoRef.current)===null||o===void 0?void 0:o.videoHeight)||0,p=u.offsetWidth<h||u.offsetHeight<f,m=h/f,v=void 0;if(p)switch(r.state.mediaObjectFit){default:case"contain":v=d>m?{width:r.containerRect.height*m,height:r.containerRect.height}:{width:r.containerRect.width,height:r.containerRect.width/m};break;case"horizontal-cover":v={width:r.containerRect.width,height:r.containerRect.width/m};break;case"vertical-cover":v={width:r.containerRect.height*m,height:r.containerRect.height};break}else v={width:u.offsetWidth,height:u.offsetHeight};r.mediaSize=ur(ur({},v),{naturalWidth:h,naturalHeight:f}),r.props.setMediaSize&&r.props.setMediaSize(r.mediaSize);var g=r.props.cropSize?r.props.cropSize:OYe(r.mediaSize.width,r.mediaSize.height,r.containerRect.width,r.containerRect.height,r.props.aspect,r.props.rotation);return(((l=r.state.cropSize)===null||l===void 0?void 0:l.height)!==g.height||((c=r.state.cropSize)===null||c===void 0?void 0:c.width)!==g.width)&&r.props.onCropSizeChange&&r.props.onCropSizeChange(g),r.setState({cropSize:g},r.recomputeCropPosition),r.props.setCropSize&&r.props.setCropSize(g),g}},r.saveContainerPosition=function(){if(r.containerRef){var n=r.containerRef.getBoundingClientRect();r.containerPosition={x:n.left,y:n.top}}},r.onMouseDown=function(n){r.currentDoc&&(n.preventDefault(),r.currentDoc.addEventListener("mousemove",r.onMouseMove),r.currentDoc.addEventListener("mouseup",r.onDragStopped),r.saveContainerPosition(),r.onDragStart(t.getMousePoint(n)))},r.onMouseMove=function(n){return r.onDrag(t.getMousePoint(n))},r.onScroll=function(n){r.currentDoc&&(n.preventDefault(),r.saveContainerPosition())},r.onTouchStart=function(n){r.currentDoc&&(r.isTouching=!0,!(r.props.onTouchRequest&&!r.props.onTouchRequest(n))&&(r.currentDoc.addEventListener("touchmove",r.onTouchMove,{passive:!1}),r.currentDoc.addEventListener("touchend",r.onDragStopped),r.saveContainerPosition(),n.touches.length===2?r.onPinchStart(n):n.touches.length===1&&r.onDragStart(t.getTouchPoint(n.touches[0]))))},r.onTouchMove=function(n){n.preventDefault(),n.touches.length===2?r.onPinchMove(n):n.touches.length===1&&r.onDrag(t.getTouchPoint(n.touches[0]))},r.onGestureStart=function(n){r.currentDoc&&(n.preventDefault(),r.currentDoc.addEventListener("gesturechange",r.onGestureChange),r.currentDoc.addEventListener("gestureend",r.onGestureEnd),r.gestureZoomStart=r.props.zoom,r.gestureRotationStart=r.props.rotation)},r.onGestureChange=function(n){if(n.preventDefault(),!r.isTouching){var a=t.getMousePoint(n),i=r.gestureZoomStart-1+n.scale;if(r.setNewZoom(i,a,{shouldUpdatePosition:!0}),r.props.onRotationChange){var o=r.gestureRotationStart+n.rotation;r.props.onRotationChange(o)}}},r.onGestureEnd=function(n){r.cleanEvents()},r.onDragStart=function(n){var a,i,o=n.x,l=n.y;r.dragStartPosition={x:o,y:l},r.dragStartCrop=ur({},r.props.crop),(i=(a=r.props).onInteractionStart)===null||i===void 0||i.call(a)},r.onDrag=function(n){var a=n.x,i=n.y;r.currentWindow&&(r.rafDragTimeout&&r.currentWindow.cancelAnimationFrame(r.rafDragTimeout),r.rafDragTimeout=r.currentWindow.requestAnimationFrame(function(){if(r.state.cropSize&&!(a===void 0||i===void 0)){var o=a-r.dragStartPosition.x,l=i-r.dragStartPosition.y,c={x:r.dragStartCrop.x+o,y:r.dragStartCrop.y+l},u=r.props.restrictPosition?rv(c,r.mediaSize,r.state.cropSize,r.props.zoom,r.props.rotation):c;r.props.onCropChange(u)}}))},r.onDragStopped=function(){var n,a;r.isTouching=!1,r.cleanEvents(),r.emitCropData(),(a=(n=r.props).onInteractionEnd)===null||a===void 0||a.call(n)},r.onWheel=function(n){if(r.currentWindow&&!(r.props.onWheelRequest&&!r.props.onWheelRequest(n))){n.preventDefault();var a=t.getMousePoint(n),i=RYe(n).pixelY,o=r.props.zoom-i*r.props.zoomSpeed/200;r.setNewZoom(o,a,{shouldUpdatePosition:!0}),r.state.hasWheelJustStarted||r.setState({hasWheelJustStarted:!0},function(){var l,c;return(c=(l=r.props).onInteractionStart)===null||c===void 0?void 0:c.call(l)}),r.wheelTimer&&clearTimeout(r.wheelTimer),r.wheelTimer=r.currentWindow.setTimeout(function(){return r.setState({hasWheelJustStarted:!1},function(){var l,c;return(c=(l=r.props).onInteractionEnd)===null||c===void 0?void 0:c.call(l)})},250)}},r.getPointOnContainer=function(n,a){var i=n.x,o=n.y;if(!r.containerRect)throw new Error("The Cropper is not mounted");return{x:r.containerRect.width/2-(i-a.x),y:r.containerRect.height/2-(o-a.y)}},r.getPointOnMedia=function(n){var a=n.x,i=n.y,o=r.props,l=o.crop,c=o.zoom;return{x:(a+l.x)/c,y:(i+l.y)/c}},r.setNewZoom=function(n,a,i){var o=i===void 0?{}:i,l=o.shouldUpdatePosition,c=l===void 0?!0:l;if(!(!r.state.cropSize||!r.props.onZoomChange)){var u=v_(n,r.props.minZoom,r.props.maxZoom);if(c){var d=r.getPointOnContainer(a,r.containerPosition),h=r.getPointOnMedia(d),f={x:h.x*u-d.x,y:h.y*u-d.y},p=r.props.restrictPosition?rv(f,r.mediaSize,r.state.cropSize,u,r.props.rotation):f;r.props.onCropChange(p)}r.props.onZoomChange(u)}},r.getCropData=function(){if(!r.state.cropSize)return null;var n=r.props.restrictPosition?rv(r.props.crop,r.mediaSize,r.state.cropSize,r.props.zoom,r.props.rotation):r.props.crop;return DYe(n,r.mediaSize,r.state.cropSize,r.getAspect(),r.props.zoom,r.props.rotation,r.props.restrictPosition)},r.emitCropData=function(){var n=r.getCropData();if(n){var a=n.croppedAreaPercentages,i=n.croppedAreaPixels;r.props.onCropComplete&&r.props.onCropComplete(a,i),r.props.onCropAreaChange&&r.props.onCropAreaChange(a,i)}},r.emitCropAreaChange=function(){var n=r.getCropData();if(n){var a=n.croppedAreaPercentages,i=n.croppedAreaPixels;r.props.onCropAreaChange&&r.props.onCropAreaChange(a,i)}},r.recomputeCropPosition=function(){if(r.state.cropSize){var n=r.props.crop;if(r.isInitialized&&r.previousCropSize){var a=Math.abs(r.previousCropSize.width-r.state.cropSize.width)>1e-6||Math.abs(r.previousCropSize.height-r.state.cropSize.height)>1e-6;if(a){var i=r.state.cropSize.width/r.previousCropSize.width,o=r.state.cropSize.height/r.previousCropSize.height;n={x:r.props.crop.x*i,y:r.props.crop.y*o}}}var l=r.props.restrictPosition?rv(n,r.mediaSize,r.state.cropSize,r.props.zoom,r.props.rotation):n;r.previousCropSize=r.state.cropSize,r.props.onCropChange(l),r.emitCropData()}},r.onKeyDown=function(n){var a,i,o=r.props,l=o.crop,c=o.onCropChange,u=o.keyboardStep,d=o.zoom,h=o.rotation,f=u;if(r.state.cropSize){n.shiftKey&&(f*=.2);var p=ur({},l);switch(n.key){case"ArrowUp":p.y-=f,n.preventDefault();break;case"ArrowDown":p.y+=f,n.preventDefault();break;case"ArrowLeft":p.x-=f,n.preventDefault();break;case"ArrowRight":p.x+=f,n.preventDefault();break;default:return}r.props.restrictPosition&&(p=rv(p,r.mediaSize,r.state.cropSize,d,h)),n.repeat||(i=(a=r.props).onInteractionStart)===null||i===void 0||i.call(a),c(p)}},r.onKeyUp=function(n){var a,i;switch(n.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":n.preventDefault();break;default:return}r.emitCropData(),(i=(a=r.props).onInteractionEnd)===null||i===void 0||i.call(a)},r}return t.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=VYe,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef),this.props.setCropperRef&&this.props.setCropperRef(this.cropperRef))},t.prototype.componentWillUnmount=function(){var r,n;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(r=this.resizeObserver)===null||r===void 0||r.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((n=this.styleRef.parentNode)===null||n===void 0||n.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},t.prototype.componentDidUpdate=function(r){var n,a,i,o,l,c,u,d,h;r.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):r.aspect!==this.props.aspect?this.computeSizes():r.objectFit!==this.props.objectFit?this.computeSizes():r.zoom!==this.props.zoom?this.recomputeCropPosition():((n=r.cropSize)===null||n===void 0?void 0:n.height)!==((a=this.props.cropSize)===null||a===void 0?void 0:a.height)||((i=r.cropSize)===null||i===void 0?void 0:i.width)!==((o=this.props.cropSize)===null||o===void 0?void 0:o.width)?this.computeSizes():(((l=r.crop)===null||l===void 0?void 0:l.x)!==((c=this.props.crop)===null||c===void 0?void 0:c.x)||((u=r.crop)===null||u===void 0?void 0:u.y)!==((d=this.props.crop)===null||d===void 0?void 0:d.y))&&this.emitCropAreaChange(),r.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),r.video!==this.props.video&&((h=this.videoRef.current)===null||h===void 0||h.load());var f=this.getObjectFit();f!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:f},this.computeSizes)},t.prototype.getAspect=function(){var r=this.props,n=r.cropSize,a=r.aspect;return n?n.width/n.height:a},t.prototype.getObjectFit=function(){var r,n,a,i;if(this.props.objectFit==="cover"){var o=this.imageRef.current||this.videoRef.current;if(o&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var l=this.containerRect.width/this.containerRect.height,c=((r=this.imageRef.current)===null||r===void 0?void 0:r.naturalWidth)||((n=this.videoRef.current)===null||n===void 0?void 0:n.videoWidth)||0,u=((a=this.imageRef.current)===null||a===void 0?void 0:a.naturalHeight)||((i=this.videoRef.current)===null||i===void 0?void 0:i.videoHeight)||0,d=c/u;return d<l?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},t.prototype.onPinchStart=function(r){var n=t.getTouchPoint(r.touches[0]),a=t.getTouchPoint(r.touches[1]);this.lastPinchDistance=HB(n,a),this.lastPinchRotation=KB(n,a),this.onDragStart(YB(n,a))},t.prototype.onPinchMove=function(r){var n=this;if(!(!this.currentDoc||!this.currentWindow)){var a=t.getTouchPoint(r.touches[0]),i=t.getTouchPoint(r.touches[1]),o=YB(a,i);this.onDrag(o),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var l=HB(a,i),c=n.props.zoom*(l/n.lastPinchDistance);n.setNewZoom(c,o,{shouldUpdatePosition:!1}),n.lastPinchDistance=l;var u=KB(a,i),d=n.props.rotation+(u-n.lastPinchRotation);n.props.onRotationChange&&n.props.onRotationChange(d),n.lastPinchRotation=u})}},t.prototype.render=function(){var r=this,n,a=this.props,i=a.image,o=a.video,l=a.mediaProps,c=a.cropperProps,u=a.transform,d=a.crop,h=d.x,f=d.y,p=a.rotation,m=a.zoom,v=a.cropShape,g=a.showGrid,x=a.roundCropAreaPixels,y=a.style,b=y.containerStyle,N=y.cropAreaStyle,j=y.mediaStyle,_=a.classes,S=_.containerClassName,C=_.cropAreaClassName,E=_.mediaClassName,k=(n=this.state.mediaObjectFit)!==null&&n!==void 0?n:this.getObjectFit();return w.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(A){return r.containerRef=A},"data-testid":"container",style:b,className:Pb("reactEasyCrop_Container",S)},i?w.createElement("img",ur({alt:"",className:Pb("reactEasyCrop_Image",k==="contain"&&"reactEasyCrop_Contain",k==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",k==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",E)},l,{src:i,ref:this.imageRef,style:ur(ur({},j),{transform:u||"translate(".concat(h,"px, ").concat(f,"px) rotate(").concat(p,"deg) scale(").concat(m,")")}),onLoad:this.onMediaLoad})):o&&w.createElement("video",ur({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:Pb("reactEasyCrop_Video",k==="contain"&&"reactEasyCrop_Contain",k==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",k==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",E)},l,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:ur(ur({},j),{transform:u||"translate(".concat(h,"px, ").concat(f,"px) rotate(").concat(p,"deg) scale(").concat(m,")")}),controls:!1}),(Array.isArray(o)?o:[{src:o}]).map(function(P){return w.createElement("source",ur({key:P.src},P))})),this.state.cropSize&&w.createElement("div",ur({ref:this.cropperRef,style:ur(ur({},N),{width:x?Math.round(this.state.cropSize.width):this.state.cropSize.width,height:x?Math.round(this.state.cropSize.height):this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,"data-testid":"cropper",className:Pb("reactEasyCrop_CropArea",v==="round"&&"reactEasyCrop_CropAreaRound",g&&"reactEasyCrop_CropAreaGrid",C)},c)))},t.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:WYe,minZoom:zYe,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},cropperProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:qYe},t.getMousePoint=function(r){return{x:Number(r.clientX),y:Number(r.clientY)}},t.getTouchPoint=function(r){return{x:Number(r.clientX),y:Number(r.clientY)}},t}(w.Component);const yee=({currentPhotoUrl:e,onPhotoChange:t})=>{const[r,n]=w.useState(null),[a,i]=w.useState({x:0,y:0}),[o,l]=w.useState(1),[c,u]=w.useState(null),[d,h]=w.useState(!1),[f,p]=w.useState(!1),m=w.useCallback((b,N)=>{u(N)},[]),v=b=>{var _;const N=(_=b.target.files)==null?void 0:_[0];if(!N)return;if(!N.type.startsWith("image/")){H.error("Please select an image file");return}if(N.size>5*1024*1024){H.error("Image must be smaller than 5MB");return}const j=new FileReader;j.onload=()=>{n(j.result),p(!0)},j.readAsDataURL(N)},g=async()=>{if(!r||!c)throw new Error("No image selected");const b=new Image;b.src=r,await new Promise(_=>{b.onload=_});const N=document.createElement("canvas"),j=N.getContext("2d");if(!j)throw new Error("Could not get canvas context");return N.width=c.width,N.height=c.height,j.drawImage(b,c.x,c.y,c.width,c.height,0,0,c.width,c.height),new Promise((_,S)=>{N.toBlob(C=>{C?_(C):S(new Error("Failed to create blob"))},"image/jpeg",.9)})},x=async()=>{if(c){h(!0);try{const b=await g(),{data:{user:N}}=await T.auth.getUser();if(!N){H.error("You must be logged in to upload photos");return}const _=`${N.id}/avatar-${Date.now()}.jpg`,{data:S,error:C}=await T.storage.from("profile-photos").upload(_,b,{contentType:"image/jpeg",upsert:!0});if(C)throw C;const{data:{publicUrl:E}}=T.storage.from("profile-photos").getPublicUrl(S.path);t(E),p(!1),n(null),H.success("Profile photo uploaded successfully!")}catch(b){console.error("Upload error:",b),H.error("Failed to upload photo. Please try again.")}finally{h(!1)}}},y=()=>{n(null),p(!1),i({x:0,y:0}),l(1)};return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-32 h-32 rounded-full bg-muted border-2 border-border overflow-hidden flex items-center justify-center",children:e?s.jsx("img",{src:e,alt:"Profile",className:"w-full h-full object-cover"}):s.jsx(Na,{className:"w-12 h-12 text-muted-foreground"})}),e&&s.jsx("button",{onClick:()=>t(""),className:"absolute -top-2 -right-2 w-8 h-8 bg-destructive text-destructive-foreground rounded-full flex items-center justify-center hover:bg-destructive/90 transition-colors","aria-label":"Remove photo",children:s.jsx(vn,{className:"w-4 h-4"})})]}),s.jsxs("div",{children:[s.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:v,className:"hidden",id:"profile-photo-input"}),s.jsx("label",{htmlFor:"profile-photo-input",children:s.jsx(L,{type:"button",variant:"outline",className:"cursor-pointer",asChild:!0,children:s.jsxs("span",{children:[s.jsx(lj,{className:"w-4 h-4 mr-2"}),e?"Change Photo":"Upload Photo"]})})})]}),s.jsx("p",{className:"text-xs text-muted-foreground text-center max-w-xs",children:"Upload a clear photo of yourself. JPG, PNG, or WEBP. Max 5MB."})]}),s.jsx(Ca,{open:f,onOpenChange:p,children:s.jsxs(oa,{className:"max-w-2xl",children:[s.jsxs(Ea,{children:[s.jsx(ka,{children:"Crop Your Photo"}),s.jsx(pu,{children:"Adjust the crop area to select the part of your image you want to use"})]}),s.jsx("div",{className:"relative h-96 bg-muted rounded-lg overflow-hidden",children:r&&s.jsx(GYe,{image:r,crop:a,zoom:o,aspect:1,cropShape:"round",showGrid:!1,onCropChange:i,onZoomChange:l,onCropComplete:m})}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Zoom"}),s.jsx("input",{type:"range",min:1,max:3,step:.1,value:o,onChange:b=>l(Number(b.target.value)),className:"w-full"})]}),s.jsxs(Hx,{children:[s.jsx(L,{type:"button",variant:"outline",onClick:y,disabled:d,children:"Cancel"}),s.jsx(L,{type:"button",onClick:x,disabled:d,children:d?"Uploading...":"Upload Photo"})]})]})})]})},HYe=({photo:e,onRemove:t,galleryType:r})=>{const{attributes:n,listeners:a,setNodeRef:i,transform:o,transition:l,isDragging:c}=$I({id:e.id}),u={transform:Vd.Transform.toString(o),transition:l};return s.jsx("div",{ref:i,style:u,className:me("relative group",c&&"z-50 opacity-50"),children:s.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-muted border-2 border-border",children:[s.jsx("img",{src:e.url,alt:`Gallery ${e.order+1}`,className:"w-full h-full object-cover"}),s.jsx("div",{...n,...a,className:"absolute top-2 left-2 w-8 h-8 bg-background/80 backdrop-blur-sm rounded-md flex items-center justify-center cursor-grab active:cursor-grabbing opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx(dT,{className:"w-4 h-4 text-foreground"})}),s.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx(xe,{variant:"secondary",className:"bg-background/80 backdrop-blur-sm",children:r==="public"?s.jsxs(s.Fragment,{children:[s.jsx(So,{className:"w-3 h-3 mr-1"})," Public"]}):s.jsxs(s.Fragment,{children:[s.jsx(Or,{className:"w-3 h-3 mr-1"})," Members"]})})}),s.jsx("button",{onClick:t,className:"absolute bottom-2 right-2 w-8 h-8 bg-destructive text-destructive-foreground rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity hover:bg-destructive/90","aria-label":"Remove photo",children:s.jsx(vn,{className:"w-4 h-4"})}),s.jsx("div",{className:"absolute bottom-2 left-2 w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-semibold",children:e.order+1})]})})},XB=({photos:e,onPhotosChange:t,maxPhotos:r=8,galleryType:n})=>{const[a,i]=w.useState(!1),o=PI(kp(iy),kp(sy,{coordinateGetter:FI})),l=h=>{const{active:f,over:p}=h;if(p&&f.id!==p.id){const m=e.findIndex(x=>x.id===f.id),v=e.findIndex(x=>x.id===p.id),g=oy(e,m,v).map((x,y)=>({...x,order:y}));t(g)}},c=async h=>{const f=Array.from(h.target.files||[]);if(!f.length)return;const p=r-e.length;if(f.length>p){H.error(`You can only upload ${p} more photo(s)`);return}i(!0);try{const{data:{user:m}}=await T.auth.getUser();if(!m){H.error("You must be logged in to upload photos");return}const v=f.map(async(y,b)=>{if(!y.type.startsWith("image/"))throw new Error(`${y.name} is not an image`);if(y.size>5*1024*1024)throw new Error(`${y.name} is larger than 5MB`);const N=y.name.split(".").pop(),j=`${m.id}/${n}/gallery-${Date.now()}-${b}.${N}`,{data:_,error:S}=await T.storage.from("profile-photos").upload(j,y,{contentType:y.type,upsert:!1});if(S)throw S;const{data:{publicUrl:C}}=T.storage.from("profile-photos").getPublicUrl(_.path);return C}),g=await Promise.all(v),x=g.map((y,b)=>({id:`${Date.now()}-${b}`,url:y,order:e.length+b}));t([...e,...x]),H.success(`${g.length} photo(s) uploaded successfully!`)}catch(m){console.error("Upload error:",m),H.error(m.message||"Failed to upload photos. Please try again.")}finally{i(!1),h.target.value=""}},u=h=>{const f=e.filter(p=>p.id!==h).map((p,m)=>({...p,order:m}));t(f),H.success("Photo removed")},d=e.length<r;return s.jsxs("div",{className:"space-y-4",children:[e.length>0&&s.jsx(II,{sensors:o,collisionDetection:TI,onDragEnd:l,children:s.jsx(MI,{items:e.map(h=>h.id),strategy:DI,children:s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:e.map(h=>s.jsx(HYe,{photo:h,onRemove:()=>u(h.id),galleryType:n},h.id))})})}),d&&s.jsx(q,{className:"border-2 border-dashed border-border hover:border-primary/50 transition-colors",children:s.jsx(ee,{className:"p-6",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:n==="public"?s.jsx(So,{className:"w-6 h-6 text-primary"}):s.jsx(Or,{className:"w-6 h-6 text-primary"})}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm font-medium text-foreground mb-1",children:n==="public"?"Public Gallery":"Members-Only Gallery"}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.length," of ",r," photos uploaded"]})]}),s.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:c,multiple:!0,className:"hidden",id:`gallery-${n}-input`,disabled:a}),s.jsx("label",{htmlFor:`gallery-${n}-input`,children:s.jsx(L,{type:"button",variant:"outline",size:"sm",className:"cursor-pointer",disabled:a,asChild:!0,children:s.jsxs("span",{children:[s.jsx(lj,{className:"w-4 h-4 mr-2"}),a?"Uploading...":"Add Photos"]})})}),s.jsx("p",{className:"text-xs text-muted-foreground text-center",children:n==="public"?"Visible to everyone who scans your QR code":"Only visible to verified members"})]})})}),e.length===0&&s.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Drag and drop to reorder photos after uploading"})]})},KYe=({form:e})=>{var n,a;const[t,r]=w.useState("idle");return w.useEffect(()=>{const i=e.getValues("username");if(!i||i.length<3){r("idle");return}r("checking");const o=setTimeout(()=>{const l=["admin","test","vairify"].includes(i.toLowerCase());r(l?"taken":"available")},500);return()=>clearTimeout(o)},[e.watch("username")]),s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Basic Information"}),s.jsx("p",{className:"text-muted-foreground",children:"Start with your username. Everything else on this page is optional."})]}),s.jsxs(q,{className:"border-2 border-primary/50",children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(fn,{className:"w-5 h-5 text-primary"}),s.jsxs(be,{className:"flex items-center gap-2",children:["Username",s.jsx("span",{className:"text-destructive text-xl",children:"*"})]})]}),s.jsx(Re,{children:"Your professional display name. This is how clients will find you. Cannot be changed later."})]}),s.jsx(ee,{children:s.jsx(pt,{control:e.control,name:"username",render:({field:i})=>s.jsxs(Bt,{children:[s.jsx(Nn,{children:s.jsxs("div",{className:"relative",children:[s.jsx(De,{...i,placeholder:"Enter username",className:"text-lg h-12 pr-10"}),s.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:[t==="checking"&&s.jsx("div",{className:"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin"}),t==="available"&&s.jsx($t,{className:"w-5 h-5 text-success"}),t==="taken"&&s.jsx(vn,{className:"w-5 h-5 text-destructive"})]})]})}),s.jsx(Fi,{children:"3-20 characters, letters, numbers, and underscores only"}),t==="taken"&&s.jsx("p",{className:"text-sm text-destructive",children:"Username is already taken"}),t==="available"&&s.jsx("p",{className:"text-sm text-success",children:"Username is available!"}),s.jsx(gs,{})]})})})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Na,{className:"w-5 h-5 text-primary"}),s.jsxs(be,{className:"flex items-center gap-2",children:["Profile Photo",s.jsx(xe,{variant:"secondary",className:"text-xs bg-primary/20",children:"Recommended"})]})]}),s.jsx(Re,{children:"Upload a clear, professional photo of yourself. This will be displayed on your profile."})]}),s.jsx(ee,{children:s.jsx(pt,{control:e.control,name:"avatarUrl",render:({field:i})=>s.jsxs(Bt,{children:[s.jsx(Nn,{children:s.jsx(yee,{currentPhotoUrl:i.value,onPhotoChange:i.onChange})}),s.jsx(Fi,{children:"Your photo helps clients recognize you and builds trust"})]})})})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(cae,{className:"w-5 h-5 text-primary"}),s.jsxs(be,{className:"flex items-center gap-2",children:["Gallery Photos",s.jsx(xe,{variant:"outline",className:"text-xs",children:"Optional"})]})]}),s.jsx(Re,{children:"Add up to 8 photos for each gallery. Public photos are shown to everyone, members-only photos require verification."})]}),s.jsx(ee,{children:s.jsxs(JI,{type:"single",collapsible:!0,className:"w-full",children:[s.jsxs(kc,{value:"public-gallery",children:[s.jsx(Ac,{className:"hover:no-underline",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(So,{className:"w-4 h-4 text-primary"}),s.jsx("span",{className:"font-semibold",children:"Public Gallery"}),s.jsxs(xe,{variant:"secondary",className:"ml-2",children:[((n=e.watch("publicGallery"))==null?void 0:n.length)||0,"/8"]})]})}),s.jsx(Pc,{className:"pt-4",children:s.jsx(pt,{control:e.control,name:"publicGallery",render:({field:i})=>s.jsxs(Bt,{children:[s.jsx(Nn,{children:s.jsx(XB,{photos:i.value||[],onPhotosChange:i.onChange,maxPhotos:8,galleryType:"public"})}),s.jsx(Fi,{children:"These photos are visible to anyone who scans your QR code"})]})})})]}),s.jsxs(kc,{value:"members-gallery",children:[s.jsx(Ac,{className:"hover:no-underline",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Or,{className:"w-4 h-4 text-primary"}),s.jsx("span",{className:"font-semibold",children:"Members-Only Gallery"}),s.jsxs(xe,{variant:"secondary",className:"ml-2",children:[((a=e.watch("membersGallery"))==null?void 0:a.length)||0,"/8"]})]})}),s.jsx(Pc,{className:"pt-4",children:s.jsx(pt,{control:e.control,name:"membersGallery",render:({field:i})=>s.jsxs(Bt,{children:[s.jsx(Nn,{children:s.jsx(XB,{photos:i.value||[],onPhotosChange:i.onChange,maxPhotos:8,galleryType:"members"})}),s.jsx(Fi,{children:"These photos are only visible to verified Vairify members"})]})})})]})]})})]}),s.jsx(q,{className:"opacity-60",children:s.jsxs(ge,{children:[s.jsx(be,{className:"text-muted-foreground",children:"About & Location (Coming Soon)"}),s.jsx(Re,{children:"Bio, service areas, and languages will be added in future updates"})]})})]})},YYe=[{id:"1hour",name:"1 Hour City Tour",duration:"60 minutes",price:200,description:"Standard city tour experience",icon:hn},{id:"1.5hour",name:"Extended Walking Tour",duration:"90 minutes",price:280,description:"Leisurely walking tour with extra time",icon:hn},{id:"cart",name:"Golf Cart Tour",duration:"60 minutes",price:250,description:"Comfortable tour via golf cart",icon:nz},{id:"2hour",name:"2 Hour Premium Tour",duration:"120 minutes",price:380,description:"Extended premium experience",icon:hn}],XYe=[{id:"dinner",name:"Dinner After Tour",duration:"+60 minutes",price:150,note:"Client covers meal expenses",icon:Sae},{id:"transport",name:"Taxi/Uber To & From Venue",price:40,note:"Round-trip transportation included",icon:nz},{id:"overnight",name:"Overnight Experience",duration:"8+ hours",price:800,note:"Available by special arrangement",icon:On}],QYe=({form:e})=>{const t=n=>{const a=e.getValues("servicesOffered"),i=a.includes(n)?a.filter(o=>o!==n):[...a,n];e.setValue("servicesOffered",i)},r=n=>{const a=e.getValues("addOns"),i=a.includes(n)?a.filter(o=>o!==n):[...a,n];e.setValue("addOns",i)};return s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Physical Attributes & Services"}),s.jsx("p",{className:"text-muted-foreground",children:"All fields are optional. Add what you're comfortable sharing."})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(oz,{className:"w-5 h-5 text-muted-foreground"}),s.jsxs(be,{className:"flex items-center gap-2",children:["Physical Attributes",s.jsx(xe,{variant:"outline",className:"text-xs",children:"Optional"})]})]}),s.jsx(Re,{children:"Help clients know what to expect. All fields optional."})]}),s.jsx(ee,{children:s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsx(pt,{control:e.control,name:"height",render:({field:n})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Height"}),s.jsxs(At,{onValueChange:n.onChange,defaultValue:n.value,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select height"})}),s.jsxs(St,{children:[s.jsx(re,{value:"4-10",children:`4'10" - 147cm`}),s.jsx(re,{value:"5-0",children:`5'0" - 152cm`}),s.jsx(re,{value:"5-2",children:`5'2" - 157cm`}),s.jsx(re,{value:"5-4",children:`5'4" - 162cm`}),s.jsx(re,{value:"5-6",children:`5'6" - 168cm`}),s.jsx(re,{value:"5-8",children:`5'8" - 173cm`}),s.jsx(re,{value:"5-10",children:`5'10" - 178cm`}),s.jsx(re,{value:"6-0",children:`6'0" - 183cm`}),s.jsx(re,{value:"6-2",children:`6'2" - 188cm`})]})]})]})}),s.jsx(pt,{control:e.control,name:"eyeColor",render:({field:n})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Eye Color"}),s.jsxs(At,{onValueChange:n.onChange,defaultValue:n.value,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select eye color"})}),s.jsxs(St,{children:[s.jsx(re,{value:"brown",children:"Brown"}),s.jsx(re,{value:"blue",children:"Blue"}),s.jsx(re,{value:"green",children:"Green"}),s.jsx(re,{value:"hazel",children:"Hazel"}),s.jsx(re,{value:"gray",children:"Gray"}),s.jsx(re,{value:"other",children:"Other"})]})]})]})}),s.jsx(pt,{control:e.control,name:"hairColor",render:({field:n})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Hair Color"}),s.jsxs(At,{onValueChange:n.onChange,defaultValue:n.value,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select hair color"})}),s.jsxs(St,{children:[s.jsx(re,{value:"blonde",children:"Blonde"}),s.jsx(re,{value:"brunette",children:"Brunette"}),s.jsx(re,{value:"black",children:"Black"}),s.jsx(re,{value:"red",children:"Red"}),s.jsx(re,{value:"auburn",children:"Auburn"}),s.jsx(re,{value:"gray",children:"Gray"}),s.jsx(re,{value:"other",children:"Other"})]})]})]})}),s.jsx(pt,{control:e.control,name:"hairLength",render:({field:n})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Hair Length"}),s.jsxs(At,{onValueChange:n.onChange,defaultValue:n.value,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select hair length"})}),s.jsxs(St,{children:[s.jsx(re,{value:"short",children:"Short"}),s.jsx(re,{value:"medium",children:"Medium"}),s.jsx(re,{value:"long",children:"Long"}),s.jsx(re,{value:"bald",children:"Bald"})]})]})]})}),s.jsx(pt,{control:e.control,name:"bodyType",render:({field:n})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Body Type"}),s.jsxs(At,{onValueChange:n.onChange,defaultValue:n.value,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select body type"})}),s.jsxs(St,{children:[s.jsx(re,{value:"slim",children:"Slim"}),s.jsx(re,{value:"athletic",children:"Athletic"}),s.jsx(re,{value:"average",children:"Average"}),s.jsx(re,{value:"curvy",children:"Curvy"}),s.jsx(re,{value:"plus-size",children:"Plus-size"}),s.jsx(re,{value:"muscular",children:"Muscular"})]})]})]})}),s.jsx(pt,{control:e.control,name:"ageRange",render:({field:n})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Age Range"}),s.jsxs(At,{onValueChange:n.onChange,defaultValue:n.value,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select age range"})}),s.jsxs(St,{children:[s.jsx(re,{value:"18-24",children:"18-24"}),s.jsx(re,{value:"25-34",children:"25-34"}),s.jsx(re,{value:"35-44",children:"35-44"}),s.jsx(re,{value:"45-54",children:"45-54"}),s.jsx(re,{value:"55+",children:"55+"})]})]})]})})]})})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(rz,{className:"w-5 h-5 text-primary"}),s.jsxs(be,{className:"flex items-center gap-2",children:["Services & Tours",s.jsx(xe,{variant:"secondary",className:"text-xs bg-primary/20",children:"Recommended"})]})]}),s.jsx(Re,{children:"Select the services you offer. Pricing is set by administrators."}),s.jsx("div",{className:"bg-primary/10 border border-primary/20 rounded-lg p-3 mt-2",children:s.jsxs("p",{className:"text-sm text-foreground flex items-start gap-2",children:[s.jsx("span",{className:"text-primary",children:""}),"Prices and service names are managed by Vairify administrators to ensure consistency."]})})]}),s.jsx(ee,{children:s.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:YYe.map(n=>{const a=n.icon,i=e.watch("servicesOffered").includes(n.id);return s.jsx(q,{className:me("cursor-pointer transition-all hover:shadow-lg hover:-translate-y-1",i&&"border-primary bg-primary/5"),onClick:()=>t(n.id),children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:me("w-5 h-5 border-2 rounded flex items-center justify-center shrink-0 mt-0.5",i?"bg-primary border-primary":"border-border"),children:i&&s.jsx($t,{className:"w-3 h-3 text-primary-foreground"})}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("div",{className:"flex items-start justify-between gap-2",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(a,{className:"w-4 h-4 text-primary"}),s.jsx("h4",{className:"font-semibold text-foreground",children:n.name})]})}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:["Duration: ",n.duration]}),s.jsxs("div",{className:"text-lg font-semibold text-primary",children:["$",n.price]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:n.description})]})]})})},n.id)})})})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ms,{className:"w-5 h-5 text-muted-foreground"}),s.jsxs(be,{className:"flex items-center gap-2",children:["Add-On Services",s.jsx(xe,{variant:"outline",className:"text-xs",children:"Optional"})]})]}),s.jsx(Re,{children:"Additional services you can offer with tours"})]}),s.jsx(ee,{children:s.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:XYe.map(n=>{const a=n.icon,i=e.watch("addOns").includes(n.id);return s.jsx(q,{className:me("cursor-pointer transition-all hover:shadow-lg hover:-translate-y-1",i&&"border-primary bg-primary/5"),onClick:()=>r(n.id),children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:me("w-5 h-5 border-2 rounded flex items-center justify-center shrink-0 mt-0.5",i?"bg-primary border-primary":"border-border"),children:i&&s.jsx($t,{className:"w-3 h-3 text-primary-foreground"})}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(a,{className:"w-4 h-4 text-primary"}),s.jsx("h4",{className:"font-semibold text-foreground",children:n.name})]}),n.duration&&s.jsx("div",{className:"text-sm text-muted-foreground",children:n.duration}),s.jsxs("div",{className:"text-lg font-semibold text-primary",children:["+$",n.price]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:n.note})]})]})})},n.id)})})})]})]})},ZYe=({form:e,completionPercentage:t})=>{var n,a,i,o,l,c;const r=e.getValues();return s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Settings & Review"}),s.jsx("p",{className:"text-muted-foreground",children:"Configure your availability and review your profile"})]}),s.jsxs(q,{className:"border-2 border-primary/50 bg-gradient-to-br from-primary/5 to-accent/5",children:[s.jsx(ge,{children:s.jsxs(be,{className:"flex items-center justify-between",children:[s.jsx("span",{children:"Profile Completion"}),s.jsxs(xe,{variant:"secondary",className:"text-lg px-4 py-2",children:[t,"%"]})]})}),s.jsxs(ee,{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[r.username?s.jsx($t,{className:"w-5 h-5 text-success"}):s.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-muted-foreground"}),s.jsx("span",{className:r.username?"text-foreground":"text-muted-foreground",children:"Username set"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[((n=r.servicesOffered)==null?void 0:n.length)>0?s.jsx($t,{className:"w-5 h-5 text-success"}):s.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-muted-foreground"}),s.jsxs("span",{className:((a=r.servicesOffered)==null?void 0:a.length)>0?"text-foreground":"text-muted-foreground",children:[((i=r.servicesOffered)==null?void 0:i.length)||0," services selected"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[r.height||r.hairColor||r.bodyType?s.jsx($t,{className:"w-5 h-5 text-success"}):s.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-muted-foreground"}),s.jsx("span",{className:r.height||r.hairColor||r.bodyType?"text-foreground":"text-muted-foreground",children:"Physical attributes added"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[((o=r.addOns)==null?void 0:o.length)>0?s.jsx($t,{className:"w-5 h-5 text-success"}):s.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-muted-foreground"}),s.jsxs("span",{className:((l=r.addOns)==null?void 0:l.length)>0?"text-foreground":"text-muted-foreground",children:[((c=r.addOns)==null?void 0:c.length)||0," add-ons selected"]})]})]})]}),s.jsxs(q,{children:[s.jsx(ge,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Yn,{className:"w-5 h-5 text-muted-foreground"}),s.jsxs(be,{className:"flex items-center gap-2",children:["Availability",s.jsx(xe,{variant:"outline",className:"text-xs",children:"Optional"})]})]})}),s.jsxs(ee,{className:"space-y-4",children:[s.jsx(pt,{control:e.control,name:"acceptingClients",render:({field:u})=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(de,{htmlFor:"acceptingClients",className:"text-base",children:"Currently Accepting New Clients"}),s.jsx(Yt,{id:"acceptingClients",checked:u.value,onCheckedChange:u.onChange})]})}),s.jsx(pt,{control:e.control,name:"outcalls",render:({field:u})=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(de,{htmlFor:"outcalls",className:"text-base",children:"Available for Outcalls"}),s.jsx(Yt,{id:"outcalls",checked:u.value,onCheckedChange:u.onChange})]})}),s.jsx(pt,{control:e.control,name:"incalls",render:({field:u})=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(de,{htmlFor:"incalls",className:"text-base",children:"Available for Incalls"}),s.jsx(Yt,{id:"incalls",checked:u.value,onCheckedChange:u.onChange})]})}),s.jsx(pt,{control:e.control,name:"tours",render:({field:u})=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(de,{htmlFor:"tours",className:"text-base",children:"Available for Tours"}),s.jsx(Yt,{id:"tours",checked:u.value,onCheckedChange:u.onChange})]})})]})]}),s.jsxs(q,{children:[s.jsx(ge,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(oj,{className:"w-5 h-5 text-muted-foreground"}),s.jsx(be,{children:"Profile Settings"})]})}),s.jsxs(ee,{className:"space-y-4",children:[s.jsx(pt,{control:e.control,name:"visibleInDirectory",render:({field:u})=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(de,{htmlFor:"visibleInDirectory",className:"text-base",children:"Make profile visible in directory"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Clients can find you in the provider directory"})]}),s.jsx(Yt,{id:"visibleInDirectory",checked:u.value,onCheckedChange:u.onChange})]})}),s.jsx(pt,{control:e.control,name:"allowDirectBooking",render:({field:u})=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(de,{htmlFor:"allowDirectBooking",className:"text-base",children:"Allow direct booking requests"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Clients can send you booking requests"})]}),s.jsx(Yt,{id:"allowDirectBooking",checked:u.value,onCheckedChange:u.onChange})]})}),s.jsx(pt,{control:e.control,name:"showOnlineStatus",render:({field:u})=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(de,{htmlFor:"showOnlineStatus",className:"text-base",children:"Show online status"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Display when you're active on the platform"})]}),s.jsx(Yt,{id:"showOnlineStatus",checked:u.value,onCheckedChange:u.onChange})]})})]})]}),s.jsx(q,{className:"bg-muted/50",children:s.jsx(ee,{className:"p-4",children:s.jsx("p",{className:"text-sm text-center text-muted-foreground",children:" You can edit all of these settings anytime from your profile page"})})})]})};function JYe({method:e,onRemove:t}){const{attributes:r,listeners:n,setNodeRef:a,transform:i,transition:o}=$I({id:e.id}),l={transform:Vd.Transform.toString(i),transition:o};return s.jsx(q,{ref:a,style:l,className:"mb-2",children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{...r,...n,className:"cursor-grab active:cursor-grabbing",children:s.jsx(dT,{className:"w-5 h-5 text-muted-foreground"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium",children:e.payment_app.app_name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Priority #",e.preference_order]})]}),s.jsx(L,{variant:"ghost",size:"sm",onClick:t,children:"Remove"})]})})})}function eXe(){const{toast:e}=Et(),[t,r]=w.useState([]),[n,a]=w.useState([]),[i,o]=w.useState(""),[l,c]=w.useState(null),[u,d]=w.useState(null),[h,f]=w.useState(""),[p,m]=w.useState(""),[v,g]=w.useState(!1),x=PI(kp(iy),kp(sy,{coordinateGetter:FI}));w.useEffect(()=>{y(),b()},[]);const y=async()=>{const{data:E}=await T.from("payment_apps").select("*").eq("is_active",!0).order("app_name");E&&r(E)},b=async()=>{const{data:{user:E}}=await T.auth.getUser();if(!E)return;const{data:k}=await T.from("user_payment_methods").select(`
        *,
        payment_app:payment_apps(*)
      `).eq("user_id",E.id).eq("is_active",!0).order("preference_order");k&&a(k)},N=E=>{var P;const k=(P=E.target.files)==null?void 0:P[0];if(k){c(k);const A=new FileReader;A.onloadend=()=>{d(A.result)},A.readAsDataURL(k)}},j=async()=>{if(!i){e({title:"Please select a payment app",variant:"destructive"});return}g(!0);try{const{data:{user:E}}=await T.auth.getUser();if(!E)throw new Error("Not authenticated");let k=null;if(l){const O=l.name.split(".").pop(),I=`${E.id}/${i}-${Date.now()}.${O}`,{error:R,data:M}=await T.storage.from("payment_qr_codes").upload(I,l);if(R)throw R;const{data:{publicUrl:B}}=T.storage.from("payment_qr_codes").getPublicUrl(I);k=B}const P=n.length+1,{error:A}=await T.from("user_payment_methods").insert({user_id:E.id,payment_app_id:i,preference_order:P,qr_code_image_url:k,username_handle:h||null,wallet_address:p||null});if(A)throw A;e({title:"Payment method added successfully"}),o(""),c(null),d(null),f(""),m(""),b()}catch(E){e({title:"Error adding payment method",description:E.message,variant:"destructive"})}finally{g(!1)}},_=async E=>{try{const{error:k}=await T.from("user_payment_methods").update({is_active:!1}).eq("id",E);if(k)throw k;e({title:"Payment method removed"}),b()}catch(k){e({title:"Error removing payment method",description:k.message,variant:"destructive"})}},S=async E=>{const{active:k,over:P}=E;if(!P||k.id===P.id)return;const A=n.findIndex(R=>R.id===k.id),O=n.findIndex(R=>R.id===P.id),I=oy(n,A,O);a(I);try{const R=I.map((M,B)=>({id:M.id,preference_order:B+1}));for(const M of R)await T.from("user_payment_methods").update({preference_order:M.preference_order}).eq("id",M.id);e({title:"Payment preferences updated"})}catch(R){e({title:"Error updating preferences",description:R.message,variant:"destructive"}),b()}},C=t.find(E=>E.id===i);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Payment Setup (Optional)"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Add your preferred payment methods so clients can easily send you payments. You can skip this step and set it up later."})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{className:"text-base",children:"Add Payment Method"}),s.jsx(Re,{children:"Select an app and provide your details"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{children:"Payment App"}),s.jsxs(At,{value:i,onValueChange:o,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select a payment app"})}),s.jsx(St,{children:t.map(E=>s.jsxs(re,{value:E.id,children:[E.app_name," (",E.app_category,")"]},E.id))})]}),C&&s.jsxs("div",{className:"flex gap-2 mt-2",children:[C.download_url_ios&&s.jsx(L,{variant:"outline",size:"sm",asChild:!0,children:s.jsxs("a",{href:C.download_url_ios,target:"_blank",rel:"noopener noreferrer",children:[s.jsx(ig,{className:"w-4 h-4 mr-2"}),"iOS"]})}),C.download_url_android&&s.jsx(L,{variant:"outline",size:"sm",asChild:!0,children:s.jsxs("a",{href:C.download_url_android,target:"_blank",rel:"noopener noreferrer",children:[s.jsx(ig,{className:"w-4 h-4 mr-2"}),"Android"]})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{children:"QR Code (Optional)"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(L,{type:"button",variant:"outline",onClick:()=>{var E;return(E=document.getElementById("qr-upload"))==null?void 0:E.click()},children:[s.jsx(lj,{className:"w-4 h-4 mr-2"}),"Upload QR Code"]}),s.jsx("input",{id:"qr-upload",type:"file",accept:"image/*",onChange:N,className:"hidden"}),u&&s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:u,alt:"QR Preview",className:"w-20 h-20 object-cover rounded"}),s.jsx(L,{size:"icon",variant:"destructive",className:"absolute -top-2 -right-2 h-6 w-6",onClick:()=>{c(null),d(null)},children:s.jsx(vn,{className:"w-4 h-4"})})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{children:"Username/Handle (Optional)"}),s.jsx(De,{value:h,onChange:E=>f(E.target.value),placeholder:"@username or handle"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{children:"Wallet Address (Optional)"}),s.jsx(De,{value:p,onChange:E=>m(E.target.value),placeholder:"Crypto wallet address"})]}),s.jsxs(L,{onClick:j,disabled:v||!i,className:"w-full",children:[s.jsx(Ms,{className:"w-4 h-4 mr-2"}),"Add Payment Method"]})]})]}),n.length>0&&s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{className:"text-base",children:"Your Payment Methods"}),s.jsx(Re,{children:"Drag to reorder by preference"})]}),s.jsx(ee,{children:s.jsx(II,{sensors:x,collisionDetection:TI,onDragEnd:S,children:s.jsx(MI,{items:n.map(E=>E.id),strategy:$Q,children:n.map(E=>s.jsx(JYe,{method:E,onRemove:()=>_(E.id)},E.id))})})})]})]})}const bee=()=>{const[e,t]=w.useState(null),[r,n]=w.useState(!0),[a,i]=w.useState(!1);w.useEffect(()=>{o()},[]);const o=async()=>{try{const{data:{user:u}}=await T.auth.getUser();if(!u){n(!1);return}const{data:d,error:h}=await T.from("provider_profiles").select("*").eq("user_id",u.id).maybeSingle();if(h)throw h;d&&t({...d,public_gallery:d.public_gallery||[],members_gallery:d.members_gallery||[],services_offered:d.services_offered||[],add_ons:d.add_ons||[],availability:d.availability||{acceptingClients:!0,outcalls:!1,incalls:!1,tours:!0},profile_settings:d.profile_settings||{visibleInDirectory:!0,allowDirectBooking:!0,showOnlineStatus:!1}})}catch(u){console.error("Error loading profile:",u),H.error("Failed to load profile")}finally{n(!1)}},l=async u=>{i(!0);try{const{data:{user:d}}=await T.auth.getUser();if(!d)return H.error("You must be logged in to save your profile"),!1;const h={user_id:d.id,username:u.username,avatar_url:u.avatar_url,public_gallery:JSON.parse(JSON.stringify(u.public_gallery||[])),members_gallery:JSON.parse(JSON.stringify(u.members_gallery||[])),height:u.height,weight:u.weight,hair_color:u.hair_color,hair_length:u.hair_length,eye_color:u.eye_color,body_type:u.body_type,ethnicity:u.ethnicity,age_range:u.age_range,services_offered:u.services_offered||[],add_ons:u.add_ons||[],availability:u.availability||{acceptingClients:!0,outcalls:!1,incalls:!1,tours:!0},profile_settings:u.profile_settings||{visibleInDirectory:!0,allowDirectBooking:!0,showOnlineStatus:!1},profile_completion_percentage:c(u)},{data:f,error:p}=await T.from("provider_profiles").upsert([h],{onConflict:"user_id"}).select().single();if(p)throw p;if(f){const m={...f,public_gallery:f.public_gallery||[],members_gallery:f.members_gallery||[],services_offered:f.services_offered||[],add_ons:f.add_ons||[],availability:f.availability||h.availability,profile_settings:f.profile_settings||h.profile_settings};t(m)}return H.success("Profile saved successfully!"),!0}catch(d){return console.error("Error saving profile:",d),d.code==="23505"?H.error("This username is already taken. Please choose another."):H.error("Failed to save profile. Please try again."),!1}finally{i(!1)}},c=u=>{let d=0;const h=20;return u.username&&d++,u.avatar_url&&(d+=2),u.public_gallery&&u.public_gallery.length>0&&(d+=2),u.members_gallery&&u.members_gallery.length>0&&(d+=2),u.height&&d++,u.weight&&d++,u.hair_color&&d++,u.hair_length&&d++,u.eye_color&&d++,u.body_type&&d++,u.ethnicity&&d++,u.age_range&&d++,u.services_offered&&u.services_offered.length>0&&(d+=3),u.add_ons&&u.add_ons.length>0&&(d+=2),d+=5,Math.round(d/h*100)};return{profile:e,loading:r,saving:a,saveProfile:l,reloadProfile:o}},tXe=wd({username:qt().min(3,"Username must be at least 3 characters").max(20,"Username must be less than 20 characters").regex(/^[a-zA-Z0-9_]+$/,"Username can only contain letters, numbers, and underscores"),avatarUrl:qt().optional(),publicGallery:ad(wd({id:qt(),url:qt(),order:QA()})).default([]),membersGallery:ad(wd({id:qt(),url:qt(),order:QA()})).default([]),height:qt().optional(),weight:qt().optional(),hairColor:qt().optional(),hairLength:qt().optional(),eyeColor:qt().optional(),bodyType:qt().optional(),ethnicity:qt().optional(),ageRange:qt().optional(),servicesOffered:ad(qt()).default([]),addOns:ad(qt()).default([]),acceptingClients:Hs().default(!0),outcalls:Hs().default(!1),incalls:Hs().default(!1),tours:Hs().default(!0),visibleInDirectory:Hs().default(!0),allowDirectBooking:Hs().default(!0),showOnlineStatus:Hs().default(!1)});function rXe(){const e=Oe(),{profile:t,loading:r,saving:n,saveProfile:a}=bee(),[i,o]=w.useState(1),[l,c]=w.useState(0),u=l4({resolver:c4(tXe),defaultValues:{username:"",avatarUrl:"",publicGallery:[],membersGallery:[],servicesOffered:[],addOns:[],acceptingClients:!0,outcalls:!1,incalls:!1,tours:!0,visibleInDirectory:!0,allowDirectBooking:!0,showOnlineStatus:!1}}),d=u.watch(),[h,f]=w.useState(null);w.useEffect(()=>{(async()=>{const{data:{user:N}}=await T.auth.getUser();if(!N)return;const{data:j}=await T.from("referral_codes").select("tier").eq("user_id",N.id).single();j!=null&&j.tier&&f(j.tier)})()},[]),w.useEffect(()=>{var b,N,j,_,S,C,E;t&&!r&&u.reset({username:t.username,avatarUrl:t.avatar_url||"",publicGallery:t.public_gallery||[],membersGallery:t.members_gallery||[],height:t.height||"",weight:t.weight||"",hairColor:t.hair_color||"",hairLength:t.hair_length||"",eyeColor:t.eye_color||"",bodyType:t.body_type||"",ethnicity:t.ethnicity||"",ageRange:t.age_range||"",servicesOffered:t.services_offered||[],addOns:t.add_ons||[],acceptingClients:((b=t.availability)==null?void 0:b.acceptingClients)??!0,outcalls:((N=t.availability)==null?void 0:N.outcalls)??!1,incalls:((j=t.availability)==null?void 0:j.incalls)??!1,tours:((_=t.availability)==null?void 0:_.tours)??!0,visibleInDirectory:((S=t.profile_settings)==null?void 0:S.visibleInDirectory)??!0,allowDirectBooking:((C=t.profile_settings)==null?void 0:C.allowDirectBooking)??!0,showOnlineStatus:((E=t.profile_settings)==null?void 0:E.showOnlineStatus)??!1})},[t,r,u]),w.useEffect(()=>{const b=setInterval(()=>{const N=u.getValues();localStorage.setItem("vairify_profile_draft",JSON.stringify(N))},3e4);return()=>clearInterval(b)},[u]),w.useEffect(()=>{const b=u.getValues();let N=0;const j=20;b.username&&N++,b.avatarUrl&&(N+=2),b.publicGallery.length>0&&(N+=2),b.membersGallery.length>0&&(N+=2),b.height&&N++,b.height&&N++,b.weight&&N++,b.hairColor&&N++,b.hairLength&&N++,b.eyeColor&&N++,b.bodyType&&N++,b.ethnicity&&N++,b.ageRange&&N++,b.servicesOffered.length>0&&(N+=3),b.addOns.length>0&&(N+=2),N+=5,c(Math.round(N/j*100))},[d,u]);const p=()=>{if(i===1){const b=u.getValues("username");return b&&b.length>=3&&b.length<=20}return!0},m=()=>{p()&&i<4&&(o(i+1),window.scrollTo(0,0))},v=()=>{i>1&&(o(i-1),window.scrollTo(0,0))},g=async b=>{if(!b.username||b.username.trim().length<3){H.error("Username is required and must be at least 3 characters"),o(1);return}const N={username:b.username.trim(),avatar_url:b.avatarUrl,public_gallery:b.publicGallery.map(_=>({id:_.id,url:_.url,order:_.order})),members_gallery:b.membersGallery.map(_=>({id:_.id,url:_.url,order:_.order})),height:b.height,weight:b.weight,hair_color:b.hairColor,hair_length:b.hairLength,eye_color:b.eyeColor,body_type:b.bodyType,ethnicity:b.ethnicity,age_range:b.ageRange,services_offered:b.servicesOffered,add_ons:b.addOns,availability:{acceptingClients:b.acceptingClients,outcalls:b.outcalls,incalls:b.incalls,tours:b.tours},profile_settings:{visibleInDirectory:b.visibleInDirectory,allowDirectBooking:b.allowDirectBooking,showOnlineStatus:b.showOnlineStatus}};await a(N)&&(localStorage.removeItem("vairify_profile_draft"),H.success("Profile created successfully!"),e("/pricing"))},x=()=>{const b=u.getValues();localStorage.setItem("vairify_profile_draft",JSON.stringify(b))},y=()=>{switch(i){case 1:return"Basic Info";case 2:return"Physical & Services";case 3:return"Payment Setup";case 4:return"Settings & Review";default:return""}};return r?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background to-background/95 flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading your profile..."})]})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background to-background/95 pb-32 md:pb-16",children:[s.jsx("div",{className:"sticky top-0 z-40 bg-card/95 backdrop-blur-sm border-b border-border",children:s.jsx("div",{className:"container mx-auto px-4 py-4",children:s.jsxs("div",{className:"max-w-3xl mx-auto space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("span",{className:"text-muted-foreground",children:["Step ",i," of 4: ",y()]}),s.jsxs("span",{className:"text-primary font-medium",children:[l,"% Complete"]})]}),s.jsx(aN,{value:i/4*100,className:"h-2"}),s.jsx("div",{className:"flex items-center justify-between",children:[1,2,3,4].map(b=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-medium transition-colors ${b===i?"bg-primary text-primary-foreground":b<i?"bg-success text-success-foreground":"bg-muted text-muted-foreground"}`,children:b<i?s.jsx($t,{className:"w-4 h-4"}):b}),s.jsx("span",{className:`text-sm hidden sm:inline ${b===i?"text-foreground font-medium":"text-muted-foreground"}`,children:b===1?"Basic":b===2?"Services":"Review"})]},b))})]})})}),s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsxs("div",{className:"text-center space-y-4 mb-8 animate-fade-in",children:[s.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-foreground",children:"Create Your Professional Profile"}),s.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Only username is requiredeverything else is optional and helps you get discovered."}),h&&s.jsx(e4,{tier:h,size:"lg"})]}),s.jsx(d4,{...u,children:s.jsxs("form",{onSubmit:u.handleSubmit(g),children:[i===1&&s.jsx(KYe,{form:u}),i===2&&s.jsx(QYe,{form:u}),i===3&&s.jsx(eXe,{}),i===4&&s.jsx(ZYe,{form:u,completionPercentage:l})]})})]})}),s.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-card/95 backdrop-blur-sm border-t border-border p-4 md:p-6",children:s.jsx("div",{className:"container mx-auto max-w-3xl",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-center justify-between",children:[s.jsx("div",{className:"w-full sm:w-auto",children:i>1?s.jsxs(L,{type:"button",variant:"outline",onClick:v,className:"w-full sm:w-auto",children:[s.jsx(Xd,{className:"w-4 h-4 mr-1"}),"Previous"]}):s.jsx("p",{className:"text-sm text-muted-foreground text-center sm:text-left",children:"Edit anytime in Settings"})}),s.jsxs("div",{className:"flex gap-3 w-full sm:w-auto",children:[s.jsx(L,{type:"button",variant:"outline",onClick:x,className:"flex-1 sm:flex-none",disabled:n,children:"Save Draft"}),i<4?s.jsxs(L,{type:"button",onClick:m,disabled:!p()||n,className:"flex-1 sm:flex-none min-w-[150px]",children:[i===3?"Skip & Continue":"Next Step",s.jsx(Wp,{className:"w-4 h-4 ml-1"})]}):s.jsx(L,{type:"submit",onClick:u.handleSubmit(g),className:"flex-1 sm:flex-none min-w-[200px]",disabled:!u.getValues("username")||n,children:n?"Saving...":"Complete Profile"})]})]})})})]})}const nXe=[{code:"en",name:"English",flag:""},{code:"es",name:"Spanish",flag:""},{code:"fr",name:"French",flag:""},{code:"de",name:"German",flag:""},{code:"it",name:"Italian",flag:""},{code:"pt",name:"Portuguese",flag:""},{code:"zh",name:"Mandarin",flag:""},{code:"ja",name:"Japanese",flag:""},{code:"ko",name:"Korean",flag:""},{code:"ar",name:"Arabic",flag:""},{code:"ru",name:"Russian",flag:""},{code:"hi",name:"Hindi",flag:""}],aXe=({form:e})=>{const t=e.watch("languages")||[],r=n=>{const a=t,i=a.includes(n)?a.filter(o=>o!==n):[...a,n];e.setValue("languages",i)};return s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Select Your Languages"}),s.jsx("p",{className:"text-muted-foreground",children:"Choose the languages you speak. This helps clients find providers who speak their language."})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(So,{className:"w-5 h-5 text-primary"}),s.jsxs(be,{className:"flex items-center gap-2",children:["Languages",s.jsx(xe,{variant:"outline",className:"text-xs",children:"Optional"})]})]}),s.jsx(Re,{children:"Select all languages you're comfortable speaking with clients. You can add more later."})]}),s.jsx(ee,{children:s.jsx(pt,{control:e.control,name:"languages",render:()=>s.jsxs(Bt,{children:[s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:nXe.map(n=>{const a=t.includes(n.code);return s.jsx(q,{className:me("cursor-pointer transition-all hover:shadow-lg hover:-translate-y-1",a&&"border-primary bg-primary/5"),onClick:()=>r(n.code),children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:me("w-5 h-5 border-2 rounded flex items-center justify-center shrink-0",a?"bg-primary border-primary":"border-border"),children:a&&s.jsx($t,{className:"w-3 h-3 text-primary-foreground"})}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:n.flag}),s.jsx("span",{className:"font-semibold text-foreground",children:n.name})]})})]})})},n.code)})}),s.jsxs(Fi,{className:"mt-4",children:["Selected languages: ",t.length>0?t.join(", "):"None"]})]})})})]}),t.length>0&&s.jsx(q,{className:"bg-primary/5 border-primary/20",children:s.jsx(ee,{className:"p-4",children:s.jsxs("p",{className:"text-sm text-foreground",children:[" You've selected ",t.length," language",t.length!==1?"s":"",". This information will be visible on your profile."]})})})]})},sXe=({form:e,userRole:t})=>{const[r,n]=w.useState("idle");return w.useEffect(()=>{const a=e.getValues("username");if(!a||a.length<3){n("idle");return}n("checking");const i=setTimeout(async()=>{try{const{data:o,error:l}=await T.from("provider_profiles").select("username").eq("username",a.toLowerCase()).maybeSingle();if(l)throw l;const{data:{user:c}}=await T.auth.getUser();o&&o.username!==(c==null?void 0:c.id)?n("taken"):n("available")}catch(o){console.error("Error checking username:",o),n("idle")}},500);return()=>clearTimeout(i)},[e.watch("username")]),s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Personal Information"}),s.jsx("p",{className:"text-muted-foreground",children:t==="provider"?"Start with your username. Everything else is optional.":"Add your personal information. Everything is optional."})]}),t==="provider"&&s.jsxs(q,{className:"border-2 border-primary/50",children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(fn,{className:"w-5 h-5 text-primary"}),s.jsxs(be,{className:"flex items-center gap-2",children:["Username",s.jsx("span",{className:"text-destructive text-xl",children:"*"})]})]}),s.jsx(Re,{children:"Your professional display name. This is how clients will find you. Cannot be changed later."})]}),s.jsx(ee,{children:s.jsx(pt,{control:e.control,name:"username",render:({field:a})=>s.jsxs(Bt,{children:[s.jsx(Nn,{children:s.jsxs("div",{className:"relative",children:[s.jsx(De,{...a,placeholder:"Enter username",className:"text-lg h-12 pr-10",onChange:i=>{a.onChange(i.target.value.toLowerCase())}}),s.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:[r==="checking"&&s.jsx("div",{className:"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin"}),r==="available"&&s.jsx($t,{className:"w-5 h-5 text-success"}),r==="taken"&&s.jsx(vn,{className:"w-5 h-5 text-destructive"})]})]})}),s.jsx(Fi,{children:"3-20 characters, letters, numbers, and underscores only"}),r==="taken"&&s.jsx("p",{className:"text-sm text-destructive",children:"Username is already taken"}),r==="available"&&s.jsx("p",{className:"text-sm text-success",children:"Username is available!"}),s.jsx(gs,{})]})})})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center gap-2",children:["Bio",s.jsx(xe,{variant:"outline",className:"text-xs",children:"Optional"})]}),s.jsx(Re,{children:"Tell clients about yourself. Keep it professional and concise."})]}),s.jsx(ee,{children:s.jsx(pt,{control:e.control,name:"bio",render:({field:a})=>{var i;return s.jsxs(Bt,{children:[s.jsx(Nn,{children:s.jsx(Mn,{...a,placeholder:"Write a brief bio about yourself...",className:"min-h-[120px] resize-none",maxLength:500})}),s.jsxs(Fi,{children:[((i=a.value)==null?void 0:i.length)||0," / 500 characters"]}),s.jsx(gs,{})]})}})})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Na,{className:"w-5 h-5 text-primary"}),s.jsxs(be,{className:"flex items-center gap-2",children:["Profile Photo",s.jsx(xe,{variant:"secondary",className:"text-xs bg-primary/20",children:"Recommended"})]})]}),s.jsx(Re,{children:"Upload a clear, professional photo of yourself. This will be displayed on your profile."})]}),s.jsx(ee,{children:s.jsx(pt,{control:e.control,name:"avatarUrl",render:({field:a})=>s.jsxs(Bt,{children:[s.jsx(Nn,{children:s.jsx(yee,{currentPhotoUrl:a.value,onPhotoChange:a.onChange})}),s.jsx(Fi,{children:"Your photo helps clients recognize you and builds trust"})]})})})]})]})},iXe=({form:e})=>s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Physical Appearance"}),s.jsx("p",{className:"text-muted-foreground",children:"All fields are optional. Add what you're comfortable sharing."})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(oz,{className:"w-5 h-5 text-muted-foreground"}),s.jsxs(be,{className:"flex items-center gap-2",children:["Physical Attributes",s.jsx(xe,{variant:"outline",className:"text-xs",children:"Optional"})]})]}),s.jsx(Re,{children:"Help clients know what to expect. All fields optional."})]}),s.jsx(ee,{children:s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsx(pt,{control:e.control,name:"height",render:({field:t})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Height"}),s.jsxs(At,{onValueChange:t.onChange,defaultValue:t.value,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select height"})}),s.jsxs(St,{children:[s.jsx(re,{value:"4-10",children:`4'10" - 147cm`}),s.jsx(re,{value:"5-0",children:`5'0" - 152cm`}),s.jsx(re,{value:"5-2",children:`5'2" - 157cm`}),s.jsx(re,{value:"5-4",children:`5'4" - 162cm`}),s.jsx(re,{value:"5-6",children:`5'6" - 168cm`}),s.jsx(re,{value:"5-8",children:`5'8" - 173cm`}),s.jsx(re,{value:"5-10",children:`5'10" - 178cm`}),s.jsx(re,{value:"6-0",children:`6'0" - 183cm`}),s.jsx(re,{value:"6-2",children:`6'2" - 188cm`}),s.jsx(re,{value:"6-4",children:`6'4" - 193cm`})]})]})]})}),s.jsx(pt,{control:e.control,name:"weight",render:({field:t})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Weight"}),s.jsxs(At,{onValueChange:t.onChange,defaultValue:t.value,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select weight range"})}),s.jsxs(St,{children:[s.jsx(re,{value:"under-100",children:"Under 100 lbs"}),s.jsx(re,{value:"100-120",children:"100-120 lbs"}),s.jsx(re,{value:"120-140",children:"120-140 lbs"}),s.jsx(re,{value:"140-160",children:"140-160 lbs"}),s.jsx(re,{value:"160-180",children:"160-180 lbs"}),s.jsx(re,{value:"180-200",children:"180-200 lbs"}),s.jsx(re,{value:"200-220",children:"200-220 lbs"}),s.jsx(re,{value:"220-240",children:"220-240 lbs"}),s.jsx(re,{value:"over-240",children:"Over 240 lbs"})]})]})]})}),s.jsx(pt,{control:e.control,name:"eyeColor",render:({field:t})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Eye Color"}),s.jsxs(At,{onValueChange:t.onChange,defaultValue:t.value,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select eye color"})}),s.jsxs(St,{children:[s.jsx(re,{value:"brown",children:"Brown"}),s.jsx(re,{value:"blue",children:"Blue"}),s.jsx(re,{value:"green",children:"Green"}),s.jsx(re,{value:"hazel",children:"Hazel"}),s.jsx(re,{value:"gray",children:"Gray"}),s.jsx(re,{value:"amber",children:"Amber"}),s.jsx(re,{value:"other",children:"Other"})]})]})]})}),s.jsx(pt,{control:e.control,name:"hairColor",render:({field:t})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Hair Color"}),s.jsxs(At,{onValueChange:t.onChange,defaultValue:t.value,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select hair color"})}),s.jsxs(St,{children:[s.jsx(re,{value:"blonde",children:"Blonde"}),s.jsx(re,{value:"brunette",children:"Brunette"}),s.jsx(re,{value:"black",children:"Black"}),s.jsx(re,{value:"red",children:"Red"}),s.jsx(re,{value:"auburn",children:"Auburn"}),s.jsx(re,{value:"gray",children:"Gray"}),s.jsx(re,{value:"white",children:"White"}),s.jsx(re,{value:"other",children:"Other"})]})]})]})}),s.jsx(pt,{control:e.control,name:"hairLength",render:({field:t})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Hair Length"}),s.jsxs(At,{onValueChange:t.onChange,defaultValue:t.value,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select hair length"})}),s.jsxs(St,{children:[s.jsx(re,{value:"bald",children:"Bald"}),s.jsx(re,{value:"short",children:"Short"}),s.jsx(re,{value:"medium",children:"Medium"}),s.jsx(re,{value:"long",children:"Long"}),s.jsx(re,{value:"very-long",children:"Very Long"})]})]})]})}),s.jsx(pt,{control:e.control,name:"bodyType",render:({field:t})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Body Type"}),s.jsxs(At,{onValueChange:t.onChange,defaultValue:t.value,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select body type"})}),s.jsxs(St,{children:[s.jsx(re,{value:"slim",children:"Slim"}),s.jsx(re,{value:"athletic",children:"Athletic"}),s.jsx(re,{value:"average",children:"Average"}),s.jsx(re,{value:"curvy",children:"Curvy"}),s.jsx(re,{value:"plus-size",children:"Plus-size"}),s.jsx(re,{value:"muscular",children:"Muscular"})]})]})]})}),s.jsx(pt,{control:e.control,name:"ethnicity",render:({field:t})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Ethnicity"}),s.jsxs(At,{onValueChange:t.onChange,defaultValue:t.value,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select ethnicity"})}),s.jsxs(St,{children:[s.jsx(re,{value:"asian",children:"Asian"}),s.jsx(re,{value:"black",children:"Black/African American"}),s.jsx(re,{value:"hispanic",children:"Hispanic/Latino"}),s.jsx(re,{value:"middle-eastern",children:"Middle Eastern"}),s.jsx(re,{value:"native-american",children:"Native American"}),s.jsx(re,{value:"pacific-islander",children:"Pacific Islander"}),s.jsx(re,{value:"white",children:"White/Caucasian"}),s.jsx(re,{value:"mixed",children:"Mixed"}),s.jsx(re,{value:"other",children:"Other"}),s.jsx(re,{value:"prefer-not-to-say",children:"Prefer not to say"})]})]})]})}),s.jsx(pt,{control:e.control,name:"ageRange",render:({field:t})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Age Range"}),s.jsxs(At,{onValueChange:t.onChange,defaultValue:t.value,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select age range"})}),s.jsxs(St,{children:[s.jsx(re,{value:"18-24",children:"18-24"}),s.jsx(re,{value:"25-34",children:"25-34"}),s.jsx(re,{value:"35-44",children:"35-44"}),s.jsx(re,{value:"45-54",children:"45-54"}),s.jsx(re,{value:"55-64",children:"55-64"}),s.jsx(re,{value:"65+",children:"65+"})]})]})]})})]})})]})]}),oXe=({form:e})=>{const[t,r]=w.useState([]),[n,a]=w.useState(!0),[i,o]=w.useState({}),l=e.watch("selectedServices")||[];w.useEffect(()=>{c()},[]);const c=async()=>{try{a(!0);const{data:d,error:h}=await T.from("service_categories").select("*").eq("is_active",!0).is("parent_category_id",null).order("display_order",{ascending:!0});if(h)throw h;const f=await Promise.all((d||[]).map(async m=>{const{data:v}=await T.from("service_categories").select("*").eq("is_active",!0).eq("parent_category_id",m.id).order("display_order",{ascending:!0}),g=[m.id,...(v==null?void 0:v.map(b=>b.id))||[]],{data:x}=await T.from("service_options").select("*").eq("is_active",!0).in("category_id",g).order("display_order",{ascending:!0}),y=(v||[]).map(b=>({...b,service_options:(x==null?void 0:x.filter(N=>N.category_id===b.id))||[]}));return{...m,service_options:(x==null?void 0:x.filter(b=>b.category_id===m.id))||[],subcategories:y}}));r(f);const p={};f.forEach(m=>{var v;(m.service_options.length>0||((v=m.subcategories)==null?void 0:v.length)>0)&&(p[m.id]=!0)}),o(p)}catch(d){console.error("Error loading service categories:",d)}finally{a(!1)}},u=d=>{const h=l,f=h.includes(d)?h.filter(p=>p!==d):[...h,d];e.setValue("selectedServices",f)};return n?s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Services"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading service categories..."})]}),s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Er,{className:"w-8 h-8 text-primary animate-spin"})})]}):s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Select Your Services"}),s.jsx("p",{className:"text-muted-foreground",children:"Choose the services you offer. You'll set pricing in the next step."})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(rz,{className:"w-5 h-5 text-primary"}),s.jsxs(be,{className:"flex items-center gap-2",children:["Services & Offerings",s.jsx(xe,{variant:"outline",className:"text-xs",children:"Optional"})]})]}),s.jsx(Re,{children:"Select all services you're comfortable providing. Services are organized by category."})]}),s.jsxs(ee,{children:[t.length===0?s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No service categories available. Please contact support."}):s.jsx(JI,{type:"multiple",value:Object.keys(i).filter(d=>i[d]),onValueChange:d=>{const h={};d.forEach(f=>{h[f]=!0}),o(h)},className:"w-full",children:t.map(d=>{var h,f;return s.jsxs(kc,{value:d.id,className:"border-b",children:[s.jsx(Ac,{className:"hover:no-underline py-4",children:s.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[d.icon&&s.jsx("span",{className:"text-2xl",children:d.icon}),s.jsxs("div",{className:"flex-1 text-left",children:[s.jsx("div",{className:"font-semibold text-foreground",children:d.display_name}),d.description&&s.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:d.description})]}),s.jsxs(xe,{variant:"secondary",className:"mr-2",children:[d.service_options.length+(((h=d.subcategories)==null?void 0:h.reduce((p,m)=>p+m.service_options.length,0))||0)," services"]})]})}),s.jsx(Pc,{className:"pb-4",children:s.jsxs("div",{className:"space-y-4 pt-2",children:[d.service_options.length>0&&s.jsx("div",{className:"space-y-2",children:d.service_options.map(p=>{const m=l.includes(p.id);return s.jsx(q,{className:me("cursor-pointer transition-all hover:shadow-md",m&&"border-primary bg-primary/5"),onClick:()=>u(p.id),children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:me("w-5 h-5 border-2 rounded flex items-center justify-center shrink-0 mt-0.5",m?"bg-primary border-primary":"border-border"),children:m&&s.jsx($t,{className:"w-3 h-3 text-primary-foreground"})}),s.jsxs("div",{className:"flex-1 space-y-1",children:[s.jsx("h4",{className:"font-semibold text-foreground",children:p.display_name}),p.description&&s.jsx("p",{className:"text-sm text-muted-foreground",children:p.description}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[p.duration_minutes&&s.jsxs("span",{children:["Duration: ",p.duration_minutes," min"]}),s.jsxs("span",{className:"font-semibold text-primary",children:["Base: $",p.base_price]})]})]})]})})},p.id)})}),(f=d.subcategories)==null?void 0:f.map(p=>s.jsxs("div",{className:"space-y-2",children:[s.jsx("h5",{className:"font-medium text-foreground text-sm ml-7",children:p.display_name}),p.service_options.map(m=>{const v=l.includes(m.id);return s.jsx(q,{className:me("cursor-pointer transition-all hover:shadow-md ml-7",v&&"border-primary bg-primary/5"),onClick:()=>u(m.id),children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:me("w-5 h-5 border-2 rounded flex items-center justify-center shrink-0 mt-0.5",v?"bg-primary border-primary":"border-border"),children:v&&s.jsx($t,{className:"w-3 h-3 text-primary-foreground"})}),s.jsxs("div",{className:"flex-1 space-y-1",children:[s.jsx("h4",{className:"font-semibold text-foreground",children:m.display_name}),m.description&&s.jsx("p",{className:"text-sm text-muted-foreground",children:m.description}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[m.duration_minutes&&s.jsxs("span",{children:["Duration: ",m.duration_minutes," min"]}),s.jsxs("span",{className:"font-semibold text-primary",children:["Base: $",m.base_price]})]})]})]})})},m.id)})]},p.id))]})})]},d.id)})}),l.length>0&&s.jsx("div",{className:"mt-6 p-4 bg-primary/5 border border-primary/20 rounded-lg",children:s.jsxs("p",{className:"text-sm text-foreground",children:[" You've selected ",l.length," service",l.length!==1?"s":"",". Configure pricing in the next step."]})})]})]})]})},wee=w.forwardRef(({className:e,...t},r)=>s.jsx("div",{className:"relative w-full overflow-auto",children:s.jsx("table",{ref:r,className:me("w-full caption-bottom text-sm",e),...t})}));wee.displayName="Table";const jee=w.forwardRef(({className:e,...t},r)=>s.jsx("thead",{ref:r,className:me("[&_tr]:border-b",e),...t}));jee.displayName="TableHeader";const Nee=w.forwardRef(({className:e,...t},r)=>s.jsx("tbody",{ref:r,className:me("[&_tr:last-child]:border-0",e),...t}));Nee.displayName="TableBody";const lXe=w.forwardRef(({className:e,...t},r)=>s.jsx("tfoot",{ref:r,className:me("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));lXe.displayName="TableFooter";const iP=w.forwardRef(({className:e,...t},r)=>s.jsx("tr",{ref:r,className:me("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",e),...t}));iP.displayName="TableRow";const Uh=w.forwardRef(({className:e,...t},r)=>s.jsx("th",{ref:r,className:me("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));Uh.displayName="TableHead";const Vh=w.forwardRef(({className:e,...t},r)=>s.jsx("td",{ref:r,className:me("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Vh.displayName="TableCell";const cXe=w.forwardRef(({className:e,...t},r)=>s.jsx("caption",{ref:r,className:me("mt-4 text-sm text-muted-foreground",e),...t}));cXe.displayName="TableCaption";const uXe=({form:e})=>{const[t,r]=w.useState([]),[n,a]=w.useState(!0),i=e.watch("selectedServices")||[],o=e.watch("servicePricing")||{};w.useEffect(()=>{i.length>0?l():a(!1)},[i]);const l=async()=>{try{a(!0);const{data:h,error:f}=await T.from("service_options").select("*").in("id",i).eq("is_active",!0);if(f)throw console.error("Error fetching service options:",f),f;if(!h||h.length===0){r([]),a(!1);return}const p=[...new Set(h.map(b=>b.category_id))],{data:m,error:v}=await T.from("service_categories").select("id, display_name, icon").in("id",p);v&&console.error("Error fetching categories:",v);const g=h.map(b=>({...b,category:m==null?void 0:m.find(N=>N.id===b.category_id)})),y={...e.getValues("servicePricing")||{}};g.forEach(b=>{y[b.id]||(y[b.id]={priceType:"included",customPrice:void 0})}),e.setValue("servicePricing",y),r(g||[])}catch(h){console.error("Error loading service details:",h)}finally{a(!1)}},c=(h,f)=>{const p=e.getValues("servicePricing")||{};e.setValue("servicePricing",{...p,[h]:{...p[h],priceType:f}})},u=(h,f)=>{const p=e.getValues("servicePricing")||{},m=f?parseFloat(f):void 0;e.setValue("servicePricing",{...p,[h]:{...p[h],customPrice:m}})},d=h=>{const f=o[h.id];return(f==null?void 0:f.customPrice)??h.base_price};return n?s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Service Pricing"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading service details..."})]}),s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Er,{className:"w-8 h-8 text-primary animate-spin"})})]}):i.length===0?s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Service Pricing"}),s.jsx("p",{className:"text-muted-foreground",children:"No services selected. Go back to select services."})]}),s.jsx(q,{children:s.jsx(ee,{className:"py-12 text-center text-muted-foreground",children:"Please select at least one service in the previous step to configure pricing."})})]}):s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Service Pricing"}),s.jsx("p",{className:"text-muted-foreground",children:'Set pricing for your selected services. Mark services as "Included" (in base price) or "Extra" (additional charge).'})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Wi,{className:"w-5 h-5 text-primary"}),s.jsxs(be,{className:"flex items-center gap-2",children:["Pricing Configuration",s.jsx(xe,{variant:"outline",className:"text-xs",children:"Optional"})]})]}),s.jsx(Re,{children:"Configure how each service is priced. Included services are part of the base price, Extra services are additional charges."})]}),s.jsx(ee,{children:s.jsx(pt,{control:e.control,name:"servicePricing",render:()=>s.jsxs(Bt,{children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs(wee,{children:[s.jsx(jee,{children:s.jsxs(iP,{children:[s.jsx(Uh,{className:"w-[200px]",children:"Service"}),s.jsx(Uh,{className:"w-[120px]",children:"Base Price"}),s.jsx(Uh,{className:"w-[150px]",children:"Price Type"}),s.jsx(Uh,{className:"w-[150px]",children:"Custom Price"}),s.jsx(Uh,{children:"Description"})]})}),s.jsx(Nee,{children:t.map(h=>{var m,v;const f=o[h.id]||{priceType:"included"};d(h);const p=f.priceType==="included";return s.jsxs(iP,{className:"hover:bg-muted/50",children:[s.jsx(Vh,{className:"font-medium",children:s.jsxs("div",{className:"flex items-center gap-2",children:[((m=h.category)==null?void 0:m.icon)&&s.jsx("span",{className:"text-xl",children:h.category.icon}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold text-foreground",children:h.display_name}),h.category&&s.jsx("div",{className:"text-xs text-muted-foreground mt-0.5",children:h.category.display_name})]})]})}),s.jsxs(Vh,{children:[s.jsxs("span",{className:"font-semibold text-primary",children:["$",h.base_price]}),h.duration_minutes&&s.jsxs("div",{className:"text-xs text-muted-foreground mt-0.5",children:[h.duration_minutes," min"]})]}),s.jsx(Vh,{children:s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx(de,{htmlFor:`type-${h.id}`,className:"text-xs text-muted-foreground",children:p?"Included":"Extra"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:me("text-sm font-medium",p?"text-foreground":"text-muted-foreground"),children:"Included"}),s.jsx(Yt,{id:`type-${h.id}`,checked:!p,onCheckedChange:g=>{c(h.id,g?"extra":"included")},className:"data-[state=checked]:bg-primary"}),s.jsx("span",{className:me("text-sm font-medium",p?"text-muted-foreground":"text-foreground"),children:"Extra"})]})]})})}),s.jsx(Vh,{children:s.jsxs("div",{className:"space-y-1",children:[s.jsx(De,{type:"number",placeholder:h.base_price.toString(),value:((v=f.customPrice)==null?void 0:v.toString())||"",onChange:g=>u(h.id,g.target.value),className:"w-full h-9",min:"0",step:"0.01"}),f.customPrice&&f.customPrice!==h.base_price&&s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Override: $",f.customPrice]})]})}),s.jsx(Vh,{children:h.description&&s.jsx("p",{className:"text-sm text-muted-foreground max-w-md",children:h.description})})]},h.id)})})]})}),t.length>0&&s.jsxs("div",{className:"mt-6 space-y-4",children:[s.jsxs("div",{className:"grid md:grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-foreground mb-2",children:"Included Services"}),s.jsxs("ul",{className:"space-y-1 text-sm text-muted-foreground",children:[t.filter(h=>{var f;return((f=o[h.id])==null?void 0:f.priceType)==="included"}).map(h=>s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx($t,{className:"w-4 h-4 text-success"}),s.jsxs("span",{children:[h.display_name," - $",d(h)]})]},h.id)),t.filter(h=>{var f;return((f=o[h.id])==null?void 0:f.priceType)==="included"}).length===0&&s.jsx("li",{className:"text-muted-foreground italic",children:"None"})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-foreground mb-2",children:"Extra Services"}),s.jsxs("ul",{className:"space-y-1 text-sm text-muted-foreground",children:[t.filter(h=>{var f;return((f=o[h.id])==null?void 0:f.priceType)==="extra"}).map(h=>s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx(Wi,{className:"w-4 h-4 text-primary"}),s.jsxs("span",{children:[h.display_name," - $",d(h)]})]},h.id)),t.filter(h=>{var f;return((f=o[h.id])==null?void 0:f.priceType)==="extra"}).length===0&&s.jsx("li",{className:"text-muted-foreground italic",children:"None"})]})]})]}),s.jsx("div",{className:"p-4 bg-primary/5 border border-primary/20 rounded-lg",children:s.jsxs("p",{className:"text-sm text-foreground",children:[s.jsx("strong",{children:"Note:"})," Included services are part of your base pricing package. Extra services are optional add-ons that clients can purchase separately."]})})]})]})})})]})]})},dXe=({form:e})=>s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Profile Settings"}),s.jsx("p",{className:"text-muted-foreground",children:"Configure your profile visibility and preferences. All fields are optional."})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center gap-2",children:["Bio",s.jsx(xe,{variant:"outline",className:"text-xs",children:"Optional"})]}),s.jsx(Re,{children:"Tell others about yourself. Keep it professional and concise."})]}),s.jsx(ee,{children:s.jsx(pt,{control:e.control,name:"bio",render:({field:t})=>{var r;return s.jsxs(Bt,{children:[s.jsx(Mn,{...t,placeholder:"Write a brief bio about yourself...",className:"min-h-[120px] resize-none",maxLength:500}),s.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[((r=t.value)==null?void 0:r.length)||0," / 500 characters"]})]})}})})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center gap-2",children:["Profile Links",s.jsx(xe,{variant:"outline",className:"text-xs",children:"Optional"})]}),s.jsx(Re,{children:"Add links to your social media or website"})]}),s.jsx(ee,{children:s.jsx("div",{className:"space-y-3",children:s.jsx(pt,{control:e.control,name:"profileLinks",render:()=>s.jsx(Bt,{children:s.jsx("p",{className:"text-sm text-muted-foreground",children:"Profile links management will be added in Settings page after profile creation."})})})})})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(lt,{className:"w-5 h-5 text-primary"}),s.jsx(be,{children:"Privacy Settings"})]}),s.jsx(Re,{children:"Control who can see your profile information"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsx(pt,{control:e.control,name:"profileVisible",render:({field:t})=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(de,{htmlFor:"profileVisible",className:"text-base",children:"Make profile visible to others"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow other users to find and view your profile"})]}),s.jsx(Yt,{id:"profileVisible",checked:t.value??!0,onCheckedChange:t.onChange})]})}),s.jsx(pt,{control:e.control,name:"showOnlineStatus",render:({field:t})=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(de,{htmlFor:"showOnlineStatus",className:"text-base",children:"Show online status"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Display when you're active on the platform"})]}),s.jsx(Yt,{id:"showOnlineStatus",checked:t.value??!1,onCheckedChange:t.onChange})]})}),s.jsx(pt,{control:e.control,name:"allowMessages",render:({field:t})=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(de,{htmlFor:"allowMessages",className:"text-base",children:"Allow direct messages"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Let other users send you messages"})]}),s.jsx(Yt,{id:"allowMessages",checked:t.value??!0,onCheckedChange:t.onChange})]})})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(tz,{className:"w-5 h-5 text-muted-foreground"}),s.jsx(be,{children:"Notification Preferences"})]}),s.jsx(Re,{children:"Choose how you want to be notified"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsx(pt,{control:e.control,name:"emailNotifications",render:({field:t})=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(de,{htmlFor:"emailNotifications",className:"text-base",children:"Email notifications"}),s.jsx(Yt,{id:"emailNotifications",checked:t.value??!0,onCheckedChange:t.onChange})]})}),s.jsx(pt,{control:e.control,name:"pushNotifications",render:({field:t})=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(de,{htmlFor:"pushNotifications",className:"text-base",children:"Push notifications"}),s.jsx(Yt,{id:"pushNotifications",checked:t.value??!0,onCheckedChange:t.onChange})]})})]})]}),s.jsx(q,{className:"bg-primary/5 border-primary/20",children:s.jsx(ee,{className:"p-4",children:s.jsx("p",{className:"text-sm text-center text-foreground",children:" You can edit all of these settings anytime from your Settings page"})})})]}),hXe=wd({languages:ad(qt()).default([]),username:qt().min(3,"Username must be at least 3 characters").max(20,"Username must be less than 20 characters").regex(/^[a-zA-Z0-9_]+$/,"Username can only contain letters, numbers, and underscores").optional(),bio:qt().optional(),avatarUrl:qt().optional(),height:qt().optional(),weight:qt().optional(),hairColor:qt().optional(),hairLength:qt().optional(),eyeColor:qt().optional(),bodyType:qt().optional(),ethnicity:qt().optional(),ageRange:qt().optional(),selectedServices:ad(qt()).default([]),servicePricing:jYe(wd({priceType:cee(["included","extra"]),customPrice:QA().optional()})).default({}),profileVisible:Hs().default(!0),showOnlineStatus:Hs().default(!1),allowMessages:Hs().default(!0),emailNotifications:Hs().default(!0),pushNotifications:Hs().default(!0),profileLinks:ad(wd({title:qt(),url:qt()})).default([])});function fXe(){const e=Oe(),{profile:t,loading:r,saving:n,saveProfile:a}=bee(),[i,o]=w.useState(1),[l,c]=w.useState(null),[u,d]=w.useState(!0),[h,f]=w.useState(null),p=l4({resolver:c4(hXe),defaultValues:{languages:[],username:"",bio:"",avatarUrl:"",height:"",weight:"",hairColor:"",hairLength:"",eyeColor:"",bodyType:"",ethnicity:"",ageRange:"",selectedServices:[],servicePricing:{},profileVisible:!0,showOnlineStatus:!1,allowMessages:!0,emailNotifications:!0,pushNotifications:!0,profileLinks:[]}});w.useEffect(()=>{(async()=>{try{const{data:{user:k}}=await T.auth.getUser();if(!k){d(!1);return}const P=sessionStorage.getItem("vairify_role");if(P==="provider"||P==="client"){c(P),d(!1);return}const{data:A}=await T.from("provider_profiles").select("user_id").eq("user_id",k.id).maybeSingle();if(A)c("provider"),sessionStorage.setItem("vairify_role","provider");else{const{data:O}=await T.from("profiles").select("id").eq("id",k.id).maybeSingle();c("client"),sessionStorage.setItem("vairify_role","client")}}catch(k){console.error("Error detecting role:",k),c("client")}finally{d(!1)}})()},[]),w.useEffect(()=>{(async()=>{const{data:{user:k}}=await T.auth.getUser();if(!k)return;const{data:P}=await T.from("referral_codes").select("tier").eq("user_id",k.id).single();P!=null&&P.tier&&f(P.tier)})()},[]),w.useEffect(()=>{l==="provider"&&t&&!r?p.reset({username:t.username||"",avatarUrl:t.avatar_url||"",height:t.height||"",weight:t.weight||"",hairColor:t.hair_color||"",hairLength:t.hair_length||"",eyeColor:t.eye_color||"",bodyType:t.body_type||"",ethnicity:t.ethnicity||"",ageRange:t.age_range||"",selectedServices:t.services_offered||[],languages:[],servicePricing:{}}):l==="client"&&!r&&(async()=>{const{data:{user:k}}=await T.auth.getUser();if(!k)return;const{data:P}=await T.from("profiles").select("*").eq("id",k.id).maybeSingle();P&&p.reset({bio:P.bio||"",avatarUrl:P.avatar_url||"",profileVisible:!0,showOnlineStatus:!1,allowMessages:!0,emailNotifications:!0,pushNotifications:!0,profileLinks:P.profile_links||[],languages:[]})})()},[t,r,p,l]),w.useEffect(()=>{const E=setInterval(()=>{const k=p.getValues();localStorage.setItem("vairify_profile_wizard_draft",JSON.stringify({formData:k,currentStep:i}))},3e4);return()=>clearInterval(E)},[p,i]),w.useEffect(()=>{const E=localStorage.getItem("vairify_profile_wizard_draft");if(E)try{const{formData:k,currentStep:P}=JSON.parse(E);p.reset(k),o(P||1)}catch(k){console.error("Error loading draft:",k)}},[p]);const m=async E=>{try{const k=p.getValues(),{data:{user:P}}=await T.auth.getUser();if(!P||l==="provider"&&E>=2&&!k.username)return;if(localStorage.setItem("vairify_profile_wizard_draft",JSON.stringify({formData:k,currentStep:E})),l==="provider"&&k.username)await a({username:k.username,avatar_url:k.avatarUrl,height:k.height,weight:k.weight,hair_color:k.hairColor,hair_length:k.hairLength,eye_color:k.eyeColor,body_type:k.bodyType,ethnicity:k.ethnicity,age_range:k.ageRange,services_offered:k.selectedServices});else if(l==="client"){const{data:{user:A}}=await T.auth.getUser();A&&await T.from("profiles").upsert({id:A.id,avatar_url:k.avatarUrl,bio:k.bio,profile_links:k.profileLinks||[],updated_at:new Date().toISOString()},{onConflict:"id"})}}catch(k){console.error("Error saving step progress:",k)}},g=l==="client"?3:5,x=async()=>{if(i<g){if(l==="provider"&&i===2&&!p.getValues("username")){H.error("Username is required to continue");return}await m(i),o(i+1),window.scrollTo({top:0,behavior:"smooth"})}},y=()=>{i>1&&(o(i-1),window.scrollTo({top:0,behavior:"smooth"}))},b=()=>i===2&&l==="provider"?!!p.getValues("username")&&p.getValues("username").length>=3:!0,N=async E=>{try{const{data:{user:k}}=await T.auth.getUser();if(!k){H.error("You must be logged in to save your profile");return}if(l==="provider"){if(!E.username||E.username.trim().length<3){H.error("Username is required and must be at least 3 characters"),o(2);return}const P={username:E.username.trim(),avatar_url:E.avatarUrl,height:E.height,weight:E.weight,hair_color:E.hairColor,hair_length:E.hairLength,eye_color:E.eyeColor,body_type:E.bodyType,ethnicity:E.ethnicity,age_range:E.ageRange,services_offered:E.selectedServices};if(await a(P)){if(Object.keys(E.servicePricing).length>0){const O=Object.entries(E.servicePricing).map(([I,R])=>({user_id:k.id,service_option_id:I,price_type:R.priceType,custom_price:R.customPrice||null}));for(const I of O)await T.from("provider_service_pricing").upsert([I],{onConflict:"user_id,service_option_id"})}localStorage.removeItem("vairify_profile_wizard_draft"),H.success("Profile created successfully!"),e("/feed")}}else{const{error:P}=await T.from("profiles").upsert({id:k.id,avatar_url:E.avatarUrl,bio:E.bio,profile_links:E.profileLinks||[],updated_at:new Date().toISOString()},{onConflict:"id"});if(P)throw P;const{error:A}=await T.from("privacy_settings").upsert({user_id:k.id,profile_visibility:E.profileVisible?"public":"private",online_status_visible:E.showOnlineStatus,show_in_search:E.profileVisible,updated_at:new Date().toISOString()},{onConflict:"user_id"});A&&A.code!=="PGRST116"&&console.error("Error saving privacy settings:",A);const{error:O}=await T.from("user_settings").upsert({user_id:k.id,email_notifications:E.emailNotifications,push_notifications:E.pushNotifications,updated_at:new Date().toISOString()},{onConflict:"user_id"});O&&O.code!=="PGRST116"&&console.error("Error saving notification settings:",O),localStorage.removeItem("vairify_profile_wizard_draft"),H.success("Profile created successfully!"),e("/feed")}}catch(k){console.error("Error submitting profile:",k),H.error("Failed to save profile. Please try again.")}},j=()=>{if(l==="client")switch(i){case 1:return"Language";case 2:return"Personal Info";case 3:return"Settings";default:return""}else switch(i){case 1:return"Language";case 2:return"Personal Info";case 3:return"Appearance";case 4:return"Services";case 5:return"Pricing";default:return""}},_=()=>l==="client"?[1,2,3]:[1,2,3,4,5];if(r||u)return s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background to-background/95 flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading your profile..."})]})});if(!l)return s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background to-background/95 flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4 max-w-md mx-auto p-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Unable to Detect Role"}),s.jsx("p",{className:"text-muted-foreground",children:"Please select your role first from the onboarding flow."}),s.jsx(L,{onClick:()=>e("/onboarding/role"),children:"Go to Role Selection"})]})});const S=i/g*100,C=_();return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background to-background/95 pb-32 md:pb-16",children:[s.jsx("div",{className:"sticky top-0 z-40 bg-card/95 backdrop-blur-sm border-b border-border",children:s.jsx("div",{className:"container mx-auto px-4 py-4",children:s.jsxs("div",{className:"max-w-3xl mx-auto space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("span",{className:"text-muted-foreground",children:["Step ",i," of ",g,": ",j()]}),s.jsxs("span",{className:"text-primary font-medium",children:[Math.round(S),"% Complete"]})]}),s.jsx(aN,{value:S,className:"h-2"}),s.jsx("div",{className:"flex items-center justify-between",children:C.map((E,k)=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-medium transition-colors ${E===i?"bg-primary text-primary-foreground":E<i?"bg-success text-success-foreground":"bg-muted text-muted-foreground"}`,children:E<i?s.jsx($t,{className:"w-4 h-4"}):E}),k<C.length-1&&s.jsx("div",{className:`h-0.5 w-8 ${E<i?"bg-success":"bg-muted"}`})]},E))})]})})}),s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsxs("div",{className:"text-center space-y-4 mb-8 animate-fade-in",children:[s.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-foreground",children:l==="provider"?"Create Your Professional Profile":"Create Your Profile"}),s.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:l==="provider"?"Only username is requiredeverything else is optional and helps you get discovered.":"Set up your profile to connect with providers safely."}),l==="provider"&&s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx(xe,{variant:"secondary",className:"bg-primary/20 text-primary",children:"Provider Account"}),h&&s.jsx(e4,{tier:h,size:"lg"})]}),l==="client"&&s.jsx(xe,{variant:"secondary",className:"bg-accent/20 text-accent",children:"Client Account"})]}),s.jsx(d4,{...p,children:s.jsxs("form",{onSubmit:p.handleSubmit(N),children:[i===1&&s.jsx(aXe,{form:p}),i===2&&s.jsx(sXe,{form:p,userRole:l}),l==="provider"&&s.jsxs(s.Fragment,{children:[i===3&&s.jsx(iXe,{form:p}),i===4&&s.jsx(oXe,{form:p}),i===5&&s.jsx(uXe,{form:p})]}),l==="client"&&i===3&&s.jsx(dXe,{form:p})]})})]})}),s.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-card/95 backdrop-blur-sm border-t border-border p-4 md:p-6",children:s.jsx("div",{className:"container mx-auto max-w-3xl",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-center justify-between",children:[s.jsx("div",{className:"w-full sm:w-auto",children:i>1?s.jsxs(L,{type:"button",variant:"outline",onClick:y,className:"w-full sm:w-auto",children:[s.jsx(Xd,{className:"w-4 h-4 mr-1"}),"Previous"]}):s.jsx("p",{className:"text-sm text-muted-foreground text-center sm:text-left",children:"Edit anytime in Settings"})}),s.jsx("div",{className:"flex gap-3 w-full sm:w-auto",children:i<g?s.jsxs(L,{type:"button",onClick:x,disabled:!b()||n,className:"flex-1 sm:flex-none min-w-[150px]",children:["Next Step",s.jsx(Wp,{className:"w-4 h-4 ml-1"})]}):s.jsx(L,{type:"submit",onClick:p.handleSubmit(N),className:"flex-1 sm:flex-none min-w-[200px]",disabled:l==="provider"&&!p.getValues("username")||n,children:n?"Saving...":"Complete Profile"})})]})})})]})}const nv=qt().trim().max(100,"Handle must be less than 100 characters").optional(),pXe=wd({application_type:cee(["influencer","affiliate"],{required_error:"Please select an application type"}),instagram:nv,tiktok:nv,youtube:nv,twitter:nv,other_platform:qt().trim().max(50,"Platform name must be less than 50 characters").optional(),other_handle:nv,audience_size:qt({required_error:"Please select your audience size"}),application_notes:qt().trim().max(1e3,"Notes must be less than 1000 characters").optional()});function mXe(){const e=Oe(),[t,r]=w.useState(!1),n=l4({resolver:c4(pXe),defaultValues:{application_type:"influencer",instagram:"",tiktok:"",youtube:"",twitter:"",other_platform:"",other_handle:"",audience_size:"",application_notes:""}}),a=async i=>{r(!0);try{const{data:{user:o}}=await T.auth.getUser();if(!o){H.error("You must be logged in to apply"),e("/login");return}const{data:l}=await T.from("influencer_applications").select("id, status").eq("user_id",o.id).in("status",["pending","approved"]).single();if(l){l.status==="approved"?(H.error("You already have an approved application"),e("/application/status")):(H.error("You already have a pending application"),e("/application/status")),r(!1);return}const c={};i.instagram&&(c.instagram=i.instagram),i.tiktok&&(c.tiktok=i.tiktok),i.youtube&&(c.youtube=i.youtube),i.twitter&&(c.twitter=i.twitter),i.other_platform&&i.other_handle&&(c[i.other_platform]=i.other_handle);const{error:u}=await T.from("influencer_applications").insert({user_id:o.id,application_type:i.application_type,social_handles:c,audience_size:i.audience_size,application_notes:i.application_notes||null});if(u)throw u;H.success("Application submitted successfully! We'll review it shortly."),e("/application/status")}catch(o){console.error("Application error:",o),H.error("Failed to submit application. Please try again.")}finally{r(!1)}};return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-6",children:s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsxs(L,{variant:"ghost",size:"sm",onClick:()=>e(-1),className:"mb-4",children:[s.jsx(ze,{className:"h-4 w-4 mr-2"}),"Back"]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center gap-2",children:[s.jsx(An,{className:"h-6 w-6 text-primary"}),"Apply as Influencer or Affiliate"]}),s.jsx(Re,{children:"Join our network and earn commissions by promoting Vairify. Share your social media presence and we'll review your application."})]}),s.jsx(ee,{children:s.jsx(d4,{...n,children:s.jsxs("form",{onSubmit:n.handleSubmit(a),className:"space-y-6",children:[s.jsx(pt,{control:n.control,name:"application_type",render:({field:i})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Application Type *"}),s.jsx(Nn,{children:s.jsxs(nm,{onValueChange:i.onChange,defaultValue:i.value,className:"flex flex-col space-y-2",children:[s.jsxs(Bt,{className:"flex items-center space-x-3 space-y-0",children:[s.jsx(Nn,{children:s.jsx(Ts,{value:"influencer"})}),s.jsx(gr,{className:"font-normal cursor-pointer",children:s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold",children:"Influencer"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Content creators with engaged audiences"})]})})]}),s.jsxs(Bt,{className:"flex items-center space-x-3 space-y-0",children:[s.jsx(Nn,{children:s.jsx(Ts,{value:"affiliate"})}),s.jsx(gr,{className:"font-normal cursor-pointer",children:s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold",children:"Affiliate"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Marketers and promoters earning through referrals"})]})})]})]})}),s.jsx(gs,{})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(en,{className:"h-5 w-5 text-primary"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Social Media Presence"})]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Provide at least one social media handle where you have an audience"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx(pt,{control:n.control,name:"instagram",render:({field:i})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Instagram"}),s.jsx(Nn,{children:s.jsx(De,{placeholder:"@username",...i})}),s.jsx(gs,{})]})}),s.jsx(pt,{control:n.control,name:"tiktok",render:({field:i})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"TikTok"}),s.jsx(Nn,{children:s.jsx(De,{placeholder:"@username",...i})}),s.jsx(gs,{})]})}),s.jsx(pt,{control:n.control,name:"youtube",render:({field:i})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"YouTube"}),s.jsx(Nn,{children:s.jsx(De,{placeholder:"Channel name or handle",...i})}),s.jsx(gs,{})]})}),s.jsx(pt,{control:n.control,name:"twitter",render:({field:i})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"X (Twitter)"}),s.jsx(Nn,{children:s.jsx(De,{placeholder:"@username",...i})}),s.jsx(gs,{})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx(pt,{control:n.control,name:"other_platform",render:({field:i})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Other Platform"}),s.jsx(Nn,{children:s.jsx(De,{placeholder:"Platform name",...i})}),s.jsx(gs,{})]})}),s.jsx(pt,{control:n.control,name:"other_handle",render:({field:i})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Handle/Username"}),s.jsx(Nn,{children:s.jsx(De,{placeholder:"@username",...i})}),s.jsx(gs,{})]})})]})]}),s.jsx(pt,{control:n.control,name:"audience_size",render:({field:i})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Total Audience Size *"}),s.jsxs(At,{onValueChange:i.onChange,defaultValue:i.value,children:[s.jsx(Nn,{children:s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select your audience size"})})}),s.jsxs(St,{children:[s.jsx(re,{value:"1k-10k",children:"1K - 10K followers"}),s.jsx(re,{value:"10k-50k",children:"10K - 50K followers"}),s.jsx(re,{value:"50k-100k",children:"50K - 100K followers"}),s.jsx(re,{value:"100k-500k",children:"100K - 500K followers"}),s.jsx(re,{value:"500k-1m",children:"500K - 1M followers"}),s.jsx(re,{value:"1m+",children:"1M+ followers"})]})]}),s.jsx(Fi,{children:"Combined total across all platforms"}),s.jsx(gs,{})]})}),s.jsx(pt,{control:n.control,name:"application_notes",render:({field:i})=>s.jsxs(Bt,{children:[s.jsx(gr,{children:"Additional Information (Optional)"}),s.jsx(Nn,{children:s.jsx(Mn,{placeholder:"Tell us about your content style, audience demographics, or why you'd be a great fit...",className:"min-h-[100px]",...i})}),s.jsx(Fi,{children:"Maximum 1000 characters"}),s.jsx(gs,{})]})}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx(L,{type:"button",variant:"outline",onClick:()=>e(-1),disabled:t,children:"Cancel"}),s.jsx(L,{type:"submit",disabled:t,children:t?"Submitting...":"Submit Application"})]})]})})})]})]})})}function vXe(){const e=Oe(),[t,r]=w.useState(null),[n,a]=w.useState(!0),[i,o]=w.useState(!1);w.useEffect(()=>{l()},[]);const l=async()=>{try{const{data:{user:h}}=await T.auth.getUser();if(!h){e("/login");return}const{data:f}=await T.from("user_roles").select("role").eq("user_id",h.id).in("role",["influencer","affiliate"]);if(f&&f.length>0){o(!0),a(!1);return}const{data:p,error:m}=await T.from("influencer_applications").select("*").eq("user_id",h.id).order("applied_at",{ascending:!1}).maybeSingle();if(m)throw m;r(p)}catch(h){console.error("Error loading application:",h),H.error("Failed to load application status")}finally{a(!1)}},c=h=>{switch(h){case"pending":return{icon:On,color:"text-yellow-500",bgColor:"bg-yellow-500/10",borderColor:"border-yellow-500/20",title:"Application Under Review",description:"Your application is being reviewed by our team. We'll notify you once a decision is made."};case"approved":return{icon:ut,color:"text-green-500",bgColor:"bg-green-500/10",borderColor:"border-green-500/20",title:"Application Approved!",description:"Congratulations! Your application has been approved. You can now start earning as an "+((t==null?void 0:t.application_type)||"member")+"."};case"rejected":return{icon:Qd,color:"text-red-500",bgColor:"bg-red-500/10",borderColor:"border-red-500/20",title:"Application Not Approved",description:"Unfortunately, your application was not approved at this time. You may reapply in the future."};default:return{icon:Xs,color:"text-gray-500",bgColor:"bg-gray-500/10",borderColor:"border-gray-500/20",title:"Unknown Status",description:"Please contact support for more information."}}};if(n)return s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});if(i)return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-6",children:s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsxs(L,{variant:"ghost",size:"sm",onClick:()=>e("/feed"),className:"mb-4",children:[s.jsx(ze,{className:"h-4 w-4 mr-2"}),"Back to Feed"]}),s.jsxs(q,{className:"border-green-500/20 bg-green-500/5",children:[s.jsx(ge,{children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-green-500/10 rounded-full flex items-center justify-center",children:s.jsx(ut,{className:"w-6 h-6 text-green-500"})}),s.jsxs("div",{children:[s.jsx(be,{children:"You're Already a Member!"}),s.jsx(Re,{children:"You have influencer or affiliate status"})]})]})}),s.jsxs(ee,{children:[s.jsx("p",{className:"text-muted-foreground mb-4",children:"You already have influencer or affiliate access. Visit your referral dashboard to start earning."}),s.jsx(L,{onClick:()=>e("/referrals"),children:"Go to Referral Dashboard"})]})]})]})});if(!t)return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-6",children:s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsxs(L,{variant:"ghost",size:"sm",onClick:()=>e("/feed"),className:"mb-4",children:[s.jsx(ze,{className:"h-4 w-4 mr-2"}),"Back to Feed"]}),s.jsxs(q,{children:[s.jsx(ge,{children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-purple-500/10 rounded-full flex items-center justify-center",children:s.jsx(en,{className:"w-6 h-6 text-purple-500"})}),s.jsxs("div",{children:[s.jsx(be,{children:"No Application Found"}),s.jsx(Re,{children:"You haven't submitted an application yet"})]})]})}),s.jsxs(ee,{className:"space-y-4",children:[s.jsx("p",{className:"text-muted-foreground",children:"Ready to join our network of influencers and affiliates? Submit your application to get started."}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(L,{onClick:()=>e("/apply/influencer"),children:"Apply Now"}),s.jsx(L,{variant:"outline",onClick:()=>e("/feed"),children:"Back to Feed"})]})]})]})]})});const u=c(t.status),d=u.icon;return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-6",children:s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsxs(L,{variant:"ghost",size:"sm",onClick:()=>e("/feed"),className:"mb-4",children:[s.jsx(ze,{className:"h-4 w-4 mr-2"}),"Back to Feed"]}),s.jsxs(q,{className:`${u.borderColor} ${u.bgColor}`,children:[s.jsx(ge,{children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-12 h-12 ${u.bgColor} rounded-full flex items-center justify-center`,children:s.jsx(d,{className:`w-6 h-6 ${u.color}`})}),s.jsxs("div",{children:[s.jsx(be,{children:u.title}),s.jsxs(Re,{children:["Applied ",new Date(t.applied_at).toLocaleDateString()]})]})]})}),s.jsxs(ee,{className:"space-y-4",children:[s.jsx(Hn,{children:s.jsx(Kn,{children:u.description})}),s.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[s.jsx("h3",{className:"font-semibold",children:"Application Details"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Type"}),s.jsxs(xe,{variant:"outline",className:"mt-1 capitalize",children:[t.application_type==="influencer"&&s.jsx(An,{className:"w-3 h-3 mr-1"}),t.application_type==="affiliate"&&s.jsx(en,{className:"w-3 h-3 mr-1"}),t.application_type]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Audience Size"}),s.jsx("p",{className:"font-medium mt-1",children:t.audience_size})]})]}),t.application_notes&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Your Notes"}),s.jsx("p",{className:"text-sm mt-1",children:t.application_notes})]}),t.admin_notes&&s.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[s.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Admin Feedback"}),s.jsx("p",{className:"text-sm mt-1",children:t.admin_notes})]}),t.reviewed_at&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Reviewed"}),s.jsx("p",{className:"text-sm mt-1",children:new Date(t.reviewed_at).toLocaleDateString()})]})]}),s.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[t.status==="rejected"&&s.jsx(L,{onClick:()=>e("/apply/influencer"),children:"Reapply"}),t.status==="approved"&&s.jsx(L,{onClick:()=>e("/referrals"),children:"Go to Referral Dashboard"}),s.jsx(L,{variant:"outline",onClick:()=>e("/feed"),children:"Back to Feed"})]})]})]})]})})}function gXe(){const e=Oe(),[t,r]=w.useState([]),[n,a]=w.useState(!0);w.useEffect(()=>{i();const h=T.channel("notifications-changes").on("postgres_changes",{event:"*",schema:"public",table:"notifications"},()=>{i()}).subscribe();return()=>{T.removeChannel(h)}},[]);const i=async()=>{try{const{data:{user:h}}=await T.auth.getUser();if(!h){e("/login");return}const{data:f,error:p}=await T.from("notifications").select("*").eq("user_id",h.id).order("created_at",{ascending:!1});if(p)throw p;r(f||[])}catch(h){console.error("Error loading notifications:",h),H.error("Failed to load notifications")}finally{a(!1)}},o=async h=>{try{const{error:f}=await T.from("notifications").update({read:!0}).eq("id",h);if(f)throw f;r(p=>p.map(m=>m.id===h?{...m,read:!0}:m))}catch(f){console.error("Error marking notification as read:",f)}},l=async()=>{try{const{data:{user:h}}=await T.auth.getUser();if(!h)return;const{error:f}=await T.from("notifications").update({read:!0}).eq("user_id",h.id).eq("read",!1);if(f)throw f;H.success("All notifications marked as read"),i()}catch(h){console.error("Error marking all as read:",h),H.error("Failed to mark notifications as read")}},c=async h=>{try{const{error:f}=await T.from("notifications").delete().eq("id",h);if(f)throw f;r(p=>p.filter(m=>m.id!==h)),H.success("Notification deleted")}catch(f){console.error("Error deleting notification:",f),H.error("Failed to delete notification")}},u=h=>{switch(h){case"application_status":return"";case"referral":return"";case"system":return"";default:return""}},d=t.filter(h=>!h.read).length;return n?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsx("div",{className:"text-center",children:"Loading notifications..."})}):s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"sticky top-0 z-10 bg-background border-b border-border px-4 py-3",children:s.jsxs("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/feed"),children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold text-foreground",children:"Notifications"}),d>0&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:[d," unread"]})]})]}),d>0&&s.jsxs(L,{variant:"outline",size:"sm",onClick:l,children:[s.jsx($t,{className:"w-4 h-4 mr-2"}),"Mark all read"]})]})}),s.jsx("main",{className:"max-w-4xl mx-auto px-4 py-6",children:t.length===0?s.jsx(q,{children:s.jsxs(ee,{className:"py-12 text-center",children:[s.jsx("div",{className:"text-6xl mb-4",children:""}),s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"No notifications"}),s.jsx("p",{className:"text-muted-foreground",children:"You're all caught up! We'll notify you when something important happens."})]})}):s.jsx("div",{className:"space-y-2",children:t.map(h=>s.jsx(q,{className:`transition-colors ${h.read?"bg-background":"bg-accent/50 border-primary/20"}`,children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"text-3xl flex-shrink-0",children:u(h.type)}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-foreground mb-1",children:h.title}),s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:h.message}),s.jsx("p",{className:"text-xs text-muted-foreground",children:SI(new Date(h.created_at),{addSuffix:!0})})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[!h.read&&s.jsx(L,{variant:"ghost",size:"sm",onClick:()=>o(h.id),children:s.jsx($t,{className:"w-4 h-4"})}),s.jsx(L,{variant:"ghost",size:"sm",onClick:()=>c(h.id),children:s.jsx(Qc,{className:"w-4 h-4"})})]})]})})]})})},h.id))})})]})}const xXe=()=>{const{toast:e}=Et(),[t,r]=w.useState(!1),[n,a]=w.useState(!1),[i,o]=w.useState(!0),[l,c]=w.useState("5"),[u,d]=w.useState(null),[h,f]=w.useState(null),[p,m]=w.useState("");w.useEffect(()=>{v()},[]),w.useEffect(()=>{if(!h)return;const j=setInterval(()=>{const _=new Date,S=h.getTime()-_.getTime();if(S<=0)a(!1),f(null),m(""),e({title:"Available Now Expired",description:"Your 1-hour availability window has ended."});else{const C=Math.floor(S/6e4),E=Math.floor(S%6e4/1e3);m(`${C}m ${E}s`)}},1e3);return()=>clearInterval(j)},[h,e]);const v=async()=>{var j;try{const{data:{user:_}}=await T.auth.getUser();if(!_)return;const{data:S,error:C}=await T.from("provider_profiles").select("available_now, available_now_started_at, available_now_location, accept_invitations").eq("user_id",_.id).single();if(C)throw C;if(S){if(a(S.available_now||!1),o(S.accept_invitations??!0),S.available_now_location&&typeof S.available_now_location=="object"){const E=S.available_now_location;d({lat:E.lat,lng:E.lng,address:E.address}),c(((j=E.radius_miles)==null?void 0:j.toString())||"5")}if(S.available_now&&S.available_now_started_at){const E=new Date(S.available_now_started_at),k=new Date(E.getTime()+60*60*1e3);f(k)}}}catch(_){console.error("Error loading availability settings:",_)}},g=()=>new Promise((j,_)=>{if(!navigator.geolocation){_(new Error("Geolocation is not supported"));return}navigator.geolocation.getCurrentPosition(async S=>{const{latitude:C,longitude:E}=S.coords;try{const P=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${C}&lon=${E}`)).json();j({lat:C,lng:E,address:P.display_name||`${C.toFixed(4)}, ${E.toFixed(4)}`})}catch{j({lat:C,lng:E,address:`${C.toFixed(4)}, ${E.toFixed(4)}`})}},S=>{_(S)})}),x=async j=>{if(j&&!u){e({title:"Location Required",description:"Please set your location before enabling Available Now.",variant:"destructive"});return}r(!0);try{const{data:{user:_}}=await T.auth.getUser();if(!_)throw new Error("Not authenticated");const S={available_now:j,available_now_started_at:j?new Date().toISOString():null};j&&u&&(S.available_now_location={...u,radius_miles:parseInt(l)});const{error:C}=await T.from("provider_profiles").update(S).eq("user_id",_.id);if(C)throw C;if(a(j),j){const E=new Date(Date.now()+36e5);f(E),e({title:"Available Now Active",description:"You're now visible to nearby clients for 1 hour."})}else f(null),m(""),e({title:"Available Now Disabled",description:"You're no longer visible in Available Now searches."})}catch(_){console.error("Error updating availability:",_),e({title:"Error",description:"Failed to update availability status.",variant:"destructive"})}finally{r(!1)}},y=async j=>{r(!0);try{const{data:{user:_}}=await T.auth.getUser();if(!_)throw new Error("Not authenticated");const{error:S}=await T.from("provider_profiles").update({accept_invitations:j}).eq("user_id",_.id);if(S)throw S;o(j),e({title:j?"Invitations Enabled":"Invitations Disabled",description:j?"You'll receive client invitation requests to review.":"You won't receive new invitation requests."})}catch(_){console.error("Error updating invitations:",_),e({title:"Error",description:"Failed to update invitation settings.",variant:"destructive"})}finally{r(!1)}},b=async()=>{r(!0);try{const j=await g();if(d(j),n){const{data:{user:_}}=await T.auth.getUser();if(!_)throw new Error("Not authenticated");const{error:S}=await T.from("provider_profiles").update({available_now_location:{...j,radius_miles:parseInt(l)}}).eq("user_id",_.id);if(S)throw S}e({title:"Location Set",description:"Your current location has been saved."})}catch(j){console.error("Error getting location:",j),e({title:"Location Error",description:"Failed to get your current location. Please enable location services.",variant:"destructive"})}finally{r(!1)}},N=async j=>{if(c(j),n&&u)try{const{data:{user:_}}=await T.auth.getUser();if(!_)return;await T.from("provider_profiles").update({available_now_location:{...u,radius_miles:parseInt(j)}}).eq("user_id",_.id)}catch(_){console.error("Error updating radius:",_)}};return s.jsx("div",{className:"space-y-4",children:s.jsx(q,{className:"p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(On,{className:"h-5 w-5 text-primary"}),s.jsx(de,{htmlFor:"available-now",className:"text-base font-semibold",children:"Available Now"})]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Become visible to nearby clients for 1 hour"})]}),s.jsx(Yt,{id:"available-now",checked:n,onCheckedChange:x,disabled:t})]}),n&&p&&s.jsxs(Hn,{children:[s.jsx(On,{className:"h-4 w-4"}),s.jsxs(Kn,{children:["Active for ",p," remaining"]})]}),s.jsxs("div",{className:"space-y-3 pl-7 border-l-2 border-border",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{className:"text-sm",children:"Location"}),u?s.jsxs("div",{className:"flex items-start gap-2 p-3 bg-muted rounded-lg",children:[s.jsx(hn,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),s.jsx("p",{className:"text-sm flex-1",children:u.address})]}):s.jsx("p",{className:"text-sm text-muted-foreground",children:"No location set"}),s.jsxs(L,{variant:"outline",size:"sm",onClick:b,disabled:t,className:"w-full",children:[s.jsx(hn,{className:"h-4 w-4 mr-2"}),u?"Update Location":"Set Current Location"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"radius",className:"text-sm",children:"Search Radius"}),s.jsxs(At,{value:l,onValueChange:N,disabled:t,children:[s.jsx(_t,{id:"radius",children:s.jsx(Pt,{})}),s.jsxs(St,{children:[s.jsx(re,{value:"5",children:"5 miles"}),s.jsx(re,{value:"10",children:"10 miles"}),s.jsx(re,{value:"25",children:"25 miles"}),s.jsx(re,{value:"50",children:"50 miles"}),s.jsx(re,{value:"100",children:"100 miles"})]})]})]})]})]}),s.jsx("div",{className:"border-t"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(An,{className:"h-5 w-5 text-primary"}),s.jsx(de,{htmlFor:"accept-invitations",className:"text-base font-semibold",children:"Accept Invitations"})]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive and selectively respond to client requests"})]}),s.jsx(Yt,{id:"accept-invitations",checked:i,onCheckedChange:y,disabled:t})]}),s.jsxs(Hn,{children:[s.jsx(iz,{className:"h-4 w-4"}),s.jsx(Kn,{children:"With invitations, you can review client preferences and choose which requests to respond to, avoiding bombardment while staying selective."})]})]})]})})})},yXe=()=>{const e=Oe();return s.jsx("div",{className:"min-h-screen bg-background",children:s.jsxs("div",{className:"container max-w-2xl mx-auto p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e(-1),children:s.jsx(ze,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Availability Settings"}),s.jsx("p",{className:"text-muted-foreground",children:"Control how clients can discover and request encounters"})]})]}),s.jsx(xXe,{}),s.jsx(rJ,{}),s.jsxs(q,{className:"p-6 bg-muted/50",children:[s.jsx("h2",{className:"font-semibold mb-4",children:"How It Works"}),s.jsxs("div",{className:"space-y-4 text-sm text-muted-foreground",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-foreground mb-1",children:"Available Now"}),s.jsx("p",{children:`Toggle this on when you're ready to meet clients immediately. You'll appear in "Available Now" searches for nearby clients. Your location and radius determine your visibility. This status automatically expires after 1 hour or when you accept a VAI Check.`})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-foreground mb-1",children:"Accept Invitations"}),s.jsx("p",{children:"When enabled, you'll see client invitation requests with their preferences. You can selectively choose which invitations to respond to by sending your profile. This gives you control without the bombardment of direct requests."})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-foreground mb-1",children:"Availability Schedule"}),s.jsx("p",{children:"Set recurring weekly times when you want to automatically become Available Now. Your status will activate during scheduled times and you can still manually control it anytime."})]})]})]})]})})},bXe=()=>{const e=Oe(),[t,r]=w.useState([]),[n,a]=w.useState(!0),[i,o]=w.useState(""),[l,c]=w.useState("50"),[u,d]=w.useState(null),h=(g,x,y,b)=>{const j=(y-g)*Math.PI/180,_=(b-x)*Math.PI/180,S=Math.sin(j/2)*Math.sin(j/2)+Math.cos(g*Math.PI/180)*Math.cos(y*Math.PI/180)*Math.sin(_/2)*Math.sin(_/2);return 3959*(2*Math.atan2(Math.sqrt(S),Math.sqrt(1-S)))},f=async()=>{try{const{data:g,error:x}=await T.from("provider_profiles").select("id, user_id, username, avatar_url, available_now_started_at, available_now_location").eq("available_now",!0).not("available_now_location","is",null);if(x)throw x;let y=g;if(u){y=y.map(N=>{if(N.available_now_location){const j=h(u.lat,u.lng,N.available_now_location.lat,N.available_now_location.lng);return{...N,distance:j}}return N});const b=parseInt(l);y=y.filter(N=>!N.distance||N.distance<=b),y.sort((N,j)=>(N.distance||0)-(j.distance||0))}r(y)}catch(g){console.error("Error loading providers:",g),H.error("Failed to load available providers")}finally{a(!1)}},p=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(g=>{d({lat:g.coords.latitude,lng:g.coords.longitude})},g=>{console.error("Error getting location:",g),H.error("Unable to get your location")})};w.useEffect(()=>{p()},[]),w.useEffect(()=>{f();const g=T.channel("available-now-changes").on("postgres_changes",{event:"*",schema:"public",table:"provider_profiles",filter:"available_now=eq.true"},()=>{f()}).subscribe();return()=>{T.removeChannel(g)}},[l,u]);const m=g=>{const x=new Date(g),b=Math.floor((new Date().getTime()-x.getTime())/6e4);return b<60?`${b}m ago`:`${Math.floor(b/60)}h ${b%60}m ago`},v=t.filter(g=>g.username.toLowerCase().includes(i.toLowerCase()));return s.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[s.jsx("header",{className:"sticky top-0 z-10 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-border",children:s.jsxs("div",{className:"flex items-center justify-between p-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e(-1),children:s.jsx(ze,{className:"h-5 w-5"})}),s.jsx("h1",{className:"text-xl font-semibold",children:"Available Now"}),s.jsx("div",{className:"w-10"})]})}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs(q,{children:[s.jsx(ge,{children:s.jsx(be,{className:"text-base",children:"Search & Filter"})}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(Cl,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),s.jsx(De,{placeholder:"Search by username...",value:i,onChange:g=>o(g.target.value),className:"pl-9"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Search Radius"}),s.jsxs(At,{value:l,onValueChange:c,children:[s.jsx(_t,{children:s.jsx(Pt,{})}),s.jsxs(St,{children:[s.jsx(re,{value:"10",children:"10 miles"}),s.jsx(re,{value:"25",children:"25 miles"}),s.jsx(re,{value:"50",children:"50 miles"}),s.jsx(re,{value:"100",children:"100 miles"}),s.jsx(re,{value:"500",children:"500 miles"})]})]})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-lg font-semibold",children:["Available Providers (",v.length,")"]}),s.jsx(xe,{variant:"secondary",className:"animate-pulse",children:"Live"})]}),n?s.jsx(s.Fragment,{children:[1,2,3].map(g=>s.jsx(q,{children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx(rd,{className:"h-16 w-16 rounded-full"}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx(rd,{className:"h-4 w-32"}),s.jsx(rd,{className:"h-3 w-48"}),s.jsx(rd,{className:"h-3 w-24"})]})]})})},g))}):v.length===0?s.jsx(q,{children:s.jsx(ee,{className:"p-8 text-center text-muted-foreground",children:"No providers available in your area right now"})}):v.map(g=>s.jsx(q,{className:"cursor-pointer hover:border-primary transition-colors",onClick:()=>e(`/profile/${g.user_id}`),children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:g.avatar_url||"/placeholder.svg",alt:g.username,className:"h-16 w-16 rounded-full object-cover"}),s.jsx("div",{className:"absolute -bottom-1 -right-1 h-5 w-5 bg-green-500 border-2 border-background rounded-full"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold truncate",children:g.username}),g.available_now_location&&s.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground mt-1",children:[s.jsx(hn,{className:"h-3 w-3"}),s.jsx("span",{className:"truncate",children:g.available_now_location.address})]}),s.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs",children:[s.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[s.jsx(On,{className:"h-3 w-3"}),s.jsx("span",{children:m(g.available_now_started_at)})]}),g.distance!==void 0&&s.jsxs(xe,{variant:"outline",className:"text-xs",children:[g.distance.toFixed(1)," mi away"]})]})]})]})})},g.id))]})]})]})};var oP=new Map,Tb=new WeakMap,QB=0,wXe;function jXe(e){return e?(Tb.has(e)||(QB+=1,Tb.set(e,QB.toString())),Tb.get(e)):"0"}function NXe(e){return Object.keys(e).sort().filter(t=>e[t]!==void 0).map(t=>`${t}_${t==="root"?jXe(e.root):e[t]}`).toString()}function _Xe(e){const t=NXe(e);let r=oP.get(t);if(!r){const n=new Map;let a;const i=new IntersectionObserver(o=>{o.forEach(l=>{var c;const u=l.isIntersecting&&a.some(d=>l.intersectionRatio>=d);e.trackVisibility&&typeof l.isVisible>"u"&&(l.isVisible=u),(c=n.get(l.target))==null||c.forEach(d=>{d(u,l)})})},e);a=i.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),r={id:t,observer:i,elements:n},oP.set(t,r)}return r}function SXe(e,t,r={},n=wXe){if(typeof window.IntersectionObserver>"u"&&n!==void 0){const c=e.getBoundingClientRect();return t(n,{isIntersecting:n,target:e,intersectionRatio:typeof r.threshold=="number"?r.threshold:0,time:0,boundingClientRect:c,intersectionRect:c,rootBounds:c}),()=>{}}const{id:a,observer:i,elements:o}=_Xe(r),l=o.get(e)||[];return o.has(e)||o.set(e,l),l.push(t),i.observe(e),function(){l.splice(l.indexOf(t),1),l.length===0&&(o.delete(e),i.unobserve(e)),o.size===0&&(i.disconnect(),oP.delete(a))}}function CXe({threshold:e,delay:t,trackVisibility:r,rootMargin:n,root:a,triggerOnce:i,skip:o,initialInView:l,fallbackInView:c,onChange:u}={}){var d;const[h,f]=w.useState(null),p=w.useRef(u),m=w.useRef(l),[v,g]=w.useState({inView:!!l,entry:void 0});p.current=u,w.useEffect(()=>{if(m.current===void 0&&(m.current=l),o||!h)return;let N;return N=SXe(h,(j,_)=>{const S=m.current;m.current=j,!(S===void 0&&!j)&&(g({inView:j,entry:_}),p.current&&p.current(j,_),_.isIntersecting&&i&&N&&(N(),N=void 0))},{root:a,rootMargin:n,threshold:e,trackVisibility:r,delay:t},c),()=>{N&&N()}},[Array.isArray(e)?e.toString():e,h,a,n,i,o,r,c,t]);const x=(d=v.entry)==null?void 0:d.target,y=w.useRef(void 0);!h&&x&&!i&&!o&&y.current!==x&&(y.current=x,g({inView:!!l,entry:void 0}),m.current=l);const b=[f,v.inView,v.entry];return b.ref=b[0],b.inView=b[1],b.entry=b[2],b}const EXe=({open:e,onOpenChange:t,mediaUrls:r,initialIndex:n=0})=>{const[a,i]=w.useState(n),o=()=>{i(c=>c>0?c-1:r.length-1)},l=()=>{i(c=>c<r.length-1?c+1:0)};return s.jsx(Ca,{open:e,onOpenChange:t,children:s.jsx(oa,{className:"max-w-full h-screen p-0 bg-black",children:s.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",children:[s.jsx("button",{onClick:()=>t(!1),className:"absolute top-4 right-4 z-50 bg-black/50 text-white rounded-full p-2 hover:bg-black/70",children:s.jsx(vn,{className:"h-6 w-6"})}),s.jsx("img",{src:r[a],alt:`Media ${a+1}`,className:"max-w-full max-h-full object-contain"}),r.length>1&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:o,className:"absolute left-4 top-1/2 -translate-y-1/2 bg-black/50 text-white rounded-full p-3 hover:bg-black/70",children:s.jsx(Xd,{className:"h-6 w-6"})}),s.jsx("button",{onClick:l,className:"absolute right-4 top-1/2 -translate-y-1/2 bg-black/50 text-white rounded-full p-3 hover:bg-black/70",children:s.jsx(Wp,{className:"h-6 w-6"})}),s.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2",children:r.map((c,u)=>s.jsx("button",{onClick:()=>i(u),className:`w-2 h-2 rounded-full transition-colors ${u===a?"bg-white":"bg-white/50"}`},u))})]})]})})})},kXe=({open:e,onOpenChange:t,postId:r})=>{const[n,a]=w.useState([]),[i,o]=w.useState(""),[l,c]=w.useState(!1),[u,d]=w.useState(!1);w.useEffect(()=>{e&&h()},[e,r]);const h=async()=>{try{c(!0);const{data:p,error:m}=await T.from("marketplace_post_comments").select(`
          *,
          profiles:user_id (
            full_name,
            avatar_url
          ),
          provider_profiles:user_id (
            username,
            avatar_url
          )
        `).eq("post_id",r).order("created_at",{ascending:!1});if(m)throw m;a(p||[])}catch(p){console.error("Error loading comments:",p),H.error("Failed to load comments")}finally{c(!1)}},f=async p=>{if(p.preventDefault(),!!i.trim())try{d(!0);const{data:{user:m}}=await T.auth.getUser();if(!m){H.error("Please sign in to comment");return}const{error:v}=await T.from("marketplace_post_comments").insert({post_id:r,user_id:m.id,comment_text:i.trim()});if(v)throw v;o(""),h()}catch(m){console.error("Error posting comment:",m),H.error("Failed to post comment")}finally{d(!1)}};return s.jsx(Ca,{open:e,onOpenChange:t,children:s.jsxs(oa,{className:"max-w-md",children:[s.jsx(Ea,{children:s.jsx(ka,{children:"Comments"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(yl,{className:"h-[400px] pr-4",children:l?s.jsx("div",{className:"flex justify-center py-8",children:s.jsx(Er,{className:"h-6 w-6 animate-spin text-primary"})}):n.length===0?s.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No comments yet. Be the first to comment!"}):s.jsx("div",{className:"space-y-4",children:n.map(p=>{var g,x,y,b;const m=((g=p.provider_profiles)==null?void 0:g.username)||((x=p.profiles)==null?void 0:x.full_name)||"Unknown User",v=((y=p.provider_profiles)==null?void 0:y.avatar_url)||((b=p.profiles)==null?void 0:b.avatar_url);return s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(Yi,{className:"h-8 w-8",children:[s.jsx(Xi,{src:v}),s.jsx(Qi,{children:m[0]})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("span",{className:"font-semibold text-sm",children:m}),s.jsx("span",{className:"text-xs text-muted-foreground",children:SI(new Date(p.created_at),{addSuffix:!0})})]}),s.jsx("p",{className:"text-sm mt-1",children:p.comment_text})]})]},p.id)})})}),s.jsxs("form",{onSubmit:f,className:"flex gap-2",children:[s.jsx(De,{placeholder:"Add a comment...",value:i,onChange:p=>o(p.target.value),disabled:u}),s.jsx(L,{type:"submit",size:"icon",disabled:u||!i.trim(),children:u?s.jsx(Er,{className:"h-4 w-4 animate-spin"}):s.jsx(Nx,{className:"h-4 w-4"})})]})]})]})})},AXe=({post:e,onUpdate:t})=>{var N,j;const[r,n]=w.useState(!1),[a,i]=w.useState(e.likes_count||0),[o,l]=w.useState(!1),[c,u]=w.useState(!1),[d,h]=w.useState(0),[f,p]=w.useState(null),m=Array.isArray(e.media_urls)?e.media_urls:[],v=e.provider_profiles,g=(v==null?void 0:v.username)||((N=e.profiles)==null?void 0:N.full_name)||"Unknown User",x=(v==null?void 0:v.avatar_url)||((j=e.profiles)==null?void 0:j.avatar_url);v==null||v.is_verified,w.useEffect(()=>{(async()=>{try{const{data:S}=await T.from("vai_verifications").select("vai_number").eq("user_id",e.user_id).maybeSingle();p(S)}catch(S){console.error("Error loading V.A.I. status:",S)}})()},[e.user_id]);const y=async()=>{try{const{data:{user:_}}=await T.auth.getUser();if(!_){H.error("Please sign in to like posts");return}r?(await T.from("marketplace_post_likes").delete().match({post_id:e.id,user_id:_.id}),i(S=>Math.max(0,S-1))):(await T.from("marketplace_post_likes").insert({post_id:e.id,user_id:_.id}),i(S=>S+1)),n(!r)}catch(_){console.error("Error toggling like:",_),H.error("Failed to update like")}},b=()=>e.boost_type==="spotlight"?s.jsx(xe,{className:"bg-gradient-to-r from-purple-500 to-blue-500 text-white animate-pulse",children:" Spotlight"}):e.boost_type==="premium"?s.jsx(xe,{className:"bg-gradient-to-r from-yellow-500 to-amber-500 text-white",children:" Featured"}):e.boost_type==="standard"?s.jsx(xe,{variant:"secondary",children:"Promoted"}):null;return s.jsxs(s.Fragment,{children:[s.jsxs(q,{className:"overflow-hidden",children:[s.jsxs("div",{className:"p-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Yi,{children:[s.jsx(Xi,{src:x}),s.jsx(Qi,{children:g[0]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-semibold",children:g}),f&&s.jsx(uy,{isVerified:!0,vaiNumber:f.vai_number,size:"sm",showNumber:!1})]}),s.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[s.jsx("span",{children:SI(new Date(e.created_at),{addSuffix:!0})}),(e.location_city||e.location_state)&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(hn,{className:"h-3 w-3"}),e.location_city,e.location_city&&e.location_state&&", ",e.location_state]})]})]})]})]}),b()]}),m.length>0&&s.jsxs("div",{className:"relative aspect-square bg-muted",children:[s.jsx("img",{src:m[d],alt:"Post media",className:"w-full h-full object-cover cursor-pointer",onClick:()=>l(!0)}),m.length>1&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1",children:m.map((_,S)=>s.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition-colors ${S===d?"bg-white":"bg-white/50"}`},S))}),d>0&&s.jsx("button",{onClick:_=>{_.stopPropagation(),h(S=>S-1)},className:"absolute left-2 top-1/2 -translate-y-1/2 bg-black/50 text-white rounded-full p-2 hover:bg-black/70",children:""}),d<m.length-1&&s.jsx("button",{onClick:_=>{_.stopPropagation(),h(S=>S+1)},className:"absolute right-2 top-1/2 -translate-y-1/2 bg-black/50 text-white rounded-full p-2 hover:bg-black/70",children:""})]})]}),s.jsxs("div",{className:"px-4 py-3 flex items-center gap-4 border-t",children:[s.jsxs(L,{variant:"ghost",size:"sm",className:"gap-2",onClick:y,children:[s.jsx(PC,{className:`h-5 w-5 ${r?"fill-red-500 text-red-500":""}`}),s.jsx("span",{children:a})]}),s.jsxs(L,{variant:"ghost",size:"sm",className:"gap-2",onClick:()=>u(!0),children:[s.jsx(sj,{className:"h-5 w-5"}),s.jsx("span",{children:e.comments_count||0})]}),e.available_now&&s.jsxs(xe,{variant:"secondary",className:"ml-auto",children:[s.jsx(Yn,{className:"h-3 w-3 mr-1"}),"Available Now"]})]}),e.caption&&s.jsx("div",{className:"px-4 pb-3",children:s.jsxs("p",{className:"text-sm",children:[s.jsx("span",{className:"font-semibold mr-2",children:g}),e.caption]})}),s.jsxs("div",{className:"px-4 pb-4 flex items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[s.jsx(hr,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),s.jsx(hr,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),s.jsx(hr,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),s.jsx(hr,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),s.jsx(hr,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),s.jsx("span",{className:"ml-1",children:"(0)"})]}),s.jsx(L,{size:"sm",className:"w-full max-w-[200px]",children:"Book Appointment"})]})]}),s.jsx(EXe,{open:o,onOpenChange:l,mediaUrls:m,initialIndex:d}),s.jsx(kXe,{open:c,onOpenChange:u,postId:e.id})]})},PXe=({open:e,onOpenChange:t,onPostCreated:r})=>{const[n,a]=w.useState(""),[i,o]=w.useState(""),[l,c]=w.useState(""),[u,d]=w.useState(!1),[h,f]=w.useState([]),[p,m]=w.useState([]),[v,g]=w.useState("none"),[x,y]=w.useState(!1),[b,N]=w.useState(0);w.useEffect(()=>{e&&j()},[e]);const j=async()=>{try{const{data:{user:P}}=await T.auth.getUser();if(!P)return;const{data:A,error:O}=await T.from("golden_roses_balance").select("balance").eq("user_id",P.id).single();if(O&&O.code!=="PGRST116")throw O;A?N(A.balance):(await T.from("golden_roses_balance").insert({user_id:P.id,balance:1e3}),N(1e3))}catch(P){console.error("Error loading golden roses:",P)}},_=P=>{const A=Array.from(P.target.files||[]);if(h.length+A.length>5){H.error("Maximum 5 media files allowed");return}f(O=>[...O,...A]),A.forEach(O=>{const I=new FileReader;I.onloadend=()=>{m(R=>[...R,I.result])},I.readAsDataURL(O)})},S=P=>{f(A=>A.filter((O,I)=>I!==P)),m(A=>A.filter((O,I)=>I!==P))},C=async P=>{const A=[];for(const O of h){const I=O.name.split(".").pop(),R=`${P}/${Date.now()}-${Math.random()}.${I}`,{error:M,data:B}=await T.storage.from("marketplace_media").upload(R,O);if(M)throw M;const{data:{publicUrl:$}}=T.storage.from("marketplace_media").getPublicUrl(R);A.push($)}return A},E=async()=>{try{y(!0);const{data:{user:P}}=await T.auth.getUser();if(!P){H.error("Please sign in to create a post");return}if(h.length===0){H.error("Please add at least one photo");return}const A=await C(P.id),I={none:0,standard:50,premium:100,spotlight:200}[v];if(I>b){H.error("Insufficient Golden Roses");return}const{error:R}=await T.from("marketplace_posts").insert({user_id:P.id,caption:n,location_city:i||null,location_state:l||null,media_urls:A,available_now:u,boost_type:v,boost_expires_at:v!=="none"?new Date(Date.now()+(v==="spotlight"?7*24*60*60*1e3:v==="premium"?48*60*60*1e3:24*60*60*1e3)).toISOString():null});if(R)throw R;I>0&&await T.from("golden_roses_balance").update({balance:b-I}).eq("user_id",P.id),H.success("Post created successfully!"),k(),r()}catch(P){console.error("Error creating post:",P),H.error("Failed to create post")}finally{y(!1)}},k=()=>{a(""),o(""),c(""),d(!1),f([]),m([]),g("none")};return s.jsx(Ca,{open:e,onOpenChange:t,children:s.jsxs(oa,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx(Ea,{children:s.jsx(ka,{children:"Create Post"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(de,{children:"Photos/Videos (up to 5)"}),s.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2",children:[p.map((P,A)=>s.jsxs("div",{className:"relative aspect-square",children:[s.jsx("img",{src:P,alt:`Preview ${A+1}`,className:"w-full h-full object-cover rounded-lg"}),s.jsx("button",{onClick:()=>S(A),className:"absolute top-1 right-1 bg-black/50 text-white rounded-full p-1 hover:bg-black/70",children:s.jsx(vn,{className:"h-4 w-4"})})]},A)),h.length<5&&s.jsxs("label",{className:"aspect-square border-2 border-dashed rounded-lg flex items-center justify-center cursor-pointer hover:border-primary transition-colors",children:[s.jsx("input",{type:"file",accept:"image/*,video/*",multiple:!0,className:"hidden",onChange:_}),s.jsx(lj,{className:"h-8 w-8 text-muted-foreground"})]})]})]}),s.jsxs("div",{children:[s.jsx(de,{children:"Caption"}),s.jsx(Mn,{placeholder:"Write a caption...",value:n,onChange:P=>a(P.target.value.slice(0,500)),className:"resize-none",rows:3}),s.jsxs("div",{className:"text-xs text-muted-foreground text-right mt-1",children:[n.length,"/500"]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(de,{children:"City"}),s.jsx(De,{placeholder:"City",value:i,onChange:P=>o(P.target.value)})]}),s.jsxs("div",{children:[s.jsx(de,{children:"State"}),s.jsx(De,{placeholder:"State",value:l,onChange:P=>c(P.target.value)})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Al,{id:"available",checked:u,onCheckedChange:P=>d(P)}),s.jsx("label",{htmlFor:"available",className:"text-sm cursor-pointer",children:"Available Now"})]}),s.jsxs("div",{children:[s.jsx(de,{children:"Boost Options"}),s.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Golden Roses:  ",b]}),s.jsxs(nm,{value:v,onValueChange:g,children:[s.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg",children:[s.jsx(Ts,{value:"none",id:"none"}),s.jsxs(de,{htmlFor:"none",className:"flex-1 cursor-pointer",children:[s.jsx("div",{className:"font-medium",children:"No Boost"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"Free"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg",children:[s.jsx(Ts,{value:"standard",id:"standard"}),s.jsxs(de,{htmlFor:"standard",className:"flex-1 cursor-pointer",children:[s.jsx("div",{className:"font-medium",children:"Standard Boost"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"50   24 hours"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg",children:[s.jsx(Ts,{value:"premium",id:"premium"}),s.jsxs(de,{htmlFor:"premium",className:"flex-1 cursor-pointer",children:[s.jsx("div",{className:"font-medium",children:"Premium Boost "}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"100   48 hours"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg",children:[s.jsx(Ts,{value:"spotlight",id:"spotlight"}),s.jsxs(de,{htmlFor:"spotlight",className:"flex-1 cursor-pointer",children:[s.jsx("div",{className:"font-medium",children:"Spotlight Boost "}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"200   7 days"})]})]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(L,{variant:"outline",onClick:()=>t(!1),disabled:x,className:"flex-1",children:"Cancel"}),s.jsx(L,{onClick:E,disabled:x||h.length===0,className:"flex-1",children:x?s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"h-4 w-4 mr-2 animate-spin"}),"Posting..."]}):"Post"})]})]})]})})};function TXe(){const[e,t]=w.useState([]),[r,n]=w.useState(!0),[a,i]=w.useState(!0),[o,l]=w.useState("for-you"),[c,u]=w.useState(!1),[d,h]=w.useState(!1),[f,p]=w.useState(0),m=10,{ref:v,inView:g}=CXe({threshold:0});w.useEffect(()=>{x()},[o]),w.useEffect(()=>{g&&a&&!r&&b()},[g]);const x=async()=>{try{n(!0),t([]),p(0),await y(0)}catch(j){console.error("Error loading posts:",j),H.error("Failed to load posts")}finally{n(!1)}},y=async j=>{let _=T.from("marketplace_posts").select(`
        *,
        profiles:user_id (
          full_name,
          avatar_url
        ),
        provider_profiles:user_id (
          username,
          is_verified,
          avatar_url
        )
      `).order("created_at",{ascending:!1}).range(j*m,(j+1)*m-1);const{data:S,error:C}=await _;if(C)throw C;S&&(S.length<m&&i(!1),t(E=>j===0?S:[...E,...S]))},b=async()=>{const j=f+1;p(j),await y(j)},N=()=>{x(),u(!1)};return s.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[s.jsx("div",{className:"sticky top-0 z-10 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b",children:s.jsxs("div",{className:"container max-w-2xl mx-auto px-4 py-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Marketplace"}),s.jsxs(L,{variant:"outline",size:"sm",onClick:()=>h(!0),className:"gap-2",children:[s.jsx(kd,{className:"h-4 w-4 text-yellow-500"}),"Get Roses"]})]}),s.jsx(Ga,{value:o,onValueChange:j=>l(j),children:s.jsxs(Aa,{className:"w-full grid grid-cols-3",children:[s.jsx(mt,{value:"for-you",children:"For You"}),s.jsx(mt,{value:"following",children:"Following"}),s.jsx(mt,{value:"local",children:"Local"})]})})]})}),s.jsx("div",{className:"container max-w-2xl mx-auto px-4 py-4 space-y-4",children:r&&e.length===0?s.jsx("div",{className:"space-y-4",children:[...Array(3)].map((j,_)=>s.jsxs("div",{className:"bg-card rounded-xl p-4 animate-pulse",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-muted"}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("div",{className:"h-4 bg-muted rounded w-1/3"}),s.jsx("div",{className:"h-3 bg-muted rounded w-1/4"})]})]}),s.jsx("div",{className:"h-64 bg-muted rounded-lg mb-4"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"h-4 bg-muted rounded w-full"}),s.jsx("div",{className:"h-4 bg-muted rounded w-2/3"})]})]},_))}):s.jsxs(s.Fragment,{children:[e.map(j=>s.jsx(AXe,{post:j,onUpdate:x},j.id)),a&&s.jsx("div",{ref:v,className:"py-4 text-center",children:s.jsx("div",{className:"inline-block w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"})}),!a&&e.length>0&&s.jsx("p",{className:"text-center text-muted-foreground py-8",children:"You've reached the end of the feed"}),e.length===0&&!r&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx("p",{className:"text-muted-foreground mb-4",children:"No posts yet"}),s.jsxs(L,{onClick:()=>u(!0),children:[s.jsx(Ms,{className:"h-4 w-4 mr-2"}),"Create First Post"]})]})]})}),s.jsx(L,{size:"lg",className:"fixed bottom-20 right-4 rounded-full w-14 h-14 shadow-lg animate-pulse hover:animate-none z-20",onClick:()=>u(!0),children:s.jsx(Ms,{className:"h-6 w-6"})}),s.jsx(PXe,{open:c,onOpenChange:u,onPostCreated:N}),s.jsx(kJ,{open:d,onOpenChange:h,onPurchaseComplete:x})]})}function RXe({selectedDate:e,onDateSelect:t}){const[r,n]=w.useState(new Date),{data:a}=Rd({queryKey:["appointments",Mr(r,"yyyy-MM")],queryFn:async()=>{const{data:{user:h}}=await T.auth.getUser();if(!h)return[];const f=eB(r),p=xA(r),{data:m,error:v}=await T.from("appointments").select("*").or(`provider_id.eq.${h.id},client_id.eq.${h.id}`).gte("start_time",f.toISOString()).lte("start_time",p.toISOString()).order("start_time");if(v)throw v;return m||[]}}),i=eB(r),o=xA(r),l=Ep(i),c=FWe(o),u=MWe({start:l,end:c}),d=h=>(a==null?void 0:a.filter(f=>yS(new Date(f.start_time),h)))||[];return s.jsxs(q,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold",children:Mr(r,"MMMM yyyy")}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(L,{variant:"outline",size:"icon",onClick:()=>n(Bqe(r,1)),children:s.jsx(Xd,{className:"h-4 w-4"})}),s.jsx(L,{variant:"outline",onClick:()=>n(new Date),children:"Today"}),s.jsx(L,{variant:"outline",size:"icon",onClick:()=>n(fQ(r,1)),children:s.jsx(Wp,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(h=>s.jsx("div",{className:"text-center text-sm font-medium text-muted-foreground py-2",children:h},h)),u.map(h=>{const f=d(h),p=Fqe(h,r),m=yS(h,e),v=yS(h,new Date);return s.jsxs("button",{onClick:()=>t(h),className:me("min-h-[100px] p-2 rounded-lg border transition-colors text-left relative",!p&&"text-muted-foreground bg-muted/30",m&&"border-primary bg-primary/5",v&&"border-primary","hover:bg-accent"),children:[s.jsx("div",{className:"font-medium text-sm mb-1",children:Mr(h,"d")}),s.jsxs("div",{className:"space-y-1",children:[f.slice(0,3).map((g,x)=>s.jsx("div",{className:me("text-xs px-1 py-0.5 rounded truncate",g.status==="confirmed"&&"bg-green-500/20 text-green-700 dark:text-green-300",g.status==="pending"&&"bg-yellow-500/20 text-yellow-700 dark:text-yellow-300",g.status==="cancelled"&&"bg-red-500/20 text-red-700 dark:text-red-300"),children:Mr(new Date(g.start_time),"h:mm a")},g.id)),f.length>3&&s.jsxs("div",{className:"text-xs text-muted-foreground",children:["+",f.length-3," more"]})]})]},h.toISOString())})]})]})}function OXe(){const{data:e,isLoading:t}=Rd({queryKey:["appointments-list"],queryFn:async()=>{const{data:{user:r}}=await T.auth.getUser();if(!r)return[];const{data:n,error:a}=await T.from("appointments").select(`
          *,
          provider:provider_id(full_name, avatar_url),
          client:client_id(full_name, avatar_url)
        `).or(`provider_id.eq.${r.id},client_id.eq.${r.id}`).gte("start_time",new Date().toISOString()).order("start_time");if(a)throw a;return n||[]}});return t?s.jsx("div",{className:"space-y-4",children:[1,2,3].map(r=>s.jsx(q,{className:"p-6",children:s.jsx(rd,{className:"h-24 w-full"})},r))}):e!=null&&e.length?s.jsx("div",{className:"space-y-4",children:e.map(r=>{var n,a;return s.jsxs(q,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:s.jsx(fn,{className:"h-6 w-6 text-primary"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:r.appointment_type||"Appointment"}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["with ",((n=r.provider)==null?void 0:n.full_name)||((a=r.client)==null?void 0:a.full_name)]})]})]}),s.jsx(xe,{variant:r.status==="confirmed"?"default":r.status==="pending"?"secondary":"destructive",children:r.status})]}),s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Yn,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{children:Mr(new Date(r.start_time),"EEEE, MMMM d, yyyy")})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(On,{className:"h-4 w-4 text-muted-foreground"}),s.jsxs("span",{children:[Mr(new Date(r.start_time),"h:mm a")," -",Mr(new Date(r.end_time),"h:mm a")]})]}),r.location&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(hn,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{children:r.location})]})]}),r.notes&&s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:r.notes}),s.jsxs("div",{className:"flex gap-2",children:[r.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsx(L,{variant:"default",size:"sm",children:"Confirm"}),s.jsx(L,{variant:"outline",size:"sm",children:"Reschedule"}),s.jsx(L,{variant:"ghost",size:"sm",children:"Cancel"})]}),r.status==="confirmed"&&s.jsx(L,{variant:"outline",size:"sm",children:"View Details"})]})]},r.id)})}):s.jsxs(q,{className:"p-12 text-center",children:[s.jsx(Yn,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Upcoming Appointments"}),s.jsx("p",{className:"text-muted-foreground",children:"You don't have any scheduled appointments yet."})]})}const ZB=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function IXe(){const{toast:e}=Et(),t=Cx(),[r,n]=w.useState(!1),[a,i]=w.useState(""),[o,l]=w.useState([]),{data:c}=Rd({queryKey:["schedule-templates"],queryFn:async()=>{const{data:{user:p}}=await T.auth.getUser();if(!p)return[];const{data:m,error:v}=await T.from("schedule_templates").select(`
          *,
          schedule_time_slots(*)
        `).eq("user_id",p.id).order("created_at",{ascending:!1});if(v)throw v;return m||[]}}),u=hg({mutationFn:async()=>{const{data:{user:p}}=await T.auth.getUser();if(!p)throw new Error("Not authenticated");const{data:m,error:v}=await T.from("schedule_templates").insert({user_id:p.id,template_name:a,is_active:!1}).select().single();if(v)throw v;if(o.length>0){const{error:g}=await T.from("schedule_time_slots").insert(o.map(x=>({template_id:m.id,day_of_week:x.day,start_time:x.start,end_time:x.end})));if(g)throw g}return m},onSuccess:()=>{t.invalidateQueries({queryKey:["schedule-templates"]}),n(!1),i(""),l([]),e({title:"Template created",description:"Your schedule template has been created successfully."})}}),d=hg({mutationFn:async({id:p,isActive:m})=>{const{error:v}=await T.from("schedule_templates").update({is_active:!m}).eq("id",p);if(v)throw v},onSuccess:()=>{t.invalidateQueries({queryKey:["schedule-templates"]})}}),h=()=>{l([...o,{day:1,start:"09:00",end:"17:00"}])},f=p=>{l(o.filter((m,v)=>v!==p))};return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Schedule Templates"}),s.jsxs(Ca,{open:r,onOpenChange:n,children:[s.jsx(Xj,{asChild:!0,children:s.jsxs(L,{children:[s.jsx(Ms,{className:"h-4 w-4 mr-2"}),"New Template"]})}),s.jsxs(oa,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[s.jsx(Ea,{children:s.jsx(ka,{children:"Create Schedule Template"})}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{children:[s.jsx(de,{htmlFor:"template-name",children:"Template Name"}),s.jsx(De,{id:"template-name",value:a,onChange:p=>i(p.target.value),placeholder:"e.g., Weekday Schedule"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx(de,{children:"Time Slots"}),s.jsxs(L,{type:"button",variant:"outline",size:"sm",onClick:h,children:[s.jsx(Ms,{className:"h-4 w-4 mr-2"}),"Add Slot"]})]}),o.map((p,m)=>s.jsx(q,{className:"p-4",children:s.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[s.jsxs("div",{children:[s.jsx(de,{children:"Day"}),s.jsx("select",{className:"w-full rounded-md border border-input bg-background px-3 py-2",value:p.day,onChange:v=>{const g=[...o];g[m].day=parseInt(v.target.value),l(g)},children:ZB.map((v,g)=>s.jsx("option",{value:g,children:v},g))})]}),s.jsxs("div",{children:[s.jsx(de,{children:"Start Time"}),s.jsx(De,{type:"time",value:p.start,onChange:v=>{const g=[...o];g[m].start=v.target.value,l(g)}})]}),s.jsxs("div",{children:[s.jsx(de,{children:"End Time"}),s.jsx(De,{type:"time",value:p.end,onChange:v=>{const g=[...o];g[m].end=v.target.value,l(g)}})]}),s.jsx("div",{className:"flex items-end",children:s.jsx(L,{type:"button",variant:"ghost",size:"icon",onClick:()=>f(m),children:s.jsx(Qc,{className:"h-4 w-4"})})})]})},m))]}),s.jsx(L,{onClick:()=>u.mutate(),disabled:!a||u.isPending,className:"w-full",children:"Create Template"})]})]})]})]}),s.jsx("div",{className:"grid gap-4",children:c==null?void 0:c.map(p=>{var m;return s.jsxs(q,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:p.template_name}),s.jsx(Yt,{checked:p.is_active,onCheckedChange:()=>d.mutate({id:p.id,isActive:p.is_active})})]}),s.jsx("div",{className:"space-y-2",children:(m=p.schedule_time_slots)==null?void 0:m.map(v=>s.jsxs("div",{className:"text-sm text-muted-foreground",children:[ZB[v.day_of_week],": ",v.start_time," - ",v.end_time]},v.id))})]},p.id)})})]})}function DXe(){const{toast:e}=Et(),t=Cx(),{data:r,isLoading:n}=Rd({queryKey:["calendar-settings"],queryFn:async()=>{const{data:{user:l}}=await T.auth.getUser();if(!l)return null;const{data:c,error:u}=await T.from("calendar_settings").select("*").eq("user_id",l.id).maybeSingle();if(u&&u.code!=="PGRST116")throw u;return c}}),a=hg({mutationFn:async l=>{const{data:{user:c}}=await T.auth.getUser();if(!c)throw new Error("Not authenticated");const{error:u}=await T.from("calendar_settings").upsert({user_id:c.id,...l});if(u)throw u},onSuccess:()=>{t.invalidateQueries({queryKey:["calendar-settings"]}),e({title:"Settings saved",description:"Your calendar settings have been updated."})}});if(n)return s.jsx(q,{className:"p-6",children:s.jsx(rd,{className:"h-96 w-full"})});const o=r||{advance_notice_hours:24,max_advance_days:90,allow_same_day_booking:!1,buffer_time_minutes:0,min_appointment_duration_minutes:60,max_appointment_duration_minutes:480,auto_confirm_appointments:!1,cancellation_notice_hours:24};return s.jsxs(q,{className:"p-6",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Calendar Settings"}),s.jsxs("form",{onSubmit:l=>{l.preventDefault();const c=new FormData(l.currentTarget),u={advance_notice_hours:parseInt(c.get("advance_notice_hours")),max_advance_days:parseInt(c.get("max_advance_days")),allow_same_day_booking:c.get("allow_same_day_booking")==="on",buffer_time_minutes:parseInt(c.get("buffer_time_minutes")),min_appointment_duration_minutes:parseInt(c.get("min_appointment_duration_minutes")),max_appointment_duration_minutes:parseInt(c.get("max_appointment_duration_minutes")),auto_confirm_appointments:c.get("auto_confirm_appointments")==="on",cancellation_notice_hours:parseInt(c.get("cancellation_notice_hours"))};a.mutate(u)},className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(de,{htmlFor:"advance_notice_hours",children:"Advance Notice Required (hours)"}),s.jsx(De,{id:"advance_notice_hours",name:"advance_notice_hours",type:"number",defaultValue:o.advance_notice_hours,min:"0"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Minimum time required before an appointment can be booked"})]}),s.jsxs("div",{children:[s.jsx(de,{htmlFor:"max_advance_days",children:"Maximum Advance Booking (days)"}),s.jsx(De,{id:"max_advance_days",name:"max_advance_days",type:"number",defaultValue:o.max_advance_days,min:"1"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"How far in advance clients can book appointments"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(de,{htmlFor:"allow_same_day_booking",children:"Allow Same-Day Booking"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Let clients book appointments for today"})]}),s.jsx(Yt,{id:"allow_same_day_booking",name:"allow_same_day_booking",defaultChecked:o.allow_same_day_booking})]}),s.jsxs("div",{children:[s.jsx(de,{htmlFor:"buffer_time_minutes",children:"Buffer Time Between Appointments (minutes)"}),s.jsx(De,{id:"buffer_time_minutes",name:"buffer_time_minutes",type:"number",defaultValue:o.buffer_time_minutes,min:"0",step:"15"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Gap automatically added between appointments"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(de,{htmlFor:"min_appointment_duration_minutes",children:"Min Duration (minutes)"}),s.jsx(De,{id:"min_appointment_duration_minutes",name:"min_appointment_duration_minutes",type:"number",defaultValue:o.min_appointment_duration_minutes,min:"15",step:"15"})]}),s.jsxs("div",{children:[s.jsx(de,{htmlFor:"max_appointment_duration_minutes",children:"Max Duration (minutes)"}),s.jsx(De,{id:"max_appointment_duration_minutes",name:"max_appointment_duration_minutes",type:"number",defaultValue:o.max_appointment_duration_minutes,min:"15",step:"15"})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(de,{htmlFor:"auto_confirm_appointments",children:"Auto-Confirm Appointments"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically confirm bookings without manual approval"})]}),s.jsx(Yt,{id:"auto_confirm_appointments",name:"auto_confirm_appointments",defaultChecked:o.auto_confirm_appointments})]}),s.jsxs("div",{children:[s.jsx(de,{htmlFor:"cancellation_notice_hours",children:"Cancellation Notice (hours)"}),s.jsx(De,{id:"cancellation_notice_hours",name:"cancellation_notice_hours",type:"number",defaultValue:o.cancellation_notice_hours,min:"0"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Minimum notice required for cancellations"})]})]}),s.jsx(L,{type:"submit",disabled:a.isPending,children:"Save Settings"})]})]})}function MXe(){const e=Oe(),[t,r]=w.useState(new Date);return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("div",{className:"sticky top-0 z-10 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-border",children:s.jsx("div",{className:"container mx-auto px-4 py-4",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e(-1),children:s.jsx(Xd,{className:"h-5 w-5"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Yn,{className:"h-6 w-6 text-primary"}),s.jsx("h1",{className:"text-2xl font-bold",children:"Calendar"})]})]})})})}),s.jsx("div",{className:"container mx-auto px-4 py-6",children:s.jsxs(Ga,{defaultValue:"calendar",className:"space-y-6",children:[s.jsxs(Aa,{className:"grid w-full grid-cols-4",children:[s.jsx(mt,{value:"calendar",children:"Calendar"}),s.jsx(mt,{value:"appointments",children:"Appointments"}),s.jsx(mt,{value:"schedule",children:"Schedule"}),s.jsx(mt,{value:"settings",children:"Settings"})]}),s.jsx(Rt,{value:"calendar",className:"space-y-4",children:s.jsx(RXe,{selectedDate:t,onDateSelect:r})}),s.jsx(Rt,{value:"appointments",children:s.jsx(OXe,{})}),s.jsx(Rt,{value:"schedule",children:s.jsx(IXe,{})}),s.jsx(Rt,{value:"settings",children:s.jsx(DXe,{})})]})})]})}const $Xe=e=>{const[t,r]=w.useState({isVerified:!1,loading:!0});w.useEffect(()=>{n()},[e]);const n=async()=>{var a;try{const i=e||((a=(await T.auth.getUser()).data.user)==null?void 0:a.id);if(!i){r({isVerified:!1,loading:!1});return}const{data:o}=await T.from("vai_verifications").select("vai_number, created_at").eq("user_id",i).single();r({isVerified:!!o,vaiNumber:o==null?void 0:o.vai_number,verifiedAt:o==null?void 0:o.created_at,loading:!1})}catch(i){console.error("Error loading V.A.I. status:",i),r({isVerified:!1,loading:!1})}};return{...t,refresh:n}},FXe=()=>{const e=Oe(),[t,r]=w.useState(!0),[n,a]=w.useState(!1),[i,o]=w.useState(""),[l,c]=w.useState(""),[u,d]=w.useState([]),[h,f]=w.useState(""),[p,m]=w.useState(""),[v,g]=w.useState([]),[x,y]=w.useState([]),b=$Xe();w.useEffect(()=>{N()},[]);const N=async()=>{try{const{data:{user:A}}=await T.auth.getUser();if(!A){e("/login");return}o(A.id),await Promise.all([j(A.id),_(A.id)])}catch(A){console.error("Error loading user data:",A),H.error("Failed to load profile data")}finally{r(!1)}},j=async A=>{const{data:O}=await T.from("profiles").select("*").eq("id",A).single();O&&(c(O.bio||""),d(O.profile_links||[]))},_=async A=>{const O=new Date().toISOString(),{data:I}=await T.from("appointments").select("*").eq("client_id",A).gte("start_time",O).in("status",["pending","confirmed"]).order("start_time",{ascending:!0}),{data:R}=await T.from("appointments").select("*").eq("client_id",A).lt("start_time",O).order("start_time",{ascending:!1}).limit(10);if(I&&I.length>0){const M=[...new Set(I.map(D=>D.provider_id))],{data:B}=await T.from("profiles").select("id, full_name, avatar_url").in("id",M),$=I.map(D=>({...D,provider:B==null?void 0:B.find(W=>W.id===D.provider_id)}));g($)}else g([]);if(R&&R.length>0){const M=[...new Set(R.map(D=>D.provider_id))],{data:B}=await T.from("profiles").select("id, full_name, avatar_url").in("id",M),$=R.map(D=>({...D,provider:B==null?void 0:B.find(W=>W.id===D.provider_id)}));y($)}else y([])},S=async()=>{if(i){a(!0);try{const{error:A}=await T.from("profiles").update({bio:l,profile_links:u,updated_at:new Date().toISOString()}).eq("id",i);if(A)throw A;H.success("Profile updated successfully")}catch(A){console.error("Error saving profile:",A),H.error("Failed to save profile")}finally{a(!1)}}},C=()=>{if(!h.trim()||!p.trim()){H.error("Please enter both title and URL");return}const A={id:crypto.randomUUID(),title:h.trim(),url:p.trim(),order:u.length};d([...u,A]),f(""),m("")},E=A=>{d(u.filter(O=>O.id!==A))},k=async A=>{try{const{data:O}=await T.from("conversations").select("id").or(`and(participant_1_id.eq.${i},participant_2_id.eq.${A}),and(participant_1_id.eq.${A},participant_2_id.eq.${i})`).single();if(O){e(`/chat?conversation=${O.id}`);return}const{data:I,error:R}=await T.from("conversations").insert({participant_1_id:i,participant_2_id:A}).select().single();if(R)throw R;e(`/chat?conversation=${I.id}`)}catch(O){console.error("Error starting conversation:",O),H.error("Failed to start conversation")}},P=({apt:A,isPast:O=!1})=>{var I,R;return s.jsx(q,{className:"hover:shadow-md transition-shadow",children:s.jsx(ee,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsxs(Yi,{className:"h-12 w-12",children:[s.jsx(Xi,{src:(I=A.provider)==null?void 0:I.avatar_url}),s.jsx(Qi,{children:s.jsx(fn,{className:"h-6 w-6"})})]}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:((R=A.provider)==null?void 0:R.full_name)||"Provider"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:A.appointment_type})]}),s.jsx(xe,{variant:A.status==="confirmed"?"default":"secondary",children:A.status})]}),s.jsxs("div",{className:"space-y-1 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[s.jsx(Yn,{className:"h-4 w-4"}),s.jsx("span",{children:Mr(new Date(A.start_time),"MMM d, yyyy")})]}),s.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[s.jsx(On,{className:"h-4 w-4"}),s.jsxs("span",{children:[Mr(new Date(A.start_time),"h:mm a")," - ",Mr(new Date(A.end_time),"h:mm a")]})]}),A.location&&s.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[s.jsx(hn,{className:"h-4 w-4"}),s.jsx("span",{children:A.location})]})]}),A.notes&&s.jsx("p",{className:"text-sm text-muted-foreground italic",children:A.notes}),s.jsxs(L,{variant:"outline",size:"sm",className:"w-full mt-2",onClick:()=>k(A.provider_id),children:[s.jsx(Ed,{className:"h-4 w-4 mr-2"}),"Message Provider"]})]})]})})})};return t?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading profile..."})]})}):s.jsx("div",{className:"min-h-screen bg-background pb-20",children:s.jsxs("div",{className:"container max-w-4xl mx-auto p-4 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"My Profile"}),s.jsx("div",{className:"mt-2",children:s.jsx(uy,{isVerified:b.isVerified,vaiNumber:b.vaiNumber,size:"sm"})})]}),s.jsxs("div",{className:"flex gap-2",children:[b.isVerified&&s.jsxs(L,{variant:"outline",size:"sm",onClick:()=>e("/vai-management"),children:[s.jsx(lt,{className:"w-4 h-4 mr-2"}),"Manage V.A.I."]}),s.jsx(L,{onClick:()=>e("/settings"),children:"Settings"})]})]}),s.jsxs(Ga,{defaultValue:"customize",className:"w-full",children:[s.jsxs(Aa,{className:"grid w-full grid-cols-3",children:[s.jsx(mt,{value:"customize",children:"Customize"}),s.jsx(mt,{value:"appointments",children:"Appointments"}),s.jsx(mt,{value:"history",children:"History"})]}),s.jsx(Rt,{value:"customize",className:"space-y-6",children:s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Profile Customization"}),s.jsx(Re,{children:"Create your personalized profile page like Linktree"})]}),s.jsxs(ee,{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Bio"}),s.jsx(Mn,{placeholder:"Tell others about yourself...",value:l,onChange:A=>c(A.target.value),rows:4})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("label",{className:"text-sm font-medium",children:"Profile Links"}),u.map(A=>s.jsxs("div",{className:"flex items-center gap-2 p-3 border rounded-lg bg-muted/50",children:[s.jsx(uae,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium truncate",children:A.title}),s.jsx("p",{className:"text-sm text-muted-foreground truncate",children:A.url})]}),s.jsx(L,{variant:"ghost",size:"sm",onClick:()=>E(A.id),children:s.jsx(vn,{className:"h-4 w-4"})})]},A.id)),s.jsx(q,{className:"border-dashed",children:s.jsxs(ee,{className:"p-4 space-y-3",children:[s.jsx(De,{placeholder:"Link title (e.g., Instagram)",value:h,onChange:A=>f(A.target.value)}),s.jsx(De,{placeholder:"URL (e.g., https://instagram.com/...)",value:p,onChange:A=>m(A.target.value)}),s.jsxs(L,{onClick:C,className:"w-full",variant:"secondary",children:[s.jsx(Ms,{className:"h-4 w-4 mr-2"}),"Add Link"]})]})})]}),s.jsxs(L,{onClick:S,disabled:n,className:"w-full",children:[s.jsx(yae,{className:"h-4 w-4 mr-2"}),n?"Saving...":"Save Profile"]})]})]})}),s.jsx(Rt,{value:"appointments",className:"space-y-4",children:s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Upcoming Appointments"}),s.jsxs(Re,{children:[v.length," pending appointment",v.length!==1?"s":""]})]}),s.jsx(ee,{className:"space-y-4",children:v.length===0?s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx(Yn,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"No upcoming appointments"})]}):v.map(A=>s.jsx(P,{apt:A},A.id))})]})}),s.jsx(Rt,{value:"history",className:"space-y-4",children:s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Appointment History"}),s.jsx(Re,{children:"Your past appointments"})]}),s.jsx(ee,{className:"space-y-4",children:x.length===0?s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx(sz,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"No appointment history"})]}):x.map(A=>s.jsx(P,{apt:A,isPast:!0},A.id))})]})})]})]})})},LXe=({vaiNumber:e,verifiedAt:t,biometricPhotoUrl:r,isVerified:n,onViewDetails:a,onStartVerification:i})=>s.jsxs(q,{className:"border-primary/20",children:[s.jsx(ge,{children:s.jsxs(be,{className:"flex items-center gap-2",children:[s.jsx(lt,{className:"w-5 h-5 text-primary"}),"V.A.I. Verification Status"]})}),s.jsxs(ee,{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsx(uy,{isVerified:n,vaiNumber:e,size:"lg"})}),n&&e?s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"V.A.I. Number"}),s.jsx("span",{className:"font-mono font-semibold",children:e})]}),t&&s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Verified On"}),s.jsx("span",{className:"text-sm",children:Mr(new Date(t),"MMM dd, yyyy")})]})]}),s.jsxs("div",{className:"flex items-start gap-2 p-3 bg-primary/10 rounded-lg",children:[s.jsx(ut,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("p",{className:"font-semibold",children:"Identity Verified"}),s.jsx("p",{className:"text-muted-foreground text-xs",children:"Your identity has been verified through secure biometric verification"})]})]}),a&&s.jsxs(L,{variant:"outline",className:"w-full",onClick:a,children:["View Full Details",s.jsx(ig,{className:"w-4 h-4 ml-2"})]})]}):s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:s.jsx("p",{className:"text-sm text-muted-foreground",children:"Complete V.A.I. verification to unlock premium features, build trust with the community, and access exclusive services."})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(ut,{className:"w-4 h-4 text-primary"}),s.jsx("span",{children:"Secure biometric verification"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(ut,{className:"w-4 h-4 text-primary"}),s.jsx("span",{children:"Anonymous identity protection"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(ut,{className:"w-4 h-4 text-primary"}),s.jsx("span",{children:"Verified badge on profile"})]})]}),i&&s.jsxs(L,{className:"w-full",onClick:i,children:[s.jsx(lt,{className:"w-4 h-4 mr-2"}),"Start V.A.I. Verification"]})]})]})]}),BXe=({events:e})=>{const t=n=>{switch(n){case"completed":return s.jsx(ut,{className:"w-4 h-4 text-green-500"});case"pending":return s.jsx(On,{className:"w-4 h-4 text-yellow-500"});case"failed":return s.jsx(Xs,{className:"w-4 h-4 text-red-500"});default:return s.jsx(On,{className:"w-4 h-4"})}},r=n=>{const a={completed:"default",pending:"secondary",failed:"destructive"};return s.jsx(xe,{variant:a[n]||"secondary",children:n})};return s.jsxs(q,{children:[s.jsx(ge,{children:s.jsxs(be,{className:"flex items-center gap-2",children:[s.jsx(Yn,{className:"w-5 h-5"}),"Verification History"]})}),s.jsx(ee,{children:s.jsx(yl,{className:"h-[400px] pr-4",children:s.jsx("div",{className:"space-y-4",children:e.length===0?s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx(lt,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),s.jsx("p",{children:"No verification history yet"})]}):e.map((n,a)=>s.jsxs("div",{className:"flex gap-4 pb-4 border-b last:border-0",children:[s.jsx("div",{className:"flex-shrink-0 mt-1",children:t(n.status)}),s.jsxs("div",{className:"flex-1 space-y-1",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"font-medium",children:n.description}),r(n.status)]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:Mr(new Date(n.timestamp),"MMM dd, yyyy 'at' h:mm a")})]})]},n.id))})})})]})},UXe=()=>{const e=Oe();Et();const[t,r]=w.useState(!0),[n,a]=w.useState(null),[i,o]=w.useState([]);w.useEffect(()=>{l()},[]);const l=async()=>{try{const{data:{user:u}}=await T.auth.getUser();if(!u)return;const{data:d}=await T.from("vai_verifications").select("*").eq("user_id",u.id).single();a(d),d&&o([{id:"1",type:"verification",status:"completed",timestamp:d.created_at,description:"V.A.I. verification completed successfully"}])}catch(u){console.error("Error loading V.A.I. data:",u)}finally{r(!1)}},c=()=>{const u=`${window.location.origin}/vai-callback`,d=`https://platform.chainpass.com/verify?redirect=${encodeURIComponent(u)}`;window.location.href=d};return t?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsx(ij,{className:"w-8 h-8 animate-spin text-primary"})}):s.jsxs("div",{className:"min-h-screen bg-gradient-hero",children:[s.jsx("div",{className:"bg-card/80 backdrop-blur-lg border-b border-white/10",children:s.jsx("div",{className:"container mx-auto px-4 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(L,{variant:"ghost",size:"sm",onClick:()=>e(-1),children:[s.jsx(ze,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(lt,{className:"w-6 h-6 text-primary"}),s.jsx("h1",{className:"text-xl font-bold",children:"V.A.I. Management"})]}),s.jsx("div",{className:"w-20"})]})})}),s.jsx("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:s.jsxs(Ga,{defaultValue:"overview",className:"space-y-6",children:[s.jsxs(Aa,{className:"grid w-full grid-cols-2",children:[s.jsx(mt,{value:"overview",children:"Overview"}),s.jsx(mt,{value:"history",children:"History"})]}),s.jsxs(Rt,{value:"overview",className:"space-y-6",children:[s.jsx(LXe,{vaiNumber:n==null?void 0:n.vai_number,verifiedAt:n==null?void 0:n.created_at,biometricPhotoUrl:n==null?void 0:n.biometric_photo_url,isVerified:!!n,onStartVerification:c}),n&&s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"p-4 bg-card/80 backdrop-blur-lg rounded-lg border border-white/10",children:[s.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Verification Method"}),s.jsx("p",{className:"font-semibold",children:"ChainPass Biometric"})]}),s.jsxs("div",{className:"p-4 bg-card/80 backdrop-blur-lg rounded-lg border border-white/10",children:[s.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Status"}),s.jsx("p",{className:"font-semibold text-green-500",children:"Active"})]})]})]}),s.jsx(Rt,{value:"history",children:s.jsx(BXe,{events:i})})]})})]})},VXe=({sessionId:e,onComplete:t})=>{const r=Oe(),[n,a]=w.useState(null),[i,o]=w.useState(!0),[l,c]=w.useState(!1),[u,d]=w.useState(null),[h,f]=w.useState(""),[p,m]=w.useState(!1),[v,g]=w.useState(null);w.useEffect(()=>{x()},[e]);const x=async()=>{try{const{data:{user:j}}=await T.auth.getUser();if(!j){H.error("You must be logged in"),r("/login");return}const{data:_}=await T.from("vai_verifications").select("vai_number").eq("user_id",j.id).single();if(!_){H.error("You must be VAI-verified to review manual verifications"),r("/feed");return}g(_.vai_number);const{data:S,error:C}=await T.from("vai_check_sessions").select("*").eq("id",e).single();if(C)throw C;if(S.manual_reviewer_vai_number!==_.vai_number){H.error("You are not authorized to review this verification"),r("/feed");return}if(S.manual_review_decision!=="pending"){H.info("This verification has already been reviewed"),t();return}S.reviewer_consent_timestamp||m(!0),a(S)}catch(j){console.error("Error loading session data:",j),H.error(j.message||"Failed to load verification request"),r("/feed")}finally{o(!1)}},y=async()=>{m(!1);try{const{data:{user:j}}=await T.auth.getUser();if(!j)return;await T.from("vai_check_sessions").update({reviewer_consent_timestamp:new Date().toISOString()}).eq("id",e),await T.from("manual_verification_audit_log").insert({session_id:e,action:"reviewer_consent_given",user_id:j.id,user_vai_number:v,metadata:{liability_waiver_accepted:!0}}),x()}catch(j){console.error("Error recording consent:",j),H.error("Failed to record consent")}},b=async()=>{if(!u){H.error("Please select a decision (Approve or Reject)");return}c(!0);try{const{data:{user:j}}=await T.auth.getUser();if(!j)return;const{error:_}=await T.from("vai_check_sessions").update({manual_review_decision:u,manual_review_decided_at:new Date().toISOString(),manual_review_notes:h||null,status:u==="approved"?"manual_review_approved":"manual_review_rejected"}).eq("id",e);if(_)throw _;await T.from("manual_verification_audit_log").insert({session_id:e,action:u==="approved"?"review_approved":"review_rejected",user_id:j.id,user_vai_number:v,metadata:{decision:u,notes:h||null}}),H.success(u==="approved"?"Verification approved! The other party has been notified.":"Verification rejected. The other party has been notified."),t()}catch(j){console.error("Error submitting review:",j),H.error(j.message||"Failed to submit review")}finally{c(!1)}};if(i)return s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Er,{className:"w-8 h-8 animate-spin text-primary"})});if(!n)return null;const N={system_failure:"System Failure",individual_issue:"Individual Issue",failed_verification:"Failed Verification"};return s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs(Hn,{className:"border-2 border-primary/50 bg-primary/5",children:[s.jsx(lt,{className:"h-5 w-5 text-primary"}),s.jsxs(Kn,{children:[s.jsx("div",{className:"font-semibold mb-2",children:"Manual Verification Request"}),s.jsx("p",{className:"text-sm",children:"You have been requested to manually verify another user. Please compare their VAI photo with their live selfie and make a decision."})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(tn,{className:"w-5 h-5 text-primary"}),"Review Manual Verification"]}),s.jsx(xe,{variant:"outline",children:N[n.manual_review_reason]})]}),s.jsx(Re,{children:"Compare the photos below and determine if they match the same person."})]}),s.jsxs(ee,{className:"space-y-6",children:[s.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[s.jsx(de,{className:"text-sm font-semibold mb-2 block",children:"Failure Reason:"}),s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:n.manual_review_notes||N[n.manual_review_reason]})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{className:"text-sm font-semibold",children:"VAI Verified Photo"}),s.jsx("div",{className:"aspect-video bg-muted rounded-lg overflow-hidden border-2 border-border",children:s.jsx("img",{src:n.manual_review_vai_photo_url,alt:"VAI Photo",className:"w-full h-full object-cover"})}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"This is the photo used during VAI verification"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{className:"text-sm font-semibold",children:"Live Selfie"}),s.jsx("div",{className:"aspect-video bg-muted rounded-lg overflow-hidden border-2 border-border",children:s.jsx("img",{src:n.manual_review_live_selfie_url,alt:"Live Selfie",className:"w-full h-full object-cover"})}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"This is the live photo captured during verification attempt"})]})]}),s.jsx(Hn,{children:s.jsxs(Kn,{className:"text-sm",children:[s.jsx("strong",{children:"What to look for:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2 ml-2",children:[s.jsx("li",{children:"Facial features (eyes, nose, mouth shape)"}),s.jsx("li",{children:"Face structure and proportions"}),s.jsx("li",{children:"Overall similarity"}),s.jsx("li",{children:"Note: Lighting, angle, and expression may differ"})]})]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs(de,{className:"text-base font-semibold",children:["Your Decision ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs(L,{variant:u==="approved"?"default":"outline",onClick:()=>d("approved"),className:"h-20 flex flex-col gap-2",disabled:l,children:[s.jsx(ut,{className:`w-6 h-6 ${u==="approved"?"":"text-muted-foreground"}`}),s.jsx("span",{className:"font-semibold",children:"Approve"}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"Photos match"})]}),s.jsxs(L,{variant:u==="rejected"?"destructive":"outline",onClick:()=>d("rejected"),className:"h-20 flex flex-col gap-2",disabled:l,children:[s.jsx(Qd,{className:`w-6 h-6 ${u==="rejected"?"":"text-muted-foreground"}`}),s.jsx("span",{className:"font-semibold",children:"Reject"}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"Photos don't match"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"review-notes",children:"Review Notes (Optional)"}),s.jsx(Mn,{id:"review-notes",value:h,onChange:j=>f(j.target.value),placeholder:"Add any additional observations or notes about your decision...",rows:3,maxLength:500}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[h.length," / 500 characters"]})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx(L,{variant:"outline",onClick:()=>r("/feed"),disabled:l,className:"flex-1",children:"Skip"}),s.jsx(L,{onClick:b,disabled:!u||l||!n.reviewer_consent_timestamp,className:"flex-1",children:l?s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"w-4 h-4 mr-2 animate-spin"}),"Submitting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"Submit Review"]})})]})]})]}),s.jsx(eQ,{open:p,onClose:()=>{m(!1),r("/feed")},onConfirm:y,failureReason:n.manual_review_reason,role:"reviewer",loading:l})]})};function zXe(){const{sessionId:e}=us(),t=Oe();return e?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background to-background/95 pb-32 md:pb-16",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"max-w-3xl mx-auto",children:s.jsx(VXe,{sessionId:e,onComplete:()=>t("/feed")})})})}):(t("/feed"),null)}function WXe(){const e=Oe(),{isAdmin:t,loading:r}=dh(),[n,a]=w.useState([]),[i,o]=w.useState(!0),[l,c]=w.useState("all"),[u,d]=w.useState("");w.useEffect(()=>{!r&&!t&&e("/feed")},[t,r,e]),w.useEffect(()=>{t&&h()},[t,l]);const h=async()=>{try{let g=T.from("vai_check_sessions").select(`
          *,
          provider:provider_id(id, email, full_name),
          client:client_id(id, email, full_name)
        `).order("created_at",{ascending:!1});l!=="all"&&(g=g.eq("verification_method",l));const{data:x,error:y}=await g;if(y)throw y;a(x||[])}catch(g){console.error("Error loading sessions:",g),H.error("Failed to load sessions")}finally{o(!1)}},f=g=>g==="manual_fallback"?s.jsx(xe,{variant:"outline",className:"bg-warning/10 text-warning-foreground",children:"Manual Fallback"}):s.jsx(xe,{variant:"outline",className:"bg-success/10 text-success-foreground",children:"Automated"}),p=g=>{if(!g)return null;const x={system_failure:"System Failure",individual_issue:"Individual Issue",failed_verification:"Failed Verification"};return s.jsx(xe,{variant:"outline",className:"text-xs",children:x[g]||g})},m=g=>g?g==="approved"?s.jsxs(xe,{variant:"outline",className:"bg-success/10 text-success-foreground",children:[s.jsx(ut,{className:"w-3 h-3 mr-1"}),"Approved"]}):g==="rejected"?s.jsxs(xe,{variant:"outline",className:"bg-destructive/10 text-destructive",children:[s.jsx(Qd,{className:"w-3 h-3 mr-1"}),"Rejected"]}):s.jsxs(xe,{variant:"outline",className:"bg-muted",children:[s.jsx(On,{className:"w-3 h-3 mr-1"}),"Pending"]}):null,v=n.filter(g=>{var y,b,N,j,_,S;if(!u)return!0;const x=u.toLowerCase();return((y=g.session_code)==null?void 0:y.toLowerCase().includes(x))||((b=g.manual_reviewer_vai_number)==null?void 0:b.toLowerCase().includes(x))||((j=(N=g.provider)==null?void 0:N.email)==null?void 0:j.toLowerCase().includes(x))||((S=(_=g.client)==null?void 0:_.email)==null?void 0:S.toLowerCase().includes(x))});return r||i?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):t?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/admin"),children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-xl font-bold flex items-center gap-2",children:[s.jsx(lt,{className:"w-5 h-5"}),"V.A.I. Check Sessions"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Monitor all verification sessions"})]})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6",children:[s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Filters"}),s.jsx(Re,{children:"Filter sessions by verification method and search"})]}),s.jsx(ee,{children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(De,{placeholder:"Search by session code, VAI number, or email...",value:u,onChange:g=>d(g.target.value)})}),s.jsxs(At,{value:l,onValueChange:c,children:[s.jsx(_t,{className:"w-full md:w-[200px]",children:s.jsx(Pt,{placeholder:"Verification Method"})}),s.jsxs(St,{children:[s.jsx(re,{value:"all",children:"All Methods"}),s.jsx(re,{value:"automated",children:"Automated"}),s.jsx(re,{value:"manual_fallback",children:"Manual Fallback"})]})]})]})})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{children:["All Sessions (",v.length,")"]}),s.jsx(Re,{children:"View and monitor all VAI check verification sessions"})]}),s.jsx(ee,{children:s.jsxs("div",{className:"overflow-x-auto",children:[s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b",children:[s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Session Code"}),s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Verification Method"}),s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Manual Review Reason"}),s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Reviewer VAI"}),s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Decision"}),s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Consent Timestamps"}),s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Status"}),s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Created"})]})}),s.jsx("tbody",{children:v.map(g=>s.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[s.jsx("td",{className:"p-2 text-sm font-mono",children:g.session_code}),s.jsx("td",{className:"p-2",children:f(g.verification_method)}),s.jsx("td",{className:"p-2",children:p(g.manual_review_reason)}),s.jsx("td",{className:"p-2 text-sm font-mono",children:g.manual_reviewer_vai_number||"-"}),s.jsx("td",{className:"p-2",children:m(g.manual_review_decision)}),s.jsxs("td",{className:"p-2 text-xs text-muted-foreground",children:[s.jsxs("div",{children:["Owner: ",g.owner_consent_timestamp?new Date(g.owner_consent_timestamp).toLocaleString():"-"]}),s.jsxs("div",{children:["Reviewer: ",g.reviewer_consent_timestamp?new Date(g.reviewer_consent_timestamp).toLocaleString():"-"]})]}),s.jsx("td",{className:"p-2",children:s.jsx(xe,{variant:"outline",children:g.status})}),s.jsx("td",{className:"p-2 text-xs text-muted-foreground",children:new Date(g.created_at).toLocaleString()})]},g.id))})]}),v.length===0&&s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No sessions found"})]})})]})]})]}):null}function qXe(){const e=Oe(),{isAdmin:t,loading:r}=dh(),[n,a]=w.useState([]),[i,o]=w.useState(!0),[l,c]=w.useState("all"),[u,d]=w.useState("all"),[h,f]=w.useState("");w.useEffect(()=>{!r&&!t&&e("/feed")},[t,r,e]),w.useEffect(()=>{t&&p()},[t,l,u]);const p=async()=>{try{let x=T.from("reviews").select(`
          *,
          encounter:encounters(
            id,
            status,
            created_at,
            provider_id,
            client_id
          )
        `).order("created_at",{ascending:!1});if(l!=="all"){const N=parseInt(l);x=x.gte("overall_rating",N).lt("overall_rating",N+1)}u!=="all"&&(x=x.eq("is_verified",u==="verified"));const{data:y,error:b}=await x;if(b)throw b;a(y||[])}catch(x){console.error("Error loading reviews:",x),H.error("Failed to load reviews")}finally{o(!1)}},m=async(x,y)=>{try{H.info("Review flagged. Legal team will review.")}catch(b){console.error("Error flagging review:",b),H.error("Failed to flag review")}},v=n.filter(x=>{var b,N,j,_,S;if(!h)return!0;const y=h.toLowerCase();return((b=x.reviewer_vai_number)==null?void 0:b.toLowerCase().includes(y))||((N=x.reviewee_vai_number)==null?void 0:N.toLowerCase().includes(y))||((j=x.notes)==null?void 0:j.toLowerCase().includes(y))||((S=(_=x.encounter)==null?void 0:_.id)==null?void 0:S.toLowerCase().includes(y))}),g=x=>x?x.length<=8?x:`${x.substring(0,4)}...${x.substring(x.length-4)}`:"N/A";return r||i?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):t?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/admin"),children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-xl font-bold flex items-center gap-2",children:[s.jsx(hr,{className:"w-5 h-5"}),"TrueRevu Reviews"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Monitor all verified reviews"})]})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6",children:[s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Filters"}),s.jsx(Re,{children:"Filter reviews by rating, verified status, and search"})]}),s.jsx(ee,{children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(De,{placeholder:"Search by VAI number, review text, or encounter ID...",value:h,onChange:x=>f(x.target.value)})}),s.jsxs(At,{value:l,onValueChange:c,children:[s.jsx(_t,{className:"w-full md:w-[150px]",children:s.jsx(Pt,{placeholder:"Rating"})}),s.jsxs(St,{children:[s.jsx(re,{value:"all",children:"All Ratings"}),s.jsx(re,{value:"5",children:"5 Stars"}),s.jsx(re,{value:"4",children:"4+ Stars"}),s.jsx(re,{value:"3",children:"3+ Stars"}),s.jsx(re,{value:"2",children:"2+ Stars"}),s.jsx(re,{value:"1",children:"1+ Stars"})]})]}),s.jsxs(At,{value:u,onValueChange:d,children:[s.jsx(_t,{className:"w-full md:w-[150px]",children:s.jsx(Pt,{placeholder:"Verified"})}),s.jsxs(St,{children:[s.jsx(re,{value:"all",children:"All"}),s.jsx(re,{value:"verified",children:"Verified Only"}),s.jsx(re,{value:"unverified",children:"Unverified"})]})]})]})})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{children:["All Reviews (",v.length,")"]}),s.jsx(Re,{children:"View and manage all TrueRevu reviews"})]}),s.jsx(ee,{children:s.jsxs("div",{className:"overflow-x-auto",children:[s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b",children:[s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Rating"}),s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Reviewer VAI"}),s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Reviewee VAI"}),s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Review Text"}),s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Encounter"}),s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Verified"}),s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Created"}),s.jsx("th",{className:"text-left p-2 text-sm font-semibold",children:"Actions"})]})}),s.jsx("tbody",{children:v.map(x=>{var y;return s.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[s.jsx("td",{className:"p-2",children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(hr,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),s.jsx("span",{className:"font-semibold",children:(y=x.overall_rating)==null?void 0:y.toFixed(1)})]})}),s.jsx("td",{className:"p-2 text-sm font-mono",children:g(x.reviewer_vai_number)}),s.jsx("td",{className:"p-2 text-sm font-mono",children:g(x.reviewee_vai_number)}),s.jsx("td",{className:"p-2 text-sm text-muted-foreground max-w-md truncate",children:x.notes||"-"}),s.jsx("td",{className:"p-2 text-xs font-mono",children:x.encounter?x.encounter.id.substring(0,8)+"...":"-"}),s.jsx("td",{className:"p-2",children:x.is_verified?s.jsxs(xe,{variant:"outline",className:"bg-green-500/10 text-green-600",children:[s.jsx(lt,{className:"w-3 h-3 mr-1"}),"Verified"]}):s.jsx(xe,{variant:"outline",children:"Unverified"})}),s.jsx("td",{className:"p-2 text-xs text-muted-foreground",children:new Date(x.created_at).toLocaleDateString()}),s.jsx("td",{className:"p-2",children:s.jsxs(L,{variant:"ghost",size:"sm",onClick:()=>m(x.id),className:"text-xs",children:[s.jsx(R0,{className:"w-3 h-3 mr-1"}),"Flag"]})})]},x.id)})})]}),v.length===0&&s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No reviews found"})]})})]})]})]}):null}function GXe(){var j;const e=Oe(),{isAdmin:t,loading:r}=dh(),[n,a]=w.useState([]),[i,o]=w.useState(!0),[l,c]=w.useState("all"),[u,d]=w.useState(null),[h,f]=w.useState(!1),[p,m]=w.useState(""),[v,g]=w.useState("");w.useEffect(()=>{!r&&!t&&e("/feed")},[t,r,e]),w.useEffect(()=>{t&&x()},[t,l]);const x=async()=>{try{let _=T.from("review_disputes").select(`
          *,
          review:reviews(notes, overall_rating),
          vote_tally:dispute_vote_tallies(*)
        `).order("created_at",{ascending:!1});l!=="all"&&(_=_.eq("status",l));const{data:S,error:C}=await _;if(C)throw C;a(S||[])}catch(_){console.error("Error loading disputes:",_),H.error("Failed to load disputes")}finally{o(!1)}},y=async()=>{if(!u||!p){H.error("Please select a resolution action");return}try{await T.from("review_disputes").update({status:"resolved",resolution_action:p,resolution_notes:v||null,resolved_at:new Date().toISOString()}).eq("id",u.id),p==="review_removed"&&await T.from("reviews").delete().eq("id",u.review_id),H.success("Dispute resolved successfully"),f(!1),d(null),m(""),g(""),x()}catch(_){console.error("Error resolving dispute:",_),H.error(_.message||"Failed to resolve dispute")}},b=async _=>{try{await T.from("review_disputes").update({status:"dismissed",resolution_action:"dismissed",resolved_at:new Date().toISOString()}).eq("id",_),H.success("Dispute dismissed"),x()}catch(S){console.error("Error dismissing dispute:",S),H.error(S.message||"Failed to dismiss dispute")}},N=_=>{switch(_){case"resolved":return s.jsxs(xe,{variant:"outline",className:"bg-success/10 text-success",children:[s.jsx(ut,{className:"w-3 h-3 mr-1"}),"Resolved"]});case"dismissed":return s.jsxs(xe,{variant:"outline",className:"bg-muted",children:[s.jsx(Qd,{className:"w-3 h-3 mr-1"}),"Dismissed"]});case"voting":return s.jsx(xe,{variant:"outline",className:"bg-primary/10 text-primary",children:"Voting"});case"panel_review":return s.jsx(xe,{variant:"outline",className:"bg-warning/10 text-warning",children:"Panel Review"});default:return s.jsx(xe,{variant:"outline",children:"Pending"})}};return r||i?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):t?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>e("/admin"),children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-xl font-bold flex items-center gap-2",children:[s.jsx(R0,{className:"w-5 h-5"}),"Dispute Resolution Management"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Review and resolve TrueRevu disputes"})]})]})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6",children:[s.jsx(q,{children:s.jsx(ee,{className:"p-4",children:s.jsx("div",{className:"flex gap-4",children:s.jsxs(At,{value:l,onValueChange:c,children:[s.jsx(_t,{className:"w-[200px]",children:s.jsx(Pt,{placeholder:"Filter by status"})}),s.jsxs(St,{children:[s.jsx(re,{value:"all",children:"All Statuses"}),s.jsx(re,{value:"pending_panel",children:"Pending Panel"}),s.jsx(re,{value:"panel_review",children:"Panel Review"}),s.jsx(re,{value:"voting",children:"Voting"}),s.jsx(re,{value:"resolved",children:"Resolved"}),s.jsx(re,{value:"dismissed",children:"Dismissed"})]})]})})})}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{children:["All Disputes (",n.length,")"]}),s.jsx(Re,{children:"Review vote tallies and take resolution actions"})]}),s.jsx(ee,{children:s.jsx("div",{className:"space-y-4",children:n.map(_=>{var C,E;const S=(C=_.vote_tally)==null?void 0:C[0];return s.jsx(q,{className:"border-2",children:s.jsx(ee,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"space-y-3 flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h3",{className:"font-semibold",children:["Dispute #",_.id.substring(0,8)]}),N(_.status),s.jsx(xe,{variant:"outline",children:_.dispute_reason})]}),_.review&&s.jsxs("div",{className:"text-sm",children:[s.jsxs("p",{className:"text-muted-foreground",children:['Review: "',(E=_.review.notes)==null?void 0:E.substring(0,100),'..."']}),s.jsxs("p",{className:"text-muted-foreground",children:["Rating: ",_.review.overall_rating,"/5.0"]})]}),S&&s.jsxs("div",{className:"grid grid-cols-3 gap-4 p-3 bg-muted rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"Favor Complainant"}),s.jsx("p",{className:"text-lg font-bold text-success",children:S.favor_complainant_count||0})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"Favor Respondent"}),s.jsx("p",{className:"text-lg font-bold text-destructive",children:S.favor_respondent_count||0})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"No Decision"}),s.jsx("p",{className:"text-lg font-bold text-muted-foreground",children:S.no_decision_count||0})]})]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Created: ",new Date(_.created_at).toLocaleString()]})]}),s.jsxs("div",{className:"flex gap-2",children:[_.status==="voting"&&s.jsx(L,{variant:"default",onClick:()=>{d(_),f(!0)},children:"Resolve"}),_.status!=="resolved"&&_.status!=="dismissed"&&s.jsx(L,{variant:"outline",onClick:()=>b(_.id),children:"Dismiss"})]})]})})},_.id)})})})]})]}),s.jsx(Ca,{open:h,onOpenChange:f,children:s.jsxs(oa,{children:[s.jsxs(Ea,{children:[s.jsx(ka,{children:"Resolve Dispute"}),s.jsx(pu,{children:"Review vote tallies and select a resolution action"})]}),s.jsxs("div",{className:"space-y-4",children:[((j=u==null?void 0:u.vote_tally)==null?void 0:j[0])&&s.jsxs("div",{className:"grid grid-cols-3 gap-4 p-4 bg-muted rounded-lg",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"Favor Complainant"}),s.jsx("p",{className:"text-2xl font-bold text-success",children:u.vote_tally[0].favor_complainant_count||0})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"Favor Respondent"}),s.jsx("p",{className:"text-2xl font-bold text-destructive",children:u.vote_tally[0].favor_respondent_count||0})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"No Decision"}),s.jsx("p",{className:"text-2xl font-bold text-muted-foreground",children:u.vote_tally[0].no_decision_count||0})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(de,{children:["Resolution Action ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs(At,{value:p,onValueChange:m,children:[s.jsx(_t,{children:s.jsx(Pt,{placeholder:"Select action"})}),s.jsxs(St,{children:[s.jsxs(re,{value:"review_removed",children:[s.jsx(Qc,{className:"w-4 h-4 mr-2 inline"}),"Remove Review"]}),s.jsxs(re,{value:"warning_issued",children:[s.jsx(rae,{className:"w-4 h-4 mr-2 inline"}),"Issue Warning"]}),s.jsxs(re,{value:"no_action",children:[s.jsx(ut,{className:"w-4 h-4 mr-2 inline"}),"No Action (Review Stays)"]})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{children:"Resolution Notes (Optional)"}),s.jsx(Mn,{value:v,onChange:_=>g(_.target.value),rows:4,placeholder:"Add notes about the resolution decision..."})]})]}),s.jsxs(Hx,{children:[s.jsx(L,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),s.jsx(L,{onClick:y,disabled:!p,children:"Resolve Dispute"})]})]})})]}):null}const HXe=({review:e})=>{const t=a=>a.length<=8?a:`${a.substring(0,4)}...${a.substring(a.length-4)}`,r=a=>s.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(i=>s.jsx(hr,{className:`w-4 h-4 ${i<=a?"fill-yellow-400 text-yellow-400":"fill-none text-muted-foreground"}`},i)),s.jsx("span",{className:"text-sm font-semibold ml-2",children:a.toFixed(1)})]}),n=[{label:"Punctuality",value:e.punctuality_rating},{label:"Communication",value:e.communication_rating},{label:"Respectfulness",value:e.respectfulness_rating},{label:"Attitude",value:e.attitude_rating},{label:"Accuracy",value:e.accuracy_rating},{label:"Safety",value:e.safety_rating}].filter(a=>a.value!==null&&a.value!==void 0);return s.jsxs(q,{className:"hover:shadow-lg transition-shadow",children:[s.jsx(ge,{children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx(be,{className:"flex items-center gap-2",children:r(e.overall_rating)}),s.jsxs(Re,{className:"flex items-center gap-2 text-xs",children:[s.jsx(Yn,{className:"w-3 h-3"}),new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.is_verified&&s.jsxs(xe,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[s.jsx(lt,{className:"w-3 h-3 mr-1"}),"Verified"]}),s.jsxs(xe,{variant:"outline",className:"text-xs font-mono",children:["VAI ",t(e.reviewer_vai_number)]})]})]})}),s.jsxs(ee,{className:"space-y-4",children:[e.notes&&s.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:e.notes}),n.length>0&&s.jsx("div",{className:"grid grid-cols-2 gap-2 pt-4 border-t",children:n.map(a=>s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsxs("span",{className:"text-muted-foreground",children:[a.label,":"]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(hr,{className:`w-3 h-3 ${a.value&&a.value>=3?"fill-yellow-400 text-yellow-400":"fill-none text-muted-foreground"}`}),s.jsx("span",{className:"font-semibold",children:a.value})]})]},a.label))})]})]})},KXe=({userId:e,encounterId:t,limit:r=10})=>{const[n,a]=w.useState([]),[i,o]=w.useState(!0),[l,c]=w.useState(null);w.useEffect(()=>{u()},[e,t]);const u=async()=>{try{o(!0),c(null);let d=T.from("reviews").select("*").eq("submitted",!0).eq("is_verified",!0).order("created_at",{ascending:!1});e&&(d=d.eq("reviewed_user_id",e)),t&&(d=d.eq("encounter_id",t)),r&&(d=d.limit(r));const{data:h,error:f}=await d;if(f)throw f;a(h||[])}catch(d){console.error("Error loading reviews:",d),c(d.message||"Failed to load reviews")}finally{o(!1)}};return i?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Er,{className:"w-8 h-8 animate-spin text-primary"})}):l?s.jsx("div",{className:"text-center py-12 text-destructive",children:s.jsxs("p",{children:["Error loading reviews: ",l]})}):n.length===0?s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsx("p",{children:"No reviews yet"})}):s.jsx("div",{className:"space-y-4",children:n.map(d=>s.jsx(HXe,{review:d},d.id))})};function YXe(){const e=Oe(),[t,r]=w.useState([]),[n,a]=w.useState(!0);w.useEffect(()=>{i()},[]);const i=async()=>{try{const{data:{user:o}}=await T.auth.getUser();if(!o)return;const{data:l,error:c}=await T.from("dispute_panel_members").select(`
          *,
          dispute:review_disputes(
            id,
            review_id,
            dispute_reason,
            status,
            created_at,
            review:reviews(notes, overall_rating)
          )
        `).eq("panel_member_id",o.id).in("status",["pending","accepted"]).order("created_at",{ascending:!1});if(c)throw c;r(l||[])}catch(o){console.error("Error loading pending disputes:",o),H.error("Failed to load disputes")}finally{a(!1)}};return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"TrueRevu Dashboard"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Review system and dispute resolution"})]})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:s.jsxs(Ga,{defaultValue:"reviews",className:"space-y-6",children:[s.jsxs(Aa,{children:[s.jsxs(mt,{value:"reviews",children:[s.jsx(hr,{className:"w-4 h-4 mr-2"}),"Reviews"]}),s.jsxs(mt,{value:"disputes",children:[s.jsx(R0,{className:"w-4 h-4 mr-2"}),"Pending Disputes to Review",t.length>0&&s.jsx(xe,{variant:"destructive",className:"ml-2",children:t.length})]})]}),s.jsx(Rt,{value:"reviews",children:s.jsx(KXe,{})}),s.jsx(Rt,{value:"disputes",children:s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Pending Disputes to Review"}),s.jsx(Re,{children:"You have been selected as a panel member for these disputes. Review the evidence and cast your vote."})]}),s.jsx(ee,{children:n?s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading disputes..."}):t.length===0?s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx(R0,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"No pending disputes assigned to you"})]}):s.jsx("div",{className:"space-y-4",children:t.map(o=>{var c;const l=o.dispute;return l?s.jsx(q,{className:"border-2",children:s.jsx(ee,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"space-y-2 flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h3",{className:"font-semibold",children:["Dispute #",l.id.substring(0,8)]}),s.jsx(xe,{variant:"outline",children:l.dispute_reason}),o.status==="pending"&&s.jsxs(xe,{variant:"outline",className:"bg-warning/10",children:[s.jsx(On,{className:"w-3 h-3 mr-1"}),"Invitation Pending"]}),o.status==="accepted"&&s.jsxs(xe,{variant:"outline",className:"bg-success/10",children:[s.jsx(ut,{className:"w-3 h-3 mr-1"}),"Accepted"]})]}),l.review&&s.jsxs("p",{className:"text-sm text-muted-foreground line-clamp-2",children:['Review: "',(c=l.review.notes)==null?void 0:c.substring(0,100),'..."']}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Created: ",new Date(l.created_at).toLocaleDateString()]})]}),s.jsx(L,{onClick:()=>e(`/truerevu/disputes/${l.id}`),variant:"default",children:"Review Case"})]})})},o.id):null})})})]})})]})})]})}function XXe(){const{disputeId:e}=us(),t=Oe(),[r,n]=w.useState(null),[a,i]=w.useState(null),[o,l]=w.useState(!0),[c,u]=w.useState(!1),[d,h]=w.useState(!1),[f,p]=w.useState(null);w.useEffect(()=>{m()},[e]);const m=async()=>{try{const{data:{user:g}}=await T.auth.getUser();if(!g){t("/login");return}const{data:x,error:y}=await T.from("review_disputes").select("*").eq("id",e).single();if(y||!x){H.error("Dispute not found"),t("/truerevu");return}n(x);const{data:b,error:N}=await T.from("reviews").select("*").eq("id",x.review_id).single();!N&&b&&i(b);const{data:j,error:_}=await T.from("dispute_panel_members").select("*").eq("dispute_id",e).eq("panel_member_id",g.id).single();if(_||!j){H.error("You are not a panel member for this dispute"),t("/truerevu");return}p(j),j.status==="pending"&&await T.from("dispute_panel_members").update({status:"accepted",invitation_accepted_at:new Date().toISOString()}).eq("id",j.id);const{data:S}=await T.from("dispute_votes").select("id").eq("dispute_id",e).eq("panel_member_id",g.id).maybeSingle();h(!!S)}catch(g){console.error("Error loading dispute data:",g),H.error("Failed to load dispute")}finally{l(!1)}},v=async g=>{if(e){u(!0);try{const{data:x,error:y}=await T.functions.invoke("record-dispute-vote",{body:{dispute_id:e,vote_decision:g}});if(y)throw y;if(x!=null&&x.success)H.success("Vote recorded successfully!"),h(!0);else throw new Error((x==null?void 0:x.error)||"Failed to record vote")}catch(x){console.error("Error recording vote:",x),H.error(x.message||"Failed to record vote")}finally{u(!1)}}};return o?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsx(Er,{className:"w-8 h-8 animate-spin text-primary"})}):!r||!a?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsxs(Hn,{children:[s.jsx(tn,{className:"h-4 w-4"}),s.jsx(Kn,{children:"Dispute not found"})]})}):s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4 flex items-center gap-4",children:[s.jsx(L,{variant:"ghost",size:"icon",onClick:()=>t("/truerevu"),children:s.jsx(ze,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold",children:"Dispute Review Panel"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Review case evidence and cast your vote"})]})]})}),s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6 space-y-6",children:[d?s.jsxs(Hn,{className:"border-success/50 bg-success/10",children:[s.jsx(ut,{className:"h-4 w-4 text-success"}),s.jsx(Kn,{className:"text-success",children:"You have already cast your vote. Thank you for your participation!"})]}):s.jsxs(Hn,{children:[s.jsx(tn,{className:"h-4 w-4"}),s.jsx(Kn,{children:"Please review all evidence carefully before casting your vote. Your decision is final."})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Review in Question"}),s.jsx(Re,{children:"The review that is being disputed"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Overall Rating"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl font-bold",children:a.overall_rating}),s.jsx("span",{className:"text-muted-foreground",children:"/ 5.0"})]})]}),a.notes&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Review Text"}),s.jsx("p",{className:"text-sm leading-relaxed bg-muted p-4 rounded-lg",children:a.notes})]}),s.jsx("div",{children:s.jsxs(xe,{variant:"outline",children:["Dispute Reason: ",r.dispute_reason]})})]})]}),s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Complainant's Statement"}),s.jsx(Re,{children:"Why this review should be disputed"})]}),s.jsx(ee,{children:s.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:r.statement})})]}),r.evidence_urls&&r.evidence_urls.length>0&&s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center gap-2",children:[s.jsx(T0,{className:"w-5 h-5"}),"Evidence"]}),s.jsx(Re,{children:"Supporting documents and images"})]}),s.jsx(ee,{children:s.jsx("div",{className:"grid grid-cols-2 gap-4",children:r.evidence_urls.map((g,x)=>s.jsx("div",{className:"border rounded-lg overflow-hidden",children:g.match(/\.(jpg|jpeg|png|gif)$/i)?s.jsx("img",{src:g,alt:`Evidence ${x+1}`,className:"w-full h-48 object-cover"}):s.jsxs("div",{className:"p-8 text-center",children:[s.jsx(T0,{className:"w-12 h-12 mx-auto mb-2 text-muted-foreground"}),s.jsx("a",{href:g,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline",children:"View Document"})]})},x))})})]}),r.dm_attachments&&r.dm_attachments.length>0&&s.jsxs(q,{children:[s.jsxs(ge,{children:[s.jsxs(be,{className:"flex items-center gap-2",children:[s.jsx(Ed,{className:"w-5 h-5"}),"Relevant Direct Messages"]}),s.jsx(Re,{children:"Conversation history between parties"})]}),s.jsx(ee,{children:s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:r.dm_attachments.map((g,x)=>s.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[s.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:new Date(g.created_at).toLocaleString()}),s.jsxs("p",{className:"text-sm",children:[g.preview,"..."]})]},x))})})]}),!d&&s.jsxs(q,{className:"border-2 border-primary",children:[s.jsxs(ge,{children:[s.jsx(be,{children:"Cast Your Vote"}),s.jsx(Re,{children:"Your decision is final and cannot be changed"})]}),s.jsxs(ee,{className:"space-y-4",children:[s.jsxs("div",{className:"grid gap-3",children:[s.jsx(L,{onClick:()=>v("favor_complainant"),disabled:c,className:"h-auto py-4 justify-start",variant:"outline",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(ut,{className:"w-5 h-5 text-success"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-semibold",children:"Favor Complainant"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"The review should be removed or modified"})]})]})}),s.jsx(L,{onClick:()=>v("favor_respondent"),disabled:c,className:"h-auto py-4 justify-start",variant:"outline",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Qd,{className:"w-5 h-5 text-destructive"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-semibold",children:"Favor Respondent"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"The review is valid and should remain"})]})]})}),s.jsx(L,{onClick:()=>v("no_decision"),disabled:c,className:"h-auto py-4 justify-start",variant:"outline",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(hae,{className:"w-5 h-5 text-muted-foreground"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-semibold",children:"No Decision"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"Insufficient evidence to make a determination"})]})]})})]}),c&&s.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Er,{className:"w-4 h-4 animate-spin"}),"Recording your vote..."]})]})]})]})]})}const QXe=new Moe,ZXe=()=>s.jsx(Uoe,{client:QXe,children:s.jsxs(BC,{children:[s.jsx(ose,{}),s.jsx(Dse,{}),s.jsx(Gle,{children:s.jsxs(Vle,{children:[s.jsx(Ie,{path:"/",element:s.jsx(Hle,{})}),s.jsx(Ie,{path:"/login",element:s.jsx(Fye,{})}),s.jsx(Ie,{path:"/create-vai",element:s.jsx(qwe,{})}),s.jsx(Ie,{path:"/feed",element:s.jsx(Wwe,{})}),s.jsx(Ie,{path:"/onboarding/welcome",element:s.jsx(Gwe,{})}),s.jsx(Ie,{path:"/onboarding/language",element:s.jsx(Hwe,{})}),s.jsx(Ie,{path:"/onboarding/role",element:s.jsx(Kwe,{})}),s.jsx(Ie,{path:"/onboarding/registration",element:s.jsx(a1e,{})}),s.jsx(Ie,{path:"/onboarding/verify-otp",element:s.jsx(s1e,{})}),s.jsx(Ie,{path:"/onboarding/success",element:s.jsx(l1e,{})}),s.jsx(Ie,{path:"/onboarding/vai-callback",element:s.jsx(c1e,{})}),s.jsx(Ie,{path:"/onboarding/founding-member",element:s.jsx(d1e,{})}),s.jsx(Ie,{path:"/dateguard",element:s.jsx(Uqe,{})}),s.jsx(Ie,{path:"/dateguard/home",element:s.jsx(B8e,{})}),s.jsx(Ie,{path:"/dateguard/guardians",element:s.jsx(q8e,{})}),s.jsx(Ie,{path:"/dateguard/activate",element:s.jsx(YL,{})}),s.jsx(Ie,{path:"/dateguard/activate/:encounterId",element:s.jsx(YL,{})}),s.jsx(Ie,{path:"/dateguard/session/:sessionId",element:s.jsx(K8e,{})}),s.jsx(Ie,{path:"/dateguard/chat/:sessionId",element:s.jsx(Y8e,{})}),s.jsx(Ie,{path:"/dateguard/safety-codes",element:s.jsx(X8e,{})}),s.jsx(Ie,{path:"/dateguard/setup/codes",element:s.jsx(Q8e,{})}),s.jsx(Ie,{path:"/dateguard/setup/groups",element:s.jsx(J8e,{})}),s.jsx(Ie,{path:"/dateguard/emergency/:sessionId",element:s.jsx(eWe,{})}),s.jsx(Ie,{path:"/dateguard/test-emergency",element:s.jsx(tWe,{})}),s.jsx(Ie,{path:"/vai-check",element:s.jsx(rWe,{})}),s.jsx(Ie,{path:"/vai-check/face-scan",element:s.jsx(oWe,{})}),s.jsx(Ie,{path:"/vai-check/face-scan-login",element:s.jsx(lWe,{})}),s.jsx(Ie,{path:"/vai-check/show-qr/:sessionId",element:s.jsx(xWe,{})}),s.jsx(Ie,{path:"/vai-check/scan-qr",element:s.jsx(yWe,{})}),s.jsx(Ie,{path:"/vai-check/mutual-view/:sessionId/:role",element:s.jsx(bWe,{})}),s.jsx(Ie,{path:"/vai-check/contract/:sessionId/:role",element:s.jsx(VHe,{})}),s.jsx(Ie,{path:"/vai-check/final-verification/:sessionId/:role",element:s.jsx(Vqe,{})}),s.jsx(Ie,{path:"/vai-check/complete/:sessionId",element:s.jsx(zqe,{})}),s.jsx(Ie,{path:"/vai-check/declined/:sessionId",element:s.jsx(kHe,{})}),s.jsx(Ie,{path:"/vai-check/review/:sessionId",element:s.jsx(zHe,{})}),s.jsx(Ie,{path:"/vai-check/manual-review/:sessionId",element:s.jsx(zXe,{})}),s.jsx(Ie,{path:"/vai-management",element:s.jsx(UXe,{})}),s.jsx(Ie,{path:"/vairidate/:providerId/:providerName",element:s.jsx(qqe,{})}),s.jsx(Ie,{path:"/vairipay/setup",element:s.jsx(EHe,{})}),s.jsx(Ie,{path:"/referrals",element:s.jsx(WHe,{})}),s.jsx(Ie,{path:"/referrals/help",element:s.jsx(qHe,{})}),s.jsx(Ie,{path:"/referrals/payouts",element:s.jsx(GHe,{})}),s.jsx(Ie,{path:"/referrals/invite/email",element:s.jsx(HHe,{})}),s.jsx(Ie,{path:"/referrals/invite/sms",element:s.jsx(KHe,{})}),s.jsx(Ie,{path:"/settings",element:s.jsx(eKe,{})}),s.jsx(Ie,{path:"/activity",element:s.jsx(iKe,{})}),s.jsx(Ie,{path:"/chat",element:s.jsx(rKe,{})}),s.jsx(Ie,{path:"/search",element:s.jsx(aKe,{})}),s.jsx(Ie,{path:"/favorites",element:s.jsx(sKe,{})}),s.jsx(Ie,{path:"/pricing",element:s.jsx(CKe,{})}),s.jsx(Ie,{path:"/profile-creation",element:s.jsx(rXe,{})}),s.jsx(Ie,{path:"/profile-wizard",element:s.jsx(fXe,{})}),s.jsx(Ie,{path:"/apply/influencer",element:s.jsx(mXe,{})}),s.jsx(Ie,{path:"/application/status",element:s.jsx(vXe,{})}),s.jsx(Ie,{path:"/notifications",element:s.jsx(gXe,{})}),s.jsx(Ie,{path:"/availability-settings",element:s.jsx(yXe,{})}),s.jsx(Ie,{path:"/available-now",element:s.jsx(bXe,{})}),s.jsx(Ie,{path:"/marketplace",element:s.jsx(TXe,{})}),s.jsx(Ie,{path:"/calendar",element:s.jsx(MXe,{})}),s.jsx(Ie,{path:"/admin",element:s.jsx(YHe,{})}),s.jsx(Ie,{path:"/admin/coupons",element:s.jsx(C9e,{})}),s.jsx(Ie,{path:"/admin/users",element:s.jsx(E9e,{})}),s.jsx(Ie,{path:"/admin/referrals",element:s.jsx(k9e,{})}),s.jsx(Ie,{path:"/admin/influencers",element:s.jsx(P9e,{})}),s.jsx(Ie,{path:"/admin/system-monitor",element:s.jsx(A9e,{})}),s.jsx(Ie,{path:"/admin/email-test",element:s.jsx(T9e,{})}),s.jsx(Ie,{path:"/admin/email-logs",element:s.jsx(R9e,{})}),s.jsx(Ie,{path:"/admin/country-reps",element:s.jsx(O9e,{})}),s.jsx(Ie,{path:"/admin/vai-sessions",element:s.jsx(WXe,{})}),s.jsx(Ie,{path:"/admin/reviews",element:s.jsx(qXe,{})}),s.jsx(Ie,{path:"/admin/disputes",element:s.jsx(GXe,{})}),s.jsx(Ie,{path:"/referral-leaderboard",element:s.jsx(tKe,{})}),s.jsx(Ie,{path:"/truerevu",element:s.jsx(YXe,{})}),s.jsx(Ie,{path:"/truerevu/disputes/:disputeId",element:s.jsx(XXe,{})}),s.jsx(Ie,{path:"/business/register",element:s.jsx(j1e,{})}),s.jsx(Ie,{path:"/business/:businessId/dashboard",element:s.jsx(T8e,{})}),s.jsx(Ie,{path:"/business/:businessId/control-panel",element:s.jsx($8e,{})}),s.jsx(Ie,{path:"/business/:businessId/directory",element:s.jsx(F8e,{})}),s.jsx(Ie,{path:"/vai-redemption",element:s.jsx(L8e,{})}),s.jsx(Ie,{path:"/client-profile",element:s.jsx(FXe,{})}),s.jsx(Ie,{path:"*",element:s.jsx(Kle,{})})]})})]})});NV(document.getElementById("root")).render(s.jsx(ene,{attribute:"class",defaultTheme:"system",enableSystem:!0,children:s.jsx(ZXe,{})}))});export default JXe();
